/**
 * Copyright @ 2016 Esri.
 * All rights reserved under the copyright laws of the United States and applicable international laws, treaties, and conventions.
 */
define(["dojo/_base/declare","dojo/text!./PointExtrudeMaterial.xml","esri/views/3d/webgl-engine/lib/GLSLShader","../../webgl-engine-extensions/GLSLProgramExt","../../support/fx3dUtils"],function(i,t,r,e,s){var a=i(null,{declaredClass:"esri.views.3d.effects.PointExtrude.PointExtrudeMaterial",constructor:function(i){this._gl=i.gl,this._vbLayout=i.vbLayout,this._shaderSnippets=i.shaderSnippets,this._program=null},destroy:function(){this._program&&(this._program.dispose(),delete this._program,this._program=null)},loadShaders:function(){if(this._shaderSnippets){(null==this._shaderSnippets.pointExtrudeVS||null==this._shaderSnippets.pointExtrudeFS)&&this._shaderSnippets._parse(t);var i=new r(35633,this._shaderSnippets.pointExtrudeVS,this._gl),s=new r(35632,this._shaderSnippets.pointExtrudeFS,this._gl);this._program=new e([i,s],this._gl)}return this._initResources()},getProgram:function(){return this._program},_initResources:function(){return!0},bind:function(i){this._program.use(),this._program.uniform1f("vme",i.viewingMode),this._program.uniformMatrix4fv("pmt",i.proj),this._program.uniformMatrix4fv("vmt",i.view),this._program.uniform3fv("cps",i.camPos),this._program.uniform3fv("ldn",i.lightingData.direction),this._program.uniform4fv("lat",i.lightingData.ambient),this._program.uniform4fv("lde",i.lightingData.diffuse),this._program.uniform4fv("lsr",i.lightingData.specular),i.svte.bind(0),this._program.uniform1i("svte",0),i.evte.bind(1),this._program.uniform1i("evte",1),this._program.uniform2fv("vfvs",i.vfvs),this._program.uniform2fv("wmmv",[i.minValue,i.maxValue]),this._program.uniform3fv("sz",i.sz),this._gl.activeTexture(33986),this._gl.bindTexture(3553,i.cbte),this._program.uniform1i("cbte",2),this._program.uniform1f("ail",i.ail),this._program.uniform1f("tcy",i.tcy),this._program.uniform3fv("btc",i.btc),this._program.uniform1f("fte",i.time),this._program.uniform1i("rpt",i.reachedRepeatLimit),this._program.uniform1f("sfr",i.sfr),this._program.uniform1f("zoom",i.zoom),this._gl.enable(2929),this._gl.enable(2884),this._gl.cullFace(1029),this._gl.enable(3042),this._vbLayout.enableVertexAttribArrays(this._gl,this._program,!1)},release:function(){this._gl.activeTexture(33984),this._gl.bindTexture(3553,null),this._gl.cullFace(1029),this._gl.disable(2884),this._gl.disable(3042),this._vbLayout.disableVertexAttribArrays(this._gl,this._program,!1),this._gl.useProgram(null)}});return a});