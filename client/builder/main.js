// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"dojo/promise/all":function(){define(["../_base/array","../Deferred","../when"],function(p,f,a){var l=p.some;return function(k){var h,q;k instanceof Array?q=k:k&&"object"===typeof k&&(h=k);var m,g=[];if(h){q=[];for(var e in h)Object.hasOwnProperty.call(h,e)&&(g.push(e),q.push(h[e]));m={}}else q&&(m=[]);if(!q||!q.length)return(new f).resolve(m);var c=new f;c.promise.always(function(){m=g=null});var d=q.length;l(q,function(e,u){h||g.push(u);a(e,function(a){c.isFulfilled()||(m[g[u]]=
a,0===--d&&c.resolve(m))},c.reject);return c.isFulfilled()});return c.promise}})},"dojo/cookie":function(){define(["./_base/kernel","./regexp"],function(p,f){p.cookie=function(a,l,k){var h=document.cookie,q;if(1==arguments.length)q=(q=h.match(RegExp("(?:^|; )"+f.escapeString(a)+"\x3d([^;]*)")))?decodeURIComponent(q[1]):void 0;else{k=k||{};h=k.expires;if("number"==typeof h){var m=new Date;m.setTime(m.getTime()+864E5*h);h=k.expires=m}h&&h.toUTCString&&(k.expires=h.toUTCString());l=encodeURIComponent(l);
var h=a+"\x3d"+l,g;for(g in k)h+="; "+g,m=k[g],!0!==m&&(h+="\x3d"+m);document.cookie=h}return q};p.cookie.isSupported=function(){"cookieEnabled"in navigator||(this("__djCookieTest__","CookiesAllowed"),navigator.cookieEnabled="CookiesAllowed"==this("__djCookieTest__"),navigator.cookieEnabled&&this("__djCookieTest__","",{expires:-1}));return navigator.cookieEnabled};return p.cookie})},"dojo/regexp":function(){define(["./_base/kernel","./_base/lang"],function(p,f){var a={};f.setObject("dojo.regexp",
a);a.escapeString=function(a,k){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,function(a){return k&&-1!=k.indexOf(a)?a:"\\"+a})};a.buildGroupRE=function(f,k,h){if(!(f instanceof Array))return k(f);for(var q=[],m=0;m<f.length;m++)q.push(k(f[m]));return a.group(q.join("|"),h)};a.group=function(a,k){return"("+(k?"?:":"")+a+")"};return a})},"dojo/request/script":function(){define("module ./watch ./util ../_base/kernel ../_base/array ../_base/lang ../on ../dom ../dom-construct ../has ../_base/window".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c){function d(c,d){c.canDelete&&b._remove(c.id,d.options.frameDoc,!0)}function r(c){y&&y.length&&(k.forEach(y,function(c){b._remove(c.id,c.frameDoc);c.frameDoc=null}),y=[]);return c.options.jsonp?!c.data:!0}function u(b){return!!this.scriptLoaded}function s(b){return(b=b.options.checkString)&&eval("typeof("+b+') !\x3d\x3d "undefined"')}function t(b,c){if(this.canDelete){var d=this.response.options;y.push({id:this.id,frameDoc:d.ioArgs?d.ioArgs.frameDoc:d.frameDoc});d.ioArgs&&
(d.ioArgs.frameDoc=null);d.frameDoc=null}c?this.reject(c):this.resolve(b)}function b(c,e,g){var m=a.parseArgs(c,a.deepCopy({},e));c=m.url;e=m.options;var k=a.deferred(m,d,r,e.jsonp?null:e.checkString?s:u,t);h.mixin(k,{id:v+n++,canDelete:!1});e.jsonp&&(RegExp("[?\x26]"+e.jsonp+"\x3d").test(c)||(c+=(~c.indexOf("?")?"\x26":"?")+e.jsonp+"\x3d"+(e.frameDoc?"parent.":"")+v+"_callbacks."+k.id),k.canDelete=!0,z[k.id]=function(b){m.data=b;k.handleResponse(m)});a.notify&&a.notify.emit("send",m,k.promise.cancel);
if(!e.canAttach||e.canAttach(k)){var l=b._attach(k.id,c,e.frameDoc);if(!e.jsonp&&!e.checkString)var y=q(l,w,function(b){if("load"===b.type||x.test(l.readyState))y.remove(),k.scriptLoaded=b})}q.once(l,"error",function(c){k.reject(c);b._remove(k.id,e.frameDoc,!0)});f(k);return g?k:k.promise}e.add("script-readystatechange",function(b,c){return"undefined"!==typeof c.createElement("script").onreadystatechange&&("undefined"===typeof b.opera||"[object Opera]"!==b.opera.toString())});var v=p.id.replace(/[\/\.\-]/g,
"_"),n=0,w=e("script-readystatechange")?"readystatechange":"load",x=/complete|loaded/,z=l.global[v+"_callbacks"]={},y=[];b.get=b;b._attach=function(b,d,a){a=a||c.doc;var e=a.createElement("script");e.type="text/javascript";e.src=d;e.id=b;e.async=!0;e.charset="utf-8";return a.getElementsByTagName("head")[0].appendChild(e)};b._remove=function(b,c,d){g.destroy(m.byId(b,c));z[b]&&(d?z[b]=function(){delete z[b]}:delete z[b])};b._callbacksProperty=v+"_callbacks";return b})},"jimu/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/sniff dojo/_base/config dojo/io-query dojo/query dojo/NodeList-traverse dojo/Deferred dojo/on dojo/json dojo/cookie dojo/number dojo/date/locale dojo/i18n!dojo/cldr/nls/number dojox/encoding/base64 esri/lang esri/arcgis/utils esri/dijit/PopupTemplate esri/SpatialReference esri/geometry/Extent esri/geometry/Multipoint esri/geometry/Polyline esri/geometry/Polygon esri/geometry/webMercatorUtils esri/tasks/GeometryService esri/tasks/ProjectParameters esri/tasks/FeatureSet esri/symbols/PictureMarkerSymbol esri/urlUtils esri/request esri/graphicsUtils jimu/portalUrlUtils ./shared/utils".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A,B,F,E,H,I,M,Q,K,J,O){function G(b,c){b=b||"";for(var d=0,a=[{test:window.File&&window.FileReader&&window.FileList&&window.Blob||!C.file.isEnabledFlash(),failure:[b+"libs/polyfills/fileAPI/FileAPI.js"],callback:function(){d++;d===a.length&&c()}}],e=0;e<a.length;e++)testLoad(a[e])}function T(b,c){var d=b.match(/url\([^)]+\)/gi),a,e;if(null===d||""===c)return b;for(a=0;a<d.length;a++)if(e=d[a].match(/(url\(["|']?)(.*)((?:['|"]?)\))/i),4<=e.length){var n=
e[2];c.endWith("/")||(c+="/");b=b.replace(e[1]+n+e[3],e[1]+c+n+e[3])}return b}function P(b,c){var d=Array.isArray(c),a=d&&[]||{};d?(b=b||[],a=a.concat(b),c.forEach(function(c,d){"undefined"===typeof b[d]?a[d]=c:"object"===typeof c?a[d]=P(b[d],c):-1===b.indexOf(c)&&a.push(c)})):(b&&"object"===typeof b&&Object.keys(b).forEach(function(c){a[c]=b[c]}),Object.keys(c).forEach(function(d){a[d]="object"!==typeof c[d]||!c[d]?c[d]:b[d]?P(b[d],c[d]):c[d]}));return a}function V(b,c,d){c=function(b){var c=[];
b.split("_").forEach(function(b){var d=!1,a;"--"===b.slice(b.length-2)&&(d=!0,b=b.slice(0,b.length-2));a=b.search(/\[[0-9]+\]/);-1===a&&(a=b.length);c.push({key:b.slice(0,a),index:Number(b.slice(a+1,-1)),deleteFlag:d})});return c}(c);for(var a=1;a<c.length-1;a++)if(b=p.isArray(b[c[a].key])?b[c[a].key][c[a].index]:b[c[a].key],!b)return;if(c[c.length-1].deleteFlag)!0===d&&(p.isArray(b[c[c.length-1].key])?delete b[c[c.length-1].key][c[c.length-1].index]:delete b[c[c.length-1].key]);else if(p.isArray(b[c[c.length-
1].key])){if(void 0===d)return b[c[c.length-1].key][c[c.length-1].index];b[c[c.length-1].key][c[c.length-1].index]=d}else{if(void 0===d)return b[c[c.length-1].key];b[c[c.length-1].key]=d}}function L(b,c,d){function a(d){d=C.template.getSearchRange(c,d,"]");var e=c.slice(d.firstPos,d.lastPos);return-1!==d.firstPos?(e=c.slice(d.firstPos+e.indexOf("[")+1,d.lastPos-1),d=c.slice(d.lastPos+1),(e=C.getConfigElementById(b,e))?{object:e,key:"section_"+d,state:"isSection"}:{state:"deleted"}):{state:"isNotSection"}}
var e=b,n=c=c.replace(/\//g,"_"),t=a("groups\\[.+\\]");if("deleted"!==t.state&&("isSection"===t.state&&(e=t.object,n=t.key),t=a("widgets\\[.+\\]"),"delete"!==t.state))return"isSection"===t.state&&(e=t.object,n=t.key),V(e,n,d)}var C={},X={geometryService:"http://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer"};p.mixin(C,O);window.atob||(window.atob=function(b){b=t.decode(b);for(var c="",d=0,a=b.length;d<a;d++)c+=String.fromCharCode(b[d]);return c});window.btob||(window.btob=
function(b){for(var c=[],d=0,a=b.length;d<a;d++)c.push(String.charCodeAt(b[d]));return t.encode(c)});var Y="unload",la=[];require.on("error",function(b){f.forEach(la,function(c){b.info[0]&&-1<b.info[0].indexOf(c.resKey)&&c.def.reject(b);for(var d in b.info)-1<d.indexOf(c.resKey)&&c.def.reject(b)})});C.checkError=function(b,c){la.push({resKey:b,def:c})};C.replacePlaceHolder=function(b,d){var a=c.stringify(b),e=a.match(/\$\{(\w)+\}/g),n;if(null===e)return b;for(n=0;n<e.length;n++){var t=e[n].match(/(\w)+/g)[0];
d[t]&&(a=a.replace(e[n],d[t]))}return c.parse(a)};C.changeUnit=function(b){var c=Math.abs(b),d;b=Math.floor(c);d=Math.floor(60*(c-b));c=(60*(60*(c-b)-d)).toFixed(2);return b+"\u00b0"+(10>d?"0"+d:d)+"'"+(10>c?"0"+c:c)+'"'};C.formatTime=function(b){var c=b/1E3;b=Math.floor(c/60);c=Number(c-60*b).toFixed(1);return(10>b?"0"+b:b)+":"+(10>c?"0"+c:c)};C.parseTime=function(b){var c=/(\d{2,})\:(\d{2})\.(\d{1})/;if(!c.test(b))return console.log("wrong time format."),-1;b=b.match(c);return 1E3*(60*parseInt(b[1],
10)+parseInt(b[2],10)+parseInt(b[3],10)/10)};C.preloadImg=function(b,c){var d=[],d="string"===typeof b?[b]:b;f.forEach(d,function(b){(new Image).src=c?c+b:b})};var aa=null;C.getImagesSize=function(b){var c=new g;if(!b||0!==b.indexOf("http"))return c.reject(),c;null===aa&&(aa=a.create("img",{id:"__test-image-size",style:{position:"absolute",left:"-9999px",top:"-9999px"}},document.body));var d=e(aa,"load",function(){clearTimeout(n);n=null;d.remove();var b=a.getContentBox(aa);1===b.w&&1===b.h||0===b.w||
0===b.h?c.reject():c.resolve([b.w,b.h])},{}),n=setTimeout(function(){clearTimeout(n);n=null;c.reject()},5E3);a.setAttr(aa,"src",b);return c};C.getPositionStyle=function(b){var c={};if(!b)return c;b=p.clone(b);if(window.isRTL){var d;"undefined"!==typeof b.left&&"undefined"!==typeof b.right?(d=b.left,b.left=b.right,b.right=d):"undefined"!==typeof b.left?(b.right=b.left,delete b.left):"undefined"!==typeof b.right&&(b.left=b.right,delete b.right);"undefined"!==typeof b.paddingLeft&&"undefined"!==typeof b.paddingRight?
(d=b.paddingLeft,b.paddingLeft=b.paddingRight,b.paddingRight=d):"undefined"!==typeof b.paddingLeft?(b.paddingRight=b.paddingLeft,delete b.paddingLeft):"undefined"!==typeof b.paddingRight&&(b.paddingLeft=b.paddingRight,delete b.paddingRight)}d="left top right bottom width height padding paddingLeft paddingRight paddingTop paddingBottom".split(" ");for(var a=0;a<d.length;a++){var e=d[a];"number"===typeof b[e]?c[e]=b[e]+"px":"undefined"!==typeof b[e]?c[e]=b[e]:"padding"===e.substr(0,7)?c[e]=0:c[e]="auto"}c.zIndex=
"undefined"===typeof b.zIndex?"auto":b.zIndex;return c};C.isEqual=function(b,c){function d(b,c){var n;if(null===b&&null===c||"undefined"===typeof b&&"undefined"===typeof c)return!0;if(null===b&&null!==c||null===c&&null!==b||"undefined"===typeof b&&"undefined"!==typeof c||"undefined"===typeof c&&"undefined"!==typeof b)return!1;if(isNaN(b)&&isNaN(c)&&"number"===typeof b&&"number"===typeof c||b===c)return!0;if("function"===typeof b&&"function"===typeof c||b instanceof Date&&c instanceof Date||b instanceof
RegExp&&c instanceof RegExp||b instanceof String&&c instanceof String||b instanceof Number&&c instanceof Number)return b.toString()===c.toString();if(-1<a.indexOf(b)||-1<e.indexOf(c))return!1;if(null!==c){for(n in c)if(c.hasOwnProperty(n)!==b.hasOwnProperty(n)||typeof c[n]!==typeof b[n])return!1;for(n in b){if(c.hasOwnProperty(n)!==b.hasOwnProperty(n)||typeof c[n]!==typeof b[n])return!1;switch(typeof b[n]){case "object":case "function":a.push(b);e.push(c);if(!d(b[n],c[n]))return!1;a.pop();e.pop();
break;default:if(isNaN(b[n])&&isNaN(c[n])&&"number"===typeof b[n]&&"number"===typeof c[n])return!0;if(b[n]!==c[n])return!1}}}return!0}var a,e;a=[];e=[];return!d(b,c)?!1:!0};C.file={loadFileAPI:function(){var b=new g;if("unload"===Y){var c=window.isBuilder?"stemapp/":"";window.FileAPI={debug:!1,flash:!0,staticPath:c+"libs/polyfills/fileAPI/",flashUrl:c+"libs/polyfills/fileAPI/FileAPI.flash.swf",flashImageUrl:c+"libs/polyfills/fileAPI/FileAPI.flash.image.swf"};G(c,p.hitch(this,function(){Y="loaded";
b.resolve()}));Y="loading"}else"loaded"===Y&&b.resolve();return b},supportHTML5:function(){return window.File&&window.FileReader&&window.FileList&&window.Blob?!0:!1},supportFileAPI:function(){return l("safari")&&6>l("safari")?!1:window.FileAPI&&window.FileAPI.readAsDataURL?!0:!1},isEnabledFlash:function(){var b=null;if(document.all)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(c){b=null}else navigator.plugins&&0<navigator.plugins.length&&(b=navigator.plugins["Shockwave Flash"]);return!!b},
containSeparator:function(b){return 0<=b.indexOf("/")?!0:0<=b.indexOf("\\")?!0:!1},getNameFromPath:function(b){var c="",c=0<=b.indexOf("/")?"/":"\\";b=b.split(c);return 0<b.length?b[b.length-1]:null},getFolderFromPath:function(b){return b.substr(0,b.length-C.file.getNameFromPath(b).length)},readFile:function(b,c,d,a){if(this.supportHTML5()){var e=b.target.files[0];e&&(e.type.match(c)?e.size>=d?a({errCode:"exceed"}):(b=new FileReader,b.onload=function(b){a(null,e.name,b.target.result)},b.readAsDataURL(e)):
a({errCode:"invalidType"}))}else if(this.supportFileAPI()){var n=window.FileAPI.getFiles(b);n[0].type.match(c)?n[0].size>=d?a({errCode:"exceed"}):window.FileAPI.readAsDataURL(n[0],function(b){b&&b.result?a(null,n[0].name,b.result):a({errCode:"readError"})}):a({errCode:"invalidType"})}}};C.widgetJson=function(){function b(c){var d,a={};d=c.indexOf("/");c.substring(0,d);c=c.substring(0,c.lastIndexOf("/")+1);a.folderUrl=require(C.getRequireConfig()).toUrl(c);a.amdFolder=c;return a}return{processWidgetJson:function(c){if(!c.uri)return c;
c.uri.toLowerCase().startWith("http")&&(c.isRemote=!0,c.uri.toLowerCase().endWith(".js")||(c.uri+=".js"));p.mixin(c,b(c.uri));c.icon||(c.icon=c.amdFolder+"images/icon.png?wab_dv\x3d"+window.deployVersion);c.thumbnail||(c.thumbnail=c.amdFolder+"images/thumbnail.png");return c},addManifest2WidgetJson:function(b,c){p.mixin(b,c.properties);b.name=c.name;b.label||(b.label=c.label);b.manifest=c;c.featureActions&&(b.featureActions=c.featureActions)},removeManifestFromWidgetJson:function(b){if(b.manifest){for(var c in b.manifest.properties)b[c]=
void 0;b.name=void 0;b.label=void 0;b.featureActions=void 0;b.manifest=void 0}}}}();C.getRequireConfig=function(){if(jimuConfig){var b=[];jimuConfig.widgetsPackage&&(b=b.concat(jimuConfig.widgetsPackage));jimuConfig.themesPackage&&(b=b.concat(jimuConfig.themesPackage));jimuConfig.configsPackage&&(b=b.concat(jimuConfig.configsPackage));return{packages:b}}return{}};C.getTypeByGeometryType=function(b){var c="",d="esriGeometryLine esriGeometryCircularArc esriGeometryEllipticArc esriGeometryBezier3Curve esriGeometryPath esriGeometryPolyline".split(" "),
a=["esriGeometryRing","esriGeometryPolygon","esriGeometryEnvelope"];0<=["esriGeometryPoint","esriGeometryMultipoint"].indexOf(b)?c="point":0<=d.indexOf(b)?c="polyline":0<=a.indexOf(b)&&(c="polygon");return c};C.getSymbolTypeByGeometryType=function(b){var c=null;b=C.getTypeByGeometryType(b);"point"===b?c="marker":"polyline"===b?c="line":"polygon"===b&&(c="fill");return c};C.getServices=function(){return X};C.getArcGISDefaultGeometryService=function(){return new F(X.geometryService)};C.restoreToDefaultWebMapExtent=
function(b,c,d){var a=new g;if(!(b&&"esri.Map"===b.declaredClass))return setTimeout(function(){a.reject("Invalid map.")},0),a;c=c&&c.itemInfo;if(!c)return setTimeout(function(){a.reject("Invalid itemInfo")},0),a;c=c.item&&c.item.extent;if(!c)return setTimeout(function(){a.reject("Invalid itemInfo.item.extent")}),a;var e=new w({wkid:4326}),e=new x(c[0][0],c[0][1],c[1][0],c[1][1],e);if(4326===parseInt(b.spatialReference.wkid,10))return b.setExtent(e);if(b.spatialReference.isWebMercator())return e=B.geographicToWebMercator(e),
b.setExtent(e);c=new E;c.geometries=[e];c.outSR=b.spatialReference;e=esriConfig&&esriConfig.defaults&&esriConfig.defaults.geometryService;e&&"esri.tasks.GeometryService"===e.declaredClass||(d&&"string"===typeof d&&p.trim(d)?(d=p.trim(d),e=new F(d)):e=C.getArcGISDefaultGeometryService());e.project(c).then(function(c){if(c=c&&c[0])return b.setExtent(c);a.reject("Invalid projected geometry.");return a},function(b){console.error(b);a.reject(b);return a});return a};C.getAncestorWindow=function(){for(var b=
window;b&&b.parent&&b!==b.parent;)b=b.parent;return b};C.getAncestorDom=function(b,c,d){if(b&&1===b.nodeType&&c&&"function"===typeof c){var e=100,n=document.body;d&&("number"===typeof d?(d=parseInt(d,10),0<d&&(e=d)):1===d.nodeType&&(n=d));for(d=0;b.parentNode&&d<e&&a.isDescendant(b.parentNode,n);){if(c(b.parentNode))return b.parentNode;b=b.parentNode;d++}}return null};C.bindClickAndDblclickEvents=function(b,c,d,a){var n=null;if(b&&1===b.nodeType&&c&&"function"===typeof c&&d&&"function"===typeof d){var t=
200;a&&"number"===typeof a&&(a=parseInt(a,10),0<a&&(t=a));var g=0,n=e(b,"click",function(b){g++;1===g?setTimeout(function(){1===g&&(g=0,c(b))},t):2===g&&(g=0,d(b))})}return n};C.isScrollToBottom=function(b){var c=a.getContentBox(b);return 1>b.scrollHeight-(b.scrollTop+c.h)};C.getAllItemTypes=function(){var b=[],b=b.concat(["Web Map","Web Scene","CityEngine Web Scene"]).concat("Feature Service;Map Service;Image Service;KML;WMS;Feature Collection;Feature Collection Template;Geodata Service;Globe Service".split(";")).concat(["Geometry Service",
"Geocoding Service","Network Analysis Service","Geoprocessing Service"]).concat(["Web Mapping Application","Mobile Application","Code Attachment","Operations Dashboard Add In","Operation View"]).concat("Symbol Set;Color Set;Shapefile;CSV;Service Definition;Document Link;Microsoft Word;Microsoft PowerPoint;Microsoft Excel;PDF;Image;Visio Document".split(";"));return b=b.concat("Map Document;Map Package;Tile Package;ArcPad Package;Explorer Map;Globe Document;Scene Document;Published Map;Map Template;Windows Mobile Package".split(";")).concat(["Layer",
"Layer Package","Explorer Layer"]).concat(["Geoprocessing Package","Geoprocessing Sample","Locator Package","Rule Package"]).concat("Workflow Manager Package;Desktop Application;Desktop Application Template;Code Sample;Desktop Add In;Explorer Add In".split(";"))};C.getItemQueryStringByTypes=function(b){var c="",d=C.getAllItemTypes();if(b&&0<b.length&&0<b.length){var a="";f.forEach(b,function(c,d){a+=' type:"'+c+'" ';d!==b.length-1&&(a+=" OR ")});c=" ( "+a+" ) ";d=b.concat(d);d=f.filter(d,function(c){return f.every(b,
function(b){return 0>b.toLowerCase().indexOf(c.toLowerCase())})});f.forEach(d,function(b){c+=' -type:"'+b+'" '})}return c};C.getItemQueryStringByTypeKeywords=function(b){var c="";b&&0<b.length&&(c=' typekeywords:"'+b.join(",")+'" ');return c};C.isNotEmptyString=function(b,c){var d=b&&"string"===typeof b;return d?c?d&&p.trim(b):!0:!1};C.isValidNumber=function(b){return"number"===typeof b&&!isNaN(b)};C.isObject=function(b){return b&&"object"===typeof b};C.createWebMap=function(b,c,d,a){b=J.getStandardPortalUrl(b);
b=J.getBaseItemUrl(b);v.arcgisUrl=b;return v.createMap(c,d,a)};C.getRandomString=function(){var b=Math.random().toString();return b=b.slice(2,b.length)};C._getDomainsByServerName=function(b){var c=b.split("."),d=c.length;return f.map(c,p.hitch(this,function(b,a){var e=c.slice(a,d),n="",t=e.length-1;f.forEach(e,p.hitch(this,function(b,c){n+=b;c!==t&&(n+=".")}));return n}))};C.removeCookie=function(b,c){var a=this._getDomainsByServerName(window.location.hostname);f.forEach(a,p.hitch(this,function(a){d(b,
null,{expires:-1,path:c});d(b,null,{expires:-1,path:c,domain:a});d(b,null,{expires:-1,path:c,domain:"."+a})}))};C.isLocaleChanged=function(b,c){return!b.startWith(c)};C.hashToObject=function(b){b=b.replace("#","");b=h.queryToObject(b);for(var d in b)if(b.hasOwnProperty(d))try{b[d]=c.parse(b[d])}catch(a){}return b};C.reCreateObject=function(b){function c(b){var a=[];b.forEach(function(b){Array.isArray(b)?a.push(c(b)):"object"===typeof b?a.push(d(b)):a.push(b)});return a}function d(b){var a={},e;for(e in b)b.hasOwnProperty(e)&&
(null===b[e]?a[e]=null:Array.isArray(b[e])?a[e]=c(b[e]):a[e]="object"===typeof b[e]?d(b[e]):b[e]);return a}return Array.isArray(b)?c(b):d(b)};C.setVerticalCenter=function(b){setTimeout(function(){var c=q(".jimu-vcenter-text",b),d,e;f.forEach(c,function(b){d=a.getContentBox(b).h;a.setStyle(b,{lineHeight:d+"px"})},this);c=q(".jimu-vcenter",b);f.forEach(c,function(b){d=a.getContentBox(b).h;e=a.getContentBox(q(b).parent()[0]).h;a.setStyle(b,{marginTop:(e-d)/2+"px"})},this)},10)};C.merge=P;C.loadStyleLink=
function(b,c,d){var n=new g,t,s=require(C.getRequireConfig()).toUrl(c);if(require.cache["url:"+s]){t=require.cache["url:"+s];var v=s.split("/").pop(),s=s.substr(0,s.length-v.length);t=T(t,s);b=d?a.create("style",{id:b,type:"text/css"},a.byId(d),"before"):a.create("style",{id:b,type:"text/css"},document.getElementsByTagName("head")[0]);b.styleSheet&&!b.sheet?b.styleSheet.cssText=t:b.appendChild(a.toDom(t));n.resolve("load");return n}t=d?a.create("link",{id:b,rel:"stylesheet",type:"text/css",href:s+
"?wab_dv\x3d"+window.deployVersion},a.byId(d),"before"):a.create("link",{id:b,rel:"stylesheet",type:"text/css",href:s+"?wab_dv\x3d"+window.deployVersion},document.getElementsByTagName("head")[0]);e(t,"load",function(){n.resolve("load")});var r=setInterval(function(){var b;if(f.some(document.styleSheets,function(d){if(d.href&&d.href.substr(d.href.indexOf(c),d.href.length)===c)return b=d,!0}))try{!n.isFulfilled()&&(b.cssRules&&b.cssRules.length||b.rules&&b.rules.length)&&n.resolve("load"),clearInterval(r)}catch(d){}},
50);return n};C.changeLocation=function(b){window.history.pushState&&window.history.pushState({path:b},"",b)};C.urlToObject=function(b){var c=null;-1===b.indexOf("#")?(c=M.urlToObject(b),c.hash=null):(b=b.split("#"),c=M.urlToObject(b[0]),c.hash=b[1]?-1<b[1].indexOf("\x3d")?h.queryToObject(b[1]):b[1]:null);return c};C.manifest=function(){function b(c){c.panels.forEach(function(b){b.uri="panels/"+b.name+"/Panel.js"});c.styles.forEach(function(b){b.uri="styles/"+b.name+"/style.css"});c.layouts.forEach(function(b){b.uri=
"layouts/"+b.name+"/config.json";b.icon="layouts/"+b.name+"/icon.png";b.RTLIcon="layouts/"+b.name+"/icon_rtl.png"})}return{addManifestProperies:function(c){c.icon=c.url+"images/icon.png?wab_dv\x3d"+window.deployVersion;"theme"===c.category?b(c):("undefined"!==typeof c["2D"]&&(c.support2D=c["2D"]),"undefined"!==typeof c["3D"]&&(c.support3D=c["3D"]),"undefined"===typeof c["2D"]&&"undefined"===typeof c["3D"]&&(c.support2D=!0),delete c["2D"],delete c["3D"],"undefined"===typeof c.properties&&(c.properties=
{}),O.processWidgetProperties(c))},processManifestLabel:function(b,c){var d=c.split("-")[0];b.label=b.i18nLabels&&(b.i18nLabels[c]||b.i18nLabels[d]||b.i18nLabels.defaultLabel)||b.label||b.name;b.layouts&&f.forEach(b.layouts,function(d){var a="i18nLabels_layout_"+d.name;d.label=b[a]&&(b[a][c]||b[a].defaultLabel)||d.label||d.name});b.styles&&f.forEach(b.styles,function(d){var a="i18nLabels_style_"+d.name;d.label=b[a]&&(b[a][c]||b[a].defaultLabel)||d.label||d.name})},addI18NLabel:function(b){var c=new g;
if(b.i18nLabels)return c.resolve(b),c;b.i18nLabels={};if(b.properties&&!1===b.properties.hasLocale)return c.resolve(b),c;var d;d=b.amdFolder.toLowerCase().startWith("http")?b.amdFolder+"nls/strings.js":b.amdFolder+"nls/strings";require(C.getRequireConfig(),["dojo/i18n!"+d],function(d){var a={};a[dojoConfig.locale]=d;O.addI18NLabelToManifest(b,null,a);c.resolve(b)});return c}}}();C.getUniqueValues=function(b,d){var a=new g,e=b.replace(/\/*$/g,"")+"/generateRenderer",n=c.stringify({type:"uniqueValueDef",
uniqueValueFields:[d]});Q({url:e,content:{classificationDef:n,f:"json"},handleAs:"json",callbackParamName:"callback"}).then(p.hitch(this,function(b){var c=[];(b=b&&b.uniqueValueInfos)&&0<b.length&&(c=f.map(b,p.hitch(this,function(b){return b.value})));a.resolve(c)}),p.hitch(this,function(b){a.reject(b)}));return a};C.combineRadioCheckBoxWithLabel=function(b,c){var d=!1;if(b&&1===b.nodeType&&"input"===b.tagName.toLowerCase()){var e=b.getAttribute("type")||"",e=e.toLowerCase();if("radio"===e||"checkbox"===
e)d=!0}e=!1;c&&(1===c.nodeType&&"label"===c.tagName.toLowerCase())&&(e=!0);d&&e&&(d=b.getAttribute("id"),d||(d="input_"+C.getRandomString(),b.setAttribute("id",d)),c.setAttribute("for",d),a.setStyle(c,"cursor","pointer"))};C.groupRadios=function(b,c){var d=[],a="radiogroup_"+C.getRandomString();f.forEach(b,function(b){b.name=a;c&&(b=e(b,"change",c),d.push(b))});return d};C.convertExtentToPolygon=function(b){var c=b.xmin,d=b.xmax,a=b.ymin,e=b.ymax;return new A({rings:[[[c,e],[d,e],[d,a],[c,a],[c,e]]],
spatialReference:b.toJson()})};C.combineGeometries=function(b){function c(b){var d={points:[],spatialReference:b[0].spatialReference.toJson()};f.forEach(b,function(b){"point"===b.type?d.points=d.points.concat([[b.x,b.y]]):"multipoint"===b.type&&(d.points=d.points.concat(b.points))});return new z(d)}function d(b){var c={paths:[],spatialReference:b[0].spatialReference.toJson()};f.forEach(b,function(b){c.paths=c.paths.concat(b.paths)});return new y(c)}function a(b){var c={rings:[],spatialReference:b[0].spatialReference.toJson()};
f.forEach(b,function(b){"polygon"===b.type?c.rings=c.rings.concat(b.rings):"extent"===b.type&&(b=C.convertExtentToPolygon(b),c.rings=c.rings.concat(b.rings))});return new A(c)}var e=null;if(b&&0<b.length)if(1===b.length)e=b[0];else{for(var n=null,t=null,g=null,s=null,v=0;v<b.length;v++){n=b[v];switch(n.type){case "point":case "multipoint":s="point";break;case "polyline":s="polyline";break;case "polygon":case "extent":s="polygon";break;default:return null}if(0===v)g=s;else if(g!==s)return null;if(v!==
b.length-1&&(t=b[v+1],!n.spatialReference.equals(t.spatialReference)))return null}"point"===s?e=c(b):"polyline"===s?e=d(b):"polygon"===s&&(e=a(b))}return e};C.combineGeometriesByGraphics=function(b){var c=null;b&&0<b.length&&(b=f.map(b,function(b){return b.geometry}),c=C.combineGeometries(b));return c};C.isFeaturelayerUrlSupportQuery=function(b,c){var d=!1,a=/\/featureserver\//gi.test(b),e=/\/mapserver\//gi.test(b);c=(c||"").toLowerCase();a?d=0<=c.indexOf("query"):e&&(d=0<=c.indexOf("data"));return d};
C.isImageServiceSupportQuery=function(b){return 0<=(b||"").toLowerCase().indexOf("catalog")};C.isStringEndWith=function(b,c){return b.lastIndexOf(c)+c.length===b.length};C.localizeNumber=function(b,c){var d=(b.toString().split(".")[1]||"").length,a="",a=c&&isFinite(c.places)&&c.places,a=0<a||0<d?"#,###,###,##0.0"+Array.prototype.join.call({length:0<a?a+1:d},"0"):"#,###,###,##0",d={locale:k.locale,pattern:a};p.mixin(d,c||{});try{return r.format(b,d)}catch(e){return console.error(e),b.toLocaleString()}};
C.parseNumber=function(b,c){var d={locale:k.locale};p.mixin(d,c||{});try{return r.parse(b,d)}catch(a){return console.error(a),b}};C.localizeDate=function(b,c){var d={locale:k.locale,fullYear:!0};p.mixin(d,c||{});try{return u.format(b,d)}catch(a){return console.error(a),"date"===d.selector?b.toLocaleDateString():"time"===d.selector?b.toLocaleTimeString():b.toLocaleString()}};C.localizeNumberByFieldInfo=function(b,c){var d=null,d=p.exists("format.places",c)&&c.format.places,d=C.localizeNumber(b,{places:d});
return p.exists("format.digitSeparator",c)&&!c.format.digitSeparator?d.toString().replace(RegExp("\\"+s.group,"g"),""):d};C.localizeDateByFieldInfo=function(c,d){var a=null;try{var e={date:c instanceof Date?c.getTime():c},t=p.exists("format.dateFormat",d)?d.format.dateFormat:"longMonthDayYear",a=b.substitute(e,"${date}",{dateFormat:{properties:["date"],formatter:"DateFormat"+n.prototype._dateFormats[t]}})}catch(g){console.error(g),a=c}return a};C.fieldFormatter={getFormattedUrl:function(b){if(b&&
"string"===typeof b){var c=b.indexOf("http:");-1===c&&(c=b.indexOf("https:"));if(-1<c&&-1===b.indexOf("href\x3d")){var d=b.indexOf(" ",c);-1===d&&(d=b.length);var a=b.substring(c,d);b=b.substring(0,c)+'\x3cA href\x3d"'+a+'" target\x3d"_blank"\x3e'+a+"\x3c/A\x3e"+b.substring(d,b.length)}}return b||""},getFormattedNumber:function(b,c){if("number"===typeof b){var d=(b.toString().split(".")[1]||"").length;b=C.localizeNumberByFieldInfo(b,{format:{places:c&&"number"===typeof c.places?parseInt(c.places,
10):d,digitSeparator:c&&c.digitSeparator}});return'\x3cspan class\x3d"jimu-numeric-value"\x3e'+(b||"")+"\x3c/span\x3e"}return b},getFormattedDate:function(b,c){if("number"===typeof b||b instanceof Date)b=C.localizeDateByFieldInfo(b,{format:c});return b||""},getCodedValue:function(c,d){if(c&&c.codedValues){for(var a=0,e=c.codedValues.length;a<e;a++){var n=c.codedValues[a];if(b.isDefined(d)&&p.exists("code",n)&&d.toString()===n.code.toString())return n.name}return d}return d||null},getTypeName:function(b,
c){for(var d=c.length,a=0;a<d;a++)if(b===c[a].id)return c[a].name;return b}};C.addRelativePathInCss=T;C.url={isAbsolute:function(b){return!b?!1:b.startWith("http")||b.startWith("/")},removeQueryParamFromUrl:function(b,c){var d=M.urlToObject(b);d.query&&delete d.query[c];var a=d.path,e;for(e in d.query)a=a===d.path?a+"?"+e+"\x3d"+d.query[e]:a+"\x26"+e+"\x3d"+d.query[e];return a},addQueryParamToUrl:function(b,c,d){b=M.urlToObject(b);b.query||(b.query={});b.query[c]=d;c=b.path;for(var a in b.query)c=
c===b.path?c+"?"+a+"\x3d"+b.query[a]:c+"\x26"+a+"\x3d"+b.query[a];return c}};C.processUrlInWidgetConfig=function(b,c){if(b)return b.startWith("data:")||b.startWith("http")||b.startWith("/")?b:b.startWith("${appPath}")?b.replace("${appPath}",window.appInfo.appPath):c+b};C.processUrlInAppConfig=function(b){if(b)return b.startWith("data:")||b.startWith("http")||b.startWith("/")?b:window.appInfo.appPath+b};C.getLocationUrlWithoutHashAndQueryParams=function(){var b=window.location,c=b.protocol+"//"+b.host+
b.pathname,b=M.urlToObject(b.href);b.query&&b.query.apiurl&&(c=C.url.addQueryParamToUrl(c,"apiurl",b.query.apiurl));return c};C.getDefaultWebMapThumbnail=function(){return require.toUrl("jimu/images/webmap.png")};C.invertColor=function(b){b=b.substring(1);3===b.length&&(b=b.slice(0,1)+b.slice(0,1)+b.slice(1,1)+b.slice(1,1)+b.slice(2,1)+b.slice(2,1));b=parseInt(b,16);return 7829367<b?"#000000":"#ffffff"};C.mixinAppConfigPosition=function(b,c){var d=p.clone(b);if(!c)return d;c=p.clone(c);var a=d.widgetOnScreen,
e=c.widgetOnScreen;e&&e.widgets&&("[object Object]"===Object.prototype.toString.call(e.widgets)?f.forEach(a.widgets,function(b,c){var d;d=b.uri?b.uri:"ph_"+c;e.widgets[d]&&e.widgets[d].position&&(e.widgets[d].position.relativeTo||(e.widgets[d].position.relativeTo="map"),b.position=e.widgets[d].position)},this):f.forEach(e.widgets,function(b,c){b.position&&!b.position.relativeTo&&(b.position.relativeTo="map");a.widgets[c]&&b.position&&(a.widgets[c].position=b.position)}));e&&e.groups&&("[object Object]"===
Object.prototype.toString.call(e.groups)?f.forEach(a.groups,function(b,c){var d;d=b.label?b.label:"g_"+c;e.groups[d]&&(e.groups[d].panel&&e.groups[d].panel.position)&&(e.groups[d].panel.position.relativeTo||(e.groups[d].panel.position.relativeTo="map"),b.panel.position=e.groups[d].panel.position)},this):f.forEach(e.groups,function(b,c){b.panel&&(b.panel.position&&!b.panel.position.relativeTo)&&(b.panel.position.relativeTo="map");a.groups[c]&&b.panel.position&&(a.groups[c].panel.position=b.panel.position)}));
c.map&&c.map.position&&(d.map?d.map.position=c.map.position:d.map={position:c.map.position});c.widgetPool&&c.widgetPool.panel&&(c.widgetPool.panel.position&&!c.widgetPool.panel.position.relativeTo&&(c.widgetPool.panel.position.relativeTo="map"),d.widgetPool.panel.position=c.widgetPool.panel.position);c.mobileLayout&&(d.mobileLayout=c.mobileLayout);return d};C.template={groupIdentification:"groups\\[.+\\]",widgetIdentification:"widgets\\[.+\\]",getSearchRange:function(b,c,d){var a=-1;c=b.search(RegExp(c));
0<=c&&(b=b.slice(c,b.length),b=b.indexOf(d),a=c+b+d.length);return{firstPos:c,lastPos:a}},setConfigValue:function(b,c,d){V(b,c,d)},getConfigValue:function(b,c){return V(b,c)},setConfigValueWithId:function(b,c,d){L(b,c,d)},getConfigValueWithId:function(b,c){return L(b,c)},getKeyInfo:function(b){var c=this.getWidgetIdByKey(b);if(null!==c)return{type:"widget",id:c};b=this.getGroupIdByKey(b);return null!==b?{type:"group",id:b}:{type:"unknow",id:null}},getWidgetIdByKey:function(b){var c=C.template.getSearchRange(b,
C.template.widgetIdentification,"]");if(-1===c.firstPos)b=null;else{var d=b.slice(c.firstPos,c.lastPos);b=b.slice(c.firstPos+d.indexOf("[")+1,c.lastPos-1)}return b},getGroupIdByKey:function(b){var c=C.template.getSearchRange(b,C.template.groupIdentification,"]");if(-1===c.firstPos)b=null;else{var d=b.slice(c.firstPos,c.lastPos);b=b.slice(c.firstPos+d.indexOf("[")+1,c.lastPos-1)}return b},getConfigedWidgetsByTemplateConfig:function(b){var c=[],d=C.template.widgetIdentification+"_config",a;f.forEach(b.configurationSettings,
function(b){f.forEach(b.fields,function(b){b.fieldName&&(a=C.template.getSearchRange(b.fieldName,d,"]"),0<=a.firstPos&&(b=C.template.getWidgetIdByKey(b.fieldName),-1===c.indexOf(b)&&c.push(b)))},this)},this);return c},mergeTemplateAppConfigToAppConfig:function(b,c,d){function a(b){var c=[];f.forEach(b,function(b){b&&c.push(b)},this);return c}var e=b.widgetOnScreen,n=b.portalUrl;c.values.webmap&&(b.map.itemId=c.values.webmap);d&&(b.map.mapOptions&&C.deleteMapOptions(b.map.mapOptions),b.map.portalUrl=
n,c.values.app_title||(c.values.app_title=d.title),c.values.app_subtitle||(c.values.app_subtitle=d.snippet));for(var t in c.values)"webmap"!==t&&C.template.setConfigValueWithId(b,t,c.values[t]);b.widgetPool.widgets=a(b.widgetPool.widgets);e.widgets=a(e.widgets);if(b.widgetPool.groups)for(c=0;c<b.widgetPool.groups.length;c++)b.widgetPool.groups[c].widgets=a(b.widgetPool.groups[c].widgets);if(e.groups)for(c=0;c<e.groups.length;c++)e.groups[c].widgets=a(e.groups[c].widgets);return b}};C.deleteMapOptions=
function(b){b&&(delete b.extent,delete b.lods,delete b.center,delete b.scale,delete b.zoom,delete b.maxScale,delete b.maxZoom,delete b.minScale,delete b.minZoom)};C.graphicsExtent=function(b,c){var d=null;try{0<b.length&&(d=K.graphicsExtent(b))&&"number"===typeof c&&0<c&&(d=d.expand(c))}catch(a){console.error(a)}return d};C.sanitizeHTML=function(b){return html_sanitize(b,function(b){return b},function(b){return b})};C.stripHTML=function(b){return!b?b:-1<b.indexOf("\x3c")&&-1<b.indexOf("\x3e")?b.replace(/<(?:.|\s)*?>/g,
""):b};C.removeSuffixSlashes=function(b){return b.replace(/\/*$/g,"")};C.getBestDisplayAttributes=function(b,c){var d={},a=null,e;for(e in b)a=C.getBestDisplayValue(e,b,c),d[e]=a;return d};C.getBestDisplayValue=function(b,c,d){var a="",e=null;p.isArrayLike(d)?e=C.getFieldInfoByFieldName(d,b):"object"===typeof d&&d.name===b&&(e=d);e&&(a=c[b],"esriFieldTypeDate"===e.type?a&&(b=new Date(parseInt(a,10)),a=C._tryLocaleDate(b)):"number"===typeof a&&(e.domain&&"codedValue"===e.domain.type?f.some(e.domain.codedValues,
function(b){if(b.code===a)return a=b.name,!0}):a=C._tryLocaleNumber(a)));if(null===a||void 0===a)a="";return a};C.getDefaultPortalFieldInfo=function(b){var c=b.name,c={fieldName:c,label:b.alias||c,tooltip:"",visible:!1,format:null,stringFieldOption:"textbox"};switch(b.type){case "esriFieldTypeSmallInteger":case "esriFieldTypeInteger":c.format={places:0,digitSeparator:!0};break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":c.format={places:2,digitSeparator:!0};break;case "esriFieldTypeDate":c.format=
{dateFormat:"longMonthDayYear"}}return c};C._tryLocaleNumber=function(b){var c=C.localizeNumber(b);if(null===c||void 0===c)c=b;return c};C._tryLocaleDate=function(b){var c=C.localizeDate(b);c||(c=b.toLocaleDateString());return c};C.getFieldInfoByFieldName=function(b,c){var d=null;b&&0<b.length&&f.some(b,p.hitch(this,function(b){return b.name===c?(d=b,!0):!1}));return d};C.containsNonLatinCharacter=function(b){for(var c=0;c<b.length;c++)if(255<b.charCodeAt(c))return!0;return!1};C.has=function(b){var c=
l(b);if(c)return c;if("ie"===b.toLowerCase()){b=0;var d=/MSIE (\d+\.\d+);/.test(navigator.userAgent),a=!!navigator.userAgent.match(/Trident\/7.0/),e=navigator.userAgent.indexOf("rv:11.0");d&&(b=Number(RegExp.$1));-1!==navigator.appVersion.indexOf("MSIE 10")&&(b=10);a&&-1!==e&&(b=11);return 11===b&&11||c}if("edge"===b.toLowerCase())return navigator.userAgent.split("Edge/")[1]||c};C.detectUserAgent=function(){var b={},c={},d=navigator.userAgent,a=navigator.platform,e=d.match(/Web[kK]it[\/]{0,1}([\d.]+)/),
n=d.match(/(Android);?[\s\/]+([\d.]+)?/),t=!!d.match(/\(Macintosh\; Intel /),g=d.match(/(iPad).*OS\s([\d_]+)/),s=d.match(/(iPod)(.*OS\s([\d_]+))?/),v=!g&&d.match(/(iPhone\sOS)\s([\d_]+)/),r=d.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),a=/Win\d{2}|Windows/.test(a),w=d.match(/Windows Phone ([\d.]+)/),u=r&&d.match(/TouchPad/),m=d.match(/Kindle\/([\d.]+)/),h=d.match(/Silk\/([\d._]+)/),k=d.match(/(BlackBerry).*Version\/([\d.]+)/),f=d.match(/(BB10).*Version\/([\d.]+)/),q=d.match(/(RIM\sTablet\sOS)\s([\d.]+)/),
z=d.match(/PlayBook/),l=d.match(/Chrome\/([\d.]+)/)||d.match(/CriOS\/([\d.]+)/),x=d.match(/Firefox\/([\d.]+)/),y=d.match(/\((?:Mobile|Tablet); rv:([\d.]+)\).*Firefox\/[\d.]+/),Q=d.match(/MSIE\s([\d.]+)/)||d.match(/Trident\/[\d](?=[^\?]+).*rv:([0-9.].)/),A=!l&&d.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/),B=A||d.match(/Version\/([\d.]+)([^S](Safari)|[^M]*(Mobile)[^S]*(Safari))/);c.webkit=!!e;c.webkit&&(c.version=e[1]);n&&(b.android=!0,b.version=n[2]);v&&!s&&(b.ios=b.iphone=!0,b.version=v[2].replace(/_/g,
"."));g&&(b.ios=b.ipad=!0,b.version=g[2].replace(/_/g,"."));s&&(b.ios=b.ipod=!0,b.version=s[3]?s[3].replace(/_/g,"."):null);w&&(b.wp=!0,b.version=w[1]);r&&(b.webos=!0,b.version=r[2]);u&&(b.touchpad=!0);k&&(b.blackberry=!0,b.version=k[2]);f&&(b.bb10=!0,b.version=f[2]);q&&(b.rimtabletos=!0,b.version=q[2]);z&&(c.playbook=!0);m&&(b.kindle=!0,b.version=m[1]);h&&(c.silk=!0,c.version=h[1]);!h&&(b.android&&d.match(/Kindle Fire/))&&(c.silk=!0);l&&(c.chrome=!0,c.version=l[1]);x&&(c.firefox=!0,c.version=x[1]);
y&&(b.firefoxos=!0,b.version=y[1]);Q&&(c.ie=!0,c.version=Q[1]);if(B&&(t||b.ios||a))c.safari=!0,b.ios||(c.version=B[1]);A&&(c.webview=!0);b.tablet=!(!g&&!z&&!(n&&!d.match(/Mobile/)||x&&d.match(/Tablet/)||Q&&!d.match(/Phone/)&&d.match(/Touch/)));b.phone=!(b.tablet||b.ipod||!n&&!v&&!r&&!k&&!f&&!(l&&d.match(/Android/)||l&&d.match(/CriOS\/([\d.]+)/)||x&&d.match(/Mobile/)||Q&&d.match(/Touch/)));return{os:b,browser:c}};C.isMobileUa=function(){var b=C.detectUserAgent();return!0===b.os.phone||!0===b.os.tablet?
!0:!1};C.getObjectIdField=function(b){if(b.objectIdField)return b.objectIdField;b=b.fields;for(var c=0;c<b.length;c++){var d=b[c];if("esriFieldTypeOID"===d.type)return d.name}return null};C.isNeedHttpsButNot=function(){return window.hasOwnProperty("isSecureContext")&&!window.isSecureContext?!0:!1};C.toFeatureSet=function(b){var c=new H;"[object Object]"===Object.prototype.toString.call(b)&&(b=[b]);c.features=b;if(0<b.length){var d;f.some(b,function(b){if(b.geometry)return d=b,!0});if(d){b=d.getLayer();
var a={};b&&(c.displayFieldName=b.displayField,f.forEach(b.fields,p.hitch(this,function(b){var c=b.name;a[c]=b.alias||c})),c.fieldAliases=a);c.geometryType=d.geometry.type;c.spatialReference=d.geometry.spatialReference}}return c};C.showValidationErrorTipForFormDijit=function(b){try{!b.validate()&&b.domNode&&b.focusNode&&(b.focusNode.focus(),setTimeout(p.hitch(this,function(){b.focusNode.blur()}),100))}catch(c){console.error(c)}};C.getFeatureLayerDefinition=function(b){var c=null,d=b.graphics;b.graphics=
[];var a=b.toJson();b.graphics=d;a&&(c=a.layerDefinition);return c};C.simulateClickEvent=function(b){if(l("safari")){var c=document.createEvent("MouseEvents");c.initEvent("click",!0,!0);b.dispatchEvent(c)}else b.click()};C.getFeatureSetByLayerAndFeatures=function(b,c){var d=new H;d.fields=p.clone(b.fields);d.features=c;d.geometryType=b.geometryType;d.fieldAliases={};f.forEach(d.fields,p.hitch(this,function(b){var c=b.name;d.fieldAliases[c]=b.alias||c}));return d};C.featureAction=function(){return{zoomTo:function(b,
c,d){d||(d={});d.hasOwnProperty("extentFactor")||(d.extentFactor=1.2);if(b&&c&&0<c.length){var a=f.every(c,function(b){return b&&b.spatialReference&&b.type});if(f.every(c,function(b){return b&&b.geometry&&b.geometry.spatialReference&&b.geometry.type})||a)a&&(c=f.map(c,function(b){return{geometry:b}})),1===c.length&&"point"===c[0].type?(d=15,d=-1<b.getMaxZoom()?b.getMaxZoom():0.1,b.centerAndZoom(c[0].geometry,d)):(c=K.graphicsExtent(c),b.setExtent(c.expand(d.extentFactor)))}},flash:function(b,c){function d(b,
c){f.forEach(e,function(d,a){d.setSymbol(c?b:t[a]||g)})}function a(b){return function(){setTimeout(function(){d(s,!0);e[0]&&c&&c.redraw();setTimeout(function(){d(null,!1);e[0]&&c&&c.redraw();b()},200)},200)}}if(f.every(b||[],function(b){return b&&b.geometry})){var e=b,n=e[0],t=f.map(e,function(b){return b.symbol}),g=n.symbol||p.getObject("renderer.symbol",!1,c),s=null;c&&"esriGeometryPoint"===c.geometryType?s=new I(require.toUrl("jimu")+"/images/flash.gif",20,20):(s=p.clone(g))&&(s.outline?s.outline.setColor("#ffc500"):
s.setColor("#ffc500"));n&&(g&&s&&c)&&("esriGeometryPoint"===c.geometryType?(d(s,!0),c.redraw(),setTimeout(function(){d(null,!1);c.redraw()},2E3)):a(a(a(function(){})))())}},panTo:function(b,c){if(f.every(c||[],function(b){return b&&b.geometry})){var d;0<c.length?d=K.graphicsExtent(c).getCenter():(d=c[0].geometry,d="polyline"===d.type||"polygon"===d.type?d.getExtent().getCenter():"extent"===d.type?d.getCenter():"multipoint"===d.type?1<d.points.length?d.getExtent().getCenter():d.getPoint(0):d);b.centerAt(d)}},
showPopup:function(b,c){if(f.every(c||[],function(b){return b&&b.geometry})){var d=b.infoWindow;d.setFeatures(c);var a=c[0];"point"===a.geometry.type?d.show(a.geometry,{closetFirst:!0}):d.show(a.geometry.getExtent().getCenter(),{closetFirst:!0})}}}}();return C})},"dojo/NodeList-traverse":function(){define(["./query","./_base/lang","./_base/array"],function(p,f,a){var l=p.NodeList;f.extend(l,{_buildArrayFromCallback:function(a){for(var h=[],f=0;f<this.length;f++){var m=a.call(this[f],this[f],h);m&&
(h=h.concat(m))}return h},_getUniqueAsNodeList:function(k){for(var h=[],f=0,m;m=k[f];f++)1==m.nodeType&&-1==a.indexOf(h,m)&&h.push(m);return this._wrap(h,null,this._NodeListCtor)},_getUniqueNodeListWithParent:function(a,h){var f=this._getUniqueAsNodeList(a),f=h?p._filterResult(f,h):f;return f._stash(this)},_getRelatedUniqueNodes:function(a,h){return this._getUniqueNodeListWithParent(this._buildArrayFromCallback(h),a)},children:function(a){return this._getRelatedUniqueNodes(a,function(a,k){return f._toArray(a.childNodes)})},
closest:function(a,h){return this._getRelatedUniqueNodes(null,function(f,m){do if(p._filterResult([f],a,h).length)return f;while(f!=h&&(f=f.parentNode)&&1==f.nodeType);return null})},parent:function(a){return this._getRelatedUniqueNodes(a,function(a,k){return a.parentNode})},parents:function(a){return this._getRelatedUniqueNodes(a,function(a,k){for(var m=[];a.parentNode;)a=a.parentNode,m.push(a);return m})},siblings:function(a){return this._getRelatedUniqueNodes(a,function(a,k){for(var m=[],g=a.parentNode&&
a.parentNode.childNodes,e=0;e<g.length;e++)g[e]!=a&&m.push(g[e]);return m})},next:function(a){return this._getRelatedUniqueNodes(a,function(a,k){for(var m=a.nextSibling;m&&1!=m.nodeType;)m=m.nextSibling;return m})},nextAll:function(a){return this._getRelatedUniqueNodes(a,function(a,k){for(var m=[],g=a;g=g.nextSibling;)1==g.nodeType&&m.push(g);return m})},prev:function(a){return this._getRelatedUniqueNodes(a,function(a,k){for(var m=a.previousSibling;m&&1!=m.nodeType;)m=m.previousSibling;return m})},
prevAll:function(a){return this._getRelatedUniqueNodes(a,function(a,k){for(var m=[],g=a;g=g.previousSibling;)1==g.nodeType&&m.push(g);return m})},andSelf:function(){return this.concat(this._parent)},first:function(){return this._wrap(this[0]&&[this[0]]||[],this)},last:function(){return this._wrap(this.length?[this[this.length-1]]:[],this)},even:function(){return this.filter(function(a,h){return 0!=h%2})},odd:function(){return this.filter(function(a,h){return 0==h%2})}});return l})},"dojo/number":function(){define(["./_base/lang",
"./i18n","./i18n!./cldr/nls/number","./string","./regexp"],function(p,f,a,l,k){var h={};p.setObject("dojo.number",h);h.format=function(a,g){g=p.mixin({},g||{});var e=f.normalizeLocale(g.locale),e=f.getLocalization("dojo.cldr","number",e);g.customs=e;e=g.pattern||e[(g.type||"decimal")+"Format"];return isNaN(a)||Infinity==Math.abs(a)?null:h._applyPattern(a,e,g)};h._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;h._applyPattern=function(a,g,e){e=e||{};var c=e.customs.group,d=e.customs.decimal;g=g.split(";");
var r=g[0];g=g[0>a?1:0]||"-"+r;if(-1!=g.indexOf("%"))a*=100;else if(-1!=g.indexOf("\u2030"))a*=1E3;else if(-1!=g.indexOf("\u00a4"))c=e.customs.currencyGroup||c,d=e.customs.currencyDecimal||d,g=g.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/,function(c,d,b,a){c=e[["symbol","currency","displayName"][b.length-1]]||e.currency||"";return!c?"":d+c+a});else if(-1!=g.indexOf("E"))throw Error("exponential notation not supported");var u=h._numberPatternRE,r=r.match(u);if(!r)throw Error("unable to find a number expression in pattern: "+
g);!1===e.fractional&&(e.places=0);return g.replace(u,h._formatAbsolute(a,r[0],{decimal:d,group:c,places:e.places,round:e.round}))};h.round=function(a,g,e){e=10/(e||10);return(e*+a).toFixed(g)/e};if(0==(0.9).toFixed()){var q=h.round;h.round=function(a,g,e){var c=Math.pow(10,-g||0),d=Math.abs(a);if(!a||d>=c)c=0;else if(d/=c,0.5>d||0.95<=d)c=0;return q(a,g,e)+(0<a?c:-c)}}h._formatAbsolute=function(a,g,e){e=e||{};!0===e.places&&(e.places=0);Infinity===e.places&&(e.places=6);g=g.split(".");var c="string"==
typeof e.places&&e.places.indexOf(","),d=e.places;c?d=e.places.substring(c+1):0<=d||(d=(g[1]||[]).length);0>e.round||(a=h.round(a,d,e.round));a=String(Math.abs(a)).split(".");var r=a[1]||"";g[1]||e.places?(c&&(e.places=e.places.substring(0,c)),c=void 0!==e.places?e.places:g[1]&&g[1].lastIndexOf("0")+1,c>r.length&&(a[1]=l.pad(r,c,"0",!0)),d<r.length&&(a[1]=r.substr(0,d))):a[1]&&a.pop();d=g[0].replace(",","");c=d.indexOf("0");-1!=c&&(c=d.length-c,c>a[0].length&&(a[0]=l.pad(a[0],c)),-1==d.indexOf("#")&&
(a[0]=a[0].substr(a[0].length-c)));var d=g[0].lastIndexOf(","),u,s;-1!=d&&(u=g[0].length-d-1,g=g[0].substr(0,d),d=g.lastIndexOf(","),-1!=d&&(s=g.length-d-1));g=[];for(d=a[0];d;)c=d.length-u,g.push(0<c?d.substr(c):d),d=0<c?d.slice(0,c):"",s&&(u=s,delete s);a[0]=g.reverse().join(e.group||",");return a.join(e.decimal||".")};h.regexp=function(a){return h._parseInfo(a).regexp};h._parseInfo=function(a){a=a||{};var g=f.normalizeLocale(a.locale),g=f.getLocalization("dojo.cldr","number",g),e=a.pattern||g[(a.type||
"decimal")+"Format"],c=g.group,d=g.decimal,r=1;if(-1!=e.indexOf("%"))r/=100;else if(-1!=e.indexOf("\u2030"))r/=1E3;else{var u=-1!=e.indexOf("\u00a4");u&&(c=g.currencyGroup||c,d=g.currencyDecimal||d)}g=e.split(";");1==g.length&&g.push("-"+g[0]);g=k.buildGroupRE(g,function(e){e="(?:"+k.escapeString(e,".")+")";return e.replace(h._numberPatternRE,function(e){var b={signed:!1,separator:a.strict?c:[c,""],fractional:a.fractional,decimal:d,exponent:!1};e=e.split(".");var g=a.places;1==e.length&&1!=r&&(e[1]=
"###");1==e.length||0===g?b.fractional=!1:(void 0===g&&(g=a.pattern?e[1].lastIndexOf("0")+1:Infinity),g&&void 0==a.fractional&&(b.fractional=!0),!a.places&&g<e[1].length&&(g+=","+e[1].length),b.places=g);e=e[0].split(",");1<e.length&&(b.groupSize=e.pop().length,1<e.length&&(b.groupSize2=e.pop().length));return"("+h._realNumberRegexp(b)+")"})},!0);u&&(g=g.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(c,d,b,e){c=k.escapeString(a[["symbol","currency","displayName"][b.length-1]]||a.currency||
"");if(!c)return"";d=d?"[\\s\\xa0]":"";e=e?"[\\s\\xa0]":"";return!a.strict?(d&&(d+="*"),e&&(e+="*"),"(?:"+d+c+e+")?"):d+c+e}));return{regexp:g.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:c,decimal:d,factor:r}};h.parse=function(a,g){var e=h._parseInfo(g),c=RegExp("^"+e.regexp+"$").exec(a);if(!c)return NaN;var d=c[1];if(!c[1]){if(!c[2])return NaN;d=c[2];e.factor*=-1}d=d.replace(RegExp("["+e.group+"\\s\\xa0]","g"),"").replace(e.decimal,".");return d*e.factor};h._realNumberRegexp=function(a){a=a||{};"places"in
a||(a.places=Infinity);"string"!=typeof a.decimal&&(a.decimal=".");if(!("fractional"in a)||/^0/.test(a.places))a.fractional=[!0,!1];"exponent"in a||(a.exponent=[!0,!1]);"eSigned"in a||(a.eSigned=[!0,!1]);var g=h._integerRegexp(a),e=k.buildGroupRE(a.fractional,function(c){var e="";c&&0!==a.places&&(e="\\"+a.decimal,e=Infinity==a.places?"(?:"+e+"\\d+)?":e+("\\d{"+a.places+"}"));return e},!0),c=k.buildGroupRE(a.exponent,function(c){return c?"([eE]"+h._integerRegexp({signed:a.eSigned})+")":""}),g=g+e;
e&&(g="(?:(?:"+g+")|(?:"+e+"))");return g+c};h._integerRegexp=function(a){a=a||{};"signed"in a||(a.signed=[!0,!1]);"separator"in a?"groupSize"in a||(a.groupSize=3):a.separator="";var g=k.buildGroupRE(a.signed,function(c){return c?"[-+]":""},!0),e=k.buildGroupRE(a.separator,function(c){if(!c)return"(?:\\d+)";c=k.escapeString(c);" "==c?c="\\s":"\u00a0"==c&&(c="\\s\\xa0");var d=a.groupSize,e=a.groupSize2;return e?(c="(?:0|[1-9]\\d{0,"+(e-1)+"}(?:["+c+"]\\d{"+e+"})*["+c+"]\\d{"+d+"})",0<d-e?"(?:"+c+"|(?:0|[1-9]\\d{0,"+
(d-1)+"}))":c):"(?:0|[1-9]\\d{0,"+(d-1)+"}(?:["+c+"]\\d{"+d+"})*)"},!0);return g+e};return h})},"dojo/i18n":function(){define("./_base/kernel require ./has ./_base/array ./_base/config ./_base/lang ./_base/xhr ./json module".split(" "),function(p,f,a,l,k,h,q,m,g){a.add("dojo-preload-i18n-Api",1);q=p.i18n={};var e=/(^.*(^|\/)nls)(\/|$)([^\/]*)\/?([^\/]*)/,c=function(b,c,d,a){var e=[d+a];c=c.split("-");for(var n="",g=0;g<c.length;g++)if(n+=(n?"-":"")+c[g],!b||b[n])e.push(d+n+"/"+a),e.specificity=n;
return e},d={},r=function(b,c,d){d=d?d.toLowerCase():p.locale;b=b.replace(/\./g,"/");c=c.replace(/\./g,"/");return/root/i.test(d)?b+"/nls/"+c:b+"/nls/"+d+"/"+c},u=p.getL10nName=function(b,c,d){return g.id+"!"+r(b,c,d)},s=function(b,a,e,n,g,t){b([a],function(s){var v=h.clone(s.root||s.ROOT),r=c(!s._v1x&&s,g,e,n);b(r,function(){for(var b=1;b<r.length;b++)v=h.mixin(h.clone(v),arguments[b]);d[a+"/"+g]=v;v.$locale=r.specificity;t()})})},t=function(b){var c=k.extraLocale||[],c=h.isArray(c)?c:[c];c.push(b);
return c},b=function(b,c,g){if(a("dojo-preload-i18n-Api")){var v=b.split("*"),r="preload"==v[1];r&&(d[b]||(d[b]=1,x(v[2],m.parse(v[3]),1,c)),g(1));if(!(v=r))n&&w.push([b,c,g]),v=n;if(v)return}b=e.exec(b);var u=b[1]+"/",k=b[5]||b[4],f=u+k,v=(b=b[5]&&b[4])||p.locale||"",q=f+"/"+v;b=b?[v]:t(v);var K=b.length,J=function(){--K||g(h.delegate(d[q]))};l.forEach(b,function(b){var e=f+"/"+b;a("dojo-preload-i18n-Api")&&z(e);d[e]?J():s(c,f,u,k,b,J)})};a("dojo-preload-i18n-Api");var v=q.normalizeLocale=function(b){b=
b?b.toLowerCase():p.locale;return"root"==b?"ROOT":b},n=0,w=[],x=q._preloadLocalizations=function(c,a,e,g){function t(b,c){g([b],c)}function s(b,c){for(var d=b.split("-");d.length;){if(c(d.join("-")))return;d.pop()}c("ROOT")}function r(){for(--n;!n&&w.length;)b.apply(null,w.shift())}function u(b){b=v(b);s(b,function(e){if(0<=l.indexOf(a,e)){var v=c.replace(/\./g,"/")+"_"+e;n++;t(v,function(c){for(var a in c){var t=c[a],v=a.match(/(.+)\/([^\/]+)$/),u;if(v&&(u=v[2],v=v[1]+"/",t._localized)){var w;if("ROOT"===
e){var m=w=t._localized;delete t._localized;m.root=t;d[f.toAbsMid(a)]=m}else w=t._localized,d[f.toAbsMid(v+u+"/"+e)]=t;e!==b&&function(c,a,e,t){var v=[],u=[];s(b,function(b){t[b]&&(v.push(f.toAbsMid(c+b+"/"+a)),u.push(f.toAbsMid(c+a+"/"+b)))});v.length?(n++,g(v,function(){for(var n=v.length-1;0<=n;n--)e=h.mixin(h.clone(e),arguments[n]),d[u[n]]=e;d[f.toAbsMid(c+a+"/"+b)]=h.clone(e);r()})):d[f.toAbsMid(c+a+"/"+b)]=e}(v,u,t,w)}}r()});return!0}return!1})}g=g||f;u();l.forEach(p.config.extraLocale,u)},
z=function(){};new Function("__bundle","__checkForLegacyModules","__mid","__amdValue","var define \x3d function(mid, factory){define.called \x3d 1; __amdValue.result \x3d factory || mid;},\t   require \x3d function(){define.called \x3d 1;};try{define.called \x3d 0;eval(__bundle);if(define.called\x3d\x3d1)return __amdValue;if((__checkForLegacyModules \x3d __checkForLegacyModules(__mid)))return __checkForLegacyModules;}catch(e){}try{return eval('('+__bundle+')');}catch(e){return e;}");z=function(b){for(var c,
a=b.split("/"),e=p.global[a[0]],n=1;e&&n<a.length-1;e=e[a[n++]]);e&&((c=e[a[n]])||(c=e[a[n].replace(/-/g,"_")]),c&&(d[b]=c));return c};q.getLocalization=function(c,d,a){var e;c=r(c,d,a);b(c,f,function(b){e=b});return e};return h.mixin(q,{dynamic:!0,normalize:function(b,c){return/^\./.test(b)?c(b):b},load:b,cache:d,getL10nName:u})})},"dojo/string":function(){define(["./_base/kernel","./_base/lang"],function(p,f){var a=/[&<>'"\/]/g,l={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;",
"'":"\x26#x27;","/":"\x26#x2F;"},k={};f.setObject("dojo.string",k);k.escape=function(h){return!h?"":h.replace(a,function(a){return l[a]})};k.rep=function(a,k){if(0>=k||!a)return"";for(var m=[];;){k&1&&m.push(a);if(!(k>>=1))break;a+=a}return m.join("")};k.pad=function(a,f,m,g){m||(m="0");a=String(a);f=k.rep(m,Math.ceil((f-a.length)/m.length));return g?a+f:f+a};k.substitute=function(a,k,m,g){g=g||p.global;m=m?f.hitch(g,m):function(a){return a};return a.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,
function(a,c,d){if(""==c)return"$";a=f.getObject(c,!1,k);d&&(a=f.getObject(d,!1,g).call(g,a,c));return m(a,c).toString()})};k.trim=String.prototype.trim?f.trim:function(a){a=a.replace(/^\s+/,"");for(var k=a.length-1;0<=k;k--)if(/\S/.test(a.charAt(k))){a=a.substring(0,k+1);break}return a};return k})},"dojo/date/locale":function(){define("../_base/lang ../_base/array ../date ../cldr/supplemental ../i18n ../regexp ../string ../i18n!../cldr/nls/gregorian module".split(" "),function(p,f,a,l,k,h,q,m,g){function e(c,
b,a,d){return d.replace(/([a-z])\1*/ig,function(e){var g,s,u=e.charAt(0);e=e.length;var h=["abbr","wide","narrow"];switch(u){case "G":g=b[4>e?"eraAbbr":"eraNames"][0>c.getFullYear()?0:1];break;case "y":g=c.getFullYear();switch(e){case 1:break;case 2:if(!a.fullYear){g=String(g);g=g.substr(g.length-2);break}default:s=!0}break;case "Q":case "q":g=Math.ceil((c.getMonth()+1)/3);s=!0;break;case "M":case "L":g=c.getMonth();3>e?(g+=1,s=!0):(u=["months","L"==u?"standAlone":"format",h[e-3]].join("-"),g=b[u][g]);
break;case "w":g=r._getWeekOfYear(c,0);s=!0;break;case "d":g=c.getDate();s=!0;break;case "D":g=r._getDayOfYear(c);s=!0;break;case "e":case "c":if(g=c.getDay(),2>e){g=(g-l.getFirstDayOfWeek(a.locale)+8)%7;break}case "E":g=c.getDay();3>e?(g+=1,s=!0):(u=["days","c"==u?"standAlone":"format",h[e-3]].join("-"),g=b[u][g]);break;case "a":u=12>c.getHours()?"am":"pm";g=a[u]||b["dayPeriods-format-wide-"+u];break;case "h":case "H":case "K":case "k":s=c.getHours();switch(u){case "h":g=s%12||12;break;case "H":g=
s;break;case "K":g=s%12;break;case "k":g=s||24}s=!0;break;case "m":g=c.getMinutes();s=!0;break;case "s":g=c.getSeconds();s=!0;break;case "S":g=Math.round(c.getMilliseconds()*Math.pow(10,e-3));s=!0;break;case "v":case "z":if(g=r._getZone(c,!0,a))break;e=4;case "Z":u=r._getZone(c,!1,a);u=[0>=u?"+":"-",q.pad(Math.floor(Math.abs(u)/60),2),q.pad(Math.abs(u)%60,2)];4==e&&(u.splice(0,0,"GMT"),u.splice(3,0,":"));g=u.join("");break;default:throw Error("dojo.date.locale.format: invalid pattern char: "+d);}s&&
(g=q.pad(g,e));return g})}function c(c,b,a,d){var e=function(b){return b};b=b||e;a=a||e;d=d||e;var g=c.match(/(''|[^'])+/g),s="'"==c.charAt(0);f.forEach(g,function(c,d){c?(g[d]=(s?a:b)(c.replace(/''/g,"'")),s=!s):g[d]=""});return d(g.join(""))}function d(c,b,a,d){d=h.escapeString(d);a.strict||(d=d.replace(" a"," ?a"));return d.replace(/([a-z])\1*/ig,function(d){var e;e=d.charAt(0);var n=d.length,g="",s="";a.strict?(1<n&&(g="0{"+(n-1)+"}"),2<n&&(s="0{"+(n-2)+"}")):(g="0?",s="0{0,2}");switch(e){case "y":e=
"\\d{2,4}";break;case "M":case "L":e=2<n?"\\S+?":"1[0-2]|"+g+"[1-9]";break;case "D":e="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|"+g+"[1-9][0-9]|"+s+"[1-9]";break;case "d":e="3[01]|[12]\\d|"+g+"[1-9]";break;case "w":e="[1-4][0-9]|5[0-3]|"+g+"[1-9]";break;case "E":case "e":case "c":e=".+?";break;case "h":e="1[0-2]|"+g+"[1-9]";break;case "k":e="1[01]|"+g+"\\d";break;case "H":e="1\\d|2[0-3]|"+g+"\\d";break;case "K":e="1\\d|2[0-4]|"+g+"[1-9]";break;case "m":case "s":e="[0-5]\\d";break;case "S":e="\\d{"+n+"}";
break;case "a":n=a.am||b["dayPeriods-format-wide-am"];g=a.pm||b["dayPeriods-format-wide-pm"];e=n+"|"+g;a.strict||(n!=n.toLowerCase()&&(e+="|"+n.toLowerCase()),g!=g.toLowerCase()&&(e+="|"+g.toLowerCase()),-1!=e.indexOf(".")&&(e+="|"+e.replace(/\./g,"")));e=e.replace(/\./g,"\\.");break;default:e=".*"}c&&c.push(d);return"("+e+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var r={};p.setObject(g.id.replace(/\//g,"."),r);r._getZone=function(c,b,d){return b?a.getTimezoneName(c):c.getTimezoneOffset()};r.format=
function(a,b){b=b||{};var d=k.normalizeLocale(b.locale),n=b.formatLength||"short",d=r._getGregorianBundle(d),g=[],s=p.hitch(this,e,a,d,b);if("year"==b.selector)return c(d["dateFormatItem-yyyy"]||"yyyy",s);var u;"date"!=b.selector&&(u=b.timePattern||d["timeFormat-"+n])&&g.push(c(u,s));"time"!=b.selector&&(u=b.datePattern||d["dateFormat-"+n])&&g.push(c(u,s));return 1==g.length?g[0]:d["dateTimeFormat-"+n].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(b,c){return g[c]})};r.regexp=function(c){return r._parseInfo(c).regexp};
r._parseInfo=function(a){a=a||{};var b=k.normalizeLocale(a.locale),b=r._getGregorianBundle(b),e=a.formatLength||"short",n=a.datePattern||b["dateFormat-"+e],g=a.timePattern||b["timeFormat-"+e],e="date"==a.selector?n:"time"==a.selector?g:b["dateTimeFormat-"+e].replace(/\{(\d+)\}/g,function(b,c){return[g,n][c]}),s=[];return{regexp:c(e,p.hitch(this,d,s,b,a)),tokens:s,bundle:b}};r.parse=function(c,b){var d=/[\u200E\u200F\u202A\u202E]/g,e=r._parseInfo(b),g=e.tokens,s=e.bundle,d=RegExp("^"+e.regexp.replace(d,
"")+"$",e.strict?"":"i").exec(c&&c.replace(d,""));if(!d)return null;var u=["abbr","wide","narrow"],h=[1970,0,1,0,0,0,0],m="",d=f.every(d,function(c,d){if(!d)return!0;var a=g[d-1],e=a.length,a=a.charAt(0);switch(a){case "y":if(2!=e&&b.strict)h[0]=c;else if(100>c)c=Number(c),a=""+(new Date).getFullYear(),e=100*a.substring(0,2),a=Math.min(Number(a.substring(2,4))+20,99),h[0]=c<a?e+c:e-100+c;else{if(b.strict)return!1;h[0]=c}break;case "M":case "L":if(2<e){if(e=s["months-"+("L"==a?"standAlone":"format")+
"-"+u[e-3]].concat(),b.strict||(c=c.replace(".","").toLowerCase(),e=f.map(e,function(b){return b.replace(".","").toLowerCase()})),c=f.indexOf(e,c),-1==c)return!1}else c--;h[1]=c;break;case "E":case "e":case "c":e=s["days-"+("c"==a?"standAlone":"format")+"-"+u[e-3]].concat();b.strict||(c=c.toLowerCase(),e=f.map(e,function(b){return b.toLowerCase()}));c=f.indexOf(e,c);if(-1==c)return!1;break;case "D":h[1]=0;case "d":h[2]=c;break;case "a":e=b.am||s["dayPeriods-format-wide-am"];a=b.pm||s["dayPeriods-format-wide-pm"];
if(!b.strict){var n=/\./g;c=c.replace(n,"").toLowerCase();e=e.replace(n,"").toLowerCase();a=a.replace(n,"").toLowerCase()}if(b.strict&&c!=e&&c!=a)return!1;m=c==a?"p":c==e?"a":"";break;case "K":24==c&&(c=0);case "h":case "H":case "k":if(23<c)return!1;h[3]=c;break;case "m":h[4]=c;break;case "s":h[5]=c;break;case "S":h[6]=c}return!0}),e=+h[3];"p"===m&&12>e?h[3]=e+12:"a"===m&&12==e&&(h[3]=0);e=new Date(h[0],h[1],h[2],h[3],h[4],h[5],h[6]);b.strict&&e.setFullYear(h[0]);var k=g.join(""),q=-1!=k.indexOf("d"),
k=-1!=k.indexOf("M");if(!d||k&&e.getMonth()>h[1]||q&&e.getDate()>h[2])return null;if(k&&e.getMonth()<h[1]||q&&e.getDate()<h[2])e=a.add(e,"hour",1);return e};var u=[],s={};r.addCustomFormats=function(c,b){u.push({pkg:c,name:b});s={}};r._getGregorianBundle=function(c){if(s[c])return s[c];var b={};f.forEach(u,function(a){a=k.getLocalization(a.pkg,a.name,c);b=p.mixin(b,a)},this);return s[c]=b};r.addCustomFormats(g.id.replace(/\/date\/locale$/,".cldr"),"gregorian");r.getNames=function(c,b,a,d){var e;d=
r._getGregorianBundle(d);c=[c,a,b];"standAlone"==a&&(a=c.join("-"),e=d[a],1==e[0]&&(e=void 0));c[1]="format";return(e||d[c.join("-")]).concat()};r.isWeekend=function(c,b){var a=l.getWeekend(b),d=(c||new Date).getDay();a.end<a.start&&(a.end+=7,d<a.start&&(d+=7));return d>=a.start&&d<=a.end};r._getDayOfYear=function(c){return a.difference(new Date(c.getFullYear(),0,1,c.getHours()),c)+1};r._getWeekOfYear=function(c,b){1==arguments.length&&(b=0);var a=(new Date(c.getFullYear(),0,1)).getDay(),d=Math.floor((r._getDayOfYear(c)+
(a-b+7)%7-1)/7);a==b&&d++;return d};return r})},"dojo/date":function(){define(["./has","./_base/lang"],function(p,f){var a={getDaysInMonth:function(f){var k=f.getMonth();return 1==k&&a.isLeapYear(f)?29:[31,28,31,30,31,30,31,31,30,31,30,31][k]},isLeapYear:function(a){a=a.getFullYear();return!(a%400)||!(a%4)&&!!(a%100)},getTimezoneName:function(a){var k=a.toString(),h="",f=k.indexOf("(");if(-1<f)h=k.substring(++f,k.indexOf(")"));else if(f=/([A-Z\/]+) \d{4}$/,k=k.match(f))h=k[1];else if(k=a.toLocaleString(),
f=/ ([A-Z\/]+)$/,k=k.match(f))h=k[1];return"AM"==h||"PM"==h?"":h},compare:function(a,k,h){a=new Date(+a);k=new Date(+(k||new Date));"date"==h?(a.setHours(0,0,0,0),k.setHours(0,0,0,0)):"time"==h&&(a.setFullYear(0,0,0),k.setFullYear(0,0,0));return a>k?1:a<k?-1:0},add:function(a,k,h){var f=new Date(+a),m=!1,g="Date";switch(k){case "day":break;case "weekday":var e;(k=h%5)?e=parseInt(h/5):(k=0<h?5:-5,e=0<h?(h-5)/5:(h+5)/5);var c=a.getDay(),d=0;6==c&&0<h?d=1:0==c&&0>h&&(d=-1);c+=k;if(0==c||6==c)d=0<h?2:
-2;h=7*e+k+d;break;case "year":g="FullYear";m=!0;break;case "week":h*=7;break;case "quarter":h*=3;case "month":m=!0;g="Month";break;default:g="UTC"+k.charAt(0).toUpperCase()+k.substring(1)+"s"}if(g)f["set"+g](f["get"+g]()+h);m&&f.getDate()<a.getDate()&&f.setDate(0);return f},difference:function(f,k,h){k=k||new Date;h=h||"day";var q=k.getFullYear()-f.getFullYear(),m=1;switch(h){case "quarter":f=f.getMonth();k=k.getMonth();f=Math.floor(f/3)+1;k=Math.floor(k/3)+1;m=k+4*q-f;break;case "weekday":q=Math.round(a.difference(f,
k,"day"));h=parseInt(a.difference(f,k,"week"));m=q%7;if(0==m)q=5*h;else{var g=0,e=f.getDay();k=k.getDay();h=parseInt(q/7);m=q%7;f=new Date(f);f.setDate(f.getDate()+7*h);f=f.getDay();if(0<q)switch(!0){case 6==e:g=-1;break;case 0==e:g=0;break;case 6==k:g=-1;break;case 0==k:g=-2;break;case 5<f+m:g=-2}else if(0>q)switch(!0){case 6==e:g=0;break;case 0==e:g=1;break;case 6==k:g=2;break;case 0==k:g=1;break;case 0>f+m:g=2}q=q+g-2*h}m=q;break;case "year":m=q;break;case "month":m=k.getMonth()-f.getMonth()+12*
q;break;case "week":m=parseInt(a.difference(f,k,"day")/7);break;case "day":m/=24;case "hour":m/=60;case "minute":m/=60;case "second":m/=1E3;case "millisecond":m*=k.getTime()-f.getTime()}return Math.round(m)}};f.mixin(f.getObject("dojo.date",!0),a);return a})},"dojo/cldr/supplemental":function(){define(["../_base/lang","../i18n"],function(p,f){var a={};p.setObject("dojo.cldr.supplemental",a);a.getFirstDayOfWeek=function(f){f={bd:5,mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,iq:6,ir:6,jo:6,kw:6,ly:6,ma:6,om:6,
qa:6,sa:6,sd:6,sy:6,ye:6,ag:0,ar:0,as:0,au:0,br:0,bs:0,bt:0,bw:0,by:0,bz:0,ca:0,cn:0,co:0,dm:0,"do":0,et:0,gt:0,gu:0,hk:0,hn:0,id:0,ie:0,il:0,"in":0,jm:0,jp:0,ke:0,kh:0,kr:0,la:0,mh:0,mm:0,mo:0,mt:0,mx:0,mz:0,ni:0,np:0,nz:0,pa:0,pe:0,ph:0,pk:0,pr:0,py:0,sg:0,sv:0,th:0,tn:0,tt:0,tw:0,um:0,us:0,ve:0,vi:0,ws:0,za:0,zw:0}[a._region(f)];return void 0===f?1:f};a._region=function(a){a=f.normalizeLocale(a);a=a.split("-");var k=a[1];k?4==k.length&&(k=a[2]):k={aa:"et",ab:"ge",af:"za",ak:"gh",am:"et",ar:"eg",
as:"in",av:"ru",ay:"bo",az:"az",ba:"ru",be:"by",bg:"bg",bi:"vu",bm:"ml",bn:"bd",bo:"cn",br:"fr",bs:"ba",ca:"es",ce:"ru",ch:"gu",co:"fr",cr:"ca",cs:"cz",cv:"ru",cy:"gb",da:"dk",de:"de",dv:"mv",dz:"bt",ee:"gh",el:"gr",en:"us",es:"es",et:"ee",eu:"es",fa:"ir",ff:"sn",fi:"fi",fj:"fj",fo:"fo",fr:"fr",fy:"nl",ga:"ie",gd:"gb",gl:"es",gn:"py",gu:"in",gv:"gb",ha:"ng",he:"il",hi:"in",ho:"pg",hr:"hr",ht:"ht",hu:"hu",hy:"am",ia:"fr",id:"id",ig:"ng",ii:"cn",ik:"us","in":"id",is:"is",it:"it",iu:"ca",iw:"il",ja:"jp",
ji:"ua",jv:"id",jw:"id",ka:"ge",kg:"cd",ki:"ke",kj:"na",kk:"kz",kl:"gl",km:"kh",kn:"in",ko:"kr",ks:"in",ku:"tr",kv:"ru",kw:"gb",ky:"kg",la:"va",lb:"lu",lg:"ug",li:"nl",ln:"cd",lo:"la",lt:"lt",lu:"cd",lv:"lv",mg:"mg",mh:"mh",mi:"nz",mk:"mk",ml:"in",mn:"mn",mo:"ro",mr:"in",ms:"my",mt:"mt",my:"mm",na:"nr",nb:"no",nd:"zw",ne:"np",ng:"na",nl:"nl",nn:"no",no:"no",nr:"za",nv:"us",ny:"mw",oc:"fr",om:"et",or:"in",os:"ge",pa:"in",pl:"pl",ps:"af",pt:"br",qu:"pe",rm:"ch",rn:"bi",ro:"ro",ru:"ru",rw:"rw",sa:"in",
sd:"in",se:"no",sg:"cf",si:"lk",sk:"sk",sl:"si",sm:"ws",sn:"zw",so:"so",sq:"al",sr:"rs",ss:"za",st:"za",su:"id",sv:"se",sw:"tz",ta:"in",te:"in",tg:"tj",th:"th",ti:"et",tk:"tm",tl:"ph",tn:"za",to:"to",tr:"tr",ts:"za",tt:"ru",ty:"pf",ug:"cn",uk:"ua",ur:"pk",uz:"uz",ve:"za",vi:"vn",wa:"be",wo:"sn",xh:"za",yi:"il",yo:"ng",za:"cn",zh:"cn",zu:"za",ace:"id",ady:"ru",agq:"cm",alt:"ru",amo:"ng",asa:"tz",ast:"es",awa:"in",bal:"pk",ban:"id",bas:"cm",bax:"cm",bbc:"id",bem:"zm",bez:"tz",bfq:"in",bft:"pk",bfy:"in",
bhb:"in",bho:"in",bik:"ph",bin:"ng",bjj:"in",bku:"ph",bqv:"ci",bra:"in",brx:"in",bss:"cm",btv:"pk",bua:"ru",buc:"yt",bug:"id",bya:"id",byn:"er",cch:"ng",ccp:"in",ceb:"ph",cgg:"ug",chk:"fm",chm:"ru",chp:"ca",chr:"us",cja:"kh",cjm:"vn",ckb:"iq",crk:"ca",csb:"pl",dar:"ru",dav:"ke",den:"ca",dgr:"ca",dje:"ne",doi:"in",dsb:"de",dua:"cm",dyo:"sn",dyu:"bf",ebu:"ke",efi:"ng",ewo:"cm",fan:"gq",fil:"ph",fon:"bj",fur:"it",gaa:"gh",gag:"md",gbm:"in",gcr:"gf",gez:"et",gil:"ki",gon:"in",gor:"id",grt:"in",gsw:"ch",
guz:"ke",gwi:"ca",haw:"us",hil:"ph",hne:"in",hnn:"ph",hoc:"in",hoj:"in",ibb:"ng",ilo:"ph",inh:"ru",jgo:"cm",jmc:"tz",kaa:"uz",kab:"dz",kaj:"ng",kam:"ke",kbd:"ru",kcg:"ng",kde:"tz",kdt:"th",kea:"cv",ken:"cm",kfo:"ci",kfr:"in",kha:"in",khb:"cn",khq:"ml",kht:"in",kkj:"cm",kln:"ke",kmb:"ao",koi:"ru",kok:"in",kos:"fm",kpe:"lr",krc:"ru",kri:"sl",krl:"ru",kru:"in",ksb:"tz",ksf:"cm",ksh:"de",kum:"ru",lag:"tz",lah:"pk",lbe:"ru",lcp:"cn",lep:"in",lez:"ru",lif:"np",lis:"cn",lki:"ir",lmn:"in",lol:"cd",lua:"cd",
luo:"ke",luy:"ke",lwl:"th",mad:"id",mag:"in",mai:"in",mak:"id",man:"gn",mas:"ke",mdf:"ru",mdh:"ph",mdr:"id",men:"sl",mer:"ke",mfe:"mu",mgh:"mz",mgo:"cm",min:"id",mni:"in",mnk:"gm",mnw:"mm",mos:"bf",mua:"cm",mwr:"in",myv:"ru",nap:"it",naq:"na",nds:"de","new":"np",niu:"nu",nmg:"cm",nnh:"cm",nod:"th",nso:"za",nus:"sd",nym:"tz",nyn:"ug",pag:"ph",pam:"ph",pap:"bq",pau:"pw",pon:"fm",prd:"ir",raj:"in",rcf:"re",rej:"id",rjs:"np",rkt:"in",rof:"tz",rwk:"tz",saf:"gh",sah:"ru",saq:"ke",sas:"id",sat:"in",saz:"in",
sbp:"tz",scn:"it",sco:"gb",sdh:"ir",seh:"mz",ses:"ml",shi:"ma",shn:"mm",sid:"et",sma:"se",smj:"se",smn:"fi",sms:"fi",snk:"ml",srn:"sr",srr:"sn",ssy:"er",suk:"tz",sus:"gn",swb:"yt",swc:"cd",syl:"bd",syr:"sy",tbw:"ph",tcy:"in",tdd:"cn",tem:"sl",teo:"ug",tet:"tl",tig:"er",tiv:"ng",tkl:"tk",tmh:"ne",tpi:"pg",trv:"tw",tsg:"ph",tts:"th",tum:"mw",tvl:"tv",twq:"ne",tyv:"ru",tzm:"ma",udm:"ru",uli:"fm",umb:"ao",unr:"in",unx:"in",vai:"lr",vun:"tz",wae:"ch",wal:"et",war:"ph",xog:"ug",xsr:"np",yao:"mz",yap:"fm",
yav:"cm",zza:"tr"}[a[0]];return k};a.getWeekend=function(f){var k=a._region(f);f={"in":0,af:4,dz:4,ir:4,om:4,sa:4,ye:4,ae:5,bh:5,eg:5,il:5,iq:5,jo:5,kw:5,ly:5,ma:5,qa:5,sd:5,sy:5,tn:5}[k];k={af:5,dz:5,ir:5,om:5,sa:5,ye:5,ae:6,bh:5,eg:6,il:6,iq:6,jo:6,kw:6,ly:6,ma:6,qa:6,sd:6,sy:6,tn:6}[k];void 0===f&&(f=6);void 0===k&&(k=0);return{start:f,end:k}};return a})},"dojox/encoding/base64":function(){define(["dojo/_base/lang"],function(p){p=p.getObject("dojox.encoding.base64",!0);p.encode=function(f){for(var a=
[],l=f.length,k=l%3,l=l-k,h=0;h<l;){var q=f[h++]<<16|f[h++]<<8|f[h++];a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(q>>>18&63));a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(q>>>12&63));a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(q>>>6&63));a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(q&63))}switch(k){case 2:q=f[h++]<<16|f[h++]<<8;a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(q>>>
18&63));a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(q>>>12&63));a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(q>>>6&63));a.push("\x3d");break;case 1:q=f[h++]<<16,a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(q>>>18&63)),a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(q>>>12&63)),a.push("\x3d"),a.push("\x3d")}return a.join("")};p.decode=function(f){f=f.split("");
for(var a=[],l=f.length;"\x3d"==f[--l];);for(var k=0;k<l;){var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(f[k++])<<18;k<=l&&(h|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(f[k++])<<12);k<=l&&(h|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(f[k++])<<6);k<=l&&(h|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(f[k++]));a.push(h>>>16&255);a.push(h>>>8&255);a.push(h&255)}for(;0==a[a.length-
1];)a.pop();return a};return p})},"esri/lang":function(){define("dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/_base/lang dojo/date dojo/has dojo/number dojo/date/locale ./kernel".split(" "),function(p,f,a,l,k,h,q,m,g){function e(c){return void 0!==c&&null!==c}function c(c,a,b){var d=b.match(/([^\(]+)(\([^\)]+\))?/i),n=l.trim(d[1]);b=a[c];var d=f.fromJson((d[2]?l.trim(d[2]):"()").replace(/^\(/,"({").replace(/\)$/,"})")),g=d.utcOffset;if(-1===p.indexOf(r,n))n=l.getObject(n),l.isFunction(n)&&
(b=n(b,c,a,d));else if("number"===typeof b||"string"===typeof b&&b&&!isNaN(Number(b)))switch(b=Number(b),n){case "NumberFormat":return q.format(b,d);case "DateString":c=new Date(b);if(d.local||d.systemLocale)return d.systemLocale?c.toLocaleDateString()+(d.hideTime?"":" "+c.toLocaleTimeString()):c.toDateString()+(d.hideTime?"":" "+c.toTimeString());c=c.toUTCString();d.hideTime&&(c=c.replace(/\s+\d\d\:\d\d\:\d\d\s+(utc|gmt)/i,""));return c;case "DateFormat":return c=new Date(b),e(g)&&(c=k.add(c,"minute",
c.getTimezoneOffset()-g)),m.format(c,d)}return e(b)?b:""}function d(c,a){var b;if(a)for(b in c)c.hasOwnProperty(b)&&(void 0===c[b]?delete c[b]:c[b]instanceof Object&&d(c[b],!0));else for(b in c)c.hasOwnProperty(b)&&void 0===c[b]&&delete c[b];return c}var r=["NumberFormat","DateString","DateFormat"],u=/<\/?[^>]+>/g;return{valueOf:function(c,a){for(var b in c)if(c[b]==a)return b;return null},stripTags:function(c){if(c){var a=typeof c;if("string"===a)c=c.replace(u,"");else if("object"===a)for(var b in c)(a=
c[b])&&"string"===typeof a&&(a=a.replace(u,"")),c[b]=a}return c},substitute:function(a,d,b){var g,n,r;e(b)&&(l.isObject(b)?(g=b.first,n=b.dateFormat,r=b.numberFormat):g=b);if(!d||"${*}"===d){d=[];for(var u in a){b=a[u];if(n&&-1!==p.indexOf(n.properties||"",u))b=c(u,a,n.formatter||"DateString");else if(r&&-1!==p.indexOf(r.properties||"",u))b=c(u,a,r.formatter||"NumberFormat");d.push(u+" \x3d "+(e(b)?b:"")+"\x3cbr/\x3e");if(g)break}return d.join("")}return l.replace(d,l.hitch({obj:a},function(b,a){var d=
a.split(":");return 1<d.length?(a=d[0],d.shift(),c(a,this.obj,d.join(":"))):n&&-1!==p.indexOf(n.properties||"",a)?c(a,this.obj,n.formatter||"DateString"):r&&-1!==p.indexOf(r.properties||"",a)?c(a,this.obj,r.formatter||"NumberFormat"):e(this.obj[a])?this.obj[a]:""}),/\$\{([^\}]+)\}/g)},filter:function(c,d,b){d=[l.isString(c)?c.split(""):c,b||a.global,l.isString(d)?new Function("item","index","array",d):d];b={};var e;c=d[0];for(e in c)d[2].call(d[e],c[e],e,c)&&(b[e]=c[e]);return b},isDefined:e,fixJson:d}})},
"esri/kernel":function(){define(["dojo/_base/kernel","dojo/_base/config","dojo/has"],function(p,f,a){p=window.location;a=p.pathname;a={version:"3.17",_appBaseUrl:p.protocol+"//"+p.host+a.substring(0,a.lastIndexOf(a.split("/")[a.split("/").length-1]))};f.noGlobals||(window.esri=a);(a.dijit=a.dijit||{})._arcgisUrl=("file:"===p.protocol?"http:":p.protocol)+"//www.arcgis.com/sharing/rest";return a})},"esri/arcgis/utils":function(){define("require dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/on dojo/DeferredList dojo/dom-construct dojo/sniff ../kernel ../config ../lang ../request ../SpatialReference ../map ../urlUtils ../geometry/ScreenPoint ../geometry/Extent ../geometry/webMercatorUtils ../symbols/jsonUtils ../renderers/jsonUtils ../dijit/PopupTemplate ../dijit/Popup ../tasks/query ../tasks/GeometryService ../layers/ArcGISTiledMapServiceLayer ../layers/FeatureLayer dojo/i18n!../nls/jsapi".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A,B,F,E,H,I,M){function Q(b){return s({url:wa.arcgisUrl+"/"+b.itemId+"/data",content:{f:"json"},callbackParamName:"callback"},{disableIdentityLookup:!0,_preLookup:!0})}function K(b,c){var a={f:"json"};c&&(a.token=c);return s({url:b,content:a,callbackParamName:"callback"},{disableIdentityLookup:!0})}function J(b){if(b.layerDefinition&&(!b.layerDefinition.drawingInfo||!b.layerDefinition.drawingInfo.labelingInfo))b.showLabels=!1;b.itemProperties.layerDefinition&&
(b.layerDefinition?(b.layerDefinition.drawingInfo||(b.layerDefinition.drawingInfo=b.itemProperties.layerDefinition.drawingInfo),u.isDefined(b.layerDefinition.definitionExpression)||(b.layerDefinition.definitionExpression=b.itemProperties.layerDefinition.definitionExpression),u.isDefined(b.layerDefinition.minScale)||(b.layerDefinition.minScale=b.itemProperties.layerDefinition.minScale),u.isDefined(b.layerDefinition.maxScale)||(b.layerDefinition.maxScale=b.itemProperties.layerDefinition.maxScale)):
b.layerDefinition=b.itemProperties.layerDefinition);b.itemProperties.popupInfo&&(!b.popupInfo&&!b.disablePopup)&&(b.popupInfo=b.itemProperties.popupInfo);u.isDefined(b.itemProperties.showLabels)&&!u.isDefined(b.showLabels)&&(b.showLabels=b.itemProperties.showLabels);u.isDefined(b.itemProperties.showLegend)&&!u.isDefined(b.showLegend)&&(b.showLegend=b.itemProperties.showLegend);u.isDefined(b.itemProperties.refreshInterval)&&!u.isDefined(b.refreshInterval)&&(b.refreshInterval=b.itemProperties.refreshInterval)}
function O(b){J(b);b.itemProperties.layerDefinition&&b.layerDefinition&&(!u.isDefined(b.layerDefinition.maximumTrackPoints)&&u.isDefined(b.itemProperties.layerDefinition.maximumTrackPoints)&&(b.layerDefinition.maximumTrackPoints=b.itemProperties.layerDefinition.maximumTrackPoints),!b.layerDefinition.definitionGeometry&&b.itemProperties.layerDefinition.definitionGeometry&&(b.layerDefinition.definitionGeometry=b.itemProperties.layerDefinition.definitionGeometry));b.itemProperties.purgeOptions&&!b.purgeOptions&&
(b.purgeOptions=b.itemProperties.purgeOptions)}function G(b,c){var d=new k,e=b.itemData,n=[],s=[];a.forEach(e.operationalLayers,function(b){if(b.itemId&&!b.type){var c=b.url.toLowerCase();-1<c.indexOf("/featureserver")||-1<c.indexOf("/mapserver/")?(s.push(b),n.push(Q(b))):-1<c.indexOf("/mapserver")&&-1===c.indexOf("/mapserver/")&&(!b.layers||!u.isDefined(b.minScale)&&!u.isDefined(b.maxScale))?(s.push(b),n.push(Q(b))):-1<c.indexOf("/imageserver")&&!u.isDefined(b.minScale)&&!u.isDefined(b.maxScale)?
(s.push(b),n.push(Q(b))):-1<c.indexOf("/streamserver")&&(s.push(b),n.push(Q(b)))}});e.baseMap&&e.baseMap.baseMapLayers&&a.forEach(e.baseMap.baseMapLayers,function(b){b.itemId&&"VectorTileLayer"!==b.layerType&&(s.push(b),n.push(Q(b)))});if(0<n.length){var t={};(new g(n)).addCallback(function(c){a.forEach(s,function(b,d){var e=c[d][1];if(e&&!(e instanceof Error)&&(t[b.itemId]=e,!b.type)){var n=b.url.toLowerCase();if((-1<n.indexOf("/featureserver")||-1<n.indexOf("/mapserver/"))&&e.layers)a.forEach(e.layers,
function(c){if(n.match("/featureserver/"+c.id+"$")=="/featureserver/"+c.id||n.match("/mapserver/"+c.id+"$")=="/mapserver/"+c.id)b.itemProperties=c,J(b)});else if(-1<n.indexOf("/streamserver"))b.itemProperties=e,O(b);else if(-1<n.indexOf("/mapserver"))e.layers&&!b.layers&&(b.layers=e.layers),u.isDefined(e.minScale)&&!u.isDefined(b.minScale)&&(b.minScale=e.minScale),u.isDefined(e.maxScale)&&!u.isDefined(b.maxScale)&&(b.maxScale=e.maxScale),u.isDefined(e.refreshInterval)&&!u.isDefined(b.refreshInterval)&&
(b.refreshInterval=e.refreshInterval),e.visibleLayers&&!b.visibleLayers&&(b.visibleLayers=e.visibleLayers);else if(-1<n.indexOf("/imageserver")&&(u.isDefined(e.minScale)&&!u.isDefined(b.minScale)&&(b.minScale=e.minScale),u.isDefined(e.maxScale)&&!u.isDefined(b.maxScale)&&(b.maxScale=e.maxScale),u.isDefined(e.refreshInterval)&&!u.isDefined(b.refreshInterval)&&(b.refreshInterval=e.refreshInterval),e.popupInfo&&(!b.popupInfo&&!b.disablePopup)&&(b.popupInfo=e.popupInfo),e.renderingRule&&!b.renderingRule&&
(b.renderingRule=e.renderingRule,e.renderingRule.functionName&&(b.renderingRule.rasterFunction=e.renderingRule.functionName)),e.bandIds&&!b.bandIds&&(b.bandIds=e.bandIds),e.mosaicRule&&!b.mosaicRule&&(b.mosaicRule=e.mosaicRule),e.format&&!b.format&&(b.format=e.format),u.isDefined(e.compressionQuality)&&!u.isDefined(b.compressionQuality)&&(b.compressionQuality=e.compressionQuality),e.layerDefinition&&e.layerDefinition.definitionExpression&&(!u.isDefined(b.layerDefinition)||!u.isDefined(b.layerDefinition.definitionExpression))))b.layerDefinition=
b.layerDefinition||{},b.layerDefinition.definitionExpression=e.layerDefinition.definitionExpression}});b.relatedItemsData=t;d.callback(b)})}else d.callback(b);return d}function T(b,c){var a=new k,e=b.itemData,n=e.baseMap.baseMapLayers[0];if("BingMapsAerial"===n.type||"BingMapsRoad"===n.type||"BingMapsHybrid"===n.type)if(n.portalUrl&&d.id)delete c.bingMapsKey,d.id.checkSignInStatus(v.urlToObject(wa.arcgisUrl).path).then(f.hitch(null,function(b,c,a,d,e){K(n.portalUrl,e.token).then(f.hitch(null,V,b,
c,a,d),f.hitch(null,L,b,c,a,d))},b,c,e,a),f.hitch(null,function(b,c,a,d,e){K(n.portalUrl).then(f.hitch(null,V,b,c,a,d),f.hitch(null,L,b,c,a,d))},b,c,e,a));else if(c.bingMapsKey){var g=new ma({bingMapsKey:c.bingMapsKey,mapStyle:ma.MAP_STYLE_AERIAL});l.connect(g,"onLoad",f.hitch(this,function(){a.callback([b,c])}));l.connect(g,"onError",function(d){delete c.bingMapsKey;b.itemData=C(e);n=b.itemData.baseMap.baseMapLayers[0];n.errors=[];n.errors.push({message:"The owner of the application has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});
a.callback([b,c])})}else b.itemData=C(e),n=b.itemData.baseMap.baseMapLayers[0],n.errors=[],n.errors.push({message:"The owner of the application has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."}),a.callback([b,c]);else a.callback([b,c]);return a}function P(b){var a=new k,d,e;b=b.itemData;var n=b.baseMap&&b.baseMap.baseMapLayers;if(c("ie")||ob&&!ob.supported())for(b=0;b<n.length;b++){var g=n[b];if(!g.isReference){"VectorTileLayer"===g.layerType&&(d=g.itemId,e=b);
break}}d?ca(d,!1).addBoth(function(b){var c=/^https?:\/\/basemaps(dev)?\.arcgis\.com\/arcgis\/rest\/services\/World_Basemap\/VectorTileServer/i;b&&(b.item&&c.test(b.item.url))&&(n[e]={id:"FB_"+g.id,layerType:"ArcGISTiledMapServiceLayer",opacity:"opacity"in g?g.opacity:1,visibility:"visibility"in g?g.visibility:!0,url:"http://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer"});a.resolve()}):a.resolve();return a}function V(b,c,a,d,e){e.bingKey?(c.bingMapsKey=e.bingKey,e=new ma({bingMapsKey:c.bingMapsKey,
mapStyle:ma.MAP_STYLE_AERIAL}),l.connect(e,"onLoad",f.hitch(this,function(){d.callback([b,c])})),l.connect(e,"onError",function(e){delete c.bingMapsKey;b.itemData=C(a);e=b.itemData.baseMap.baseMapLayers[0];e.errors=[];e.errors.push({message:"The owner of the map has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});d.callback([b,c])})):L(b,c,a,d)}function L(b,c,a,d){delete c.bingMapsKey;b.itemData=C(a);a=b.itemData.baseMap.baseMapLayers[0];a.errors=[];a.errors.push({message:"The owner of the map has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."});
d.callback([b,c])}function C(b){b.baseMap="BingMapsAerial"===b.baseMap.baseMapLayers[0].type?{title:"Imagery",baseMapLayers:[{id:"World_Imagery_2017",visibility:!0,opacity:1,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]}:"BingMapsRoad"===b.baseMap.baseMapLayers[0].type?{title:"Streets",baseMapLayers:[{id:"World_Street_Map_8421",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]}:{title:"Imagery with Labels",
baseMapLayers:[{id:"World_Imagery_6611",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{id:"World_Boundaries_and_Places_1145",isReference:!0,opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer"}]};return b}function X(b,c,d,e){var n=b.dynamicLayerInfos||b.layerInfos,g=c.layers;if(g&&n)if(e.usePopupManager){var s;a.forEach(n,function(b){var c=b.id;if(!b.subLayerIds)for(b=
0;b<g.length;b++){var a=g[b];if(a.id===c&&a.popupInfo){s||(s={});s[c]={infoTemplate:new d(a.popupInfo),layerUrl:a.layerUrl};break}}});s&&b.setInfoTemplates(s)}else{var t=[],r=[],v=[],w=[],h=[],f=[];a.forEach(n,function(c){var d=c.id;if(!c.subLayerIds&&-1!==a.indexOf(b.visibleLayers,d))for(c=0;c<g.length;c++){var e=g[c];if(e.id===d){r.push(d);t.push(e.popupInfo);v.push(e.layerUrl||"");e.layerDefinition&&e.layerDefinition.definitionExpression?w.push(e.layerDefinition.definitionExpression):w.push("");
h.push(u.isDefined(e.minScale)?e.minScale:null);f.push(u.isDefined(e.maxScale)?e.maxScale:null);break}}});t.length&&(b.__popups=t,b.__popupIds=r,b.__popupUrls=v,b.__popupWhereClauses=w,b.__popupMinScales=h,b.__popupMaxScales=f,b.__resourceInfo=c.resourceInfo)}}function Y(b){if(!b)return!1;var c=(new q(wa.arcgisUrl)).authority;return-1!==b.indexOf(".arcgis.com/")||-1!==b.indexOf(c)}function la(b){return!b?!1:-1!==b.indexOf("/services.arcgisonline.com/")||-1!==b.indexOf("/server.arcgisonline.com/")}
function aa(b){if("https:"===location.protocol&&(Y(b)||la(b)))b=b.replace("http:","https:");return b}function ga(b,c,d){var e=[],n;b.displayLevels||(e=a.map(b.resourceInfo.tileInfo.lods,function(b){return b.level}));b.exclusionAreas&&(n=f.clone(b.exclusionAreas),n=a.map(n,function(b){b.geometry=new w(b.geometry);return b}));e=new H(aa(b.url),{resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,displayLevels:b.displayLevels||e,id:b.id,minScale:b.minScale,maxScale:b.maxScale,refreshInterval:b.refreshInterval,
exclusionAreas:n});d.ignorePopups||X(e,b,c,d);return e}function qa(b,c){if(!b||!c||0===c.length)return[];var a=","+c+",",d=[],e,n=",";for(e=0;e<b.length;e++)if(null!==b[e].subLayerIds){if(-1===a.indexOf(","+b[e].id+",")||-1<n.indexOf(","+b[e].id+","))n+=b[e].subLayerIds.toString()+","}else-1<a.indexOf(","+b[e].id+",")&&-1===n.indexOf(","+b[e].id+",")&&d.push(b[e].id);return d}function za(b,c,d){var e=new Z;e.format="png24";b.resourceInfo&&(b.resourceInfo.supportedImageFormatTypes&&-1<b.resourceInfo.supportedImageFormatTypes.indexOf("PNG32"))&&
(e.format="png32");var e=new S(aa(b.url),{resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,id:b.id,imageParameters:e,minScale:b.minScale,maxScale:b.maxScale,refreshInterval:b.refreshInterval}),n=b.visibleLayers;if(!b.visibleLayers){var g="";a.forEach(e.layerInfos,function(b){b.defaultVisibility&&(g+=(0<g.length?",":"")+b.id)});n=g}if(b.layers&&0<b.layers.length){var s=[],t=[],r,v=[],u,w;a.forEach(b.layers,function(c){c.layerDefinition&&c.layerDefinition.definitionExpression&&(s[c.id]=
c.layerDefinition.definitionExpression);if(c.layerDefinition&&c.layerDefinition.source){r=null;w=c.layerDefinition.source;if("mapLayer"===w.type){var d=a.filter(b.resourceInfo.layers,function(b){return b.id===w.mapLayerId});d.length&&(r=f.mixin(d[0],c))}else r=f.mixin({},c);r&&(r.source=w,delete r.popupInfo,r=new ja(r),b.visibleLayers&&(d="string"==typeof b.visibleLayers?b.visibleLayers.split(","):b.visibleLayers,-1<a.indexOf(d,c.id)?r.defaultVisibility=!0:r.defaultVisibility=!1),t.push(r))}c.layerDefinition&&
(c.layerDefinition.source&&c.layerDefinition.drawingInfo)&&(u=new Ra(c.layerDefinition.drawingInfo),v[c.id]=u)},this);0<s.length&&e.setLayerDefinitions(s);0<t.length?(e.setDynamicLayerInfos(t,!0),0<v.length&&e.setLayerDrawingOptions(v,!0)):(n=qa(e.layerInfos,n),e.setVisibleLayers(n))}else n=qa(e.layerInfos,n),e.setVisibleLayers(n);d.ignorePopups||X(e,b,c,d);return e}function ia(b,c,a){var d=new N;d.bandIds=b.bandIds;null!=b.format&&(d.format=b.format,null!=b.compressionQuality&&(d.compressionQuality=
b.compressionQuality));if(b.renderingRule&&b.renderingRule.rasterFunction){var e=new pb(b.renderingRule);d.renderingRule=e}b.mosaicRule&&(e=new Xa(b.mosaicRule),d.mosaicRule=e);u.isDefined(b.noData)&&(d.noData=b.noData);u.isDefined(b.noDataInterpretation)&&(d.noDataInterpretation=b.noDataInterpretation);u.isDefined(b.interpolation)&&(d.interpolation=b.interpolation);e=b.layerType?"ArcGISImageServiceVectorLayer"===b.layerType:!1;u.isDefined(b.layerType)||(e=b.resourceInfo.hasMultidimensions&&("esriImageServiceDataTypeVector-UV"===
b.resourceInfo.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===b.resourceInfo.serviceDataType));d={resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,id:b.id,imageServiceParameters:d,minScale:b.minScale,maxScale:b.maxScale,refreshInterval:b.refreshInterval};d=e?new D(aa(b.url),d):new fa(aa(b.url),d);b.layerDefinition&&(b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.renderer&&(e=y.fromJson(b.layerDefinition.drawingInfo.renderer),d.setRenderer(e)),b.layerDefinition.definitionExpression&&
d.setDefinitionExpression(b.layerDefinition.definitionExpression,!0));!a.ignorePopups&&b.popupInfo&&d.setInfoTemplate(new c(b.popupInfo));return d}function oa(b,c,d){var e=[102113,102100,3857],n=d||new t(c[0].layerObject.fullExtent.spatialReference),g=new t(b.resourceInfo.fullExtent.spatialReference);return n.wkt==g.wkt&&(n.wkid==g.wkid||u.isDefined(n.latestWkid)&&n.latestWkid==g.wkid||u.isDefined(g.latestWkid)&&n.wkid==g.latestWkid||u.isDefined(n.latestWkid)&&n.latestWkid==g.latestWkid)||n.wkid&&
g.wkid&&a.some(e,function(b){return b===g.wkid})&&a.some(e,function(b){return b===n.wkid})?!0:!1}function xa(b,c,a){if(!c[0].layerObject.tileInfo)return!1;b=b.resourceInfo.tileInfo;c=c[0].layerObject.tileInfo;a=a.width>a.height?a.width:a.height;for(var d=!1,e=!1,n=0;n<b.lods.length;n++){for(var g=b.lods[n].scale/b.dpi,s=0;s<c.lods.length;s++){var t=c.lods[s].scale/c.dpi;if(Math.abs(t-g)/t<1/a)if(d){e=!0;break}else d=!0}if(e)break}return e||d&&(1===b.lods.length||1===c.lods.length)?!0:!1}function sa(b,
c,e,n,g,s){var r,k,q=e._clazz;if("OpenStreetMap"===b.type)r=new Hb({id:b.id,opacity:b.opacity,visible:null!==b.visibility&&void 0!==b.visibility?b.visibility:!0});else if("WFS"===b.type)n={geometryType:b.layerDefinition.geometryType,id:b.id,labelingInfo:b.layerDefinition.drawingInfo.labelingInfo,maxFeatures:b.wfsInfo.maxFeatures,mode:b.mode,name:b.wfsInfo.name,showLabels:!0,swapXY:b.wfsInfo.swapXY,title:b.title,url:b.url,version:b.wfsInfo.version,visible:b.visibility,wkid:b.layerDefinition.spatialReference.wkid},
r=new gb,r.fromJson(n,function(){u.isDefined(b.opacity)&&r.setOpacity(b.opacity);u.isDefined(b.visibility)&&r.setVisibility(b.visibility);(b.minScale||b.maxScale)&&r.setScaleRange(b.minScale,b.maxScale);r.renderer=y.fromJson(b.layerDefinition.drawingInfo.renderer);!e.ignorePopups&&b.popupInfo&&r.setInfoTemplate(new q(b.popupInfo));r.emit("fromJsonComplete")});else if("WMS"===b.type){var x=[],Q=[];a.forEach(b.layers,function(b){Q.push(new qb({name:b.name,title:b.title,legendURL:b.legendURL,queryable:b.queryable,
showPopup:b.showPopup}));x.push(b.name)},this);b.visibleLayers&&(x=b.visibleLayers);n={extent:new w(b.extent[0][0],b.extent[0][1],b.extent[1][0],b.extent[1][1],new t({wkid:4326})),layerInfos:Q,version:b.version,maxWidth:b.maxWidth,maxHeight:b.maxHeight,featureInfoFormat:b.featureInfoFormat,getFeatureInfoURL:b.featureInfoUrl,getMapURL:b.mapUrl,spatialReferences:b.spatialReferences,title:b.title,copyright:b.copyright,minScale:b.minScale||0,maxScale:b.maxScale||0,format:b.format};r=new Cb(b.url,{id:b.id,
visibleLayers:x,format:"png",transparent:b.firstLayer?!1:!0,opacity:b.opacity,visible:null!==b.visibility?b.visibility:!0,resourceInfo:n,refreshInterval:b.refreshInterval});r.spatialReference.wkid=n.spatialReferences[0]}else if("KML"===b.type){k=b.url;if(d.id){var B=d.id.findCredential(v.urlToObject(wa.arcgisUrl).path);B&&(c=wa.arcgisUrl.substring(wa.arcgisUrl.indexOf("//")+2,wa.arcgisUrl.indexOf("/",wa.arcgisUrl.indexOf("//")+3)),g=c.split("."),g=g[g.length-2]+"."+g[g.length-1],s=k.indexOf(g),-1<
s&&(k="https://"+c+k.substring(s+g.length),k+="?token\x3d"+B.token))}r=new hb(k,{id:b.id,visible:null!==b.visibility?b.visibility:!0,outSR:n,refreshInterval:b.refreshInterval});l.connect(r,"onLoad",function(){(b.opacity||0===b.opacity)&&r.setOpacity(b.opacity);u.isDefined(b.minScale)&&u.isDefined(b.maxScale)&&r.setScaleRange(b.minScale,b.maxScale);b.visibleFolders&&a.forEach(r.folders,function(c){-1<a.indexOf(b.visibleFolders,c.id)?r.setFolderVisibility(c,!0):r.setFolderVisibility(c,!1)},this)})}else"WebTiledLayer"===
b.type?(r=new rb(b.templateUrl,{id:b.id,visible:null!==b.visibility?b.visibility:!0,opacity:b.opacity,copyright:b.copyright,fullExtent:b.fullExtent&&new w(b.fullExtent),initialExtent:b.fullExtent&&new w(b.fullExtent),subDomains:b.subDomains,tileInfo:b.tileInfo?new yb(b.tileInfo):null,refreshInterval:b.refreshInterval}),l.connect(r,"onLoad",function(){(u.isDefined(b.minScale)||u.isDefined(b.maxScale))&&r.setScaleRange(b.minScale,b.maxScale)})):"GeoRSS"===b.type?(r=new W(b.url,{id:b.id,opacity:b.opacity,
outSpatialReference:n,refreshInterval:b.refreshInterval}),l.connect(r,"onLoad",function(){!1===b.visibility&&r.hide();u.isDefined(b.minScale)&&u.isDefined(b.maxScale)&&r.setScaleRange(b.minScale,b.maxScale);var c=r.getFeatureLayers();a.forEach(c,function(a){b.pointSymbol&&"esriGeometryPoint"===a.geometryType?(a.renderer.symbol=z.fromJson(b.pointSymbol),1===c.length&&(r.pointSymbol=z.fromJson(b.pointSymbol))):b.lineSymbol&&"esriGeometryPolyline"===a.geometryType?(a.renderer.symbol=z.fromJson(b.lineSymbol),
1===c.length&&(r.polylineSymbol=z.fromJson(b.lineSymbol))):b.polygonSymbol&&"esriGeometryPolygon"===a.geometryType&&(a.renderer.symbol=z.fromJson(b.polygonSymbol),1===c.length&&(r.polygonSymbol=z.fromJson(b.polygonSymbol)))})})):"CSV"==b.type&&b.url?(n={layerDefinition:b.layerDefinition,columnDelimiter:b.columnDelimiter,id:b.id?b.id:null,visible:null!==b.visibility?b.visibility:!0,opacity:b.opacity,refreshInterval:b.refreshInterval},b.locationInfo&&(n.latitudeFieldName=b.locationInfo.latitudeFieldName,
n.longitudeFieldName=b.locationInfo.longitudeFieldName),e.ignorePopups||(n.infoTemplate=new A(b.popupInfo?b.popupInfo:ba.generateDefaultPopupInfo(b))),r=new da(b.url,n)):"VectorTileLayer"===b.layerType&&b.styleUrl?r=new Db(b.styleUrl,{id:b.id,minScale:b.minScale,maxScale:b.maxScale,opacity:b.opacity,visible:b.visibility}):b.layerDefinition&&!b.url?(n=h.fromJson(h.toJson(b)),delete n.id,delete n.opacity,delete n.visibility,r=new I(n,{id:b.id,opacity:b.opacity,visible:b.visibility,outFields:["*"],autoGeneralize:!0}),
!e.ignorePopups&&n.popupInfo&&r.setInfoTemplate(new q(n.popupInfo)),Da(r)):"BingMapsAerial"===b.type||"BingMapsRoad"===b.type||"BingMapsHybrid"===b.type?e.bingMapsKey?(n=ma.MAP_STYLE_AERIAL_WITH_LABELS,"BingMapsAerial"===b.type?n=ma.MAP_STYLE_AERIAL:"BingMapsRoad"===b.type&&(n=ma.MAP_STYLE_ROAD),r=new ma({bingMapsKey:e.bingMapsKey,mapStyle:n,opacity:b.opacity,id:b.id}),l.connect(r,"onError",f.hitch(this,function(b){b.errors=b.errors||[];b.errors.push({message:"This application does not have a valid Bing Key for the Bing layer that is included in this map. [type:"+
b.type+"]"})},b))):(b.errors=b.errors||[],b.errors.push({message:"This application does not provide a Bing Key for the Bing layer that is included in this map. [type:"+b.type+"]"})):b.resourceInfo&&b.resourceInfo.mapName?r=!0===b.resourceInfo.singleFusedMapCache&&(b.baseMapLayer||oa(b,c,n)&&xa(b,g,s))?ga(b,q,e):za(b,q,e):b.resourceInfo&&b.resourceInfo.pixelSizeX?r=!0===b.resourceInfo.singleFusedMapCache&&(b.baseMapLayer||oa(b,c,n)&&xa(b,g,s))?ga(b,q,e):ia(b,q,e):b.resourceInfo&&"Feature Layer"===
b.resourceInfo.type?(b.capabilities&&(b.resourceInfo.capabilities=b.capabilities),r=new I(aa(b.url),{resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,id:b.id,mode:b.mode===I.MODE_SELECTION?I.MODE_SELECTION:I.MODE_AUTO,editable:!1===e.editable?!1:void 0,outFields:["*"],autoGeneralize:!0,refreshInterval:b.refreshInterval}),!e.ignorePopups&&b.popupInfo&&r.setInfoTemplate(new q(b.popupInfo)),b.layerDefinition&&(b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.renderer&&(n=
y.fromJson(b.layerDefinition.drawingInfo.renderer),n.isMaxInclusive=!0,r.setRenderer(n)),b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.labelingInfo&&(n=a.map(b.layerDefinition.drawingInfo.labelingInfo,function(b){return new Eb(b)}),r.setLabelingInfo(n)),b.layerDefinition.definitionExpression&&r.setDefinitionExpression(b.layerDefinition.definitionExpression),u.isDefined(b.layerDefinition.minScale)&&r.setMinScale(b.layerDefinition.minScale),u.isDefined(b.layerDefinition.maxScale)&&r.setMaxScale(b.layerDefinition.maxScale)),
Da(r)):b.resourceInfo&&b.resourceInfo.streamUrls&&(n={resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,id:b.id},b.layerDefinition&&(B=b.layerDefinition.drawingInfo,b.layerDefinition.definitionGeometry&&(k=k||{},k.geometry=b.layerDefinition.definitionGeometry),u.isDefined(b.layerDefinition.definitionExpression)&&(k=k||{},k.where=b.layerDefinition.definitionExpression),u.isDefined(b.layerDefinition.maximumTrackPoints)&&(n.maximumTrackPoints=b.layerDefinition.maximumTrackPoints)),k&&
(n.filter=k),b.purgeOptions&&(n.purgeOptions=b.purgeOptions),r=new Fb(aa(b.url),n),B&&B.renderer&&(n=B.renderer,r.setRenderer(y.fromJson(n))),!e.ignorePopups&&b.popupInfo&&r.setInfoTemplate(new q(b.popupInfo)),b.layerDefinition&&(u.isDefined(b.layerDefinition.minScale)&&r.setMinScale(b.layerDefinition.minScale),u.isDefined(b.layerDefinition.maxScale)&&r.setMaxScale(b.layerDefinition.maxScale)),m.once(r,"error",function(c){b.errors.push({message:"Error loading stream layer. Check websocket url"})}));
r&&(r.arcgisProps={title:b.title},b.baseMapLayer&&(b.isReference?(r.attr("data-reference",!0),r._basemapGalleryLayerType="reference"):r._basemapGalleryLayerType="basemap"));return r}function ea(b,c,d,e,n){a.forEach(b,function(a){a.layerObject=sa(a,b,c,d,e,n)});var g=a.filter(b,function(b){return!b.isReference}),s=a.filter(b,function(b){return!!b.isReference});return b=g.concat(s)}function pa(b){var c=null;b=b[0];b.url&&!b.type?b.resourceInfo.spatialReference&&(c=new t,b.resourceInfo.spatialReference.wkid&&
(c.wkid=b.resourceInfo.spatialReference.wkid),b.resourceInfo.spatialReference.wkt&&(c.wkt=b.resourceInfo.spatialReference.wkt)):b.type&&(-1<b.type.indexOf("BingMaps")||"OpenStreetMap"==b.type?c=new t({wkid:102100}):"WMS"==b.type&&(c=new t({wkid:b.spatialReferences[0]})));return c}function Aa(b,c,d,e,n,g,s,r){a.forEach(c,function(c){c.url&&!c.type&&(c.resourceInfo=b[c.deferredsPos][1],delete c.deferredsPos)});g=g||pa(c);c=ea(c,d,g,s,r);n.callback(c);return n}function Da(b){!window.CanvasRenderingContext2D&&
(b.renderer&&"esri.renderer.HeatmapRenderer"===b.renderer.declaredClass)&&b.setRenderer(y.fromJson({type:"simple",symbol:{color:[77,77,77,255],size:6,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[255,255,255,255],width:0.75,type:"esriSLS",style:"esriSLSSolid"}}}))}function Ea(b,c){var a=aa(b);return s({url:a,content:{f:"json"},callbackParamName:"callback",error:function(b,d){b.message=b.message?b.message+(" [url:"+a+"]"):"[url:"+a+"]";c.push(b);r.defaults.io.errorHandler(b,
d)}})}function ua(b){var c=wa.arcgisUrl+"/"+b.itemId+"/data";return s({url:c,content:{f:"json"},callbackParamName:"callback",error:function(a,d){a.message=a.message?a.message+(" [url:"+c+"]"):"[url:"+c+"]";b.errors=b.errors||[];b.errors.push(a);r.defaults.io.errorHandler(a,d)}})}function Ca(b,c,d){var e=new k;if((!d.featureCollection||!d.featureCollection.layers)&&!d.layers)return console.log("Invalid Feature Collection item data [item id: "+b.itemId+"]: ",d),b.errors=b.errors||[],b.errors.push({message:"Invalid Feature Collection item data. [item id: "+
b.itemId+"]"}),e.errback(),e;d.layers&&(d.featureCollection={layers:d.layers},delete d.layers,u.isDefined(d.showLegend)&&(d.featureCollection.showLegend=d.showLegend,delete d.showLegend));ta(b,d.featureCollection,c).then(function(c){d.featureCollection=c;b.featureCollection&&b.featureCollection.layers?a.forEach(d.featureCollection.layers,function(c,a){var d=b.featureCollection.layers[a];if(!d.popupInfo&&!d.layerDefinition)d.popupInfo=c.popupInfo,d.layerDefinition=c.layerDefinition;else if(d.layerDefinition){if(u.isDefined(d.layerDefinition.minScale)&&
u.isDefined(d.layerDefinition.maxScale)&&(d.layerDefinition.minScale!==c.layerDefinition.minScale||d.layerDefinition.maxScale!==c.layerDefinition.maxScale))delete c.layerDefinition.minscale,delete c.layerDefinition.maxScale;d.layerDefinition.drawingInfo&&h.toJson(d.layerDefinition.drawingInfo)!==h.toJson(c.layerDefinition.drawingInfo)&&delete c.layerDefinition.drawingInfo;d.layerDefinition.showLegend!==c.layerDefinition.showLegend&&delete c.layerDefinition.showLegend;d.layerDefinition=f.mixin(d.layerDefinition,
c.layerDefinition)}else d.layerDefinition=c.layerDefinition;d.featureSet=c.featureSet;d.nextObjectId=c.nextObjectId}):(b.featureCollection=b.featureCollection||{},b.featureCollection=f.mixin(b.featureCollection,d.featureCollection));e.callback(b)});return e}function ta(b,c,d){var e=new k;p(["./csv"],function(n){var s=[];a.forEach(c.layers,function(b){b.featureSet&&(b.featureSet.features&&b.featureSet.features.length&&b.featureSet.features[0].geometry&&b.featureSet.features[0].geometry.spatialReference)&&
(b.deferredsPos=s.length,s.push(n.projectFeatureCollection(b,d,b.featureSet.features[0].geometry.spatialReference)))});(new g(s)).addCallback(function(){a.forEach(c.layers,function(c){u.isDefined(c.deferredsPos)&&(s[c.deferredsPos].results&&s[c.deferredsPos].results.length?c=s[c.deferredsPos].results[0]:(console.log("Errors projecting feature collection. ["+b.title+" - "+c.layerDefinition.name+"]"),c.errors=c.errors||[],c.errors.push({message:"Errors projecting feature collection. ["+b.title+" - "+
c.layerDefinition.name+"]"})),delete c.deferredsPos)});e.callback(c)})});return e}function va(b,c,d,e,n){var s=new k,r=new k,t=[],v;a.forEach(b.operationalLayers,function(b){b.itemId&&"Feature Collection"==b.type&&t.push(ua(b).then(f.hitch(null,Ca,b,d)))});0===t.length?Ka(b,c,d,e,r,n):(v=new g(t),v.addCallback(function(a){Ka(b,c,d,e,r,n)}));r.then(function(b){t=[];a.forEach(b,function(b){var c;b=b.layerObject;b instanceof I&&!b.loaded&&!b.loadError?(c=new k,m.once(b,"load, error",function(){c.callback(b)}),
t.push(c)):b&&("esri.layers.WFSLayer"===b.declaredClass&&!b.loadError)&&(c=new k,m.once(b,"fromJsonComplete, error",function(d){c.callback(b)}),t.push(c))});if(t.length){var c=new k;v=new g(t);v.addCallback(function(){c.callback(b)});return c.promise}return b}).then(function(b){var c=[];a.forEach(b,function(b){var d=b.layerObject;d instanceof I?d.loaded&&(d.labelingInfo&&(b.showLabels||d._collection))&&c.push(d):d&&"esri.layers.WFSLayer"===d.declaredClass&&d.loaded&&d.labelingInfo&&c.push(d)});c.length?
p(["../layers/LabelLayer"],function(d){var e=new d;a.forEach(c,function(b){e.addFeatureLayer(b)});b.push({layerObject:e});s.callback(b)}):s.callback(b)});return s}function Ka(b,c,d,e,n,s){var r=[],t=[],v=[];a.forEach(b.operationalLayers,function(b,c){if(b.featureCollection&&b.featureCollection.layers){var d=b.featureCollection.layers.length;a.forEach(b.featureCollection.layers,function(e,n){var g=!0;b.visibleLayers&&-1==a.indexOf(b.visibleLayers,n)&&(g=!1);e.visibility=b.visibility&&g;e.opacity=b.opacity;
e.id=(b.id||"operational"+c)+"_"+n;b.title&&(e.title=1===d||!e.layerDefinition.name||b.title===e.layerDefinition.name?b.title:b.title+" - "+e.layerDefinition.name);v.push(e)},this)}else v.push(b)});a.forEach(b.baseMap.baseMapLayers,function(b,c){b.baseMapLayer=!0;b.id=b.id||"base"+c;r.push(b)});a.forEach(v,function(b,c){b.id=b.id||"operational"+c;r.push(b)});a.forEach(r,function(b){b.url&&!b.type&&(b.deferredsPos=t.length,b.errors=b.errors||[],t.push(Ea(b.url,b.errors)))});0===t.length?(d=d||pa(r),
r=ea(r,c,d,e,s),n.callback(r)):(new g(t)).addCallback(function(b){Aa(b,r,c,t,n,d,e,s)});return n}function Pa(b,c,d,e){var n=b.minScale,g=b.maxScale;if(10.1>=d.version&&c)for(b=c.length-1;0<=b;b--){if(c[b].id==e)if(0==n&&0<c[b].minScale?n=c[b].minScale:0<n&&0==c[b].minScale?n=d.minScale:0<n&&0<c[b].minScale&&(n=Math.min(n,c[b].minScale)),g=Math.max(d.maxScale||0,c[b].maxScale||0),d.setScaleRange(n,g),-1<c[b].parentLayerId)e=c[b].parentLayerId;else break}else 10.1<d.version&&(a.forEach(b.layerInfos,
function(b){b.id==e&&(0==n&&0<b.minScale?n=b.minScale:0<n&&0==b.minScale||0<n&&0<b.minScale&&(n=Math.min(n,b.minScale)),g=Math.max(g||0,b.maxScale||0))}),d.setScaleRange(n,g))}function Za(b,c,d,e){var n=b.url,g=b.__popupIds,s=b.__popupUrls,r=b.__popupWhereClauses,t=b.__popupMinScales,v=b.__popupMaxScales,w=b.__resourceInfo,h=[];a.forEach(b.__popups,function(e,f){if(e){var k,m=[];a.forEach(e.fieldInfos,function(b){"shape"!==b.fieldName.toLowerCase()&&m.push(b.fieldName)});if(b.dynamicLayerInfos&&0<
b.dynamicLayerInfos.length){var q=a.filter(b.dynamicLayerInfos,function(b){return g[f]==b.id})[0].source;k=new I(n+"/dynamicLayer",{id:b.id+"_"+g[f],source:q,outFields:m,mode:I.MODE_SELECTION,infoTemplate:e&&new d(e),drawMode:!1,visible:b.visible,autoGeneralize:!0});var z=function(d,a){0<r[d].length&&a.setDefinitionExpression(r[d]);if(!u.isDefined(t[d])&&!u.isDefined(v[d]))Pa(b,c||w.layers,a,g[d]);else if(u.isDefined(b.minScale)||u.isDefined(b.maxScale)){var e=b.minScale,n=b.maxScale;0==e&&0<t[d]?
e=t[d]:0<e&&0==t[d]||0<e&&0<t[d]&&(e=Math.min(e,t[d]));n=Math.max(n||0,v[d]||0);a.setScaleRange(e,n)}else a.setScaleRange(t[d],v[d])};k.loaded?z(f,k):l.connect(k,"onLoad",function(b){z(f,k)})}else{var x=null,y=n+"/"+g[f];if(s[f].length)y=s[f];else if(c)for(q=0;q<c.length;q++)if(c[q].id===g[f]){x=c[q];break}k=new I(aa(y),{id:b.id+"_"+g[f],outFields:m,mode:I.MODE_SELECTION,infoTemplate:e&&new d(e),drawMode:!1,visible:b.visible,resourceInfo:x,autoGeneralize:!0});k.loaded?(0<r[f].length&&k.setDefinitionExpression(r[f]),
Pa(b,c||w.layers,k,g[f])):l.connect(k,"onLoad",function(d){0<r[f].length&&k.setDefinitionExpression(r[f]);Pa(b,c||w.layers,d,g[f])})}h.push(k)}});0<h.length&&(l.connect(b,"onVisibilityChange",f.hitch(this,function(b,c){a.forEach(b,function(b){c?b.show():b.hide()})},h)),l.connect(e,"onLayerRemove",f.hitch(this,function(b,c,d){b.id===d.id&&a.forEach(c,function(b){e.removeLayer(b)})},b,h)));delete b.__popups;delete b.__popupIds;delete b.__popupUrls;delete b.__popupWhereClauses;delete b.__popupMinScales;
delete b.__popupMaxScales;delete b.__resourceInfo;return h}function Oa(b){return s({url:aa(b.url+"/layers"),content:{f:"json"},callbackParamName:"callback",error:function(){}})}function ka(b,c,d){var e=[];a.forEach(b,function(b){var c=b.__popups;c&&(1<c.length&&10<=b.version)&&(b.__deferredsPos=e.length,e.push(Oa(b)))});var n=[];0<e.length?(new g(e)).addCallback(function(e){a.forEach(b,function(b){b.__popups&&0<b.__popups.length&&(b.__deferredsPos||0===b.__deferredsPos?(n=n.concat(Za(b,e[b.__deferredsPos][1].layers,
d,c)),delete b.__deferredsPos):n=n.concat(Za(b,null,d,c)))});c.addLayers(n)}):(a.forEach(b,function(b){b.__popups&&0<b.__popups.length&&(n=n.concat(Za(b,null,d,c)))}),c.addLayers(n))}function $a(b){a.forEach(b,function(b){var c=b.layer;c.toJson&&(b=c.toJson(),b.featureSet&&(c.name&&-1<c.name.indexOf("Text"))&&a.forEach(b.featureSet.features,function(b,d){if(b.attributes.TEXT){var a=c.graphics[d];a.symbol.setText(b.attributes.TEXT);b.symbol.horizontalAlignment&&(a.symbol.align=b.symbol.horizontalAlignment);
a.setSymbol(a.symbol);a.setAttributes(b.attributes)}},this))})}function Qa(b){var c=6;a.forEach(b,function(b){if(b=b.renderer)"esri.renderer.SimpleRenderer"===b.declaredClass?((b=b.symbol)&&b.xoffset&&(c=Math.max(c,Math.abs(b.xoffset))),b&&b.yoffset&&(c=Math.max(c,Math.abs(b.yoffset)))):("esri.renderer.UniqueValueRenderer"===b.declaredClass||"esri.renderer.ClassBreaksRenderer"===b.declaredClass)&&a.forEach(b.infos,function(b){(b=b.symbol)&&b.xoffset&&(c=Math.max(c,Math.abs(b.xoffset)));b&&b.yoffset&&
(c=Math.max(c,Math.abs(b.yoffset)))})});return c}function Va(b){var c=this,d=c.infoWindow,e=b.graphic;if(c.loaded){d.hide();d.clearFeatures();var g=[];a.forEach(c.graphicsLayerIds,function(b){if((b=c.getLayer(b))&&b instanceof I&&b.loaded&&b.visible)b.clearSelection(),b.infoTemplate&&!b.suspended&&g.push(b)});a.forEach(c.layerIds,function(b){(b=c.getLayer(b))&&(-1!==b.declaredClass.indexOf("ArcGISImageServiceLayer")&&b.loaded&&b.visible&&b.infoTemplate)&&g.push(b)});e=e&&e.getInfoTemplate()?e:null;
if(g.length||e){var s=Qa(g),r=b.screenPoint,t=c.toMap(new n(r.x-s,r.y+s)),s=c.toMap(new n(r.x+s,r.y-s)),t=new w(t.x,t.y,s.x,s.y,c.spatialReference),v=new F;v.geometry=t;v.timeExtent=c.timeExtent;var u=!0,t=a.map(g,function(c){var d;-1!==c.declaredClass.indexOf("ArcGISImageServiceLayer")?(v.geometry=b.mapPoint,u=!1,d=c.queryVisibleRasters(v,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),d.addCallback(function(){return c.getVisibleRasters()})):(d=c.selectFeatures(v),d.addCallback(function(){return c.getSelectedFeatures()}));
return d});e&&(s=new k,s.callback([e]),t.splice(0,0,s));if(!a.some(t,function(b){return-1===b.fired})){var h=e?1:0;a.forEach(g,function(b){h=-1!==b.declaredClass.indexOf("ArcGISImageServiceLayer")?h+b.getVisibleRasters().length:h+b.getSelectedFeatures().length});if(!h)return}d.setFeatures(t);d.show(b.mapPoint,{closestFirst:u})}}}function Wa(c,d){var a=d.mapOptions||{},n;a.infoWindow||(n=new B({visibleWhenEmpty:!1},e.create("div")),a.infoWindow=n);!u.isDefined(a.showInfoWindowOnClick)&&!d.usePopupManager&&
(a.showInfoWindowOnClick=!1);a=new b(c,a);l.connect(a,"onLayersAddResult",$a);return a}function Ia(b,c,d,e,n,g){var s,r,t,v;e.map?(s=e.map,r=e.clickEventHandle,t=e.clickEventListener,v=e.errors):(s=Wa(e,n),!n.ignorePopups&&(!n.disableClickBehavior&&!n.usePopupManager)&&(r=l.connect(s,"onClick",Va),t=Va));s.addLayers(b);!n.ignorePopups&&!n.usePopupManager&&ka(b,s,n._clazz);var u=v||[];a.forEach(c,function(b){b.errors&&(u=u.concat(b.errors))},this);s.loaded?g.callback({map:s,itemInfo:d,errors:u,clickEventHandle:r,
clickEventListener:t}):l.connect(s,"onLoad",function(){g.callback({map:s,itemInfo:d,errors:u,clickEventHandle:r,clickEventListener:t})})}function R(b,c,d,e,n){var g=[];a.forEach(n,function(b){f.isArray(b.layerObject)?a.forEach(b.layerObject,function(b){g.push(b)}):g.push(b.layerObject)});if("BingMapsAerial"===n[0].type||"BingMapsRoad"===n[0].type||"BingMapsHybrid"===n[0].type)var s=setInterval(function(){if(n[0].layerObject&&n[0].layerObject.loaded)clearInterval(s),ya(b,c,d,e,n,g);else if(n[0].errors){clearInterval(s);
var a="";n[0].errors&&n[0].errors.length&&(a=" ("+n[0].errors[0].message+")");e.errback(Error(M.arcgis.utils.baseLayerError+a))}},10);else if(!g[0]&&n[0].baseMapLayer){var r="";n[0].errors&&n[0].errors.length&&(r=" ("+n[0].errors[0].message+")");e.errback(Error(M.arcgis.utils.baseLayerError+r))}else ya(b,c,d,e,n,g)}function ya(b,c,d,e,n,g){try{var s=d.mapOptions||{};d.mapOptions=s;var v=b.item;g=a.filter(g,u.isDefined);if(v)if(v.extent&&v.extent.length)if(s.extent)Ia(g,n,b,c,d,e);else{var h=new w(v.extent[0][0],
v.extent[0][1],v.extent[1][0],v.extent[1][1],new t({wkid:4326})),f=g[0].spatialReference;4326===f.wkid?(s.extent=h,Ia(g,n,b,c,d,e)):102100===f.wkid||102113===f.wkid||3857===f.wkid?(h.xmin=Math.max(h.xmin,-180),h.xmax=Math.min(h.xmax,180),h.ymin=Math.max(h.ymin,-89.99),h.ymax=Math.min(h.ymax,89.99),s.extent=x.geographicToWebMercator(h),Ia(g,n,b,c,d,e)):d.geometryServiceURL||r.defaults.geometryService?(d.geometryServiceURL?new E(d.geometryServiceURL):r.defaults.geometryService).project([h],f,function(a){a=
a[0];s.extent=s.extent||a;Ia(g,n,b,c,d,e)},function(){Ia(g,n,b,c,d,e)}):e.errback(Error(M.arcgis.utils.geometryServiceError))}else Ia(g,n,b,c,d,e);else Ia(g,n,b,c,d,e)}catch(k){e.errback(k)}}function Fa(b){var c=[];a.forEach(b.operationalLayers,function(b){b.featureCollection?c.push({featureCollection:b.featureCollection,visibility:b.visibility,title:b.title}):b.layerObject&&c.push({layer:b.layerObject,visibility:b.visibility,title:b.title})});return c}function $(b){var c=[];b=b.baseMap.baseMapLayers.concat(b.operationalLayers);
a.forEach(b,function(b){var d={};if(b.featureCollection&&"CSV"!==b.type)!0===b.featureCollection.showLegend&&a.forEach(b.featureCollection.layers,function(a){if(!1!==a.showLegend){var e=a.layerObject.renderer;d={layer:a.layerObject,title:b.title,defaultSymbol:e&&e.defaultSymbol&&e.defaultLabel?!0:!1};1<b.featureCollection.layers.length&&(d.title+=" - "+a.layerDefinition.name);c.push(d)}});else if(b.baseMapLayer&&!0===b.showLegend&&b.layerObject||!b.baseMapLayer&&!1!==b.showLegend&&b.layerObject&&
!(b.layerObject instanceof I&&b.layerObject.mode===I.MODE_SELECTION)){var e=b.layerObject.renderer,n=b.layerObject.declaredClass,e=!e||e&&e.defaultSymbol&&e.defaultLabel?!0:!1;if(10.1>b.layerObject.version&&("esri.layers.ArcGISDynamicMapServiceLayer"===n||"esri.layers.ArcGISTiledMapServiceLayer"===n)||"esri.layers.ArcGISImageServiceLayer"===n)e=!0;d={layer:b.layerObject,title:b.title,defaultSymbol:e};b.layers&&(n=a.map(a.filter(b.layers,function(b){return!1===b.showLegend}),function(b){return b.id}),
n.length&&(d.hideLayers=n));c.push(d)}});return c}function Sa(b,d){function e(b,c){a.forEach(b,function(b,d){switch(b){case ib:S=c[d];break;case Ta:fa=c[d];break;case sb:D=c[d];break;case Ga:ba=c[d];break;case tb:da=c[d];break;case ub:ja=c[d];break;case ab:W=c[d];break;case ra:Z=c[d];break;case vb:N=c[d];break;case wb:hb=c[d];break;case bb:Eb=c[d];break;case xb:Ra=c[d];break;case cb:Xa=c[d];break;case zb:Hb=c[d];break;case db:pb=c[d];break;case Ab:Fb=c[d];break;case jb:yb=c[d];break;case eb:ob=c[d];
break;case kb:Db=c[d];break;case lb:ma=c[d];break;case Ha:rb=c[d];break;case La:gb=c[d];break;case Ja:Cb=c[d];break;case Ba:qb=c[d]}})}var n=new k,g=b.itemData,s=[];g.baseMap&&g.baseMap.baseMapLayers&&(s=s.concat(g.baseMap.baseMapLayers));g.operationalLayers&&(s=s.concat(g.operationalLayers));for(var g=a.map(s,function(b){return b&&b.layerType}),r=[],t=[],s=!1,v=0;v<g.length;v++){switch(g[v]){case "ArcGISFeatureLayer":-1===a.indexOf(r,bb)&&r.push(bb);break;case "ArcGISImageServiceLayer":case "ArcGISTiledImageServiceLayer":-1===
a.indexOf(r,Ta)&&(r.push(Ta),t.push(vb),t.push(cb),t.push(db));break;case "ArcGISImageServiceVectorLayer":-1===a.indexOf(r,sb)&&(r.push(sb),t.push(vb),t.push(cb),t.push(db));break;case "ArcGISMapServiceLayer":case "ArcGISTiledMapServiceLayer":-1===a.indexOf(r,ib)&&(r.push(ib),t.push(ub),t.push(ra),t.push(xb));break;case "ArcGISStreamLayer":-1===a.indexOf(r,Ab)&&r.push(Ab);break;case "BingMapsAerial":case "BingMapsHybrid":case "BingMapsRoad":-1===a.indexOf(r,lb)&&r.push(lb);break;case "CSV":-1===a.indexOf(r,
tb)&&(r.push(tb),t.push(Ga));break;case "GeoRSS":-1===a.indexOf(r,ab)&&r.push(ab);break;case "KML":-1===a.indexOf(r,wb)&&r.push(wb);break;case "OpenStreetMap":-1===a.indexOf(r,zb)&&r.push(zb);break;case "VectorTileLayer":-1===a.indexOf(r,kb)&&(r.push(kb),c("ie")||t.push(eb));break;case "WebTiledLayer":-1===a.indexOf(r,Ha)&&(r.push(Ha),t.push(jb));break;case "WFS":-1===a.indexOf(r,La)&&r.push(La);break;case "WMS":-1===a.indexOf(r,Ja)&&(r.push(Ja),t.push(Ba));break;default:s=!0}if(s)break}s&&(r=Na,
t=Ua);r.length?p(r,function(){e(r,arguments);t.length?p(t,function(){e(t,arguments);n.resolve()}):n.resolve()}):n.resolve();return n}function Ma(b,c,d,e){var n=e.itemData;n.baseMap&&(n.baseMap.baseMapLayers&&n.baseMap.baseMapLayers.length)&&(n.baseMap.baseMapLayers[0].firstLayer=!0);var g=c.layerMixins,s=g&&g.length;if(s){var r=function(b){for(var c=0;c<s;c++){var d=g[c];if(d.mixin)if(d.hasOwnProperty("id")){if(b.id===d.id){f.mixin(b,d.mixin);break}}else if(b.url===d.url){f.mixin(b,d.mixin);break}}};
a.forEach(n.baseMap&&n.baseMap.baseMapLayers,r);a.forEach(n.operationalLayers,r)}Sa(e,c).then(function(){return P(e,c)}).then(function(){return T(e,c)}).then(function(c){var e=c[0],n=c[1];if(!e.itemData.operationalLayers||0===e.itemData.operationalLayers.length)G(e,n).addCallback(function(c){va(c.itemData,n).addCallback(f.hitch(null,R,c,b,n,d))});else{var g=new k,s=e.itemData.baseMap.baseMapLayers.slice(),r=a.filter(e.itemData.baseMap.baseMapLayers,function(b){return!b.isReference});c={item:e.item,
itemData:{baseMap:{baseMapLayers:r}}};e.itemData.baseMap.baseMapLayers=a.filter(e.itemData.baseMap.baseMapLayers,function(b){return b.isReference});G(c,n).addCallback(function(c){va(c.itemData,n).addCallback(f.hitch(null,R,c,b,n,g))});g.then(function(b){G(e,n).addCallback(function(c){va(c.itemData,n,b.map.spatialReference,r,b.map).addCallback(function(a){c.itemData.baseMap.baseMapLayers=s;R(c,b,n,d,a)})})},f.hitch(d,d.errback))}})}function ca(b,c){"undefined"===typeof c&&(c=!0);wa._arcgisUrl&&0<wa._arcgisUrl.length&&
(wa.arcgisUrl=wa._arcgisUrl);var d=wa.arcgisUrl+"/"+b,a={},e=new k;s({url:d,content:{f:"json"},callbackParamName:"callback",load:function(b){a.item=b;c?s({url:d+"/data",content:{f:"json"},callbackParamName:"callback",load:function(b){a.itemData=b;e.callback(a)},error:function(b){e.errback(b)}}):e.callback(a)},error:function(b){e.errback(b)}});return e}var wa,S,fa,D,ba,da,ja,W,Z,N,hb,Eb,Ra,Xa,Hb,pb,Fb,yb,ob,Db,ma,rb,gb,Cb,qb,ib="../layers/ArcGISDynamicMapServiceLayer",Ta="../layers/ArcGISImageServiceLayer",
sb="../layers/ArcGISImageServiceVectorLayer",Ga="./csv",tb="../layers/CSVLayer",ub="../layers/DynamicLayerInfo",ab="../layers/GeoRSSLayer",ra="../layers/ImageParameters",vb="../layers/ImageServiceParameters",wb="../layers/KMLLayer",bb="../layers/LabelClass",xb="../layers/LayerDrawingOptions",cb="../layers/MosaicRule",zb="../layers/OpenStreetMapLayer",db="../layers/RasterFunction",Ab="../layers/StreamLayer",jb="../layers/TileInfo",eb="../layers/vector-tile",kb="../layers/VectorTileLayer",lb="../virtualearth/VETiledLayer",
Ha="../layers/WebTiledLayer",La="../layers/WFSLayer",Ja="../layers/WMSLayer",Ba="../layers/WMSLayerInfo",Na=[ib,Ta,sb,tb,ab,wb,bb,zb,Ab,kb,lb,Ha,La,Ja],Ua=[Ga,ub,ra,vb,xb,cb,db,jb,eb,Ba];wa={arcgisUrl:location.protocol+"//www.arcgis.com/sharing/rest/content/items",getItem:ca,createMap:function(b,c,d){var a=new k;d=d||{};var e=d.infoTemplateClass;d._clazz=e&&(f.isObject(e)?e:f.getObject(e))||A;f.isString(b)?ca(b).addCallback(f.hitch(null,Ma,c,d,a)).addErrback(f.hitch(a,a.errback)):Ma(c,d,a,b);return a},
getLayerList:function(b){return b&&b.itemInfo&&b.itemInfo.itemData?Fa(b.itemInfo.itemData):[]},getLegendLayers:function(b){return b&&b.itemInfo&&b.itemInfo.itemData?$(b.itemInfo.itemData):[]},_arcgisUrl:null,_getItemProps:G,_getItemData:Q,_getBingKey:K,_portalUrlResponse:V,_portalUrlFailure:L,_processFSItemProperties:J,_processSSItemProperties:O,_getLayers:va,_preBuildLayerObjects:Aa,_buildLayerObjects:ea,_preCreateMap:R,_getMapSR:pa,_createMap:Ia,_addSelectionLayers:ka,_createSelectionFeatureLayers:Za,
_getServiceInfo:Ea,_getFeatureCollectionItem:ua,_mergeFeatureCollectionItem:Ca,_projectFeatureCollection:ta,_getLayersInfo:Oa,_initLayer:sa,_loadAsCached:ga,_loadAsDynamic:za,_processPopups:X,_onLayersAddResult:$a,_sameSpatialReferenceAsBasemap:oa,_sameTilingSchemeAsBasemap:xa,_showPopup:Va,_calculateClickTolerance:Qa,_getVisibleFeatureLayers:qa,_updateLayerScaleInfo:Pa,_checkUrl:aa,_isHostedService:Y,_isAgolService:la,_getLegendLayers:$};f.setObject("arcgis.utils",wa,d);return wa})},"dojo/_base/url":function(){define(["./kernel"],
function(p){var f=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,a=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,l=function(){for(var k=arguments,h=[k[0]],q=1;q<k.length;q++)if(k[q]){var m=new l(k[q]+""),h=new l(h[0]+"");if(""==m.path&&!m.scheme&&!m.authority&&!m.query)null!=m.fragment&&(h.fragment=m.fragment),m=h;else if(!m.scheme&&(m.scheme=h.scheme,!m.authority&&(m.authority=h.authority,"/"!=m.path.charAt(0)))){for(var h=(h.path.substring(0,h.path.lastIndexOf("/")+
1)+m.path).split("/"),g=0;g<h.length;g++)"."==h[g]?g==h.length-1?h[g]="":(h.splice(g,1),g--):0<g&&(!(1==g&&""==h[0])&&".."==h[g]&&".."!=h[g-1])&&(g==h.length-1?(h.splice(g,1),h[g-1]=""):(h.splice(g-1,2),g-=2));m.path=h.join("/")}h=[];m.scheme&&h.push(m.scheme,":");m.authority&&h.push("//",m.authority);h.push(m.path);m.query&&h.push("?",m.query);m.fragment&&h.push("#",m.fragment)}this.uri=h.join("");k=this.uri.match(f);this.scheme=k[2]||(k[1]?"":null);this.authority=k[4]||(k[3]?"":null);this.path=
k[5];this.query=k[7]||(k[6]?"":null);this.fragment=k[9]||(k[8]?"":null);null!=this.authority&&(k=this.authority.match(a),this.user=k[3]||null,this.password=k[4]||null,this.host=k[6]||k[7],this.port=k[9]||null)};l.prototype.toString=function(){return this.uri};return p._Url=l})},"dojo/DeferredList":function(){define(["./_base/kernel","./_base/Deferred","./_base/array"],function(p,f,a){p.DeferredList=function(l,k,h,q,m){var g=[];f.call(this);var e=this;0===l.length&&!k&&this.resolve([0,[]]);var c=0;
a.forEach(l,function(d,a){function u(d,t){g[a]=[d,t];c++;c===l.length&&e.resolve(g)}d.then(function(c){k?e.resolve([a,c]):u(!0,c)},function(c){h?e.reject(c):u(!1,c);if(q)return null;throw c;})})};p.DeferredList.prototype=new f;p.DeferredList.prototype.gatherResults=function(f){f=new p.DeferredList(f,!1,!0,!1);f.addCallback(function(f){var h=[];a.forEach(f,function(a){h.push(a[1])});return h});return f};return p.DeferredList})},"esri/config":function(){define(["dojo/_base/config","dojo/topic","dojo/has",
"./kernel"],function(p,f,a,l){a={defaults:{screenDPI:96,geometryService:null,kmlService:null,map:{width:400,height:400,layerNamePrefix:"layer",graphicsLayerNamePrefix:"graphicsLayer",slider:{left:"30px",top:"30px",width:null,height:"200px"},sliderLabel:{tick:5,labels:null,style:"width:2em; font-family:Verdana; font-size:75%;"},sliderChangeImmediate:!0,zoomSymbol:{color:[0,0,0,64],outline:{color:[255,0,0,255],width:1.25,style:"esriSLSSolid"},style:"esriSFSSolid"},zoomDuration:500,zoomRate:25,panDuration:350,
panRate:25,logoLink:"http://www.esri.com"},autoSpatialIndexing:window.Worker&&!1,io:{errorHandler:function(a,h){f.publish("esri.Error",[a])},proxyUrl:null,alwaysUseProxy:!1,useCors:"with-credentials",corsEnabledServers:"server.arcgisonline.com services.arcgisonline.com www.arcgis.com tiles.arcgis.com tiles1.arcgis.com tiles2.arcgis.com tiles3.arcgis.com tiles4.arcgis.com basemaps.arcgis.com elevation3d.arcgis.com services.arcgis.com services1.arcgis.com services2.arcgis.com services3.arcgis.com services4.arcgis.com services5.arcgis.com services6.arcgis.com services7.arcgis.com static.arcgis.com utility.arcgisonline.com geocode.arcgis.com geoenrich.arcgis.com qaext.arcgis.com tilesqa.arcgis.com servicesqa.arcgis.com servicesqa1.arcgis.com servicesqa2.arcgis.com servicesqa3.arcgis.com geocodeqa.arcgis.com geoenrichqa.arcgis.com dev.arcgis.com devext.arcgis.com staticdev.arcgis.com tilesdevext.arcgis.com elevation3ddev.arcgis.com servicesdev.arcgis.com servicesdev1.arcgis.com servicesdev2.arcgis.com servicesdev3.arcgis.com geocodedev.arcgis.com geoenrichdev.arcgis.com basemapsdev.arcgis.com".split(" "),
corsDetection:window.cordova?!1:!0,corsStatus:{},webTierAuthServers:[],proxyRules:[],postLength:2E3,timeout:6E4,useWorkers:"on-request",maxRequestWorkers:5}}};p.noGlobals||(window.esriConfig=a);return a})},"esri/request":function(){define("require dojo/_base/array dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/_base/url dojo/_base/xhr dojo/io/script dojo/io/iframe dojo/dom-construct dojo/io-query ./kernel ./config ./sniff ./lang ./urlUtils ./deferredUtils".split(" "),function(p,f,a,l,
k,h,q,m,g,e,c,d,r,u,s,t,b){function v(b){b=new h(b);return(b.host+(b.port?":"+b.port:"")).toLowerCase()}function n(b,n,r,v){var w=!1,h=!1,z;s.isDefined(n)&&(k.isObject(n)?(w=!!n.useProxy,h=!!n.usePost,z=n.crossOrigin):w=!!n);b=k.mixin({},b);b._ssl&&(b.url=b.url.replace(/^http:/i,"https:"));n=b.content;var x=b.url,y=r&&b.form,p=B;z=s.isDefined(z)?z:p.useCors;b.load=function(b){var c;b&&(b.error?(c=k.mixin(Error(),b.error),c.log=a.isDebug):"error"===b.status&&(c=k.mixin(Error(),b),c.log=a.isDebug),
c&&!s.isDefined(c.httpCode)&&(c.httpCode=c.code));return c||b};b.error=function(b,c){c&&c.xhr&&c.xhr.abort();b instanceof Error||(b=k.mixin(Error(),b));b.log=a.isDebug;p.errorHandler(b,c);return b};b._token&&(b.content=b.content||{},b.content.token=b._token);var F=0,L;n&&x&&(L=c.objectToQuery(n),F=L.length+x.length+1,u("esri-url-encodes-apostrophe")&&(F=L.replace(/'/g,"%27").length+x.length+1));b.timeout=s.isDefined(b.timeout)?b.timeout:p.timeout;b.handleAs=b.handleAs||"json";try{var C,X,Y=z&&t.canUseXhr(b.url)&&
!/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i.test(b.url),la=t.hasSameOrigin(b.url,window.location.href)||Y,aa=h||r||F>p.postLength?!0:!1,ga=!la&&-1!==b.handleAs.indexOf("json")&&b.callbackParamName&&!r?!0:!1,qa=t.getProxyRule(b.url)||p.alwaysUseProxy||w||(!ga||aa)&&!la?!0:!1;r&&(!u("esri-file-upload")&&!qa&&Y)&&(qa=!0);if(qa)if(C=t.getProxyUrl(x,z),X=C.path,C._xo&&(Y=!0),!aa&&X.length+1+F>p.postLength&&(aa=!0),b.url=X+"?"+x,aa)b.content=k.mixin(C.query||{},n);else{var za=c.objectToQuery(k.mixin(C.query||
{},n));za&&(b.url+="?"+za);b.content=null}if(ga&&!aa)return!s.isDefined(b.isAsync)&&4>u("ff")&&(b.isAsync=!0),m.get(A?A(b):b);var ia=b.headers;if(Y&&(!ia||!ia.hasOwnProperty("X-Requested-With")))ia=b.headers=ia||{},ia["X-Requested-With"]=null;if(r){var oa=b.callbackParamName||"callback.html",xa=b.callbackElementName||"textarea",sa,ea,pa,Aa,Da=y.elements?y.elements.length:0,Ea;if(n=b.content)for(sa in n)if(pa=n[sa],s.isDefined(pa)){ea=null;for(Aa=0;Aa<Da;Aa++)if(Ea=y.elements[Aa],Ea.name===sa){ea=
Ea;break}ea?ea.value=pa:v?y.append(sa,pa):y.appendChild(e.create("input",{type:"hidden",name:sa,value:pa}))}if(u("esri-file-upload"))f.forEach(y.elements,function(b){b.name===oa&&y.removeChild(b)}),b.contentType=!1,b.postData=v?y:new FormData(y),delete b.form;else{y.enctype="multipart/form-data";9>u("ie")&&(y.encoding="multipart/form-data");y.method="post";f.some(y.elements,function(b){return b.name===oa})||y.appendChild(e.create("input",{type:"hidden",name:oa,value:xa}));if(-1!==x.toLowerCase().indexOf("addattachment")||
-1!==x.toLowerCase().indexOf("updateattachment"))b.url=x+(-1===x.indexOf("?")?"?":"\x26")+oa+"\x3d"+xa,qa&&(b.url=X+"?"+b.url);delete b.content}}if(Y&&!b.hasOwnProperty("withCredentials")&&"with-credentials"===B.useCors){v=qa?X:x;var ua=t.canUseXhr(v,!0),Ca=-1<ua?B.corsEnabledServers[ua]:null;if(Ca&&Ca.hasOwnProperty("withCredentials"))Ca.withCredentials&&(b.withCredentials=!0);else if(d.id){var ta=d.id.findServerInfo(v);ta&&ta.webTierAuth&&(b.withCredentials=!0)}}b=A?A(b):b;if(aa){if(r&&!u("esri-file-upload"))return g.send(b);
!qa&&u("safari")&&(b.url+=(-1===b.url.indexOf("?")?"?":"\x26")+"_ts\x3d"+(new Date).getTime()+E++);return q.post(b)}return q.get(b)}catch(va){return r=new l,r.errback(b.error(va)),r}}function w(b){var c=B.corsStatus,d=t.canUseXhr(b,!0);-1<d&&B.corsEnabledServers.splice(d,1);c[v(b)]=1;return d}function x(b){var c=B.corsStatus;if(B.corsDetection&&B.useCors)try{var d=v(b);u("esri-cors")&&(b&&-1!==b.toLowerCase().indexOf("/rest/services")&&!t.hasSameOrigin(b,window.location.href)&&!t.canUseXhr(b)&&!c[d])&&
(c[d]=-1,q.get({url:b.substring(0,b.toLowerCase().indexOf("/rest/")+6)+"info",content:{f:"json"},failOk:!0,handleAs:"json",headers:{"X-Requested-With":null}}).then(function(a){a?(c[d]=2,t.canUseXhr(b)||B.corsEnabledServers.push(d)):c[d]=1},function(b){c[d]=1}))}catch(a){console.log("esri._detectCors: an unknown error occurred while detecting CORS support")}}function z(c,e){function g(b){b._pendingDfd=n(c,e,V,P);if(!b._pendingDfd){b.ioArgs=b._pendingDfd&&b._pendingDfd.ioArgs;var r=Error("Deferred object is missing");
r.log=a.isDebug;c._usrDfd=null;b.errback(r);b._pendingDfd=null;return b}b._pendingDfd.addCallback(function(d){b.ioArgs=b._pendingDfd&&b._pendingDfd.ioArgs;c._usrDfd=null;b.callback(d);b._pendingDfd=null}).addErrback(function(a){var n,g,r;a&&(n=a.code,g=a.subcode,r=(r=a.messageCode)&&r.toUpperCase());if(a&&403==n&&(4==g||a.message&&-1<a.message.toLowerCase().indexOf("ssl")&&-1===a.message.toLowerCase().indexOf("permission"))){if(!c._ssl){c._ssl=c._sslFromServer=!0;c._usrDfd=b;z(c,e);return}}else if(a&&
415==a.status){if(w(c.url),!c._err415){c._err415=1;c._usrDfd=b;z(c,e);return}}else if(d.id&&-1!==f.indexOf(d.id._errorCodes,n)&&!d.id._isPublic(c.url)&&!k&&(403!=n||-1===f.indexOf(F,r)&&(!s.isDefined(g)||2==g&&c._token))){b._pendingDfd=d.id.getCredential(c.url,{token:c._token,error:a});b._pendingDfd.addCallback(function(d){c._token=d.token;c._usrDfd=b;c._credential=d;c._ssl=c._sslFromServer||d.ssl;z(c,e)}).addErrback(function(d){c._usrDfd=null;b.errback(d);b._pendingDfd=null});return}b.ioArgs=b._pendingDfd&&
b._pendingDfd.ioArgs;c._usrDfd=null;b.errback(a);b._pendingDfd=null})}c.url=t.fixUrl(c.url);"file:"!==window.location.protocol&&(c.url=t.getAbsoluteUrl(c.url));e=e||{};var r,h=c.form,k=e.disableIdentityLookup,m=e._preLookup,A=!1;if(u("esri-workers")&&!1!==B.useWorkers)if(!0===e.useWorkers||!0===B.useWorkers)A=!0;else if(e.workerOptions){var E=e.workerOptions;if(E.callback||E.worker&&E.worker.worker instanceof Worker)A=!0}var P=h&&h.append,V=h&&(h.elements?f.some(h.elements,function(b){return"file"===
b.type}):P),L=-1!==c.url.toLowerCase().indexOf("token\x3d")||c.content&&c.content.token||V&&f.some(h.elements,function(b){return"token"===b.name})?1:0;x(c.url);if(c._usrDfd)r=c._usrDfd;else{r=new l(b._dfdCanceller);r.addCallback(function(b){if((/\/sharing\/rest\/accounts\/self/i.test(c.url)||/\/sharing\/rest\/portals\/self/i.test(c.url))&&!L&&!c._token&&b.user&&b.user.username){B.webTierAuthServers.push(v(c.url));b=B.corsEnabledServers;var a=t.canUseXhr(c.url,!0),e={host:v(c.url),withCredentials:!0};
if(-1===a)b.push(e);else{var n=b[a];"object"===typeof n?n.withCredentials=!0:b.splice(a,1,e)}}if(b=c._credential)if(a=(a=d.id.findServerInfo(b.server))&&a.owningSystemUrl)a=a.replace(/\/?$/,"/sharing"),(b=d.id.findCredential(a,b.userId))&&-1===d.id._getIdenticalSvcIdx(a,b)&&b.resources.splice(0,0,a)});r.addBoth(function(b){delete c._credential;if(b&&(!u("ie")||!b.nodeType))b._ssl=c._ssl});var C=c.load,X=c.error;C&&r.addCallback(function(b){var c=r._pendingDfd,c=c&&c.ioArgs;return C.call(c&&c.args,
b,c)});X&&r.addErrback(function(b){var c=r._pendingDfd,c=c&&c.ioArgs;return X.call(c&&c.args,b,c)})}if(d.id&&!L&&!c._token&&!d.id._isPublic(c.url)&&(!k||m))if(h=d.id.findCredential(c.url))c._token=h.token,c._ssl=h.ssl;A?e.workerOptions&&e.workerOptions.worker?(y||(y=q),q=e.workerOptions.worker,g(r)):p(["./workers/RequestClient"],function(b){y||(y=q);if(e.workerOptions){var c=e.workerOptions;q=b.getClient(c.callback,c.cbFunction)}else q=b.getClient();g(r)}):(y&&(q=y,y=null),g(r));return r}var y=null,
A,B=r.defaults.io,F=["COM_0056","COM_0057"],E=0;z._request=n;z._disableCors=w;z._detectCors=x;z.setRequestPreCallback=function(b){A=b};return z})},"dojo/io/script":function(){define("../_base/connect ../_base/kernel ../_base/lang ../sniff ../_base/window ../_base/xhr ../dom ../dom-construct ../request/script ../aspect".split(" "),function(p,f,a,l,k,h,q,m,g,e){f.deprecated("dojo/io/script","Use dojo/request/script.","2.0");var c={get:function(d){var a,u=this._makeScriptDeferred(d,function(c){a&&a.cancel()}),
s=u.ioArgs;h._ioAddQueryToUrl(s);h._ioNotifyStart(u);a=g.get(s.url,{timeout:d.timeout,jsonp:s.jsonp,checkString:d.checkString,ioArgs:s,frameDoc:d.frameDoc,canAttach:function(d){s.requestId=d.id;s.scriptId=d.scriptId;s.canDelete=d.canDelete;return c._canAttach(s)}},!0);e.around(a,"isValid",function(d){return function(b){c._validCheck(u);return d.call(this,b)}});a.then(function(){u.resolve(u)}).otherwise(function(c){u.ioArgs.error=c;u.reject(c)});return u},attach:g._attach,remove:g._remove,_makeScriptDeferred:function(d,
a){var e=h._ioSetArgs(d,a||this._deferredCancel,this._deferredOk,this._deferredError),s=e.ioArgs;s.id=f._scopeName+"IoScript"+(d.callbackSuffix||this._counter++);s.canDelete=!1;s.jsonp=d.callbackParamName||d.jsonp;s.jsonp&&(s.query=s.query||"",0<s.query.length&&(s.query+="\x26"),s.query+=s.jsonp+"\x3d"+(d.frameDoc?"parent.":"")+f._scopeName+".io.script.jsonp_"+s.id+"._jsonpCallback",s.frameDoc=d.frameDoc,s.canDelete=!0,e._jsonpCallback=this._jsonpCallback,this["jsonp_"+s.id]=e);e.addBoth(function(d){s.canDelete&&
(d instanceof Error?c["jsonp_"+s.id]._jsonpCallback=function(){delete c["jsonp_"+s.id];if(s.requestId)f.global[g._callbacksProperty][s.requestId]()}:c._addDeadScript(s))});return e},_deferredCancel:function(c){c.canceled=!0},_deferredOk:function(c){c=c.ioArgs;return c.json||c.scriptLoaded||c},_deferredError:function(c,a){console.log("dojo.io.script error",c);return c},_deadScripts:[],_counter:1,_addDeadScript:function(d){c._deadScripts.push({id:d.id,frameDoc:d.frameDoc});d.frameDoc=null},_validCheck:function(d){if((d=
c._deadScripts)&&0<d.length){for(var a=0;a<d.length;a++)c.remove(d[a].id,d[a].frameDoc),delete c["jsonp_"+d[a].id],d[a].frameDoc=null;c._deadScripts=[]}return!0},_ioCheck:function(c){c=c.ioArgs;return c.json||c.scriptLoaded&&!c.args.checkString?!0:(c=c.args.checkString)&&eval("typeof("+c+") !\x3d 'undefined'")},_resHandle:function(d){c._ioCheck(d)?d.callback(d):d.errback(Error("inconceivable dojo.io.script._resHandle error"))},_canAttach:function(){return!0},_jsonpCallback:function(c){this.ioArgs.json=
c;if(this.ioArgs.requestId)f.global[g._callbacksProperty][this.ioArgs.requestId](c)}};a.setObject("dojo.io.script",c);return c})},"dojo/io/iframe":function(){define("../_base/config ../_base/json ../_base/kernel ../_base/lang ../_base/xhr ../sniff ../_base/window ../dom ../dom-construct ../query require ../aspect ../request/iframe".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r){a.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");h=r._iframeName;h=h.substring(0,h.lastIndexOf("_"));var u=
l.delegate(r,{create:function(){return u._frame=r.create.apply(r,arguments)},get:null,post:null,send:function(c){var e,b=k._ioSetArgs(c,function(b){e&&e.cancel()},function(b){var c=null;b=b.ioArgs;try{var d=b.handleAs;"xml"===d||"html"===d?c=e.response.data:(c=e.response.text,"json"===d?c=f.fromJson(c):"javascript"===d&&(c=a.eval(c)))}catch(n){c=n}return c},function(b,c){c.ioArgs._hasError=!0;return b}),g=b.ioArgs,n="GET",u=m.byId(c.form);c.method&&("POST"===c.method.toUpperCase()&&u)&&(n="POST");
c={method:n,handleAs:"json"===c.handleAs||"javascript"===c.handleAs?"text":c.handleAs,form:c.form,query:u?null:c.content,data:u?c.content:null,timeout:c.timeout,ioArgs:g};c.method&&(c.method=c.method.toUpperCase());if(p.ioPublish&&a.publish&&!1!==g.args.ioPublish)var h=d.after(r,"_notifyStart",function(c){c.options.ioArgs===g&&(h.remove(),k._ioNotifyStart(b))},!0);e=r(g.url,c,!0);g._callNext=e._callNext;e.then(function(){b.resolve(b)}).otherwise(function(c){b.ioArgs.error=c;b.reject(c)});return b},
_iframeOnload:q.global[h+"_onload"]});l.setObject("dojo.io.iframe",u);return u})},"dojo/request/iframe":function(){define("module require ./watch ./util ./handlers ../_base/lang ../io-query ../query ../has ../dom ../dom-construct ../_base/window ../NodeList-dom".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d){function r(b){return!this.isFulfilled()}function u(b){return!!this._finished}function s(c,d){if(!d)try{var a=c.options,e=b.doc(b._frame),n=a.handleAs;if("html"!==n){if("xml"===n)if("html"===e.documentElement.tagName.toLowerCase()){m("a",
e.documentElement).orphan();var g=e.documentElement.innerText||e.documentElement.textContent,g=g.replace(/>\s+</g,"\x3e\x3c");c.text=h.trim(g)}else c.data=e;else c.text=e.getElementsByTagName("textarea")[0].value;k(c)}else c.data=e}catch(r){d=r}d?this.reject(d):this._finished?this.resolve(c):this.reject(Error("Invalid dojo/request/iframe request state"))}function t(b){this._callNext()}function b(c,d,e){var g=l.parseArgs(c,l.deepCreate(w,d),!0);c=g.url;d=g.options;if("GET"!==d.method&&"POST"!==d.method)throw Error(d.method+
" not supported by dojo/request/iframe");b._frame||(b._frame=b.create(b._iframeName,n+"();"));c=l.deferred(g,null,r,u,s,t);c._callNext=function(){this._calledNext||(this._calledNext=!0,b._currentDfd=null,b._fireNextRequest())};c._legacy=e;b._dfdQueue.push(c);b._fireNextRequest();a(c);return e?c:c.promise}var v=p.id.replace(/[\/\.\-]/g,"_"),n=v+"_onload";d.global[n]||(d.global[n]=function(){var d=b._currentDfd;if(d){var a=e.byId(d.response.options.form)||d._tmpForm;if(a){for(var n=d._contentToClean,
g=0;g<n.length;g++)for(var r=n[g],s=0;s<a.childNodes.length;s++){var t=a.childNodes[s];if(t.name===r){c.destroy(t);break}}d._originalAction&&a.setAttribute("action",d._originalAction);d._originalMethod&&(a.setAttribute("method",d._originalMethod),a.method=d._originalMethod);d._originalTarget&&(a.setAttribute("target",d._originalTarget),a.target=d._originalTarget)}d._tmpForm&&(c.destroy(d._tmpForm),delete d._tmpForm);d._finished=!0}else b._fireNextRequest()});var w={method:"POST"};b.create=function(b,
a,e){if(d.global[b])return d.global[b];if(d.global.frames[b])return d.global.frames[b];e||(g("config-useXDomain")&&!g("config-dojoBlankHtmlUrl")&&console.warn("dojo/request/iframe: When using cross-domain Dojo builds, please save dojo/resources/blank.html to your domain and set dojoConfig.dojoBlankHtmlUrl to the path on your domain to blank.html"),e=g("config-dojoBlankHtmlUrl")||f.toUrl("dojo/resources/blank.html"));a=c.place('\x3ciframe id\x3d"'+b+'" name\x3d"'+b+'" src\x3d"'+e+'" onload\x3d"'+a+
'" style\x3d"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden"\x3e',d.body());return d.global[b]=a};b.doc=function(b){if(b.contentDocument)return b.contentDocument;var c=b.name;if(c){var a=d.doc.getElementsByTagName("iframe");if(b.document&&a[c].contentWindow&&a[c].contentWindow.document)return a[c].contentWindow.document;if(d.doc.frames[c]&&d.doc.frames[c].document)return d.doc.frames[c].document}return null};b.setSrc=function(b,c,a){b=d.global.frames[b.name];
b.contentWindow&&(b=b.contentWindow);try{a?b.location.replace(c):b.location=c}catch(e){console.log("dojo/request/iframe.setSrc: ",e)}};b._iframeName=v+"_IoIframe";b._notifyStart=function(){};b._dfdQueue=[];b._currentDfd=null;b._fireNextRequest=function(){var a;try{if(!b._currentDfd&&b._dfdQueue.length){do a=b._currentDfd=b._dfdQueue.shift();while(a&&(a.canceled||a.isCanceled&&a.isCanceled())&&b._dfdQueue.length);if(!a||a.canceled||a.isCanceled&&a.isCanceled())b._currentDfd=null;else{var n=a.response,
g=n.options,r=a._contentToClean=[],s=e.byId(g.form),t=l.notify,u=g.data||null,w;!a._legacy&&"POST"===g.method&&!s?s=a._tmpForm=c.create("form",{name:v+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},d.body()):"GET"===g.method&&(s&&-1<n.url.indexOf("?"))&&(w=n.url.slice(n.url.indexOf("?")+1),u=h.mixin(q.queryToObject(w),u));if(s){if(!a._legacy){var f=s;do f=f.parentNode;while(f&&f!==d.doc.documentElement);f||(s.style.position="absolute",s.style.left="-1000px",s.style.top="-1000px",
d.body().appendChild(s));s.name||(s.name=v+"_form")}if(u){var f=function(b,d){c.create("input",{type:"hidden",name:b,value:d},s);r.push(b)},k;for(k in u){var m=u[k];if(h.isArray(m)&&1<m.length)for(w=0;w<m.length;w++)f(k,m[w]);else s[k]?s[k].value=m:f(k,m)}}var p=s.getAttributeNode("action"),J=s.getAttributeNode("method"),O=s.getAttributeNode("target");n.url&&(a._originalAction=p?p.value:null,p?p.value=n.url:s.setAttribute("action",n.url));if(a._legacy){if(!J||!J.value)J?J.value=g.method:s.setAttribute("method",
g.method)}else a._originalMethod=J?J.value:null,J?J.value=g.method:s.setAttribute("method",g.method);a._originalTarget=O?O.value:null;O?O.value=b._iframeName:s.setAttribute("target",b._iframeName);s.target=b._iframeName;t&&t.emit("send",n,a.promise.cancel);b._notifyStart(n);s.submit()}else g="",n.options.data&&(g=n.options.data,"string"!==typeof g&&(g=q.objectToQuery(g))),f=n.url+(-1<n.url.indexOf("?")?"\x26":"?")+g,t&&t.emit("send",n,a.promise.cancel),b._notifyStart(n),b.setSrc(b._frame,f,!0)}}}catch(G){a.reject(G)}};
l.addCommonMethods(b,["GET","POST"]);return b})},"esri/sniff":function(){define(["dojo/_base/sniff","./kernel"],function(p,f){var a=p("ff"),l=p("ie"),k=void 0===l&&7<=p("trident"),h=p("webkit"),q=p("opera"),m=p("chrome"),g=p("safari"),e=navigator.userAgent,c;(c=e.match(/(iPhone|iPad|CPU)\s+OS\s+(\d+\_\d+)/i))&&p.add("esri-iphone",parseFloat(c[2].replace("_",".")));(c=e.match(/Android\s+(\d+\.\d+)/i))&&p.add("esri-android",parseFloat(c[1]));(c=e.match(/Fennec\/(\d+\.\d+)/i))&&p.add("esri-fennec",parseFloat(c[1]));
0<=e.indexOf("BlackBerry")&&0<=e.indexOf("WebKit")&&p.add("esri-blackberry",1);p.add("esri-touch",p("esri-iphone")||p("esri-android")||p("esri-blackberry")||6<=p("esri-fennec")||(a||h)&&document.createTouch?!0:!1);(c=e.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i))&&p.add("esri-mobile",c);p.add("esri-pointer",navigator.pointerEnabled||navigator.msPointerEnabled);f._getDOMAccessor=function(c){var e="";a?e="Moz":h?e="Webkit":l?e="ms":q&&(e="O");return e+c.charAt(0).toUpperCase()+
c.substr(1)};p.add("esri-phonegap",!!window.cordova);p.add("esri-cors",p("esri-phonegap")||window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest);p.add("esri-file-upload",window.FormData&&window.FileList?!0:!1);p.add("esri-workers",window.Worker?!0:!1);p.add("esri-transforms",k||9<=l||3.5<=a||4<=m||3.1<=g||10.5<=q||3.2<=p("esri-iphone")||2.1<=p("esri-android"));p.add("esri-transitions",k||10<=l||4<=a||4<=m||3.1<=g||10.5<=q||3.2<=p("esri-iphone")||2.1<=p("esri-android"));p.add("esri-transforms3d",
k||10<=a||12<=m||4<=g||3.2<=p("esri-iphone")||3<=p("esri-android"));p.add("esri-url-encodes-apostrophe",function(){var c=window.document.createElement("a");c.href="?'";return-1<c.href.indexOf("?%27")});3>p("esri-android")&&(p.add("esri-transforms",!1,!1,!0),p.add("esri-transitions",!1,!1,!0),p.add("esri-transforms3d",!1,!1,!0));f._css=function(c){var e=p("esri-transforms3d");if(void 0!==c&&null!==c)e=c;else if(e&&(m||g&&!p("esri-iphone")))e=!1;var u=e?"translate3d(":"translate(",s=e?m?",-1px)":",0px)":
")",t=e?"scale3d(":"scale(",b=e?",1)":")",v=e?"rotate3d(0,0,1,":"rotate(",n=e?"matrix3d(":"matrix(",w=e?",0,0,":",",f=e?",0,0,0,0,1,0,":",",k=e?",0,1)":")";return{names:{transition:h&&"-webkit-transition"||a&&"MozTransition"||q&&"OTransition"||l&&"msTransition"||"transition",transform:h&&"-webkit-transform"||a&&"MozTransform"||q&&"OTransform"||l&&"msTransform"||"transform",transformName:h&&"-webkit-transform"||a&&"-moz-transform"||q&&"-o-transform"||l&&"-ms-transform"||"transform",origin:h&&"-webkit-transform-origin"||
a&&"MozTransformOrigin"||q&&"OTransformOrigin"||l&&"msTransformOrigin"||"transformOrigin",endEvent:h&&"webkitTransitionEnd"||a&&"transitionend"||q&&"oTransitionEnd"||l&&"MSTransitionEnd"||"transitionend"},translate:function(b,c){return u+b+"px,"+c+"px"+s},scale:function(c){return t+c+","+c+b},rotate:function(b){return v+b+"deg)"},matrix:function(b){return n+b.xx+","+b.xy+w+b.yx+","+b.yy+f+b.dx.toFixed(10)+(a?"px,":",")+b.dy.toFixed(10)+(a?"px":"")+k},getScaleFromMatrix:function(b){if(!b)return 1;
b=b.toLowerCase();var c=-1<b.indexOf("matrix3d")?"matrix3d(":"matrix(";return Number(b.substring(c.length,b.indexOf(",")))}}};return p})},"esri/urlUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/url dojo/io-query ./kernel ./config ./sniff dojo/i18n!./nls/jsapi".split(" "),function(p,f,a,l,k,h,q,m){var g=new a(window.location.href.toLowerCase()),e={},c=h.defaults.io,d=window.location.protocol;"file:"===d&&(d="http:");e.urlToObject=function(c){var d={},e=new a(c),g=c.indexOf("?");
null===e.query?d={path:c,query:null}:(d.path=c.substring(0,g),d.query=l.queryToObject(e.query));e.fragment&&(d.hash=e.fragment,null===e.query&&(d.path=d.path.substring(0,d.path.length-(e.fragment.length+1))));return d};e.getProxyUrl=function(d,a){var g=p.isString(d)?0===p.trim(d).toLowerCase().indexOf("https:"):d,t=c.proxyUrl,b,v,n=m.io.proxyNotSet;if(p.isString(d)&&(v=e.getProxyRule(d)))t=v.proxyUrl;if(!t)throw console.log(n),Error(n);g&&(!1!==a&&0!==window.location.href.toLowerCase().indexOf("https:"))&&
(g=t,0!==g.toLowerCase().indexOf("http")&&(g=e.getAbsoluteUrl(g)),g=g.replace(/^http:/i,"https:"),e.canUseXhr(g)&&(t=g,b=1));t=e.urlToObject(t);t._xo=b;return t};e.addProxy=function(d){var a=e.getProxyRule(d),g;a?g=e.urlToObject(a.proxyUrl):c.alwaysUseProxy&&(g=e.getProxyUrl());g&&(a=e.urlToObject(d),d=g.path+"?"+a.path,(g=l.objectToQuery(p.mixin(g.query||{},a.query)))&&(d+="?"+g));return d};e.addProxyRule=function(d){var a=d.urlPrefix=e.urlToObject(d.urlPrefix).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,
"").toLowerCase(),g=c.proxyRules,t,b=g.length,v,n=b;for(t=0;t<b;t++)if(v=g[t].urlPrefix,0===a.indexOf(v)){if(a.length===v)return-1;n=t;break}else 0===v.indexOf(a)&&(n=t+1);g.splice(n,0,d);return n};e.getProxyRule=function(d){var a=c.proxyRules,g=a.length,t=e.urlToObject(d).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),b;for(d=0;d<g;d++)if(0===t.indexOf(a[d].urlPrefix)){b=a[d];break}return b};e.hasSameOrigin=function(c,d,e){c=c.toLowerCase();d=d.toLowerCase();var g=window.location.href.toLowerCase();
c=0===c.indexOf("http")?new a(c):g=new a(g);d=0===d.indexOf("http")?new a(d):p.isString(g)?new a(g):g;return(e||c.scheme===d.scheme)&&c.host===d.host&&c.port===d.port};e.canUseXhr=function(d,a){var g=q("esri-phonegap")?!0:!1,t=e.hasSameOrigin,b=c.corsEnabledServers,v,n=-1;!g&&(q("esri-cors")&&b&&b.length)&&(g=f.some(b,function(b,c){var a=b&&"object"===typeof b?b.host:b;return a&&(v=0!==p.trim(a).toLowerCase().indexOf("http"),t(d,v?"http://"+a:a)||v&&t(d,"https://"+a))?(n=c,!0):!1}));return a?n:g};
e.getAbsoluteUrl=function(c){return p.isString(c)&&!/^https?:\/\//i.test(c)?0===c.indexOf("//")?d+c:0===c.indexOf("/")?d+"//"+window.location.host+c:k._appBaseUrl+c:c};e.fixUrl=function(c){/^\/\//i.test(c)&&(c=d+c);return c=c.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")};e.normalize=function(c){c=e._ensureProtocol(c);return c=e._ensureProperProtocolForAGOResource(c)};e._ensureProtocol=function(c){var d;if(!c)return c;/^\/\//i.test(c)&&(d=g.scheme,c=("file"===d?"https":d)+":"+c);return c};e._ensureProperProtocolForAGOResource=
function(c){return("https"===g.scheme||"file"===g.scheme)&&(/^http\:\/\/server\.arcgisonline\.com(?!:)/i.test(c)||/^http\:\/\/services\.arcgisonline\.com(?!:)/i.test(c)||/^http\:\/\/.+\.arcgis\.com(?!:)/i.test(c))?c.replace(/http:/i,"https:"):c};return e})},"esri/deferredUtils":function(){define(["dojo/_base/lang","dojo/has","./kernel"],function(p,f,a){return{_dfdCanceller:function(a){a.canceled=!0;var f=a._pendingDfd;-1===a.fired&&(f&&-1===f.fired)&&f.cancel();a._pendingDfd=null},_fixDfd:function(a){var f=
a.then;a.then=function(a,q,m){if(a){var g=a;a=function(a){return a&&a._argsArray?g.apply(null,a):g(a)}}return f.call(this,a,q,m)};return a},_resDfd:function(a,f,h){var q=f.length;1===q?h?a.errback(f[0]):a.callback(f[0]):1<q?(f._argsArray=!0,a.callback(f)):a.callback()}}})},"esri/SpatialReference":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ./kernel ./lang".split(" "),function(p,f,a,l,k,h){l=[-2.0037508342788905E7,2.0037508342788905E7];k=[-2.0037508342787E7,2.0037508342787E7];
return p(null,{declaredClass:"esri.SpatialReference",constructor:function(f){f&&(a.isObject(f)?a.mixin(this,f):a.isString(f)?this.wkt=f:this.wkid=f)},wkid:null,wkt:null,_info:{102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:l,origin:k,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:l,origin:k,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:l,origin:k,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:l,origin:k,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",${Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}},_isWebMercator:function(){return-1!==f.indexOf([102113,102100,3857,3785],this.wkid)},_isWrappable:function(){return-1!==f.indexOf([102113,102100,3857,3785,4326],this.wkid)},_getInfo:function(){return this.wkid?this._info[this.wkid]:null},_canProject:function(a){var f=!1;a&&(f=this.isWebMercator()&&4326===a.wkid||a.isWebMercator()&&4326===this.wkid);return f},isWebMercator:function(){return this._isWebMercator()},equals:function(a){var f=!1;a&&(this===a&&
(f=!0),this.wkid||a.wkid?f=this.wkid===a.wkid||this.isWebMercator()&&a.isWebMercator()||this.wkid===a.latestWkid||a.wkid===this.latestWkid:this.wkt&&a.wkt&&(f=this.wkt.toUpperCase()===a.wkt.toUpperCase()));return f},toJson:function(){var a=null,f=h.isDefined;f(this.wkid)?a={wkid:this.wkid}:f(this.wkt)&&(a={wkt:this.wkt});a&&f(this.latestWkid)&&(a.latestWkid=this.latestWkid);return a}})})},"esri/map":function(){define("require dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/event dojo/on dojo/aspect dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/a11yclick dijit/registry ./kernel ./config ./sniff ./lang ./_coremap ./MapNavigationManager dojo/i18n!./nls/jsapi".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A){var B={up:"panUp",right:"panRight",down:"panDown",left:"panLeft"},F={upperRight:"panUpperRight",lowerRight:"panLowerRight",lowerLeft:"panLowerLeft",upperLeft:"panUpperLeft"},E=l.connect,H=l.disconnect,I=r.create,M=s.set,Q=k.hitch,K=u.getMarginBox,J=f.deprecated,O=k.mixin,G=0;return a(z,{declaredClass:"esri.Map",constructor:function(b,c){O(this,{_slider:null,_navDiv:null,_mapParams:O({attributionWidth:0.45,slider:!0,nav:!1,logo:!0,sliderStyle:"small",
sliderPosition:"top-left",sliderOrientation:"vertical",autoResize:!0},c||{})});O(this,{isDoubleClickZoom:!1,isShiftDoubleClickZoom:!1,isClickRecenter:!1,isScrollWheelZoom:!1,isPan:!1,isRubberBandZoom:!1,isKeyboardNavigation:!1,isPanArrows:!1,isZoomSlider:!1});k.isFunction(v._css)&&(v._css=v._css(this._mapParams.force3DTransforms),this.force3DTransforms=this._mapParams.force3DTransforms);var d=w("esri-transforms")&&w("esri-transitions");this.navigationMode=this._mapParams.navigationMode||d&&"css-transforms"||
"classic";"css-transforms"===this.navigationMode&&!d&&(this.navigationMode="classic");this.fadeOnZoom=x.isDefined(this._mapParams.fadeOnZoom)?this._mapParams.fadeOnZoom:"css-transforms"===this.navigationMode;"css-transforms"!==this.navigationMode&&(this.fadeOnZoom=!1);this.setMapCursor("default");this.smartNavigation=c&&c.smartNavigation;if(!x.isDefined(this.smartNavigation)&&w("mac")&&!w("esri-touch")&&!w("esri-pointer")&&!(3.5>=w("ff"))){var a=navigator.userAgent.match(/Mac\s+OS\s+X\s+([\d]+)(\.|\_)([\d]+)\D/i);
a&&(x.isDefined(a[1])&&x.isDefined(a[3]))&&(d=parseInt(a[1],10),a=parseInt(a[3],10),this.smartNavigation=10<d||10===d&&6<=a)}this.showAttribution=x.isDefined(this._mapParams.showAttribution)?this._mapParams.showAttribution:!0;this._onLoadHandler_connect=E(this,"onLoad",this,"_onLoadInitNavsHandler");var e=I("div",{"class":"esriControlsBR"+(this._mapParams.nav?" withPanArrows":"")},this.root);if(this.showAttribution)if(d=k.getObject("esri.dijit.Attribution",!1))this._initAttribution(d,e);else{var n=
G++,s=this;this._rids&&this._rids.push(n);p(["./dijit/Attribution"],function(b){var c=s._rids?h.indexOf(s._rids,n):-1;-1!==c&&(s._rids.splice(c,1),s._initAttribution(b,e))})}this._mapParams.logo&&(d={},6===w("ie")&&(d.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+p.toUrl("./images/map/logo-med.png")+"')"),this._ogol=I("div",{style:d,tabIndex:"0",title:"Esri"},e),this._setLogoSize(),this._onMapResizeLogo_connect=E(this,"onResize",this,
"_setLogoSize"),this._ogol_connect=E(this._ogol,t,this,"_openLogoLink"));this.navigationManager=new y(this);c&&c.basemap&&(this._onLoadFix=!0,this.setBasemap(c.basemap),this._onLoadFix=!1);if(this.autoResize=this._mapParams.autoResize)d=this._getEnclosingResizableWidget(this.container)||window,a=this.resize,this._rszSignal=m.pausable(d,"resize",a),this._oriSignal=m.pausable(window,"orientationchange",a),g.after(d,"resize",a,!0),this._startResizeTimer()},_startResizeTimer:function(){clearTimeout(this._persistentTimer);
this._persistentTimer=setTimeout(this._timedResize,2*this.resizeDelay)},_getEnclosingResizableWidget:function(c){var d=b.getEnclosingWidget(c);return!d?d:d.resize?d:this._getEnclosingResizableWidget(c.parentNode)},_setLogoSize:function(){this._ogol&&(25E4>this.root.clientWidth*this.root.clientHeight?(d.remove(this._ogol,"logo-med"),d.add(this._ogol,"logo-sm")):(d.remove(this._ogol,"logo-sm"),d.add(this._ogol,"logo-med")))},_initAttribution:function(b,c){var a=I("span",{"class":"esriAttribution"},
c,"first");M(a,"maxWidth",Math.floor(this.width*this._mapParams.attributionWidth)+"px");this._connects.push(E(a,t,function(){d.contains(this,"esriAttributionOpen")?d.remove(this,"esriAttributionOpen"):this.scrollWidth>this.clientWidth&&d.add(this,"esriAttributionOpen")}));this.attribution=new b({map:this},a)},_cleanUp:function(){this.disableMapNavigation();this.navigationManager.destroy();var b=this._slider;b&&(b.destroy&&!b._destroyed)&&b.destroy();var b=this._navDiv,c=this.attribution;b&&r.destroy(b);
c&&c.destroy();this._connects.push(this._slider_connect,this._ogol_connect,this._rszSignal,this._oriSignal);h.forEach(this._connects,H);clearInterval(this._persistentTimer);this.attribution=this.navigationManager=this._rids=this._connects=this._slider_connect=this._ogol_connect=this._rszSignal=this._oriSignal=this._persistentTimer=null;this.inherited("_cleanUp",arguments)},_isPanningOrZooming:function(){return this.__panning||this.__zooming},_canZoom:function(b){var c=this.getLevel();return!this.__tileInfo||
!(c===this.getMinZoom()&&0>b||c===this.getMaxZoom()&&0<b)},_onLoadInitNavsHandler:function(){this.enableMapNavigation();this._createNav();if("small"===this._mapParams.sliderStyle||!this._createSlider)this._createSimpleSlider();else if(this._mapParams.slider){var b=-1!==this._getSliderClass(!0).indexOf("Horizontal"),b=[b?"dijit.form.HorizontalSlider":"dijit.form.VerticalSlider",b?"dijit.form.HorizontalRule":"dijit.form.VerticalRule",b?"dijit.form.HorizontalRuleLabels":"dijit.form.VerticalRuleLabels"];
if(h.some(b,function(b){return!k.getObject(b,!1)})){var b=h.map(b,function(b){return b.replace(/\./g,"/")}),c=G++,d=this;this._rids&&this._rids.push(c);p(b,function(){var b=d._rids?h.indexOf(d._rids,c):-1;-1!==b&&(d._rids.splice(b,1),d._createSlider.apply(d,arguments))})}else b=h.map(b,function(b){return k.getObject(b,!1)}),this._createSlider.apply(this,b)}H(this._onLoadHandler_connect)},_createNav:function(){if(this._mapParams.nav){var b,c,a,e=d.add,n=this.id;this._navDiv=I("div",{id:n+"_navdiv"},
this.root);e(this._navDiv,"navDiv");var g=this.width/2,s=this.height/2,r;for(a in B)c=B[a],b=I("div",{id:n+"_pan_"+a},this._navDiv),e(b,"fixedPan "+c),"up"===a||"down"===a?(r=parseInt(K(b).w,10)/2,M(b,{left:g-r+"px",zIndex:30})):(r=parseInt(K(b).h,10)/2,M(b,{top:s-r+"px",zIndex:30})),this._connects.push(E(b,"onclick",Q(this,this[c])));this._onMapResizeNavHandler_connect=E(this,"onResize",this,"_onMapResizeNavHandler");for(a in F)c=F[a],b=I("div",{id:n+"_pan_"+a,style:{zIndex:30}},this._navDiv),e(b,
"fixedPan "+c),this._connects.push(E(b,"onclick",Q(this,this[c])));this.isPanArrows=!0}},_onMapResizeNavHandler:function(b,c,d){b=this.id;c/=2;d/=2;var a=e.byId,n,g,s;for(n in B)g=a(b+"_pan_"+n),"up"===n||"down"===n?(s=parseInt(K(g).w,10)/2,M(g,"left",c-s+"px")):(s=parseInt(K(g).h,10)/2,M(g,"top",d-s+"px"))},_createSimpleSlider:function(){if(this._mapParams.slider){var b=this._slider=I("div",{id:this.id+"_zoom_slider","class":this._getSliderClass(),style:{zIndex:30}}),c=I("div",{"class":"esriSimpleSliderIncrementButton",
tabIndex:"0",role:"button"},b),a=I("div",{"class":"esriSimpleSliderDecrementButton",tabIndex:"0",role:"button"},b);this._addZoomButtonTooltips(c,a);this._incButton=c;this._decButton=a;this._simpleSliderZoomHandler(null,null,null,this.getLevel());c.innerHTML="\x3cspan\x3e+\x3c/span\x3e";a.innerHTML="\x3cspan\x3e\x26ndash;\x3c/span\x3e";8>w("ie")&&d.add(a,"dj_ie67Fix");this._connects.push(E(c,t,this,this._simpleSliderChangeHandler));this._connects.push(E(a,t,this,this._simpleSliderChangeHandler));(-1<
this.getMaxZoom()||-1<this.getMinZoom())&&this._connects.push(E(this,"onZoomEnd",this,this._simpleSliderZoomHandler));10>w("ie")&&e.setSelectable(b,!1);this.root.appendChild(b);this.isZoomSlider=!0}},_simpleSliderChangeHandler:function(b){q.stop(b);b=-1!==b.currentTarget.className.indexOf("IncrementButton")?!0:!1;this._extentUtil({numLevels:b?1:-1})},_simpleSliderZoomHandler:function(b,c,a,e){var n;b=this._incButton;c=this._decButton;-1<e&&e===this.getMaxZoom()?n=b:-1<e&&e===this.getMinZoom()&&(n=
c);n?(d.add(n,"esriSimpleSliderDisabledButton"),d.remove(n===b?c:b,"esriSimpleSliderDisabledButton")):(d.remove(b,"esriSimpleSliderDisabledButton"),d.remove(c,"esriSimpleSliderDisabledButton"))},_getSliderClass:function(b){b=b?"Large":"Simple";var c=this._mapParams.sliderOrientation,d=this._mapParams.sliderPosition||"",c=c&&"horizontal"===c.toLowerCase()?"esri"+b+"SliderHorizontal":"esri"+b+"SliderVertical";if(d)switch(d.toLowerCase()){case "top-left":d="esri"+b+"SliderTL";break;case "top-right":d=
"esri"+b+"SliderTR";break;case "bottom-left":d="esri"+b+"SliderBL";break;case "bottom-right":d="esri"+b+"SliderBR"}return"esri"+b+"Slider "+c+" "+d},_addZoomButtonTooltips:function(b,d){var a=A.widgets.zoomSlider;c.set(b,"title",a.zoomIn);c.set(d,"title",a.zoomOut)},_createSlider:function(b,c,d){if(this._mapParams.slider){var a=I("div",{id:this.id+"_zoom_slider"},this.root),e=n.defaults.map,g=this._getSliderClass(!0),s=-1!==g.indexOf("Horizontal"),r=this.getNumLevels();if(0<r){var t,v,u=this._mapParams.sliderLabels,
f=!!u,k=!1!==u;if(k){var m=s?"bottomDecoration":"rightDecoration";if(!u){u=[];for(e=0;e<r;e++)u[e]=""}h.forEach([{"class":"esriLargeSliderTicks",container:m,count:r,dijitClass:c},{"class":f&&"esriLargeSliderLabels",container:m,count:r,labels:u,dijitClass:d}],function(b){var d=I("div"),e=b.dijitClass;delete b.dijitClass;a.appendChild(d);e===c?t=new e(b,d):v=new e(b,d)})}b=this._slider=new b({id:a.id,"class":g,minimum:this.getMinZoom(),maximum:this.getMaxZoom(),discreteValues:r,value:this.getLevel(),
clickSelect:!0,intermediateChanges:!0,style:"z-index:30;"},a);b.startup();k&&(t.startup(),v.startup());this._slider_connect=E(b,"onChange",this,"_onSliderChangeHandler");this._connects.push(E(this,"onExtentChange",this,"_onExtentChangeSliderHandler"));this._connects.push(E(b._movable,"onFirstMove",this,"_onSliderMoveStartHandler"))}else{b=this._slider=new b({id:a.id,"class":g,minimum:0,maximum:2,discreteValues:3,value:1,clickSelect:!0,intermediateChanges:e.sliderChangeImmediate,style:"height:50px; z-index:30;"},
a);d=b.domNode.firstChild.childNodes;for(e=1;3>=e;e++)M(d[e],"visibility","hidden");b.startup();this._slider_connect=E(b,"onChange",this,"_onDynSliderChangeHandler");this._connects.push(E(this,"onExtentChange",this,"_onExtentChangeDynSliderHandler"))}e=b.incrementButton;d=b.decrementButton;s?this._addZoomButtonTooltips(e,d):this._addZoomButtonTooltips(d,e);e.style.outline="none";d.style.outline="none";b.sliderHandle.style.outline="none";b._onKeyPress=function(){};if(s=b._movable){var q=s.onMouseDown;
s.onMouseDown=function(b){9>w("ie")&&1!==b.button||q.apply(this,arguments)}}this.isZoomSlider=!0}},_onSliderMoveStartHandler:function(){H(this._slider_connect);H(this._slidermovestop_connect);this._slider_connect=E(this._slider,"onChange",this,"_onSliderChangeDragHandler");this._slidermovestop_connect=E(this._slider._movable,"onMoveStop",this,"_onSliderMoveEndHandler")},_onSliderChangeDragHandler:function(b){this._extentUtil({targetLevel:b})},_onSliderMoveEndHandler:function(){H(this._slider_connect);
H(this._slidermovestop_connect)},_onSliderChangeHandler:function(b){this.setLevel(b)},_updateSliderValue:function(b,c){H(this._slider_connect);var d=this._slider,a=d._onChangeActive;d._onChangeActive=!1;d.set("value",b);d._onChangeActive=a;this._slider_connect=E(d,"onChange",this,c)},_onExtentChangeSliderHandler:function(b,c,d,a){H(this._slidermovestop_connect);this._updateSliderValue(a.level,"_onSliderChangeHandler")},_onDynSliderChangeHandler:function(b){this._extentUtil({numLevels:0<b?1:-1})},
_onExtentChangeDynSliderHandler:function(){this._updateSliderValue(1,"_onDynSliderChangeHandler")},_openLogoLink:function(b){window.open(n.defaults.map.logoLink,"_blank");q.stop(b)},enableMapNavigation:function(){this.navigationManager.enableNavigation()},disableMapNavigation:function(){this.navigationManager.disableNavigation()},enableDoubleClickZoom:function(){this.isDoubleClickZoom||(this.navigationManager.enableDoubleClickZoom(),this.isDoubleClickZoom=!0)},disableDoubleClickZoom:function(){this.isDoubleClickZoom&&
(this.navigationManager.disableDoubleClickZoom(),this.isDoubleClickZoom=!1)},enableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom||(J(this.declaredClass+": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",null,"v2.0"),this.navigationManager.enableShiftDoubleClickZoom(),this.isShiftDoubleClickZoom=!0)},disableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom&&(J(this.declaredClass+": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",
null,"v2.0"),this.navigationManager.disableShiftDoubleClickZoom(),this.isShiftDoubleClickZoom=!1)},enableClickRecenter:function(){this.isClickRecenter||(this.navigationManager.enableClickRecenter(),this.isClickRecenter=!0)},disableClickRecenter:function(){this.isClickRecenter&&(this.navigationManager.disableClickRecenter(),this.isClickRecenter=!1)},enablePan:function(){this.isPan||(this.navigationManager.enablePan(),this.isPan=!0)},disablePan:function(){this.isPan&&(this.navigationManager.disablePan(),
this.isPan=!1)},enableRubberBandZoom:function(){this.isRubberBandZoom||(this.navigationManager.enableRubberBandZoom(),this.isRubberBandZoom=!0)},disableRubberBandZoom:function(){this.isRubberBandZoom&&(this.navigationManager.disableRubberBandZoom(),this.isRubberBandZoom=!1)},enableKeyboardNavigation:function(){this.isKeyboardNavigation||(this.navigationManager.enableKeyboardNavigation(),this.isKeyboardNavigation=!0)},disableKeyboardNavigation:function(){this.isKeyboardNavigation&&(this.navigationManager.disableKeyboardNavigation(),
this.isKeyboardNavigation=!1)},enableScrollWheelZoom:function(){this.isScrollWheelZoom||(this.navigationManager.enableScrollWheelZoom(),this.isScrollWheelZoom=!0)},disableScrollWheelZoom:function(){this.isScrollWheelZoom&&(this.navigationManager.disableScrollWheelZoom(),this.isScrollWheelZoom=!1)},showPanArrows:function(){this._navDiv&&(this._navDiv.style.display="block",this.isPanArrows=!0)},hidePanArrows:function(){this._navDiv&&(this._navDiv.style.display="none",this.isPanArrows=!1)},showZoomSlider:function(){this._slider&&
(M(this._slider.domNode||this._slider,"visibility","inherit"),this.isZoomSlider=!0)},hideZoomSlider:function(){this._slider&&(M(this._slider.domNode||this._slider,"visibility","hidden"),this.isZoomSlider=!1)}})})},"dijit/a11yclick":function(){define(["dojo/keys","dojo/mouse","dojo/on","dojo/touch"],function(p,f,a,l){function k(a){if((a.keyCode===p.ENTER||a.keyCode===p.SPACE)&&!/input|button|textarea/i.test(a.target.nodeName))for(a=a.target;a;a=a.parentNode)if(a.dojoClick)return!0}var h;a(document,
"keydown",function(a){k(a)?(h=a.target,a.preventDefault()):h=null});a(document,"keyup",function(f){k(f)&&f.target==h&&(h=null,a.emit(f.target,"click",{cancelable:!0,bubbles:!0,ctrlKey:f.ctrlKey,shiftKey:f.shiftKey,metaKey:f.metaKey,altKey:f.altKey,_origType:f.type}))});var q=function(f,g){f.dojoClick=!0;return a(f,"click",g)};q.click=q;q.press=function(h,g){var e=a(h,l.press,function(c){("mousedown"!=c.type||f.isLeft(c))&&g(c)}),c=a(h,"keydown",function(c){(c.keyCode===p.ENTER||c.keyCode===p.SPACE)&&
g(c)});return{remove:function(){e.remove();c.remove()}}};q.release=function(h,g){var e=a(h,l.release,function(c){("mouseup"!=c.type||f.isLeft(c))&&g(c)}),c=a(h,"keyup",function(c){(c.keyCode===p.ENTER||c.keyCode===p.SPACE)&&g(c)});return{remove:function(){e.remove();c.remove()}}};q.move=l.move;return q})},"dojo/touch":function(){define("./_base/kernel ./aspect ./dom ./dom-class ./_base/lang ./on ./has ./mouse ./domReady ./_base/window".split(" "),function(p,f,a,l,k,h,q,m,g,e){function c(c,d,a){return s&&
a?function(b,c){return h(b,a,c)}:b?function(b,a){var e=h(b,d,function(b){a.call(this,b);E=(new Date).getTime()}),n=h(b,c,function(b){(!E||(new Date).getTime()>E+1E3)&&a.call(this,b)});return{remove:function(){e.remove();n.remove()}}}:function(b,a){return h(b,c,a)}}function d(b){do if(void 0!==b.dojoClick)return b;while(b=b.parentNode)}function r(b,c,g){if(!m.isRight(b)){var s=d(b.target);if(n=!b.target.disabled&&s&&s.dojoClick)if(x=(w="useTarget"==n)?s:b.target,w&&b.preventDefault(),z=b.changedTouches?
b.changedTouches[0].pageX-e.global.pageXOffset:b.clientX,y=b.changedTouches?b.changedTouches[0].pageY-e.global.pageYOffset:b.clientY,A=("object"==typeof n?n.x:"number"==typeof n?n:0)||4,B=("object"==typeof n?n.y:"number"==typeof n?n:0)||4,!v){v=!0;var r=function(b){n=w?a.isDescendant(e.doc.elementFromPoint(b.changedTouches?b.changedTouches[0].pageX-e.global.pageXOffset:b.clientX,b.changedTouches?b.changedTouches[0].pageY-e.global.pageYOffset:b.clientY),x):n&&(b.changedTouches?b.changedTouches[0].target:
b.target)==x&&Math.abs((b.changedTouches?b.changedTouches[0].pageX-e.global.pageXOffset:b.clientX)-z)<=A&&Math.abs((b.changedTouches?b.changedTouches[0].pageY-e.global.pageYOffset:b.clientY)-y)<=B};e.doc.addEventListener(c,function(b){m.isRight(b)||(r(b),w&&b.preventDefault())},!0);e.doc.addEventListener(g,function(b){if(!m.isRight(b)&&(r(b),n)){F=(new Date).getTime();var c=w?x:b.target;"LABEL"===c.tagName&&(c=a.byId(c.getAttribute("for"))||c);var d=b.changedTouches?b.changedTouches[0]:b,e=function(c){var a=
document.createEvent("MouseEvents");a._dojo_click=!0;a.initMouseEvent(c,!0,!0,b.view,b.detail,d.screenX,d.screenY,d.clientX,d.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,0,null);return a},g=e("mousedown"),s=e("mouseup"),t=e("click");setTimeout(function(){h.emit(c,"mousedown",g);h.emit(c,"mouseup",s);h.emit(c,"click",t);F=(new Date).getTime()},0)}},!0);b=function(b){e.doc.addEventListener(b,function(c){var a=c.target;n&&(!c._dojo_click&&(new Date).getTime()<=F+1E3&&!("INPUT"==a.tagName&&l.contains(a,
"dijitOffScreen")))&&(c.stopPropagation(),c.stopImmediatePropagation&&c.stopImmediatePropagation(),"click"==b&&(("INPUT"!=a.tagName||"radio"==a.type&&(l.contains(a,"dijitCheckBoxInput")||l.contains(a,"mblRadioButton"))||"checkbox"==a.type&&(l.contains(a,"dijitCheckBoxInput")||l.contains(a,"mblCheckBox")))&&"TEXTAREA"!=a.tagName&&"AUDIO"!=a.tagName&&"VIDEO"!=a.tagName)&&c.preventDefault())},!0)};b("click");b("mousedown");b("mouseup")}}}var u=5>q("ios"),s=q("pointer-events")||q("MSPointer"),t=function(){var b=
{},c;for(c in{down:1,move:1,up:1,cancel:1,over:1,out:1})b[c]=q("MSPointer")?"MSPointer"+c.charAt(0).toUpperCase()+c.slice(1):"pointer"+c;return b}(),b=q("touch-events"),v,n,w=!1,x,z,y,A,B,F,E,H;q("touch")&&(s?g(function(){e.doc.addEventListener(t.down,function(b){r(b,t.move,t.up)},!0)}):g(function(){function b(c){var a=k.delegate(c,{bubbles:!0});6<=q("ios")&&(a.touches=c.touches,a.altKey=c.altKey,a.changedTouches=c.changedTouches,a.ctrlKey=c.ctrlKey,a.metaKey=c.metaKey,a.shiftKey=c.shiftKey,a.targetTouches=
c.targetTouches);return a}H=e.body();e.doc.addEventListener("touchstart",function(b){E=(new Date).getTime();var c=H;H=b.target;h.emit(c,"dojotouchout",{relatedTarget:H,bubbles:!0});h.emit(H,"dojotouchover",{relatedTarget:c,bubbles:!0});r(b,"touchmove","touchend")},!0);h(e.doc,"touchmove",function(c){E=(new Date).getTime();var a=e.doc.elementFromPoint(c.pageX-(u?0:e.global.pageXOffset),c.pageY-(u?0:e.global.pageYOffset));a&&(H!==a&&(h.emit(H,"dojotouchout",{relatedTarget:a,bubbles:!0}),h.emit(a,"dojotouchover",
{relatedTarget:H,bubbles:!0}),H=a),h.emit(a,"dojotouchmove",b(c))||c.preventDefault())});h(e.doc,"touchend",function(c){E=(new Date).getTime();var a=e.doc.elementFromPoint(c.pageX-(u?0:e.global.pageXOffset),c.pageY-(u?0:e.global.pageYOffset))||e.body();h.emit(a,"dojotouchend",b(c))})}));f={press:c("mousedown","touchstart",t.down),move:c("mousemove","dojotouchmove",t.move),release:c("mouseup","dojotouchend",t.up),cancel:c(m.leave,"touchcancel",s?t.cancel:null),over:c("mouseover","dojotouchover",t.over),
out:c("mouseout","dojotouchout",t.out),enter:m._eventHandler(c("mouseover","dojotouchover",t.over)),leave:m._eventHandler(c("mouseout","dojotouchout",t.out))};return p.touch=f})},"dijit/registry":function(){define(["dojo/_base/array","dojo/_base/window","./main"],function(p,f,a){var l={},k={},h={length:0,add:function(a){if(k[a.id])throw Error("Tried to register widget with id\x3d\x3d"+a.id+" but that id is already registered");k[a.id]=a;this.length++},remove:function(a){k[a]&&(delete k[a],this.length--)},
byId:function(a){return"string"==typeof a?k[a]:a},byNode:function(a){return k[a.getAttribute("widgetId")]},toArray:function(){var a=[],f;for(f in k)a.push(k[f]);return a},getUniqueId:function(f){var h;do h=f+"_"+(f in l?++l[f]:l[f]=0);while(k[h]);return"dijit"==a._scopeName?h:a._scopeName+"_"+h},findWidgets:function(a,f){function g(c){for(c=c.firstChild;c;c=c.nextSibling)if(1==c.nodeType){var a=c.getAttribute("widgetId");a?(a=k[a])&&e.push(a):c!==f&&g(c)}}var e=[];g(a);return e},_destroyAll:function(){a._curFocus=
null;a._prevFocus=null;a._activeStack=[];p.forEach(h.findWidgets(f.body()),function(a){a._destroyed||(a.destroyRecursive?a.destroyRecursive():a.destroy&&a.destroy())})},getEnclosingWidget:function(a){for(;a;){var f=1==a.nodeType&&a.getAttribute("widgetId");if(f)return k[f];a=a.parentNode}return null},_hash:k};return a.registry=h})},"dijit/main":function(){define(["dojo/_base/kernel"],function(p){return p.dijit})},"esri/_coremap":function(){define("require module dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/Deferred dojo/_base/lang dojo/_base/array dojo/_base/event dojo/_base/unload dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/sniff dijit/registry dojox/gfx/matrix ./kernel ./config ./basemaps ./lang ./Evented ./fx ./deferredUtils ./tileUtils ./urlUtils ./PluginTarget ./geometry/Point ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./geometry/scaleUtils ./geometry/screenUtils ./geometry/webMercatorUtils ./layers/GraphicsLayer ./layers/TileInfo ./layers/LOD ./layers/ArcGISTiledMapServiceLayer ./layers/MapImageLayer ./layers/OpenStreetMapLayer ./layers/VectorTileLayer ./dijit/Popup ./plugins/popupManager dojo/uacss".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A,B,F,E,H,I,M,Q,K,J,O,G,T,P,V,L,C,X,Y,la,aa,ga){function qa(b,c){var a=b.lods;a.sort(function(b,c){return b.scale>c.scale?-1:b.scale<c.scale?1:0});var d=[],a=m.filter(a,function(b){if(-1===Aa(d,b.scale))return d.push(b.scale),!0}),e=c.lods=[],n;m.forEach(a,function(b,c){n=e[c]=new C(b);n.level=c});c.tileInfo=new L(Da(b,{lods:e}))}var za,ia=T.toMapPoint,oa=T.toScreenPoint,xa=k.connect,sa=k.disconnect,ea=q.hitch,pa=t.set,Aa=m.indexOf,Da=q.mixin,
Ea=0,ua=x.defaults.map,Ca=ua.layerNamePrefix,ta=ua.graphicsLayerNamePrefix,va=RegExp("^"+Ca+"(\\d+)$"),Ka=RegExp("^"+ta+"(\\d+)$"),Pa=function(){};return l([A,I],{declaredClass:"esri._CoreMap",resizeDelay:300,invalidExtent:"Map does not have a valid extent.",invalidGeometry:"Geometry (wkid: ${geometry}) cannot be converted to spatial reference of the map (wkid: ${map})",unknownBasemap:'Unable to find basemap definition for: "${basemapName}". Try one of these: ${list}',invalidBasemap:'Unable to add basemap: "${basemapName}".',
unknownLayerType:'Unknown basemap layer type: "${type}" found in basemap definition for: "${basemapName}".',visible:!0,_eventMap:{"basemap-change":!0,"extent-change":["extent","delta","levelChange","lod"],"layer-add":["layer"],"layer-add-result":["layer","error"],"layer-remove":["layer"],"layer-reorder":["layer","index"],"layer-resume":["layer"],"layer-suspend":["layer"],"layers-add-result":["layers"],"layers-removed":!0,"layers-reordered":["layerIds"],load:["map"],pan:["extent","delta"],"pan-end":["extent",
"delta"],"pan-start":["extent","screenPoint"],reposition:["x","y"],resize:["extent","width","height"],scale:["matrix","immediate"],"time-extent-change":["timeExtent"],"before-unload":["map"],unload:["map"],"update-end":["error"],"update-start":!0,zoom:["extent","zoomFactor","anchor"],"zoom-end":["extent","zoomFactor","anchor","level"],"zoom-start":["extent","zoomFactor","anchor","level"],click:!0,"dbl-click":!0,"key-down":!0,"key-up":!0,"mouse-down":!0,"mouse-drag":!0,"mouse-drag-end":!0,"mouse-drag-start":!0,
"mouse-move":!0,"mouse-out":!0,"mouse-over":!0,"mouse-up":!0,"mouse-wheel":!0,"basic-tap":!0,"double-tap":!0,"pinch-end":!0,"pinch-move":!0,"pinch-start":!0,"processed-double-tap":!0,"processed-tap":!0,"swipe-end":!0,"swipe-move":!0,"swipe-start":!0,tap:!0,"two-finger-tap":!0},constructor:function(b,a){var n=this;this.registerConnectEvents();Da(this,{_internalLayerIds:[],_layers:[],_layerDivs:[],_layerSize:0,_connects:[],_zoomAnimDiv:null,_zoomAnim:null,_layersDiv:null,_firstLayerId:null,_delta:null,
_cursor:null,_ratioW:1,_ratioH:1,_params:null,cursor:null,layerIds:[],graphicsLayerIds:[],graphics:null,_labels:null,loaded:!1,__panning:!1,__zooming:!1,__container:null,root:null,__LOD:null,__tileInfo:null,__visibleRect:null,__visibleDelta:null,_rids:[]});var g=this.container=c.byId(b),t=this.id=d.get(g,"id")||v.getUniqueId(this.declaredClass);r.add(g,"map");var w=s.getContentBox(g),f=r.add,h=u.create;this.position=new Q(0,0);this._reposition();var k=this.width=0<w.w?w.w:ua.width,m=this.height=0<
w.h?w.h:ua.height,q=this.root=h("div",{id:t+"_root",style:{width:k+"px",height:m+"px",direction:"ltr"}});f(q,"esriMapContainer");w=this.__container=h("div",{id:t+"_container"},q);pa(w,"position","absolute");f(w,"esriMapContainer");g.appendChild(q);g=this._params=Da({slider:!0,nav:!1,zoom:-1,minZoom:-1,maxZoom:-1,scale:-1,minScale:0,maxScale:0,showInfoWindowOnClick:!0,displayGraphicsOnPan:!0,wrapAround180:!0,fitExtent:!1,optimizePanAnimation:!0},a||{});this.wrapAround180=g.wrapAround180;this.optimizePanAnimation=
g.optimizePanAnimation;y.isDefined(g.resizeDelay)&&(this.resizeDelay=g.resizeDelay);g.lods&&(qa({rows:512,cols:512,dpi:96,format:"JPEG",compressionQuality:75,origin:{x:-180,y:90},spatialReference:{wkid:4326},lods:g.lods},g),this.__tileInfo=g.tileInfo);this.extent=g.extent;this._extentUtil({mapCenter:g.center,targetLevel:g.zoom,targetScale:g.scale});this.__visibleRect=new J(0,0,k,m);this.__visibleDelta=new J(0,0,k,m);t=this._layersDiv=h("div",{id:t+"_layers"});f(t,"esriMapLayers");w.appendChild(t);
this._zoomAnimDiv=h("div",{style:{position:"absolute"}});g.infoWindow?this.infoWindow=g.infoWindow:(f=this.infoWindow=new ga(g.popupOptions,h("div")),f.startup(),f._ootb=!0,pa(f.domNode,"zIndex",40));g.showLabels&&(p(["./layers/LabelLayer"],function(b){za=b;n._createLabelLayer()}),this.on("load",function(){n._createLabelLayer()}));this.addPlugin(this._getAbsMid("./plugins/popupManager"),{enabled:g.showInfoWindowOnClick});this._zoomStartHandler=ea(this,this._zoomStartHandler);this._zoomingHandler=
ea(this,this._zoomingHandler);this._zoomEndHandler=ea(this,this._zoomEndHandler);this._panningHandler=ea(this,this._panningHandler);this._panEndHandler=ea(this,this._panEndHandler);this._endTranslate=ea(this,this._endTranslate);this._timedResize=ea(this,this._timedResize);this._execResize=ea(this,this._execResize);this.resize=ea(this,this.resize);e.addOnWindowUnload(this,this.destroy)},_getAbsMid:function(b){return p.toAbsMid?p.toAbsMid(b):f.id.replace(/\/[^\/]*$/ig,"/")+b},_cleanUp:function(){var b=
this.infoWindow;b&&(b._ootb&&b.destroy?b.destroy():b.unsetMap(this),delete this.infoWindow);sa(this._tsTimeExtentChange_connect);this.removePlugin("./plugins/popupManager");u.destroy(this.root);this.root=null},_addLayer:function(b,c,a){if(b.id){var d=b.id.match(b instanceof V?Ka:va);d&&d[1]&&(d=Number(d[1]),Ea<=d&&(Ea=d+1))}var e=b.id||(b instanceof V?ta:Ca)+Ea++;b.id=e;this._layers[e]=b;var n,g;if(c===this.layerIds||c===this.graphicsLayerIds)n=this._layerSize,this._layerSize++;b._isRefLayer="top"===
a;a=!y.isDefined(a)||0>a||a>c.length||"top"===a?c.length:a;0===n&&(this._firstLayerId=e);if(!b._isRefLayer)for(;(g=this.getLayer(c[a-1]))&&g._isRefLayer;)a--;c.splice(a,0,e);var s=ea(this,this._addLayerHandler),r=this;a=this._connects;d=function(){b.loaded?r._onLoadFix?(r._onLoadFix=!1,setTimeout(function(){s(b)},0)):s(b):(r["_"+e+"_addtoken_load"]=xa(b,"onLoad",r,"_addLayerHandler"),r["_"+e+"_addtoken_err"]=xa(b,"onError",r,function(a){s(b,a,c)}))};this.loaded||0===n||b.loaded&&-1===Aa(this.graphicsLayerIds,
e)?d():a.push(xa(this,"onLoad",d));return b},_addLayerHandler:function(b,c,a){var d=this.id,e=b.id,n=Aa(b instanceof V?this.graphicsLayerIds:this.layerIds,e),g=n,s=!1,r=this._params;sa(this["_"+e+"_addtoken_load"]);sa(this["_"+e+"_addtoken_err"]);if(c)delete this._layers[e],-1!==n&&(a.splice(n,1),this.onLayerAddResult(b,c));else{-1===n&&(n=Aa(this._internalLayerIds,e),g=20+n,s=!0);if(e===this._firstLayerId){c=b.spatialReference;if((a=this.extent&&this.extent.spatialReference)&&!a.equals(c)&&(b.tileInfo||
!b.url))a=null;a=this.spatialReference=a||c;this.wrapAround180=this.wrapAround180&&a&&a._isWrappable()?!0:!1;b.tileInfo&&(this.__tileInfo?(c=this.__tileInfo.lods,this.__tileInfo=Da({},b.tileInfo),this.__tileInfo.lods=c):(qa(Da({},b.tileInfo),r),this.__tileInfo=r.tileInfo));if(this.wrapAround180){c=this.__tileInfo;a=a._getInfo();if(!c||Math.abs(a.origin[0]-c.origin.x)>a.dx)this.wrapAround180=!1;this.wrapAround180&&c&&E._addFrameInfo(c,a)}r.units=b.units;if((c=this.__tileInfo&&this.__tileInfo.lods)&&
c.length){a=r.minScale;var n=r.maxScale,t=-1,v=-1,u=!1,w=!1,f;for(f=0;f<c.length;f++)0<a&&(!u&&a>=c[f].scale)&&(t=c[f].level,u=!0),0<n&&(!w&&n>=c[f].scale)&&(v=0<f?c[f-1].level:-1,w=!0);-1===r.minZoom&&(r.minZoom=0===a?c[0].level:t);-1===r.maxZoom&&(r.maxZoom=0===n?c[c.length-1].level:v);for(f=0;f<c.length;f++)r.minZoom===c[f].level&&(r.minScale=c[f].scale),r.maxZoom===c[f].level&&(r.maxScale=c[f].scale)}else r.minZoom=r.maxZoom=r.zoom=-1}b instanceof V?(this._gc||(this._gc=new V._GraphicsContainer,
this._gc._setMap(this,this._layersDiv).id=d+"_gc"),g=b._setMap(this,this._gc._surface),g.id=d+"_"+e,this._layerDivs[e]=g,this._reorderLayers(this.graphicsLayerIds)):(g=b._setMap(this,this._layersDiv,g,this.__LOD),g.id=d+"_"+e,this._layerDivs[e]=g,this._reorderLayers(this.layerIds),!s&&-1!==b.declaredClass.indexOf("VETiledLayer")&&this._onBingLayerAdd(b));e===this._firstLayerId&&(this.graphics=new V({id:d+"_graphics",displayOnPan:r.displayGraphicsOnPan}),this._addLayer(this.graphics,this._internalLayerIds,
20));if(b===this.graphics){a=this._layers[this._firstLayerId];d=r.zoom;g=r.scale;c=r.center;a=a.initialExtent||a.fullExtent;this._firstLayerId=null;this.extent&&(this.extent=this._convertGeometry(this,this.extent));!this.extent&&a&&(c&&(c=this._convertGeometry(a,c)),c&&(a=a.centerAt(c)));if(c=this.extent||a&&new K(a.toJson()))-1<d?c=this.__getExtentForLevel(d,null,c).extent:0<g&&(c=G.getExtentForScale(this,g,c));if(!c){console.log("Map: "+this.invalidExtent);return}r=this._fixExtent(c,r.fitExtent);
this.extent=r.extent;this.__LOD=r.lod;this.__setExtent(this.extent);this.loaded=!0;this.attr("data-loaded","");this.infoWindow.setMap(this);this.onLoad(this)}s||(this.onLayerAdd(b),this.onLayerAddResult(b));sa(this[e+"_addLayerHandler_connect"])}},_convertGeometry:function(b,c){var a=b&&b.spatialReference,d=c&&c.spatialReference;a&&(d&&!a.equals(d))&&(a._canProject(d)?a.isWebMercator()?c=P.geographicToWebMercator(c):4326===a.wkid&&(c=P.webMercatorToGeographic(c,!0)):(console.log("Map: "+y.substitute({geometry:d.wkid||
d.wkt,map:a.wkid||a.wkt},this.invalidGeometry)),c=null));return c},_reorderLayers:function(c){var a=this.onLayerReorder,d=u.place,e=this._layerDivs,n=this._layers,g=this._gc?this._gc._surface.getEventSource():null;if(c===this.graphicsLayerIds)m.forEach(c,function(b,c){var s=e[b];s&&(d(s.getEventSource(),g,c),a(n[b],c))});else{var s=this.graphics,r=s?s.id:null,t=this._layersDiv,v;m.forEach(c,function(b,c){v=e[b];b!==r&&v&&(d(v,t,c),a(n[b],c))});this._mapImageLyr&&this._placeMapImageLyr();g&&(g=9>b("ie")?
g.parentNode:g,d(g,g.parentNode,c.length))}this.onLayersReordered([].concat(c))},_zoomStartHandler:function(){this.__zoomStart(this._zoomAnimDiv.startingExtent,this._zoomAnimDiv.anchor)},_zoomingHandler:function(b){var c=parseFloat(b.left),a=parseFloat(b.top);b=new K(c,a-parseFloat(b.height),c+parseFloat(b.width),a,this.spatialReference);c=this.extent.getWidth()/b.getWidth();this.__zoom(b,c,this._zoomAnimDiv.anchor)},_zoomEndHandler:function(){var b=this._zoomAnimDiv,c=b.extent,a=this.extent.getWidth()/
c.getWidth(),d=b.anchor,e=b.newLod,n=b.levelChange;b.extent=b.anchor=b.levelChange=b.startingExtent=b.newLod=this._delta=this._zoomAnim=null;this.__zoomEnd(c,a,d,e,n)},_panningHandler:function(b){if(isNaN(parseFloat(b.left))||isNaN(parseFloat(b.top))){var c=Math.round,a=this._panAnim.node;b.left=-1*(this._delta.x-c(this.width/2))+"px";b.top=-1*(this._delta.y-c(this.height/2))+"px";t.set(a,"left",b.left);t.set(a,"top",b.top)}b=new Q(parseFloat(b.left),parseFloat(b.top));c=this.toMap(b);this.onPan(this.extent.offset(this.extent.xmin-
c.x,this.extent.ymax-c.y),b)},_panEndHandler:function(b){this.__panning=!1;var c=Math.round;b=new Q(-c(parseFloat(b.style.left)),-c(parseFloat(b.style.top)));var c=b.x,a=b.y,d=this.__visibleRect,e=this.__visibleDelta;d.x+=-c;d.y+=-a;e.x+=-c;e.y+=-a;pa(this._zoomAnimDiv,{left:"0px",top:"0px"});var d=this.extent,e=this._ratioW,n=this._ratioH,d=new K(d.xmin+c/e,d.ymin-a/n,d.xmax+c/e,d.ymax-a/n,this.spatialReference);b.setX(-b.x);b.setY(-b.y);this._delta=this._panAnim=null;this._updateExtent(d);this.onPanEnd(d,
b);this._fireExtChg([d,b,!1,this.__LOD])},_fixExtent:function(b,c){for(var a=this._reshapeExtent(b),d=1.25;!0===c&&(a.extent.getWidth()<b.getWidth()||a.extent.getHeight()<b.getHeight())&&0<a.lod.level&&3>=d;)a=this._reshapeExtent(b.expand(d)),d+=0.25;return a},_getFrameWidth:function(){var b=-1,c=this.spatialReference._getInfo();this.__LOD?(c=this.__LOD._frameInfo)&&(b=c[3]):c&&(b=Math.round(2*c.valid[1]/(this.extent.getWidth()/this.width)));return b},_fixAspectRatio:function(b){var c=b.getWidth(),
a=b.getHeight(),d=c/a,e=this.width/this.height,n=0,g=0;this.width>this.height?c>a?e>d?n=a*e-c:g=c/e-a:n=a*e-c:this.width<this.height?c<a?e>d?n=a*e-c:g=c/e-a:g=c/e-a:c<a?n=a-c:c>a&&(g=c/e-a);n&&(b.xmin-=n/2,b.xmax+=n/2);g&&(b.ymin-=g/2,b.ymax+=g/2);return b},_reshapeExtent:function(b){b=this._fixAspectRatio(b);return this._getAdjustedExtent(b)},_getAdjustedExtent:function(b){if(this.__tileInfo)return E.getCandidateTileInfo(this,this.__tileInfo,b);var c=G.getScale(this,b),a=this.getMinScale(),d=this.getMaxScale(),
e=!d||c>=d;a&&!(c<=a)?b=G.getExtentForScale(this,a,b):e||(b=G.getExtentForScale(this,d,b));return{extent:b}},_onBingLayerAdd:function(b){this["__"+b.id+"_vis_connect"]=k.connect(b,"onVisibilityChange",this,"_toggleBingLogo");this._toggleBingLogo(b.visible)},_onBingLayerRemove:function(b){k.disconnect(this["__"+b.id+"_vis_connect"]);delete this["__"+b.id+"_vis_connect"];var c=m.some(this.layerIds,function(c){return(b=this._layers[c])&&b.visible&&-1!==b.declaredClass.indexOf("VETiledLayer")},this);
this._toggleBingLogo(c)},_toggleBingLogo:function(c){c&&!this._bingLogo?(c={left:this._mapParams&&this._mapParams.nav?"25px":""},6===b("ie")&&(c.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+p.toUrl("./images/map/bing-logo-lg.png")+"')"),c=this._bingLogo=u.create("div",{style:c},this.root),r.add(c,"bingLogo-lg")):!c&&this._bingLogo&&(u.destroy(this._bingLogo),delete this._bingLogo)},__panStart:function(b,c){var a=this._zoomAnim,d=this._panAnim;
if(a&&a._active)a.stop(),a._fire("onEnd",[a.node]);else if(d&&d._active){d.stop();this._panAnim=null;var d=d.curve.getValue(d._getStep()),a=Math.round(parseFloat(d.left)),d=Math.round(parseFloat(d.top)),e=this.navigationManager._dragOrigin;this.__pan(a,d);e&&(e.x-=a,e.y-=d);return}this.__panning=!0;this.onPanStart(this.extent,new Q(b,c))},__pan:function(b,c){var a=this.extent,d=this._ratioW,e=this._ratioH;this.onPan(new K(a.xmin-b/d,a.ymin+c/e,a.xmax-b/d,a.ymax+c/e,this.spatialReference),new Q(b,
c))},__panEnd:function(b,c){var a=this.__visibleRect,d=this.__visibleDelta;a.x+=b;a.y+=c;d.x+=b;d.y+=c;var a=new Q(b,c),d=this.extent,e=this._ratioW,n=this._ratioH,d=new K(d.xmin-b/e,d.ymin+c/n,d.xmax-b/e,d.ymax+c/n,this.spatialReference);this.__panning=!1;this._updateExtent(d);this.onPanEnd(d,a);this._fireExtChg([d,a,!1,this.__LOD])},__zoomStart:function(b,c){this.__zooming=!0;this.onZoomStart(b,1,c,this.__LOD?this.__LOD.level:null)},__zoom:function(b,c,a){this.onZoom(b,c,a)},__zoomEnd:function(b,
c,a,d,e){pa(this._layersDiv,{left:"0px",top:"0px"});this._delta=new Q(0,0);this.__visibleRect.x=this.__visibleRect.y=0;b=new K(b);this.__LOD=d;this._ratioW=this.width/b.getWidth();this._ratioH=this.height/b.getHeight();var n=this._delta;this._delta=null;this.__zooming=!1;this._updateExtent(b,e);this.onZoomEnd(b,c,a,d?d.level:null);this._fireExtChg([b,n,e,d])},_extentUtil:function(b,c,a,d,e){var n=new h,g,s,r,t,v,u,w,f,k,m,z=this.width,l=this.height,x,A,B;b&&(g=b.numLevels,s=b.targetLevel,x=y.isDefined(s),
r=b.factor,t=b.mapAnchor,v=b.screenAnchor,u=b.mapCenter,A=b.levelOrFactor,w=b.targetScale,f=y.isDefined(w)&&0<w);c&&(k=c.dx,m=c.dy,u=c.mapCenter);q.isArray(u)&&(u=new M(u));var p=this._panAnim;c=(b=this._stopAnim())?b.divExtent:this.extent;var E=this.__tileInfo,F=this._params;if(!this.loaded){if(a)c&&(a=this._convertGeometry(c,a)),a&&(this.extent=a,F.zoom=F.scale=-1,F.center=null);else if(u||x||f){if(u)if(c){if(u=this._convertGeometry(c,u))this.extent=c.centerAt(u),F.center=null}else F.center=u;x&&
-1<s?(F.zoom=s,F.scale=-1):f&&(F.scale=w,F.zoom=-1)}n.resolve();return n}if(u&&(u=this._convertGeometry(this,u),!u)||t&&(t=this._convertGeometry(this,t),!t)||a&&(a=this._convertGeometry(this,a),!a))return n.reject(),n;p&&(t&&v)&&(t=ia(this.extent,z,l,v));b&&(t&&v)&&(t=ia(b.divExtent,z,l,v));x&&(E?(g=this.getMinZoom(),x=this.getMaxZoom(),s<g?s=g:s>x&&(s=x),g=s-(b?b.level:this.getLevel())):(g=0<s?-1:1,B=A?s:null));if(!a)if(y.isDefined(g))E?(z=b?b.level:this.getLevel(),l=this.__getExtentForLevel(z+g,
u,c).extent):(l=(b?b.end:this.extent).expand(B||(0<g?0.5*g:2*-g)),B&&u&&(l=l.centerAt(u))),l&&(u?a=l:(z=t||c.getCenter(),k=c.ymax-(l.getHeight()-c.getHeight())*(z.y-c.ymax)/c.getHeight(),z=c.xmin-(l.getWidth()-c.getWidth())*(z.x-c.xmin)/c.getWidth(),a=new K(z,k-l.getHeight(),z+l.getWidth(),k,this.spatialReference)));else if(f)a=G.getExtentForScale(this,w,c);else if(y.isDefined(r))a=c.expand(r);else if(k||m)b?(a=b.end,t=a.getCenter(),B=oa(a,z,l,t),B.x+=k,B.y+=m,B=ia(a,z,l,B),a=a.offset(B.x-t.x,B.y-
t.y)):(k=new Q(z/2+k,l/2+m),m=ia(c,z,l,k),l=c.getWidth(),k=c.getHeight(),z=m.x-l/2,m=m.y-k/2,a=new K(z,m,z+l,m+k,this.spatialReference));a||(u?(c=b?b.end:c,l=c.getWidth(),k=c.getHeight(),z=u.x-l/2,m=u.y-k/2,a=new K(z,m,z+l,m+k,this.spatialReference)):b&&(a=b.end));a?(this._extentDfd&&-1===this._extentDfd.fired&&(this._extentDfd.then(null,Pa),this._extentDfd.reject()),this._extentDfd=n,this.__setExtent(a,null,v,d,b,e)):n.reject();return n},__setExtent:function(c,a,d,e,n,g){try{if(this._firstLayerId)this.extent=
c;else{var s=!0,r=this.spatialReference,t=n?n.divExtent:this.extent,v=this._fixExtent(c,e||!1);c=v.extent;var u=c.getWidth(),w=c.getHeight(),f=Math.round;if(t)var h=f(1E6*t.getWidth()),k=f(1E6*u),m=f(1E6*t.getHeight()),q=f(1E6*w),s=h!==k||m!==q;var z,l,x=n&&n.rect,y=n&&n.divExtent;if(ua.zoomDuration&&s&&t){y=y||new K(t);x=x||{left:t.xmin,top:t.ymax,width:t.getWidth(),height:t.getHeight()};l={left:c.xmin,top:c.ymax,width:u,height:w};var A=new M(c.xmin,c.ymax,r),p=new M(c.xmin,c.ymin,r),E=new M(this.extent.xmin,
this.extent.ymax,r),F=new M(this.extent.xmin,this.extent.ymin,r);z=O.getLineIntersection(E,A,F,p,r);!z&&!n&&(s=!1)}this._ratioW=this.width/u;this._ratioH=this.height/w;var I=this._zoomAnimDiv;if(s)if(pa(this._layersDiv,{left:"0px",top:"0px"}),a=new Q(0,0),this.__visibleRect.x=this.__visibleRect.y=0,x&&l){this._delta=a;I.id="_zAD";I.startingExtent=y;I.extent=c;I.levelChange=s;I.newLod=v.lod;I.anchor=d?d:!z&&n?n.anchor:oa(this.extent,this.width,this.height,z);var H=this.extent.getWidth()/c.getWidth();
b("chrome")&&1024<(1>H?1/H:H)?(this.__zoomStart(y,I.anchor),this.__zoom(y,1,I.anchor),this._fireOnScale(1,I.anchor,!0),this.__zoomEnd(c,H,I.anchor,v.lod,s)):(this._zoomAnim=B.resize({node:I,start:x,end:l,duration:ua.zoomDuration,rate:ua.zoomRate,beforeBegin:!n?this._zoomStartHandler:null,onAnimate:this._zoomingHandler,onEnd:this._zoomEndHandler}).play(),this._fireOnScale(H,I.anchor,g))}else this._updateExtent(c,s),this._fireExtChg([this.extent,a,s,this.__LOD=v.lod]);else if(!this.__panning)if(!1===
this.loaded||g)this._updateExtent(c,s),this._fireExtChg([this.extent,a,s,this.__LOD=v.lod]);else{this.__panning=!0;x=(new J(0,0,this.width,this.height,this.spatialReference)).getCenter();x.x=f(x.x);x.y=f(x.y);var L=this._delta=this.toScreen(c.getCenter()),C=Math.abs(x.x-L.x),G=Math.abs(x.y-L.y);this.optimizePanAnimation&&(C>2*this.width||G>2*this.height)?(this.__panStart(0,0),this.__pan(0,0),this.__visibleRect.x=this.__visibleRect.y=this.__visibleDelta.x=this.__visibleDelta.y=0,this.__panning=!1,
this._delta=null,this._updateExtent(c,!1),this.onPanEnd(this.extent,new Q(0,0)),this._fireExtChg([this.extent,new Q(0,0),!0,this.__LOD])):(this.onPanStart(this.extent,new Q(0,0)),this._panAnim=B.slideTo({node:I,left:x.x-L.x,top:x.y-L.y,duration:ua.panDuration,rate:ua.panRate,onAnimate:this._panningHandler,onEnd:this._panEndHandler}),this._panAnim.play())}}}catch(Y){console.log(Y.stack),console.error(Y)}},_fireOnScale:function(b,c,a){if("css-transforms"===this.navigationMode){var d=this.__visibleDelta;
this.onScale(n.scaleAt(b,{x:-1*(this.width/2-(c.x-d.x)),y:-1*(this.height/2-(c.y-d.y))}),a)}},_stopAnim:function(){var b=this._zoomAnim,c=this._panAnim;if(b&&b._active){b.stop();var c=b.curve.getValue(b._getStep()),a=parseFloat(c.left),d=parseFloat(c.top),b=b.node;return{anchor:b.anchor,start:b.startingExtent,end:b.extent,level:b.newLod&&b.newLod.level,rect:c,divExtent:new K(a,d-parseFloat(c.height),a+parseFloat(c.width),d,this.spatialReference)}}c&&c._active&&(c.stop(),c._fire("onEnd",[c.node]))},
__getExtentForLevel:function(b,c,a){var d=this.__tileInfo,d=d&&d.lods;b=y.isDefined(b)?b:0;a=a||this.extent;c=c||a&&a.getCenter();if(d){if(c){a=this.getMinZoom();var e=this.getMaxZoom();b>e&&(b=e);b<a&&(b=a);b=d[b];d=this.width*b.resolution/2;a=this.height*b.resolution/2;return{extent:new K(c.x-d,c.y-a,c.x+d,c.y+a,c.spatialReference),lod:b}}}else if(a)return{extent:a.expand(!b||1>b?1:b).centerAt(c)};console.log("Map: "+this.invalidExtent)},_jobs:0,_incr:function(){1===++this._jobs&&(this.updating=
!0,this.attr("data-updating",""),this.onUpdateStart())},_decr:function(){var b=--this._jobs;b?0>b&&(this._jobs=0):(this.updating=!1,this.attr("data-updating"),this.onUpdateEnd())},_fireEvent:function(b,c){this[b]&&this[b].apply(this,c)},_updateExtent:function(b,c){this.extent=b;c&&this._setClipRect();var a=this.spatialReference;a&&(a.isWebMercator()?this.geographicExtent=P.webMercatorToGeographic(this._getAvailExtent(),!0):4326===a.wkid&&(this.geographicExtent=new K(this._getAvailExtent().toJson())))},
_fireExtChg:function(b){this.attr("data-zoom",this.getZoom());this.attr("data-scale",this.getScale());this._fireEvent("onExtentChange",b);if(b=this._extentDfd)delete this._extentDfd,b.resolve()},attr:function(b,c){var a=this.container;a&&(null==c?a.removeAttribute(b):a.setAttribute(b,c));return this},onUpdateStart:function(){},onUpdateEnd:function(){},onLoad:function(){this._setClipRect()},onBeforeUnload:function(){},onUnload:function(){},onExtentChange:function(b,c,a){},onTimeExtentChange:function(){},
onLayerAdd:function(){},onLayerAddResult:function(){},onLayersAddResult:function(){},onLayerRemove:function(){},onLayersRemoved:function(){},onLayerReorder:function(){},onLayersReordered:function(){},onLayerSuspend:function(){},onLayerResume:function(){},onPanStart:function(){},onPan:function(){},onPanEnd:function(){},onScale:function(){},onZoomStart:function(){},onZoom:function(){},onZoomEnd:function(){},onResize:function(){this._setClipRect()},onReposition:function(){},destroy:function(){this._destroyed||
(this.onBeforeUnload(this),this.removeAllLayers(),this._cleanUp(),clearTimeout(this._resizeT),this._gc&&this._gc._cleanUp(),this._destroyed=!0,this.onUnload(this))},setCursor:function(b){pa(this.__container,"cursor",this.cursor=b)},setMapCursor:function(b){this.setCursor(this._cursor=b)},resetMapCursor:function(){this.setCursor(this._cursor)},setInfoWindow:function(b){var c=this.infoWindow;c&&c.unsetMap(this);this.infoWindow=b;this.loaded&&b&&b.setMap(this)},setInfoWindowOnClick:function(b){this._params.showInfoWindowOnClick=
b;this.popupManager&&this.popupManager.set("enabled",b)},getInfoWindowAnchor:function(b){return this.infoWindow&&this.infoWindow._getAnchor&&this.infoWindow._getAnchor(b)||"upperright"},toScreen:function(b,c){return oa(this.extent,this.width,this.height,b,c)},toMap:function(b){return ia(this.extent,this.width,this.height,b)},addLayer:function(b,c){b&&!this.getLayer(b.id)&&this._addLayer(b,b instanceof V?this.graphicsLayerIds:this.layerIds,c);return b},addLayers:function(b){var c=[],a=b.length,d,e,
n=b.length;d=k.connect(this,"onLayerAddResult",function(e,n){-1!==m.indexOf(b,e)&&(a--,c.push({layer:e,success:!n,error:n}),a||(k.disconnect(d),this.onLayersAddResult(c)))});for(e=0;e<n;e++)this.addLayer(b[e]);return this},removeLayer:function(b,c){var a=b.id,d=b instanceof V?this.graphicsLayerIds:this.layerIds,e=Aa(d,a);0<=e&&(d.splice(e,1),b instanceof V?(sa(this["_gl_"+b.id+"_click_connect"]),b.loaded&&b._unsetMap(this,this._gc._surface)):b.loaded&&(b._unsetMap(this,this._layersDiv),-1!==b.declaredClass.indexOf("VETiledLayer")&&
this._onBingLayerRemove(b)),delete this._layers[a],delete this._layerDivs[a],c||this._reorderLayers(d),this.onLayerRemove(b))},removeAllLayers:function(){var b=this.layerIds,c;for(c=b.length-1;0<=c;c--)this.removeLayer(this._layers[b[c]],1);b=this.graphicsLayerIds;for(c=b.length-1;0<=c;c--)this.removeLayer(this._layers[b[c]],1);this.onLayersRemoved()},reorderLayer:function(b,c){q.isString(b)&&(a.deprecated(this.declaredClass+": Map.reorderLayer(/*String*/ id, /*Number*/ index) deprecated. Use Map.reorderLayer(/*Layer*/ layer, /*Number*/ index).",
null,"v2.0"),b=this.getLayer(b));var d=b.id,e,n=b instanceof V?this.graphicsLayerIds:this.layerIds;0>c?c=0:c>=n.length&&(c=n.length-1);e=Aa(n,d);-1===e||e===c||(n.splice(e,1),n.splice(c,0,d),this._reorderLayers(n))},getLayer:function(b){return this._layers[b]},setExtent:function(b,c){b=new K(b.toJson());var a=b.getWidth(),d=b.getHeight();return 0===a&&0===d?this.centerAt(new M({x:b.xmin,y:b.ymin,spatialReference:b.spatialReference&&b.spatialReference.toJson()})):this._extentUtil(null,null,b,c)},centerAt:function(b){return this._extentUtil(null,
{mapCenter:b})},centerAndZoom:function(b,c){return this._extentUtil({targetLevel:c,mapCenter:b,levelOrFactor:!0})},getScale:function(){return this.__LOD?this.__LOD.scale:G.getScale(this)},getResolution:function(){return this.__LOD?this.__LOD.resolution:this.extent?this.extent.getWidth()/this.width:0},getResolutionInMeters:function(){return this.getResolution()*G.getUnitValueForSR(this.spatialReference)},getMinScale:function(){return this._params.minScale},getMaxScale:function(){return this._params.maxScale},
setScale:function(b){return this._extentUtil({targetScale:b})},getLayersVisibleAtScale:function(b){var c=[];(b=b||this.getScale())&&m.forEach(this.layerIds.concat(this.graphicsLayerIds),function(a){a=this.getLayer(a);a.isVisibleAtScale(b)&&c.push(a)},this);return c},getNumLevels:function(){var b=this.getMinZoom(),c=this.getMaxZoom();return b===c&&0>b?0:c-b+1},getLevel:function(){return this.__LOD?this.__LOD.level:-1},setLevel:function(b){if(-1<b)return this._extentUtil({targetLevel:b})},getZoom:function(){return this.getLevel()},
setZoom:function(b){return this.setLevel(b)},getMinZoom:function(){return this._params.minZoom},getMaxZoom:function(){return this._params.maxZoom},setBasemap:function(b){var c;q.isObject(b)?(c=b,b=c.title):c=z&&z[b];if(c){this._basemapDfd&&-1===this._basemapDfd.fired&&this._basemapDfd.cancel();var a=[],d=[],e=0;m.forEach(c.baseMapLayers||c.layers,function(c){var n,g={id:c.id,displayLevels:c.displayLevels,opacity:y.isDefined(c.opacity)?c.opacity:null,visible:y.isDefined(c.visibility)?c.visibility:
null};if(c.type)switch(c.type){case "OpenStreetMap":n=new la(g);break;case "VectorTile":n=H._ensureProperProtocolForAGOResource(c.url);n=new aa(n,g);break;default:console.log("Map.setBasemap: "+y.substitute({basemapName:b,type:c.type},this.unknownLayerType))}else{n=c.url;if(("https:"===window.location.protocol||"file:"===window.location.protocol)&&(-1!==n.search(/^http\:\/\/server\.arcgisonline\.com/i)||-1!==n.search(/^http\:\/\/services\.arcgisonline\.com/i)||-1!==n.search(/^http\:\/\/.+\.arcgis\.com/i)))n=
n.replace(/http:/i,"https:");n=new X(n,g)}n&&(a.push(n),d.push(c),c.isReference||e++)},this);if(!a.length||!e)console.log("Map.setBasemap: "+y.substitute({basemapName:b},this.invalidBasemap));else{var n={basemapName:b,infos:d,layers:a};if(this.loaded){var g=this,s=new h(F._dfdCanceller),r=function(b){s._pendingLayers--;b=m.indexOf(n.layers,this);if(-1<b&&(b=s._layerEvents[b]))k.disconnect(b[0]),k.disconnect(b[1]);0>=s._pendingLayers&&(delete s._layerEvents,delete g._basemapDfd,0>s.fired&&s.callback(n))};
this._basemapDfd=s;s._pendingLayers=0;s._layerEvents={};m.forEach(a,function(b,c){b&&(s._pendingLayers++,b.loaded?r(b):s._layerEvents[c]=[k.connect(b,"onLoad",b,r),k.connect(b,"onError",b,r)])});s.addCallback(ea(this,this._basemapLoaded))}else this._basemapLoaded(n)}}else{c=[];for(var t in z)c.push(t);console.log("Map.setBasemap: "+y.substitute({basemapName:b,list:c.join(",")},this.unknownBasemap))}},_basemapLoaded:function(b){var c=b.layers,a=b.infos,d=0,e=!0,n;this.loaded&&(m.forEach(c,function(b,
c){b.loaded&&(a[c].isReference||d++)}),e=d);e&&(this.basemapLayerIds&&(n={basemapName:this._basemap,infos:z&&z[this._basemap]&&z[this._basemap].baseMapLayers},n.basemapName||(m.forEach(this.basemapLayerIds,function(b){if(this.getLayer(b)instanceof la)return n.basemapName="osm",n.infos=z&&z.osm&&z.osm.baseMapLayers,!1},this),n.basemapName||(n=null))),this._removeBasemap(),this._basemap=b.basemapName,this.basemapLayerIds=this._addBasemap(c,a),this.attr("data-basemap",this.getBasemap()),this.emit("basemap-change",
{current:b,previous:n}))},_addBasemap:function(b,c){var a=[],d=[],e=0;m.forEach(b,function(b,n){c[n].isReference?a.push(b):(this.addLayer(b,e++),d.push(b.id))},this);a.length&&m.forEach(a,function(b){b.attr("data-reference",!0);this.addLayer(b,"top");d.push(b.id)},this);return d},_removeBasemap:function(){var b=this.basemapLayerIds,c;b&&b.length&&m.forEach(b,function(b){(c=this.getLayer(b))&&this.removeLayer(c)},this)},getBasemap:function(){return this._basemap||""},translate:function(b,c){b=b||0;
c=c||0;if(!this._txTimer){this._tx=this._ty=0;var a=this.toScreen(this.extent.getCenter());this.__panStart(a.x,a.y)}this._tx+=b;this._ty+=c;this.__pan(this._tx,this._ty);clearTimeout(this._txTimer);this._txTimer=setTimeout(this._endTranslate,150)},_endTranslate:function(){clearTimeout(this._txTimer);this._txTimer=null;var b=this._tx,c=this._ty;this._tx=this._ty=0;this.__panEnd(b,c)},setTimeExtent:function(b){b=(this.timeExtent=b)?new b.constructor(b.toJson()):null;this.onTimeExtentChange(b)},setTimeSlider:function(b){this.timeSlider&&
(sa(this._tsTimeExtentChange_connect),this.timeSlider=this._tsTimeExtentChange_connect=null);b&&(this.timeSlider=b,this.setTimeExtent(b.getCurrentTimeExtent()),this._tsTimeExtentChange_connect=xa(b,"onTimeExtentChange",this,"setTimeExtent"))},setVisibility:function(b){if(this.visible!==b){this.visible=b;b||(this._display=this.container.style.display);this.container.style.display=b?this._display:"none";if(this.autoResize){var c=b?"resume":"pause";this._rszSignal[c]();this._oriSignal[c]()}b&&this.resize()}return this},
resize:function(b){clearTimeout(this._resizeT);this._destroyed||(!0===b?this._execResize():this._resizeT=setTimeout(this._execResize,this.resizeDelay))},_timedResize:function(){this._resizeT||this._execResize()},_execResize:function(){clearTimeout(this._resizeT);this._resizeT=null;this.reposition();this._resize();this.autoResize&&this._startResizeTimer()},_resize:function(){var b=this.width,c=this.height,a=t.get(this.container,"display"),d=s.getContentBox(this.container);if(!("none"===a||0>=d.w||
0>=d.h||b===d.w&&c===d.h)){if(a=this._zoomAnim||this._panAnim)a.stop(),a._fire("onEnd",[a.node]);pa(this.root,{width:(this.width=d.w)+"px",height:(this.height=d.h)+"px"});d=this.width;a=this.height;this.attribution&&this.attribution.domNode&&t.set(this.attribution.domNode,"maxWidth",Math.floor(d*this._mapParams.attributionWidth)+"px");this.__visibleRect.update(this.__visibleRect.x,this.__visibleRect.y,d,a);this.__visibleDelta.update(this.__visibleDelta.x,this.__visibleDelta.y,d,a);var e=new J(this.extent),
b=(new J(e.x,e.y,e.width*(d/b),e.height*(a/c),this.spatialReference)).getExtent();this.onResize(b,d,a);this._extentUtil(null,null,b,null,!0)}},reposition:function(){var b=this.position,c=b.x,a=b.y;this._reposition();b=this.position;if(c!==b.x||a!==b.y)this.onReposition(b.x,b.y)},_reposition:function(){var b=s.position(this.container,!0),c=s.getPadBorderExtents(this.container);this.position.update(b.x+c.l,b.y+c.t)},_setClipRect:function(){delete this._clip;var c=7>=b("ie")||void 0===b("ie")&&7<=b("trident")?
"rect(auto,auto,auto,auto)":"auto";if(this.wrapAround180){var a=this.width,d=this.height,e=this._getFrameWidth(),n=a-e;0<n&&(c=n/2,c="rect(0px,"+(c+e)+"px,"+d+"px,"+c+"px)",d=this.extent.getWidth(),a=d*(e/a),this._clip=[(d-a)/2,a])}pa(this.__container,"clip",c)},_getAvailExtent:function(){var b=this.extent,c=this._clip;if(c){if(!b._clip){var a=new J(b);a.width=c[1];a.x+=c[0];b._clip=a.getExtent()}return b._clip}return b},_fixedPan:function(b,c){return this._extentUtil(null,{dx:b,dy:c})},panUp:function(){return this._fixedPan(0,
-0.75*this.height)},panUpperRight:function(){return this._fixedPan(0.75*this.width,-0.75*this.height)},panRight:function(){return this._fixedPan(0.75*this.width,0)},panLowerRight:function(){return this._fixedPan(0.75*this.width,0.75*this.height)},panDown:function(){return this._fixedPan(0,0.75*this.height)},panLowerLeft:function(){return this._fixedPan(-0.75*this.width,0.75*this.height)},panLeft:function(){return this._fixedPan(-0.75*this.width,0)},panUpperLeft:function(){return this._fixedPan(-0.75*
this.width,-0.75*this.height)},enableSnapping:function(b){b=b||{};if("esri.SnappingManager"===b.declaredClass)this.snappingManager=b;else{var c=Ea++,a=this;this._rids&&this._rids.push(c);p(["./SnappingManager"],function(d){var e=a._rids?m.indexOf(a._rids,c):-1;-1!==e&&(a._rids.splice(e,1),a.snappingManager=new d(q.mixin({map:a},b)))})}return this.snappingManager},disableSnapping:function(){this.snappingManager&&this.snappingManager.destroy();this.snappingManager=null},_createLabelLayer:function(){function b(){c._labels.removeAllFeatureLayers();
m.forEach(c.graphicsLayerIds,function(b){b=c.getLayer(b);"function"===typeof b.applyEdits&&c._labels.addFeatureLayer(b);"esri.layers.WFSLayer"===b.declaredClass&&c._labels.addFeatureLayer(b)})}var c=this;!this._labels&&(za&&this.loaded)&&(this._labels=new za({id:"_internal_LabelLayer"}),this._labels._setMap(this,this._gc._surface),b(),this.on("layers-reordered",b))},_getMapImageLyr:function(){this.loaded&&!this._mapImageLyr&&(this._mapImageLyr=new Y,this._mapImageLyr._setMap(this,this._layersDiv),
this._placeMapImageLyr());return this._mapImageLyr},_placeMapImageLyr:function(){for(var b=this.layerIds,c=this._layerDivs,a=!1,d,e,n=b.length-1;0<=n;n--)if(d=b[n],e=this.getLayer(d),d=c[d],e&&d&&!e._isReference){u.place(this._mapImageLyr._div,d,"after");a=!0;break}a||u.place(this._mapImageLyr._div,this._layersDiv,"first")}})})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(p,f){var a=p.matrix={},l={};a._degToRad=function(a){return l[a]||(l[a]=Math.PI*a/180)};a._radToDeg=
function(a){return 180*(a/Math.PI)};a.Matrix2D=function(k){if(k)if("number"==typeof k)this.xx=this.yy=k;else if(k instanceof Array){if(0<k.length){for(var h=a.normalize(k[0]),q=1;q<k.length;++q){var m=h,g=a.normalize(k[q]),h=new a.Matrix2D;h.xx=m.xx*g.xx+m.xy*g.yx;h.xy=m.xx*g.xy+m.xy*g.yy;h.yx=m.yx*g.xx+m.yy*g.yx;h.yy=m.yx*g.xy+m.yy*g.yy;h.dx=m.xx*g.dx+m.xy*g.dy+m.dx;h.dy=m.yx*g.dx+m.yy*g.dy+m.dy}f.mixin(this,h)}}else f.mixin(this,k)};f.extend(a.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});f.mixin(a,
{identity:new a.Matrix2D,flipX:new a.Matrix2D({xx:-1}),flipY:new a.Matrix2D({yy:-1}),flipXY:new a.Matrix2D({xx:-1,yy:-1}),translate:function(f,h){return 1<arguments.length?new a.Matrix2D({dx:f,dy:h}):new a.Matrix2D({dx:f.x,dy:f.y})},scale:function(f,h){return 1<arguments.length?new a.Matrix2D({xx:f,yy:h}):"number"==typeof f?new a.Matrix2D({xx:f,yy:f}):new a.Matrix2D({xx:f.x,yy:f.y})},rotate:function(f){var h=Math.cos(f);f=Math.sin(f);return new a.Matrix2D({xx:h,xy:-f,yx:f,yy:h})},rotateg:function(f){return a.rotate(a._degToRad(f))},
skewX:function(f){return new a.Matrix2D({xy:Math.tan(f)})},skewXg:function(f){return a.skewX(a._degToRad(f))},skewY:function(f){return new a.Matrix2D({yx:Math.tan(f)})},skewYg:function(f){return a.skewY(a._degToRad(f))},reflect:function(f,h){1==arguments.length&&(h=f.y,f=f.x);var q=f*f,m=h*h,g=q+m,e=2*f*h/g;return new a.Matrix2D({xx:2*q/g-1,xy:e,yx:e,yy:2*m/g-1})},project:function(f,h){1==arguments.length&&(h=f.y,f=f.x);var q=f*f,m=h*h,g=q+m,e=f*h/g;return new a.Matrix2D({xx:q/g,xy:e,yx:e,yy:m/g})},
normalize:function(f){return f instanceof a.Matrix2D?f:new a.Matrix2D(f)},isIdentity:function(a){return 1==a.xx&&0==a.xy&&0==a.yx&&1==a.yy&&0==a.dx&&0==a.dy},clone:function(f){var h=new a.Matrix2D,q;for(q in f)"number"==typeof f[q]&&("number"==typeof h[q]&&h[q]!=f[q])&&(h[q]=f[q]);return h},invert:function(f){f=a.normalize(f);var h=f.xx*f.yy-f.xy*f.yx;return f=new a.Matrix2D({xx:f.yy/h,xy:-f.xy/h,yx:-f.yx/h,yy:f.xx/h,dx:(f.xy*f.dy-f.yy*f.dx)/h,dy:(f.yx*f.dx-f.xx*f.dy)/h})},_multiplyPoint:function(a,
f,q){return{x:a.xx*f+a.xy*q+a.dx,y:a.yx*f+a.yy*q+a.dy}},multiplyPoint:function(f,h,q){f=a.normalize(f);return"number"==typeof h&&"number"==typeof q?a._multiplyPoint(f,h,q):a._multiplyPoint(f,h.x,h.y)},multiplyRectangle:function(f,h){var q=a.normalize(f);h=h||{x:0,y:0,width:0,height:0};if(a.isIdentity(q))return{x:h.x,y:h.y,width:h.width,height:h.height};var m=a.multiplyPoint(q,h.x,h.y),g=a.multiplyPoint(q,h.x,h.y+h.height),e=a.multiplyPoint(q,h.x+h.width,h.y),c=a.multiplyPoint(q,h.x+h.width,h.y+h.height),
q=Math.min(m.x,g.x,e.x,c.x),d=Math.min(m.y,g.y,e.y,c.y),r=Math.max(m.x,g.x,e.x,c.x),m=Math.max(m.y,g.y,e.y,c.y);return{x:q,y:d,width:r-q,height:m-d}},multiply:function(f){for(var h=a.normalize(f),q=1;q<arguments.length;++q){var m=h,g=a.normalize(arguments[q]),h=new a.Matrix2D;h.xx=m.xx*g.xx+m.xy*g.yx;h.xy=m.xx*g.xy+m.xy*g.yy;h.yx=m.yx*g.xx+m.yy*g.yx;h.yy=m.yx*g.xy+m.yy*g.yy;h.dx=m.xx*g.dx+m.xy*g.dy+m.dx;h.dy=m.yx*g.dx+m.yy*g.dy+m.dy}return h},_sandwich:function(f,h,q){return a.multiply(a.translate(h,
q),f,a.translate(-h,-q))},scaleAt:function(f,h,q,m){switch(arguments.length){case 4:return a._sandwich(a.scale(f,h),q,m);case 3:return"number"==typeof q?a._sandwich(a.scale(f),h,q):a._sandwich(a.scale(f,h),q.x,q.y)}return a._sandwich(a.scale(f),h.x,h.y)},rotateAt:function(f,h,q){return 2<arguments.length?a._sandwich(a.rotate(f),h,q):a._sandwich(a.rotate(f),h.x,h.y)},rotategAt:function(f,h,q){return 2<arguments.length?a._sandwich(a.rotateg(f),h,q):a._sandwich(a.rotateg(f),h.x,h.y)},skewXAt:function(f,
h,q){return 2<arguments.length?a._sandwich(a.skewX(f),h,q):a._sandwich(a.skewX(f),h.x,h.y)},skewXgAt:function(f,h,q){return 2<arguments.length?a._sandwich(a.skewXg(f),h,q):a._sandwich(a.skewXg(f),h.x,h.y)},skewYAt:function(f,h,q){return 2<arguments.length?a._sandwich(a.skewY(f),h,q):a._sandwich(a.skewY(f),h.x,h.y)},skewYgAt:function(f,h,q){return 2<arguments.length?a._sandwich(a.skewYg(f),h,q):a._sandwich(a.skewYg(f),h.x,h.y)}});p.Matrix2D=a.Matrix2D;return a})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),
function(p,f,a,l,k,h,q,m,g){var e=f.getObject("dojox.gfx",!0),c=e._base={};e._hasClass=function(b,c){var a=b.getAttribute("className");return a&&0<=(" "+a+" ").indexOf(" "+c+" ")};e._addClass=function(b,c){var a=b.getAttribute("className")||"";if(!a||0>(" "+a+" ").indexOf(" "+c+" "))b.setAttribute("className",a+(a?" ":"")+c)};e._removeClass=function(b,c){var a=b.getAttribute("className");a&&b.setAttribute("className",a.replace(RegExp("(^|\\s+)"+c+"(\\s+|$)"),"$1$2"))};c._getFontMeasurements=function(){var b=
{"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},c,a;l("ie")&&(a=k.doc.documentElement.style.fontSize||"",a||(k.doc.documentElement.style.fontSize="100%"));var d=m.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},k.body());for(c in b)d.style.fontSize=c,b[c]=16*Math.round(12*d.offsetHeight/16)/12/1E3;
l("ie")&&(k.doc.documentElement.style.fontSize=a);k.body().removeChild(d);return b};var d=null;c._getCachedFontMeasurements=function(b){if(b||!d)d=c._getFontMeasurements();return d};var r=null,u={};c._getTextBox=function(b,c,a){var d,e,s=arguments.length,t;r||(r=m.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},k.body()));d=r;d.className="";e=d.style;e.borderWidth="0";e.margin="0";e.padding="0";e.outline="0";if(1<s&&c)for(t in c)t in u||(e[t]=c[t]);2<s&&a&&(d.className=
a);d.innerHTML=b;d.getBoundingClientRect?(e=d.getBoundingClientRect(),e={l:e.left,t:e.top,w:e.width||e.right-e.left,h:e.height||e.bottom-e.top}):e=g.getMarginBox(d);d.innerHTML="";return e};c._computeTextLocation=function(b,c,a,d){var e={};switch(b.align){case "end":e.x=b.x-c;break;case "middle":e.x=b.x-c/2;break;default:e.x=b.x}e.y=b.y-a*(d?0.75:1);return e};c._computeTextBoundingBox=function(b){if(!e._base._isRendered(b))return{x:0,y:0,width:0,height:0};var a;a=b.getShape();var d=b.getFont()||e.defaultFont;
b=b.getTextWidth();d=e.normalizedLength(d.size);a=c._computeTextLocation(a,b,d,!0);return{x:a.x,y:a.y,width:b,height:d}};c._isRendered=function(b){for(b=b.parent;b&&b.getParent;)b=b.parent;return null!==b};var s=0;c._getUniqueId=function(){var b;do b=p._scopeName+"xUnique"+ ++s;while(q.byId(b));return b};var t=l("pointer-events")?"touchAction":l("MSPointer")?"msTouchAction":null;c._fixMsTouchAction=t?function(b){b.rawNode.style[t]="none"}:function(){};f.mixin(e,{defaultPath:{type:"path",path:""},
defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},
defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var b=
{};return function(c){var a=b[c];if(a)return new a;a=b[c]=new Function;a.prototype=e["default"+c];return new a}}(),normalizeColor:function(b){return b instanceof a?b:new a(b)},normalizeParameters:function(b,c){var a;if(c){var d={};for(a in b)a in c&&!(a in d)&&(b[a]=c[a])}return b},makeParameters:function(b,c){var a=null;if(!c)return f.delegate(b);var d={};for(a in b)a in d||(d[a]=f.clone(a in c?c[a]:b[a]));return d},formatNumber:function(b,c){var a=b.toString();if(0<=a.indexOf("e"))a=b.toFixed(4);
else{var d=a.indexOf(".");0<=d&&5<a.length-d&&(a=b.toFixed(4))}return 0>b?a:c?" "+a:a},makeFontString:function(b){return b.style+" "+b.variant+" "+b.weight+" "+b.size+" "+b.family},splitFontString:function(b){var c=e.getDefault("Font");b=b.split(/\s+/);if(!(5>b.length)){c.style=b[0];c.variant=b[1];c.weight=b[2];var a=b[3].indexOf("/");c.size=0>a?b[3]:b[3].substring(0,a);var d=4;0>a&&("/"==b[4]?d=6:"/"==b[4].charAt(0)&&(d=5));d<b.length&&(c.family=b.slice(d).join(" "))}return c},cm_in_pt:72/2.54,mm_in_pt:7.2/
2.54,px_in_pt:function(){return e._base._getCachedFontMeasurements()["12pt"]/12},pt2px:function(b){return b*e.px_in_pt()},px2pt:function(b){return b/e.px_in_pt()},normalizedLength:function(b){if(0===b.length)return 0;if(2<b.length){var c=e.px_in_pt(),a=parseFloat(b);switch(b.slice(-2)){case "px":return a;case "pt":return a*c;case "in":return 72*a*c;case "pc":return 12*a*c;case "mm":return a*e.mm_in_pt*c;case "cm":return a*e.cm_in_pt*c}}return parseFloat(b)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,
pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,equalSources:function(b,c){return b&&c&&b===c},switchTo:function(b){var c="string"==typeof b?e[b]:b;c&&(h.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath EsriPath Surface createSurface fixTarget".split(" "),function(b){e[b]=c[b]}),"string"==typeof b?e.renderer=b:h.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(b){return e.renderer=e[b]&&e[b].Surface===e.Surface?b:null}))}});return e})},
"esri/basemaps":function(){define(["require","dojo/has","./kernel","dojo/i18n!./nls/jsapi"],function(p,f,a,l){return{streets:{title:l.basemaps.streets,thumbnailUrl:p.toUrl("./images/basemap/streets.jpg"),itemId:"d8855ee4d3d74413babfb0f41203b168",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]},satellite:{title:l.basemaps.satellite,thumbnailUrl:p.toUrl("./images/basemap/satellite.jpg"),itemId:"86de95d4e0244cba80f0fa2c9403a7b2",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]},
hybrid:{title:l.basemaps.hybrid,thumbnailUrl:p.toUrl("./images/basemap/hybrid.jpg"),itemId:"413fd05bbd7342f5991d5ec96f4f8b18",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer",isReference:!0}]},terrain:{title:l.basemaps.terrain,thumbnailUrl:p.toUrl("./images/basemap/terrain.jpg"),itemId:"aab054ab883c4a4094c72e949566ad40",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer"},
{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",isReference:!0}]},topo:{title:l.basemaps.topo,thumbnailUrl:p.toUrl("./images/basemap/topo.jpg"),itemId:"6e03e8c26aad4b9c92a87c1063ddb0e3",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer"}]},gray:{title:l.basemaps.gray,thumbnailUrl:p.toUrl("./images/basemap/gray.jpg"),itemId:"8b3b470883a744aeb60e5fff0a319ce7",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer"},
{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",isReference:!0}]},"dark-gray":{title:l.basemaps["dark-gray"],thumbnailUrl:p.toUrl("./images/basemap/dark-gray.jpg"),itemId:"da65bacab5bd4defb576f839b6b28098",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer"},{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",isReference:!0}]},oceans:{title:l.basemaps.oceans,
thumbnailUrl:p.toUrl("./images/basemap/oceans.jpg"),itemId:"48b8cec7ebf04b5fbdcaf70d09daff21",baseMapLayers:[{url:"http://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{url:"http://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",isReference:!0}]},"national-geographic":{title:l.basemaps["national-geographic"],thumbnailUrl:p.toUrl("./images/basemap/national-geographic.jpg"),itemId:"509e2d6b034246d692a461724ae2d62c",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer"}]},
osm:{title:l.basemaps.osm,thumbnailUrl:p.toUrl("./images/basemap/osm.jpg"),itemId:"5d2bfa736f8448b3a1708e1f6be23eed",baseMapLayers:[{type:"OpenStreetMap"}]},"dark-gray-vector":{title:l.basemaps["dark-gray"],thumbnailUrl:p.toUrl("./images/basemap/dark-gray.jpg"),itemId:"850db44b9eb845d3bd42b19e8aa7a024",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/850db44b9eb845d3bd42b19e8aa7a024/resources/styles/root.json",type:"VectorTile"}]},"gray-vector":{title:l.basemaps.gray,thumbnailUrl:p.toUrl("./images/basemap/gray.jpg"),
itemId:"0e02e6f86d02455091796eaae811d9b5",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/0e02e6f86d02455091796eaae811d9b5/resources/styles/root.json",type:"VectorTile"}]},"streets-vector":{title:l.basemaps.streets,thumbnailUrl:p.toUrl("./images/basemap/streets.jpg"),itemId:"4e1133c28ac04cca97693cf336cd49ad",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/4e1133c28ac04cca97693cf336cd49ad/resources/styles/root.json",type:"VectorTile"}]},"topo-vector":{title:l.basemaps.topo,
thumbnailUrl:p.toUrl("./images/basemap/topo.jpg"),itemId:"6f65bc1351b7411588a8cb43fe23dad7",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/6f65bc1351b7411588a8cb43fe23dad7/resources/styles/root.json",type:"VectorTile"}]},"streets-night-vector":{title:l.basemaps["streets-night-vector"],thumbnailUrl:p.toUrl("./images/basemap/streets-night.jpg"),itemId:"bf79e422e9454565ae0cbe9553cf6471",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/bf79e422e9454565ae0cbe9553cf6471/resources/styles/root.json",
type:"VectorTile"}]},"streets-relief-vector":{title:l.basemaps["streets-relief-vector"],thumbnailUrl:p.toUrl("./images/basemap/streets-relief.jpg"),itemId:"2e063e709e3446459f8538ed6743f879",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/2e063e709e3446459f8538ed6743f879/resources/styles/root.json",type:"VectorTile"}]},"streets-navigation-vector":{title:l.basemaps["streets-navigation-vector"],thumbnailUrl:p.toUrl("./images/basemap/streets-navigation.jpg"),itemId:"dcbbba0edf094eaa81af19298b9c6247",
baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/dcbbba0edf094eaa81af19298b9c6247/resources/styles/root.json",type:"VectorTile"}]}}})},"esri/Evented":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/Evented dojo/has ./kernel".split(" "),function(p,f,a,l,k,h){return p([l],{declaredClass:"esri.Evented",registerConnectEvents:function(){var a=this.constructor,h=this.constructor._meta.parents,g=[{}],e={},c,d,r=function(c,a){f.isArray(c)||(c=[c]);for(var d=0;d<
c.length;d++){var b=c[d];b._meta&&b._meta.parents&&r(b._meta.parents,a);b.prototype._eventMap&&a.push(f.mixin({},b.prototype._eventMap))}return a};if(!a._onMap){r(h,g);g.push(this._eventMap);h=f.mixin.apply(this,g);for(c in this)/^on\w/.test(c)&&f.isFunction(this[c])&&(g=this._hyphenLower(c).toLowerCase(),h[g]||(e[g]={method:c}));for(d in h)c=this._onCamelCase(d),e[d]={method:c,argKeys:h[d]};a._onMap=e;return a._onMap}},on:function(h,m){if(-1<h.indexOf(",")){for(var g=h.split(/\s*,\s*/),e=g.length,
c=[];e--;)c.push(this.on(g[e],m));c.remove=function(){for(var a=0;a<c.length;a++)c[a].remove()};return c}var g=this.constructor._onMap||this.registerConnectEvents(),e="string"==typeof h&&h.toLowerCase(),d=this._onCamelCase(e),r=g&&g[e];return(d=r&&r.method||this[d]&&f.isFunction(this[d])&&d)?r&&f.isArray(r.argKeys)?(g=this._onArr2Obj(m,g[e].argKeys),a.after(this,d,g,!0)):a.after(this,d,function(c){c=c||{};c.target||(c.target=this);m.call(this,c)},!0):this.inherited(arguments)},emit:function(a,h){var g,
e,c,d,r=a.toLowerCase();d=this._onCamelCase(a);var u=this.constructor._onMap||this.registerConnectEvents();d=(c=u&&u[r]&&u[r].method||f.isFunction(this[d])&&d)&&this[c];c&&(u&&u[r])&&this._onObj2Arr(function(){e=Array.prototype.slice.call(arguments)},u[r].argKeys)(h);h=h||{};h.target||(h.target=this);d&&(g=e&&e.length?e:[h],g=d.apply(this,g));this.inherited(arguments,[a,h]);return g},_onObj2Arr:function(a,f){if(f){var g=this;return function(e){var c,d=[],r=f.length;for(c=0;c<r;c++)d[c]=e[f[c]];a.apply(g,
d)}}return a},_onArr2Obj:function(a,f){if(f){var g=this;return function(){var e,c={},d=arguments.length;for(e=0;e<d;e++)c[f[e]]=arguments[e];c.target||(c.target=g);a.call(g,c)}}return a},_hyphenLower:function(a){return a.replace(/^on/,"").replace(/[A-Z](?=[a-z])/g,function(a,g){return(g?"-":"")+a.toLowerCase()})},_onCamelCase:function(a){return"on"+a.substr(0,1).toUpperCase()+a.substr(1).replace(/\-([a-z])/g,function(a,g){return g.toUpperCase()})}})})},"esri/fx":function(){define("dojo/_base/connect dojo/_base/fx dojo/_base/lang dojo/dom dojo/dom-geometry dojo/dom-style dojo/fx dojo/has ./kernel".split(" "),
function(p,f,a,l,k,h,q,m,g){return{animateRange:function(e){var c=e.range;return new f.Animation(a.mixin({curve:new f._Line(c.start,c.end)},e))},resize:function(e){var c=e.node=l.byId(e.node),d=e.start,g=e.end;d||(d=k.getMarginBox(c),c=k.getPadBorderExtents(c),d=e.start={left:d.l+c.l,top:d.t+c.t,width:d.w-c.w,height:d.h-c.h});g||(g=e.anchor?e.anchor:{x:d.left,y:d.top},c=e.size,g=e.end={left:d.left-(c.width-d.width)*(g.x-d.left)/d.width,top:d.top-(c.height-d.height)*(g.y-d.top)/d.height,width:c.width,
height:c.height});return f.animateProperty(a.mixin({properties:{left:{start:d.left,end:g.left},top:{start:d.top,end:g.top},width:{start:d.width,end:g.width},height:{start:d.height,end:g.height}}},e))},slideTo:function(e){var c=e.node=l.byId(e.node),d=h.getComputedStyle,g=null,u=null,s=function(){return function(){var a="absolute"==c.style.position?"absolute":"relative";g="absolute"==a?c.offsetTop:parseInt(d(c).top)||0;u="absolute"==a?c.offsetLeft:parseInt(d(c).left)||0;"absolute"!=a&&"relative"!=
a&&(a=k.position(c,!0),g=a.y,u=a.x,c.style.position="absolute",c.style.top=g+"px",c.style.left=u+"px")}}();s();e=f.animateProperty(a.mixin({properties:{top:{start:g,end:e.top||0},left:{start:u,end:e.left||0}}},e));p.connect(e,"beforeBegin",e,s);return e},flash:function(e){e=a.mixin({end:"#f00",duration:500,count:1},e);e.duration/=2*e.count;var c=l.byId(e.node),d=e.start;d||(d=h.getComputedStyle(c).backgroundColor);var g=e.end,u=[],s=e.count,c={node:c,duration:e.duration};for(e=0;e<s;e++)u.push(f.animateProperty(a.mixin({properties:{backgroundColor:{start:d,
end:g}}},c))),u.push(f.animateProperty(a.mixin({properties:{backgroundColor:{start:g,end:d}}},c)));return q.chain(u)}}})},"dojo/fx":function(){define("./_base/lang ./Evented ./_base/kernel ./_base/array ./aspect ./_base/fx ./dom ./dom-style ./dom-geometry ./ready require".split(" "),function(p,f,a,l,k,h,q,m,g,e,c){a.isAsync||e(0,function(){c(["./fx/Toggler"])});a=a.fx={};e={_fire:function(c,a){this[c]&&this[c].apply(this,a||[]);return this}};var d=function(c){this._index=-1;this._animations=c||[];
this._current=this._onAnimateCtx=this._onEndCtx=null;this.duration=0;l.forEach(this._animations,function(c){c&&("undefined"!=typeof c.duration&&(this.duration+=c.duration),c.delay&&(this.duration+=c.delay))},this)};d.prototype=new f;p.extend(d,{_onAnimate:function(){this._fire("onAnimate",arguments)},_onEnd:function(){this._onAnimateCtx.remove();this._onEndCtx.remove();this._onAnimateCtx=this._onEndCtx=null;this._index+1==this._animations.length?this._fire("onEnd"):(this._current=this._animations[++this._index],
this._onAnimateCtx=k.after(this._current,"onAnimate",p.hitch(this,"_onAnimate"),!0),this._onEndCtx=k.after(this._current,"onEnd",p.hitch(this,"_onEnd"),!0),this._current.play(0,!0))},play:function(c,a){this._current||(this._current=this._animations[this._index=0]);if(!a&&"playing"==this._current.status())return this;var d=k.after(this._current,"beforeBegin",p.hitch(this,function(){this._fire("beforeBegin")}),!0),b=k.after(this._current,"onBegin",p.hitch(this,function(b){this._fire("onBegin",arguments)}),
!0),e=k.after(this._current,"onPlay",p.hitch(this,function(c){this._fire("onPlay",arguments);d.remove();b.remove();e.remove()}));this._onAnimateCtx&&this._onAnimateCtx.remove();this._onAnimateCtx=k.after(this._current,"onAnimate",p.hitch(this,"_onAnimate"),!0);this._onEndCtx&&this._onEndCtx.remove();this._onEndCtx=k.after(this._current,"onEnd",p.hitch(this,"_onEnd"),!0);this._current.play.apply(this._current,arguments);return this},pause:function(){if(this._current){var c=k.after(this._current,"onPause",
p.hitch(this,function(a){this._fire("onPause",arguments);c.remove()}),!0);this._current.pause()}return this},gotoPercent:function(c,a){this.pause();var d=this.duration*c;this._current=null;l.some(this._animations,function(b,c){if(d<=b.duration)return this._current=b,this._index=c,!0;d-=b.duration;return!1},this);this._current&&this._current.gotoPercent(d/this._current.duration);a&&this.play();return this},stop:function(c){if(this._current){if(c){for(;this._index+1<this._animations.length;++this._index)this._animations[this._index].stop(!0);
this._current=this._animations[this._index]}var a=k.after(this._current,"onStop",p.hitch(this,function(c){this._fire("onStop",arguments);a.remove()}),!0);this._current.stop()}return this},status:function(){return this._current?this._current.status():"stopped"},destroy:function(){this.stop();this._onAnimateCtx&&this._onAnimateCtx.remove();this._onEndCtx&&this._onEndCtx.remove()}});p.extend(d,e);a.chain=function(c){return new d(p.isArray(c)?c:Array.prototype.slice.call(c,0))};var r=function(c){this._animations=
c||[];this._connects=[];this.duration=this._finished=0;l.forEach(c,function(c){var b=c.duration;c.delay&&(b+=c.delay);this.duration<b&&(this.duration=b);this._connects.push(k.after(c,"onEnd",p.hitch(this,"_onEnd"),!0))},this);this._pseudoAnimation=new h.Animation({curve:[0,1],duration:this.duration});var a=this;l.forEach("beforeBegin onBegin onPlay onAnimate onPause onStop onEnd".split(" "),function(c){a._connects.push(k.after(a._pseudoAnimation,c,function(){a._fire(c,arguments)},!0))})};p.extend(r,
{_doAction:function(c,a){l.forEach(this._animations,function(d){d[c].apply(d,a)});return this},_onEnd:function(){++this._finished>this._animations.length&&this._fire("onEnd")},_call:function(c,a){var d=this._pseudoAnimation;d[c].apply(d,a)},play:function(c,a){this._finished=0;this._doAction("play",arguments);this._call("play",arguments);return this},pause:function(){this._doAction("pause",arguments);this._call("pause",arguments);return this},gotoPercent:function(c,a){var d=this.duration*c;l.forEach(this._animations,
function(b){b.gotoPercent(b.duration<d?1:d/b.duration,a)});this._call("gotoPercent",arguments);return this},stop:function(c){this._doAction("stop",arguments);this._call("stop",arguments);return this},status:function(){return this._pseudoAnimation.status()},destroy:function(){this.stop();l.forEach(this._connects,function(c){c.remove()})}});p.extend(r,e);a.combine=function(c){return new r(p.isArray(c)?c:Array.prototype.slice.call(c,0))};a.wipeIn=function(c){var a=c.node=q.byId(c.node),d=a.style,b;c=
h.animateProperty(p.mixin({properties:{height:{start:function(){b=d.overflow;d.overflow="hidden";if("hidden"==d.visibility||"none"==d.display)return d.height="1px",d.display="",d.visibility="",1;var c=m.get(a,"height");return Math.max(c,1)},end:function(){return a.scrollHeight}}}},c));var e=function(){d.height="auto";d.overflow=b};k.after(c,"onStop",e,!0);k.after(c,"onEnd",e,!0);return c};a.wipeOut=function(c){var a=(c.node=q.byId(c.node)).style,d;c=h.animateProperty(p.mixin({properties:{height:{end:1}}},
c));k.after(c,"beforeBegin",function(){d=a.overflow;a.overflow="hidden";a.display=""},!0);var b=function(){a.overflow=d;a.height="auto";a.display="none"};k.after(c,"onStop",b,!0);k.after(c,"onEnd",b,!0);return c};a.slideTo=function(c){var a=null,d=null,b=function(b){return function(){var c=m.getComputedStyle(b),e=c.position;a="absolute"==e?b.offsetTop:parseInt(c.top)||0;d="absolute"==e?b.offsetLeft:parseInt(c.left)||0;"absolute"!=e&&"relative"!=e&&(c=g.position(b,!0),a=c.y,d=c.x,b.style.position=
"absolute",b.style.top=a+"px",b.style.left=d+"px")}}(c.node=q.byId(c.node));b();c=h.animateProperty(p.mixin({properties:{top:c.top||0,left:c.left||0}},c));k.after(c,"beforeBegin",b,!0);return c};return a})},"esri/tileUtils":function(){define(["dojo/_base/array","dojo/has","./kernel","./geometry/Point","./geometry/Extent"],function(p,f,a,l,k){return{_addFrameInfo:function(a,f){var m,g,e=2*f.origin[1],c=f.origin[0],d=a.origin.x,r=a.width,u;p.forEach(a.lods,function(a){m=Math.round(e/a.resolution);g=
Math.ceil(m/r);u=Math.floor((c-d)/(r*a.resolution));a._frameInfo||(a._frameInfo=[g,u,u+g-1,m])})},getContainingTileCoords:function(a,f,m){var g=a.origin;m=m.resolution;return{row:Math.floor((g.y-f.y)/(a.height*m)),col:Math.floor((f.x-g.x)/(a.width*m))}},getCandidateTileInfo:function(a,f,m){var g;g=a.width;for(var e=a.height,c=m.xmax-m.xmin,d=m.ymax-m.ymin,r=a.__tileInfo===f,u=r?a.getMinZoom():-1,r=r?a.getMaxZoom():-1,s=-1,t=f.lods,b=Math.abs,v,n,w,r=-1<r?r:t.length-1,u=-1<u?u:0;u<=r;u++)if(n=t[u])if(w=
c>d?b(d-e*n.resolution):b(c-g*n.resolution),0>s||w<=s)v=n,s=w;else break;g=v;v=g.resolution;e=(m.xmin+m.xmax)/2;c=(m.ymin+m.ymax)/2;d=a.width/2*v;v*=a.height/2;e=new k(e-d,c-v,e+d,c+v,m.spatialReference);m=new l(e.xmin,e.ymax,m.spatialReference);r=g.resolution;d=f.width;c=f.height;f=f.origin;a=a.__visibleDelta;v=Math.floor;t=d*r;b=c*r;r=v((f.y-m.y)/b);s=v((m.x-f.x)/t);u=f.y-r*b;f=v(Math.abs((m.x-(f.x+s*t))*d/t))+a.x;a=v(Math.abs((m.y-u)*c/b))+a.y;return{tile:{point:m,coords:{row:r,col:s},offsets:{x:f,
y:a}},lod:g,extent:e}},getTileExtent:function(a,f,m,g){var e=a.origin;f=a.lods[f].resolution;var c=a.width,d=a.height;return new k(g*f*c+e.x,e.y-(m+1)*f*d,(g+1)*f*c+e.x,e.y-m*f*d,a.spatialReference)}}})},"esri/geometry/Point":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ../srUtils".split(" "),function(p,f,a,l,k,h,q,m){function g(a,b){89.99999<b?b=89.99999:-89.99999>b&&(b=-89.99999);var d=b*u;return[a*u*c,c/2*Math.log((1+Math.sin(d))/
(1-Math.sin(d)))]}function e(a,b,e){a=a/c*r;if(e)return b=d/2-2*Math.atan(Math.exp(-1*b/c)),[a,b*r];e=a-360*Math.floor((a+180)/360);b=d/2-2*Math.atan(Math.exp(-1*b/c));return[e,b*r]}var c=6378137,d=3.141592653589793,r=57.29577951308232,u=0.017453292519943,s={type:"point",x:0,y:0};p=p(q,{declaredClass:"esri.geometry.Point",constructor:function(c,b,a){f.mixin(this,s);f.isArray(c)?(this.x=c[0],this.y=c[1],this.spatialReference=b):f.isObject(c)?(f.mixin(this,c),k.isDefined(this.latitude)&&(this.y=this.latitude),
k.isDefined(this.longitude)&&(this.x=this.longitude),this.spatialReference&&(this.spatialReference=m.createSpatialReference(this.spatialReference))):(this.x=c,this.y=b,this.spatialReference=a);this.verifySR()},offset:function(c,b){return new this.constructor(this.x+c,this.y+b,this.spatialReference)},setX:function(c){this.x=c;this.clearCache();return this},setY:function(c){this.y=c;this.clearCache();return this},setLongitude:function(c){var b=this.spatialReference;b&&(b._isWebMercator()?this.setX(g(c,
this.y)[0]):4326===b.wkid&&this.setX(c));return this},setLatitude:function(c){var b=this.spatialReference;b&&(b._isWebMercator()?this.setY(g(this.x,c)[1]):4326===b.wkid&&this.setY(c));return this},getLongitude:function(){var c=this.spatialReference,b;c&&(c._isWebMercator()?b=e(this.x,this.y)[0]:4326===c.wkid&&(b=this.x));return b},getLatitude:function(){var c=this.spatialReference,b;c&&(c._isWebMercator()?b=e(this.x,this.y)[1]:4326===c.wkid&&(b=this.y));return b},update:function(c,b){this.x=c;this.y=
b;this.clearCache();return this},normalize:function(){var c=this.x,b=this.spatialReference;if(b){var a=b._getInfo();if(a){var d=a.valid[0],e=a.valid[1],a=2*e;c>e?(d=Math.ceil(Math.abs(c-e)/a),c-=d*a):c<d&&(d=Math.ceil(Math.abs(c-d)/a),c+=d*a)}}return new this.constructor(c,this.y,b)},toJson:function(){var c={x:this.x,y:this.y},b=this.spatialReference;b&&(c.spatialReference=b.toJson());return c}});p.lngLatToXY=g;p.xyToLngLat=e;p.defaultProps=s;return p})},"esri/geometry/Geometry":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","../SpatialReference"],function(p,f,a,l,k){return p(null,{declaredClass:"esri.geometry.Geometry",spatialReference:null,type:null,cache:void 0,setSpatialReference:function(a){this.spatialReference=a;return this},verifySR:function(){this.spatialReference||this.setSpatialReference(new k(4326))},getExtent:function(){return null},clearCache:function(){this.cache=void 0},getCacheValue:function(a){return this.cache&&this.cache[a]},setCacheValue:function(a,f){this.cache||
(this.cache={});this.cache[a]=f}})})},"esri/srUtils":function(){define(["./SpatialReference","./ImageSpatialReference","./kernel","./sniff","dojo/_base/lang"],function(p,f,a,l,k){function h(a){var f=!1;if(a&&(a.ics||a.icsid))f=!0;return f}return{isICS:h,createSpatialReference:function(a){var m=null;a&&(m=h(a)?new f(a):new p(a));return m}}})},"esri/ImageSpatialReference":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./lang ./SpatialReference".split(" "),function(p,f,a,l,k,
h){return p(h,{declaredClass:"esri.ImageSpatialReference",constructor:function(a){a&&(f.isObject(a)&&f.mixin(this,a),this.url||console.error("ImageSpatialReference: must provide image service URL."))},icsid:null,ics:null,_isWebMercator:function(){return!1},_isWrappable:function(){return!1},equals:function(a){var f=!1;a&&(this.icsid&&a.icsid?f=this.icsid===a.icsid:this.ics&&a.ics&&(f=this.ics===a.ics));return f},toJson:function(a){var f=null,g=k.isDefined;a=g(a)?a:!0;g(this.icsid)?f={icsid:this.icsid}:
g(this.ics)&&(f={ics:this.ics});g(this.url)&&(g(f)&&a)&&(f.url=this.url);return f}})})},"esri/geometry/Extent":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./webMercatorUtils ./mathUtils ../srUtils".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d){var r={type:"extent",xmin:0,ymin:0,xmax:0,ymax:0},u=p(m,{declaredClass:"esri.geometry.Extent",constructor:function(c,e,b,g,n){a.mixin(this,r);a.isObject(c)?(a.mixin(this,
c),this.spatialReference&&(this.spatialReference=d.createSpatialReference(this.spatialReference))):this.update(c,e,b,g,n);this.verifySR()},getWidth:function(){return Math.abs(this.xmax-this.xmin)},getHeight:function(){return Math.abs(this.ymax-this.ymin)},getCenter:function(){return new g((this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2,this.spatialReference)},centerAt:function(c){var a=this.getCenter(),b=c.x-a.x;c=c.y-a.y;return new u(this.xmin+b,this.ymin+c,this.xmax+b,this.ymax+c,this.spatialReference)},
update:function(c,a,b,d,e){this.xmin=c;this.ymin=a;this.xmax=b;this.ymax=d;this.spatialReference=e;this.clearCache();return this},offset:function(c,a){return new u(this.xmin+c,this.ymin+a,this.xmax+c,this.ymax+a,this.spatialReference)},expand:function(c){var a=(1-c)/2;c=this.getWidth()*a;a*=this.getHeight();return new u(this.xmin+c,this.ymin+a,this.xmax-c,this.ymax-a,this.spatialReference)},intersects:function(c){if(!c)return!1;var a=c.type,b=this.spatialReference,d=c.spatialReference;b&&(d&&!b.equals(d)&&
b._canProject(d))&&(c=b.isWebMercator()?e.geographicToWebMercator(c):e.webMercatorToGeographic(c,!0));switch(a){case "point":return this.contains(c);case "multipoint":return this._intersectsMultipoint(c);case "extent":return this._intersectsExtent(c);case "polygon":return this._intersectsPolygon(c);case "polyline":return this._intersectsPolyline(c)}},normalize:function(){var c=this._normalize(!1,!0);a.isArray(c)||(c=[c]);return c},shiftCentralMeridian:function(){return this._normalize(!0)},bisect:function(){var c=
this.spatialReference,a=c&&c._getInfo(),b=[],d=0;if(a&&this._isOutOfBounds(a)){var e=this,d=e.xmin,g=e.ymin,r=e.ymax,f=a.valid[0],h=a.valid[1];e.getWidth()>2*h&&(e=e.getCenter(),e=new u(e.x-h,g,e.x+h,r,new q(c.toJson())));var d=e.xmin-d,m=this._normalizeX(e.xmin,a),a=this._normalizeX(e.xmax,a);m.frameId===a.frameId?b.push(new u(m.x,g,a.x,r,new q(c.toJson()))):b.push(new u(m.x,g,h,r,new q(c.toJson())),new u(f,g,a.x,r,new q(c.toJson())))}else b.push(this.getExtent());return{extents:b,marginLeft:d}},
_intersectsMultipoint:function(c){var a=c.points.length,b;for(b=0;b<a;b++)if(this.contains(c.getPoint(b)))return!0;return!1},_intersectsExtent:function(c){var a,b,d,e,g=!1;this.xmin<=c.xmin?(a=c.xmin,this.xmax<a?g=!0:d=Math.min(this.xmax,c.xmax)-a):(a=this.xmin,c.xmax<a?g=!0:d=Math.min(this.xmax,c.xmax)-a);this.ymin<=c.ymin?(b=c.ymin,this.ymax<b?g=!0:e=Math.min(this.ymax,c.ymax)-b):(b=this.ymin,c.ymax<b?g=!0:e=Math.min(this.ymax,c.ymax)-b);return g?null:new u(a,b,a+d,b+e,this.spatialReference)},_intersectsPolygon:function(c){var a=
[this.xmin,this.ymax],b=[this.xmax,this.ymax],d=[this.xmin,this.ymin],e=[this.xmax,this.ymin],r=[a,b,d,e],a=[[d,a],[a,b],[b,e],[e,d]],d=c.rings,e=d.length,f,u=new g(0,0,this.spatialReference);f=r.length;for(b=0;b<f;b++)if(u.update(r[b][0],r[b][1]),c.contains(u))return!0;u.setSpatialReference(c.spatialReference);for(var h,m,b=0;b<e;b++)if(r=d[b],f=r.length){h=r[0];u.update(h[0],h[1]);if(this.contains(u))return!0;for(c=1;c<f;c++){m=r[c];u.update(m[0],m[1]);if(this.contains(u)||this._intersectsLine([h,
m],a))return!0;h=m}}return!1},_intersectsPolyline:function(c){var a=[[[this.xmin,this.ymin],[this.xmin,this.ymax]],[[this.xmin,this.ymax],[this.xmax,this.ymax]],[[this.xmax,this.ymax],[this.xmax,this.ymin]],[[this.xmax,this.ymin],[this.xmin,this.ymin]]],b,d=c.paths,e=d.length,r,f,u,h,m=new g(0,0,c.spatialReference);for(c=0;c<e;c++)if(r=d[c],f=r.length){u=r[0];m.update(u[0],u[1]);if(this.contains(m))return!0;for(b=1;b<f;b++){h=r[b];m.update(h[0],h[1]);if(this.contains(m)||this._intersectsLine([u,h],
a))return!0;u=h}}return!1},_intersectsLine:function(a,d){var b=c._getLineIntersection2,e,n=d.length;for(e=0;e<n;e++)if(b(a,d[e]))return!0;return!1},contains:function(c){if(!c)return!1;var a=c.type;if("point"===a){var b=this.spatialReference,d=c.spatialReference,a=c.x;c=c.y;b&&(d&&!b.equals(d)&&b._canProject(d))&&(c=b.isWebMercator()?g.lngLatToXY(a,c):g.xyToLngLat(a,c,!0),a=c[0],c=c[1]);return a>=this.xmin&&a<=this.xmax&&c>=this.ymin&&c<=this.ymax}return"extent"===a?this._containsExtent(c):!1},_containsExtent:function(c){var a=
c.xmin,b=c.ymin,d=c.xmax,e=c.ymax,r=c.spatialReference;c=new g(a,b,r);a=new g(a,e,r);e=new g(d,e,r);b=new g(d,b,r);return this.contains(c)&&this.contains(a)&&this.contains(e)&&this.contains(b)?!0:!1},union:function(c){return new u(Math.min(this.xmin,c.xmin),Math.min(this.ymin,c.ymin),Math.max(this.xmax,c.xmax),Math.max(this.ymax,c.ymax),this.spatialReference)},getExtent:function(){var c=this.spatialReference;return new u(this.xmin,this.ymin,this.xmax,this.ymax,c&&new q(c.toJson()))},_shiftCM:function(c){var a=
this.getCacheValue("_shifted");if(!a){var a=new u(this.toJson()),b=a.spatialReference;if(c=c||b._getInfo()){var d=this._getCM(c);if(d){var n=b._isWebMercator()?e.webMercatorToGeographic(d):d;a.xmin-=d.x;a.xmax-=d.x;b._isWebMercator()||(n.x=this._normalizeX(n.x,c).x);a.setSpatialReference(new q(h.substitute({Central_Meridian:n.x},4326===b.wkid?c.altTemplate:c.wkTemplate)))}}this.setCacheValue("_shifted",a)}return a},_getCM:function(c){var a;this._isOutOfBounds(c)&&(a=this.getCenter());return a},_isOutOfBounds:function(c){var a=
c.valid[0];c=c.valid[1];var b=this.xmin,d=this.xmax;return!(b>=a&&b<=c&&d>=a&&d<=c)},_normalize:function(c,a,b){var d=new u(this.toJson()),e=d.spatialReference;if(e&&(b=b||e._getInfo())){var g=f.map(this._getParts(b),function(b){return b.extent});return 2<g.length?c?this._shiftCM(b):d.update(b.valid[0],d.ymin,b.valid[1],d.ymax,e):2===g.length?c?this._shiftCM(b):a?g:{rings:f.map(g,function(b){return[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]}),spatialReference:e}:
g[0]||d}return d},_getParts:function(c){var a=this.getCacheValue("_parts");if(!a){var a=[],b=this.xmin,d=this.xmax,e=this.ymin,g=this.ymax,r=this.spatialReference,f=this.getWidth(),h=b,m=d,k=0,q=0,l,p;c=c||r._getInfo();l=c.valid[0];p=c.valid[1];q=this._normalizeX(b,c);b=q.x;k=q.frameId;q=this._normalizeX(d,c);d=q.x;q=q.frameId;c=b===d&&0<f;if(f>2*p){f=new u(h<m?b:d,e,p,g,r);b=new u(l,e,h<m?d:b,g,r);p=new u(0,e,p,g,r);e=new u(l,e,0,g,r);r=[];l=[];f.contains(p)&&r.push(k);f.contains(e)&&l.push(k);b.contains(p)&&
r.push(q);b.contains(e)&&l.push(q);for(g=k+1;g<q;g++)r.push(g),l.push(g);a.push({extent:f,frameIds:[k]},{extent:b,frameIds:[q]},{extent:p,frameIds:r},{extent:e,frameIds:l})}else b>d||c?a.push({extent:new u(b,e,p,g,r),frameIds:[k]},{extent:new u(l,e,d,g,r),frameIds:[q]}):a.push({extent:new u(b,e,d,g,r),frameIds:[k]});this.setCacheValue("_parts",a)}return a},_normalizeX:function(c,a){var b=0,d=a.valid[0],e=a.valid[1],g=2*e;c>e?(b=Math.ceil(Math.abs(c-e)/g),c-=b*g):c<d&&(b=Math.ceil(Math.abs(c-d)/g),
c+=b*g,b=-b);return{x:c,frameId:b}},toJson:function(){var c={xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax},a=this.spatialReference;a&&(c.spatialReference=a.toJson());return c}});u.defaultProps=r;return u})},"esri/geometry/webMercatorUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Point".split(" "),function(p,f,a,l,k,h){function q(a,e,c,d){if("point"===a.type){var r=e(a.x,a.y,d);return new a.constructor(r[0],r[1],new k(c))}if("extent"===
a.type){var r=e(a.xmin,a.ymin,d),f=e(a.xmax,a.ymax,d);return new a.constructor(r[0],r[1],f[0],f[1],new k(c))}if("polyline"===a.type||"polygon"===a.type){var r="polyline"===a.type,s=[],t;p.forEach(r?a.paths:a.rings,function(b){s.push(t=[]);p.forEach(b,function(b){t.push(e(b[0],b[1],d))})});return r?new a.constructor({paths:s,spatialReference:new k(c)}):new a.constructor({rings:s,spatialReference:new k(c)})}if("multipoint"===a.type){var b=[];p.forEach(a.points,function(c){b.push(e(c[0],c[1],d))});return new a.constructor({points:b,
spatialReference:new k(c)})}}function m(a,e){var c=a&&(null!=a.wkid?a:a.spatialReference),d=e&&(null!=e.wkid?e:e.spatialReference);return!c||!d?!1:d.equals(c)?!0:d._canProject(c)}return{canProject:m,project:function(a,e){var c=a&&a.spatialReference,d=e&&(null!=e.wkid?e:e.spatialReference);c&&d?c.equals(d)?a=new a.constructor(a.toJson()):m(c,d)?d.isWebMercator()?a=q(a,h.lngLatToXY,{wkid:102100}):4326===d.wkid&&(a=q(a,h.xyToLngLat,{wkid:4326})):a=null:a=null;return a},lngLatToXY:h.lngLatToXY,xyToLngLat:h.xyToLngLat,
geographicToWebMercator:function(a){return q(a,h.lngLatToXY,{wkid:102100})},webMercatorToGeographic:function(a,e){return q(a,h.xyToLngLat,{wkid:4326},e)}}})},"esri/geometry/mathUtils":function(){define(["dojo/_base/lang","dojo/has","../kernel","./Point"],function(p,f,a,l){function k(a,g,e){return a instanceof l?new l(a.x+e*(g.x-a.x),a.y+e*(g.y-a.y)):[a[0]+e*(g[0]-a[0]),a[1]+e*(g[1]-a[1])]}function h(a,g){return 1E-8>Math.abs(a-g)}function q(a,g,e,c){var d,r=h(a[0],g[0])?1E10:(a[1]-g[1])/(a[0]-g[0]),
f=h(e[0],c[0])?1E10:(e[1]-c[1])/(e[0]-c[0]),s=a[1]-r*a[0],t=e[1]-f*e[0];if(h(r,f)){if(h(s,t)){if(h(a[0],g[0]))if(Math.min(a[1],g[1])<Math.max(e[1],c[1])||Math.max(a[1],g[1])>Math.min(e[1],c[1]))a=(a[1]+g[1]+e[1]+c[1]-Math.min(a[1],g[1],e[1],c[1])-Math.max(a[1],g[1],e[1],c[1]))/2,d=(a-s)/r;else return null;else if(Math.min(a[0],g[0])<Math.max(e[0],c[0])||Math.max(a[0],g[0])>Math.min(e[0],c[0]))d=(a[0]+g[0]+e[0]+c[0]-Math.min(a[0],g[0],e[0],c[0])-Math.max(a[0],g[0],e[0],c[0]))/2,a=r*d+s;else return null;
return[d,a]}return null}h(r,1E10)?(d=a[0],a=f*d+t):h(f,1E10)?(d=e[0],a=r*d+s):(d=-(s-t)/(r-f),a=a[1]===g[1]?a[1]:e[1]===c[1]?e[1]:r*d+s);return[d,a]}return{getLength:function(a,g){var e=g.x-a.x,c=g.y-a.y;return Math.sqrt(e*e+c*c)},_getLength:function(a,g){var e=g[0]-a[0],c=g[1]-a[1];return Math.sqrt(e*e+c*c)},getPointOnLine:k,getMidpoint:function(a,g){return k(a,g,0.5)},_equals:h,_getLineIntersection:q,getLineIntersection:function(a,g,e,c,d){(a=q([a.x,a.y],[g.x,g.y],[e.x,e.y],[c.x,c.y]))&&(a=new l(a[0],
a[1],d));return a},_getLineIntersection2:function(a,g){var e=a[0],c=a[1],d=g[0],r=g[1],f=e[0],e=e[1],s=c[0],c=c[1],t=d[0],b=d[1],d=r[0]-t,t=f-t,v=s-f,r=r[1]-b,b=e-b,n=c-e,w=r*v-d*n;if(0===w)return!1;d=(d*b-r*t)/w;t=(v*b-n*t)/w;return 0<=d&&1>=d&&0<=t&&1>=t?[f+d*(s-f),e+d*(c-e)]:!1},_pointLineDistance:function(a,g){var e=g[0],c=g[1],d=e[0],r=e[1],e=a[0],f=a[1],s=c[0]-d,t=c[1]-r,b=e-d,v=f-r,c=Math.sqrt,n=Math.pow,w=c(n(s,2)+n(t,2)),b=(b*s+v*t)/(w*w),r=r+b*t;return c(n(e-(d+b*s),2)+n(f-r,2))}}})},"esri/PluginTarget":function(){define("require dojo/aspect dojo/_base/array dojo/_base/lang dojo/Deferred dojo/when".split(" "),
function(p,f,a,l,k,h){function q(){f.after(this.constructor._meta,"ctor",this._pluginsHandler,!0);this._plugins={}}q.prototype={addPlugin:function(a,g){var e=this,c=this._plugins,d=new k;try{p([a],function(r){a in c?d.resolve({id:c[a].declaredId||a.replace(/\//g,".")}):(c[a]=r,h(r.add(e,g),function(){var c={id:r.declaredId||a.replace(/\//g,".")};e.emit("plugin-add",c);d.resolve(c)},function(c){d.reject(c)}))})}catch(r){d.reject(r)}return d.promise},removePlugin:function(a){if(a in this._plugins){var g=
this._plugins[a];g.remove(this);delete this._plugins[a];this.emit("plugin-remove",{id:g.declaredId||a.replace(/\//g,".")})}},_pluginsHandler:function(){var f=this;a.some(arguments,function(a){if(a&&a.plugins&&a.plugins instanceof Array){a=a.plugins;var e,c,d;for(d=0;d<a.length;d++)e=a[d],c=e instanceof Object?e.id:e,f.addPlugin(c,e.options);return!0}})}};return q})},"esri/geometry/ScreenPoint":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Point"],function(p,f,
a,l,k){return p(k,{declaredClass:"esri.geometry.ScreenPoint",verifySR:function(){}})})},"esri/geometry/Rect":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(p,f,a,l,k,h,q,m,g,e){var c=p(q,{declaredClass:"esri.geometry.Rect",constructor:function(c,a,g,s,t){f.mixin(this,l.defaultRect);f.isObject(c)&&"extent"===c.type&&(a=c.ymax,g=c.getWidth(),s=c.getHeight(),t=c.spatialReference,
c=c.xmin);f.isObject(c)?(f.mixin(this,c),this.spatialReference&&(this.spatialReference=e.createSpatialReference(this.spatialReference))):(this.x=c,this.y=a,this.width=g,this.height=s,this.spatialReference=t);this.verifySR()},getCenter:function(){return new m(this.x+this.width/2,this.y+this.height/2,this.spatialReference)},offset:function(a,e){return new c(this.x+a,this.y+e,this.width,this.height,this.spatialReference)},intersects:function(c){return c.x+c.width<=this.x||c.y+c.height<=this.y||c.y>=
this.y+this.height||c.x>=this.x+this.width?!1:!0},getExtent:function(){return new g(parseFloat(this.x),parseFloat(this.y)-parseFloat(this.height),parseFloat(this.x)+parseFloat(this.width),parseFloat(this.y),this.spatialReference)},update:function(c,a,e,g,f){this.x=c;this.y=a;this.width=e;this.height=g;this.spatialReference=f;this.clearCache();return this}});return c})},"esri/geometry/scaleUtils":function(){define("dojo/_base/lang dojo/has ../kernel ../config ../lang ../WKIDUnitConversion".split(" "),
function(p,f,a,l,k,h){var q=6370997*Math.PI/180,m=l.defaults,g={getUnitValueForSR:function(a){return this.getUnitValue(a)||q},getUnitValue:function(a){var c,d,g;a&&("object"===typeof a?(c=a.wkid,d=a.wkt):"number"===typeof a?c=a:"string"===typeof a&&(d=a));c?g=h.values[h[c]]:d&&-1!==d.search(/^PROJCS/i)&&(a=/UNIT\[([^\]]+)\]\]$/i.exec(d))&&a[1]&&(g=parseFloat(a[1].split(",")[1]));return g},getScale:function(a,c,d){var r,f,s;1<arguments.length&&k.isDefined(c)&&!c.declaredClass?(r=a,f=c,c=null,s=g.getUnitValue(d)):
(r=c||a.extent,f=a.width,s=g.getUnitValue(r&&r.spatialReference));return r&&f?39.37*(r.getWidth()/f*(s||q))*m.screenDPI:0},getExtentForScale:function(a,c,d){d=d||a.extent;var r;r=g.getUnitValue(a.spatialReference);return d.expand(c*a.width/(39.37*(r||q)*m.screenDPI)/d.getWidth())}};return g})},"esri/WKIDUnitConversion":function(){define(["dojo/has","./kernel"],function(p,f){var a,l={values:[1,0.3048,0.3048006096012192,0.3047972654,0.9143917962,0.201166195164,0.9143984146160287,0.3047994715386762,
20.11676512155263,20.11678249437587,0.9143985307444408,0.91439523,0.3047997101815088,20.116756,5E4,15E4],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,
3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,
3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,
3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,
5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,
6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,
6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,
6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,
6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,
6923:2,6924:0,6925:2,6984:0,6991:0,7131:0,7132:2,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,
7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,
22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25E3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,30340:0,
30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53034:0,53048:0,53049:0,54034:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,
102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,
103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,
103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,
103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103695:2};for(a=2E3;2045>=a;a++)l[a]=0;for(a=2056;2065>=a;a++)l[a]=0;for(a=2067;2135>=a;a++)l[a]=0;for(a=
2137;2154>=a;a++)l[a]=0;for(a=2161;2170>=a;a++)l[a]=0;for(a=2172;2193>=a;a++)l[a]=0;for(a=2195;2198>=a;a++)l[a]=0;for(a=2200;2203>=a;a++)l[a]=0;for(a=2205;2217>=a;a++)l[a]=0;for(a=2222;2224>=a;a++)l[a]=1;for(a=2225;2250>=a;a++)l[a]=2;for(a=2251;2253>=a;a++)l[a]=1;for(a=2257;2264>=a;a++)l[a]=2;for(a=2274;2279>=a;a++)l[a]=2;for(a=2280;2282>=a;a++)l[a]=1;for(a=2283;2289>=a;a++)l[a]=2;for(a=2290;2292>=a;a++)l[a]=0;for(a=2308;2313>=a;a++)l[a]=0;for(a=2315;2491>=a;a++)l[a]=0;for(a=2494;2866>=a;a++)l[a]=
0;for(a=2867;2869>=a;a++)l[a]=1;for(a=2870;2888>=a;a++)l[a]=2;for(a=2891;2895>=a;a++)l[a]=2;for(a=2896;2898>=a;a++)l[a]=1;for(a=2902;2908>=a;a++)l[a]=2;for(a=2915;2920>=a;a++)l[a]=2;for(a=2921;2923>=a;a++)l[a]=1;for(a=2924;2930>=a;a++)l[a]=2;for(a=2931;2962>=a;a++)l[a]=0;for(a=2964;2968>=a;a++)l[a]=2;for(a=2969;2973>=a;a++)l[a]=0;for(a=2975;2991>=a;a++)l[a]=0;for(a=2995;3051>=a;a++)l[a]=0;for(a=3054;3079>=a;a++)l[a]=0;for(a=3081;3088>=a;a++)l[a]=0;for(a=3092;3101>=a;a++)l[a]=0;for(a=3106;3138>=a;a++)l[a]=
0;for(a=3146;3151>=a;a++)l[a]=0;for(a=3153;3166>=a;a++)l[a]=0;for(a=3168;3172>=a;a++)l[a]=0;for(a=3174;3203>=a;a++)l[a]=0;for(a=3294;3358>=a;a++)l[a]=0;for(a=3367;3403>=a;a++)l[a]=0;for(a=3408;3416>=a;a++)l[a]=0;for(a=3417;3438>=a;a++)l[a]=2;for(a=3441;3446>=a;a++)l[a]=2;for(a=3447;3450>=a;a++)l[a]=0;for(a=3451;3459>=a;a++)l[a]=2;for(a=3460;3478>=a;a++)l[a]=0;for(a=3554;3559>=a;a++)l[a]=0;for(a=3560;3570>=a;a++)l[a]=2;for(a=3571;3581>=a;a++)l[a]=0;for(a=3594;3597>=a;a++)l[a]=0;for(a=3601;3604>=a;a++)l[a]=
0;for(a=3637;3639>=a;a++)l[a]=0;for(a=3665;3667>=a;a++)l[a]=0;for(a=3693;3695>=a;a++)l[a]=0;for(a=3701;3727>=a;a++)l[a]=0;for(a=3728;3739>=a;a++)l[a]=2;for(a=3740;3751>=a;a++)l[a]=0;for(a=3753;3760>=a;a++)l[a]=2;for(a=3761;3773>=a;a++)l[a]=0;for(a=3775;3777>=a;a++)l[a]=0;for(a=3779;3781>=a;a++)l[a]=0;for(a=3783;3785>=a;a++)l[a]=0;for(a=3788;3791>=a;a++)l[a]=0;for(a=3797;3802>=a;a++)l[a]=0;for(a=3814;3816>=a;a++)l[a]=0;for(a=3825;3829>=a;a++)l[a]=0;for(a=3832;3841>=a;a++)l[a]=0;for(a=3844;3852>=a;a++)l[a]=
0;for(a=3873;3885>=a;a++)l[a]=0;for(a=3890;3893>=a;a++)l[a]=0;for(a=3907;3912>=a;a++)l[a]=0;for(a=3942;3950>=a;a++)l[a]=0;for(a=3968;3970>=a;a++)l[a]=0;for(a=3973;3976>=a;a++)l[a]=0;for(a=3986;3989>=a;a++)l[a]=0;for(a=3994;3997>=a;a++)l[a]=0;for(a=4048;4051>=a;a++)l[a]=0;for(a=4056;4063>=a;a++)l[a]=0;for(a=4093;4096>=a;a++)l[a]=0;for(a=4390;4398>=a;a++)l[a]=0;for(a=4399;4413>=a;a++)l[a]=2;for(a=4418;4433>=a;a++)l[a]=2;for(a=4455;4457>=a;a++)l[a]=2;for(a=4484;4489>=a;a++)l[a]=0;for(a=4491;4554>=a;a++)l[a]=
0;for(a=4568;4589>=a;a++)l[a]=0;for(a=4652;4656>=a;a++)l[a]=0;for(a=4766;4800>=a;a++)l[a]=0;for(a=5014;5016>=a;a++)l[a]=0;for(a=5069;5072>=a;a++)l[a]=0;for(a=5105;5130>=a;a++)l[a]=0;for(a=5173;5188>=a;a++)l[a]=0;for(a=5253;5259>=a;a++)l[a]=0;for(a=5269;5275>=a;a++)l[a]=0;for(a=5292;5311>=a;a++)l[a]=0;for(a=5329;5331>=a;a++)l[a]=0;for(a=5343;5349>=a;a++)l[a]=0;for(a=5355;5357>=a;a++)l[a]=0;for(a=5387;5389>=a;a++)l[a]=0;for(a=5459;5463>=a;a++)l[a]=0;for(a=5479;5482>=a;a++)l[a]=0;for(a=5518;5520>=a;a++)l[a]=
0;for(a=5530;5539>=a;a++)l[a]=0;for(a=5550;5552>=a;a++)l[a]=0;for(a=5562;5583>=a;a++)l[a]=0;for(a=5623;5625>=a;a++)l[a]=2;for(a=5631;5639>=a;a++)l[a]=0;for(a=5649;5653>=a;a++)l[a]=0;for(a=5663;5680>=a;a++)l[a]=0;for(a=5682;5685>=a;a++)l[a]=0;for(a=5875;5877>=a;a++)l[a]=0;for(a=5921;5940>=a;a++)l[a]=0;for(a=6050;6125>=a;a++)l[a]=0;for(a=6244;6275>=a;a++)l[a]=0;for(a=6328;6348>=a;a++)l[a]=0;for(a=6350;6356>=a;a++)l[a]=0;for(a=6366;6372>=a;a++)l[a]=0;for(a=6381;6387>=a;a++)l[a]=0;for(a=6393;6404>=a;a++)l[a]=
0;for(a=6480;6483>=a;a++)l[a]=0;for(a=6511;6514>=a;a++)l[a]=0;for(a=6579;6581>=a;a++)l[a]=0;for(a=6619;6624>=a;a++)l[a]=0;for(a=6625;6627>=a;a++)l[a]=2;for(a=6628;6632>=a;a++)l[a]=0;for(a=6634;6637>=a;a++)l[a]=0;for(a=6669;6692>=a;a++)l[a]=0;for(a=6707;6709>=a;a++)l[a]=0;for(a=6720;6723>=a;a++)l[a]=0;for(a=6732;6738>=a;a++)l[a]=0;for(a=6931;6933>=a;a++)l[a]=0;for(a=7374;7376>=a;a++)l[a]=0;for(a=7528;7586>=a;a++)l[a]=0;for(a=7587;7645>=a;a++)l[a]=2;for(a=20002;20032>=a;a++)l[a]=0;for(a=20062;20092>=
a;a++)l[a]=0;for(a=20135;20138>=a;a++)l[a]=0;for(a=20248;20258>=a;a++)l[a]=0;for(a=20348;20358>=a;a++)l[a]=0;for(a=20436;20440>=a;a++)l[a]=0;for(a=20822;20824>=a;a++)l[a]=0;for(a=20934;20936>=a;a++)l[a]=0;for(a=21035;21037>=a;a++)l[a]=0;for(a=21095;21097>=a;a++)l[a]=0;for(a=21148;21150>=a;a++)l[a]=0;for(a=21413;21423>=a;a++)l[a]=0;for(a=21473;21483>=a;a++)l[a]=0;for(a=21780;21782>=a;a++)l[a]=0;for(a=21891;21894>=a;a++)l[a]=0;for(a=21896;21899>=a;a++)l[a]=0;for(a=22171;22177>=a;a++)l[a]=0;for(a=22181;22187>=
a;a++)l[a]=0;for(a=22191;22197>=a;a++)l[a]=0;for(a=22234;22236>=a;a++)l[a]=0;for(a=22521;22525>=a;a++)l[a]=0;for(a=22991;22994>=a;a++)l[a]=0;for(a=23028;23038>=a;a++)l[a]=0;for(a=23830;23853>=a;a++)l[a]=0;for(a=23866;23872>=a;a++)l[a]=0;for(a=23877;23884>=a;a++)l[a]=0;for(a=23886;23894>=a;a++)l[a]=0;for(a=23946;23948>=a;a++)l[a]=0;for(a=24311;24313>=a;a++)l[a]=0;for(a=24342;24347>=a;a++)l[a]=0;for(a=24370;24374>=a;a++)l[a]=10;for(a=24375;24381>=a;a++)l[a]=0;for(a=24718;24721>=a;a++)l[a]=0;for(a=24817;24821>=
a;a++)l[a]=0;for(a=24877;24882>=a;a++)l[a]=0;for(a=24891;24893>=a;a++)l[a]=0;for(a=25391;25395>=a;a++)l[a]=0;for(a=25828;25838>=a;a++)l[a]=0;for(a=26191;26195>=a;a++)l[a]=0;for(a=26391;26393>=a;a++)l[a]=0;for(a=26701;26722>=a;a++)l[a]=0;for(a=26729;26799>=a;a++)l[a]=2;for(a=26801;26803>=a;a++)l[a]=2;for(a=26811;26813>=a;a++)l[a]=2;for(a=26847;26870>=a;a++)l[a]=2;for(a=26891;26899>=a;a++)l[a]=0;for(a=26901;26923>=a;a++)l[a]=0;for(a=26929;26946>=a;a++)l[a]=0;for(a=26948;26998>=a;a++)l[a]=0;for(a=27037;27040>=
a;a++)l[a]=0;for(a=27205;27232>=a;a++)l[a]=0;for(a=27258;27260>=a;a++)l[a]=0;for(a=27391;27398>=a;a++)l[a]=0;for(a=27561;27564>=a;a++)l[a]=0;for(a=27571;27574>=a;a++)l[a]=0;for(a=27581;27584>=a;a++)l[a]=0;for(a=27591;27594>=a;a++)l[a]=0;for(a=28191;28193>=a;a++)l[a]=0;for(a=28348;28358>=a;a++)l[a]=0;for(a=28402;28432>=a;a++)l[a]=0;for(a=28462;28492>=a;a++)l[a]=0;for(a=29118;29122>=a;a++)l[a]=0;for(a=29168;29172>=a;a++)l[a]=0;for(a=29177;29185>=a;a++)l[a]=0;for(a=29187;29195>=a;a++)l[a]=0;for(a=29900;29903>=
a;a++)l[a]=0;for(a=30161;30179>=a;a++)l[a]=0;for(a=30491;30494>=a;a++)l[a]=0;for(a=30729;30732>=a;a++)l[a]=0;for(a=31251;31259>=a;a++)l[a]=0;for(a=31265;31268>=a;a++)l[a]=0;for(a=31275;31279>=a;a++)l[a]=0;for(a=31281;31297>=a;a++)l[a]=0;for(a=31461;31469>=a;a++)l[a]=0;for(a=31491;31495>=a;a++)l[a]=0;for(a=31917;31922>=a;a++)l[a]=0;for(a=31965;32E3>=a;a++)l[a]=0;for(a=32001;32003>=a;a++)l[a]=2;for(a=32005;32031>=a;a++)l[a]=2;for(a=32033;32060>=a;a++)l[a]=2;for(a=32064;32067>=a;a++)l[a]=2;for(a=32074;32077>=
a;a++)l[a]=2;for(a=32081;32086>=a;a++)l[a]=0;for(a=32107;32130>=a;a++)l[a]=0;for(a=32133;32158>=a;a++)l[a]=0;for(a=32164;32167>=a;a++)l[a]=2;for(a=32180;32199>=a;a++)l[a]=0;for(a=32201;32260>=a;a++)l[a]=0;for(a=32301;32360>=a;a++)l[a]=0;for(a=32601;32662>=a;a++)l[a]=0;for(a=32664;32667>=a;a++)l[a]=2;for(a=32701;32761>=a;a++)l[a]=0;for(a=53001;53004>=a;a++)l[a]=0;for(a=53008;53019>=a;a++)l[a]=0;for(a=53021;53032>=a;a++)l[a]=0;for(a=53042;53046>=a;a++)l[a]=0;for(a=53074;53080>=a;a++)l[a]=0;for(a=54001;54004>=
a;a++)l[a]=0;for(a=54008;54019>=a;a++)l[a]=0;for(a=54021;54032>=a;a++)l[a]=0;for(a=54042;54046>=a;a++)l[a]=0;for(a=54048;54053>=a;a++)l[a]=0;for(a=54074;54080>=a;a++)l[a]=0;for(a=102001;102040>=a;a++)l[a]=0;for(a=102042;102063>=a;a++)l[a]=0;for(a=102065;102067>=a;a++)l[a]=0;for(a=102070;102117>=a;a++)l[a]=0;for(a=102122;102216>=a;a++)l[a]=0;for(a=102221;102377>=a;a++)l[a]=0;for(a=102382;102388>=a;a++)l[a]=0;for(a=102389;102398>=a;a++)l[a]=2;for(a=102400;102444>=a;a++)l[a]=0;for(a=102445;102447>=a;a++)l[a]=
2;for(a=102448;102458>=a;a++)l[a]=0;for(a=102459;102468>=a;a++)l[a]=2;for(a=102469;102496>=a;a++)l[a]=0;for(a=102500;102519>=a;a++)l[a]=1;for(a=102520;102524>=a;a++)l[a]=0;for(a=102525;102529>=a;a++)l[a]=2;for(a=102530;102561>=a;a++)l[a]=0;for(a=102570;102588>=a;a++)l[a]=0;for(a=102590;102598>=a;a++)l[a]=0;for(a=102601;102603>=a;a++)l[a]=0;for(a=102605;102628>=a;a++)l[a]=0;for(a=102629;102646>=a;a++)l[a]=2;for(a=102648;102700>=a;a++)l[a]=2;for(a=102701;102703>=a;a++)l[a]=0;for(a=102707;102730>=a;a++)l[a]=
2;for(a=102733;102758>=a;a++)l[a]=2;for(a=102767;102798>=a;a++)l[a]=0;for(a=102965;102969>=a;a++)l[a]=0;for(a=102971;102973>=a;a++)l[a]=0;for(a=102975;102989>=a;a++)l[a]=0;for(a=102990;102992>=a;a++)l[a]=1;for(a=102997;103002>=a;a++)l[a]=0;for(a=103003;103008>=a;a++)l[a]=2;for(a=103009;103011>=a;a++)l[a]=0;for(a=103012;103014>=a;a++)l[a]=2;for(a=103019;103021>=a;a++)l[a]=0;for(a=103022;103024>=a;a++)l[a]=2;for(a=103029;103031>=a;a++)l[a]=0;for(a=103032;103034>=a;a++)l[a]=2;for(a=103065;103068>=a;a++)l[a]=
0;for(a=103074;103076>=a;a++)l[a]=0;for(a=103077;103079>=a;a++)l[a]=1;for(a=103080;103082>=a;a++)l[a]=0;for(a=103083;103085>=a;a++)l[a]=2;for(a=103090;103093>=a;a++)l[a]=0;for(a=103097;103099>=a;a++)l[a]=0;for(a=103100;103102>=a;a++)l[a]=2;for(a=103107;103109>=a;a++)l[a]=0;for(a=103110;103112>=a;a++)l[a]=2;for(a=103113;103116>=a;a++)l[a]=0;for(a=103117;103120>=a;a++)l[a]=2;for(a=103153;103157>=a;a++)l[a]=0;for(a=103158;103162>=a;a++)l[a]=2;for(a=103163;103165>=a;a++)l[a]=0;for(a=103166;103168>=a;a++)l[a]=
1;for(a=103169;103171>=a;a++)l[a]=2;for(a=103186;103188>=a;a++)l[a]=0;for(a=103189;103191>=a;a++)l[a]=2;for(a=103192;103195>=a;a++)l[a]=0;for(a=103196;103199>=a;a++)l[a]=2;for(a=103200;103224>=a;a++)l[a]=0;for(a=103225;103227>=a;a++)l[a]=1;for(a=103232;103237>=a;a++)l[a]=0;for(a=103238;103243>=a;a++)l[a]=2;for(a=103244;103246>=a;a++)l[a]=0;for(a=103247;103249>=a;a++)l[a]=2;for(a=103254;103256>=a;a++)l[a]=0;for(a=103257;103259>=a;a++)l[a]=2;for(a=103264;103266>=a;a++)l[a]=0;for(a=103267;103269>=a;a++)l[a]=
2;for(a=103300;103375>=a;a++)l[a]=0;for(a=103381;103383>=a;a++)l[a]=0;for(a=103384;103386>=a;a++)l[a]=1;for(a=103387;103389>=a;a++)l[a]=0;for(a=103390;103392>=a;a++)l[a]=2;for(a=103397;103399>=a;a++)l[a]=0;for(a=103400;103471>=a;a++)l[a]=2;for(a=103476;103478>=a;a++)l[a]=0;for(a=103479;103481>=a;a++)l[a]=2;for(a=103486;103488>=a;a++)l[a]=0;for(a=103489;103491>=a;a++)l[a]=2;for(a=103492;103495>=a;a++)l[a]=0;for(a=103496;103499>=a;a++)l[a]=2;for(a=103528;103543>=a;a++)l[a]=0;for(a=103544;103548>=a;a++)l[a]=
2;for(a=103549;103551>=a;a++)l[a]=0;for(a=103552;103554>=a;a++)l[a]=1;for(a=103555;103557>=a;a++)l[a]=2;for(a=103558;103560>=a;a++)l[a]=0;for(a=103571;103573>=a;a++)l[a]=0;for(a=103574;103576>=a;a++)l[a]=2;for(a=103577;103580>=a;a++)l[a]=0;for(a=103581;103583>=a;a++)l[a]=2;for(a=103600;103694>=a;a++)l[a]=0;for(a=103700;103793>=a;a++)l[a]=2;for(a=103794;103871>=a;a++)l[a]=0;for(a=103900;103971>=a;a++)l[a]=2;return l})},"esri/geometry/screenUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/sniff ../kernel ./Point ./ScreenPoint ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),
function(p,f,a,l,k,h,q,m,g,e){var c=function(){return 9>a("ie")?function(c,a,e,g,f,b,v,n,w){var h=[],k=Math.round,m,q=v.length,l,p,E,H,I,M;for(m=0;m<q;m++)if(l=v[m],H=n?n(l[0][0],l[0][1],w):l[0],1<(E=l.length)){I=k((H[0]-c)*e+f);M=k((a-H[1])*g+b);H=n?n(l[1][0],l[1][1],w):l[1];p=k((H[0]-c)*e+f);H=k((a-H[1])*g+b);h.push("M",I+","+M,"L",p+","+H);for(p=2;p<E;p++)H=n?n(l[p][0],l[p][1],w):l[p],I=k((H[0]-c)*e+f),M=k((a-H[1])*g+b),h.push(I+","+M)}else I=k((H[0]-c)*e+f),M=k((a-H[1])*g+b),h.push("M",I+","+
M);return h}:function(c,a,e,g,f,b,v,n,h){var k=[],m,q,l,p,F,E,H=Math.round;m=0;for(l=v?v.length:0;m<l;m++){F=v[m];k.push("M");q=0;for(p=F?F.length:0;q<p;q++)E=n?n(F[q][0],F[q][1],h):F[q],k.push(H((E[0]-c)*e+f)+","+H((a-E[1])*g+b))}return k}}();return{toScreenPoint:function(c,a,e,g,f){var b=c.spatialReference,v=g.spatialReference,n=g.x;g=g.y;b&&(v&&!b.equals(v)&&b._canProject(v))&&(b=b.isWebMercator()?k.lngLatToXY(n,g):k.xyToLngLat(n,g,!0),n=b[0],g=b[1]);n=(n-c.xmin)*(a/c.getWidth());g=(c.ymax-g)*
(e/c.getHeight());f||(n=Math.round(n),g=Math.round(g));return new h(n,g)},toScreenGeometry:function(c,a,f,s){var t=c.xmin,b=c.ymax,v=a/c.getWidth(),n=f/c.getHeight(),h=p.forEach,l=Math.round;if(s instanceof k)return new k(l((s.x-t)*v),l((b-s.y)*n));if(s instanceof g){c=new g;var z=c.points;h(s.points,function(c,a){z[a]=[l((c[0]-t)*v),l((b-c[1])*n)]});return c}if(s instanceof e)return new e(l((s.xmin-t)*v),l((b-s.ymin)*n),l((s.xmax-t)*v),l((b-s.ymax)*v));if(s instanceof q){c=new q;var y=c.paths,A;
h(s.paths,function(c,a){A=y[a]=[];h(c,function(c,a){A[a]=[l((c[0]-t)*v),l((b-c[1])*n)]})});return c}if(s instanceof m){c=new m;var B=c.rings,F;h(s.rings,function(c,a){F=B[a]=[];h(c,function(c,a){F[a]=[l((c[0]-t)*v),l((b-c[1])*n)]})});return c}},_toScreenPath:function(a,e,g,s,f,b){var v=s instanceof q,n=a.spatialReference,h=s.spatialReference,m,z;n&&(h&&!n.equals(h)&&n._canProject(h))&&(n.isWebMercator()?m=k.lngLatToXY:(m=k.xyToLngLat,z=!0));return c(a.xmin,a.ymax,e/a.getWidth(),g/a.getHeight(),f,
b,v?s.paths:s.rings,m,z)},toMapPoint:function(c,a,e,g){return new k(c.xmin+g.x/(a/c.getWidth()),c.ymax-g.y/(e/c.getHeight()),c.spatialReference)},toMapGeometry:function(c,a,f,s){var t=c.xmin,b=c.ymax,v=c.spatialReference,n=a/c.getWidth(),h=f/c.getHeight(),l=p.forEach;if(s instanceof k)return new k(t+s.x/n,b-s.y/h,v);if(s instanceof g){c=new g(v);var z=c.points;l(s.points,function(c,a){z[a]=[t+c[0]/n,b-c[1]/h]});return c}if(s instanceof e)return new e(t+s.xmin/n,b-s.ymin/h,t+s.xmax/n,b-s.ymax/h,v);
if(s instanceof q){c=new q(v);var y=c.paths,A;l(s.paths,function(c,a){A=y[a]=[];l(c,function(c,a){A[a]=[t+c[0]/n,b-c[1]/h]})});return c}if(s instanceof m){c=new m(v);var B=c.rings,F;l(s.rings,function(c,a){F=B[a]=[];l(c,function(c,a){F[a]=[t+c[0]/n,b-c[1]/h]})});return c}}}})},"esri/geometry/Polyline":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(p,f,a,l,k,h,q,m,g,e,
c){var d={type:"polyline",paths:null};p=p(m,{declaredClass:"esri.geometry.Polyline",constructor:function(e){a.mixin(this,d);this.paths=[];this._path=0;e&&(a.isArray(e)?this.paths=a.isArray(e[0][0])?e:[e]:e.paths?a.mixin(this,e):this.spatialReference=e,this.spatialReference&&(this.spatialReference=c.createSpatialReference(this.spatialReference)));this.verifySR()},addPath:function(c){this.clearCache();this._path=this.paths.length;this.paths[this._path]=[];a.isArray(c[0])?f.forEach(c,this._addPointArr,
this):f.forEach(c,this._addPoint,this);return this},_addPointArr:function(c){this.paths[this._path].push(c)},_addPoint:function(c){this.paths[this._path].push([c.x,c.y])},_insertPoints:function(c,a){this.clearCache();this._path=a;this.paths[this._path]||(this.paths[this._path]=[]);f.forEach(c,this._addPoint,this)},_validateInputs:function(c,a){return null!==c&&void 0!==c&&(0>c||c>=this.paths.length)||null!==a&&void 0!==c&&(0>a||a>=this.paths[c].length)?!1:!0},getPoint:function(c,a){if(this._validateInputs(c,
a))return new g(this.paths[c][a],this.spatialReference)},setPoint:function(c,a,d){if(this._validateInputs(c,a))return this.clearCache(),this.paths[c][a]=[d.x,d.y],this},insertPoint:function(c,a,d){if(this._validateInputs(c)&&h.isDefined(a)&&0<=a&&a<=this.paths[c].length)return this.clearCache(),this.paths[c].splice(a,0,[d.x,d.y]),this},removePath:function(c){if(this._validateInputs(c,null)){this.clearCache();c=this.paths.splice(c,1)[0];var a,d=c.length,e=this.spatialReference;for(a=0;a<d;a++)c[a]=
new g(c[a],e);return c}},removePoint:function(c,a){if(this._validateInputs(c,a))return this.clearCache(),new g(this.paths[c].splice(a,1)[0],this.spatialReference)},getExtent:function(){var c;c=this.getCacheValue("_extent");var a=this.getCacheValue("_partwise");if(c)return c=new e(c),c._partwise=a,c;c=this.paths;var d=c.length;if(d&&c[0].length){var g,b,f,n,h,k,m,q,l=n=c[0][0][0],p=h=c[0][0][1],F=Math.min,E=Math.max,H=this.spatialReference,a=[],I,M,Q,K;for(k=0;k<d;k++){g=c[k];I=M=g[0]&&g[0][0];Q=K=
g[0]&&g[0][1];q=g.length;for(m=0;m<q;m++)b=g[m],f=b[0],b=b[1],l=F(l,f),p=F(p,b),n=E(n,f),h=E(h,b),I=F(I,f),Q=F(Q,b),M=E(M,f),K=E(K,b);a.push(new e({xmin:I,ymin:Q,xmax:M,ymax:K,spatialReference:H?H.toJson():null}))}c={xmin:l,ymin:p,xmax:n,ymax:h,spatialReference:H?H.toJson():null};a=1<a.length?a:null;this.setCacheValue("_extent",c);this.setCacheValue("_partwise",a);c=new e(c);c._partwise=a;return c}},toJson:function(){var c={paths:a.clone(this.paths)},d=this.spatialReference;d&&(c.spatialReference=
d.toJson());return c}});p.defaultProps=d;return p})},"esri/geometry/Polygon":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ./mathUtils ../srUtils".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d){var r={type:"polygon",rings:null},u=p(m,{declaredClass:"esri.geometry.Polygon",constructor:function(c){a.mixin(this,r);this.rings=[];this._ring=0;c&&(a.isArray(c)?this.rings=a.isArray(c[0][0])?c:[c]:c.rings?a.mixin(this,
c):this.spatialReference=c,this.spatialReference&&(this.spatialReference=d.createSpatialReference(this.spatialReference)));this.verifySR()},addRing:function(c){this.clearCache();this._ring=this.rings.length;this.rings[this._ring]=[];a.isArray(c[0])?f.forEach(c,this._addPointArr,this):f.forEach(c,this._addPoint,this);return this},_addPointArr:function(c){this.rings[this._ring].push(c)},_addPoint:function(c){this.rings[this._ring].push([c.x,c.y])},_insertPoints:function(c,a){this.clearCache();this._ring=
a;this.rings[this._ring]||(this.rings[this._ring]=[]);f.forEach(c,this._addPoint,this)},_validateInputs:function(c,a){return null!==c&&void 0!==c&&(0>c||c>=this.rings.length)||null!==a&&void 0!==c&&(0>a||a>=this.rings[c].length)?!1:!0},getPoint:function(c,a){if(this._validateInputs(c,a))return new g(this.rings[c][a],this.spatialReference)},setPoint:function(c,a,b){if(this._validateInputs(c,a))return this.clearCache(),this.rings[c][a]=[b.x,b.y],this},insertPoint:function(c,a,b){if(this._validateInputs(c)&&
h.isDefined(a)&&0<=a&&a<=this.rings[c].length)return this.clearCache(),this.rings[c].splice(a,0,[b.x,b.y]),this},removeRing:function(c){if(this._validateInputs(c,null)){this.clearCache();c=this.rings.splice(c,1)[0];var a,b=c.length,d=this.spatialReference;for(a=0;a<b;a++)c[a]=new g(c[a],d);return c}},removePoint:function(c,a){if(this._validateInputs(c,a))return this.clearCache(),new g(this.rings[c].splice(a,1)[0],this.spatialReference)},getExtent:function(){var c;c=this.getCacheValue("_extent");var a=
this.getCacheValue("_partwise");if(c)return c=new e(c),c._partwise=a,c;c=this.rings;var b=c.length;if(b&&c[0].length){var d,n,g,r,f,h,u,k,m=r=c[0][0][0],q=f=c[0][0][1],l=Math.min,p=Math.max,M=this.spatialReference,a=[],Q,K,J,O;for(h=0;h<b;h++){d=c[h];Q=K=d[0]&&d[0][0];J=O=d[0]&&d[0][1];k=d.length;for(u=0;u<k;u++)n=d[u],g=n[0],n=n[1],m=l(m,g),q=l(q,n),r=p(r,g),f=p(f,n),Q=l(Q,g),J=l(J,n),K=p(K,g),O=p(O,n);a.push(new e({xmin:Q,ymin:J,xmax:K,ymax:O,spatialReference:M?M.toJson():null}))}c={xmin:m,ymin:q,
xmax:r,ymax:f,spatialReference:M?M.toJson():null};a=1<a.length?a:null;this.setCacheValue("_extent",c);this.setCacheValue("_partwise",a);c=new e(c);c._partwise=a;return c}},contains:function(c){var a=this.rings,b,d=!1,e,r,f,h,u,k,m=a.length;b=this.spatialReference;e=c.spatialReference;var q=c.x;c=c.y;b&&(e&&!b.equals(e)&&b._canProject(e))&&(c=b.isWebMercator()?g.lngLatToXY(q,c):g.xyToLngLat(q,c,!0),q=c[0],c=c[1]);for(k=0;k<m;k++){b=a[k];f=b.length;for(u=h=0;u<f;u++)if(h++,h===f&&(h=0),e=b[u],r=b[h],
(e[1]<c&&r[1]>=c||r[1]<c&&e[1]>=c)&&e[0]+(c-e[1])/(r[1]-e[1])*(r[0]-e[0])<q)d=!d}return d},getCentroid:function(){var c=this.getCacheValue("_centroid");if(void 0!==c)return c;var c=this.rings,a,b,d,e,r=[],h,u,k=Infinity,m=-Infinity,q=Infinity,l=-Infinity;f.forEach(c,function(c){a=b=d=0;f.forEach(c,function(e,n){n<c.length-1&&(h=c[n+1],u=e[0]*h[1]-h[0]*e[1],a+=(e[0]+h[0])*u,b+=(e[1]+h[1])*u,d+=u,e[0]<k&&(k=e[0]),e[0]>m&&(m=e[0]),e[1]<q&&(q=e[1]),e[1]>l&&(l=e[1]))});0<d&&(d*=-1);d&&r.push([a,b,d/2])});
r.sort(function(b,c){return b[2]-c[2]});a=b=void 0;if(r[0]&&(e=6*r[0][2],a=r[0][0]/e,b=r[0][1]/e,a<k||a>m||b<q||b>l))a=b=void 0;if(void 0===a||void 0===b)if(c=c[0]&&c[0].length?this._getLineCentroid(c[0]):null)a=c.x,b=c.y;c=isNaN(a)||isNaN(b)?null:new g(a,b,this.spatialReference);this.setCacheValue("_centroid",c);return c},_getLineCentroid:function(a){var d,b=0,e=0,n=0,g,r,f={x:0,y:0},h={x:0,y:0},u,k=a.length,m;for(u=0;u<k-1;u++)g=a[u],r=a[u+1],g&&r&&(f.x=g[0],f.y=g[1],h.x=r[0],h.y=r[1],d=c.getLength(f,
h),0<d&&(b+=d,g=c.getMidpoint(g,r),e+=d*g[0],n+=d*g[1]));0<b?m={x:e/b,y:n/b}:a[0]&&(m={x:a[0][0],y:a[0][1]});return m},isClockwise:function(c){var d=0,b,e=c.length,n=a.isArray(c[0])?function(b,c){return b[0]*c[1]-c[0]*b[1]}:function(b,c){return b.x*c.y-c.x*b.y};for(b=0;b<e;b++)d+=n(c[b],c[(b+1)%e]);return 0>=d/2},isSelfIntersecting:function(a){a=a||this;var d,b,e,n,g,r,f,h=a.rings.length,u;for(e=0;e<h;e++){for(d=0;d<a.rings[e].length-1;d++){g=[[a.rings[e][d][0],a.rings[e][d][1]],[a.rings[e][d+1][0],
a.rings[e][d+1][1]]];for(b=e+1;b<h;b++)for(n=0;n<a.rings[b].length-1;n++)if(r=[[a.rings[b][n][0],a.rings[b][n][1]],[a.rings[b][n+1][0],a.rings[b][n+1][1]]],(f=c._getLineIntersection2(g,r))&&!(f[0]===g[0][0]&&f[1]===g[0][1]||f[0]===r[0][0]&&f[1]===r[0][1]||f[0]===g[1][0]&&f[1]===g[1][1]||f[0]===r[1][0]&&f[1]===r[1][1]))return!0}n=a.rings[e].length;if(!(4>=n))for(d=0;d<n-3;d++){u=n-1;0===d&&(u=n-2);g=[[a.rings[e][d][0],a.rings[e][d][1]],[a.rings[e][d+1][0],a.rings[e][d+1][1]]];for(b=d+2;b<u;b++)if(r=
[[a.rings[e][b][0],a.rings[e][b][1]],[a.rings[e][b+1][0],a.rings[e][b+1][1]]],(f=c._getLineIntersection2(g,r))&&!(f[0]===g[0][0]&&f[1]===g[0][1]||f[0]===r[0][0]&&f[1]===r[0][1]||f[0]===g[1][0]&&f[1]===g[1][1]||f[0]===r[1][0]&&f[1]===r[1][1]))return!0}}return!1},toJson:function(){var c={rings:a.clone(this.rings)},d=this.spatialReference;d&&(c.spatialReference=d.toJson());return c}});u.defaultProps=r;u.createEllipse=function(c){var a=c.center.x,b=c.center.y,d=c.longAxis,e=c.shortAxis,g=c.numberOfPoints,
r=c.map,f,h,k;c=[];var m=2*Math.PI/g;for(h=0;h<g;h++)f=Math.cos(h*m),k=Math.sin(h*m),f=r.toMap({x:d*f+a,y:e*k+b}),c.push(f);c.push(c[0]);a=new u(r.spatialReference);a.addRing(c);return a};u.createCircle=function(c){return u.createEllipse({center:c.center,longAxis:c.r,shortAxis:c.r,numberOfPoints:c.numberOfPoints,map:c.map})};u.fromExtent=function(c){var a=c.normalize();c=c.spatialReference;return new u({rings:f.map(a,function(b){return[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],
[b.xmin,b.ymin]]}),spatialReference:c?c.toJson():null})};return u})},"esri/geometry/Multipoint":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(p,f,a,l,k,h,q,m,g){var e={type:"multipoint",points:null};p=p(h,{declaredClass:"esri.geometry.Multipoint",constructor:function(c){f.mixin(this,e);this.points=[];c&&(c.points?f.mixin(this,c):this.spatialReference=c,this.spatialReference&&(this.spatialReference=
g.createSpatialReference(this.spatialReference)));this.verifySR()},addPoint:function(c){this.clearCache();f.isArray(c)?this.points.push(c):this.points.push([c.x,c.y]);return this},removePoint:function(c){if(this._validateInputs(c))return this.clearCache(),new q(this.points.splice(c,1)[0],this.spatialReference)},getExtent:function(){var c=this.getCacheValue("_extent");if(c)return new m(c);var c=this.points,a=c.length;if(a){var e=c[0],g,f,t=g=e[0],b=f=e[1],v=Math.min,n=Math.max,h=this.spatialReference,
k,q;for(q=0;q<a;q++)e=c[q],k=e[0],e=e[1],t=v(t,k),b=v(b,e),g=n(g,k),f=n(f,e);c={xmin:t,ymin:b,xmax:g,ymax:f,spatialReference:h?h.toJson():null};this.setCacheValue("_extent",c);return new m(c)}},_validateInputs:function(c){return null===c||0>c||c>=this.points.length?!1:!0},getPoint:function(c){if(this._validateInputs(c))return c=this.points[c],new q(c[0],c[1],this.spatialReference)},setPoint:function(c,a){if(this._validateInputs(c))return this.clearCache(),this.points[c]=[a.x,a.y],this},toJson:function(){var c=
{points:f.clone(this.points)},a=this.spatialReference;a&&(c.spatialReference=a.toJson());return c}});p.defaultProps=e;return p})},"esri/layers/GraphicsLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/dom dojox/gfx dojox/gfx/matrix ./gfxSniff!esri-svg?dojox/gfx/filters ./layer ../kernel ../lang ../sniff ../Color ../domUtils ../symbols/MarkerSymbol ../symbols/SimpleMarkerSymbol ../geometry/Point ../geometry/ScreenPoint ../geometry/Extent ../geometry/mathUtils ../geometry/screenUtils ../PluginTarget ./gfxSniff!esri-svg?dojox/gfx/svgext".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A,B){var F,E=-1!==g.renderer.toLowerCase().indexOf("svg"),H=-1!==g.renderer.toLowerCase().indexOf("canvas"),I=9>s("ie"),M=s("esri-touch");v=p(null,{declaredClass:"esri.layers._GraphicsContainer",_setMap:function(b,c){var a,d=this._connects=[];this._map=b;H?(a=h.create("div",{style:"overflow: visible; position: absolute;"},c),this._surface={getEventSource:function(){return a}},d.push(f.connect(a,"onmousedown",this,this._canvasDownHandler)),d.push(f.connect(a,
"onmouseup",this,this._canvasUpHandler)),d.push(f.connect(a,"onclick",this,this._canvasClickHandler)),F.prototype._canvas=!0):(a=(this._surface=g.createSurface(c,b.width,b.height)).getEventSource(),q.set(a=I?a.parentNode:a,{overflow:"visible",position:"absolute"}));d.push(f.connect(b,"onResize",this,"_onResizeHandler"));return a},_onResizeHandler:function(b,c,a){b=this._surface.getEventSource();var d=this._map,e;I&&q.set(b=b.parentNode,{width:c+"px",height:a+"px",clip:"rect(0px "+c+"px "+a+"px 0px)"});
k.set(b,"width",c);k.set(b,"height",a);this._surface.declaredClass||l.forEach(b.childNodes,function(b){k.set(b,"width",c);k.set(b,"height",a)});d.loaded&&(d.graphics.suspended||(d.graphics._resized=!0),l.forEach(d.graphicsLayerIds,function(b){e=d.getLayer(b);e.suspended||(e._resized=!0);e._updateSVGFilters(null,null,c,a)}))},_cleanUp:function(){l.forEach(this._connects,f.disconnect,f);this._map=this._surface=null},_processEvent:function(b){var c=this._map;b.screenPoint=new x(b.pageX-c.position.x,
b.pageY-c.position.y);b.mapPoint=c.toMap(b.screenPoint)},_canvasDownHandler:function(b){this._processEvent(b);this._downPt=b.screenPoint.x+","+b.screenPoint.y},_canvasUpHandler:function(b){this._processEvent(b);this._upPt=b.screenPoint.x+","+b.screenPoint.y},_tolerance:15,_isPrimaryMatch:function(b,c,a,d){if(!b.visible||!c)return!1;var e=c.getTransformedBoundingBox(),n;return e?(n=new z(e[0].x,e[0].y,e[2].x,e[2].y),delete n.spatialReference,M?n.intersects(a):n.contains(d)):l.some(c.children||[],function(b){e=
b.getTransformedBoundingBox();n=new z(e[0].x,e[0].y,e[2].x,e[2].y);delete n.spatialReference;return M?n.intersects(a):n.contains(d)})},_canvasClickHandler:function(b){if(this._downPt&&this._upPt&&this._downPt===this._upPt){this._processEvent(b);var c=this._map,a=l.map(c.graphicsLayerIds,function(b){return c.getLayer(b)});a.push(c.graphics);a.reverse();var a=l.filter(a,function(b){return b.loaded&&b._mouseEvents&&!b.suspended&&(!u.isDefined(b.opacity)||0<b.opacity)}),d=b.screenPoint,e=this._tolerance,
n=d.x-e,g=d.y+e,r=d.x+e,e=d.y-e,f=new z(n,e,r,g),n=c.toMap(new x(n,g)),r=c.toMap(new x(r,e)),g=n.spatialReference._getInfo(),s=new z(z.prototype._normalizeX(n.x,g).x,n.y,z.prototype._normalizeX(r.x,g).x,r.y,n.spatialReference),t;delete f.spatialReference;l.some(a,function(b){b=l.filter(b.graphics,function(b){return this._isPrimaryMatch(b,b.getDojoShape(),f,d)||!(!b._bgShape||!this._isPrimaryMatch(b,b._bgShape,f,d))},this);b.reverse();if(0<b.length){var c;l.some(b,function(b){return b.geometry&&s.intersects(b.geometry)?
(c=b,!0):!1});if(c)return t=c,!0}return!1},this);if(t&&(a=t.getLayer()))b.graphic=t,a.onClick(b)}}});F=p(d,{declaredClass:"esri.layers._GraphicsLayer",managedSuspension:!0,surfaceType:H?"canvas-2d":g.renderer,_eventMap:{"graphic-add":["graphic"],"graphic-remove":["graphic"],"renderer-change":["renderer"]},constructor:function(b,c){if(b&&(a.isString(b)||a.isObject(b)&&(b.layerDefinition||b.query)))b=c;this._params=a.mixin({displayOnPan:!0,drawMode:!0,styling:!0},b||{});var d=this._params.dataAttributes;
"string"===typeof d&&(d=[d]);this.styling=E?this._params.styling:!0;this.dataAttributes=d;this.infoTemplate=b&&b.infoTemplate;this.graphics=[];this._draw=a.hitch(this,this._draw);this._refresh=a.hitch(this,this._refresh);this.registerConnectEvents()},getNode:function(){return this._div&&this._div.getEventSource()},setDrawMode:function(b){this._params.drawMode=b},renderer:null,_setMap:function(b,c){this.inherited(arguments);this._map=b;this._wrap=b.wrapAround180;this._srInfo=b.spatialReference._getInfo();
this._svgFilters={};this._canvas?(c=g.createSurface(c.getEventSource(),b.width,b.height),q.set(c.rawNode,"position","absolute"),this._div=c.createGroup(),this._renderProto=this._div.constructor.prototype._render,this._div._render=a.hitch(this,this._canvasRender)):this._div=c.createGroup();this._bgGroup=this._div.createGroup();this._div.getEventSource().id=this.id+"_layer";var d=this.opacity;u.isDefined(d)&&1>d&&this.setOpacity(d,!0);return this._div},_unsetMap:function(b,c){l.forEach(this.graphics,
function(b){b._shape=null});this._canvas?(c=this._div.getParent(),c._parent={},h.destroy(c.rawNode),c.destroy()):(this._div.clear(),c.remove(this._div),h.destroy(this._div.getEventSource()));this._map=this._div=this._svgFilters=null;clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();this.inherited(arguments)},_onZoomStartHandler:function(){b.hide(this._div.getEventSource())},_onExtentChangeHandler:function(c,a,d,e){clearTimeout(this._wakeTimer);this._wakeTimer=null;d?
(c=this._map.__visibleRect,a=this._div,this._evalSDRenderer(),this._refresh(!0),this._updateTransform(a,c.x,c.y,!0),this._renderProto&&a.surface.pendingRender?this._dirty=!0:this.suspended||b.show(a.getEventSource())):this._resized&&(this._refresh(!1),this._resized=!1);if(0<this.graphics.length)this.onUpdate()},_canvasRender:function(){var c=this._div;this._dirty&&(delete this._dirty,this.suspended||b.show(c.getEventSource()));return this._renderProto.apply(c,arguments)},_refresh:function(b){var c=
this.graphics,a=c.length,d,e=this._draw;for(d=0;d<a;d++)e(c[d],b)},refresh:function(){this._refresh(!0)},redraw:function(){this._refresh(!0)},_onPanHandler:function(b,c){this._panDx=c.x;this._panDy=c.y;var a=this._map.__visibleRect;this._updateTransform(this._div,a.x+c.x,a.y+c.y)},_onPanEndUpdateHandler:function(b,c){var a=this._map.__visibleRect;!this._params._child&&(c.x!==this._panDx||c.y!==this._panDy)?this._updateTransform(this._div,a.x,a.y,!0):this._updateSVGFilters(-a.x,-a.y);this._refresh(!1);
if(this.graphics.length)this.onUpdate()},_onPanStartHandler:function(){b.hide(this._div.getEventSource())},_onPanEndHandler:function(){var c=this._map.__visibleRect,a=this._div;this._updateTransform(a,c.x,c.y,!0);this._refresh(!1);this._renderProto&&a.surface.pendingRender?this._dirty=!0:b.show(a.getEventSource());if(this.graphics.length)this.onUpdate()},_updateTransform:function(b,c,a,d){b.setTransform(e.translate({x:c,y:a}));d&&this._updateSVGFilters(-c,-a)},onSuspend:function(){this.inherited(arguments);
b.hide(this._div.getEventSource());clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors()},onResume:function(b){this.inherited(arguments);b.firstOccurrence&&this._evalSDRenderer();this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(a.hitch(this,function(){this.suspended||this._onExtentChangeHandler(null,null,!0)}),0)},_enableDrawConnectors:function(){var b=this._map,c=f.connect;this._disableDrawConnectors();this._params.displayOnPan?(this._params._child||
(this._onPanHandler_connect=c(b,"onPan",this,"_onPanHandler")),this._onPanEndHandler_connect=c(b,"onPanEnd",this,"_onPanEndUpdateHandler")):(this._onPanStartHandler_connect=c(b,"onPanStart",this,"_onPanStartHandler"),this._onPanEndHandler_connect=c(b,"onPanEnd",this,"_onPanEndHandler"));this._onZoomStartHandler_connect=c(b,"onZoomStart",this,"_onZoomStartHandler");this._onExtentChangeHandler_connect=c(b,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var b=f.disconnect;
b(this._onExtentChangeHandler_connect);b(this._onZoomStartHandler_connect);b(this._onPanHandler_connect);b(this._onPanStartHandler_connect);b(this._onPanEndHandler_connect);this._onExtentChangeHandler_connect=this._onZoomStartHandler_connect=this._onPanHandler_connect=this._onPanStartHandler_connect=this._onPanEndHandler_connect=null},_updateExtent:function(b){var c=b.geometry;if(c){if(!(b._extent=c.getExtent())){var a,d;if("esri.geometry.Point"===c.declaredClass)a=c.x,d=c.y;else if("esri.geometry.Multipoint"===
c.declaredClass)a=c.points[0][0],d=c.points[0][1];else{b._extent=null;return}b._extent=new z(a,d,a,d,c.spatialReference)}}else b._extent=null},_intersects:function(b,c,a){var d=b.spatialReference,e=c.spatialReference,n=d&&e&&!d.equals(e)&&d._canProject(e)&&4326===e.wkid;if(this._wrap&&!a){a=[];var d=b._getFrameWidth(),g=this._srInfo,r=b._clip?b._getAvailExtent():b.extent,f,s,t,v,h=[];f=c._partwise;n&&(r=b.geographicExtent,g=e._getInfo());b=r._getParts(g);if(f&&f.length){c=[];e=0;for(n=f.length;e<
n;e++)c=c.concat(f[e]._getParts(g))}else c=c._getParts(g);e=0;for(n=c.length;e<n;e++){t=c[e];g=0;for(r=b.length;g<r;g++)if(v=b[g],v.extent.intersects(t.extent)){f=0;for(s=t.frameIds.length;f<s;f++)a.push((v.frameIds[0]-t.frameIds[f])*d)}}e=0;for(n=a.length;e<n;e++)f=a[e],l.indexOf(a,f)===e&&h.push(f);return h.length?h:null}return(n?b.geographicExtent:b.extent).intersects(c)?[0]:null},_defaultMarker:{type:"simplemarkersymbol",style:"square",size:1,xoffset:0,yoffset:0,angle:0},_draw:function(b,c){if(this._params.drawMode&&
this._map&&!this.suspended)try{var a=b._extent,d,e,n=!E||this.styling,g=E&&this.dataAttributes,r=b.getDojoShape(),f;if(b.visible&&a&&(d=this._intersects(this._map,a,b.geometry._originOnly))&&(e=n?this._getSymbol(b):this._defaultMarker)){if(!b._offsets||b._offsets.join(",")!==d.join(",")?b._offsets=d:f=!0,!r||c||!f){var s=b.geometry.type,a={graphic:b},t=b._bgShape,v=n&&!b.symbol?this._getRenderer(b):null,h=v&&v.backgroundFillSymbol;if("point"===s)this._isInvalidShape(e,r)&&this._removeShape(b),b._shape=
this._drawPoint(this._div,b.geometry,e,b.getDojoShape(),d,v,b),n&&this._symbolizePoint(b.getDojoShape(),e,v,b);else if("multipoint"===s)this._drawMarkers(b,e,d,v),n&&this._symbolizeMarkers(b,e,v);else{var u,s=e,w,k;n&&(s=(u="simplemarkersymbol"===e.type||"picturemarkersymbol"===e.type||"textsymbol"===e.type?e:null)?h:e);s&&s===h&&(w=this._bgGroup);t&&!w&&this._removeBgShape(b);s&&(!w&&this._isInvalidShape(s,b._shape)&&this._removeShape(b,!1),k=this._drawShape(b,d,w||this._div,w?t:b.getDojoShape()),
n&&this._symbolizeShape(k,s,v,!!h,b),b[w?"_bgShape":"_shape"]=k);if(u){this._isInvalidShape(u,b._shape)&&this._removeShape(b,!1);var m=b.geometry.getCentroid();(k=m&&this._drawPoint(this._div,m,u,b._shape,d,v,b))&&this._symbolizePoint(k,u,v,b);b._shape=k}}H||(b._bgShape&&this._initNode(b,b._bgShape,b._bgShape!==t,a,g),b._shape&&this._initNode(b,b._shape,b._shape!==r,a,g));a.node=b.getNode();this.onGraphicDraw(a)}}else r&&this._removeShape(b)}catch(q){this._errorHandler(q,b)}},_initNode:function(b,
c,a,d,e){if(c=c&&c.getNode())c.e_graphic=b,this._addDataAttrs(b,e,c),a&&(d.node=c,this.onGraphicNodeAdd(d))},_removeShape:function(b,c){var a=b.getDojoShape(),d=a&&a.getNode();a&&(a.removeShape(),a.destroy());b._shape=b._offsets=null;!1!==c&&this._removeBgShape(b);if(d&&(d.e_graphic=null,!H))this.onGraphicNodeRemove({graphic:b,node:d})},_removeBgShape:function(b){var c=b._bgShape,a=c&&c.getNode();c&&(c.removeShape(),c.destroy(),b._bgShape=null);if(a&&(a.e_graphic=null,!H))this.onGraphicNodeRemove({graphic:b,
node:a})},_addDataAttrs:function(b,c,a){var d=b.attributes,e,n=c?c.length:0,g=this._getRenderer(b);if(a&&d){for(e=0;e<n;e++)(a=c[e])&&b.attr("data-"+a,d[a]);!this.styling&&g&&(g.getBreakIndex?(c=g.getBreakIndex(b),b.attr("data-class-break",-1!==c?c:null)):g.getUniqueValueInfo&&(c=g.getUniqueValueInfo(b),b.attr("data-unique-value",c?c.value:null)))}},_drawShape:function(b,c,a,d){b=b.geometry;var e=b.type,n=this._map,g=n.extent,r=n.width,f=n.height,n=n.__visibleRect,s=[],t,v;t="extent"===e;if("rect"===
e||t)s={x:0,y:0,spatialReference:b.spatialReference},s.x=t?b.xmin:b.x,s.y=t?b.ymax:b.y,e=A.toScreenPoint(g,r,f,s),s.x=t?b.xmax:b.x+b.width,s.y=t?b.ymin:b.y+b.height,b=A.toScreenPoint(g,r,f,s),c={x:e.x-n.x+c[0],y:e.y-n.y,width:Math.abs(b.x-e.x),height:Math.abs(b.y-e.y)},0===c.width&&(c.width=1),0===c.height&&(c.height=1),d=this._drawRect(a,d,c);else if("polyline"===e||"polygon"===e){t=0;for(v=c.length;t<v;t++)s=s.concat(A._toScreenPath(g,r,f,b,-n.x+c[t],-n.y));d=this._drawPath(a,d,s);this._rendererLimits&&
("polyline"===e?this._clipPolyline(d,b):this._clipPolygon(d,b))}return d},_drawRect:function(b,c,a){return c?c.setShape(a):b.createRect(a)},_drawImage:function(b,c,a){return c?c.setShape(a):b.createImage(a)},_drawCircle:function(b,c,a){return c?c.setShape(a):b.createCircle(a)},_drawPath:function(){return I?function(b,c,a,d){a=d?a:a.join(" ");if(c)return c.setShape(a);c=b.createObject(d?g.Path:g.EsriPath,a);b._overrideSize(c.getEventSource());return c}:function(b,c,a,d){a=d?a:a.join(" ");return c?
c.setShape(a):b.createPath(a)}}(),_drawText:function(b,c,a){return c?c.setShape(a):b.createText(a)},_evalSDRenderer:function(b){var c=this._map,a=this.renderer,d,e=this._rndForScale;c&&(c.loaded&&a&&a.getRendererInfo)&&(d="zoom"===a.rangeType?a.getRendererInfoByZoom(c.getZoom()):a.getRendererInfoByScale(c.getScale()));this._rndForScale=d&&d.renderer;!b&&this._rndForScale!=e&&this.emit("renderer-change",{renderer:this._rndForScale})},_getRenderer:function(b){var c=this._rndForScale||this.renderer;
b&&(c&&c.getObservationRenderer)&&(c=c.getObservationRenderer(b));return c},_getSymbol:function(b){var c=this._getRenderer();return b.symbol||c&&c.getSymbol(b)},_getVariable:function(b,c,a){var d;b&&(d=(b=b.getVisualVariablesForType(c,a))&&b[0]);return d},_applyOpacity:function(b,c,a,d){c=c.getOpacity(d,{opacityInfo:a});null!=c&&(b=new t(b),b.a=c);return b},_symbolizeShape:function(b,c,d,e,n){var g=c.getStroke(),r=c.getFill(),f=c.type,s,t,v=this._getVariable(d,"sizeInfo",!1),h=this._getVariable(d,
"colorInfo",!1),u=this._getVariable(d,"opacityInfo",!1),w=-1!==f.indexOf("linesymbol");c=w?"none"!==c.style:c.outline&&"none"!==c.outline.style;var k=w?null:this._getVariable(d,"sizeInfo","outline"),v=(v=e?k:k||v)?d.getSize(n,{sizeInfo:v,resolution:this._map.getResolutionInMeters(),scale:this._map.getScale()}):null;e&&(h=u=null);if((h||u)&&"picturefillsymbol"!==f)w?(s=g&&g.color,h&&(s=d.getColor(n,{colorInfo:h})||s),s&&u&&(s=this._applyOpacity(s,d,u,n))):r&&r.toCss&&(t=r,h&&(t=d.getColor(n,{colorInfo:h})||
t),t&&u&&(t=this._applyOpacity(t,d,u,n)));b.setStroke(!c||null==v&&!s?g:a.mixin({},g,null!=v?{width:v}:null,s&&{color:s})).setFill(t||r)},_smsToPath:function(){return I?function(b,c,a,d,e,n,g,r,f){switch(c){case b.STYLE_SQUARE:return["M",e+","+g,"L",n+","+g,n+","+r,e+","+r,"X","E"];case b.STYLE_CROSS:return["M",a+","+g,"L",a+","+r,"M",e+","+d,"L",n+","+d,"E"];case b.STYLE_X:return["M",e+","+g,"L",n+","+r,"M",e+","+r,"L",n+","+g,"E"];case b.STYLE_DIAMOND:return["M",a+","+g,"L",n+","+d,a+","+r,e+","+
d,"X","E"];case b.STYLE_TARGET:return["M",e+","+g,"L",n+","+g,n+","+r,e+","+r,e+","+g,"M",e-f+","+d,"L",e+","+d,"M",a+","+(g-f),"L",a+","+g,"M",n+f+","+d,"L",n+","+d,"M",a+","+(r+f),"L",a+","+r,"E"]}}:function(b,c,a,d,e,n,g,r,f){switch(c){case b.STYLE_SQUARE:return["M",e+","+g,n+","+g,n+","+r,e+","+r,"Z"];case b.STYLE_CROSS:return["M",a+","+g,a+","+r,"M",e+","+d,n+","+d];case b.STYLE_X:return["M",e+","+g,n+","+r,"M",e+","+r,n+","+g];case b.STYLE_DIAMOND:return["M",a+","+g,n+","+d,a+","+r,e+","+d,
"Z"];case b.STYLE_TARGET:return["M",e+","+g,n+","+g,n+","+r,e+","+r,e+","+g,"M",e-f+","+d,e+","+d,"M",a+","+(g-f),a+","+g,"M",n+f+","+d,n+","+d,"M",a+","+(r+f),a+","+r]}}}(),_pathStyles:{square:1,cross:1,x:1,diamond:1,target:1},_typeMaps:{picturemarkersymbol:"image",picturefillsymbol:"path",simplefillsymbol:"path",simplelinesymbol:"path",cartographiclinesymbol:"path",textsymbol:"text"},_isInvalidShape:function(b,c){var a=c&&c.shape&&c.shape.type,d=b&&b.type,e=b&&b.style;"rect"===a&&(a="path");d&&
(e=this._typeMaps[d]||e);this._pathStyles[e]&&(e="path");return"shieldlabelsymbol"===d?!0:!(!a||!(e&&a!==e))},_drawPoint:function(b,c,a,d,g,r,f){var s=a.type,t=this._map,v=t.__visibleRect,h=A.toScreenPoint(t.extent,t.width,t.height,c).offset(-v.x+g[0],-v.y),v=h.x,u=h.y,w;c=[];var k,m=this._getVariable(r,"rotationInfo",!1),m=m?r.getRotationAngle(f,{rotationInfo:m}):null,q=this._getVariable(r,"sizeInfo",!1),t=q?r.getSize(f,{sizeInfo:q,shape:a.style,resolution:t.getResolutionInMeters(),scale:t.getScale()}):
null;m&&c.push(e.rotategAt(m,h));if(0!==a.xoffset||0!==a.yoffset)k=e.translate(a.xoffset,-a.yoffset),c.push(k);0!==a.angle&&c.push(e.rotategAt(a.angle,h));if("simplemarkersymbol"===s)switch(w=a.style,r=Math.round,t=null!=t?t:a.size,w){case n.STYLE_SQUARE:case n.STYLE_CROSS:case n.STYLE_X:case n.STYLE_DIAMOND:a=isNaN(t)?16:t/2;w=this._drawPath(b,d,this._smsToPath(n,w,v,u,r(v-a),r(v+a),r(u-a),r(u+a)));break;case n.STYLE_TARGET:f=a._targetWidth/2;h=a._targetHeight/2;w=this._drawPath(b,d,this._smsToPath(n,
w,v,u,r(v-f),r(v+f),r(u-h),r(u+h),a._spikeSize));break;case n.STYLE_PATH:w=this._drawPath(b,d,a.path,!0);a=w.getBoundingBox();b=this._getScaleMatrix(a,t);(1!==b.xx||1!==b.yy)&&c.push(e.scaleAt(b.xx,b.yy,h));c.push(e.translate(-(a.x+a.width/2)+v,-(a.y+a.height/2)+u));break;default:a=isNaN(t)?16:t/2,w=this._drawCircle(b,d,{cx:v,cy:u,r:a})}else if("shieldlabelsymbol"===s)w=a.width,h=a.height,d=b.createGroup(),w=b.createImage({x:v-w/2,y:u-h/2,width:w,height:h,src:a.url}),d.add(w),null!=a.font&&(u+=0.2*
a.getHeight(),b=b.createText({type:"text",text:a.text,x:v,y:u,align:"middle",decoration:a.decoration,rotated:a.rotated,kerning:a.kerning}),b.setFont(a.font),b.setFill(a.color),d.add(b)),w=d;else if("picturemarkersymbol"===s){if(null==t?(w=a.width,h=a.height):(h=t,w=h*(a.width/a.height),k&&(null!=k.dx&&(k.dx=w*(k.dx/a.width)),null!=k.dy&&(k.dy=h*(k.dy/a.height)))),w=this._drawImage(b,d,{x:v-w/2,y:u-h/2,width:w,height:h,src:a.url}),E&&(b=w.getNode()))a=(a=this._getVariable(r,"opacityInfo",!1))?r.getOpacity(f,
{opacityInfo:a}):null,null!=a?b.setAttribute("opacity",a):b.setAttribute("opacity",1)}else"textsymbol"===s&&(r=a.font,null!=t&&r&&(r=new r.constructor(r.toJson()),r.setSize(t)),w=this._drawText(b,d,{type:"text",text:a.text,x:v,y:u,align:a.getSVGAlign(),decoration:a.decoration||r&&r.decoration,rotated:a.rotated,kerning:a.kerning}),r&&w.setFont(r),E&&(b=w.getNode(),v=a.getSVGBaseline(),u=a.getSVGBaselineShift(),b&&(b.setAttribute("dominant-baseline",v),u&&b.setAttribute("baseline-shift",u),this._applyHalo(w,
a.haloColor,a.haloSize))));w.setTransform(e.multiply(c));w._wrapOffsets=g;return w},_applyHalo:function(b,c,a){var d=c&&a?this._getHaloId(c,a):null;b.setFilter(c&&a?s("webkit")||s("ff")?this._getDilateFilter(c,a,d):this._getOffsetFilter(c,a,d):null)},_getDilateFilter:function(b,a,d){var e=this._getSVGFilter(d);e||(e=this._createSVGFilter({id:d},[c.feMorphology({operator:"dilate",radius:a,result:"dilated"}),c.feFlood({"flood-color":b.toCss(!0)}),c.feComposite({in2:"dilated",operator:"in",result:"composite"}),
c.feMerge("composite","SourceGraphic")]));return e},_getOffsetFilter:function(b,a,d){var e=this._getSVGFilter(d);if(!e){b=b.toCss(!0);var e=this._offsetPrimitives,n,g=e.length,r=[],f=[];for(n=0;n<g;n++){var t=e[n],s="offset"+t.dir,v="composite"+t.dir;f.push(v);r.push(c.feOffset({dx:t.dx*a,dy:t.dy*a,"in":"SourceAlpha",result:s}),c.feFlood({"flood-color":b}),c.feComposite({in2:s,operator:"in",result:v}))}f.push("SourceGraphic");r.push(c.feMerge.apply(c.feMerge,f));e=this._createSVGFilter({id:d},r)}return e},
_offsetPrimitives:[{dir:"L",dx:-1,dy:0},{dir:"TL",dx:-1,dy:-1},{dir:"T",dx:0,dy:-1},{dir:"TR",dx:1,dy:-1},{dir:"R",dx:1,dy:0},{dir:"BR",dx:1,dy:1},{dir:"B",dx:0,dy:1},{dir:"BL",dx:-1,dy:1}],_getHaloId:function(b,c){return"halo_"+this._map.id+"_"+this.id+"_"+b.r+"_"+b.g+"_"+b.b+"_"+b.a+"_"+c},_getSVGFilter:function(b){return this._svgFilters[b]},_createSVGFilter:function(b,a){var d=c.createFilter(b,a),e=this._map,n=e.__visibleRect;d.x=-n.x;d.y=-n.y;d.width=e.width;d.height=e.height;return this._svgFilters[b.id]=
d},_updateSVGFilters:function(b,c,a,d){var e=this._svgFilters,n,g,r;for(g in e)if(n=e[g]){if(r=m.byId(g))null!=b&&r.setAttribute("x",b),null!=c&&r.setAttribute("y",c),null!=a&&r.setAttribute("width",a),null!=d&&r.setAttribute("height",d);null!=b&&(n.x=b);null!=c&&(n.y=c);null!=a&&(n.width=a);null!=d&&(n.height=d)}},_getScaleMatrix:function(b,c){var a=b.width/b.height,d=1,e=1;isNaN(c)||(1<a?(d=c/b.width,e=c/a/b.height):(e=c/b.height,d=c*a/b.width));return{xx:d,yy:e}},_symbolizePoint:function(b,c,d,
e){var g=c.type,r=c.style;if(!("shieldlabelsymbol"===g||"picturemarkersymbol"===g)){var f=c.getStroke();c=c.getFill();var r=r===n.STYLE_X||r===n.STYLE_CROSS,t=f&&f.color,s=r?t:c;if(d){var v=this._getVariable(d,"colorInfo",!1),h=this._getVariable(d,"opacityInfo",!1);v&&(s=d.getColor(e,{colorInfo:v})||s);s&&h&&(s=this._applyOpacity(s,d,h,e));s&&(r?s!==t&&(f=f?a.mixin({},f):{},f.color=s):s!==c&&(c=s))}"textsymbol"===g?b.setFill(c):"simplemarkersymbol"===g&&b.setFill(c).setStroke(f)}},_drawMarkers:function(b,
c,a,d){var e=b.geometry,n=e.points,g=b.getDojoShape()||this._div.createGroup(),r,f,s=n.length,t=[],v=0,h,u=a?a.length:0;g.children[0]&&this._isInvalidShape(c,g.children[0])&&g.clear();for(f=0;f<s;f++){r=n[f];for(h=0;h<u;h++)t[0]=a[h],this._drawPoint(g,{x:r[0],y:r[1],spatialReference:e.spatialReference},c,g.children[v++],t,d,b)}c=g.children.length;if(s*a.length<c)for(f=c-1;f>=s*a.length;f--)g.children[f].removeShape();b._shape=g},_symbolizeMarkers:function(b,c,a){var d=b.getDojoShape().children,e,
n=d.length;for(e=0;e<n;e++)this._symbolizePoint(d[e],c,a,b)},_errorHandler:function(b,c){b.message=c?"Unable to draw graphic (geometry:"+(c.geometry?c.geometry.declaredClass:null)+", symbol:"+(c.symbol?c.symbol.declaredClass:null)+"): "+b.message:"Unable to draw graphic (null): "+b.message;this.inherited(arguments)},_rendererLimits:function(){var b,c,a;s("ff")?(b=16125,c=-32250,a=32250):I?(b=1E5,c=-1E5,a=1E5):s("chrome")&&6>s("chrome")&&(b=8150,c=-1E4,a=1E4);if(b)return{clipLimit:b,rangeMin:c,rangeMax:a,
clipBBox:[-b,-b,b,b],clipSegments:[[[-b,-b],[b,-b]],[[b,-b],[b,b]],[[b,b],[-b,b]],[[-b,b],[-b,-b]]]}}(),_clipPolyline:function(b,c){var a=this._getCorners(b,c),d=a.br,e=this._rendererLimits,n=e.rangeMin,g=e.rangeMax,r=e.clipBBox,f=e.clipSegments,e=this._isPointWithinRange,s=this._isPointWithinBBox,t=this._getClipperIntersection,v=this._getPlaneIndex;if(!e(a.tl,n,g)||!e(d,n,g)){I&&this._createSegments(b);var h=[];l.forEach(b.segments,function(b){b=b.args;var c=b.length,a=[],d;for(d=0;d<c;d+=2){var e=
[b[d],b[d+1]],n=[b[d+2],b[d+3]],g=s(e,r),u=s(n,r);if(g^u){if(u=t([e,n],f))g?(d?a.push(u[1]):a.push(e,u[1]),h.push(a),a=[]):a.push(u[1],n)}else g?d?a.push(n):a.push(e,n):(u=v(e,r),g=v(n,r),-1===u||(-1===g||u===g)||(e=t([e,n],f,!0),0<e.length&&(e[u]||(u=e[u[0]]?u[0]:u[1]),e[g]||(g=e[g[0]]?g[0]:g[1]),n=e[u],e=e[g],n&&a.push(n),e&&(a.push(e),h.push(a),a=[]))))}h.push(a)});b.setShape(this._getPathStringFromPaths(h))}},_clipPolygon:function(b,c){var d=this._getCorners(b,c),e=d.br,n=this._rendererLimits,
g=n.clipLimit,r=n.rangeMin,f=n.rangeMax,s=n.clipBBox,t=n.clipSegments,n=this._isPointWithinRange,v=this._isPointWithinBBox,h=this._getClipperIntersection,u=this._getPlaneIndex,w=y._pointLineDistance;if(!n(d.tl,r,f)||!n(e,r,f))I&&this._createSegments(b),d=l.map(b.segments,function(b){var c=b.args,d=c.length,e=[];b=[];var n;for(n=0;n<d;n+=2){var r=[c[n],c[n+1]],f=[c[n+2],c[n+3]];if(n===d-2){e.push(r);break}var k=v(r,s),m=v(f,s);e.push(r);if(k^m){if(m=h([r,f],t))r=m[1],r[k?"inOut":"outIn"]=!0,e.push(r),
b.push([k?"INOUT":"OUTIN",e.length-1,m[0]])}else if(!k){var k=u(r,s),q=u(f,s);-1===k||(-1===q||k===q)||(m=h([r,f],t,!0),0<m.length?(m[k]||(k=m[k[0]]?k[0]:k[1]),m[q]||(q=m[q[0]]?q[0]:q[1]),r=m[k],f=m[q],r&&(r.outIn=!0,e.push(r),b.push(["OUTIN",e.length-1,k])),f&&(f.inOut=!0,e.push(f),b.push(["INOUT",e.length-1,q]))):a.isArray(k)&&a.isArray(q)&&(m=k.concat(q),m.sort(),"0123"===m.join("")&&(m=[],3===k[0]+k[1]?m.push([g,-g],[-g,g]):m.push([-g,-g],[g,g]),k=w(m[0],[r,f]),r=w(m[1],[r,f]),e.push(k<r?m[0]:
m[1]))))}}var z=s[0],x=s[1],y=s[2],A=s[3];l.forEach(e,function(b){b[0]<z&&(b[1]>=x&&b[1]<=A?b[0]=z:(b[0]=z,b[1]=b[1]<x?x:A))});l.forEach(e,function(b){b[1]<x&&(b[0]>=z&&b[0]<=y?b[1]=x:(b[1]=x,b[0]=b[0]<z?z:y))});l.forEach(e,function(b){b[0]>y&&(b[1]>=x&&b[1]<=A?b[0]=y:(b[0]=y,b[1]=b[1]<x?x:A))});l.forEach(e,function(b){b[1]>A&&(b[0]>=z&&b[0]<=y?b[1]=A:(b[1]=A,b[0]=b[0]<z?z:y))});c=0;d=b.length;if(0<d){do{f=b[c];n=b[(c+1)%d];if(f[2]===n[2]&&"INOUT"===f[0]&&"OUTIN"===n[0])if(r=f[1],n=n[1],r<n)for(r+=
1;r<n;r++)e[r][2]=!0;else if(r>n){for(r+=1;r<e.length;r++)e[r][2]=!0;for(r=0;r<n;r++)e[r][2]=!0}c=(c+1)%d}while(0!==c)}d=e[0];c=e[e.length-1];d[2]&&(c[2]=!0,l.some(b,function(b){return 1===b[1]?(e.splice(e.length-1,0,a.clone(e[1])),!0):!1}));e=l.filter(e,function(b){return b[2]?!1:!0});for(c=0;c<e.length-1;c++)if(d=e[c],(n=e[c+1])&&!(d[0]!==n[0]||d[1]!==n[1]))n.outIn?d.outIn=!0:n.inOut&&(d.inOut=!0),e.splice(c+1,1);d=Math.abs;b=[];for(c=0;c<e.length-1;c++){f=e[c];r=f[0];f=f[1];k=d(r)===g;m=d(f)===
g;n=e[c+1];q=n[0];n=n[1];var p=d(q)===g,B=d(n)===g;k&&B?b.push([c+1,[r,n]]):m&&p&&b.push([c+1,[q,f]])}for(c=b.length-1;0<=c;c--)n=b[c],r=e[n[0]-1],d=e[n[0]],!r.outIn&&(!r.inOut&&!d.outIn&&!d.inOut)&&e.splice(n[0],0,n[1]);d=e[0];c=e[e.length-1];(d[0]!==c[0]||d[1]!==c[1])&&e.push(d);return e}),b.setShape(this._getPathStringFromPaths(d))},_getCorners:function(b,c){if(I){var a=this._map,d=c.getExtent(),e=d.spatialReference,n=a.toScreen(new w(d.xmin,d.ymax,e)),a=a.toScreen(new w(d.xmax,d.ymin,e));return{tl:n,
br:a}}n=b.getTransformedBoundingBox();return{tl:n[0],br:n[2]}},_createSegments:function(b){b.shape.path=b.vmlPath;b.segmented=!1;b._confirmSegmented();var c=b.segments;1<c.length&&(b.segments=l.filter(c,function(b,c,a){c=a[c+1];return"M"===b.action&&c&&"L"===c.action?(b.args=b.args.concat(c.args),!0):!1}))},_getPathStringFromPaths:function(b){I?(b=l.map(b,function(b){return"m "+l.map(b,function(b,c){return(1===c?"l ":"")+b.join(",")}).join(" ")}),b.push("e")):b=l.map(b,function(b){return"M "+l.map(b,
function(b){return b.join(",")}).join(" ")});return b.join(" ")},_isPointWithinBBox:function(b,c){var a=c[1],d=c[2],e=c[3],n=b[0],g=b[1];return n>c[0]&&n<d&&g>a&&g<e?!0:!1},_isPointWithinRange:function(b,c,a){var d=b.x;b=b.y;return d<c||b<c||d>a||b>a?!1:!0},_getClipperIntersection:function(b,c,a){var d,e=y._getLineIntersection2,n=Math.round,g={length:0};for(d=0;4>d;d++){var r=e(b,c[d]);if(r)if(r[0]=n(r[0]),r[1]=n(r[1]),a)g[d]=r,g.length++;else return[d,r]}return a?g:null},_getPlaneIndex:function(b,
c){var a=b[0],d=b[1],e=c[0],n=c[1],g=c[2],r=c[3];return a<=e?d>=n&&d<=r?3:d<n?[0,3]:[2,3]:d<=n?a>=e&&a<=g?0:a<e?[3,0]:[1,0]:a>=g?d>=n&&d<=r?1:d<n?[0,1]:[2,1]:d>=r?a>=e&&a<=g?2:a<e?[3,2]:[1,2]:-1},onGraphicAdd:function(){},onGraphicRemove:function(){},onGraphicNodeAdd:function(){},onGraphicNodeRemove:function(){},onGraphicDraw:function(){},onGraphicsClear:function(){},onRendererChange:function(){},onOpacityChange:function(){},setInfoTemplate:function(b){this.infoTemplate=b},add:function(b,c){if(b._graphicsLayer===
this)return b;c||this.graphics.push(b);b._graphicsLayer=this;b._layer=this;this._updateExtent(b);this._draw(b);if(!c)this.onGraphicAdd(b);return b},remove:function(b,c){if(!c){var a;if(-1===(a=l.indexOf(this.graphics,b)))return null;b=this.graphics.splice(a,1)[0]}b.getDojoShape()&&this._removeShape(b);b._shape=b._graphicsLayer=null;this.onGraphicRemove(b);return b},clear:function(b,c){for(var a=this.graphics;0<a.length;)this.remove(a[0]);if(!c)this.onGraphicsClear()},_setIEOpacity:function(b,c){var a=
b&&b.getNode();if(a){var d=b.strokeStyle,e=a.stroke;d&&e&&(e.opacity=d.color.a*c);d=b.fillStyle;e=a.fill;d&&e&&("tile"===e.type?q.set(a,"opacity",c):e.opacity=d.a*c)}},setOpacity:function(b,c){if(c||this.opacity!=b){var a=this._div;a&&(I?(l.forEach(this.graphics,function(c){this._setIEOpacity(c._shape,b);this._setIEOpacity(c._bgShape,b)},this),a._esriIeOpacity=b,this._bgGroup._esriIeOpacity=b):this._canvas?q.set(a.getEventSource(),"opacity",b):a.getEventSource().setAttribute("opacity",b));this.opacity=
b;if(!c)this.onOpacityChange(b)}},setRenderer:function(b){this.renderer=b;this._evalSDRenderer(!0);this.emit("renderer-change",{renderer:this._rndForScale||b})}});p=p([F,B],{declaredClass:"esri.layers.GraphicsLayer",constructor:function(){this.enableMouseEvents=a.hitch(this,this.enableMouseEvents);this.disableMouseEvents=a.hitch(this,this.disableMouseEvents);this._processEvent=a.hitch(this,this._processEvent);this._initLayer()},_initLayer:function(){this.loaded=!0;this.onLoad(this)},_setMap:function(){var b=
this.inherited("_setMap",arguments);this.enableMouseEvents();return b},_unsetMap:function(){this.disableMouseEvents();this.inherited("_unsetMap",arguments)},_processEvent:function(b){var c=this._map,a=b.target,d;b.screenPoint=new x(b.pageX-c.position.x,b.pageY-c.position.y);for(b.mapPoint=c.toMap(b.screenPoint);a&&!(d=a.e_graphic);)a=a.parentNode;if(d)return b.graphic=d,b},_onMouseOverHandler:function(b){if(this._processEvent(b))this.onMouseOver(b)},_onMouseMoveHandler:function(b){if(this._processEvent(b))this.onMouseMove(b)},
_onMouseDragHandler:function(b){if(this._processEvent(b))this.onMouseDrag(b)},_onMouseOutHandler:function(b){if(this._processEvent(b))this.onMouseOut(b)},_onMouseDownHandler:function(b){this._downGr=this._downPt=null;this._processEvent(b)&&(f.disconnect(this._onmousemove_connect),f.disconnect(this._onmousedrag_connect),this._onmousedrag_connect=f.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseDragHandler"),this._downGr=b.graphic,this._downPt=b.screenPoint.x+","+b.screenPoint.y,this.onMouseDown(b))},
_onMouseUpHandler:function(b){this._upGr=this._upPt=null;this._processEvent(b)&&(f.disconnect(this._onmousedrag_connect),f.disconnect(this._onmousemove_connect),this._onmousemove_connect=f.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseMoveHandler"),this._upGr=b.graphic,this._upPt=b.screenPoint.x+","+b.screenPoint.y,this.onMouseUp(b))},_onClickHandler:function(b){if(this._processEvent(b)){var c=this._downGr,a=this._upGr;c&&(a&&c===a&&this._downPt===this._upPt)&&(I&&(r._ieGraphic=b.graphic),
this.onClick(b))}},_onDblClickHandler:function(b){if(this._processEvent(b))this.onDblClick(b)},onMouseOver:function(){},onMouseMove:function(){},onMouseDrag:function(){},onMouseOut:function(){},onMouseDown:function(){},onMouseUp:function(){},onClick:function(){},onDblClick:function(){},enableMouseEvents:function(){if(!this._mouseEvents){var b=f.connect,c=this._div.getEventSource();H||(this._onmouseover_connect=b(c,"onmouseover",this,"_onMouseOverHandler"),this._onmousemove_connect=b(c,"onmousemove",
this,"_onMouseMoveHandler"),this._onmouseout_connect=b(c,"onmouseout",this,"_onMouseOutHandler"),this._onmousedown_connect=b(c,"onmousedown",this,"_onMouseDownHandler"),this._onmouseup_connect=b(c,"onmouseup",this,"_onMouseUpHandler"),this._onclick_connect=b(c,"onclick",this,"_onClickHandler"),this._ondblclick_connect=b(c,"ondblclick",this,"_onDblClickHandler"));this._mouseEvents=!0}},disableMouseEvents:function(){if(this._mouseEvents){var b=f.disconnect;b(this._onmouseover_connect);b(this._onmousemove_connect);
b(this._onmousedrag_connect);b(this._onmouseout_connect);b(this._onmousedown_connect);b(this._onmouseup_connect);b(this._onclick_connect);b(this._ondblclick_connect);this._mouseEvents=!1}}});p._GraphicsContainer=v;p._GraphicsLayer=F;return p})},"dojox/gfx":function(){define(["dojo/_base/lang","./gfx/_base","./gfx/renderer!"],function(p,f,a){f.switchTo(a);return f})},"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/_base/config"],function(p,
f,a,l,k){var h=null;a.add("vml",function(a,f,g){g.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';a="adj"in g.firstChild;g.innerHTML="";return a});return{load:function(q,m,g){function e(){m(["dojox/gfx/"+c],function(a){p.renderer=c;h=a;g(a)})}if(h&&"force"!=q)g(h);else{var c=k.forceGfxRenderer;q=!c&&(f.isString(k.gfxRenderer)?k.gfxRenderer:"svg,vml,canvas,silverlight").split(",");for(var d,r;!c&&q.length;)switch(q.shift()){case "svg":"SVGAngle"in l.global&&(c="svg");break;case "vml":a("vml")&&(c="vml");break;
case "silverlight":try{a("ie")?(d=new ActiveXObject("AgControl.AgControl"))&&d.IsVersionSupported("1.0")&&(r=!0):navigator.plugins["Silverlight Plug-In"]&&(r=!0)}catch(u){r=!1}finally{d=null}r&&(c="silverlight");break;case "canvas":l.global.CanvasRenderingContext2D&&(c="canvas")}"canvas"===c&&!1!==k.canvasEvents&&(c="canvasWithEvents");k.isDebug&&console.log("gfx renderer \x3d "+c);"svg"==c&&"undefined"!=typeof window.svgweb?window.svgweb.addOnLoad(e):e()}}}})},"esri/layers/gfxSniff":function(){define(["dojo/has",
"dojox/gfx"],function(p,f){p.add("esri-svg",function(){return-1!==f.renderer.toLowerCase().indexOf("svg")});return p})},"esri/layers/layer":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/connect dojo/_base/lang dojo/_base/Deferred dojo/_base/json dojo/has ../Evented ../kernel ../lang ../request ../deferredUtils ../urlUtils ../SpatialReference ../geometry/Extent".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s){var t=p([m],{declaredClass:"esri.layers.Layer",_eventMap:{error:["error"],
load:["layer"],"opacity-change":["opacity"],"update-end":["error"],"visibility-change":["visible"]},constructor:function(b,c){this._attrs={};if(b&&l.isString(b))this._url=r.urlToObject(this.url=b);else if(this.url=this._url=null,(c=c||b)&&(c.layerDefinition||c.query))c=null;this.spatialReference=new u(4326);this.initialExtent=new s(-180,-90,180,90,new u(4326));this._map=this._div=null;this.normalization=!0;c&&(c.id&&(this.id=c.id),!1===c.visible&&(this.visible=!1),e.isDefined(c.opacity)&&(this.opacity=
c.opacity),e.isDefined(c.minScale)&&this.setMinScale(c.minScale),e.isDefined(c.maxScale)&&this.setMaxScale(c.maxScale),this.attributionDataUrl=c.attributionDataUrl||"",this.hasAttributionData=!!this.attributionDataUrl,e.isDefined(c.showAttribution)&&(this.showAttribution=c.showAttribution),this.className=c.className,this.refreshInterval=c.refreshInterval||0);this._errorHandler=l.hitch(this,this._errorHandler);this.refresh=l.hitch(this,this.refresh);if(this.managedSuspension){var d=this._setMap;this._setMap=
function(b){var c=d.apply(this,arguments);this.evaluateSuspension();if(this.suspended&&!b.loaded)var e=a.connect(b,"onLoad",this,function(){a.disconnect(e);e=null;this.evaluateSuspension()});return c}}this.registerConnectEvents()},id:null,visible:!0,opacity:1,loaded:!1,loadError:null,minScale:0,maxScale:0,visibleAtMapScale:!1,suspended:!0,attributionDataUrl:"",hasAttributionData:!1,showAttribution:!0,refreshInterval:0,_errorHandler:function(b){this.loaded||(this.loadError=b);this.onError(b)},_setMap:function(b,
c,d,e){this._map=b;this._lyrZEHandle=a.connect(b,"onZoomEnd",this,this._processMapScale);if(b.loaded)this.visibleAtMapScale=this._isMapAtVisibleScale();else var g=a.connect(b,"onLoad",this,function(){a.disconnect(g);g=null;this._processMapScale()})},_unsetMap:function(b,c){a.disconnect(this._lyrZEHandle);this._toggleRT();this._map=this._lyrZEHandle=null;this._resumedOnce=void 0;this.suspended=!0},_cleanUp:function(){this._map=this._div=null},_fireUpdateStart:function(){this.updating||(this.updating=
!0,this.attr("data-updating",""),this._toggleRT(),this.onUpdateStart(),this._map&&this._map._incr())},_fireUpdateEnd:function(b,c){this.updating&&(this.updating=!1,this.attr("data-updating"),this._toggleRT(!0),this.onUpdateEnd(b,c),this._map&&this._map._decr())},_getToken:function(){var b=this._url,c=this.credential;return b&&b.query&&b.query.token||c&&c.token||void 0},_findCredential:function(){this.credential=g.id&&this._url&&g.id.findCredential(this._url.path)},_useSSL:function(){var b=this._url,
c=/^http:/i;this.url&&(this.url=this.url.replace(c,"https:"));b&&b.path&&(b.path=b.path.replace(c,"https:"))},refresh:function(){},show:function(){this.setVisibility(!0)},hide:function(){this.setVisibility(!1)},setMinScale:function(b){this.setScaleRange(b)},setMaxScale:function(b){this.setScaleRange(null,b)},setScaleRange:function(b,c){var a=e.isDefined(b),d=e.isDefined(c);this.loaded||(this._hasMin=this._hasMin||a,this._hasMax=this._hasMax||d);var g=this.minScale,r=this.maxScale;this.minScale=(a?
b:this.minScale)||0;this.maxScale=(d?c:this.maxScale)||0;if(g!==this.minScale||r!==this.maxScale)this.onScaleRangeChange(),this._processMapScale()},suspend:function(){this._suspended=!0;this.evaluateSuspension()},resume:function(){this._suspended=!1;this.evaluateSuspension()},canResume:function(){return this.loaded&&this._map&&this._map.loaded&&this.visible&&this.visibleAtMapScale&&!this._suspended},evaluateSuspension:function(){this.canResume()?this.suspended&&this._resume():this.suspended||this._suspend()},
_suspend:function(){this.suspended=!0;this.attr("data-suspended","");this._toggleRT();this.onSuspend();if(this._map)this._map.onLayerSuspend(this)},_resume:function(){this.suspended=!1;this.attr("data-suspended");var b=void 0===this._resumedOnce,c=this.className,a=this._attrs,d=this.getNode(),e;if(b){this._resumedOnce=!0;if(c&&d){var g=d.getAttribute("class")||"";RegExp("(^|\\s)"+c+"(\\s|$)","i").test(g)||d.setAttribute("class",g+((g?" ":"")+c))}if(a&&d)for(e in a)a.hasOwnProperty(e)&&d.setAttribute(e,
a[e])}this._toggleRT(!0);this.onResume({firstOccurrence:b});if(this._map)this._map.onLayerResume(this)},_processMapScale:function(){var b=this.visibleAtMapScale;this.visibleAtMapScale=this._isMapAtVisibleScale();b!==this.visibleAtMapScale&&(this.onScaleVisibilityChange(),this.evaluateSuspension())},isVisibleAtScale:function(b){return b?t.prototype._isMapAtVisibleScale.apply(this,arguments):!1},_isMapAtVisibleScale:function(b,c){if(!b&&(!this._map||!this._map.loaded))return!1;var a=this._map;b=b||
a.getScale();var d=this.minScale,e=this.maxScale,g=!d,r=!e,f;c&&(f=a.width>a.height?a.width:a.height);g||(b<=d?g=!0:c&&(g=Math.abs(d-b)/d<1/f));r||(b>=e?r=!0:c&&(r=Math.abs(e-b)/e<1/f));return g&&r},getAttributionData:function(){var b=this.attributionDataUrl,a=new k(d._dfdCanceller);this.hasAttributionData&&b?(a._pendingDfd=c({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),a._pendingDfd.then(function(b){a.callback(b)},function(b){a.errback(b)})):(b=Error("Layer does not have attribution data"),
b.log=f.isDebug,a.errback(b));return a},getResourceInfo:function(){var b=this.resourceInfo;return l.isString(b)?h.fromJson(b):l.clone(b)},getMap:function(){return this._map},getNode:function(){return this._div},attr:function(b,c){var a=this.getNode();if("data-reference"===b&&11>q("ie"))return this;a&&(null==c?a.removeAttribute(b):a.setAttribute(b,c));this._attrs&&(null==c?delete this._attrs[b]:this._attrs[b]=c);return this},setRefreshInterval:function(b){var c=this.refreshInterval;this.refreshInterval=
b;this._toggleRT();b&&!this.updating&&!this.suspended&&this._toggleRT(!0);if(c!==b)this.onRefreshIntervalChange();return this},_toggleRT:function(b){b&&this.refreshInterval?(clearTimeout(this._refreshT),this._refreshT=setTimeout(this.refresh,6E4*this.refreshInterval)):this._refreshT&&(clearTimeout(this._refreshT),this._refreshT=null)},setNormalization:function(b){this.normalization=b},setVisibility:function(b){this.visible!==b&&(this.visible=b,this.onVisibilityChange(this.visible),this.evaluateSuspension());
this.attr("data-hidden",b?null:"")},onLoad:function(){},onVisibilityChange:function(){},onScaleRangeChange:function(){},onScaleVisibilityChange:function(){},onSuspend:function(){},onResume:function(){},onUpdate:function(){},onUpdateStart:function(){},onUpdateEnd:function(){},onRefreshIntervalChange:function(){},onError:function(){}});return t})},"esri/Color":function(){define(["dojo/_base/declare","dojo/_base/Color","dojo/has","./kernel"],function(p,f,a,l){p=p([f],{declaredClass:"esri.Color"});p.toJsonColor=
function(a){return a&&[a.r,a.g,a.b,1<a.a?a.a:Math.round(255*a.a)]};p.toDojoColor=function(a){return a&&new f([a[0],a[1],a[2],a[3]/255])};l="named blendColors fromRgb fromHex fromArray fromString".split(" ");for(a=0;a<l.length;a++)p[l[a]]=f[l[a]];return p})},"esri/domUtils":function(){define(["./kernel","dojo/_base/connect","dojo/_base/lang","dojo/dom-style","dojo/has"],function(p,f,a,l,k){var h={show:function(a){if(a=h.getNode(a))a.style.display="block"},getNode:function(a){return a&&a.domNode||a},
hide:function(a){if(a=h.getNode(a))a.style.display="none"},toggle:function(a){if(a=h.getNode(a))a.style.display="none"===a.style.display?"block":"none"},documentBox:8>=k("ie")?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:window.innerWidth,h:window.innerHeight},setScrollable:function(a){if(a=this.getNode(a)){var h=0,g=0,e=0,c=0,d=0,r=0;return[f.connect(a,"ontouchstart",function(f){h=f.touches[0].screenX;g=f.touches[0].screenY;e=a.scrollWidth;c=a.scrollHeight;
d=a.clientWidth;r=a.clientHeight}),f.connect(a,"ontouchmove",function(f){f.preventDefault();var s=a.firstChild;s instanceof Text&&(s=a.childNodes[1]);var t=s._currentX||0,b=s._currentY||0,t=t+(f.touches[0].screenX-h);0<t?t=0:0>t&&Math.abs(t)+d>e&&(t=-1*(e-d));s._currentX=t;b+=f.touches[0].screenY-g;0<b?b=0:0>b&&Math.abs(b)+r>c&&(b=-1*(c-r));s._currentY=b;l.set(s,{"-webkit-transition-property":"-webkit-transform","-webkit-transform":"translate("+t+"px, "+b+"px)"});h=f.touches[0].screenX;g=f.touches[0].screenY})]}}};
return h})},"esri/symbols/MarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),function(p,f,a,l,k,h){return p(h,{declaredClass:"esri.symbol.MarkerSymbol",angle:0,xoffset:0,yoffset:0,size:12,constructor:function(a){a&&f.isObject(a)&&(this.size="auto"===this.size?this.size:l.pt2px(this.size),this.xoffset=l.pt2px(this.xoffset),this.yoffset=l.pt2px(this.yoffset),this.angle&&(this.angle*=-1))},setAngle:function(a){this.angle=a;return this},
setSize:function(a){this.size=a;return this},setOffset:function(a,f){this.xoffset=a;this.yoffset=f;return this},toJson:function(){var a=l.px2pt(this.size),a=isNaN(a)?void 0:a,h=l.px2pt(this.xoffset),h=isNaN(h)?void 0:h,g=l.px2pt(this.yoffset),g=isNaN(g)?void 0:g;return f.mixin(this.inherited("toJson",arguments),{size:"auto"===this.size?this.size:a,angle:this.angle&&-1*this.angle,xoffset:h,yoffset:g})}})})},"esri/symbols/Symbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../Color".split(" "),
function(p,f,a,l,k,h){return p(null,{declaredClass:"esri.symbol.Symbol",color:new h([0,0,0,1]),type:null,constructor:function(a){if(a&&f.isObject(a)&&(f.mixin(this,a),this.color&&k.isDefined(this.color[0])&&(this.color=h.toDojoColor(this.color)),(a=this.type)&&0===a.indexOf("esri")))this.type={esriSMS:"simplemarkersymbol",esriPMS:"picturemarkersymbol",esriSLS:"simplelinesymbol",esriCLS:"cartographiclinesymbol",esriSFS:"simplefillsymbol",esriPFS:"picturefillsymbol",esriTS:"textsymbol",esriSHD:"shieldlabelsymbol"}[a]},
setColor:function(a){this.color=a;return this},toJson:function(){return{color:h.toJsonColor(this.color)}}})})},"esri/symbols/SimpleMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./MarkerSymbol ./SimpleLineSymbol".split(" "),function(p,f,a,l,k,h,q,m,g){var e={STYLE_CIRCLE:"circle",STYLE_SQUARE:"square",STYLE_CROSS:"cross",STYLE_X:"x",STYLE_DIAMOND:"diamond",STYLE_PATH:"path",STYLE_TARGET:"target"},c={style:e.STYLE_CIRCLE,
color:[255,255,255,0.25],size:12,angle:0,xoffset:0,yoffset:0};p=p(m,{declaredClass:"esri.symbol.SimpleMarkerSymbol",type:"simplemarkersymbol",_styles:{circle:"esriSMSCircle",square:"esriSMSSquare",cross:"esriSMSCross",x:"esriSMSX",diamond:"esriSMSDiamond",path:"esriSMSPath"},constructor:function(d,r,h,s){d?f.isString(d)?(this.style=d,r&&(this.size=r),h&&(this.outline=h),s&&(this.color=s)):(this.style=q.valueOf(this._styles,this.style),d.outline&&(this.outline=new g(d.outline))):(f.mixin(this,c),this.size=
k.pt2px(this.size),this.outline=new g(this.outline),this.color=new a(this.color));this.style||(this.style=e.STYLE_CIRCLE)},setStyle:function(c){this.style=c;return this},setPath:function(c){this.path=c;this.setStyle(e.STYLE_PATH);return this},setOutline:function(c){this.outline=c;return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return this.color},_setDim:function(c,a,e){this._targetWidth=c;this._targetHeight=a;this._spikeSize=e},getShapeDescriptors:function(){var a,
g,f,s=this.style,t=(this.size||k.pt2px(c.size))/2,b=0-t,h=0+t,n=0-t,w=0+t;switch(s){case e.STYLE_CIRCLE:a={type:"circle",cx:0,cy:0,r:t};g=this.getFill();if(f=this.getStroke())f.style=f.style||"Solid";break;case e.STYLE_CROSS:a={type:"path",path:"M "+b+",0 L "+h+",0 M 0,"+n+" L 0,"+w+" E"};g=null;f=this.getStroke();break;case e.STYLE_DIAMOND:a={type:"path",path:"M "+b+",0 L 0,"+n+" L "+h+",0 L 0,"+w+" L "+b+",0 Z"};g=this.getFill();f=this.getStroke();break;case e.STYLE_SQUARE:a={type:"path",path:"M "+
b+","+w+" L "+b+","+n+" L "+h+","+n+" L "+h+","+w+" L "+b+","+w+" Z"};g=this.getFill();f=this.getStroke();break;case e.STYLE_X:a={type:"path",path:"M "+b+","+w+" L "+h+","+n+" M "+b+","+n+" L "+h+","+w+" E"};g=null;f=this.getStroke();break;case e.STYLE_PATH:a={type:"path",path:this.path||""},g=this.getFill(),f=this.getStroke()}return{defaultShape:a,fill:g,stroke:f}},toJson:function(){var c=f.mixin(this.inherited("toJson",arguments),{type:"esriSMS",style:this._styles[this.style]}),a=this.outline;a&&
(c.outline=a.toJson());c.path=this.path;return q.fixJson(c)}});f.mixin(p,e);p.defaultProps=c;return p})},"esri/symbols/SimpleLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./LineSymbol".split(" "),function(p,f,a,l,k,h,q,m){var g={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",STYLE_NULL:"none",STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",
STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot"},e={color:[0,0,0,1],style:g.STYLE_SOLID,width:1};p=p(m,{declaredClass:"esri.symbol.SimpleLineSymbol",type:"simplelinesymbol",_styles:{solid:"esriSLSSolid",dash:"esriSLSDash",dot:"esriSLSDot",dashdot:"esriSLSDashDot",longdashdotdot:"esriSLSDashDotDot",none:"esriSLSNull",insideframe:"esriSLSInsideFrame",shortdash:"esriSLSShortDash",shortdot:"esriSLSShortDot",shortdashdot:"esriSLSShortDashDot",shortdashdotdot:"esriSLSShortDashDotDot",
longdash:"esriSLSLongDash",longdashdot:"esriSLSLongDashDot"},constructor:function(c,d,r){c?f.isString(c)?(this.style=c,d&&(this.color=d),r&&(this.width=r)):this.style=q.valueOf(this._styles,c.style)||g.STYLE_SOLID:(f.mixin(this,e),this.color=new a(this.color),this.width=k.pt2px(this.width))},setStyle:function(c){this.style=c;return this},getStroke:function(){return this.style===g.STYLE_NULL||0===this.width?null:{color:this.color,style:this.style,width:this.width}},getFill:function(){return null},
getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},fill:null,stroke:this.getStroke()}},toJson:function(){return q.fixJson(f.mixin(this.inherited("toJson",arguments),{type:"esriSLS",style:this._styles[this.style]}))}});f.mixin(p,g);p.defaultProps=e;return p})},"esri/symbols/LineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),function(p,f,a,l,k,h){return p(h,{declaredClass:"esri.symbol.LineSymbol",
constructor:function(a){f.isObject(a)?this.width=l.pt2px(this.width):this.width=12},setWidth:function(a){this.width=a;return this},toJson:function(){var a=l.px2pt(this.width),a=isNaN(a)?void 0:a;return f.mixin(this.inherited("toJson",arguments),{width:a})}})})},"esri/layers/TileInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../SpatialReference ../geometry/Point ./LOD".split(" "),function(p,f,a,l,k,h,q,m,g){return p(null,{declaredClass:"esri.layers.TileInfo",
constructor:function(e){f.mixin(this,e);this.width=this.cols;this.height=this.rows;e=this.spatialReference;var c=this.origin;e&&(e=this.spatialReference=new q(e.toJson?e.toJson():e));c&&(this.origin=new m(c.toJson?c.toJson():c),!c.spatialReference&&e&&this.origin.setSpatialReference(new q(e.toJson())));this.lods=a.map(this.lods,function(c){return new g(c)})},toJson:function(){return h.fixJson({rows:this.rows,cols:this.cols,dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,
origin:this.origin&&this.origin.toJson(),spatialReference:this.spatialReference&&this.spatialReference.toJson(),lods:this.lods&&a.map(this.lods,function(a){return a.toJson()})})}})})},"esri/layers/LOD":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(p,f,a,l,k){return p(null,{declaredClass:"esri.layers.LOD",constructor:function(a){f.mixin(this,a)},toJson:function(){return k.fixJson({level:this.level,levelValue:this.levelValue,resolution:this.resolution,
scale:this.scale})}})})},"esri/layers/ArcGISTiledMapServiceLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has dojo/io-query ../kernel ../urlUtils ../SpatialReference ./TiledMapServiceLayer ./ArcGISMapServiceLayer ./TileInfo ./TimeInfo ./TileMap".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s){return f([c,d],{declaredClass:"esri.layers.ArcGISTiledMapServiceLayer",_agolAttrs:"Canvas/World_Dark_Gray_Base Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Base Canvas/World_Light_Gray_Reference Elevation/World_Hillshade Ocean/World_Ocean_Base Ocean/World_Ocean_Reference Ocean_Basemap Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Transportation World_Imagery World_Street_Map World_Topo_Map".split(" "),
_isReference:!1,_referenceLayers:"Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Reference Ocean/World_Ocean_Reference Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Reference_Overlay Reference/World_Transportation".split(" "),constructor:function(c,b){b&&(b.roundrobin&&(p.deprecated(this.declaredClass+" : Constructor option 'roundrobin' deprecated. Use option 'tileServers'."),b.tileServers=b.roundrobin),this._setTileServers(b.tileServers),
this._loadCallback=b.loadCallback);this._params=a.mixin({},this._url.query);this._initLayer=a.hitch(this,this._initLayer);var d=b&&b.resourceInfo;d?this._initLayer(d):(this._load=a.hitch(this,this._load),this._load())},_TILE_FORMATS:{PNG:"png",PNG8:"png",PNG24:"png",PNG32:"png",JPG:"jpg",JPEG:"jpg",GIF:"gif"},_setTileServers:function(c){if(c&&0<c.length){this.tileServers=c;var b,a=c.length;for(b=0;b<a;b++)c[b]=g.urlToObject(c[b]).path}},_initLayer:function(c,b){this.inherited(arguments);this.resourceInfo=
k.toJson(c);this.tileInfo=new r(c.tileInfo);!1!==this.resampling&&(c.capabilities&&-1<c.capabilities.indexOf("Tilemap")?(this.resampling=!0,this.tileMap=new s(this)):this.resampling=!!c.resampling);!this.spatialReference&&this.tileInfo.spatialReference&&(this.spatialReference=new e(this.tileInfo.spatialReference.toJson()));this.isPNG32="PNG24"===this.tileInfo.format||"PNG32"===this.tileInfo.format;c.timeInfo&&(this.timeInfo=new u(c.timeInfo));var a=this._url.path,d=this._loadCallback,g="file:"===
window.location.protocol?"https:":window.location.protocol,f=a.match(/^https?\:\/\/(server|services)\.arcgisonline\.com\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i),f=f&&f[2];if(!this.tileServers)if(c.tileServers)this._setTileServers(c.tileServers);else{var h=-1!==a.search(/^https?\:\/\/server\.arcgisonline\.com/i),m=-1!==a.search(/^https?\:\/\/services\.arcgisonline\.com/i);if(h||m)this._setTileServers([a,a.replace(h?/server\.arcgisonline/i:/services\.arcgisonline/i,h?"services.arcgisonline":
"server.arcgisonline")])}if(f){f=f.toLowerCase();for(a=0;a<this._agolAttrs.length;a++)if(h=this._agolAttrs[a],h.toLowerCase()===f){this.hasAttributionData=!0;this.attributionDataUrl=this.attributionDataUrl||g+"//static.arcgis.com/attribution/"+h;break}for(a=0;a<this._referenceLayers.length;a++)if(h=this._referenceLayers[a],h.toLowerCase()===f){this._isReference=!0;break}}this.loaded=!0;this.onLoad(this);d&&(delete this._loadCallback,d(this))},getTileUrl:function(c,b,a){var d=this.tileServers,e=this._getToken(),
r=this._url.query;c=(d?d[b%d.length]:this._url.path)+"/tile/"+c+"/"+b+"/"+a;this.resampling&&!this.tileMap&&(c+="?blankTile\x3dfalse");r&&(c=this.resampling&&!this.tileMap?c+("\x26"+q.objectToQuery(r)):c+("?"+q.objectToQuery(r)));if(e&&(!r||!r.token))c+=(-1===c.indexOf("?")?"?":"\x26")+"token\x3d"+e;c=this.addTimestampToURL(c);return g.addProxy(c)}})})},"esri/layers/TiledMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/url dojo/dom-construct dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/dom dojox/collections/ArrayList dojox/gfx/matrix ../kernel ../config ../sniff ../domUtils ../tileUtils ../geometry/Point ../geometry/Rect ../geometry/Extent ./layer".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x){return p(x,{declaredClass:"esri.layers.TiledMapServiceLayer",constructor:function(b,c){f.connect(this,"onLoad",this,"_initTiledLayer");this._lowestLevel=(this._displayLevels=c?c.displayLevels:null)?this._displayLevels[0]:0;this.resampling=c?c.resampling:void 0;this._resamplingTolerance=c?c.resamplingTolerance:null;this.exclusionAreas=c?c.exclusionAreas:null;var d=a.hitch;this._addImage=d(this,this._addImage);this._tileLoadHandler=d(this,this._tileLoadHandler);
this._tileErrorHandler=d(this,this._tileErrorHandler);this._popTile=d(this,this._popTile);this._cleanUpRemovedImages=d(this,this._cleanUpRemovedImages);this._fireOnUpdateEvent=d(this,this._fireOnUpdateEvent);this._transitionEnd=d(this,this._transitionEnd);this._tileMapCallback=d(this,this._tileMapCallback)},opacity:1,isPNG32:!1,_multiple:1,isResampling:!1,_initTiledLayer:function(){var c=this.tileInfo,a=c.lods;this.resampling=null!=this.resampling?this.resampling:!1;this._tileW=c.width;this._tileH=
c.height;var d=this.scales=[],e=this._displayLevels,n=-Infinity,g=Infinity,r=this.fullExtent,f=new v(r.xmin,r.ymax),r=new v(r.xmax,r.ymin),t=b.getContainingTileCoords,h,u,w,k=a.length;for(w=0;w<k;w++)if(u=a[w],h=t(c,f,u),u.startTileRow=0>h.row?0:h.row,u.startTileCol=0>h.col?0:h.col,h=t(c,r,u),u.endTileRow=h.row,u.endTileCol=h.col,!e||-1!==l.indexOf(e,u.level))d[w]=u.scale,n=u.scale>n?u.scale:n,g=u.scale<g?u.scale:g;-Infinity!==n&&!this._hasMin&&this.setMinScale(n);Infinity!==g&&!this._hasMax&&this.setMaxScale(g);
this.setExclusionAreas(this.exclusionAreas);this._patchIE=6<=s("ie")&&7>s("ie")&&(this.isPNG32||"Mixed"===c.format)},isVisibleAtScale:function(b){return b?x.prototype._isMapAtVisibleScale.call(this,b,!0):!1},_isMapAtVisibleScale:function(b){var c=this.inherited(arguments,[b,!0]);if(c){var a;a=this._map;var c=this.scales,d=a.getScale(),e=!1,n=a.width>a.height?a.width:a.height;for(a=0;a<c.length;a++)if(Math.abs(c[a]-d)/c[a]<1/n){e=!0;break}c=e}return c},_setMap:function(c,a,d,e){this.inherited(arguments);
this._map=c;var n=this._div=h.create("div",null,a),s=c.__visibleDelta,t=f.connect,v=r._css.names,w={position:"absolute",width:c.width+"px",height:c.height+"px",overflow:"visible"},k=u.defaults.map.zoomDuration;"css-transforms"===c.navigationMode?(w[v.transform]=r._css.translate(-s.x,-s.y),g.set(n,w),delete w[v.transform],w[v.transition]=v.transformName+" "+k+"ms ease",g.set(this._active=h.create("div",null,n),w),this._active._remove=0,this._passives=[]):(w.left=-s.x+"px",w.top=-s.y+"px",g.set(n,w));
this._onResizeHandler_connect=t(c,"onResize",this,"_onResizeHandler");this._opacityChangeHandler_connect=t(this,"onOpacityChange",this,"_opacityChangeHandler");s=this.tileInfo;t=s.spatialReference;v=t._getInfo();(this._wrap=c.wrapAround180&&t._isWrappable()&&Math.abs(v.origin[0]-s.origin.x)<=v.dx)&&b._addFrameInfo(s,v);this.setExclusionAreas(this.exclusionAreas);this.evaluateSuspension();if(this.suspended&&!c.loaded)var m=f.connect(c,"onLoad",this,function(){f.disconnect(m);m=null;this.setExclusionAreas(this.exclusionAreas);
this.evaluateSuspension()});return n},_unsetMap:function(b,c){this.suspended||this._suspendImpl();h.destroy(this._div);this._map=this._div=null;var a=f.disconnect;a(this._onResizeHandler_connect);a(this._opacityChangeHandler_connect);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);this._suspendImpl()},_suspendImpl:function(){t.hide(this._div);clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();var b=this._tiles,c=this._tileIds,a=this._loadingList,
d,e,n=f.disconnect,g=h.destroy;a&&0<a.count&&(a.forEach(function(c){if(d=b[c])n(d._onload_connect),n(d._onerror_connect),n(d._onabort_connect),d._onload_connect=d._onerror_connect=d._onabort_connect=null}),a.clear(),this._fireUpdateEnd());this._removeList.clear();for(a=c.length-1;0<=a;a--)(d=(e=c[a])&&b[e])&&g(d);if("css-transforms"===this._map.navigationMode){c=this._active;e=this._passives;var r;this._noDom=0;for(a=e.length-1;0<=a;a--)r=e[a],r._endHandle&&n(r._endHandle),r._matrix=r._multiply=r._endHandle=
null,r._marked=r._remove=0,e.splice(a,1),g(r);c._matrix=c._multiply=null;c._marked=c._remove=0}this._tileIds=this._tiles=this._tileBounds=this._ct=this._loadingList=this._removeList=this._standby=null},onResume:function(){this.inherited(arguments);this._tileIds=[];this._tiles=[];this._tileBounds=[];this._ct=null;this._removeList=new c;this._loadingList=new c;t.show(this._div);this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(a.hitch(this,function(){this.suspended||this._onExtentChangeHandler(this._map.extent,
null,!0,this._map.__LOD)}),0)},_enableDrawConnectors:function(){var b=this._map,c=f.connect;if("css-transforms"===b.navigationMode){if(this._onScaleHandler_connect=c(b,"onScale",this,this._onScaleHandler),s("esri-mobile")){this._standby=[];var a=this,d=function(){a._noDom=1};this._onPanStartHandler_connect=c(b,"onPanStart",d);this._onZoomStartHandler_connect=c(b,"onZoomStart",d)}}else this._onZoomHandler_connect=c(b,"onZoom",this,"_onZoomHandler");this._onPanHandler_connect=c(b,"onPan",this,"_onPanHandler");
this._onExtentChangeHandler_connect=c(b,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var b=f.disconnect;b(this._onPanHandler_connect);b(this._onZoomHandler_connect);b(this._onScaleHandler_connect);b(this._onExtentChangeHandler_connect);b(this._onPanStartHandler_connect);b(this._onZoomStartHandler_connect);this._onPanHandler_connect=this._onZoomHandler_connect=this._onScaleHandler_connect=this._onExtentChangeHandler_connect=this._onPanStartHandler_connect=this._onZoomStartHandler_connect=
null},_onResizeHandler:function(b,c,a){b={width:c+"px",height:a+"px"};c=g.set;c(this._div,b);if("css-transforms"===this._map.navigationMode){this._active&&c(this._active,b);for(a=this._passives.length-1;0<=a;a--)c(this._passives[a],b)}},_onExtentChangeHandler:function(c,a,e,f){a=this._map;var s=this._standby,t;clearTimeout(this._wakeTimer);this._wakeTimer=null;if(!a._isPanningOrZooming()){if("css-transforms"===a.navigationMode){if(e)for(f=this._passives.length-1;0<=f;f--)t=this._passives[f],g.set(t,
r._css.names.transition,"none"),t._marked?(this._passives.splice(f,1),t.parentNode&&t.parentNode.removeChild(t),h.destroy(t)):0<t.childNodes.length&&(t._multiply=t._multiply?d.multiply(t._matrix,t._multiply):t._matrix);this._noDom=0;if(s&&s.length)for(f=s.length-1;0<=f;f--)t=s[f],g.set(t,"visibility","inherit"),this._popTile(t),s.splice(f,1)}this._fireUpdateStart();this._rrIndex=0;f=b.getCandidateTileInfo(a,this.tileInfo,c);c=a.__visibleDelta;if(!this._ct||f.lod.level!==this._ct.lod.level||e){t=f&&
this._ct&&f.lod.level!==this._ct.lod.level;this._ct=f;var u=this._tiles,v=this._tileIds,w=this._tileBounds,k=this._removeList,q,l=v.length;this._cleanUpRemovedImages();for(f=0;f<l;f++)s=v[f],q=u[s],w[s]=v[f]=null,"css-transforms"===a.navigationMode&&(t&&q.parentNode&&a.fadeOnZoom)&&(q._fadeOut=t,q.parentNode._remove++),k.add(q);e&&(this._tileIds=[],this._tiles=[],this._tileBounds=[])}f=c.x;e=c.y;"css-transforms"===a.navigationMode?(s={},s[r._css.names.transform]=r._css.translate(f,e),g.set(this._div,
s)):g.set(this._div,{left:f+"px",top:e+"px"});this.__coords_dx=f;this.__coords_dy=e;this._updateImages(new n(0,0,c.width,c.height));0===this._loadingList.count?(this._cleanUpRemovedImages(),this.onUpdate(),this._fireUpdateEnd()):this._fireOnUpdate=!0;e=this._tileW;u=this._tileH;c=new n(-c.x,-c.y,c.width,c.height);for(f=this._tileIds.length-1;0<=f;f--)(s=this._tileIds[f])?(t=this._tiles[s],v=m.getMarginBox(t),v=new n(v.l,v.t,e,u),"css-transforms"===a.navigationMode&&(v.x=t._left,v.y=t._top),c.intersects(v)?
this._tileBounds[s]=v:(this._loadingList.contains(s)&&this._popTile(t),h.destroy(t),this._tileIds.splice(f,1),delete this._tileBounds[s],delete this._tiles[s])):(this._tileIds.splice(f,1),delete this._tileBounds[s],delete this._tiles[s])}},_onPanHandler:function(b,c){var a=this._map,d=a.__visibleDelta.offset(c.x,c.y);this.__coords_dx=this.__coords_dy=0;"css-transforms"===a.navigationMode?(a={},a[r._css.names.transform]=r._css.translate(d.x,d.y),g.set(this._div,a),s("esri-mobile")||this._updateImages({x:-d.x,
y:-d.y,width:d.width,height:d.height})):(g.set(this._div,{left:d.x+"px",top:d.y+"px"}),this._updateImages({x:-d.x,y:-d.y,width:d.width,height:d.height}));0<this._loadingList.count&&(this._fireUpdateStart(),this._fireOnUpdate=!0)},_onScaleHandler:function(b,c){var a,e={},n=r._css.names,f=this._map,s=u.defaults.map.zoomDuration;for(a=this._passives.length-1;0<=a;a--){var t=this._passives[a];0===t.childNodes.length?(this._passives.splice(a,1),h.destroy(t)):("none"===t.style[n.transition]&&g.set(t,n.transition,
n.transformName+" "+s+"ms ease"),g.set(t,n.transition,c?"none":n.transformName+" "+s+"ms ease"),t._matrix=b,e[n.transform]=r._css.matrix(t._multiply?d.multiply(b,t._multiply):b),g.set(t,e))}this._active&&0===this._active.childNodes.length||(g.set(this._active,n.transition,c?"none":n.transformName+" "+s+"ms ease"),this._active._matrix=b,e[n.transform]=r._css.matrix(this._active._matrix),g.set(this._active,e),this._passives.push(this._active),e={position:"absolute",width:f.width+"px",height:f.height+
"px",overflow:"visible"},e[n.transition]=n.transformName+" "+s+"ms ease",g.set(this._active=h.create("div",null,this._div),e),this._active._remove=0,f.fadeOnZoom&&h.place(this._active,this._div,"first"))},_onZoomHandler:function(b,c,a){b=m.getMarginBox(this._div);a=a.offset(-b.l,-b.t);if(!this._previousScale||1===c)this._previousScale=1;var d,e=this._tileW*c,n=this._tileH*c,r=this._tileBounds,f=this._tiles,t=this._previousScale,h=this._multiple,u=g.set,v,w;if((b=s("ie"))&&8>b)l.forEach(this._tileIds,
function(b){w="";d=r[b];v=f[b].style.margin.split(" ");l.forEach(v,function(b){""!==w&&(w+=" ");b=parseFloat(b);w+=b/t*c+"px"});u(f[b],{left:d.x-(e-d.width)*(a.x-d.x)/d.width+"px",top:d.y-(n-d.height)*(a.y-d.y)/d.height+"px",margin:1!==h&&-1===w.indexOf("NaN")?w:"",zoom:c})});else{var k=e*h,q=n*h,x,p;l.forEach(this._tileIds,function(b){w="";d=r[b];x=d.x-(e-d.width)*(a.x-d.x)/d.width;p=d.y-(n-d.height)*(a.y-d.y)/d.height;v=f[b].style.margin.split(" ");l.forEach(v,function(b){""!==w&&(w+=" ");b=parseFloat(b);
w+=b/t*c+"px"});u(f[b],{left:x+"px",top:p+"px",margin:1!==h&&-1===w.indexOf("NaN")?w:"",width:k+"px",height:q+"px"})})}this._previousScale=c},_updateImages:function(b){if(this._ct){var c,a=this._tileW,d=this._tileH,e=this._ct;c=e.lod;var e=e.tile,n=e.offsets,g=e.coords,r=g.row,g=g.col,f=c.level,s=this.opacity,t=this._tileIds,h=this._loadingList,u=this._addImage,v=this._map.id,w=this.id,k=b.x,m=b.y,q=c.startTileRow,x=c.endTileRow,p=c.startTileCol,Y=c.endTileCol,la=l.indexOf,aa,ga,qa=n.x-this.__coords_dx,
za=n.y-this.__coords_dy;ga=a-qa+-b.x;var ia=d-za+-b.y;aa=Math.ceil;ga=0<ga?ga%a:a-Math.abs(ga)%a;ia=0<ia?ia%d:d-Math.abs(ia)%d;k=0<k?Math.floor((k+qa)/a):aa((k-(a-qa))/a);m=0<m?Math.floor((m+za)/d):aa((m-(d-za))/d);za=k+aa((b.width-ga)/a);b=m+aa((b.height-ia)/d);var oa,xa,sa;this._wrap&&(oa=c._frameInfo,xa=oa[0],sa=oa[1],oa=oa[2]);for(ia=k;ia<=za;ia++)for(k=m;k<=b;k++)aa=r+k,ga=g+ia,this._wrap&&(ga<sa?(ga%=xa,ga=ga<sa?ga+xa:ga):ga>oa&&(ga%=xa)),!this._isExcluded(f,aa,ga)&&(aa>=q&&aa<=x&&ga>=p&&ga<=
Y)&&(c=v+"_"+w+"_tile_"+f+"_"+k+"_"+ia,-1===la(t,c)&&(h.add(c),t.push(c),u(f,k,aa,ia,ga,c,a,d,s,e,n)))}},_cleanUpRemovedImages:function(){var b=this._removeList,c=h.destroy,a,d=r._css.names;b.forEach(function(b){b._fadeOut||(b.style.filter="",b.style.zoom=1,c(b))});if("css-transforms"===this._map.navigationMode)for(a=this._passives.length-1;0<=a;a--){var e=this._passives[a];0===e.childNodes.length?(this._passives.splice(a,1),c(e)):this._map.fadeOnZoom&&(!e._marked&&e._remove===e.childNodes.length)&&
(e._marked=1,2048>r._css.getScaleFromMatrix(g.get(e,d.transform))?(g.set(e,d.transition,"opacity 0.65s"),g.set(e,"opacity",0),f.disconnect(e._endHandle),e._endHandle=f.connect(e,d.endEvent,this._transitionEnd)):this._transitionEnd({propertyName:"opacity",target:e}))}b.clear()},_transitionEnd:function(b){var c=b.target;"opacity"===b.propertyName&&(f.disconnect(c._endHandle),c._endHandle=null,b=l.indexOf(this._passives,c),-1<b&&this._passives.splice(b,1),c.parentNode&&c.parentNode.removeChild(c),h.destroy(c))},
_addImage:function(b,c,d,e,n,s,t,u,v,w,k){if(this._patchIE)w=this._tiles[s]=h.create("div"),w.id=s,q.add(w,"layerTile"),g.set(w,{left:t*e-k.x+"px",top:u*c-k.y+"px",width:t+"px",height:u+"px",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+this.getTileUrl(b,d,n)+"', sizingMethod\x3d'scale')"}),1>v&&g.set(w,"opacity",v),b=w.appendChild(h.create("div")),g.set(b,{opacity:0,width:t+"px",height:u+"px"}),this._div.appendChild(w),this._loadingList.remove(s),this._fireOnUpdateEvent();
else{w=this._tiles[s]=h.create("img");var m=f.connect;w.id=s;w.alt="";q.add(w,"layerTile");e=t*e-k.x;k=u*c-k.y;c=this._map;var l=r._css.names;t={width:t+"px",height:u+"px",visibility:"hidden"};"css-transforms"===c.navigationMode?(t[l.transform]=r._css.translate(e,k),g.set(w,t),w._left=e,w._top=k):(t.left=e+"px",t.top=k+"px",g.set(w,t));1>v&&g.set(w,"opacity",v);w._onload_connect=m(w,"onload",this,"_tileLoadHandler");w._onerror_connect=m(w,"onerror",a.hitch(this,"_tileErrorHandler",d,n));w._onabort_connect=
m(w,"onabort",this,"_tileAbortHandler");if(this.tileMap)this.tileMap.getTile(b,d,n,s,this._tileMapCallback);else if(s=this.getTileUrl(b,d,n,w))this._failedRequests&&this._failedRequests[s]?(g.set(w,this._failedRequests[s].css),w.src=this._failedRequests[s].src,this._multiple=parseInt(this._failedRequests[s].css.width)/this._tileW,this.isResampling=1!==this._multiple):(this._multiple=1,this.isResampling=!1,w.src=s);"css-transforms"===c.navigationMode?this._active.appendChild(w):this._div.appendChild(w)}},
_tileMapCallback:function(b,c){var a,d;this.suspended||((d=this._tiles[c.id]||e.byId(c.id))?(this._multiple=2*(c.level-b.level)||1,this.isResampling=1!==this._multiple,a=this.tileMap.style(b,c),g.set(d,a),d.src=this.getTileUrl(b.level,b.row,b.col)):this._popTile(c))},getTileUrl:function(b,c,a){},_reCheckTS:/[\?\&]_ts=/ig,_reReplaceTS:/([\?\&]_ts=)[0-9]+/ig,addTimestampToURL:function(b){var c=this._refreshTS;c&&(b=this._reCheckTS.test(b)?b.replace(this._reReplaceTS,"$$$1"+c):b+((-1===b.indexOf("?")?
"?":"\x26")+"_ts\x3d"+c));return b},refresh:function(){this.suspended||(this._refreshTS=(new Date).getTime(),this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD))},_popTile:function(b){var c=f.disconnect;c(b._onload_connect);c(b._onerror_connect);c(b._onabort_connect);b._onload_connect=b._onerror_connect=b._onabort_connect=null;this._loadingList.remove(b.id);this._fireOnUpdateEvent()},_tileLoadHandler:function(b){b=b.currentTarget;this._noDom?this._standby.push(b):(g.set(b,"visibility",
"inherit"),this._popTile(b))},_tileAbortHandler:function(b){b=b.currentTarget;this.onError(Error("Unable to load tile: "+b.src));g.set(b,"visibility","hidden");this._popTile(b)},_tileErrorHandler:function(b,c,a){a=a.currentTarget;var d,e,n=!0;if(this.tileMap||!this.resampling)n=!1;else if(d=new k(a.src),d=d.path.split("/"),d=parseInt(d[d.length-3]),e=this._ct.lod.level-d+1,this._multiple=Math.pow(2,e),d===this._lowestLevel||0===this._resamplingTolerance||this._resamplingTolerance&&Math.log(this._multiple)/
Math.LN2>this._resamplingTolerance)n=!1;n?(this.isResampling=!0,this._resample(a,b,c)):(this.onError(Error("Unable to load tile: "+a.src)),g.set(a,"visibility","hidden"),this._popTile(a))},_resample:function(b,c,a){var d=(new k(b.src)).path.split("/"),e=this._multiple,n=parseInt(d[d.length-3])-1,r=parseInt(c/e),f=parseInt(a/e),d=a%e,t=c%e,r=this.getTileUrl(n,r,f);c=this.getTileUrl(n+Math.log(e)/Math.LN2,c,a);e={width:this._tileW*e+"px",height:this._tileH*e+"px",margin:"-"+this._tileW*t+"px 0 0 "+
("-"+this._tileH*d+"px")};this._failedRequests||(this._failedRequests={});this._failedRequests[c]={src:r,css:e};g.set(b,e);s("chrome")&&b.setAttribute("src",null);b.src=r},_fireOnUpdateEvent:function(){0===this._loadingList.count&&(this._cleanUpRemovedImages(),this._fireOnUpdate&&(this._fireOnUpdate=!1,this.onUpdate(),this._fireUpdateEnd()))},setOpacity:function(b){if(this.opacity!=b)this.onOpacityChange(this.opacity=b)},onOpacityChange:function(){},_opacityChangeHandler:function(b){var c=g.set,a,
d,e;if("css-transforms"===this._map.navigationMode){if(this._active){e=this._active.childNodes;for(a=e.length-1;0<=a;a--)c(e[a],"opacity",b)}for(a=this._passives.length-1;0<=a;a--){e=this._passives[a].childNodes;for(d=e.length-1;0<=d;d--)c(e[d],"opacity",b)}}else{e=this._div.childNodes;for(a=e.length-1;0<=a;a--)c(e[a],"opacity",b)}},setExclusionAreas:function(b){this.exclusionAreas=b;if(this.loaded&&this._map&&this._map.loaded){var c=this._map.spatialReference,a=this.tileInfo,d=a.origin,e=a.lods,
n=e[0].level,g=e[e.length-1].level,r,f,s,t,h,u,k,m,q;if(!this.exclusionAreas||!this.exclusionAreas.length)this._exclusionsPerZoom=null;else{this._exclusionsPerZoom=[];f=0;for(s=b.length;f<s;f++)if(r=b[f],(q=r.geometry)&&"extent"===q.type&&q.xmin<=q.xmax&&q.ymin<=q.ymax){if(!c.equals(q.spatialReference))if(c._canProject(q.spatialReference))c.isWebMercator()?(m=v.lngLatToXY(q.xmin,q.ymin),q=v.lngLatToXY(q.xmax,q.ymax)):(m=v.xyToLngLat(q.xmin,q.ymin,!0),q=v.xyToLngLat(q.xmax,q.ymax,!0)),q=new w(m[0],
m[1],q[0],q[1],c);else continue;k=-1;if(r.minZoom&&-1!==r.minZoom)k=r.minZoom;else if(r.minScale&&-1!==r.minScale){t=0;for(h=e.length;t<h;t++)if(e[t].scale<=r.minScale){k=e[t].level;break}}k=Math.max(k,n);m=-1;if(r.maxZoom&&-1!==r.maxZoom)m=r.maxZoom;else if(r.maxScale&&-1!==r.maxScale){t=0;for(h=e.length;t<h;t++)if(e[t].scale<r.maxScale){m=e[t-1].level;break}else if(e[t].scale===r.maxScale){m=e[t].level;break}}m=-1===m?g:Math.min(m,g);for(r=k;r<=m;r++){t=0;for(h=e.length;t<h;t++)if(e[t].level===
r){u=e[t];break}u&&(this._exclusionsPerZoom[r]||(this._exclusionsPerZoom[r]=[]),t=1/u.resolution/a.rows,h=1/u.resolution/a.cols,this._exclusionsPerZoom[r].push({rowFrom:Math.floor((d.y-q.ymax)*t),rowTo:Math.ceil((d.y-q.ymin)*t),colFrom:Math.floor((q.xmin-d.x)*h),colTo:Math.ceil((q.xmax-d.x)*h)}))}}}this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD)}},_isExcluded:function(b,c,a){var d,e,n;if(!this._exclusionsPerZoom)return!1;d=this._exclusionsPerZoom[b];if(!d)return!1;
e=0;for(n=d.length;e<n;e++)if(b=d[e],c>=b.rowFrom&&c<b.rowTo&&a>=b.colFrom&&a<b.colTo)return!0;return!1}})})},"dojox/collections/ArrayList":function(){define(["dojo/_base/kernel","dojo/_base/array","./_base"],function(p,f,a){a.ArrayList=function(f){var k=[];f&&(k=k.concat(f));this.count=k.length;this.add=function(a){k.push(a);this.count=k.length};this.addRange=function(a){if(a.getIterator)for(a=a.getIterator();!a.atEnd();)this.add(a.get());else for(var f=0;f<a.length;f++)k.push(a[f]);this.count=k.length};
this.clear=function(){k.splice(0,k.length);this.count=0};this.clone=function(){return new a.ArrayList(k)};this.contains=function(a){for(var f=0;f<k.length;f++)if(k[f]==a)return!0;return!1};this.forEach=function(a,f){p.forEach(k,a,f)};this.getIterator=function(){return new a.Iterator(k)};this.indexOf=function(a){for(var f=0;f<k.length;f++)if(k[f]==a)return f;return-1};this.insert=function(a,f){k.splice(a,0,f);this.count=k.length};this.item=function(a){return k[a]};this.remove=function(a){a=this.indexOf(a);
0<=a&&k.splice(a,1);this.count=k.length};this.removeAt=function(a){k.splice(a,1);this.count=k.length};this.reverse=function(){k.reverse()};this.sort=function(a){a?k.sort(a):k.sort()};this.setByIndex=function(a,f){k[a]=f;this.count=k.length};this.toArray=function(){return[].concat(k)};this.toString=function(a){return k.join(a||",")}};return a.ArrayList})},"dojox/collections/_base":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array"],function(p,f,a){p=f.getObject("dojox.collections",
!0);p.DictionaryEntry=function(a,f){this.key=a;this.value=f;this.valueOf=function(){return this.value};this.toString=function(){return String(this.value)}};p.Iterator=function(f){var k=0;this.element=f[k]||null;this.atEnd=function(){return k>=f.length};this.get=function(){return this.atEnd()?null:this.element=f[k++]};this.map=function(h,k){return a.map(f,h,k)};this.reset=function(){k=0;this.element=f[k]}};p.DictionaryIterator=function(f){var k=[],h={},q;for(q in f)h[q]||k.push(f[q]);var m=0;this.element=
k[m]||null;this.atEnd=function(){return m>=k.length};this.get=function(){return this.atEnd()?null:this.element=k[m++]};this.map=function(g,e){return a.map(k,g,e)};this.reset=function(){m=0;this.element=k[m]}};return p})},"esri/layers/ArcGISMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../request ../SpatialReference ../geometry/Extent ./LayerInfo".split(" "),function(p,f,a,l,k,h,q,m,g,e){return p(null,{declaredClass:"esri.layers.ArcGISMapServiceLayer",
infoTemplates:null,constructor:function(c,a){this.layerInfos=[];a&&(this.infoTemplates=a.infoTemplates||null);var e=this._params={},g=this._url.query?this._url.query.token:null;g&&(e.token=g)},setInfoTemplates:function(c){this.infoTemplates=c},_load:function(){q({url:this._url.path,content:f.mixin({f:"json"},this._params),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler})},spatialReference:null,initialExtent:null,fullExtent:null,description:null,units:null,_initLayer:function(c,
d){try{this._findCredential();(this.credential&&this.credential.ssl||c&&c._ssl)&&this._useSSL();this.description=c.description;this.copyright=c.copyrightText;this.spatialReference=c.spatialReference&&new m(c.spatialReference);this.initialExtent=c.initialExtent&&new g(c.initialExtent);this.fullExtent=c.fullExtent&&new g(c.fullExtent);this.units=c.units;this.maxRecordCount=c.maxRecordCount;this.maxImageHeight=c.maxImageHeight;this.maxImageWidth=c.maxImageWidth;this.supportsDynamicLayers=c.supportsDynamicLayers;
var r=this.layerInfos=[],f=c.layers,s=this._defaultVisibleLayers=[];a.forEach(f,function(b,c){r[c]=new e(b);b.defaultVisibility&&s.push(b.id)});this.visibleLayers||(this.visibleLayers=s);this.version=c.currentVersion;this.version||(this.version="capabilities"in c||"tables"in c?10:"supportedImageFormatTypes"in c?9.31:9.3);this.capabilities=c.capabilities;h.isDefined(c.minScale)&&!this._hasMin&&this.setMinScale(c.minScale);h.isDefined(c.maxScale)&&!this._hasMax&&this.setMaxScale(c.maxScale)}catch(t){this._errorHandler(t)}}})})},
"esri/layers/LayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(p,f,a,l,k){return p(null,{declaredClass:"esri.layers.LayerInfo",constructor:function(a){f.mixin(this,a)},toJson:function(){return k.fixJson({defaultVisibility:this.defaultVisibility,id:this.id,maxScale:this.maxScale,minScale:this.minScale,name:this.name,parentLayerId:this.parentLayerId,subLayerIds:this.subLayerIds})}})})},"esri/layers/TimeInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../TimeExtent ./TimeReference ./LayerTimeOptions".split(" "),
function(p,f,a,l,k,h,q){p=p(null,{declaredClass:"esri.layers.TimeInfo",constructor:function(a){null!==a&&(f.mixin(this,a),a.exportOptions&&(this.exportOptions=new q(a.exportOptions)),this.timeExtent=null,a.timeExtent&&2===a.timeExtent.length&&(this.timeExtent=new k(a.timeExtent)),this.timeReference=new h(a.timeReference))}});f.mixin(p,{UNIT_CENTURIES:"esriTimeUnitsCenturies",UNIT_DAYS:"esriTimeUnitsDays",UNIT_DECADES:"esriTimeUnitsDecades",UNIT_HOURS:"esriTimeUnitsHours",UNIT_MILLISECONDS:"esriTimeUnitsMilliseconds",
UNIT_MINUTES:"esriTimeUnitsMinutes",UNIT_MONTHS:"esriTimeUnitsMonths",UNIT_SECONDS:"esriTimeUnitsSeconds",UNIT_UNKNOWN:"esriTimeUnitsUnknown",UNIT_WEEKS:"esriTimeUnitsWeeks",UNIT_YEARS:"esriTimeUnitsYears"});return p})},"esri/TimeExtent":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel"],function(p,f,a,l){var k=p(null,{declaredClass:"esri.TimeExtent",constructor:function(a){if(1<arguments.length)this._create(arguments[0],arguments[1]);else if(a)if(f.isArray(a)){var k=
a[0],m=a[1];this.startTime=null===k||"null"===k?null:new Date(k);this.endTime=null===m||"null"===m?null:new Date(m)}else a instanceof Date&&this._create(a,null)},offset:function(a,f){var m=new k,g=this.startTime,e=this.endTime;g&&(m.startTime=this._getOffsettedDate(g,a,f));e&&(m.endTime=this._getOffsettedDate(e,a,f));return m},intersection:function(a){return this._intersection(this,a)},toJson:function(){var a=[],f=this.startTime;a.push(f?f.getTime():"null");f=this.endTime;a.push(f?f.getTime():"null");
return a},_create:function(a,f){this.startTime=a?new Date(a.getTime()):null;this.endTime=f?new Date(f.getTime()):null},_refData:{esriTimeUnitsMilliseconds:{getter:"getUTCMilliseconds",setter:"setUTCMilliseconds",multiplier:1},esriTimeUnitsSeconds:{getter:"getUTCSeconds",setter:"setUTCSeconds",multiplier:1},esriTimeUnitsMinutes:{getter:"getUTCMinutes",setter:"setUTCMinutes",multiplier:1},esriTimeUnitsHours:{getter:"getUTCHours",setter:"setUTCHours",multiplier:1},esriTimeUnitsDays:{getter:"getUTCDate",
setter:"setUTCDate",multiplier:1},esriTimeUnitsWeeks:{getter:"getUTCDate",setter:"setUTCDate",multiplier:7},esriTimeUnitsMonths:{getter:"getUTCMonth",setter:"setUTCMonth",multiplier:1},esriTimeUnitsYears:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:1},esriTimeUnitsDecades:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:10},esriTimeUnitsCenturies:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:100}},_intersection:function(a,f){if(a&&f){var m=a.startTime,g=a.endTime,
e=f.startTime,c=f.endTime,m=m?m.getTime():-Infinity,e=e?e.getTime():-Infinity,g=g?g.getTime():Infinity,c=c?c.getTime():Infinity,d,r;e>=m&&e<=g?d=e:m>=e&&m<=c&&(d=m);g>=e&&g<=c?r=g:c>=m&&c<=g&&(r=c);if(!isNaN(d)&&!isNaN(r))return m=new k,m.startTime=-Infinity===d?null:new Date(d),m.endTime=Infinity===r?null:new Date(r),m}return null},_getOffsettedDate:function(a,f,k){var g=this._refData;a=new Date(a.getTime());f&&k&&(g=g[k],a[g.setter](a[g.getter]()+f*g.multiplier));return a}});return k})},"esri/layers/TimeReference":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(p,f,a,l){return p(null,{declaredClass:"esri.layers.TimeReference",constructor:function(a){a&&f.mixin(this,a)}})})},"esri/layers/LayerTimeOptions":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(p,f,a,l,k){return p(null,{declaredClass:"esri.layers.LayerTimeOptions",constructor:function(a){a&&f.mixin(this,a)},toJson:function(){return k.fixJson({timeDataCumulative:this.timeDataCumulative,timeOffset:this.timeOffset,
timeOffsetUnits:this.timeOffsetUnits,useTime:this.useTime})}})})},"esri/layers/TileMap":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/io-query ../request ../urlUtils ../sniff".split(" "),function(p,f,a,l,k,h,q,m){var g=m("esri-iphone");return p(null,{declaredClass:"esri.layers.TileMap",constructor:function(a){this.layer=a;this._tileMaps={}},getTile:function(a,c,d,g,f){a={id:g,level:a,row:c,col:d};c=this._getResamplingBudget();0<c?this._process({tile:a,requestedTile:a,
callback:f,resamplingBudget:c}):(f||this.callback).call(this,a,a)},statusOf:function(a,c,d){var g=this._getResamplingBudget();a={level:a,row:c,col:d};if(0===g)return 1;for(;0<=g;){c=this._tileToTileMap(a);if(!this._tileMaps[c.uid])return-1;c=this._tileMaps[c.uid];if(!c.promise.isFulfilled())return-1;if(this._isTileAvailable(a,c))return 1;a=this._parentTile(a);if(!a)break;g--}return 0},style:function(a,c){if(!(a.level===c.level&&a.row===c.row&&a.col===c.col)){for(var d=this.layer.tileInfo,r=d.lods,
f=d.cols,d=d.rows,s,t,b=r.length-1;!s||!t;)!s&&r[b].level===a.level&&(s=r[b]),!t&&r[b].level===c.level&&(t=r[b]),b--;s=Math.round(s.resolution/t.resolution);t=-1*c.col%s*f;r=-1*c.row%s*d;s={width:f*s+"px",height:d*s+"px",margin:r+"px 0 0 "+t+"px","will-change":"transform"};g&&(t=0===t?0:-1*t,r=0===r?0:-1*r,s.clip="rect("+r+"px,"+(t+f)+"px,"+(r+d)+"px,"+t+"px)");return s}},_process:function(a){var c=a.tile,d=this._tileToTileMap(c),g=this._parentTile(c);this._getTileMap(d).then(f.hitch(this,function(f){d=
f;this._isTileAvailable(c,d)?(a.callback||this.callback).call(this,c,a.requestedTile):0<a.resamplingBudget&&g?(a.resamplingBudget--,a.tile=g,this._process(a)):(a.callback||this.callback).call(this,a.requestedTile,a.requestedTile)}),f.hitch(this,function(){(a.callback||this.callback).call(this,a.requestedTile,a.requestedTile)}))},_getTileMap:function(a){var c,d,g,u,s=null;this._tileMaps[a.uid]?(a=this._tileMaps[a.uid],c=a.promise):(this._tileMaps[a.uid]=a,d=new l,h({url:this._getTileMapUrl(a.level,
a.row,a.col),handleAs:"json",callbackParamName:"callback",timeout:3E3,load:function(c){f.mixin(a,c);if(a.data&&0<a.data.length){u=a.data.length;if(1===u)s=a.data[0];else{s=a.data[0];for(g=1;g<u;g++)if(a.data[g]!==s){s=null;break}}null!==s&&(delete a.data,a.value=s)}d.resolve(a)},error:function(c){d.reject()}}),c=a.promise=d.promise);return c},_parentTile:function(e){var c=this.layer.tileInfo.lods,d,g,f=null;a.some(c,function(c,a){return e.level===c.level?(d=c,g=a,!0):!1});0<g&&(c=c[g-1],f={id:e.id,
level:c.level,row:Math.floor(e.row*d.resolution/c.resolution+0.01),col:Math.floor(e.col*d.resolution/c.resolution+0.01)});return f},_tileToTileMap:function(a){var c=8*Math.floor(a.row/8),d=8*Math.floor(a.col/8);return{uid:a.level+"_"+c+"_"+d,level:a.level,row:c,col:d}},_isTileAvailable:function(a,c){var d,g;c.valid?void 0!==c.value?d=c.value:(d=c.location.left,g=c.location.top,d=(a.row-g)*c.location.width+(a.col-d),d=d<c.data.length?c.data[d]:0):d=0;return d},_getTileMapUrl:function(a,c,d){var g=
this.layer,f=g.tileServers,s=g._getToken(),t=g._url.query;a=(f?f[c%f.length]:g._url.path)+"/tilemap/"+a+"/"+c+"/"+d+"/8/8";t&&(a+="?"+k.objectToQuery(t));if(s&&(!t||!t.token))a+=(-1===a.indexOf("?")?"?":"\x26")+"token\x3d"+s;return a=g.addTimestampToURL(a)},_getResamplingBudget:function(){var a=this.layer,c=0;if(a.resampling&&(c=a._resamplingTolerance,null===c||void 0===c))c=a.tileInfo.lods.length;return c}})})},"esri/layers/MapImageLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style ../kernel ../config ../sniff ../domUtils ../geometry/Point ../geometry/webMercatorUtils ./layer".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r){var u=p([r],{declaredClass:"esri.layers.MapImageLayer","-chains-":{constructor:"manual"},constructor:function(c){this.inherited(arguments,[null,c]);this._mapImages=[];var d=a.hitch;this._panStart=d(this,this._panStart);this._pan=d(this,this._pan);this._extentChange=d(this,this._extentChange);this._zoom=d(this,this._zoom);this._zoomStart=d(this,this._zoomStart);this._scale=d(this,this._scale);this._resize=d(this,this._resize);f.connect(this,"onSuspend",this,this._onSuspend);
f.connect(this,"onResume",this,this._onResume);this.loaded=!0;this.onLoad(this)},opacity:1,addImage:function(c){var a=this._mapImages.push(c),a=a-1;c._idx=a;c._layer=this;this._div&&this._createImage(c,a)},removeImage:function(c){if(c){var a=c._idx,b=this._mapImages;if(b[a]===c){delete b[a];if(a=c._node)this._clearEvents(a),a.e_idx=a.e_bl=a.e_tr=a.e_l=a.e_t=a.e_w=a.e_h=null,a.parentNode&&(a.parentNode.removeChild(a),k.destroy(a));c._node=c._idx=c._layer=null}}},removeAllImages:function(){var c=this._mapImages,
a,b=c.length;for(a=0;a<b;a++){var d=c[a];d&&this.removeImage(d)}this._mapImages=[]},getImages:function(){var c=this._mapImages,a=[],b,d=c.length;for(b=0;b<d;b++)c[b]&&a.push(c[b]);return a},setOpacity:function(c){this.opacity!=c&&(this._opacityChanged(this.opacity=c),this.onOpacityChange())},onOpacityChange:function(){},_opacityChanged:function(c){var a=this._div,b,d;if(a)if(!g("ie")||8<g("ie"))h.set(a,"opacity",c);else{d=a.childNodes;b=d.length;for(a=0;a<b;a++)h.set(d[a],"opacity",c)}},_createImage:function(c,
a){var b=k.create("img");h.set(b,{position:"absolute"});1>c.opacity?h.set(b,"opacity",c.opacity):8>=g("ie")&&h.set(b,"opacity",this.opacity);c.rotation&&!(9>g("ie"))&&h.set(b,q._css.names.transform,q._css.rotate(360-c.rotation));c._node=b;b.e_idx=a;b.e_layer=this;b.e_load=f.connect(b,"onload",u.prototype._imageLoaded);b.e_error=f.connect(b,"onerror",u.prototype._imageError);b.e_abort=f.connect(b,"onabort",u.prototype._imageError);b.src=c.href},_imageLoaded:function(c,a){var b=a||c.target||c.currentTarget,
d=b.e_layer,e=d._mapImages[b.e_idx],g=d._map;g&&(g.__zooming||g.__panning||!d._sr)?d._standby.push(b):(d._clearEvents(b),e&&e._node===b&&g&&d._attach(e))},_imageError:function(c){c=c.target||c.currentTarget;var a=c.e_layer,b=a._mapImages[c.e_idx];a._clearEvents(c);b&&(b._node=null)},_clearEvents:function(c){var a=f.disconnect;a(c.e_load);a(c.e_error);a(c.e_abort);c.e_load=c.e_error=c.e_abort=c.e_layer=null},_attach:function(a){var e=a.extent,b=e.spatialReference,g=this._sr,n=this._div,f=a._node,r=
new c({x:e.xmin,y:e.ymin,spatialReference:b}),e=new c({x:e.xmax,y:e.ymax,spatialReference:b});g.equals(b)||(g.isWebMercator()&&4326===b.wkid?(r=d.geographicToWebMercator(r),e=d.geographicToWebMercator(e)):b.isWebMercator()&&4326===g.wkid&&(r=d.webMercatorToGeographic(r),e=d.webMercatorToGeographic(e)));f.e_bl=r;f.e_tr=e;a.visible&&(this._setPos(f,n._left,n._top),(this._active||n).appendChild(f))},_setPos:function(c,a,b){var d=c.e_bl,e=c.e_tr,g=this._map,d=g.toScreen(d),e=g.toScreen(e);a=d.x-a;b=e.y-
b;var f=Math.abs(e.x-d.x),d=Math.abs(d.y-e.y),e={width:f+"px",height:d+"px"},r=this._mapImages[c.e_idx];"css-transforms"===g.navigationMode?e[q._css.names.transform]=q._css.translate(a,b)+(r.rotation?" "+q._css.rotate(360-r.rotation):""):(e.left=a+"px",e.top=b+"px");h.set(c,e);c.e_l=a;c.e_t=b;c.e_w=f;c.e_h=d},managedSuspension:!0,_setMap:function(c,a){this.inherited(arguments);var b=this._div=k.create("div",null,a),d=q._css.names,n={position:"absolute"},f=c.__visibleDelta;if(!g("ie")||8<g("ie"))n.opacity=
this.opacity;"css-transforms"===c.navigationMode?(n[d.transform]=q._css.translate(f.x,f.y),h.set(b,n),b._left=f.x,b._top=f.y,n={position:"absolute",width:c.width+"px",height:c.height+"px",overflow:"visible"},this._active=k.create("div",null,b),h.set(this._active,n),this._passive=k.create("div",null,b),h.set(this._passive,n)):(b._left=0,b._top=0,h.set(b,n));this._standby=[];d=this._mapImages;f=d.length;for(n=0;n<f;n++){var r=d[n];r._node||this._createImage(r,r._idx)}e.hide(b);return b},_unsetMap:function(c,
a){this._disconnect();var b=this._div;if(b){var d=this._mapImages,e,g=d.length;for(e=0;e<g;e++){var f=d[e];if(f){var r=f._node;r&&(this._clearEvents(r),r.e_idx=r.e_bl=r.e_tr=r.e_l=r.e_t=r.e_w=r.e_h=null);f._node=null}}a.removeChild(b);k.destroy(b)}this._map=this._div=this._sr=this._active=this._passive=this._standby=null;this.inherited(arguments)},_onSuspend:function(){this._disconnect();e.hide(this._div)},_onResume:function(c){c.firstOccurrence&&(this._sr=this._map.spatialReference,this._processStandbyList());
c=this._map;var a=this._div,b=c.__visibleDelta;"css-transforms"===c.navigationMode&&(a._left=b.x,a._top=b.y,h.set(a,q._css.names.transform,q._css.translate(a._left,a._top)));this._redraw("css-transforms"===c.navigationMode);this._connect(c);e.show(a)},_connect:function(c){if(!this._connections){var a=f.connect,b="css-transforms"===c.navigationMode;this._connections=[a(c,"onPanStart",this._panStart),a(c,"onPan",this._pan),a(c,"onExtentChange",this._extentChange),b&&a(c,"onZoomStart",this._zoomStart),
b?a(c,"onScale",this._scale):a(c,"onZoom",this._zoom),b&&a(c,"onResize",this._resize)]}},_disconnect:function(){this._connections&&(l.forEach(this._connections,f.disconnect),this._connections=null)},_panStart:function(){this._panL=this._div._left;this._panT=this._div._top},_pan:function(c,a){var b=this._div;b._left=this._panL+a.x;b._top=this._panT+a.y;"css-transforms"===this._map.navigationMode?h.set(b,q._css.names.transform,q._css.translate(b._left,b._top)):h.set(b,{left:b._left+"px",top:b._top+
"px"})},_extentChange:function(c,a,b){b?this._redraw("css-transforms"===this._map.navigationMode):a&&this._pan(c,a);this._processStandbyList()},_processStandbyList:function(){var c,a=this._standby;if(a&&a.length)for(c=a.length-1;0<=c;c--)this._imageLoaded(null,a[c]),a.splice(c,1)},_redraw:function(c){if(c){c=this._passive;var a=q._css.names;h.set(c,a.transition,"none");this._moveImages(c,this._active);h.set(c,a.transform,"none")}c=this._active||this._div;var a=this._div._left,b=this._div._top,d,e=
c.childNodes.length,g;for(d=0;d<e;d++)g=c.childNodes[d],this._setPos(g,a,b)},_zoom:function(c,a,b){c=this._div;var d=c._left,e=c._top,g,f=c.childNodes.length,r;for(g=0;g<f;g++){r=c.childNodes[g];var u=r.e_w*a,k=r.e_h*a,m=(b.x-d-r.e_l)*(u-r.e_w)/r.e_w,q=(b.y-e-r.e_t)*(k-r.e_h)/r.e_h,m=isNaN(m)?0:m,q=isNaN(q)?0:q;h.set(r,{left:r.e_l-m+"px",top:r.e_t-q+"px",width:u+"px",height:k+"px"})}},_zoomStart:function(){this._moveImages(this._active,this._passive)},_moveImages:function(c,a){var b=c.childNodes,
d;d=b.length;if(0<d)for(d-=1;0<=d;d--)a.appendChild(b[d])},_scale:function(c,a){var b=q._css.names,d=this._passive;h.set(d,b.transition,a?"none":b.transformName+" "+m.defaults.map.zoomDuration+"ms ease");q._css.matrix(c);h.set(d,b.transform,q._css.matrix(c))},_resize:function(c,a,b){h.set(this._active,{width:a+"px",height:b+"px"});h.set(this._passive,{width:a+"px",height:b+"px"})}});return u})},"esri/layers/OpenStreetMapLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../urlUtils ../SpatialReference ../geometry/Extent ./TiledMapServiceLayer ./TileInfo".split(" "),
function(p,f,a,l,k,h,q,m,g){return p(m,{declaredClass:"esri.layers.OpenStreetMapLayer",constructor:function(a){this.spatialReference=new h({wkid:102100});this.tileInfo=new g({rows:256,cols:256,dpi:96,format:"PNG8",compressionQuality:0,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:0,scale:5.91657527591555E8,resolution:156543.033928},{level:1,scale:2.95828763795777E8,resolution:78271.5169639999},{level:2,scale:1.47914381897889E8,resolution:39135.7584820001},
{level:3,scale:7.3957190948944E7,resolution:19567.8792409999},{level:4,scale:3.6978595474472E7,resolution:9783.93962049996},{level:5,scale:1.8489297737236E7,resolution:4891.96981024998},{level:6,scale:9244648.868618,resolution:2445.98490512499},{level:7,scale:4622324.434309,resolution:1222.99245256249},{level:8,scale:2311162.217155,resolution:611.49622628138},{level:9,scale:1155581.108577,resolution:305.748113140558},{level:10,scale:577790.554289,resolution:152.874056570411},{level:11,scale:288895.277144,
resolution:76.4370282850732},{level:12,scale:144447.638572,resolution:38.2185141425366},{level:13,scale:72223.819286,resolution:19.1092570712683},{level:14,scale:36111.909643,resolution:9.55462853563415},{level:15,scale:18055.954822,resolution:4.77731426794937},{level:16,scale:9027.977411,resolution:2.38865713397468},{level:17,scale:4513.988705,resolution:1.19432856685505},{level:18,scale:2256.994353,resolution:0.597164283559817},{level:19,scale:1128.497176,resolution:0.298582141647617}]});this.fullExtent=
new q({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.initialExtent=new q({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.tileServers=a&&a.tileServers||["//a.tile.openstreetmap.org","//b.tile.openstreetmap.org","//c.tile.openstreetmap.org"];this.serversLength=this.tileServers.length;this._displayLevels=a?a.displayLevels:null;this.copyright=a&&a.copyright||"Map data \u00a9 OpenStreetMap contributors, CC-BY-SA";
this.loaded=!0;this.onLoad(this);(a=a&&a.loadCallback)&&a(this)},getTileUrl:function(a,c,d){a=this.tileServers[c%this.serversLength]+"/"+a+"/"+d+"/"+c+".png";a=k.normalize(a);a=this.addTimestampToURL(a);return k.addProxy(a)}})})},"esri/layers/VectorTileLayer":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/url dojo/dom-construct dojo/dom-style dojo/has dojo/Deferred ../lang ../domUtils ../urlUtils ../kernel ../config ../request ../SpatialReference ../geometry/Extent ./layer ./TileInfo ./unitBezier".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n){var w=f(b,{declaredClass:"esri.layers.VectorTileLayer",_mapsWithAttribution:["World_Basemap"],_eventMap:{"style-change":["style"]},constructor:function(b,a){this._displayLevels=a?a.displayLevels:null;this._glStyleApplied=!1;this._serviceOverrides={};this._style=null;a&&(a.tileServers&&a.tileServers.length)&&(this._serviceOverrides.tileServers=a.tileServers.map(function(b){if(T.isMapboxUrl(b))return b;b=c.getAbsoluteUrl(b);var a=T.getTokenFromUrl(b);
return a?a.url+"?token\x3d"+a.token:c.urlToObject(b).path},this));var d=b;"string"===typeof b&&(d=T.isMapboxUrl(b)?b:c.getAbsoluteUrl(b),this._serviceOverrides.credential=T.getTokenFromUrl(b));this.setStyle(d);this.registerConnectEvents()},setStyle:function(b){if(b)return this._glStyleApplied=!1,this._serviceOverrides.credential="string"!==typeof b?null:T.getTokenFromUrl(b),this._loadStyle(b)},getStyle:function(){if(!this._style)return null;var b=JSON.parse(JSON.stringify(this._style.stylesheet)),
c=b.sources;Object.keys(c).forEach(function(b){b=c[b];b.tiles=(b.tiles||[]).map(function(b){"string"!==typeof b&&(b=b.value);return b})});return b},opacity:1,setOpacity:function(b){if(this.opacity!=b)this.onOpacityChange(this.opacity=b)},onOpacityChange:function(){},refresh:function(){},_loadStyle:function(b){return(new m).resolve().then(function(){var b=new m;null==q("ie")||9<q("ie")?x?x.supported()?b.resolve():b.reject(Error("layer not supported"),!0):p(["./vector-tile"],function(c){x=c;x.supported()?
b.resolve():b.reject(Error("layer not supported"),!0)}):b.reject(Error("layer not supported"),!0);return b.promise}).then(function(){x.tokenHandler?z=x.tokenHandler:(z=new P,x.tokenHandler=z);this._serviceOverrides&&this._serviceOverrides.credential&&z.addToken(this._serviceOverrides.credential);return T.loadMetadata(b,this._serviceOverrides)}.bind(this)).then(a.hitch(this,function(a){var e=a.layerDefinition;this.serviceUrl=a.serviceUrl||null;this.styleUrl=a.styleUrl||null;e?(this.spatialReference=
e.initialExtent&&e.initialExtent.spatialReference&&new s(e.initialExtent.spatialReference),this.initialExtent=e.initialExtent&&new t(e.initialExtent),this.fullExtent=e.fullExtent&&new t(e.fullExtent),this.version=e.currentVersion,this.tileInfo=new v(e.tileInfo),g.isDefined(e.minScale)&&!this._hasMin&&this.setMinScale(e.minScale),g.isDefined(e.maxScale)&&!this._hasMax&&this.setMaxScale(e.maxScale),e=null,b&&(e=c.urlToObject(a.serviceUrl),e=this._getDefaultAttribution(e.path)),e&&(this.attributionDataUrl=
e,this.hasAttributionData=!0)):(this.spatialReference=E,this.initialExtent=H,this.fullExtent=I,this.tileInfo=F,this.version=null);for(var e=this.tileInfo.lods,n=this.scales=[],r=this._displayLevels,f=-Infinity,h=Infinity,u,w=0,k=e.length;w<k;w++)if(u=e[w],!r||-1!==r.indexOf(u.level))n[w]=u.scale,f=u.scale>f?u.scale:f,h=u.scale<h?u.scale:h;-Infinity!==f&&!this._hasMin&&this.setMinScale(f);Infinity!==h&&!this._hasMax&&this.setMaxScale(h);this._style=a.style;this.gl&&(x.identityManager=d.id,this._applyGLStyle(this._style));
this.onStyleChange(this.getStyle())})).then(a.hitch(this,function(){!this.loaded&&!this.loadError&&(this.loaded=!0,this.onLoad(this))})).otherwise(a.hitch(this,function(b){this._errorHandler(b);throw b;}))},_setMap:function(b,c,e){this.inherited(arguments);this._map=b;var n=this._div=k.create("div",null,c);h.set(n,{position:"absolute",width:b.width+"px",height:b.height+"px",overflow:"visible",opacity:this.opacity});this._onResizeHandle=b.on("resize",a.hitch(this,this._onResizeHandler));this._onOpacityHandle=
this.on("opacity-change",a.hitch(this,this._opacityChangeHandler));this._onScaleVisHandle=this.on("scale-visibility-change",a.hitch(this,function(){this._applyGLStyle(this._style)}));this._onVisibilityHandle=this.on("visibility-change",a.hitch(this,function(){this._applyGLStyle(this._style)}));x.identityManager=d.id;this.gl=new x.Renderer({container:n});this.gl.setSize(b.width,b.height);this._applyGLStyle(this._style);this.evaluateSuspension();if(this.suspended&&!b.loaded)var g=b.on("load",a.hitch(this,
function(){g.remove();this.evaluateSuspension()}));return n},_unsetMap:function(b,c){this.gl.remove();this.gl=null;this._glStyleApplied=!1;k.destroy(this._div);this._map=this._div=null;this._onResizeHandle=this._onResizeHandle&&this._onResizeHandle.remove()&&null;this._onOpacityHandle=this._onOpacityHandle&&this._onOpacityHandle.remove()&&null;this._onScaleVisHandle=this._onScaleVisHandle&&this._onScaleVisHandle.remove()&&null;this._onVisibilityHandle=this._onVisibilityHandle&&this._onVisibilityHandle.remove()&&
null;this._disableDrawConnectors();this._animation&&(this._animation.stop(),this._animation=null);this.inherited(arguments)},_applyGLStyle:function(b){if(!this._glStyleApplied){var c=this.gl;c&&(b?this.visible&&this._isMapAtVisibleScale()&&(b.animationLoop=c.animationLoop,c.setStyle(b),b._loaded&&(Object.getOwnPropertyNames(b.sources).forEach(function(b){this.fire("source.add",{source:this.sources[b]})},b),b.fire("load"),b.sprite&&b.sprite.loaded()&&b.fire("change")),this._glStyleApplied=!0):c.setStyle(null))}},
_enableDrawConnectors:function(){var b=this._map;b&&(this._panHandle=b.on("pan",a.hitch(this,this._onPanExtentChangeHandler)),this._extentChangeHandle=b.on("extent-change",a.hitch(this,this._onExtentChangeHandler)),this._onScaleHandle=b.on("scale",a.hitch(this,this._onScaleHandler)))},_disableDrawConnectors:function(){this._onScaleHandle=this._onScaleHandle&&this._onScaleHandle.remove()&&null;this._panHandle=this._panHandle&&this._panHandle.remove()&&null;this._extentChangeHandle=this._extentChangeHandle&&
this._extentChangeHandle.remove()&&null},_getZoom:function(b){var c=this.tileInfo.lods,a=null,d=null,e=0,n=c.length-1;for(e;e<n;e++){a=c[e];d=c[e+1];if(a.scale<=b)return a.level;if(d.scale===b)return d.level;if(a.scale>b&&d.scale<b){e=e+1-(b-d.scale)/(a.scale-d.scale);e=Math.ceil(e)-Math.log(Math.abs(Math.ceil(e)-e+1))/Math.LN2;if(0.995<e-Math.floor(e)||0.005>e-Math.floor(e))e=Math.round(e);return c[e].level}}return b>c[0].scale?c[0].level:c[c.length-1].level},_isMapAtVisibleScale:function(){var b=
this.inherited(arguments);if(b){for(var c=this._map,b=this.scales,a=c.getScale(),d=!1,c=c.width>c.height?c.width:c.height,e=0,n=b.length;e<n;e++)if(Math.abs(b[e]-a)/b[e]<1/c){d=!0;break}b=d}return b},_getDefaultAttribution:function(b){var c=b.match(/^https?:\/\/(basemaps|basemapsbeta)\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);if(c&&(b=c[3])){var c=c[2]||"",a;b=b.toLowerCase();for(var d=0,e=this._mapsWithAttribution.length;d<e;d++)if(a=this._mapsWithAttribution[d],
-1<a.toLowerCase().indexOf(b))return"file:"===window.location.protocol?"https:":window.location.protocol+"//static.arcgis.com/attribution/Vector"+c+"/"+a}},onStyleChange:function(b){},_opacityChangeHandler:function(b){this.gl&&(this._div.style.opacity=b.opacity)},_onResizeHandler:function(b){if(this.gl){var c=b.extent.getCenter();this.gl.setSize(b.width,b.height);this.gl.jumpTo({center:[c.getLongitude(),c.getLatitude()]});this._div.style.width=b.width+"px";this._div.style.height=b.height+"px"}},onSuspend:function(){this.inherited(arguments);
e.hide(this._div);this._disableDrawConnectors()},onResume:function(){this.inherited(arguments);if(this.gl&&this._style){e.show(this._div);var b=this._map,c=this._getZoom(b.getScale()),b=b.extent.getCenter();this._animate(b,c,!0)}this._enableDrawConnectors()},_onPanExtentChangeHandler:function(b){var c=this._getZoom(this._map.getScale());b=b.extent.getCenter();this._animate(b,c,!0)},_onExtentChangeHandler:function(b){var c=b.extent.getCenter();this._animate(c,this._getZoom(b.lod.scale),this._pinching||
b.immediate);this._pinching=!1},_onScaleHandler:function(b){var c=this._map,a,d,e;c._zoomAnimDiv.extent?(this._pinching=!1,a=c._zoomAnimDiv.anchor,d=c._zoomAnimDiv.extent.getCenter(),e=this._getZoom(c._zoomAnimDiv.newLod.scale,c._zoomAnimDiv.newLod.level),this._animate(d,e,b.immediate,a)):c.navigationManager._pinchScale&&(this._pinching=!0,e=this._getZoom(c.__LOD.scale),b=c.navigationManager._pinchScale-1,a=c.navigationManager._dragOrigin,this.gl.zoomTo(e+b,{animate:!1,offset:a?[a.x-c.width/2,a.y-
c.height/2]:null}))},_animate:function(b,c,a,d){this._animation&&(this._animation.stop(),this._animation=null);this._animation=O(this.gl,b.getLongitude(),b.getLatitude(),c,a,this._map,d)}}),x=null,z=null;b=Object.freeze||function(b){};for(var y=[],A=0;20>A;A++){var B=78271.51696402048/Math.pow(2,A);y.push({level:A,scale:Math.floor(3779.527559055118*B),resolution:B})}var F=new v({rows:512,cols:512,dpi:96,format:"pbf",origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},
lods:y});b(F);var E=new s(102100);b(E);var H=new t(-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7,E);b(H);var I=new t(-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7,E);b(I);var M=function(){var b,c=window.performance||{},a=c.now||c.webkitNow||c.msNow||c.oNow||c.mozNow;if(void 0!==a)return function(){return a.call(c)};b=window.performance&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.timing.navigationStart:(new Date).getTime();return function(){return(new Date).getTime()-
b}}();b=q("ff");var y=q("ie"),A=q("webkit"),B=q("opera"),Q=(new Date).getTime(),K=window.requestAnimationFrame;K||(K=window[(A&&"webkit"||b&&"moz"||B&&"o"||y&&"ms")+"RequestAnimationFrame"])||(K=function(b){var c=M(),a=Math.max(0,16-(c-Q)),d=window.setTimeout(function(){b(M())},a);Q=c+a;return d});var J=n.ease,O=function(b,c,a,d,e,n,g){if(e=e||0===r.defaults.map.zoomDuration)return b.jumpTo({center:[c,a],zoom:Math.ceil(d)-Math.log(Math.abs(Math.ceil(d)-d+1))/Math.LN2}),null;var f=!0,s=r.defaults.map.zoomDuration,
t=b.transform.center.lat,h=b.transform.center.lng,u=b.transform.zoom,v=M()+16,w=g?[g.x-n.width/2,g.y-n.height/2]:null,k=function(){if(f){var e=(M()+16-v)/s;1<=e&&(e=1,f=!1);var e=J(e),n=u+(d-u)*e,n=Math.ceil(n)-Math.log(Math.abs(Math.ceil(n)-n+1))/Math.LN2;w?b.zoomTo(n,{animate:!1,offset:w}):b.jumpTo({center:[h+(c-h)*e,t+(a-t)*e],zoom:n});f&&K(k)}};k();return{stop:function(){f=!1}}},G=f(String,{constructor:function(b,c){this.value=b;this.token=c},valueOf:function(){var b=this.value,c=this.token;if(!c){var a=
d.id&&d.id.findCredential(b);a&&a.token&&(c=a.token)}c&&(b+=(-1===b.indexOf("?")?"?":"\x26")+"token\x3d"+c);return b},toString:function(){return this.valueOf()},replace:function(b,c){return String.prototype.replace.call(this.valueOf(),b,c)}}),T={loadMetadata:function(b,a){var d=null,e=null,n=a&&a.credential;return(new m).resolve(b).then(function(){x.config.ACCESS_TOKEN=w.ACCESS_TOKEN;if("string"!==typeof b)return b;T.isMapboxUrl(b)?(e=b,d=x.normalizeStyleURL(b)):e=d=c.normalize(b).replace(/\/*$/,
"");T._corsify(d);d=T._appendToken(d,n);return u({url:d,content:{f:"json"},handleAs:"json"})}).then(function(b){return T._processMetadata(e,b,a)}).then(function(b){return T._loadStyle(b,a)})},isMapboxUrl:function(b){return-1<b.search(/^mapbox:\/\/styles\//)},getTokenFromUrl:function(b){var a;T.isMapboxUrl(b)||(b=c.urlToObject(b),b.query&&b.query.token&&(a={url:b.path,token:b.query.token}));return a},_appendToken:function(b,c){return!c||!c.token||-1!==b.indexOf("token\x3d")?b:b+=(-1===b.indexOf("?")?
"?":"\x26")+"token\x3d"+c.token},_configureStyle:function(b,c){var a=b.layerDefinition,d=b.style,e=b.serviceUrl,n=b.styleUrl,g=T._getAbsolutePath,f=T._corsify;if(a&&d&&d.sources.esri){var r=a.tilejson||"2.0.0",s=a.tileInfo&&a.tileInfo.format||"pbf",t=a.tileMap?f(g(a.tileMap,e)):null,h=(a.tiles||[]).map(function(b){return new G(T._getAbsolutePath(b.valueOf(),e),c&&c.credential&&c.credential.token)});d.sources.esri={type:"vector",scheme:"xyz",tilejson:r,format:s,index:t,tiles:h,description:a.description,
name:a.name};h.forEach(f);d.glyphs=f(g(d.glyphs,n));d.sprite=f(g(d.sprite,n))}return{style:d,layerDefinition:a,serviceUrl:e,styleUrl:n}},_loadStyle:function(b,c){var e=new m,n=b.style,g=n.sources;c&&c.tileServers&&Object.getOwnPropertyNames(g).forEach(a.hitch(this,function(a){a=g[a];var d=c.tileServers.map(function(a){return new G(T._getAbsolutePath(a,b.serviceUrl,c))});a.tiles=d;d.forEach(T._corsify)}));x.identityManager=d.id;var n=new x.Style(n),f=function(){n.off("load",f);n.off("error",r);b.style=
n;e.resolve(b)},r=function(b){n.off("load",f);n.off("error",r);e.reject(b)};n.on("load",f);n.on("error",r);return e.promise},_getAbsolutePath:function(b,a){var d;a=c.urlToObject(a||"").path;if(/^https?:\/\//i.test(b))d=b;else{if(0===b.indexOf("//"))return location.protocol+b;a=a.replace(/(\/+\w+\.\w+)$/,"");/\/+$/.test(a)||(a+="/");0===b.indexOf("/")&&(b=b.substring(1));d=a+b}return c.normalize(d)},_corsify:function(b){b=b.valueOf();var a=r.defaults.io.corsEnabledServers;if(!c.canUseXhr(b)){var d=
new l(b),d=(d.host+(d.port?":"+d.port:"")).toLowerCase();-1===a.indexOf(d)&&a.push(d)}return b},_processMetadata:function(b,c,d){var e={},n,g,f=T._getAbsolutePath,r=T._configureStyle,s=T._corsify,h=d&&d.credential;delete c._ssl;if(c.currentVersion)return n=b,g=f(c.defaultStyles,n),u({url:T._appendToken(g,h),content:{f:"json"},handleAs:"json"}).then(a.hitch(this,function(b){return r({style:b,layerDefinition:c,styleUrl:g,serviceUrl:n},d)}));e=c;g=b;return c.sources.esri&&c.sources.esri.url?(n=s(f(c.sources.esri.url,
g)),u({url:T._appendToken(n,h),content:{f:"json"},handleAs:"json"}).then(a.hitch(this,function(b){return r({style:e,layerDefinition:b,styleUrl:g,serviceUrl:n},d)}))):r({style:e})}},P=f([],{constructor:function(){this._credentials=[]},addToken:function(b){if(!b||!b.url||!b.token)return!1;var c=this.getServiceRoot(b.url);this._credentials.push({rootUrl:c,token:b.token})},findCredential:function(b){var c=-1,a=this._credentials,d=this.getServiceRoot(b);a.some(function(b,a){if(b.rootUrl===d)return c=a,
!0});return-1<c?a[c]:null},getServiceRoot:function(b){var c=/(.+\/rest\/services\/.*\/?vectortileserver)/i,a=/(.+\/sharing\/.*)/i;return c.test(b)?b.match(c)[1].toLowerCase():a.test(b)?b.match(a)[1].toLowerCase():null},shareSameService:function(b,c){b=this.getServiceRoot(b);c=this.getServiceRoot(c);b=b.substr(b.indexOf(":"));c=c.substr(c.indexOf(":"));return b===c}});w.ACCESS_TOKEN=null;return w})},"esri/layers/unitBezier":function(){define([],function(){var p=function(a,f,k,h){function q(c,a){var d,
b,f,n;a=null==a?1E-6:a;f=c;for(b=0;8>b;b++){n=((e*f+g)*f+m)*f-c;if(Math.abs(n)<a)return f;d=(3*e*f+2*g)*f+m;if(1E-6>Math.abs(d))break;f-=n/d}d=0;b=1;f=c;if(f<d)return d;if(f>b)return b;for(;d<b;){n=((e*f+g)*f+m)*f;if(Math.abs(n-c)<a)break;c>n?d=f:b=f;f=0.5*(b-d)+d}return f}var m=3*a,g=3*(k-a)-m,e=1-m-g,c=3*f,d=3*(h-f)-c,r=1-c-d;return function(a,e){var g=q(a,e);return((r*g+d)*g+c)*g}},f=/^cubic-bezier\((.*)\)/;p.parse=function(a){var l=p[a]||null;if(!l&&(a=f.exec(a)))a=a[1].split(",").map(function(a){return parseFloat(a.trim())}),
4===a.length&&!a.some(function(a){return isNaN(a)})&&(l=p.apply(p,a));return l};p.ease=p(0.25,0.1,0.25,1);p.linear=p(0,0,1,1);p.easeIn=p["ease-in"]=p(0.42,0,1,1);p.easeOut=p["ease-out"]=p(0,0,0.58,1);p.easeInOut=p["ease-in-out"]=p(0.42,0,0.58,1);return p})},"esri/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/window dojo/Stateful dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/registry ../kernel ../lang ../domUtils ../geometry/Polyline ../geometry/Polygon ../InfoWindowBase ../PopupBase dojo/i18n!../nls/jsapi dojo/NodeList-dom require require".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A){return p([z,y,m],{declaredClass:"esri.dijit.Popup",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:25,marginTop:25,highlight:!0,pagingControls:!0,pagingInfo:!0,keepHighlightOnHide:!1,popupWindow:!0,titleInBody:!0,anchor:"auto",visibleWhenEmpty:!0,hideDelay:1E3,location:null,constructor:function(b,a){this.initialize();f.mixin(this,b);this.domNode=e.byId(a);var g=this._nls=f.mixin({},A.widgets.popup),r=this.domNode;d.add(r,"esriPopup");(this._isRTL=
!u.isBodyLtr())&&s.set(r,"direction","rtl");c.set(r,"innerHTML","\x3cdiv class\x3d'esriPopupWrapper' style\x3d'position: absolute;'\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'titlePane'\x3e\x3cdiv class\x3d'spinner hidden' title\x3d'"+g.NLS_searching+"...'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton prev hidden' title\x3d'"+g.NLS_prevFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton next hidden' title\x3d'"+g.NLS_nextFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton maximize' title\x3d'"+
g.NLS_maximize+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton close' title\x3d'"+g.NLS_close+"'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer content'\x3e\x3cdiv class\x3d'contentPane'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'actionsPane'\x3e\x3cdiv class\x3d'actionList hidden'\x3e\x3ca title\x3d"+g.NLS_zoomTo+" class\x3d'action zoomTo' href\x3d'javascript:void(0);'\x3e\x3cspan\x3e"+g.NLS_zoomTo+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'outerPointer hidden'\x3e\x3c/div\x3e");
this._sizers=k.query(".sizer",r);g=k.query(".titlePane",r)[0];e.setSelectable(g,!1);this._title=k.query(".title",g)[0];this._prevFeatureButton=k.query(".prev",g)[0];this._nextFeatureButton=k.query(".next",g)[0];this._maxButton=k.query(".maximize",g)[0];this._spinner=k.query(".spinner",g)[0];this._contentPane=k.query(".contentPane",r)[0];this._positioner=k.query(".esriPopupWrapper",r)[0];this._pointer=k.query(".pointer",r)[0];this._outerPointer=k.query(".outerPointer",r)[0];this._actionList=k.query(".actionsPane .actionList",
r)[0];this._eventConnections=[l.connect(k.query(".close",g)[0],"onclick",this,this.hide),l.connect(this._prevFeatureButton,"onclick",this,this.selectPrevious),l.connect(this._nextFeatureButton,"onclick",this,this.selectNext),l.connect(this._maxButton,"onclick",this,this._toggleSize),l.connect(k.query(".zoomTo",this._actionList)[0],"onclick",this,this._zoomToFeature),l.connect(this,"onClearFeatures",this,this._featuresCleared),l.connect(this,"onSelectionChange",this,this._featureSelected),l.connect(this,
"onDfdComplete",this,this._updateUI)];h("esri-touch")&&(r=n.setScrollable(this._contentPane),this._eventConnections.push(r[0],r[1]));this._toggleVisibility(!1)},onMaximize:function(){},onRestore:function(){},setMap:function(b){this.inherited(arguments);r.place(this.domNode,b.root);this.highlight&&this.enableHighlight(b);this._maxHeight=s.get(this._contentPane,"maxHeight")},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments)},setTitle:function(b){if(this.popupWindow){if(!v.isDefined(b)||
""===b)b="\x26nbsp;";this.destroyDijits(this._title);this.place(b,this._title);this.isShowing&&(this.startupDijits(this._title),this.reposition())}},setContent:function(b){if(this.popupWindow){if(!v.isDefined(b)||""===b)b="\x26nbsp;";this.destroyDijits(this._contentPane);this.place(b,this._contentPane);this.isShowing&&(this.startupDijits(this._contentPane),this.reposition())}},show:function(b,c){if(this.popupWindow)if(this._delayHide=!1,b){var a=this.map,d;b.spatialReference?(this.location=b,d=a.toScreen(b)):
(this.location=a.toMap(b),d=b);var e=a._getFrameWidth();if(-1!==e&&(d.x%=e,0>d.x&&(d.x+=e),a.width>e))for(a=(a.width-e)/2;d.x<a;)d.x+=e;this._maximized?this.restore():this._setPosition(d);c&&c.closestFirst&&this.showClosestFirst(this.location);this.isShowing||(this._toggleVisibility(!0),this._followMap(),this.startupDijits(this._title),this.startupDijits(this._contentPane),this.reposition(),this.showHighlight(),this.onShow())}else this._toggleVisibility(!0)},hide:function(){this.isShowing&&(this._toggleVisibility(!1),
this._unfollowMap(),this.keepHighlightOnHide||this.hideHighlight(),this.onHide())},resize:function(b,c){this.popupWindow&&(this._sizers.style({width:b+"px"}),s.set(this._contentPane,"maxHeight",c+"px"),this._maxHeight=c,this.isShowing&&this.reposition())},reposition:function(){this.popupWindow&&this.map&&(this.location&&!this._maximized&&this.isShowing)&&this._setPosition(this.map.toScreen(this.location))},maximize:function(){var b=this.map;if(b&&!this._maximized&&this.popupWindow){this._maximized=
!0;var a=this._maxButton;d.remove(a,"maximize");d.add(a,"restore");c.set(a,"title",this._nls.NLS_restore);var a=this.marginLeft,e=this.marginTop,n=b.width-2*a,b=b.height-2*e;s.set(this.domNode,{left:this._isRTL?null:a+"px",right:this._isRTL?a+"px":null,top:e+"px",bottom:null});s.set(this._positioner,{left:null,right:null,top:null,bottom:null});this._savedWidth=s.get(this._sizers[0],"width");this._savedHeight=s.get(this._contentPane,"maxHeight");this._sizers.style({width:n+"px"});s.set(this._contentPane,
{maxHeight:b-65+"px",height:b-65+"px"});this._showPointer("");this._unfollowMap();d.add(this.domNode,"esriPopupMaximized");this.onMaximize()}},restore:function(){if(this.map&&this._maximized&&this.popupWindow){this._maximized=!1;var b=this._maxButton;d.remove(b,"restore");d.add(b,"maximize");c.set(b,"title",this._nls.NLS_maximize);s.set(this._contentPane,"height",null);this.resize(this._savedWidth,this._savedHeight);this._savedWidth=this._savedHeight=null;this.show(this.location);this._followMap();
d.remove(this.domNode,"esriPopupMaximized");this.onRestore()}},startup:function(){},destroy:function(){this.map&&this.unsetMap();this.cleanup();this.isShowing&&this.hide();this.destroyDijits(this._title);this.destroyDijits(this._content);a.forEach(this._eventConnections,l.disconnect);r.destroy(this.domNode);this._sizers=this._contentPane=this._actionList=this._positioner=this._pointer=this._outerPointer=this._title=this._prevFeatureButton=this._nextFeatureButton=this._spinner=this._eventConnections=
this._pagerScope=this._targetLocation=this._nls=this._maxButton=null},selectNext:function(){this.select(this.selectedIndex+1)},selectPrevious:function(){this.select(this.selectedIndex-1)},setFeatures:function(){this.inherited(arguments);this._updateUI()},postscript:null,_highlightSetter:function(b){var c=this.highlight,a=this.map;this.highlight=b;if(a&&b!==c)if(b){if(this.enableHighlight(a),b=this.features&&this.features[this.selectedIndex])this.updateHighlight(a,b),this.showHighlight()}else this.disableHighlight(a)},
_pagingControlsSetter:function(b){var c=this.pagingControls,a=this.map;this.pagingControls=b;a&&b!==c&&this._updatePagingControls()},_pagingInfoSetter:function(b){var c=this.pagingInfo,a=this.map;this.pagingInfo=b;a&&(b!==c&&this.features&&this.features.length)&&this._updatePagingInfo()},_popupWindowSetter:function(b){var c=this.popupWindow,a=this.map;this.popupWindow=b;a&&b!==c&&(b?(this._updateUI(),this._updateWindow()):(this.hide(),this.showHighlight()))},_anchorSetter:function(b){var c=this.anchor;
this.anchor=b;this.map&&b!==c&&this.reposition()},_featuresCleared:function(){this.setTitle("\x26nbsp;");this.setContent("\x26nbsp;");this._setPagerCallbacks(this);this._updateUI();this.hideHighlight()},_featureSelected:function(){this._updateUI();this._updateWindow()},_updateWindow:function(){var b=this.selectedIndex;if(0<=b){var c=this.features[b].getContent(),a;!this.titleInBody&&c&&f.isString(c.id)&&(a=t.byId(c.id))&&(a.set&&/_PopupRenderer/.test(a.declaredClass))&&a.set("showTitle",!1);this.setContent(c);
this.updateHighlight(this.map,this.features[b]);this.showHighlight()}},_toggleVisibility:function(b){this._setVisibility(b);this.isShowing=b},_setVisibility:function(b){d.toggle(this.domNode,"esriPopupVisible",b);d.toggle(this.domNode,"esriPopupHidden",!b)},_waitAndHide:function(b){var c=this;this._delayHide=!0;setTimeout(function(){c._delayHide&&(c._delayHide=!1,c.hide())},b)},_followMap:function(){this._unfollowMap();var b=this.map;this._handles=[l.connect(b,"onPanStart",this,this._onPanStart),
l.connect(b,"onPan",this,this._onPan),l.connect(b,"onZoomStart",this,this._onZoomStart),l.connect(b,"onExtentChange",this,this._onExtentChange)]},_unfollowMap:function(){var b=this._handles;b&&(a.forEach(b,l.disconnect),this._handles=null)},_onPanStart:function(){var b=this.domNode.style;this._panOrigin={left:b.left,top:b.top,right:b.right,bottom:b.bottom}},_onPan:function(b,c){var a=this._panOrigin,d=c.x,e=c.y,n=a.left,g=a.top,f=a.right,a=a.bottom;n&&(n=parseFloat(n)+d+"px");g&&(g=parseFloat(g)+
e+"px");f&&(f=parseFloat(f)-d+"px");a&&(a=parseFloat(a)-e+"px");s.set(this.domNode,{left:n,top:g,right:f,bottom:a})},_onZoomStart:function(){this._setVisibility(!1)},_onExtentChange:function(b,c,a){a&&(this._setVisibility(!0),this.show(this._targetLocation||this.location));this._targetLocation=null},_toggleSize:function(){this._maximized?this.restore():this.maximize()},_setPosition:function(b){var c=b.x,a=b.y;b=this.offsetX||0;var d=this.offsetY||0,e=0,n=0,g=u.position(this.map.container,!0),f=g.w,
r=g.h,h="Left",t="bottom",v=u.getContentBox(this._positioner),w=v.w/2,k=v.h/2,m=s.get(this._sizers[0],"height")+this._maxHeight+s.get(this._sizers[2],"height"),l=m/2,z=0,x=0,y=c,A=a,p=this.anchor.toLowerCase();if("auto"===p){if(p=q.getBox)p=p(),z=Math.max(p.l,g.x),f=Math.min(p.l+p.w,g.x+g.w),x=Math.max(p.t,g.y),r=Math.min(p.t+p.h,g.y+g.h),y+=g.x,A+=g.y;g=A-x>=m;m=r-A>=m;p=f-y>=v.w;v=y-z>=v.w;A-x>l&&r-A>=l&&(p?(t="",h="Left"):v&&(t="",h="Right"));h&&t&&(y-z>w&&f-y>=w)&&(g?(h="",t="bottom"):m&&(h="",
t="top"));h&&t&&(p&&g?(h="Left",t="bottom"):p&&m?(h="Left",t="top"):v&&m?(h="Right",t="top"):v&&g&&(h="Right",t="bottom"))}else t=h="",-1!==p.indexOf("top")?t="bottom":-1!==p.indexOf("bottom")&&(t="top"),-1!==p.indexOf("left")?h="Right":-1!==p.indexOf("right")&&(h="Left");l=t+h;switch(l){case "top":case "bottom":n=14;break;case "Left":case "Right":e=13;break;case "topLeft":case "topRight":case "bottomLeft":case "bottomRight":n=14,e=-16}s.set(this.domNode,{left:c+"px",top:a+"px",right:null,bottom:null});
c={left:null,right:null,top:null,bottom:null};h?c[h.toLowerCase()]=e+b+"px":c.left=-w+"px";t?c[t]=n+d+"px":c.top=-k+"px";s.set(this._positioner,c);this._showPointer(l)},_showPointer:function(b){d.remove(this._pointer,"top bottom right left topLeft topRight bottomRight bottomLeft hidden".split(" "));d.remove(this._outerPointer,["right","left","hidden"]);"Right"===b||"Left"===b?(b=b.toLowerCase(),d.add(this._outerPointer,b)):d.add(this._pointer,b)},_setPagerCallbacks:function(b,c,a){if(this.pagingControls&&
!(b===this&&(!this._pagerScope||this._pagerScope===this))&&b!==this._pagerScope){this._pagerScope=b;b===this&&(c=this.selectPrevious,a=this.selectNext);var d=this._eventConnections;l.disconnect(d[1]);l.disconnect(d[2]);c&&(d[1]=l.connect(this._prevFeatureButton,"onclick",b,c));a&&(d[2]=l.connect(this._nextFeatureButton,"onclick",b,a))}},_getLocation:function(b){var c=this.map,d,e,n=0,g;if(b=b&&b.geometry)switch(b.type){case "point":d=b;break;case "multipoint":d=b.getPoint(0);e=b.getExtent();break;
case "polyline":d=b.getPoint(0,0);e=b.getExtent();-1!==c._getFrameWidth()&&(a.forEach(b.paths,function(b){b=(new w({paths:[b,c.spatialReference]})).getExtent();var a=Math.abs(b.ymax-b.ymin),d=Math.abs(b.xmax-b.xmin),a=d>a?d:a;a>n&&(n=a,g=b)}),g.spatialReference=e.spatialReference,e=g);break;case "polygon":d=b.getPoint(0,0),e=b.getExtent(),-1!==c._getFrameWidth()&&(a.forEach(b.rings,function(b){b=(new x({rings:[b,c.spatialReference]})).getExtent();var a=Math.abs(b.ymax-b.ymin),d=Math.abs(b.xmax-b.xmin),
a=d>a?d:a;a>n&&(n=a,g=b)}),g.spatialReference=e.spatialReference,e=g)}return[d,e]},_zoomToFeature:function(b){b.preventDefault();var c=this.features,a=this.selectedIndex;b=this.map;if(c){a=this._getLocation(c[a]);c=a[0];a=a[1];c||(c=this.location);if(!a||!a.intersects(this.location))this.location=c;if(a&&a.getWidth()&&a.getHeight())b.setExtent(a,!0);else{var d=b.getNumLevels(),a=b.getLevel(),e=b.getMaxZoom(),n=this.zoomFactor||1;0<d?a!==e&&(d=a+n,d>e&&(d=e),b.navigationManager._wheelZoom({value:d-
a,mapPoint:c},!0)):b.navigationManager._wheelZoom({value:2*(1/Math.pow(2,n)),mapPoint:c},!0)}}},_updatePagingControls:function(){var b=this._prevFeatureButton,c=this._nextFeatureButton,a=this.selectedIndex,e=this.features?this.features.length:0;this.pagingControls&&1<e?(0===a?d.add(b,"hidden"):d.remove(b,"hidden"),a===e-1?d.add(c,"hidden"):d.remove(c,"hidden")):(d.add(b,"hidden"),d.add(c,"hidden"))},_updatePagingInfo:function(){var b=this.features?this.features.length:0,c=this._nls,a="\x26nbsp;";
this.pagingInfo&&(1<b&&c.NLS_pagingInfo)&&(a=v.substitute({index:this.selectedIndex+1,total:b},c.NLS_pagingInfo));if(b&&(c=this.getSelectedFeature(),b=c.getInfoTemplate(),c=c.getTitle(),(!b||/esri\.InfoTemplate/.test(b.declaredClass)||!this.titleInBody)&&c))a=c+("\x26nbsp;"===a?"":" "+a);this.setTitle(a)},_updateUI:function(){if(this.popupWindow){var b=this.features,c=this.deferreds,a=b?b.length:0,e=this._spinner,n=this._actionList,g=this._nls;this._updatePagingControls();this._updatePagingInfo();
a?d.remove(n,"hidden"):d.add(n,"hidden");c&&c.length?b?d.remove(e,"hidden"):this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+g.NLS_searching+"...\x3c/div\x3e"):(d.add(e,"hidden"),a||(this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+g.NLS_noInfo+".\x3c/div\x3e"),this.visibleWhenEmpty||this._waitAndHide(this.hideDelay)))}}})})},"dojo/window":function(){define("./_base/lang ./sniff ./_base/window ./dom ./dom-geometry ./dom-style ./dom-construct".split(" "),function(p,f,a,l,k,
h,q){f.add("rtl-adjust-position-for-verticalScrollBar",function(g,e){var c=a.body(e),d=q.create("div",{style:{overflow:"scroll",overflowX:"visible",direction:"rtl",visibility:"hidden",position:"absolute",left:"0",top:"0",width:"64px",height:"64px"}},c,"last"),f=q.create("div",{style:{overflow:"hidden",direction:"ltr"}},d,"last"),h=0!=k.position(f).x;d.removeChild(f);c.removeChild(d);return h});f.add("position-fixed-support",function(g,e){var c=a.body(e),d=q.create("span",{style:{visibility:"hidden",
position:"fixed",left:"1px",top:"1px"}},c,"last"),f=q.create("span",{style:{position:"fixed",left:"0",top:"0"}},d,"last"),h=k.position(f).x!=k.position(d).x;d.removeChild(f);c.removeChild(d);return h});var m={getBox:function(g){g=g||a.doc;var e="BackCompat"==g.compatMode?a.body(g):g.documentElement,c=k.docScroll(g);if(f("touch")){var d=m.get(g);g=d.innerWidth||e.clientWidth;e=d.innerHeight||e.clientHeight}else g=e.clientWidth,e=e.clientHeight;return{l:c.x,t:c.y,w:g,h:e}},get:function(a){if(f("ie")&&
m!==document.parentWindow){a.parentWindow.execScript("document._parentWindow \x3d window;","Javascript");var e=a._parentWindow;a._parentWindow=null;return e}return a.parentWindow||a.defaultView},scrollIntoView:function(g,e){try{g=l.byId(g);var c=g.ownerDocument||a.doc,d=a.body(c),r=c.documentElement||d.parentNode,u=f("ie")||f("trident"),s=f("webkit");if(!(g==d||g==r))if(!f("mozilla")&&(!u&&!s&&!f("opera")&&!f("trident")&&!f("edge"))&&"scrollIntoView"in g)g.scrollIntoView(!1);else{var t="BackCompat"==
c.compatMode,b=Math.min(d.clientWidth||r.clientWidth,r.clientWidth||d.clientWidth),v=Math.min(d.clientHeight||r.clientHeight,r.clientHeight||d.clientHeight),c=s||t?d:r,n=e||k.position(g),w=g.parentNode,s=function(b){return 6>=u||7==u&&t?!1:f("position-fixed-support")&&"fixed"==h.get(b,"position").toLowerCase()},m=this,q=function(b,c,a){"BODY"==b.tagName||"HTML"==b.tagName?m.get(b.ownerDocument).scrollBy(c,a):(c&&(b.scrollLeft+=c),a&&(b.scrollTop+=a))};if(!s(g))for(;w;){w==d&&(w=c);var y=k.position(w),
p=s(w),B="rtl"==h.getComputedStyle(w).direction.toLowerCase();if(w==c){y.w=b;y.h=v;if(c==r&&(u||f("trident"))&&B)y.x+=c.offsetWidth-y.w;y.x=0;y.y=0}else{var F=k.getPadBorderExtents(w);y.w-=F.w;y.h-=F.h;y.x+=F.l;y.y+=F.t;var E=w.clientWidth,H=y.w-E;0<E&&0<H&&(B&&f("rtl-adjust-position-for-verticalScrollBar")&&(y.x+=H),y.w=E);E=w.clientHeight;H=y.h-E;0<E&&0<H&&(y.h=E)}p&&(0>y.y&&(y.h+=y.y,y.y=0),0>y.x&&(y.w+=y.x,y.x=0),y.y+y.h>v&&(y.h=v-y.y),y.x+y.w>b&&(y.w=b-y.x));var I=n.x-y.x,M=n.y-y.y,Q=I+n.w-y.w,
K=M+n.h-y.h,J,O;if(0<Q*I&&(w.scrollLeft||w==c||w.scrollWidth>w.offsetHeight)){J=Math[0>I?"max":"min"](I,Q);if(B&&(8==u&&!t||5<=f("trident")))J=-J;O=w.scrollLeft;q(w,J,0);J=w.scrollLeft-O;n.x-=J}if(0<K*M&&(w.scrollTop||w==c||w.scrollHeight>w.offsetHeight))J=Math.ceil(Math[0>M?"max":"min"](M,K)),O=w.scrollTop,q(w,0,J),J=w.scrollTop-O,n.y-=J;w=w!=c&&!p&&w.parentNode}}}catch(G){console.error("scrollIntoView: "+G),g.scrollIntoView(!1)}}};p.setObject("dojo.window",m);return m})},"dojo/Stateful":function(){define(["./_base/declare",
"./_base/lang","./_base/array","./when"],function(p,f,a,l){return p("dojo.Stateful",null,{_attrPairNames:{},_getAttrNames:function(a){var f=this._attrPairNames;return f[a]?f[a]:f[a]={s:"_"+a+"Setter",g:"_"+a+"Getter"}},postscript:function(a){a&&this.set(a)},_get:function(a,f){return"function"===typeof this[f.g]?this[f.g]():this[a]},get:function(a){return this._get(a,this._getAttrNames(a))},set:function(a,f){if("object"===typeof a){for(var q in a)a.hasOwnProperty(q)&&"_watchCallbacks"!=q&&this.set(q,
a[q]);return this}q=this._getAttrNames(a);var m=this._get(a,q);q=this[q.s];var g;"function"===typeof q?g=q.apply(this,Array.prototype.slice.call(arguments,1)):this[a]=f;if(this._watchCallbacks){var e=this;l(g,function(){e._watchCallbacks(a,m,f)})}return this},_changeAttrValue:function(a,f){var q=this.get(a);this[a]=f;this._watchCallbacks&&this._watchCallbacks(a,q,f);return this},watch:function(f,h){var q=this._watchCallbacks;if(!q)var m=this,q=this._watchCallbacks=function(c,a,e,g){var f=function(g){if(g){g=
g.slice();for(var b=0,f=g.length;b<f;b++)g[b].call(m,c,a,e)}};f(q["_"+c]);g||f(q["*"])};!h&&"function"===typeof f?(h=f,f="*"):f="_"+f;var g=q[f];"object"!==typeof g&&(g=q[f]=[]);g.push(h);var e={};e.unwatch=e.remove=function(){var c=a.indexOf(g,h);-1<c&&g.splice(c,1)};return e}})})},"esri/InfoWindowBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/dom-construct dojo/has dijit/registry ./kernel ./lang ./geometry/ScreenPoint".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c){return p(null,{declaredClass:"esri.InfoWindowBase",constructor:function(){var c=f.hitch;this.__set_title=c(this,this.__set_title);this.__err_title=c(this,this.__err_title);this.__set_content=c(this,this.__set_content);this.__err_content=c(this,this.__err_content)},setMap:function(c){this.map=c},unsetMap:function(c){delete this.map},setTitle:function(){},setContent:function(){},show:function(){},hide:function(){},resize:function(){},onShow:function(){},onHide:function(){},
place:function(c,a){e.isDefined(c)?f.isObject(c)?h.place(c,a,"only"):a.innerHTML=c:a.innerHTML=""},startupDijits:function(c){this._processDijits(c)},destroyDijits:function(c){this._processDijits(c,!0)},_processDijits:function(c,e){if(c&&1===c.children.length){var g=c.children[0];if(g){var f=m.byNode(g),g=f?[f]:m.findWidgets(g);a.forEach(g,function(c){if(e){if(c._started&&!c._destroyed)try{c.destroyRecursive?c.destroyRecursive():c.destroy&&c.destroy()}catch(b){console.debug("An error occurred when destroying a widget embedded within InfoWindow: "+
b.message)}}else if(!c._started)try{c.startup()}catch(a){console.debug("An error occurred when starting a widget embedded within InfoWindow: "+a.message)}})}}},__registerMapListeners:function(){this.__unregisterMapListeners();var c=this.map;this.__handles=[l.connect(c,"onPan",this,this.__onMapPan),l.connect(c,"onZoomStart",this,this.__onMapZmStart),l.connect(c,"onExtentChange",this,this.__onMapExtChg)]},__unregisterMapListeners:function(){var c=this.__handles;c&&(a.forEach(c,l.disconnect,l),this.__handles=
null)},__onMapPan:function(c,a){this.move(a,!0)},__onMapZmStart:function(){this.__mcoords=this.mapCoords||this.map.toMap(new c(this.coords));this.hide(null,!0)},__onMapExtChg:function(c,a,e){c=this.map;var g=this.mapCoords;g?this.show(g,null,!0):(a=e?c.toScreen(this.__mcoords):this.coords.offset(a&&a.x||0,a&&a.y||0),this.show(a,null,!0))},__setValue:function(c,a){this[c].innerHTML="";var g="_dfd"+c,f=this[g];f&&-1===f.fired&&(f.cancel(),this[g]=null);e.isDefined(a)&&(a instanceof k?(this[g]=a,a.addCallbacks(this["__set"+
c],this["__err"+c])):this.__render(c,a))},__set_title:function(c){this._dfd_title=null;this.__render("_title",c)},__err_title:function(c){this._dfd_title=null},__set_content:function(c){this._dfd_content=null;this.__render("_content",c)},__err_content:function(c){this._dfd_content=null},__render:function(c,a){var e=this[c];this.place(a,e);this.isShowing&&(this.startupDijits(e),"_title"===c&&this._adjustContentArea&&this._adjustContentArea())}})})},"esri/PopupBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Color dojo/_base/Deferred dojo/has ./kernel ./graphic ./geometry/Point ./geometry/jsonUtils ./geometry/mathUtils ./geometry/webMercatorUtils ./symbols/SimpleMarkerSymbol ./symbols/SimpleLineSymbol ./symbols/CartographicLineSymbol ./symbols/SimpleFillSymbol ./tasks/query ./Evented require".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v){function n(b){return"sizeInfo"===b.type}return p(v,{declaredClass:"esri.PopupBase",_featureLayers:{},_updateEndHandles:[],_evtMap:{"set-features":!0,"clear-features":!0,"selection-change":!0,"dfd-complete":!0},onSetFeatures:function(){},onClearFeatures:function(){},onSelectionChange:function(){},onDfdComplete:function(){},initialize:function(){this.count=0;this.selectedIndex=-1;this.on("clear-features",f.hitch(this,this._resetUpdateEndListeners));this.on("dfd-complete",
f.hitch(this,this._processFeatures));this.on("set-features",f.hitch(this,this._processFeatures))},cleanup:function(){this.features=this.deferreds=null;this._resetUpdateEndListeners()},setFeatures:function(b){if(b&&b.length){this.clearFeatures();var c,d;b[0]instanceof k?d=b:c=b;c?this._updateFeatures(null,c):(this.deferreds=d,d=d.slice(0),a.forEach(d,function(b){b.addBoth(f.hitch(this,this._updateFeatures,b))},this))}},clearFeatures:function(){this.features=this.deferreds=this._marked=null;this.count=
0;var b=this.selectedIndex;this.selectedIndex=-1;if(-1<b)this.onSelectionChange();this.onClearFeatures()},getSelectedFeature:function(){var b=this.features;if(b)return b[this.selectedIndex]},select:function(b){0>b||b>=this.count||(this.selectedIndex=b,this.onSelectionChange())},enableHighlight:function(b){this._highlighted=b.graphics.add(new m(new g(0,0,b.spatialReference)));this._highlighted.hide();this.markerSymbol||(b=this.markerSymbol=new r,b.setStyle(r.STYLE_TARGET),b._setDim(16,16,0),b.setOutline(new s(u.STYLE_SOLID,
new l([0,255,255]),2,s.CAP_ROUND,s.JOIN_ROUND)),b.setColor(new l([0,0,0,0])));this.lineSymbol||(this.lineSymbol=new u(u.STYLE_SOLID,new l([0,255,255]),2));this.fillSymbol||(this.fillSymbol=new t(t.STYLE_NULL,new u(u.STYLE_SOLID,new l([0,255,255]),2),new l([0,0,0,0])))},disableHighlight:function(b){var c=this._highlighted;c&&(c.hide(),b.graphics.remove(c),delete this._highlighted);this.markerSymbol=this.lineSymbol=this.fillSymbol=null},showHighlight:function(){var b=this.features&&this.features[this.selectedIndex];
this._highlighted&&(b&&b.geometry)&&this._highlighted.show()},hideHighlight:function(){this._highlighted&&this._highlighted.hide()},updateHighlight:function(b,c){var a=c.geometry,d=this._highlighted;if(!a||!d)d&&d.hide();else{d.hide();!d._graphicsLayer&&b&&b.graphics.add(d);d.setGeometry(e.fromJson(a.toJson()));var n;switch(a.type){case "point":case "multipoint":var g=c.getLayer(),a=c.symbol||g&&g._getSymbol(c);if(g&&a){var f,r,h=0,t=0,s=0;n=!c.symbol?g._getRenderer(c):null;if(g=this._getSizeInfo(n))f=
r=n.getSize(c,{sizeInfo:g,shape:a.style,resolution:b&&b.getResolutionInMeters&&b.getResolutionInMeters()});else switch(a.type){case "simplemarkersymbol":f=r=a.size||0;break;case "picturemarkersymbol":f=a.width||0,r=a.height||0}h=a.xoffset||0;t=a.yoffset||0;s=a.angle||0;n=this.markerSymbol;n.setOffset(0,0);n.setAngle(0);f&&r&&n._setDim(f+1,r+1,0);n.setOffset(h,t);n.setAngle(s)}break;case "polyline":n=this.lineSymbol;break;case "polygon":n=this.fillSymbol}d.setSymbol(n)}},showClosestFirst:function(b){var a=
this.features;if(a&&a.length){if(1<a.length){var e,n=Infinity,g=-1,f,r=c.getLength,h,t=b.spatialReference,s,u;b=b.normalize();for(e=a.length-1;0<=e;e--)if(f=a[e].geometry){s=f.spatialReference;h=0;try{u="point"===f.type?f:f.getExtent().getCenter(),u=u.normalize(),t&&(s&&!t.equals(s)&&t._canProject(s))&&(u=t.isWebMercator()?d.geographicToWebMercator(u):d.webMercatorToGeographic(u)),h=r(b,u)}catch(v){}0<h&&h<n&&(n=h,g=e)}0<g&&(a.splice(0,0,a.splice(g,1)[0]),this.select(0))}}else this.deferreds&&(this._marked=
b)},_unbind:function(b){b=a.indexOf(this.deferreds,b);if(-1!==b)return this.deferreds.splice(b,1),!this.deferreds.length?(this.deferreds=null,2):1},_fireComplete:function(b){var c=this._marked;c&&(this._marked=null,this.showClosestFirst(c));this.onDfdComplete(b)},_updateFeatures:function(b,c){if(b){if(this.deferreds){var d=this._unbind(b);if(d)if(c&&c instanceof Error){if(this._fireComplete(c),2===d)this.onSetFeatures()}else if(c&&c.length)if(this.features){var e=a.filter(c,function(b){return-1===
a.indexOf(this.features,b)},this);this.features=this.features.concat(e);this.count=this.features.length;this._fireComplete();if(2===d)this.onSetFeatures()}else{this.features=c;this.count=c.length;this.selectedIndex=0;this._fireComplete();if(2===d)this.onSetFeatures();this.select(0)}else if(this._fireComplete(),2===d)this.onSetFeatures()}}else this.features=c,this.count=c.length,this.selectedIndex=0,this.onSetFeatures(),this.select(0)},_getSizeInfo:function(b){return b?b.sizeInfo||a.filter(b.visualVariables,
n)[0]:null},_resetUpdateEndListeners:function(){this._featureLayers={};a.forEach(this._updateEndHandles,function(b){b.remove()});this._updateEndHandles=[]},_processFeatures:function(){a.forEach(this.features,function(b){if((b=b.getLayer())&&!this._featureLayers[b.id]&&(1===b.currentMode||0===b.currentMode&&6===b.mode)&&b.objectIdField&&b.hasXYFootprint&&b.queryFeatures&&("esriGeometryPolygon"===b.geometryType||"esriGeometryPolyline"===b.geometryType||b.hasXYFootprint()))this._featureLayers[b.id]=
b,b=b.on("update-end",f.hitch(this,this._fLyrUpdateEndHandler)),this._updateEndHandles.push(b)},this)},_fLyrUpdateEndHandler:function(c){if(!c.error){var d=this,e=c.target,n=e.getSelectedFeatures(),g=0===e.currentMode&&6===e.mode,f={},r=[];a.forEach(this.features,function(b){if(b.getLayer()===e){var c=b.attributes[e.objectIdField];f[c]=b;r.push(c)}});r.length&&(c=new b,c.objectIds=r,e.queryFeatures(c,function(b){a.forEach(b.features,function(b){var c=f[b.attributes[e.objectIdField]],d=!1;c.geometry!==
b.geometry?(c.setGeometry(b.geometry),d=!0):g&&(n&&-1!==a.indexOf(n,b))&&(d=!0);d&&(this._highlighted&&c===this.getSelectedFeature())&&this._highlighted.setGeometry(b.geometry)},d)}))}}})})},"esri/graphic":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./domUtils ./lang ./InfoTemplate ./geometry/jsonUtils ./symbols/jsonUtils".split(" "),function(p,f,a,l,k,h,q,m,g){p=p(null,{declaredClass:"esri.Graphic",constructor:function(a,c,d,f){a&&!a.declaredClass?(this.geometry=a.geometry?
m.fromJson(a.geometry):null,this.symbol=a.symbol?g.fromJson(a.symbol):null,this.attributes=a.attributes||null,this.infoTemplate=a.infoTemplate?new q(a.infoTemplate):null):(this.geometry=a,this.symbol=c,this.attributes=d,this.infoTemplate=f)},_shape:null,_graphicsLayer:null,_visible:!0,visible:!0,getDojoShape:function(){return this._shape},getShapes:function(){var a=[];this._shape&&a.push(this._shape);this._bgShape&&a.push(this._bgShape);return a},getNode:function(){var a=this._shape&&this._shape.getNode();
return a&&a.nodeType?a:null},getNodes:function(){var a=this.getShapes(),c,d,g=a.length,f=[];for(d=0;d<g;d++)(c=a[d]&&a[d].getNode())&&c.nodeType&&f.push(c);return f},getLayer:function(){return this._layer},draw:function(){var a=this._graphicsLayer;a&&a._draw(this,!0);return this},setGeometry:function(a){this.geometry=a;if(a=this._graphicsLayer)a._updateExtent(this),a._draw(this,!0);return this},setSymbol:function(a,c){var d=this._graphicsLayer,g=this._shape;this.symbol=a;d&&(c&&g&&d._removeShape(this),
d._draw(this,!0));return this},setAttributes:function(a){this.attributes=a;this._clearCache();return this},setInfoTemplate:function(a){this.infoTemplate=a;return this},getInfoTemplate:function(){return this._getEffInfoTemplate()},_getEffInfoTemplate:function(){var a=this.getLayer();return this.infoTemplate||a&&a.infoTemplate},getTitle:function(){var a=this.getInfoTemplate(),c=a&&a.title;if(f.isFunction(c))c=c.call(a,this);else if(f.isString(c))var d=(a=this.getLayer())&&a._getDateOpts,c=h.substitute(this.attributes,
c,{first:!0,dateFormat:d&&d.call(a)});return c},getContent:function(){var a=this.getInfoTemplate(),c=a&&a.content;if(f.isFunction(c))c=c.call(a,this);else if(f.isString(c))var d=(a=this.getLayer())&&a._getDateOpts,c=h.substitute(this.attributes,c,{dateFormat:d&&d.call(a)});return c},attr:function(a,c){var d=this.getNodes(),g,f=d.length;for(g=0;g<f;g++)null==c?d[g].removeAttribute(a):d[g].setAttribute(a,c);return this},show:function(){this.visible=this._visible=!0;var a,c,d;if(this.getShapes().length){a=
this.getNodes();d=a.length;this.attr("data-hidden");for(c=0;c<d;c++)k.show(a[c])}else this._graphicsLayer&&this._graphicsLayer._draw(this,!0);return this},hide:function(){this.visible=this._visible=!1;var a=this._graphicsLayer,c,d;if(a)if("canvas-2d"===a.surfaceType)a._removeShape(this);else if(a=this.getNodes(),d=a.length){this.attr("data-hidden","");for(c=0;c<d;c++)k.hide(a[c])}return this},toJson:function(){var a={};this.geometry&&(a.geometry=this.geometry.toJson());this.attributes&&(a.attributes=
f.mixin({},this.attributes));this.symbol&&(a.symbol=this.symbol.toJson());this.infoTemplate&&(a.infoTemplate=this.infoTemplate.toJson());return a},_getDataValue:function(a,c,d){var g=this._getCacheItem(a,c);if(void 0===g.value){var h=null,s=this.attributes,t=a.field;if(c.exprTree)h=d.executeExpression(c.exprTree,d.createExecContext(this));else if(f.isFunction(t))h=t(this);else if(s&&(h=s[t],(a=a.normalizationField)&&this._isValidNumber(h)))s=parseFloat(s[a]),h=this._isValidNumber(s)&&0!==s?h/s:null;
this._isValidNumber(h)||(h=null);g.value=h}return g.value},_isValidNumber:function(a){return"number"===typeof a&&!isNaN(a)},_getCacheItem:function(a,c){var d=this._findCacheItem(a);d?d.version!==c.version&&(d.version=c.version,d.value=void 0):d=this._createCacheItem(a,c);return d},_findCacheItem:function(a){var c,d=this._cache;if(d){var g,f=d.length;for(g=0;g<f;g++){var h=d[g];if(h.variable===a){c=h;break}}}return c},_createCacheItem:function(a,c){var d=this._cache;d||(d=this._cache=[]);var g={variable:a,
version:c.version,value:void 0};d.push(g);return g},_clearCache:function(){this._cache=null}});p.prototype.getShape=p.prototype.getDojoShape;return p})},"esri/InfoTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel","./lang"],function(p,f,a,l,k){return p(null,{declaredClass:"esri.InfoTemplate",constructor:function(a,k){a&&f.isObject(a)&&!f.isFunction(a)?f.mixin(this,a):(this.title=a||"${*}",this.content=k||"${*}")},setTitle:function(a){this.title=a;return this},
setContent:function(a){this.content=a;return this},toJson:function(){return k.fixJson({title:this.title,content:this.content})}})})},"esri/geometry/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ./Point ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(p,f,a,l,k,h,q,m){return{fromJson:function(a){if(void 0!==a.x&&void 0!==a.y)return new l(a);if(void 0!==a.paths)return new k(a);if(void 0!==a.rings)return new h(a);if(void 0!==a.points)return new q(a);if(void 0!==a.xmin&&
void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax)return new m(a)},getJsonType:function(a){return a instanceof l?"esriGeometryPoint":a instanceof k?"esriGeometryPolyline":a instanceof h?"esriGeometryPolygon":a instanceof m?"esriGeometryEnvelope":a instanceof q?"esriGeometryMultipoint":null},getGeometryType:function(a){return"esriGeometryPoint"===a?l:"esriGeometryPolyline"===a?k:"esriGeometryPolygon"===a?h:"esriGeometryEnvelope"===a?m:"esriGeometryMultipoint"===a?q:null}}})},"esri/symbols/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ./SimpleMarkerSymbol ./PictureMarkerSymbol ./SimpleLineSymbol ./CartographicLineSymbol ./SimpleFillSymbol ./PictureFillSymbol ./TextSymbol".split(" "),
function(p,f,a,l,k,h,q,m,g,e){return{fromJson:function(c){var a=null;switch(c.type){case "esriSMS":a=new l(c);break;case "esriPMS":a=new k(c);break;case "esriTS":a=new e(c);break;case "esriSLS":a=void 0!==c.cap?new q(c):new h(c);break;case "esriCLS":a=new q(c);break;case "esriSFS":a=new m(c);break;case "esriPFS":a=new g(c)}return a},getShapeDescriptors:function(c){return c&&c.getShapeDescriptors?c.getShapeDescriptors():{defaultShape:null,fill:null,stroke:null}}}})},"esri/symbols/PictureMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol".split(" "),
function(p,f,a,l,k,h,q,m){var g={url:"",width:12,height:12,angle:0,xoffset:0,yoffset:0};p=p(m,{declaredClass:"esri.symbol.PictureMarkerSymbol",type:"picturemarkersymbol",constructor:function(e,c,d){e?f.isString(e)?(this.url=e,c&&(this.width=c),d&&(this.height=d)):(this.width=l.pt2px(e.width),this.height=l.pt2px(e.height),c=e.imageData,!(9>a("ie"))&&c&&(d=this.url,this.url="data:"+(e.contentType||"image")+";base64,"+c,this.imageData=d)):(f.mixin(this,g),this.width=l.pt2px(this.width),this.height=l.pt2px(this.height))},
getStroke:function(){return null},getFill:function(){return null},setWidth:function(a){this.width=a;return this},setHeight:function(a){this.height=a;return this},setUrl:function(a){a!==this.url&&(delete this.imageData,delete this.contentType);this.url=a;return this},getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||""},fill:null,stroke:null}},toJson:function(){var a=this.url,c=
this.imageData;if(0===a.indexOf("data:"))var d=a,a=c,c=d.indexOf(";base64,")+8,c=d.substr(c);if(f.isString(a)&&(0===a.indexOf("/")||0===a.indexOf("//")||0===a.indexOf("./")||0===a.indexOf("../")))a=q.getAbsoluteUrl(a);var d=l.px2pt(this.width),d=isNaN(d)?void 0:d,g=l.px2pt(this.height),g=isNaN(g)?void 0:g,a=h.fixJson(f.mixin(this.inherited("toJson",arguments),{type:"esriPMS",url:a,imageData:c,contentType:this.contentType,width:d,height:g}));delete a.color;delete a.size;a.imageData||delete a.imageData;
return a}});p.defaultProps=g;return p})},"esri/symbols/CartographicLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./SimpleLineSymbol".split(" "),function(p,f,a,l,k,h,q,m){var g={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",STYLE_NULL:"none",STYLE_INSIDE_FRAME:"insideframe",STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",
STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot",CAP_BUTT:"butt",CAP_ROUND:"round",CAP_SQUARE:"square",JOIN_MITER:"miter",JOIN_ROUND:"round",JOIN_BEVEL:"bevel"},e={color:[0,0,0,1],style:g.STYLE_SOLID,width:1,cap:g.CAP_BUTT,join:g.JOIN_MITER,miterLimit:10};p=p(m,{declaredClass:"esri.symbol.CartographicLineSymbol",type:"cartographiclinesymbol",_caps:{butt:"esriLCSButt",round:"esriLCSRound",square:"esriLCSSquare"},_joins:{miter:"esriLJSMiter",round:"esriLJSRound",
bevel:"esriLJSBevel"},constructor:function(c,d,g,h,s,t){c?f.isString(c)?(this.style=c,d&&(this.color=d),void 0!==g&&(this.width=g),h&&(this.cap=h),s&&(this.join=s),void 0!==t&&(this.miterLimit=t)):(this.cap=q.valueOf(this._caps,c.cap),this.join=q.valueOf(this._joins,c.join),this.width=k.pt2px(c.width),this.miterLimit=k.pt2px(c.miterLimit)):(f.mixin(this,e),this.color=new a(this.color),this.width=k.pt2px(this.width),this.miterLimit=k.pt2px(this.miterLimit))},setCap:function(c){this.cap=c;return this},
setJoin:function(c){this.join=c;return this},setMiterLimit:function(c){this.miterLimit=c;return this},getStroke:function(){return f.mixin(this.inherited("getStroke",arguments),{cap:this.cap,join:this.join===g.JOIN_MITER?this.miterLimit:this.join})},getFill:function(){return null},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},fill:null,stroke:this.getStroke()}},toJson:function(){var c=k.px2pt(this.miterLimit),c=isNaN(c)?void 0:c;return q.fixJson(f.mixin(this.inherited("toJson",
arguments),{type:"esriCLS",cap:this._caps[this.cap],join:this._joins[this.join],miterLimit:c}))}});f.mixin(p,g);p.defaultProps=e;return p})},"esri/symbols/SimpleFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./FillSymbol ./SimpleLineSymbol require".split(" "),function(p,f,a,l,k,h,q,m,g,e){var c={STYLE_SOLID:"solid",STYLE_NULL:"none",STYLE_HORIZONTAL:"horizontal",STYLE_VERTICAL:"vertical",STYLE_FORWARD_DIAGONAL:"forwarddiagonal",
STYLE_BACKWARD_DIAGONAL:"backwarddiagonal",STYLE_CROSS:"cross",STYLE_DIAGONAL_CROSS:"diagonalcross",STYLE_FORWARDDIAGONAL:"forwarddiagonal",STYLE_BACKWARDDIAGONAL:"backwarddiagonal",STYLE_DIAGONALCROSS:"diagonalcross"},d={style:c.STYLE_SOLID,color:[0,0,0,0.25]};p=p(m,{declaredClass:"esri.symbol.SimpleFillSymbol",type:"simplefillsymbol",_styles:{solid:"esriSFSSolid",none:"esriSFSNull",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical",forwarddiagonal:"esriSFSForwardDiagonal",backwarddiagonal:"esriSFSBackwardDiagonal",
cross:"esriSFSCross",diagonalcross:"esriSFSDiagonalCross"},constructor:function(c,e,h){c?f.isString(c)?(this.style=c,void 0!==e&&(this.outline=e),void 0!==h&&(this.color=h)):this.style=q.valueOf(this._styles,c.style):(f.mixin(this,d),this.outline=new g(this.outline),this.color=new a(this.color))},setStyle:function(c){this.style=c;return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){var a=this.style;return a===c.STYLE_NULL?null:a===c.STYLE_SOLID?this.color:
f.mixin({},k.defaultPattern,{src:e.toUrl("../images/symbol/sfs/"+a+".png"),width:10,height:10})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 E"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){return q.fixJson(f.mixin(this.inherited("toJson",arguments),{type:"esriSFS",style:this._styles[this.style]}))}});f.mixin(p,c);p.defaultProps=d;return p})},"esri/symbols/FillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./Symbol ./SimpleLineSymbol".split(" "),
function(p,f,a,l,k,h){return p(k,{declaredClass:"esri.symbol.FillSymbol",constructor:function(a){a&&(f.isObject(a)&&a.outline)&&(this.outline=new h(a.outline))},setOutline:function(a){this.outline=a;return this},toJson:function(){var a=this.inherited("toJson",arguments);this.outline&&(a.outline=this.outline.toJson());return a}})})},"esri/symbols/PictureFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./FillSymbol".split(" "),
function(p,f,a,l,k,h,q,m){var g={xoffset:0,yoffset:0,width:12,height:12};p=p(m,{declaredClass:"esri.symbol.PictureFillSymbol",type:"picturefillsymbol",xscale:1,yscale:1,xoffset:0,yoffset:0,constructor:function(e,c,d,r){e?f.isString(e)?(this.url=e,void 0!==c&&(this.outline=c),void 0!==d&&(this.width=d),void 0!==r&&(this.height=r)):(this.xoffset=l.pt2px(e.xoffset),this.yoffset=l.pt2px(e.yoffset),this.width=l.pt2px(e.width),this.height=l.pt2px(e.height),c=e.imageData,!(9>a("ie"))&&c&&(d=this.url,this.url=
"data:"+(e.contentType||"image")+";base64,"+c,this.imageData=d)):(f.mixin(this,g),this.width=l.pt2px(this.width),this.height=l.pt2px(this.height))},setWidth:function(a){this.width=a;return this},setHeight:function(a){this.height=a;return this},setOffset:function(a,c){this.xoffset=a;this.yoffset=c;return this},setUrl:function(a){a!==this.url&&(delete this.imageData,delete this.contentType);this.url=a;return this},setXScale:function(a){this.xscale=a;return this},setYScale:function(a){this.yscale=a;
return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return f.mixin({},l.defaultPattern,{src:this.url,width:this.width*this.xscale,height:this.height*this.yscale,x:this.xoffset,y:this.yoffset})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 E"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var a=this.url,c=this.imageData;if(0===a.indexOf("data:"))var d=a,a=c,c=d.indexOf(";base64,")+
8,c=d.substr(c);if(f.isString(a)&&(0===a.indexOf("/")||0===a.indexOf("//")||0===a.indexOf("./")||0===a.indexOf("../")))a=q.getAbsoluteUrl(a);var d=l.px2pt(this.width),d=isNaN(d)?void 0:d,g=l.px2pt(this.height),g=isNaN(g)?void 0:g,u=l.px2pt(this.xoffset),u=isNaN(u)?void 0:u,s=l.px2pt(this.yoffset),s=isNaN(s)?void 0:s,a=h.fixJson(f.mixin(this.inherited("toJson",arguments),{type:"esriPFS",url:a,imageData:c,contentType:this.contentType,width:d,height:g,xoffset:u,yoffset:s,xscale:this.xscale,yscale:this.yscale}));
a.imageData||delete a.imageData;return a}});p.defaultProps=g;return p})},"esri/symbols/TextSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Symbol ./Font".split(" "),function(p,f,a,l,k,h,q,m,g){var e={type:"textsymbol",x:0,y:0,text:"",rotated:!1,kerning:!0,color:[0,0,0,1],font:l.defaultFont,angle:0,xoffset:0,yoffset:0,horizontalAlignment:"center"},c={start:"left",middle:"center",end:"right"},d={left:"start",center:"middle",right:"end",
justify:"start"},r={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},u=document.createElement("canvas");p=p(m,{declaredClass:"esri.symbol.TextSymbol",angle:0,xoffset:0,yoffset:0,constructor:function(c,a,b){f.mixin(this,e);this.font=new g(this.font);this.color=new q(this.color);c&&(f.isObject(c)?(f.mixin(this,c),this.color&&h.isDefined(this.color[0])&&(this.color=q.toDojoColor(this.color)),this.type="textsymbol",this.font=new g(this.font),this.xoffset=l.pt2px(this.xoffset),
this.yoffset=l.pt2px(this.yoffset),this.angle&&(this.angle*=-1),this.haloSize&&(this.haloSize=l.pt2px(this.haloSize)),this.haloColor&&(this.haloColor=q.toDojoColor(this.haloColor))):(this.text=c,a&&(this.font=a),b&&(this.color=b)));this.setAlign(this.align||this.getSVGAlign())},setFont:function(c){this.font=c;return this},setSize:function(c){this.font.size=c;return this},setAngle:function(c){this.angle=c;return this},setOffset:function(c,a){this.xoffset=c;this.yoffset=a;return this},setHaloColor:function(c){this.haloColor=
c;return this},setHaloSize:function(c){this.haloSize=c;return this},setAlign:function(a){this.align=a;this.setHorizontalAlignment(a&&c[a.toLowerCase()]||"center");return this},setHorizontalAlignment:function(c){this.horizontalAlignment=c;return this},getSVGAlign:function(){var c=this.horizontalAlignment;return c=c&&d[c.toLowerCase()]||"middle"},setVerticalAlignment:function(c){this.verticalAlignment=c;return this},getSVGBaseline:function(){var c=this.verticalAlignment;return c&&r[c.toLowerCase()]||
"alphabetic"},getSVGBaselineShift:function(){return"bottom"===this.verticalAlignment?"super":null},setDecoration:function(c){this.decoration=c;this.font||this.setFont(new g);this.font.setDecoration(c);return this},setRotated:function(c){this.rotated=c;return this},setKerning:function(c){this.kerning=c;return this},setText:function(c){this.text=c;return this},getStroke:function(){return null},getFill:function(){return this.color},getWidth:function(){var c=u&&u.getContext&&u.getContext("2d");if(c){var a=
this.font;c.font=(a.style?a.style:l.defaultFont.style)+" "+(a.weight?a.weight:l.defaultFont.weight)+" "+(a.size?a.size:l.defaultFont.size)+"px "+(a.family?a.family:l.defaultFont.family);return c.measureText(this.text).width}var c=this.getHeight(),a=0,b,d;for(b=0;b<this.text.length;b++)d=this.text.charAt(b),a=d==d.toUpperCase()?a+0.7*c:a+0.5*c;return a},getHeight:function(){return l.normalizedLength(this.font.size)},getShapeDescriptors:function(){var c=this.font,a;c&&(a={},c.size&&(a.size=c.size),
c.style&&(a.style=c.style),c.variant&&(a.variant=c.variant),c.decoration&&(a.decoration=c.decoration),c.weight&&(a.weight=c.weight),c.family&&(a.family=c.family));return{defaultShape:{type:"text",text:this.text,x:0,y:this.getHeight()/4,align:"middle",decoration:this.decoration||c&&c.decoration,rotated:this.rotated,kerning:this.kerning},font:a,fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var c=l.px2pt(this.xoffset),a=l.px2pt(this.yoffset),b=l.px2pt(this.haloSize),c=isNaN(c)?void 0:
c,a=isNaN(a)?void 0:a,b=isNaN(b)?void 0:b;return h.fixJson(f.mixin(this.inherited("toJson",arguments),{type:"esriTS",backgroundColor:this.backgroundColor,borderLineColor:this.borderLineColor,borderLineSize:this.borderLineSize,haloSize:b,haloColor:this.haloColor&&q.toJsonColor(this.haloColor),verticalAlignment:this.verticalAlignment,horizontalAlignment:this.horizontalAlignment,rightToLeft:this.rightToLeft,width:this.width,angle:this.angle&&-1*this.angle,xoffset:c,yoffset:a,text:this.text,rotated:this.rotated,
kerning:this.kerning,font:this.font.toJson()}))}});f.mixin(p,{ALIGN_START:"start",ALIGN_MIDDLE:"middle",ALIGN_END:"end",DECORATION_NONE:"none",DECORATION_UNDERLINE:"underline",DECORATION_OVERLINE:"overline",DECORATION_LINETHROUGH:"line-through"});p.defaultProps=e;return p})},"esri/symbols/Font":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang".split(" "),function(p,f,a,l,k,h){p=p(null,{declaredClass:"esri.symbol.Font",constructor:function(h,k,g,e,
c){h?f.isObject(h)?f.mixin(this,h):(this.size=h,parseFloat(this.size)==this.size&&(this.size+="px"),void 0!==k&&(this.style=k),void 0!==g&&(this.variant=g),void 0!==e&&(this.weight=e),void 0!==c&&(this.family=c)):f.mixin(this,l.defaultFont);parseFloat(this.size)==this.size&&(this.size+="pt");9>a("ie")&&(this.size&&f.isString(this.size)&&-1<this.size.indexOf("em"))&&(this.size=l.pt2px(12*parseFloat(this.size))+"px");this.size=this._convert2PxSize(this.size)},setSize:function(a){this.size=this._convert2PxSize(a);
return this},_convert2PxSize:function(a){var h;parseFloat(a)==a?h=a:f.isString(a)&&(-1<a.indexOf("pt")?h=l.pt2px(parseFloat(a)):-1<a.indexOf("px")?h=parseFloat(a):-1<a.indexOf("em")?h=l.pt2px(12*parseFloat(a)):-1<a.indexOf("%")&&(h=l.pt2px(0.12*parseFloat(a))));return h},setStyle:function(a){this.style=a;return this},setVariant:function(a){this.variant=a;return this},setWeight:function(a){this.weight=a;return this},setFamily:function(a){this.family=a;return this},setDecoration:function(a){this.decoration=
a;return this},toJson:function(){return h.fixJson({size:l.px2pt(this.size),style:this.style,variant:this.variant,decoration:this.decoration,weight:this.weight,family:this.family})}});f.mixin(p,{STYLE_NORMAL:"normal",STYLE_ITALIC:"italic",STYLE_OBLIQUE:"oblique",VARIANT_NORMAL:"normal",VARIANT_SMALLCAPS:"small-caps",WEIGHT_NORMAL:"normal",WEIGHT_BOLD:"bold",WEIGHT_BOLDER:"bolder",WEIGHT_LIGHTER:"lighter"});return p})},"esri/tasks/query":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils ./SpatialRelationship require require require".split(" "),
function(p,f,a,l,k,h,q,m){var g=p(null,{declaredClass:"esri.tasks.Query",constructor:function(){this.spatialRelationship=g.SPATIAL_REL_INTERSECTS},text:null,where:"",geometry:null,groupByFieldsForStatistics:null,objectIds:null,returnGeometry:!1,returnDistinctValues:!1,orderByFields:null,outSpatialReference:null,outFields:null,outStatistics:null,timeExtent:null,relationParam:null,pixelSize:null,distance:null,units:null,resultOffset:null,resultRecordCount:null,resultType:null,sqlFormat:null,quantizationParameters:null,
_units:{meters:"esriSRUnit_Meter",kilometers:"esriSRUnit_Kilometer",feet:"esriSRUnit_Foot",miles:"esriSRUnit_StatuteMile","nautical-miles":"esriSRUnit_NauticalMile","us-nautical-miles":"esriSRUnit_USNauticalMile"},toJson:function(e){var c={text:this.text,where:this.where,returnGeometry:this.returnGeometry,spatialRel:this.spatialRelationship,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision,sqlFormat:this.sqlFormat},d=e&&e.geometry||this.geometry,f=this.objectIds,
h=this.outFields,s=this.outSpatialReference,t=this.groupByFieldsForStatistics,b=this.orderByFields,v=this.outStatistics;e=this.distance;d&&(c.geometry=d,c.geometryType=q.getJsonType(d),c.inSR=d.spatialReference.wkid||l.toJson(d.spatialReference.toJson()));f&&(c.objectIds=f.join(","));h&&(c.outFields=h.join(","));this.returnDistinctValues&&(c.returnDistinctValues=!0);t&&(c.groupByFieldsForStatistics=t.join(","));b&&(c.orderByFields=b.join(","));if(v){var n=[];a.forEach(v,function(b){n.push(b.toJson())});
c.outStatistics=l.toJson(n)}s?c.outSR=s.wkid||l.toJson(s.toJson()):d&&(c.outSR=d.spatialReference.wkid||l.toJson(d.spatialReference.toJson()));d=this.timeExtent;c.time=d?d.toJson().join(","):null;if((d=this.relationParam)&&this.spatialRelationship===g.SPATIAL_REL_RELATION)c.relationParam=d;e&&(c.distance=this.distance,this.hasOwnProperty("units")?c.units=this._units[this.units]||this._units.meters:(console.warn("esri/tasks/query::no distance unit provided, defaulting to meters"),c.units=this._units.meters));
this.hasOwnProperty("start")&&(c.resultOffset=this.start,c.resultRecordCount=10,""===c.where&&(c.where="1\x3d1"));this.hasOwnProperty("num")&&(c.resultRecordCount=this.num);c.resultType=this.resultType;c.pixelSize=this.pixelSize?l.toJson(this.pixelSize.toJson()):null;c.multipatchOption=this.multipatchOption;this.quantizationParameters&&(c.quantizationParameters=l.toJson(this.quantizationParameters));c._ts=this._ts;return c}});f.mixin(g,m);return g})},"esri/tasks/SpatialRelationship":function(){define(["dojo/_base/lang",
"dojo/has","../kernel"],function(p,f,a){return{SPATIAL_REL_INTERSECTS:"esriSpatialRelIntersects",SPATIAL_REL_CONTAINS:"esriSpatialRelContains",SPATIAL_REL_CROSSES:"esriSpatialRelCrosses",SPATIAL_REL_ENVELOPEINTERSECTS:"esriSpatialRelEnvelopeIntersects",SPATIAL_REL_INDEXINTERSECTS:"esriSpatialRelIndexIntersects",SPATIAL_REL_OVERLAPS:"esriSpatialRelOverlaps",SPATIAL_REL_TOUCHES:"esriSpatialRelTouches",SPATIAL_REL_WITHIN:"esriSpatialRelWithin",SPATIAL_REL_RELATION:"esriSpatialRelRelation"}})},"esri/plugins/popupManager":function(){define(["../PopupManager"],
function(p){return{add:function(f,a){f.popupManager||(f.popupManager=new p(a),f.popupManager.setMap(f))},remove:function(f){var a=f.popupManager;a&&(a.unsetMap(),f.popupManager=void 0)}}})},"esri/PopupManager":function(){define("./geometry/Extent ./geometry/ScreenPoint ./kernel ./layerUtils ./tasks/query dijit/registry dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/_base/lang dojo/has dojo/on dojo/promise/all dojo/Stateful require".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s){var t;
return m(u,{declaredClass:"esri.PopupManager",enabled:!1,map:null,_mapClickHandle:null,_featureLayersCache:{},constructor:function(b){this._mapClickHandler=e.hitch(this,this._mapClickHandler)},setMap:function(b){if(this.map)if(b!==this.map)this.unsetMap();else return;this.map=b;this._setupClickHandler()},unsetMap:function(){this.map&&(this.map=null);this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null)},getMapLayer:function(b){var c;if(b&&(c=b.getLayer()))if(b=c.id,this._featureLayersCache[b]){var a=
b.lastIndexOf("_");-1<a&&(b=b.substring(0,a),c=this.map.getLayer(b))}return c},_enabledSetter:function(b){this.enabled=b;this._setupClickHandler()},_setupClickHandler:function(){this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null);this.enabled&&this.map&&(this._mapClickHandle=this.map.on("click",this._mapClickHandler))},_mapClickHandler:function(b){var c=this.map.infoWindow,a=b.graphic;c&&this.map.loaded&&(c.clearFeatures&&c.setFeatures?this._showPopup(b):a&&a.getInfoTemplate()&&
this._showInfoWindow(a,b.mapPoint))},_showPopup:function(b){var c=this.map,a=c.infoWindow,d=this,e=[],r=[c.graphics].concat(q.map(c.graphicsLayerIds,c.getLayer,c));q.forEach(r,function(b){b&&(b.loaded&&b.infoTemplate&&!b.suspended)&&e.push(b)});var h=[];q.forEach(c.layerIds,function(b){(b=c.getLayer(b))&&(b.loaded&&!b.suspended)&&(d._isImageServiceLayer(b)&&b.infoTemplate?e.push(b):"esri.layers.WMSLayer"===b.declaredClass&&b.getFeatureInfoURL?e.push(b):("esri.layers.ArcGISDynamicMapServiceLayer"===
b.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===b.declaredClass)&&b.infoTemplates&&h.push(b))});this._getSubLayerFeatureLayers(h).then(function(r){e=e.concat(r);r=null;b.graphic&&(b.graphic.getInfoTemplate()&&!d._isImageServiceLayer(b.graphic._layer))&&(r=b.graphic);if(e.length||r){var h=d._calculateClickTolerance(e),t=b.screenPoint,u=c.toMap(new f(t.x-h,t.y+h)),h=c.toMap(new f(t.x+h,t.y-h)),s=new p(u.x,u.y,h.x,h.y,c.spatialReference);if(s=s.intersects(c.extent)){var m=new k,l=!!r,z=!0,
u=q.map(e,function(a){var e;m.timeExtent=a.useMapTime?c.timeExtent:null;if(d._isImageServiceLayer(a))m.geometry=b.mapPoint,z=!1,e=a.queryVisibleRasters(m,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),e.addCallback(function(){var b=a.getVisibleRasters();l=l||0<b.length;return b});else if("esri.layers.WMSLayer"===a.declaredClass){e=new g;var n=a._getPopupGraphic(c,b.screenPoint);n?(e.resolve([n]),l=!0):e.resolve([])}else d._featureLayersCache[a.id]||"function"===typeof a.queryFeatures&&
(0===a.currentMode||1===a.currentMode)?(m.geometry=s,e=a.queryFeatures(m),e.addCallback(function(b){b=b.features;b=q.filter(b,function(b){return b.visible});l=l||0<b.length;return b})):(e=new g,n=q.filter(a.graphics,function(b){return b&&b.visible&&s.intersects(b.geometry)}),l=l||0<n.length,e.resolve(n));return e});r&&(h=new g,h.resolve([r]),u.unshift(h));!q.some(u,function(b){return!b.isFulfilled()})&&!l?(a.hide(),a.clearFeatures()):(a.setFeatures(u),a.show(b.mapPoint,{closestFirst:z}))}}})},_getSubLayerFeatureLayers:function(b,
c){var a=c||new g,e=[],f=b.length,h=Math.floor(this.map.extent.getWidth()/this.map.width),u=this.map.getScale(),k=!1,m=this,p=0;a:for(;p<f;p++){var E=b[p],H=E.dynamicLayerInfos||E.layerInfos;if(H){var I=null;if(E._params&&(E._params.layers||E._params.dynamicLayers))I=E.visibleLayers;for(var I=l._getVisibleLayers(H,I),M=l._getLayersForScale(u,H),Q=H.length,K=0;K<Q;K++){var J=H[K],O=J.id,G=E.infoTemplates[O];if(!J.subLayerIds&&G&&G.infoTemplate&&-1<q.indexOf(I,O)&&-1<q.indexOf(M,O)){if(!t){k=!0;break a}var T=
E.id+"_"+O,P=this._featureLayersCache[T];if(!P||!P.loadError)P||((P=G.layerUrl)||(P=J.source?this._getLayerUrl(E.url,"/dynamicLayer"):this._getLayerUrl(E.url,O)),P=new t(P,{id:T,drawMode:!1,mode:t.MODE_SELECTION,outFields:this._getOutFields(G.infoTemplate),resourceInfo:G.resourceInfo,source:J.source}),this._featureLayersCache[T]=P),P.setDefinitionExpression(E.layerDefinitions&&E.layerDefinitions[O]),P.setGDBVersion(E.gdbVersion),P.setInfoTemplate(G.infoTemplate),P.setMaxAllowableOffset(h),P.setUseMapTime(!!E.useMapTime),
E.layerDrawingOptions&&(E.layerDrawingOptions[O]&&E.layerDrawingOptions[O].renderer)&&P.setRenderer(E.layerDrawingOptions[O].renderer),e.push(P)}}}}if(k){var V=new g;s(["./layers/FeatureLayer"],function(b){t=b;V.resolve()});V.then(function(){m._getSubLayerFeatureLayers(b,a)})}else{var L=[];q.forEach(e,function(b){if(!b.loaded){var c=new g;d.once(b,"load, error",function(){c.resolve()});L.push(c.promise)}});L.length?r(L).then(function(){e=q.filter(e,function(b){return!b.loadError&&b.isVisibleAtScale(u)});
a.resolve(e)}):(e=q.filter(e,function(b){return b.isVisibleAtScale(u)}),a.resolve(e))}return a.promise},_getLayerUrl:function(b,c){var a=b.indexOf("?");return-1===a?b+"/"+c:b.substring(0,a)+"/"+c+b.substring(a)},_getOutFields:function(b){var c;b.info&&"esri.dijit.PopupTemplate"===b.declaredClass?(c=[],q.forEach(b.info.fieldInfos,function(b){var a=b.fieldName&&b.fieldName.toLowerCase();a&&("shape"!==a&&0!==a.indexOf("relationships/"))&&c.push(b.fieldName)})):c=["*"];return c},_calculateClickTolerance:function(b){var c=
6,a,d;q.forEach(b,function(b){if(a=b.renderer)"esri.renderer.SimpleRenderer"===a.declaredClass?((d=a.symbol)&&d.xoffset&&(c=Math.max(c,Math.abs(d.xoffset))),d&&d.yoffset&&(c=Math.max(c,Math.abs(d.yoffset)))):("esri.renderer.UniqueValueRenderer"===a.declaredClass||"esri.renderer.ClassBreaksRenderer"===a.declaredClass)&&q.forEach(a.infos,function(b){(d=b.symbol)&&d.xoffset&&(c=Math.max(c,Math.abs(d.xoffset)));d&&d.yoffset&&(c=Math.max(c,Math.abs(d.yoffset)))})});return c},_showInfoWindow:function(b,
c){var a=this.map.infoWindow,d=b.geometry,d=d&&"point"===d.type?d:c,g=b.getContent();a.setTitle(b.getTitle());if(g&&e.isString(g.id)){var f=h.byId(g.id);f&&(f.set&&/_PopupRenderer/.test(f.declaredClass))&&f.set("showTitle",!1)}a.setContent(g);a.show(d)},_isImageServiceLayer:function(b){return"esri.layers.ArcGISImageServiceLayer"===b.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===b.declaredClass}})})},"esri/layerUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/json",
"dojo/has","./kernel"],function(p,f,a,l,k){return{_serializeLayerDefinitions:function(h){var k=[],m=!1,g=/[:;]/;if(h&&(f.forEach(h,function(c,a){c&&(k.push([a,c]),!m&&g.test(c)&&(m=!0))}),0<k.length)){var e;m?(e={},f.forEach(k,function(c){e[c[0]]=c[1]}),e=a.toJson(e)):(e=[],f.forEach(k,function(c){e.push(c[0]+":"+c[1])}),e=e.join(";"));return e}return null},_serializeTimeOptions:function(h,k){if(h){var m=[];f.forEach(h,function(g,e){if(g){var c=g.toJson();k&&-1!==f.indexOf(k,e)&&(c.useTime=!1);m.push('"'+
e+'":'+a.toJson(c))}});if(m.length)return"{"+m.join(",")+"}"}},_getVisibleLayers:function(a,k){var m=[],g,e,c;if(!a)return m;if(k){m=k.concat();for(c=0;c<a.length;c++)g=a[c],e=f.indexOf(a,g.id),g.subLayerIds&&-1<e&&(m.splice(e,1),m=m.concat(g.subLayerIds))}else m=this._getDefaultVisibleLayers(a);return m},_getDefaultVisibleLayers:function(a){var k=[],m;if(!a)return k;for(m=0;m<a.length;m++)0<=a[m].parentLayerId&&-1===f.indexOf(k,a[m].parentLayerId)&&f.some(a,function(g){return g.id===a[m].parentLayerId})||
a[m].defaultVisibility&&k.push(a[m].id);return k},_getLayersForScale:function(a,k){var m=[];if(0<a&&k){var g;for(g=0;g<k.length;g++)if(!(0<=k[g].parentLayerId&&-1===f.indexOf(m,k[g].parentLayerId)&&f.some(k,function(c){return c.id===k[g].parentLayerId}))&&0<=k[g].id){var e=!0,c=k[g].maxScale,d=k[g].minScale;if(0<c||0<d)0<c&&0<d?e=c<=a&&a<=d:0<c?e=c<=a:0<d&&(e=a<=d);e&&m.push(k[g].id)}}return m}}})},"dojo/uacss":function(){define(["./dom-geometry","./_base/lang","./domReady","./sniff","./_base/window"],
function(p,f,a,l,k){var h=k.doc.documentElement;k=l("ie");var q=l("trident"),m=l("opera"),g=Math.floor,e=l("ff"),c=p.boxModel.replace(/-/,""),m={dj_quirks:l("quirks"),dj_opera:m,dj_khtml:l("khtml"),dj_webkit:l("webkit"),dj_safari:l("safari"),dj_chrome:l("chrome"),dj_edge:l("edge"),dj_gecko:l("mozilla"),dj_ios:l("ios"),dj_android:l("android")};k&&(m.dj_ie=!0,m["dj_ie"+g(k)]=!0,m.dj_iequirks=l("quirks"));q&&(m.dj_trident=!0,m["dj_trident"+g(q)]=!0);e&&(m["dj_ff"+g(e)]=!0);m["dj_"+c]=!0;var d="",r;for(r in m)m[r]&&
(d+=r+" ");h.className=f.trim(h.className+" "+d);a(function(){if(!p.isBodyLtr()){var c="dj_rtl dijitRtl "+d.replace(/ /g,"-rtl ");h.className=f.trim(h.className+" "+c+"dj_rtl dijitRtl "+d.replace(/ /g,"-rtl "))}});return l})},"esri/MapNavigationManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/event dojo/mouse dojo/keys dijit/focus ./kernel ./MouseEvents ./TouchEvents ./PointerEvents ./config ./sniff ./lang ./fx ./graphic ./tileUtils ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./symbols/SimpleFillSymbol".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y){var A=l.connect,B=l.disconnect,F=u("chrome"),E=u("safari"),H=[q.NUMPAD_PLUS,61,187,q.NUMPAD_MINUS,173,189,q.UP_ARROW,q.NUMPAD_8,q.RIGHT_ARROW,q.NUMPAD_6,q.DOWN_ARROW,q.NUMPAD_2,q.LEFT_ARROW,q.NUMPAD_4,q.PAGE_UP,q.NUMPAD_9,q.PAGE_DOWN,q.NUMPAD_3,q.END,q.NUMPAD_1,q.HOME,q.NUMPAD_7];return p(null,{declaredClass:"esri.MapNavigationManager",eventModel:"",constructor:function(a,g){this.map=a;f.mixin(this,g);var n=a.__container;u("esri-pointer")?(this.pointerEvents=
new d(n,{map:a}),this.eventModel="pointer"):u("esri-touch")?(u("ios")||(this.mouseEvents=new e(n,{map:a})),this.touchEvents=new c(n,{map:a,mouseEvents:this.mouseEvents}),this.eventModel="touch"):(this.mouseEvents=new e(n,{map:a}),this.eventModel="mouse");this._zoomRect=new b(null,new y(r.defaults.map.zoomSymbol));this._keyDx=this._keyDy=0;this._adjustPinch=f.hitch(this,this._adjustPinch);this._adjustPinchEnd=f.hitch(this,this._adjustPinchEnd)},_panInit:function(b){var c=this.mouseEvents;if(h.isLeft(b)&&
(this.map.isPan&&!b.shiftKey)&&(this._dragOrigin=new n(0,0),f.mixin(this._dragOrigin,b.screenPoint),B(this._panStartHandle),B(this._panHandle),B(this._panEndHandle),this._panStartHandle=A(c,"onMouseDragStart",this,this._panStart),this._panHandle=A(c,"onMouseDrag",this,this._pan),this._panEndHandle=A(c,"onMouseUp",this,this._panEnd),F||E))b.preventDefault(),m.curNode&&m.curNode.blur()},_panStart:function(b){this.map.setCursor("move");this.map.__panStart(b.screenPoint.x,b.screenPoint.y)},_pan:function(b){this.map.__pan(b.screenPoint.x-
this._dragOrigin.x,b.screenPoint.y-this._dragOrigin.y)},_panEnd:function(b){B(this._panStartHandle);B(this._panHandle);B(this._panEndHandle);this._panStartHandle=this._panHandle=this._panEndHandle=null;var c=this.map;c.__panning&&(c.__panEnd(b.screenPoint.x-this._dragOrigin.x,b.screenPoint.y-this._dragOrigin.y),c.resetMapCursor())},_zoomInit:function(b){var c=this.map,a=this.pointerEvents||this.mouseEvents;if((h.isLeft(b)||b.pointerType)&&c.isRubberBandZoom&&b.shiftKey)c.setCursor("crosshair"),this._dragOrigin=
f.mixin({},b.screenPoint),this._zoomDir=b.ctrlKey||b.metaKey?-1:1,this.pointerEvents?(this._zoomHandle=A(a,"onSwipeMove",this,this._zoom),this._zoomEndHandle=A(a,"onSwipeEnd",this,this._zoomEnd)):(this._zoomHandle=A(a,"onMouseDrag",this,this._zoom),this._zoomEndHandle=A(a,"onMouseUp",this,this._zoomEnd)),F&&b.preventDefault()},_zoom:function(b){var c=this.map,a=this._normalizeRect(b).offset(c.__visibleRect.x,c.__visibleRect.y);b=c.graphics;var d=this._zoomRect;d.geometry||c.setCursor("crosshair");
d.geometry&&b.remove(d,!0);var e=c.toMap(new n(a.x,a.y)),a=c.toMap(new n(a.x+a.width,a.y+a.height)),a=new x(e.x,e.y,a.x-e.x,e.y-a.y,c.spatialReference);a._originOnly=!0;d.setGeometry(a);b.add(d,!0)},_zoomEnd:function(b){var c=this._zoomRect,a=this.map,d=a.extent,e=a.spatialReference;B(this._zoomHandle);B(this._zoomEndHandle);this._zoomHandle=this._zoomEndHandle=null;if(a._canZoom(this._zoomDir)&&c.getDojoShape()){a.graphics.remove(c);c.geometry=null;b=this._normalizeRect(b);b.x+=a.__visibleRect.x;
b.y+=a.__visibleRect.y;if(-1===this._zoomDir){var g=d.getWidth();b=(g*a.width/b.width-g)/2;e=new w(d.xmin-b,d.ymin-b,d.xmax+b,d.ymax+b,e)}else d=a.toMap({x:b.x,y:b.y+b.height}),b=a.toMap({x:b.x+b.width,y:b.y}),e=new w(d.x,d.y,b.x,b.y,e);a._extentUtil(null,null,e)}c.getDojoShape()&&a.graphics.remove(c,!0);this._zoomDir=0;a.resetMapCursor()},_wheelZoom:function(b,c){var a=this.map;if(!c){if(a.smartNavigation&&!b.shiftKey&&!a._isPanningOrZooming()){a.disableScrollWheelZoom();this._setScrollWheelPan(!0);
this._wheelPan(b);return}var d=b.timeStamp;if(!s.isDefined(d)||0>=d)d=(new Date).getTime();if(100>(this._mwts?d-this._mwts:d))return;this._mwts=d}a._canZoom(b.value)&&a._extentUtil({numLevels:b.value,mapAnchor:b.mapPoint,screenAnchor:b.screenPoint})},_wheelPan:function(b){var c=this.map;if(b.shiftKey&&!c._isPanningOrZooming())this._setScrollWheelPan(!1),c.enableScrollWheelZoom(),this._wheelZoom(b);else{var a=0,d=0;u("ff")?b.axis===b.HORIZONTAL_AXIS?a=-b.detail:d=-b.detail:(a=b.wheelDeltaX,d=b.wheelDeltaY);
c.translate(a,d)}},_setScrollWheelPan:function(b){this.map.isScrollWheelPan=b;this.mouseEvents.enableMouseWheel(b);B(this._mwMacHandle);this._mwMacHandle=null;b&&(this._mwMacHandle=A(this.mouseEvents,"onMouseWheel",this,this._wheelPan))},_recenter:function(b){b.shiftKey&&!this.map._isPanningOrZooming()&&this.map.centerAt(b.mapPoint)},_recenterZoom:function(b){b.shiftKey&&!this.map._isPanningOrZooming()&&(b.value=b.ctrlKey||b.metaKey?-1:1,this._wheelZoom(b,!0))},_dblClickZoom:function(b){this.map._isPanningOrZooming()||
(b.value=1,this._wheelZoom(b,!0))},_twoFingerTap:function(b){this.map._isPanningOrZooming()||(b.value=-1,this._wheelZoom(b,!0))},_keyDown:function(b){var c=b.keyCode,d=this.map;if(-1!==a.indexOf(H,c)){if(c===q.NUMPAD_PLUS||61===c||187===c)d._extentUtil({numLevels:1});else if(c===q.NUMPAD_MINUS||173===c||189===c)d._extentUtil({numLevels:-1});else{d.__panning||d.__panStart(0,0);switch(c){case q.UP_ARROW:case q.NUMPAD_8:this._keyDy+=10;break;case q.RIGHT_ARROW:case q.NUMPAD_6:this._keyDx-=10;break;case q.DOWN_ARROW:case q.NUMPAD_2:this._keyDy-=
10;break;case q.LEFT_ARROW:case q.NUMPAD_4:this._keyDx+=10;break;case q.PAGE_UP:case q.NUMPAD_9:this._keyDx-=10;this._keyDy+=10;break;case q.PAGE_DOWN:case q.NUMPAD_3:this._keyDx-=10;this._keyDy-=10;break;case q.END:case q.NUMPAD_1:this._keyDx+=10;this._keyDy-=10;break;case q.HOME:case q.NUMPAD_7:this._keyDx+=10;this._keyDy+=10;break;default:return}d.__pan(this._keyDx,this._keyDy)}k.stop(b)}},_keyEnd:function(b){var c=this.map;c.__panning&&b.keyCode!==q.SHIFT&&(c.__panEnd(this._keyDx,this._keyDy),
this._keyDx=this._keyDy=0)},_swipeInit:function(b){var c=this.map,c=c._zoomAnim||c._panAnim;if(b.shiftKey)return!1;c&&c._active&&(c.stop(),c._fire("onEnd",[c.node]));this._dragOrigin=new n(0,0);f.mixin(this._dragOrigin,b.screenPoint);B(this._swipeHandle);B(this._swipeEndHandle);this._swipeHandle=A(this.touchEvents||this.pointerEvents,"onSwipeMove",this,this._swipe);this._swipeEndHandle=A(this.touchEvents||this.pointerEvents,"onSwipeEnd",this,this._swipeEnd)},_swipe:function(b){var c=this.map;c.__panning?
(this._panX=b.screenPoint.x,this._panY=b.screenPoint.y,c.__pan(b.screenPoint.x-this._dragOrigin.x,b.screenPoint.y-this._dragOrigin.y)):(c.setCursor("move"),c.__panStart(b.screenPoint.x,b.screenPoint.y))},_swipeEnd:function(b){B(this._swipeHandle);B(this._swipeEndHandle);this._swipeHandle=this._swipeEndHandle=null;var c=this.map;c.__panning&&(c.resetMapCursor(),c.__panEnd(b.screenPoint.x-this._dragOrigin.x,b.screenPoint.y-this._dragOrigin.y))},_pinchInit:function(b){var c=this.map,a=c._zoomAnim||c._panAnim;
a&&a._active?(a.stop(),a._fire("onEnd",[a.node])):c.__panning&&(b.screenPoint=new n(this._panX,this._panY),b.mapPoint=c.toMap(b.screenPoint),this._swipeEnd(b));B(this._pinchHandle);B(this._pinchEndHandle);this._pinchHandle=A(this.touchEvents||this.pointerEvents,"onPinchMove",this,this._pinch);this._pinchEndHandle=A(this.touchEvents||this.pointerEvents,"onPinchEnd",this,this._pinchEnd)},_pinch:function(b){var c=this.map;if(b.screenPoints){this.currLength=z.getLength(b.screenPoints[0],b.screenPoints[1]);
var a;c.__zooming?(a=this.currLength/this._length,this._zoomStartExtent=this.__scaleExtent(c.extent,a,this._dragOrigin),c.__zoom(this._zoomStartExtent,a,this._dragOrigin)):(this._dragOrigin=new n((b.screenPoints[0].x+b.screenPoints[1].x)/2,(b.screenPoints[0].y+b.screenPoints[1].y)/2),this._length=this.currLength,c.__zoomStart(c.extent,this._dragOrigin));this._pinchScale=a;c._fireOnScale(this.currLength/this._length,this._dragOrigin,!0)}},_pinchEnd:function(b){b=this.map;B(this._pinchHandle);B(this._pinchEndHandle);
this._pinchHandle=this._pinchEndHandle=null;this._pinchScale=0;if(b.__zooming&&null===b._zoomAnim){var c=this.currLength/this._length,a=b.extent.getWidth();this._zoomAnimAnchor=b.toMap(this._dragOrigin);this._zoomStartExtent=this.__scaleExtent(b.extent,1/c,this._zoomAnimAnchor);if(b.__tileInfo){var d=v.getCandidateTileInfo(b,b.__tileInfo,this._zoomStartExtent),e=b.__getExtentForLevel(d.lod.level,this._zoomAnimAnchor),g=b.getMinZoom(),n=b.getMaxZoom(),f=e.extent,e=e.lod,h=a/f.getWidth(),u=d.lod.level;
1>c?h>c&&u--:h<c&&u++;u<g?u=g:u>n&&(u=n);u!==d.lod.level&&(e=b.__getExtentForLevel(u,this._zoomAnimAnchor),f=e.extent,e=e.lod);this._zoomEndExtent=f;this._zoomEndLod=e;b._zoomAnim=t.animateRange({range:{start:a/this._zoomStartExtent.getWidth(),end:h},duration:r.defaults.map.zoomDuration,rate:r.defaults.map.zoomRate,onAnimate:this._adjustPinch,onEnd:this._adjustPinchEnd});b._zoomAnim.play();b._fireOnScale(b.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin)}else this._zoomEndExtent=
this._zoomStartExtent,b._fireOnScale(b.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin),this._adjustPinchEnd()}},_adjustPinch:function(b){var c=this.__scaleExtent(this.map.extent,b,this._zoomAnimAnchor);this.map.__zoom(c,b,this._dragOrigin)},_adjustPinchEnd:function(){var b=this.map,c=b.extent.getWidth()/this._zoomEndExtent.getWidth(),a=this.__scaleExtent(b.extent,1/c,this._zoomAnimAnchor),d=this._dragOrigin,e=this._zoomEndLod;this._zoomStartExtent=this._zoomEndExtent=this._zoomEndLod=
this._dragOrigin=b._zoomAnim=this._zoomAnimAnchor=null;b.__zoomEnd(a,c,d,e,!0)},__scaleExtent:function(b,c,a){a=a||b.getCenter();c=b.expand(c);var d=b.xmin-(c.getWidth()-b.getWidth())*(a.x-b.xmin)/b.getWidth();a=b.ymax-(c.getHeight()-b.getHeight())*(a.y-b.ymax)/b.getHeight();return new w(d,a-c.getHeight(),d+c.getWidth(),a,b.spatialReference)},_normalizeRect:function(b){b=b.screenPoint;var c=this._dragOrigin.x,a=this._dragOrigin.y;b=new x((b.x<c?b.x:c)-this.map.__visibleRect.x,(b.y<a?b.y:a)-this.map.__visibleRect.y,
Math.abs(b.x-c),Math.abs(b.y-a));delete b.spatialReference;0===b.width&&(b.width=1);0===b.height&&(b.height=1);return b},setImmediateClick:function(b){switch(this.eventModel){case "mouse":this.mouseEvents.setImmediateClick(b);break;case "touch":this.touchEvents.setImmediateTap(b);this.mouseEvents&&this.mouseEvents.setImmediateClick(b);break;case "pointer":this.pointerEvents.setImmediateTap(b)}},enablePan:function(){this.disablePan();switch(this.eventModel){case "mouse":this._panInitHandle=A(this.mouseEvents,
"onMouseDown",this,this._panInit);break;case "touch":this._panInitHandle=A(this.mouseEvents,"onMouseDown",this,this._panInit);this._swipeInitHandle=A(this.touchEvents,"onSwipeStart",this,this._swipeInit);break;case "pointer":this._swipeInitHandle=A(this.pointerEvents,"onSwipeStart",this,this._swipeInit)}},disablePan:function(){B(this._panInitHandle);this._panInitHandle=null;B(this._swipeInitHandle);this._swipeInitHandle=null},enableRubberBandZoom:function(){this.disableRubberBandZoom();this._zoomInitHandle=
this.pointerEvents?A(this.pointerEvents,"onSwipeStart",this,this._zoomInit):A(this.mouseEvents,"onMouseDown",this,this._zoomInit)},disableRubberBandZoom:function(){B(this._zoomInitHandle);this._zoomInitHandle=null},enablePinchZoom:function(){this.disablePinchZoom();if("touch"===this.eventModel||"pointer"===this.eventModel)this._pinchInitHandle=A(this.touchEvents||this.pointerEvents,"onPinchStart",this,this._pinchInit)},disablePinchZoom:function(){B(this._pinchInitHandle);this._pinchInitHandle=null},
enableScrollWheelZoom:function(){this.disableScrollWheelZoom();this._wheelHandle=A(this.mouseEvents||this.pointerEvents,"onMouseWheel",this,this._wheelZoom)},disableScrollWheelZoom:function(){B(this._wheelHandle);this._wheelHandle=null},enableDoubleClickZoom:function(){this.disableDoubleClickZoom();switch(this.eventModel){case "mouse":this._dblClickHandle=A(this.mouseEvents,"onDblClick",this,this._dblClickZoom);break;case "touch":this._dblClickHandle=A(this.mouseEvents,"onDblClick",this,this._dblClickZoom);
this._dblTapHandle=A(this.touchEvents,"onDoubleTap",this,this._dblClickZoom);this._zoomOutHandle=A(this.touchEvents,"onTwoFingerTap",this,this._twoFingerTap);break;case "pointer":this._dblTapHandle=A(this.pointerEvents,"onDoubleTap",this,this._dblClickZoom),this._zoomOutHandle=A(this.pointerEvents,"onTwoFingerTap",this,this._twoFingerTap)}},disableDoubleClickZoom:function(){B(this._dblClickHandle);B(this._zoomOutHandle);this._dblTapHandle&&B(this._dblTapHandle);this._dblClickHandle=this._zoomOutHandle=
this._dblTapHandle=null},enableShiftDoubleClickZoom:function(){this.disableShiftDoubleClickZoom();this._sDblClickHandle=A(this.pointerEvents||this.mouseEvents,"onDblClick",this,this._recenterZoom)},disableShiftDoubleClickZoom:function(){B(this._sDblClickHandle);this._sDblClickHandle=null},enableClickRecenter:function(){this.disableClickRecenter();this._recenterHandle=A(this.pointerEvents||this.mouseEvents,"onClick",this,this._recenter)},disableClickRecenter:function(){B(this._recenterHandle);this._recenterHandle=
null},enableKeyboardNavigation:function(){this.disableKeyboardNavigation();this._keyHandle=A(this.pointerEvents||this.mouseEvents,"onKeyDown",this,this._keyDown);this._keyEndHandle=A(this.pointerEvents||this.mouseEvents,"onKeyUp",this,this._keyEnd)},disableKeyboardNavigation:function(){B(this._keyHandle);B(this._keyEndHandle);this._keyHandle=this._keyEndHandle=null},enableNavigation:function(){var b=this.map;b&&b.loaded&&(b.enableDoubleClickZoom(),b.enableClickRecenter(),b.enablePan(),b.enableRubberBandZoom(),
this.enablePinchZoom(),b.enableKeyboardNavigation(),b.smartNavigation?this._setScrollWheelPan(!0):b.enableScrollWheelZoom())},disableNavigation:function(){var b=this.map;b&&b.loaded&&(b.disableDoubleClickZoom(),b.disableClickRecenter(),b.disablePan(),b.disableRubberBandZoom(),this.disablePinchZoom(),b.disableKeyboardNavigation(),b.disableScrollWheelZoom(),b.smartNavigation&&this._setScrollWheelPan(!1))},destroy:function(){this.touchEvents&&this.touchEvents.destroy();this.mouseEvents&&this.mouseEvents.destroy();
this.pointerEvents&&this.pointerEvents.destroy();var b,c=[this._panInitHandle,this._panStartHandle,this._panHandle,this._panEndHandle,this._zoomInitHandle,this._zoomHandle,this._zoomEndHandle,this._wheelHandle,this._mwMacHandle,this._dblClickHandle,this._zoomOutHandle,this._recenterHandle,this._sDblClickHandle,this._dblTapHandle,this._keyHandle,this._keyEndHandle,this._swipeInitHandle,this._swipeHandle,this._swipeEndHandle,this._pinchInitHandle,this._pinchHandle,this._pinchEndHandle];for(b=0;b<c.length;b++)B(c[b]);
this.map=this.touchEvents=this.mouseEvents=this.eventModel=this.pointerEvents=this._zoomRect=this._dragOrigin=this._panInitHandle=this._panStartHandle=this._panHandle=this._panEndHandle=this._zoomInitHandle=this._zoomHandle=this._zoomEndHandle=this._wheelHandle=this._mwMacHandle=this._dblClickHandle=this._zoomOutHandle=this._recenterHandle=this._sDblClickHandle=this._dblTapHandle=this._keyHandle=this._keyEndHandle=this._swipeInitHandle=this._swipeHandle=this._swipeEndHandle=this._pinchInitHandle=
this._pinchHandle=this._pinchEndHandle=null}})})},"dijit/focus":function(){define("dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/Evented dojo/_base/lang dojo/on dojo/domReady dojo/sniff dojo/Stateful dojo/_base/window dojo/window ./a11y ./registry ./main".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b){var v,n,w=new (f([d,q],{curNode:null,activeStack:[],constructor:function(){var b=m.hitch(this,function(b){a.isDescendant(this.curNode,b)&&this.set("curNode",
null);a.isDescendant(this.prevNode,b)&&this.set("prevNode",null)});p.before(h,"empty",b);p.before(h,"destroy",b)},registerIframe:function(b){return this.registerWin(b.contentWindow,b)},registerWin:function(b,a){var d=this,e=b.document&&b.document.body;if(e){var n=c("pointer-events")?"pointerdown":c("MSPointer")?"MSPointerDown":c("touch-events")?"mousedown, touchstart":"mousedown",f=g(b.document,n,function(b){if(!b||!(b.target&&null==b.target.parentNode))d._onTouchNode(a||b.target,"mouse")}),r=g(e,
"focusin",function(b){if(b.target.tagName){var c=b.target.tagName.toLowerCase();"#document"==c||"body"==c||(s.isFocusable(b.target)?d._onFocusNode(a||b.target):d._onTouchNode(a||b.target))}}),h=g(e,"focusout",function(b){d._onBlurNode(a||b.target)});return{remove:function(){f.remove();r.remove();h.remove();e=f=r=h=null}}}},_onBlurNode:function(b){b=(new Date).getTime();b<v+100||(this._clearFocusTimer&&clearTimeout(this._clearFocusTimer),this._clearFocusTimer=setTimeout(m.hitch(this,function(){this.set("prevNode",
this.curNode);this.set("curNode",null)}),0),this._clearActiveWidgetsTimer&&clearTimeout(this._clearActiveWidgetsTimer),b<n+100||(this._clearActiveWidgetsTimer=setTimeout(m.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([])}),0)))},_onTouchNode:function(b,c){n=(new Date).getTime();this._clearActiveWidgetsTimer&&(clearTimeout(this._clearActiveWidgetsTimer),delete this._clearActiveWidgetsTimer);k.contains(b,"dijitPopup")&&(b=b.firstChild);var a=[];try{for(;b;){var d=l.get(b,
"dijitPopupParent");if(d)b=t.byId(d).domNode;else if(b.tagName&&"body"==b.tagName.toLowerCase()){if(b===r.body())break;b=u.get(b.ownerDocument).frameElement}else{var e=b.getAttribute&&b.getAttribute("widgetId"),g=e&&t.byId(e);g&&!("mouse"==c&&g.get("disabled"))&&a.unshift(e);b=b.parentNode}}}catch(f){}this._setStack(a,c)},_onFocusNode:function(b){b&&9!=b.nodeType&&(v=(new Date).getTime(),this._clearFocusTimer&&(clearTimeout(this._clearFocusTimer),delete this._clearFocusTimer),this._onTouchNode(b),
b!=this.curNode&&(this.set("prevNode",this.curNode),this.set("curNode",b)))},_setStack:function(b,c){var a=this.activeStack,d=a.length-1,e=b.length-1;if(b[e]!=a[d]){this.set("activeStack",b);var g;for(g=d;0<=g&&a[g]!=b[g];g--)if(d=t.byId(a[g]))d._hasBeenBlurred=!0,d.set("focused",!1),d._focusManager==this&&d._onBlur(c),this.emit("widget-blur",d,c);for(g++;g<=e;g++)if(d=t.byId(b[g]))d.set("focused",!0),d._focusManager==this&&d._onFocus(c),this.emit("widget-focus",d,c)}},focus:function(b){if(b)try{b.focus()}catch(c){}}}));
e(function(){var b=w.registerWin(u.get(document));c("ie")&&g(window,"unload",function(){b&&(b.remove(),b=null)})});b.focus=function(b){w.focus(b)};for(var x in w)/^_/.test(x)||(b.focus[x]="function"==typeof w[x]?m.hitch(w,x):w[x]);w.watch(function(c,a,d){b.focus[c]=d});return w})},"dijit/a11y":function(){define("dojo/_base/array dojo/dom dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/sniff ./main".split(" "),function(p,f,a,l,k,h,q){var m={_isElementShown:function(g){var e=l.get(g);return"hidden"!=
e.visibility&&"collapsed"!=e.visibility&&"none"!=e.display&&"hidden"!=a.get(g,"type")},hasDefaultTabStop:function(g){switch(g.nodeName.toLowerCase()){case "a":return a.has(g,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return!0;case "iframe":var e;try{var c=g.contentDocument;if("designMode"in c&&"on"==c.designMode)return!0;e=c.body}catch(d){try{e=g.contentWindow.document.body}catch(f){return!1}}return e&&("true"==e.contentEditable||e.firstChild&&"true"==
e.firstChild.contentEditable);default:return"true"==g.contentEditable}},effectiveTabIndex:function(g){return a.get(g,"disabled")?void 0:a.has(g,"tabIndex")?+a.get(g,"tabIndex"):m.hasDefaultTabStop(g)?0:void 0},isTabNavigable:function(a){return 0<=m.effectiveTabIndex(a)},isFocusable:function(a){return-1<=m.effectiveTabIndex(a)},_getTabNavigable:function(g){function e(b){return b&&"input"==b.tagName.toLowerCase()&&b.type&&"radio"==b.type.toLowerCase()&&b.name&&b.name.toLowerCase()}var c,d,f,u,s,t,b=
{},k=m._isElementShown,n=m.effectiveTabIndex,w=function(g){for(g=g.firstChild;g;g=g.nextSibling)if(!(1!=g.nodeType||9>=h("ie")&&"HTML"!==g.scopeName||!k(g))){var m=n(g);if(0<=m){if(0==m)c||(c=g),d=g;else if(0<m){if(!f||m<u)u=m,f=g;if(!s||m>=t)t=m,s=g}m=e(g);a.get(g,"checked")&&m&&(b[m]=g)}"SELECT"!=g.nodeName.toUpperCase()&&w(g)}};k(g)&&w(g);return{first:b[e(c)]||c,last:b[e(d)]||d,lowest:b[e(f)]||f,highest:b[e(s)]||s}},getFirstInTabbingOrder:function(a,e){var c=m._getTabNavigable(f.byId(a,e));return c.lowest?
c.lowest:c.first},getLastInTabbingOrder:function(a,e){var c=m._getTabNavigable(f.byId(a,e));return c.last?c.last:c.highest}};k.mixin(q,m);return m})},"esri/MouseEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/_base/connect dojo/_base/event ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(p,f,a,l,k,h,q,m,g,e){var c=k.connect,d=k.disconnect;return p([m],{declaredClass:"esri.MouseEvents",doubleClickDuration:300,minWheelValue:1,
maxWheelValue:1,mozWheelDivisor:-1!==l("mac")?1:3,wheelDivisor:2>l("chrome")?360:120,preventPageScroll:!0,map:null,constructor:function(d,e){this.node=d;a.mixin(this,e);var g=function(c){h.stop(c);return!1};l("mozilla")&&f.style(d,"MozUserSelect","none");this._handles=[c(d,"onselectstart",g),c(d,"ondragstart",g),c(d,"onmouseenter",this,this._onMouseEnterHandler),c(d,"onmouseleave",this,this._onMouseLeaveHandler),c(d,"onmousedown",this,this._onMouseDownHandler),c(d,"onclick",this,this._onClickHandler),
c(d,"ondblclick",this,this._onDblClickHandler)];this._onMouseMoveHandler_connect=c(d,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=c(d,"onmouseup",this,this._onMouseUpHandler);this._fireClickEvent=a.hitch(this,this._fireClickEvent);this._initialDuration=this.doubleClickDuration;this.preventPageScroll=(g=this.map)?g.isScrollWheelZoom||g.isScrollWheelPan:this.preventPageScroll;this.enableMouseWheel(!1)},_fire:function(c,a){if(!this._preventClick||!("onClick"===c||"onDblClick"===
c)){if(this[c])this[c](a);if(this.map&&this.map[c])this.map[c](a)}},_processEvent:function(c){c=h.fix(c,c.target);var a=this.map,d=a&&a.position;d&&("DOMMouseScroll"===c.type&&3>l("ff")?c.screenPoint=new e(window.scrollX+c.screenX-d.x,window.scrollY+c.screenY-d.y):c.screenPoint=new e(c.pageX-d.x,c.pageY-d.y),c.mapPoint=a.extent?a.toMap(c.screenPoint):new g);c.numPoints=0;return c},_onMouseEnterHandler:function(a){d(this._onKeyDown_connect);d(this._onKeyUp_connect);this._onKeyDown_connect=c(document,
"onkeydown",this,this._onKeyDownHandler);this._onKeyUp_connect=c(document,"onkeyup",this,this._onKeyUpHandler);this._fire("onMouseOver",this._processEvent(a))},_onMouseLeaveHandler:function(c){d(this._onKeyDown_connect);d(this._onKeyUp_connect);this._onKeyDown_connect=this._onKeyUp_connect=null;this._fire("onMouseOut",this._processEvent(c))},_onMouseMoveHandler:function(c){this._dragEnd?this._dragEnd=!1:this._fire("onMouseMove",this._processEvent(c))},_onMouseDownHandler:function(a){d(this._onMouseMoveHandler_connect);
this._onMouseMoveHandler_connect=null;this.node.setCapture&&this.node.setCapture(!1);d(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=c(document,"onmousemove",this,this._onMouseDragHandler);this._startX=a.pageX;this._startY=a.pageY;this._fire("onMouseDown",this._processEvent(a))},_onMouseUpHandler:function(a){var e=this.node;e.releaseCapture&&e.releaseCapture();d(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=null;d(this._onMouseMoveHandler_connect);this._onMouseMoveHandler_connect=
c(e,"onmousemove",this,this._onMouseMoveHandler);this._fire("onMouseUp",this._processEvent(a))},_onMouseDragHandler:function(a){d(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=c(document,"onmousemove",this,this._onMouseDraggingHandler);d(this._onMouseUpHandler_connect);this._onMouseUpHandler_connect=c(document,"onmouseup",this,this._onDragMouseUpHandler);this._docLeaveConnect=c(document,"onmouseout",this,this._onDocMouseOut);this._fire("onMouseDragStart",this._processEvent(a))},
_onMouseDraggingHandler:function(c){h.stop(c);this._fire("onMouseDrag",this._processEvent(c))},_onDragMouseUpHandler:function(a){var e=this.node;e.releaseCapture&&e.releaseCapture();this._dragEnd=!0;d(this._docLeaveConnect);d(this._onMouseDragHandler_connect);d(this._onMouseUpHandler_connect);this._docLeaveConnect=this._onMouseDragHandler_connect=null;this._onMouseMoveHandler_connect=c(e,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=c(e,"onmouseup",this,this._onMouseUpHandler);
a=this._processEvent(a);this._fire("onMouseDragEnd",a);this._fire("onMouseUp",a)},_onDocMouseOut:function(c){var a=9>l("ie")?c.toElement:c.relatedTarget,d=a&&a.nodeName.toLowerCase();(!a||l("chrome")&&"html"===d)&&this._onDragMouseUpHandler(c)},_onClickHandler:function(c){c=this._processEvent(c);if(!(c.pageX!==this._startX||c.pageY!==this._startY)){clearTimeout(this._clickTimer);var a={},d="movementX"in c,e;for(e in c)if(!d||"webkitMovementX"!==e&&"webkitMovementY"!==e)a[e]=c[e];this._clickEvent=
a;this._clickTimer=setTimeout(this._fireClickEvent,this.doubleClickDuration)}},_fireClickEvent:function(){clearTimeout(this._clickTimer);9>l("ie")&&(this._clickEvent.graphic=q._ieGraphic,delete q._ieGraphic);this._fire("onClick",this._clickEvent)},_onDblClickHandler:function(c){clearTimeout(this._clickTimer);this._fire("onDblClick",this._processEvent(c))},_onMouseWheelHandler:function(c){var a=this.map;(a?a.isScrollWheelZoom||a.isScrollWheelPan:this.preventPageScroll)&&h.stop(c);var a=l("ff")||l("mozilla")?
-c.detail/this.mozWheelDivisor:c.wheelDelta/this.wheelDivisor,d=Math.abs(a),d=d<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;c.value=0>a?-d:d;this._fire("onMouseWheel",this._processEvent(c))},_onKeyDownHandler:function(c){this._fire("onKeyDown",c)},_onKeyUpHandler:function(c){this._fire("onKeyUp",c)},enableMouseWheel:function(a){d(this._scrollHandle);this._scrollHandle=c(this.node,l("ff")||l("mozilla")?a?"MozMousePixelScroll":"DOMMouseScroll":"onmousewheel",this,this._onMouseWheelHandler)},
setImmediateClick:function(c){this.doubleClickDuration=c?0:this._initialDuration},preventClickEvents:function(c){this._preventClick=c},destroy:function(){var c=this._handles.concat([this._onMouseMoveHandler_connect,this._onMouseUpHandler_connect,this._onMouseDragHandler_connect,this._scrollHandle,this._onKeyDown_connect,this._onKeyUp_connect,this._docLeaveConnect]),a;for(a=0;a<c.length;a++)d(c[a]);clearTimeout(this._clickTimer);this.node=this.map=this._handles=this._clickEvent=this._onMouseMoveHandler_connect=
this._onMouseUpHandler_connect=this._onMouseDragHandler_connect=this._scrollHandle=this._onKeyDown_connect=this._onKeyUp_connect=this._docLeaveConnect=null}})})},"esri/TouchEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/dom ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(p,f,a,l,k,h,q,m,g){return p([q],{declaredClass:"esri.TouchEvents",tapRadius:8,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,map:null,
constructor:function(e,c){this.node=e;a.mixin(this,c);f.setSelectable(e,!1);this._touchStart=a.hitch(this,this._touchStart);this._touchMove=a.hitch(this,this._touchMove);this._touchEnd=a.hitch(this,this._touchEnd);this._touchCancel=a.hitch(this,this._touchCancel);e.addEventListener("touchstart",this._touchStart,!1);e.addEventListener("touchmove",this._touchMove,!1);e.addEventListener("touchend",this._touchEnd,!1);e.addEventListener("touchcancel",this._touchCancel,!1);this.map&&l("ios")&&(this._mouseOver=
a.hitch(this,this._mouseOver),this._mouseOut=a.hitch(this,this._mouseOut),this._mouseDown=a.hitch(this,this._mouseDown),this._mouseUp=a.hitch(this,this._mouseUp),this._mouseClick=a.hitch(this,this._mouseClick),e.addEventListener("mouseover",this._mouseOver,!1),e.addEventListener("mouseout",this._mouseOut,!1),e.addEventListener("mousedown",this._mouseDown,!1),e.addEventListener("mouseup",this._mouseUp,!1),e.addEventListener("click",this._mouseClick,!1));this._numTouches=0;this._nodeTouches=[];this._touches=
{};this._touchIds=[];this._taps=[];this._immediate=!1},_touchStart:function(a){var c=this._touches,d,g=a.changedTouches.length,f,h,t,b,k=(new Date).getTime();if(!l("android")||!l("safari")||!(1===a.targetTouches.length&&a.touches.length===a.targetTouches.length&&a.targetTouches.length===a.changedTouches.length&&0===a.changedTouches[0].identifier&&c[a.changedTouches[0].identifier])){this._addTouch(a);for(d=0;d<g;d++)f=a.changedTouches[d],h=c[f.identifier]={},h.startX=f.pageX,h.startY=f.pageY,h.startTS=
k,-1===this._touchIds.indexOf(f.identifier)&&this._touchIds.push(f.identifier);this._swipeActive&&(t=this._nodeTouches[0]);this._pinchActive&&(b=this._nodeTouches[1]);1===this._numTouches?this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(a,t))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(a,[t,b]))):2===this._numTouches?this._swipeActive&&(t&&(h=c[this._touchIds[0]],h.startX=t.pageX,h.startY=t.pageY,h.moved=!1),this._swipeActive=
!1,this._fire("onSwipeEnd",this._processTouchEvent(a,t))):this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(a,t))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(a,[t,b])))}},_touchMove:function(a){a.preventDefault();this._updateTouch(a);var c=this._touches,d,g=a.changedTouches.length,f,h,t,b;if(!l("android")||!l("safari")||!(1===a.targetTouches.length&&a.touches.length===a.targetTouches.length&&a.targetTouches.length===
a.changedTouches.length&&0===a.changedTouches[0].identifier&&c[a.changedTouches[0].identifier]&&1<this._touchIds.length)){for(d=0;d<g;d++)if(f=a.changedTouches[d],h=c[f.identifier]){t=Math.abs(f.pageX-h.startX);f=Math.abs(f.pageY-h.startY);if(!h.moved&&(t>=this.tapRadius||f>=this.tapRadius))h.moved=h.absMoved=!0;b=b?b:h.moved}1===this._numTouches?(d=a.changedTouches[0],this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(a,d)):b&&(this._swipeActive=!0,this._fire("onSwipeStart",this._processTouchEvent(a,
d)))):2===this._numTouches&&(d=this._nodeTouches[0],g=this._nodeTouches[1],this._pinchActive?this._fire("onPinchMove",this._processTouchEvent(a,[d,g])):b&&(b=c[d.identifier],h=c[g.identifier],c=Math.abs(b.startX-h.startX),b=Math.abs(b.startY-h.startY),c=Math.sqrt(c*c+b*b),b=Math.abs(d.pageX-g.pageX),h=Math.abs(d.pageY-g.pageY),b=Math.sqrt(b*b+h*h),Math.abs(b-c)>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(a,[d,g])))))}},_touchEnd:function(a){this._removeTouch(a);
var c=this._touches,d=a.changedTouches,g,f=d.length,h,t,b=(new Date).getTime(),k=this._touchIds;for(g=0;g<f;g++)if(t=c[d[g].identifier])t.absMoved&&(h=!0),t.pageX=d[g].pageX,t.pageY=d[g].pageY,t.endTS=b;if(0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(a,d[0]));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(a,d));else{if(!h){f=Infinity;h=-Infinity;var b=
Infinity,n=-Infinity,m=this.tapStartTolerance,l=[],q=!0;for(g=0;g<k.length;g++)t=c[k[g]],l.push(t),t.startTS<f&&(f=t.startTS),t.startTS>h&&(h=t.startTS),t.endTS<b&&(b=t.endTS),t.endTS>n&&(n=t.endTS),delete c[k[g]];if(1===l.length&&d[0]&&(c=Math.abs(d[0].pageX-l[0].startX),d=Math.abs(d[0].pageY-l[0].startY),c>=this.tapRadius||d>=this.tapRadius))q=!1;q&&(Math.abs(h-f)<=m&&Math.abs(n-b)<=m)&&this._basicTap(a,l)}}else 1===this._numTouches&&this._pinchActive&&(g=this._nodeTouches[0],t=c[g.identifier],
t.startX=g.pageX,t.startY=g.pageY,this._pinchActive=t.moved=!1,this._fire("onPinchEnd",this._processTouchEvent(a,[d[0],g])))},_touchCancel:function(a){this._numTouches&&this._touchEnd(a)},_basicTap:function(a,c){var d=(new Date).getTime(),g=this;a=this._processTouchEvent(a,c);this._taps.push({touchInfos:c,ts:d,event:a});2<this._taps.length&&this._taps.shift();this._fire("onBasicTap",a);clearTimeout(this._tapTimer);this._immediate?this._analyzeTap(!0):this._tapTimer=setTimeout(function(){var c=g;g=
null;clearTimeout(c._tapTimer);c._analyzeTap()},2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration)},_analyzeTap:function(a){var c=this._taps,d=c[0],g=c[1],f=d.touchInfos,h=g&&g.touchInfos;c.length&&(a||(this._taps=[]),d&&g?f.length===h.length?g.ts-d.ts<=this.doubleTapDuration?(1===f.length?(a=Math.abs(f[0].startX-h[0].startX),f=Math.abs(f[0].startY-h[0].startY),f=a<=this.doubleTapRadius&&f<=this.doubleTapRadius):f=!0,f?this._processedDoubleTap(c):this._processedTap(g)):this._processedTap(g):
this._processedTap(g):this._processedTap(d||g))},_processedTap:function(a){var c=a.event;this._fire("onProcessedTap",c);1===a.touchInfos.length?this._fire("onTap",this._fixEvent(c)):2===a.touchInfos.length&&this._fire("onTwoFingerTap",c)},_processedDoubleTap:function(a){var c=1===a[1].touchInfos.length,d;c&&(d=[this._fixEvent(a[0].event),this._fixEvent(a[1].event)],d[1].relatedEvents=d);a=[a[0].event,a[1].event];a[1].relatedEvents=a;this._fire("onProcessedDoubleTap",a[1]);c&&(this._fire("onDoubleTap",
d[1]),this._fire("onDblClick",d[1]))},_addTouch:function(a){var c=a.changedTouches,d=this._nodeTouches,g,f,h;this._numTouches+=c.length;for(a=0;a<c.length;a++){f=d.length;h=!1;for(g=0;g<f&&!(h=d[g].identifier===c[a].identifier);g++);h?this._numTouches--:d.push(c[a])}for(a=d.length-1;0<=a;a--)k.isDescendant(d[a].target,document.body)||(d.splice(a,1),this._numTouches--);0>this._numTouches&&(this._numTouches=0)},_removeTouch:function(a){var c=[],d=[],g=a.changedTouches,f=this._nodeTouches;this._numTouches-=
g.length;0>this._numTouches&&(this._numTouches=0);for(a=0;a<g.length;a++)c.push(g[a].identifier);for(a=f.length-1;0<=a;a--)-1!==c.indexOf(f[a].identifier)&&d.push(f.splice(a,1)[0]);return d},_updateTouch:function(a){var c=[],d,g=a.changedTouches,f=this._nodeTouches;for(a=0;a<g.length;a++)c.push(g[a].identifier);for(a=0;a<f.length;a++)d=c.indexOf(f[a].identifier),-1!==d&&f.splice(a,1,g[d])},_mouseOver:function(a){this._fire("onMouseOver",this._processMouseEvent(a))},_mouseOut:function(a){this._fire("onMouseOut",
this._processMouseEvent(a))},_mouseDown:function(a){this._fire("onMouseDown",this._processMouseEvent(a))},_mouseUp:function(a){this._fire("onMouseUp",this._processMouseEvent(a))},_mouseClick:function(a){this._fire("onClick",this._processMouseEvent(a))},_fire:function(a,c){if("onDblClick"===a&&this.mouseEvents){this.mouseEvents.preventClickEvents(!0);var d=this;setTimeout(function(){d.mouseEvents.preventClickEvents(!1)},350)}if(this[a])this[a](c);if(this.map&&this.map[a])this.map[a](c)},_fixEvent:function(a){var c=
{},d;for(d in a)c[d]=a[d];this.map&&(c.screenPoint=c.screenPoints[0],c.mapPoint=c.mapPoints[0]);return c},_processTouchEvent:function(e,c){var d=this.map,f=d&&d.position,h=0;if(f&&c)if(a.isArray(c)){var s,t;e.screenPoints=[];e.mapPoints=[];for(s=0;s<c.length;s++)c[s]?(t=new g(c[s].pageX-f.x,c[s].pageY-f.y),e.screenPoints.push(t),e.mapPoints.push(d.extent?d.toMap(t):new m)):h++}else e.screenPoint=new g(c.pageX-f.x,c.pageY-f.y),e.mapPoint=d.extent?d.toMap(e.screenPoint):new m;e.numPoints=c?a.isArray(c)?
c.length-h:1:0;return e},_processMouseEvent:function(a){var c=this.map,d=c&&c.position;d&&(a.screenPoint=new g(a.pageX-d.x,a.pageY-d.y),a.mapPoint=c.extent?c.toMap(a.screenPoint):new m);return a},setImmediateTap:function(a){this._immediate=a},destroy:function(){var a=this.node;a.removeEventListener("touchstart",this._touchStart,!1);a.removeEventListener("touchmove",this._touchMove,!1);a.removeEventListener("touchend",this._touchEnd,!1);a.removeEventListener("touchcancel",this._touchCancel,!1);this.map&&
(a.removeEventListener("mouseover",this._mouseOver,!1),a.removeEventListener("mouseout",this._mouseOut,!1),a.removeEventListener("mousedown",this._mouseDown,!1),a.removeEventListener("mouseup",this._mouseUp,!1),a.removeEventListener("click",this._mouseClick,!1));f.setSelectable(a,!0);clearTimeout(this._tapTimer);this.node=this.map=this._numTouches=this._nodeTouches=this._touches=this._touchIds=this._taps=null}})})},"esri/PointerEvents":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),
function(p,f,a,l,k,h,q,m){return p([h],{declaredClass:"esri.PointerEvents",tapRadius:8,clickRadius:2,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,minWheelValue:1,maxWheelValue:1,mozWheelDivisor:-1!==l("mac")?1:3,wheelDivisor:120,preventPageScroll:!0,_dragging:!1,constructor:function(a,e){this.node=a;f.mixin(this,e);void 0!==a.style.msTouchAction?a.style.msTouchAction="none":void 0!==a.style.touchAction&&(a.style.touchAction="none");var c=navigator.msPointerEnabled,d=function(c){c.preventDefault()};
a.addEventListener("selectstart",d,!1);a.addEventListener("dragstart",d,!1);this._pointerDown=f.hitch(this,this._pointerDown);this._pointerMove=f.hitch(this,this._pointerMove);this._pointerUp=f.hitch(this,this._pointerUp);this._pointerCancel=f.hitch(this,this._pointerCancel);a.addEventListener(c?"MSPointerDown":"pointerdown",this._pointerDown,!1);a.addEventListener(c?"MSPointerMove":"pointermove",this._pointerMove,!1);a.addEventListener(c?"MSPointerUp":"pointerup",this._pointerUp,!1);a.addEventListener(c?
"MSPointerCancel":"pointercancel",this._pointerCancel,!1);this.map&&(this._mouseOver=f.hitch(this,this._mouseOver),this._mouseOut=f.hitch(this,this._mouseOut),this._mouseLeave=f.hitch(this,this._mouseLeave),this._mouseDown=f.hitch(this,this._mouseDown),this._mouseUp=f.hitch(this,this._mouseUp),this._mouseClick=f.hitch(this,this._mouseClick),this._mouseWheel=f.hitch(this,this._mouseWheel),this._mouseMove=f.hitch(this,this._mouseMove),this._mouseEnter=f.hitch(this,this._mouseEnter),this._onKeyDown=
f.hitch(this,this._onKeyDown),this._onKeyUp=f.hitch(this,this._onKeyUp),a.addEventListener("mouseover",this._mouseOver,!1),a.addEventListener("mouseout",this._mouseOut,!1),a.addEventListener("mouseleave",this._mouseLeave,!1),a.addEventListener("mousedown",this._mouseDown,!1),a.addEventListener("mouseup",this._mouseUp,!1),a.addEventListener("click",this._mouseClick,!1),a.addEventListener("mousewheel",this._mouseWheel,!1),a.addEventListener("mousemove",this._mouseMove,!1),a.addEventListener("mouseenter",
this._mouseEnter,!1));this._numTouches=0;this._touches={};this._touchIds=[];this._taps=[];this._immediate=!1},_pointerDown:function(g){if(-1<a.indexOf(this._touchIds,g.pointerId))this._pointerUp(g);else{var e=this._touches,c=g.target,d=g.pointerId,f=this._touchIds,h,s=(new Date).getTime();h=e[d]={};h.pointerId=d;h.startX=h.pageX=g.pageX;h.startY=h.pageY=g.pageY;h.startTS=s;f.push(d);this._numTouches++;c.setPointerCapture?c.setPointerCapture(d):c.msSetPointerCapture&&c.msSetPointerCapture(d);c=e[f[0]];
e=e[f[1]];1!==this._numTouches&&(2===this._numTouches?this._swipeActive&&(c&&(c.startX=c.pageX,c.startY=c.pageY,c.moved=!1),this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(g,c))):this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(g,c))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(g,[c,e]))))}},_pointerMove:function(a){var e=this._touches,c=this._touchIds,d,f,h;if((d=e[a.pointerId])&&!(d.pageX===
a.pageX&&d.pageY===a.pageY)){d.pageX=a.pageX;d.pageY=a.pageY;f=Math.abs(d.pageX-d.startX);h=Math.abs(d.pageY-d.startY);if(!d.moved&&(f>=this.tapRadius||h>=this.tapRadius))d.moved=d.absMoved=!0;if(1===this._numTouches)this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(a,a)):d.moved&&(this._swipeActive=!0,this._fire("onSwipeStart",this._processTouchEvent(a,a)));else if(2===this._numTouches)if(d=e[c[0]],e=e[c[1]],this._pinchActive)this._fire("onPinchMove",this._processTouchEvent(a,[d,
e]));else if(d.moved||e.moved)c=Math.abs(d.startX-e.startX),f=Math.abs(d.startY-e.startY),c=Math.sqrt(c*c+f*f),f=Math.abs(d.pageX-e.pageX),h=Math.abs(d.pageY-e.pageY),f=Math.sqrt(f*f+h*h),Math.abs(f-c)>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(a,[d,e])))}},_pointerUp:function(g){var e=this._touches,c,d=this.node,f=g.target,h=g.pointerId,s=this._touchIds,t=s.slice(0),b=a.map(t,function(b){return e[b]}),k=(new Date).getTime();if(c=e[h])if(c.pageX=g.pageX,
c.pageY=g.pageY,c.endTS=k,this._numTouches--,f.releasePointerCapture?f.releasePointerCapture(h):f.msReleasePointerCapture&&f.msReleasePointerCapture(h),0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(g,g));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(g,g));else{if(!c.absMoved){var f=Infinity,h=-Infinity,s=Infinity,k=-Infinity,n=this.tapStartTolerance,
m;for(m=0;m<t.length;m++)c=b[m],c.startTS<f&&(f=c.startTS),c.startTS>h&&(h=c.startTS),c.endTS<s&&(s=c.endTS),c.endTS>k&&(k=c.endTS);Math.abs(h-f)<=n&&Math.abs(k-s)<=n&&this._basicTap(g,b)}}else 1===this._numTouches&&this._pinchActive&&(s.splice(a.indexOf(s,g.pointerId),1),delete e[g.pointerId],c=e[s[0]],c.startX=c.pageX,c.startY=c.pageY,c.moved=!1,document.msElementsFromPoint&&(t=document.msElementsFromPoint(c.pageX,c.pageY),a.some(t,function(b){return b===d})||(this._touches={},this._touchIds=[],
this._numTouches=0)),this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(g,[g,c])))},_pointerCancel:function(a){this._numTouches&&this._pointerUp(a)},_basicTap:function(a,e){var c=(new Date).getTime(),d=this,f=this._immediate;a=this._processTouchEvent(a,e);this._taps.push({touchInfos:e,ts:c,event:a});2<this._taps.length&&this._taps.shift();this._fire("onBasicTap",a);clearTimeout(this._tapTimer);c=2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration;this._tapTimer=
setTimeout(function(){var c=d;d=null;clearTimeout(c._tapTimer);c._analyzeTap(f)},f?0:c)},_analyzeTap:function(a){var e=this._taps,c=e[0],d=e[1],f=c.touchInfos,h=d&&d.touchInfos;e.length&&(a||(this._taps=[]),c&&d?f.length===h.length?d.ts-c.ts<=this.doubleTapDuration?(1===f.length?(a=Math.abs(f[0].startX-h[0].startX),f=Math.abs(f[0].startY-h[0].startY),f=a<=this.doubleTapRadius&&f<=this.doubleTapRadius):f=!0,f?this._processedDoubleTap(e):this._processedTap(d)):this._processedTap(d):this._processedTap(d):
this._processedTap(c||d))},_processedTap:function(a){var e=a.event;this._fire("onProcessedTap",e);1===a.touchInfos.length?this._fire("onTap",this._fixEvent(e)):2===a.touchInfos.length&&this._fire("onTwoFingerTap",e)},_processedDoubleTap:function(a){var e=1===a[1].touchInfos.length,c;e&&(c=[this._fixEvent(a[0].event),this._fixEvent(a[1].event)],c[1].relatedEvents=c);a=[a[0].event,a[1].event];a[1].relatedEvents=a;this._fire("onProcessedDoubleTap",a[1]);e&&(this._fire("onDoubleTap",c[1]),this._fire("onDblClick",
c[1]))},_mouseOver:function(a){this._fire("onMouseOver",this._processMouseEvent(a))},_mouseMove:function(a){this._dragging?this._fire("onMouseDrag",this._processMouseEvent(a)):this._fire("onMouseMove",this._processMouseEvent(a))},_mouseOut:function(a){this._fire("onMouseOut",this._processMouseEvent(a))},_mouseLeave:function(a){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseOut",this._processMouseEvent(event))},_mouseDown:function(a){this._downX=
a.pageX;this._downY=a.pageY;this._fire("onMouseDown",this._processMouseEvent(a));0===a.button&&(this._dragging=!0,this._fire("onMouseDragStart",this._processMouseEvent(a)))},_mouseUp:function(a){this._dragging&&(this._dragging=!1,this._fire("onMouseDragEnd",this._processMouseEvent(a)));this._fire("onMouseUp",this._processMouseEvent(a))},_mouseClick:function(a){Math.abs(a.pageX-this._downX)<=this.clickRadius&&Math.abs(a.pageY-this._downY)<=this.clickRadius&&this._fire("onClick",this._processMouseEvent(a))},
_mouseWheel:function(a){var e=this.map;(e?e.isScrollWheelZoom||e.isScrollWheelPan:this.preventPageScroll)&&a.preventDefault();var e=a.wheelDelta?a.wheelDelta/this.wheelDivisor:-a.detail/this.mozWheelDivisor,c=Math.abs(e),c=c<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;a.value=0>e?-c:c;this._fire("onMouseWheel",this._processMouseEvent(a))},_mouseEnter:function(a){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);document.addEventListener("keydown",
this._onKeyDown,!1);document.addEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseEnter",this._processMouseEvent(a))},_onKeyDown:function(a){this._fire("onKeyDown",a)},_onKeyUp:function(a){this._fire("onKeyUp",a)},_fire:function(a,e){if(this[a])this[a](e);if(this.map&&this.map[a])this.map[a](e)},_fixEvent:function(a){var e={},c;for(c in a)e[c]=a[c];e.preventDefault=function(){a.preventDefault()};e.stopPropagation=function(){a.stopPropagation()};this.map&&(e.screenPoint=e.screenPoints[0],
e.mapPoint=e.mapPoints[0]);return e},_processTouchEvent:function(a,e){var c=this.map,d=c&&c.position,r=0;if(d&&e)if(f.isArray(e)){var h,k;a.screenPoints=[];a.mapPoints=[];for(h=0;h<e.length;h++)e[h]?(k=new m(e[h].pageX-d.x,e[h].pageY-d.y),a.screenPoints.push(k),a.mapPoints.push(c.extent?c.toMap(k):new q)):r++}else a.screenPoint=new m(e.pageX-d.x,e.pageY-d.y),a.mapPoint=c.extent?c.toMap(a.screenPoint):new q;a.numPoints=e?f.isArray(e)?e.length-r:1:0;return a},_processMouseEvent:function(a){var e=this.map,
c=e&&e.position;c&&(a.screenPoint=new m(a.pageX-c.x,a.pageY-c.y),a.mapPoint=e.extent?e.toMap(a.screenPoint):new q);return a},setImmediateTap:function(a){this._immediate=a},destroy:function(){var a=this.node;a.removeEventListener("MSPointerDown",this._pointerDown,!1);a.removeEventListener("MSPointerMove",this._pointerMove,!1);a.removeEventListener("MSPointerUp",this._pointerUp,!1);a.removeEventListener("MSPointerCancel",this._pointerCancel,!1);this.map&&(a.removeEventListener("mouseover",this._mouseOver,
!1),a.removeEventListener("mousemove",this._mouseMove,!1),a.removeEventListener("mouseout",this._mouseOut,!1),a.removeEventListener("mouseleave",this._mouseLeave,!1),a.removeEventListener("mousedown",this._mouseDown,!1),a.removeEventListener("mouseup",this._mouseUp,!1),a.removeEventListener("click",this._mouseClick,!1),a.removeEventListener("mouseenter",this._mouseEnter,!1));clearTimeout(this._tapTimer);this.node=this.map=this._numTouches=this._touches=this._touchIds=this._taps=null}})})},"esri/renderers/jsonUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../Color ../symbols/jsonUtils ./SimpleRenderer ./UniqueValueRenderer ./ClassBreaksRenderer ./VectorFieldRenderer ./DotDensityRenderer ./ScaleDependentRenderer ./TimeClassBreaksAger ./TimeRampAger ./TemporalRenderer ./HeatmapRenderer".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b){return{fromJson:function(b){var a;switch(b.type||""){case "simple":a=new m(b);break;case "uniqueValue":a=new g(b);break;case "classBreaks":a=new e(b);break;case "vectorField":a=new c(b);break;case "scaleDependent":a=this._scaleDependentFromJson(b);break;case "dotDensity":a=this._dotDensityFromJson(b);break;case "temporal":a=this._temporalFromJson(b);break;case "heatmap":a=this._heatmapFromJson(b)}return a},_scaleDependentFromJson:function(b){var c={},a=
b.minScale;c.rendererInfos=p.map(b.rendererInfos,function(b){var c=b.maxScale;b={minScale:a,maxScale:c,renderer:b.renderer&&this.fromJson(b.renderer)};a=c;return b},this);return new r(c)},_dotDensityFromJson:function(b){b.backgroundColor&&f.isArray(b.backgroundColor)&&(b.backgroundColor=h.toDojoColor(b.backgroundColor));0<b.dotSize&&(b.dotSize=l.pt2px(b.dotSize));b.fields&&p.forEach(b.fields,function(b){b&&f.isArray(b.color)&&(b.color=h.toDojoColor(b.color))});b.legendOptions&&(b.legendOptions.backgroundColor&&
f.isArray(b.legendOptions.backgroundColor)&&(b.legendOptions.backgroundColor=h.toDojoColor(b.legendOptions.backgroundColor)),b.legendOptions.outline&&(b.legendOptions.outline=q.fromJson(b.legendOptions.outline)));b.outline&&(b.outline=q.fromJson(b.outline));return new d(b)},_temporalFromJson:function(b){var c,a,d;b=b||{};c=this.fromJson(b.observationRenderer);a=b.latestObservationRenderer?this.fromJson(b.latestObservationRenderer):null;d=b.trackRenderer?this.fromJson(b.trackRenderer):null;b=this._agerFromJson(b.observationAger);
return new t(c,a,d,b)},_agerFromJson:function(b){var c;b=b||{};b.colorRange||b.sizeRange||b.alphaRange?c=this._timeRampFromJson(b):b.agerClassBreakInfos&&(c=this._timeClassBreaksFromJson(b));return c},_timeRampFromJson:function(b){var c,a,d;b.colorRange&&1<b.colorRange.length&&(c=[h.toDojoColor(b.colorRange[0]),h.toDojoColor(b.colorRange[1])]);b.sizeRange&&1<b.sizeRange.length&&(a=[b.sizeRange[0],b.sizeRange[1]]);b.alphaRange&&1<b.alphaRange.length&&(d=[b.alphaRange[0]/255,b.alphaRange[1]/255]);return new s(c,
a,d)},_timeClassBreaksFromJson:function(b){var c=b.agerClassBreakInfos,a,d,e=[],g;a=u.UNIT_DAYS;switch(b.timeUnits){case "esriTimeUnitsSeconds":a=u.UNIT_SECONDS;break;case "esriTimeUnitsMilliseconds":a=u.UNIT_MILLISECONDS;break;case "esriTimeUnitsHours":a=u.UNIT_HOURS;break;case "esriTimeUnitsMinutes":a=u.UNIT_MINUTES;break;case "esriTimeUnitsMonths":a=u.UNIT_MONTHS;break;case "esriTimeUnitsWeeks":a=u.UNIT_WEEKS;break;case "esriTimeUnitsYears":a=u.UNIT_YEARS}for(g=0;g<c.length;g+=1)b=c[g],d={minAge:0,
maxAge:b.oldestAge||Infinity},b.color&&(d.color=h.toDojoColor(b.color)),b.alpha&&(d.alpha=b.alpha/255),d.size=b.size,e[g]=d;return new u(e,a)},_heatmapFromJson:function(c){var a=c.colorStops;a&&a instanceof Array&&p.forEach(a,function(b){b.color=h.toDojoColor(b.color)});return new b(c)}}})},"esri/renderers/SimpleRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer".split(" "),function(p,f,a,l,k,h,q){return p(q,{declaredClass:"esri.renderer.SimpleRenderer",
constructor:function(a){if(a&&!a.declaredClass){var g=a;this.symbol=(a=g.symbol)&&(a.declaredClass?a:h.fromJson(a));this.label=g.label;this.description=g.description}else this.symbol=a},getSymbol:function(a){return this.symbol},toJson:function(){var a=f.mixin(this.inherited(arguments),{type:"simple",label:this.label,description:this.description,symbol:this.symbol&&this.symbol.toJson()});return k.fixJson(a)}})})},"esri/renderers/Renderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojox/gfx/_base ../kernel ../Color ./arcadeUtils".split(" "),
function(p,f,a,l,k,h,q,m){var g=Math.PI,e=1;return p(null,{declaredClass:"esri.renderer.Renderer",constructor:function(c){this._cache={};if(c&&!c.declaredClass){this.rotationInfo=c.rotationInfo;if(!this.rotationInfo){var a=c.rotationType,e=c.rotationExpression;if(a||e)this.rotationInfo={type:a,expression:e}}this.setRotationInfo(this.rotationInfo);this.setSizeInfo(this._readSizeInfo(c.sizeInfo));this.setColorInfo(this._readColorInfo(c.colorInfo));this.setOpacityInfo(this._readOpacityInfo(c.transparencyInfo));
this.setVisualVariables(this._readVariables(c.visualVariables));this.setAuthoringInfo(c.authoringInfo)}this.getSymbol=f.hitch(this,this.getSymbol)},getSymbol:function(c){},_readSizeInfo:function(c){if(c){var d=c.minSize,e=c.maxSize;d&&(c.minSize="number"===typeof d?k.pt2px(d):this._readSizeInfo(d));e&&(c.maxSize="number"===typeof e?k.pt2px(e):this._readSizeInfo(e));c.stops&&a.forEach(c.stops,function(c){c.size&&"number"===typeof c.size&&(c.size=k.pt2px(c.size))})}return c},_readColorInfo:function(c){c&&
(a.forEach(c.colors,function(a,e){f.isArray(a)&&(c.colors[e]=q.toDojoColor(a))}),a.forEach(c.stops,function(a,e){a.color&&f.isArray(a.color)&&(c.stops[e].color=q.toDojoColor(a.color))}));return c},_readOpacityInfo:function(c){var d;c&&(d=f.mixin({},c),d.transparencyValues&&(d.opacityValues=a.map(d.transparencyValues,function(c){return 1-c/100}),delete d.transparencyValues),d.stops&&(d.stops=a.map(d.stops,function(c){c=f.mixin({},c);c.opacity=1-c.transparency/100;delete c.transparency;return c})));
return d},_readVariables:function(c){c&&(c=a.map(c,function(c){"sizeInfo"===c.type?c=this._readSizeInfo(c):"colorInfo"===c.type?c=this._readColorInfo(c):"transparencyInfo"===c.type&&(c=this._readOpacityInfo(c),c.type="opacityInfo");return c},this));return c},setAuthoringInfo:function(c){this.authoringInfo=c},setRotationInfo:function(c){if(c=this.rotationInfo="string"===typeof c?{field:c}:c){if(c.expression&&!f.isFunction(c.expression)&&!c.field){var a=c.expression.match(this.rotationRE);a&&a[1]&&
(c.field=a[1])}c.rotationType=c.type}return this},rotationRE:/^\[([^\]]+)\]$/i,getRotationAngle:function(c,a){var e=this._getVarInfo(a&&a.rotationInfo,"rotationInfo").variable,g="arithmetic"===this._getRotationType(e),e=e.field,h=c.attributes,t=0;e&&(f.isFunction(e)?t=e.apply(this,arguments):h&&(t=h[e]||0),t=(t+(g?-90:0))*(g?-1:1));return t},_getRotationType:function(c){return c&&("rotationInfo"===c.type?c.rotationType:c.type)},_getDataValue:function(c,a,e,g){g||(g=this._getVarInfo(a,e),a=g.variable,
g=this._cache[g.cacheKey],"sizeInfo"===e&&(g=g.root));return c._getDataValue(a,g,m)},setVisualVariables:function(c){var d=this._cache;a.forEach(this.visualVariables,function(c,a){d.hasOwnProperty(a)&&(d[a]=null)},this);this.visualVariables=c;a.some(c,function(c){return!!c.target})&&c.sort(function(c,a){return c.target===a.target?0:c.target?1:-1});a.forEach(c,function(c,a){"colorInfo"===c.type?d[a]=this._processColorInfo(c):"opacityInfo"===c.type?d[a]=this._processOpacityInfo(c):"sizeInfo"===c.type&&
(d[a]=this._processSizeInfo(c))},this);return this},getVisualVariableValues:function(c){var d=this.visualVariables,e;d&&(e=a.map(d,function(a){var d;switch(a.type){case "sizeInfo":d=this.getSize(c,{sizeInfo:a});break;case "colorInfo":d=this.getColor(c,{colorInfo:a});break;case "opacityInfo":d=this.getOpacity(c,{opacityInfo:a});break;case "rotationInfo":d=this.getRotationAngle(c,{rotationInfo:a})}return{variable:a,value:d}},this));return e},hasVisualVariables:function(c,a){return c?!!this.getVisualVariablesForType(c,
a):!(!this.getVisualVariablesForType("sizeInfo",a)&&!this.getVisualVariablesForType("colorInfo",a)&&!this.getVisualVariablesForType("opacityInfo",a)&&!this.getVisualVariablesForType("rotationInfo",a))},getVisualVariablesForType:function(c,d){var e=this.visualVariables,g;!d&&this[c]?("rotationInfo"===c&&(this[c].rotationType=this[c].type),g=[this[c]]):e&&(g=a.filter(e,function(a){return a.type===c&&("string"===typeof d?a.target===d:!1===d?!a.target:!0)}))&&0===g.length&&(g=void 0);return g},setSizeInfo:function(c){this.sizeInfo=
this.proportionalSymbolInfo=c;this._cache.sizeInfo=this._processSizeInfo(c);return this},_processSizeInfo:function(c){return c&&{root:this._createCache(c),minSize:this._createCache(c.minSize),maxSize:this._createCache(c.maxSize)}},_getVarInfo:function(c,d){var e;c&&c.type===d?(e=a.indexOf(this.visualVariables,c),c=this.visualVariables[e]):(e=d,c=this[d]);return{variable:c,cacheKey:e}},setProportionalSymbolInfo:function(c){this.setSizeInfo(c);return this},getSize:function(c,a){var e=this._getVarInfo(a&&
a.sizeInfo,"sizeInfo"),g=e.variable,e=this._cache[e.cacheKey],f=null;if(g)var h=g.minSize,f=g.maxSize,h="object"===typeof h&&h?this._getSize(c,h,e&&e.minSize,a):h,f="object"===typeof f&&f?this._getSize(c,f,e&&e.maxSize,a):f,f=this._getSize(c,g,e&&e.root,a,[h,f]);return f},_getSize:function(c,a,e,f,h){var t=a.expression,b=a.stops,k=0,n=e&&e.exprTree,m=e&&e.ipData,l="number"===typeof c?c:null;if(a.field||t||n){var q=f&&f.scale,n=h?h[0]:a.minSize;h=h?h[1]:a.maxSize;var y=a.minDataValue,p=a.maxDataValue,
B=a.valueUnit||"unknown",F=a.valueRepresentation,E=a.scaleBy,H=f&&f.shape;t?l="view.scale"===t.toLowerCase()?q:null:"number"!==typeof l&&(l=this._getDataValue(c,a,null,e));if(null==l)return null;if(b)n=this._lookupData(l,m),l=n[0],h=n[1],l===h?k=b[l].size:(l=b[l].size,b=b[h].size,k=l+(b-l)*n[2]);else if(null!=n&&null!=h&&null!=y&&null!=p)l<=y?k=n:l>=p?k=h:(b=(l-y)/(p-y),"area"===E&&H?(n=(l="circle"===H)?g*Math.pow(n/2,2):n*n,h=l?g*Math.pow(h/2,2):h*h,b=n+b*(h-n),k=l?2*Math.sqrt(b/g):Math.sqrt(b)):
k=n+b*(h-n));else if("unknown"===B)null!=n&&null!=y&&(n&&y?(b=l/y,k="circle"===H?2*Math.sqrt(b*Math.pow(n/2,2)):"square"===H||"diamond"===H||"image"===H?Math.sqrt(b*Math.pow(n,2)):b*n):k=l+(n||y),k=k<n?n:k,null!=h&&k>h&&(k=h));else{b=(f&&f.resolution?f.resolution:1)*this._meterIn[B];if("area"===F)k=Math.sqrt(l/g)/b,k*=2;else if(k=l/b,"radius"===F||"distance"===F)k*=2;null!=n&&k<n&&(k=n);null!=h&&k>h&&(k=h)}}else k=b&&b[0]&&b[0].size,null==k&&(k=a.minSize);return k=isNaN(k)?0:k},getSizeRangeAtScale:function(c,
a){var e,g=this._getVarInfo(c,"sizeInfo"),f=this._cache[g.cacheKey],h={scale:a};if((c=g.variable)&&a){var b=c.minSize,g=c.maxSize,b="object"===typeof b&&b?this._getSize({},b,f&&f.minSize,h):b,f="object"===typeof g&&g?this._getSize({},g,f&&f.maxSize,h):g;if(null!=b||null!=f)e={minSize:b,maxSize:f}}return e},setColorInfo:function(c){this.colorInfo=c;this._cache.colorInfo=this._processColorInfo(c);return this},_createCache:function(c){return{ipData:this._interpolateData(c),exprTree:m.parseExpression(c&&
c.valueExpression),version:e++}},_processColorInfo:function(c){c&&(a.forEach(c.colors,function(a,e){f.isArray(a)&&(c.colors[e]=new q(a))}),a.forEach(c.stops,function(a,e){a.color&&f.isArray(a.color)&&(c.stops[e].color=new q(a.color))}));return this._createCache(c)},getColor:function(c,a){var e=this._getVarInfo(a&&a.colorInfo,"colorInfo");return this._getColorComponent(c,e.variable,this._cache[e.cacheKey])},setOpacityInfo:function(c){this.opacityInfo=c;this._cache.opacityInfo=this._processOpacityInfo(c);
return this},_processOpacityInfo:function(c){return this._createCache(c)},getOpacity:function(c,a){var e=this._getVarInfo(a&&a.opacityInfo,"opacityInfo");return this._getColorComponent(c,e.variable,this._cache[e.cacheKey],!0)},_getColorComponent:function(c,a,e,g,h){var t=c.attributes,b=a&&a.field,k="number"===typeof c,n=k?c:null,w=e&&e.exprTree,l=e&&e.ipData,q;if(b||w){var y=a.normalizationField,p=t?parseFloat(t[y]):void 0;"number"!==typeof n&&(w?n=m.executeExpression(w,m.createExecContext(c)):f.isFunction(b)?
n=b.apply(this,arguments):t&&(n=t[b]));if(null!=n&&(!y||k||!isNaN(p)&&0!==p))!isNaN(p)&&!k&&(n/=p),q=g?this._getOpacity(n,a,l):this._getColor(n,a,l)}else a&&(t=a.stops,g?(q=t&&t[0]&&t[0].opacity,null==q&&(q=a.opacityValues&&a.opacityValues[0])):q=t&&t[0]&&t[0].color||a.colors&&a.colors[0]);h&&(h.data=n,h.value=q);return h||q},_interpolateData:function(c){var d;if(c)if(c.colors||c.opacityValues){var e=(c.colors||c.opacityValues).length,g=c.minDataValue,f=(c.maxDataValue-g)/(e-1);d=[];for(c=0;c<e;c++)d[c]=
g+c*f}else c.stops&&(d=a.map(c.stops,function(c){return c.value}));return d},_getOpacity:function(c,a,e){c=this._lookupData(c,e);var g;a=a||this.opacityInfo;c&&(e=c[0],g=c[1],e===g?g=this._getOpacValue(a,e):(e=this._getOpacValue(a,e),a=this._getOpacValue(a,g),g=e+(a-e)*c[2]));return g},_getOpacValue:function(c,a){return c.opacityValues?c.opacityValues[a]:c.stops[a].opacity},_getColor:function(c,a,e){c=this._lookupData(c,e);var g;a=a||this.colorInfo;c&&(g=c[0],e=c[1],g=g===e?this._getColorObj(a,g):
q.blendColors(this._getColorObj(a,g),this._getColorObj(a,e),c[2]));return g},_getColorObj:function(c,a){return c.colors?c.colors[a]:c.stops[a].color},_lookupData:function(c,d){var e;if(d){var g=0,f=d.length-1;a.some(d,function(a,b){if(c<a)return f=b,!0;g=b;return!1});e=[g,f,(c-d[g])/(d[f]-d[g])]}return e},_meterIn:{inches:39.3701,feet:3.28084,yards:1.09361,miles:6.21371E-4,"nautical-miles":5.39957E-4,millimeters:1E3,centimeters:100,decimeters:10,meters:1,kilometers:0.001,"decimal-degrees":180/20015077},
_writeSizeInfo:function(c){if(c){c=f.mixin({},c);var d=c.minSize,e=c.maxSize;d&&(c.minSize="number"===typeof d?k.px2pt(d):this._writeSizeInfo(d));e&&(c.maxSize="number"===typeof e?k.px2pt(e):this._writeSizeInfo(e));if(d=c.legendOptions)if(c.legendOptions=f.mixin({},d),d=d.customValues)c.legendOptions.customValues=d.slice(0);c.stops&&(c.stops=a.map(c.stops,function(c){c=f.mixin({},c);c.size&&"number"===typeof c.size&&(c.size=k.px2pt(c.size));return c}))}return c},_writeColorInfo:function(c){c&&(c=
f.mixin({},c),c.colors&&(c.colors=a.map(c.colors,function(c){return q.toJsonColor(c)})),c.stops&&(c.stops=a.map(c.stops,function(c){c=f.mixin({},c);c.color&&(c.color=q.toJsonColor(c.color));return c})));return c},_writeOpacityInfo:function(c){var d;c&&(d=f.mixin({},c),d.opacityValues&&(d.transparencyValues=a.map(d.opacityValues,function(c){return 100*(1-c)}),delete d.opacityValues),d.stops&&(d.stops=a.map(d.stops,function(c){c=f.mixin({},c);c.transparency=100*(1-c.opacity);delete c.opacity;return c})),
d.legendOptions&&(d.legendOptions=f.mixin({},d.legendOptions)));return d},toJson:function(){var c=this.visualVariables,d=f.clone(this.authoringInfo),e=this.getVisualVariablesForType("rotationInfo",!1),g=(e=e&&e[0])&&e.field,g=e&&(e.expression||g&&(f.isFunction(g)?g:"["+g+"]"));c&&(c=a.map(c,function(c){"sizeInfo"===c.type?c=this._writeSizeInfo(c):"colorInfo"===c.type?c=this._writeColorInfo(c):"opacityInfo"===c.type?(c=this._writeOpacityInfo(c),c.type="transparencyInfo"):"rotationInfo"===c.type&&(c=
f.mixin({},c));return c},this));d&&a.forEach(d.visualVariables,function(c){"opacityInfo"===c.type&&(c.type="transparencyInfo")});return{rotationType:g&&(this._getRotationType(e)||"geographic"),rotationExpression:g,colorInfo:this._writeColorInfo(this.colorInfo),transparencyInfo:this._writeOpacityInfo(this.opacityInfo),sizeInfo:this._writeSizeInfo(this.sizeInfo),visualVariables:c,authoringInfo:d}}})})},"esri/renderers/arcadeUtils":function(){define(["dojo/_base/lang","dojo/has","../kernel","../arcade/arcade"],
function(p,f,a,l){return{parseExpression:function(a,f){f=f||{vars:{$feature:"any"}};return a?l.parseScript(a,f):null},createExecContext:function(a){return{vars:{$feature:l.constructFeature(a)}}},executeExpression:function(a,f){return l.executeScript(a,f,-1)}}})},"esri/arcade/arcade":function(){define(["require","exports","./arcadeRuntime","./parser","./Feature"],function(p,f,a,l,k){f.constructFeature=function(a){return k.fromFeature(a)};f.parseScript=function(a){return l.parseScript(a)};f.validateScript=
function(a,f){return l.validateScript(a,f,"simple")};f.scriptCheck=function(a,f,k){return l.scriptCheck(a,f,k,"full")};f.parseAndExecuteScript=function(f,k,m){return a.executeScript(l.parseScript(f),k,m)};f.executeScript=function(f,k,m){return a.executeScript(f,k,m)};f.referencesMember=function(f,k){return a.referencesMember(f,k)};f.referencesFunction=function(f,k){return a.referencesFunction(f,k)};f.extractFieldLiterals=function(a,f){void 0===f&&(f=!1);return l.extractFieldLiterals(a,f)}})},"esri/arcade/arcadeRuntime":function(){define("require exports ../geometry/Polygon ../graphic ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./FunctionWrapper ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/stats ./ImmutablePathArray ./ImmutablePointArray ../geometry/Geometry".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z){function y(b,c){for(var a=[],d=0;d<c.arguments.length;d++)a.push(B(b,c.arguments[d]));return a}function A(b,c,a){try{return a(b,c,y(b,c))}catch(d){throw d;}}function B(b,a){try{switch(a.type){case "EmptyStatement":return e.voidOperation;case "VariableDeclarator":var g=null===a.init?null:B(b,a.init);g===e.voidOperation&&(g=null);var n=a.id.name.toLowerCase();null!==b.localScope?b.localScope[n]={value:g,valueset:!0,node:a.init}:b.globalScope[n]=
{value:g,valueset:!0,node:a.init};return e.voidOperation;case "VariableDeclaration":for(var f=0;f<a.declarations.length;f++)B(b,a.declarations[f]);return e.voidOperation;case "BlockStatement":var h;a:{for(var t=e.voidOperation,f=0;f<a.body.length;f++)if(t=B(b,a.body[f]),t instanceof e.ReturnResult||t===e.breakResult||t===e.continueResult){h=t;break a}h=t}return h;case "FunctionDeclaration":var k=a.id.name.toLowerCase();b.globalScope[k]={valueset:!0,node:null,value:new u(a,b)};return e.voidOperation;
case "ReturnStatement":var m;if(null===a.argument)m=new e.ReturnResult(e.voidOperation);else{var s=B(b,a.argument);m=new e.ReturnResult(s)}return m;case "IfStatement":var w;if("AssignmentExpression"===a.test.type||"UpdateExpression"===a.test.type)throw Error(c.nodeErrorMessage(a.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var v=B(b,a.test);if(!0===v)w=B(b,a.consequent);else if(!1===v)w=null!==a.alternate?B(b,a.alternate):e.voidOperation;else throw Error(c.nodeErrorMessage(a,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));
return w;case "ExpressionStatement":var l;if("AssignmentExpression"===a.expression.type||"UpdateExpression"===a.expression.type)l=B(b,a.expression);else{var q=B(b,a.expression);l=q===e.voidOperation?e.voidOperation:new e.ImplicitResult(q)}return l;case "AssignmentExpression":var z;var x=B(b,a.right),f=null,y="";if("MemberExpression"===a.left.type){f=B(b,a.left.object);y=!0===a.left.computed?B(b,a.left.property):a.left.property.name;if(e.isArray(f))if(e.isNumber(y)){if(0>y||y>f.length)throw Error("Assignment outside of array bounds");
if(y===f.length&&"\x3d"!==a.operator)throw Error("Invalid Parameter");f[y]=E(x,a.operator,f[y],a)}else throw Error("Invalid Parameter");else if(f instanceof d){if(!1===e.isString(y))throw Error("Dictionary accessor must be a string");if(!0===f.hasField(y))f.setField(y,E(x,a.operator,f.field(y),a));else{if("\x3d"!==a.operator)throw Error("Invalid Parameter");f.setField(y,E(x,a.operator,null,a))}}else if(f instanceof r){if(!1===e.isString(y))throw Error("Feature accessor must be a string");if(!0===
f.hasField(y))f.setField(y,E(x,a.operator,f.field(y),a));else{if("\x3d"!==a.operator)throw Error("Invalid Parameter");f.setField(y,E(x,a.operator,null,a))}}else{if(e.isImmutableArray(f))throw Error("Array is Immutable");throw Error("Invalid Parameter");}z=e.voidOperation}else if(f=a.left.name.toLowerCase(),null!==b.localScope&&void 0!==b.localScope[f])b.localScope[f]={value:E(x,a.operator,b.localScope[f].value,a),valueset:!0,node:a.right},z=e.voidOperation;else if(void 0!==b.globalScope[f])b.globalScope[f]=
{value:E(x,a.operator,b.globalScope[f].value,a),valueset:!0,node:a.right},z=e.voidOperation;else throw Error("Variable not recognised");return z;case "UpdateExpression":var p;var A,f=null,y="";if("MemberExpression"===a.argument.type){f=B(b,a.argument.object);y=!0===a.argument.computed?B(b,a.argument.property):a.argument.property.name;if(e.isArray(f))if(e.isNumber(y)){if(0>y||y>=f.length)throw Error("Assignment outside of array bounds");A=e.toNumber(f[y]);f[y]="++"===a.operator?A+1:A-1}else throw Error("Invalid Parameter");
else if(f instanceof d){if(!1===e.isString(y))throw Error("Dictionary accessor must be a string");if(!0===f.hasField(y))A=e.toNumber(f.field(y)),f.setField(y,"++"===a.operator?A+1:A-1);else throw Error("Invalid Parameter");}else if(f instanceof r){if(!1===e.isString(y))throw Error("Feature accessor must be a string");if(!0===f.hasField(y))A=e.toNumber(f.field(y)),f.setField(y,"++"===a.operator?A+1:A-1);else throw Error("Invalid Parameter");}else{if(e.isImmutableArray(f))throw Error("Array is Immutable");
throw Error("Invalid Parameter");}p=!1===a.prefix?A:"++"===a.operator?A+1:A-1}else if(f=a.argument.name.toLowerCase(),null!==b.localScope&&void 0!==b.localScope[f])A=e.toNumber(b.localScope[f].value),b.localScope[f]={value:"++"===a.operator?A+1:A-1,valueset:!0,node:a},p=!1===a.prefix?A:"++"===a.operator?A+1:A-1;else if(void 0!==b.globalScope[f])A=e.toNumber(b.globalScope[f].value),b.globalScope[f]={value:"++"===a.operator?A+1:A-1,valueset:!0,node:a},p=!1===a.prefix?A:"++"===a.operator?A+1:A-1;else throw Error("Variable not recognised");
return p;case "BreakStatement":return e.breakResult;case "ContinueStatement":return e.continueResult;case "ForStatement":null!==a.init&&B(b,a.init);y={testResult:!0,lastAction:e.voidOperation};do b:{z=b;x=a;p=y;if(null!==x.test){p.testResult=B(z,x.test);if(!1===p.testResult)break b;if(!0!==p.testResult)throw Error(c.nodeErrorMessage(x,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));}p.lastAction=B(z,x.body);p.lastAction===e.breakResult?p.testResult=!1:p.lastAction instanceof e.ReturnResult?p.testResult=
!1:null!==x.update&&B(z,x.update)}while(!0===y.testResult);f=y.lastAction instanceof e.ReturnResult?y.lastAction:e.voidOperation;return f;case "ForInStatement":return F(b,a);case "Identifier":var H;var J;try{var C=a.name.toLowerCase();if(null!==b.localScope&&void 0!==b.localScope[C])J=b.localScope[C],!0!==J.valueset&&(J.value=B(b,J.node),J.valueset=!0),H=J.value;else if(void 0!==b.globalScope[C])J=b.globalScope[C],!0!==J.valueset&&(J.value=B(b,J.node),J.valueset=!0),H=J.value;else throw Error(c.nodeErrorMessage(a,
"RUNTIME","VARIABLENOTFOUND"));}catch(L){throw L;}return H;case "MemberExpression":return I(b,a);case "Literal":return a.value;case "ThisExpression":throw Error(c.nodeErrorMessage(a,"RUNTIME","NOTSUPPORTED"));case "CallExpression":return K(b,a);case "UnaryExpression":return M(b,a);case "BinaryExpression":return Q(b,a);case "LogicalExpression":var G;a:try{if("AssignmentExpression"===a.left.type||"UpdateExpression"===a.left.type)throw Error(c.nodeErrorMessage(a.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));
if("AssignmentExpression"===a.right.type||"UpdateExpression"===a.right.type)throw Error(c.nodeErrorMessage(a.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var O=[B(b,a.left),B(b,a.right)],T=O[0],P=O[1];if(e.isBoolean(T)&&e.isBoolean(P))switch(a.operator){case "||":G=T||P;break a;case "\x26\x26":G=T&&P;break a;default:throw Error(c.nodeErrorMessage(a,"RUNTIME","ONLYORORAND"));}else throw Error(c.nodeErrorMessage(a,"RUNTIME","ONLYBOOLEAN"));}catch(V){throw V;}return G;case "ConditionalExpression":throw Error(c.nodeErrorMessage(a,
"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{f=[];for(y=0;y<a.elements.length;y++){var X=B(b,a.elements[y]);if(e.isFunctionParameter(X))throw Error(c.nodeErrorMessage(a,"RUNTIME","FUNCTIONCONTEXTILLEGAL"));X===e.voidOperation?f.push(null):f.push(X)}}catch(R){throw R;}return f;case "ObjectExpression":f={};for(y=0;y<a.properties.length;y++){var ya=B(b,a.properties[y]);if(e.isFunctionParameter(ya.value))throw Error("Illegal Argument");if(!1===e.isString(ya.key))throw Error("Illegal Argument");
f[ya.key.toString()]=ya.value===e.voidOperation?null:ya.value}var Fa=new d(f);Fa.immutable=!1;return Fa;case "Property":return{key:"Identifier"===a.key.type?a.key.name:B(b,a.key),value:B(b,a.value)};case "Array":throw Error(c.nodeErrorMessage(a,"RUNTIME","NOTSUPPORTED"));default:throw Error(c.nodeErrorMessage(a,"RUNTIME","UNREOGNISED"));}}catch($){throw $;}}function F(b,a){var g=B(b,a.right);"VariableDeclaration"===a.left.type&&B(b,a.left);var n=null,f="VariableDeclaration"===a.left.type?a.left.declarations[0].id.name:
a.left.name;null!==b.localScope&&void 0!==b.localScope[f]&&(n=b.localScope[f]);null===n&&void 0!==b.globalScope[f]&&(n=b.globalScope[f]);if(null===n)throw Error(c.nodeErrorMessage(a,"RUNTIME","VARIABLENOTDECLARED"));if(e.isArray(g)||e.isString(g)){for(var g=g.length,h=0;h<g&&!(n.value=h,f=B(b,a.body),f===e.breakResult);h++)if(f instanceof e.ReturnResult)return f;return e.voidOperation}if(e.isImmutableArray(g)){for(h=0;h<g.length()&&!(n.value=h,f=B(b,a.body),f===e.breakResult);h++)if(f instanceof e.ReturnResult)return f;
return e.voidOperation}if(g instanceof d||g instanceof r){g=g.keys();for(h=0;h<g.length&&!(n.value=g[h],f=B(b,a.body),f===e.breakResult);h++)if(f instanceof e.ReturnResult)return f}else return e.voidOperation}function E(b,a,d,g){switch(a){case "\x3d":return b===e.voidOperation?null:b;case "/\x3d":return e.toNumber(d)/e.toNumber(b);case "*\x3d":return e.toNumber(d)*e.toNumber(b);case "-\x3d":return e.toNumber(d)-e.toNumber(b);case "+\x3d":return e.isString(d)||e.isString(b)?e.toString(d)+e.toString(b):
e.toNumber(d)+e.toNumber(b);case "%\x3d":return e.toNumber(d)%e.toNumber(b);default:throw Error(c.nodeErrorMessage(g,"RUNTIME","OPERATORNOTRECOGNISED"));}}function H(b,a,g,n){a=a.toLowerCase();switch(a){case "hasz":return b=b.hasZ,void 0===b?!1:b;case "hasm":return b=b.hasM,void 0===b?!1:b;case "spatialreference":return a=b.spatialReference._arcadeCacheId,void 0===a&&(g=!0,Object.freeze&&Object.isFrozen(b.spatialReference)&&(g=!1),g&&(C++,a=b.spatialReference._arcadeCacheId=C)),b=new d({wkt:b.spatialReference.wkt,
wkid:b.spatialReference.wkid}),void 0!==a&&(b._arcadeCacheId="SPREF"+a.toString()),b}switch(b.type){case "extent":switch(a){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return b=b[a],void 0!==b?b:null;case "type":return"Extent"}break;case "polygon":switch(a){case "rings":return a=e.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===a&&(C++,a=C,e.isVersion4?b.cache._arcadeCacheId=a:b.setCacheValue("_arcadeCacheId",a)),b=new w(b.rings,
b.spatialReference,!0===b.hasZ,!0===b.hasM,a);case "type":return"Polygon"}break;case "point":switch(a){case "x":case "y":case "z":case "m":return void 0!==b[a]?b[a]:null;case "type":return"Point"}break;case "polyline":switch(a){case "paths":return a=e.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===a&&(C++,a=C,e.isVersion4?b.cache._arcadeCacheId=a:b.setCacheValue("_arcadeCacheId",a)),b=new w(b.paths,b.spatialReference,!0===b.hasZ,!0===b.hasM,a);case "type":return"Polyline"}break;
case "multipoint":switch(a){case "points":return a=e.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===a&&(C++,a=C,e.isVersion4?b.cache._arcadeCacheId=a:b.setCacheValue("_arcadeCacheId",a)),b=new x(b.points,b.spatialReference,!0===b.hasZ,!0===b.hasM,a,1);case "type":return"Multipoint"}}throw Error(c.nodeErrorMessage(n,"RUNTIME","PROPERTYNOTFOUND"));}function I(b,a){try{var g=B(b,a.object);if(null===g)throw Error(c.nodeErrorMessage(a,"RUNTIME","NOTFOUND"));if(!1===a.computed){if(g instanceof
d||g instanceof r)return g.field(a.property.name);if(g instanceof z)return H(g,a.property.name,b,a);throw Error(c.nodeErrorMessage(a,"RUNTIME","INVALIDTYPE"));}var n=B(b,a.property);if(g instanceof d||g instanceof r){if(e.isString(n))return g.field(n)}else if(g instanceof z){if(e.isString(n))return H(g,n,b,a)}else if(e.isArray(g)){if(e.isNumber(n)&&isFinite(n)&&Math.floor(n)===n){if(n>=g.length||0>n)throw Error(c.nodeErrorMessage(a,"RUNTIME","OUTOFBOUNDS"));return g[n]}}else if(e.isString(g)){if(e.isNumber(n)&&
isFinite(n)&&Math.floor(n)===n){if(n>=g.length||0>n)throw Error(c.nodeErrorMessage(a,"RUNTIME","OUTOFBOUNDS"));return g[n]}}else if(e.isImmutableArray(g)&&e.isNumber(n)&&isFinite(n)&&Math.floor(n)===n){if(n>=g.length()||0>n)throw Error(c.nodeErrorMessage(a,"RUNTIME","OUTOFBOUNDS"));return g.get(n)}throw Error(c.nodeErrorMessage(a,"RUNTIME","INVALIDTYPE"));}catch(f){throw f;}}function M(b,a){try{var d=B(b,a.argument);if(e.isBoolean(d)){if("!"===a.operator)return!d;if("-"===a.operator)return-1*e.toNumber(d);
if("+"===a.operator)return 1*e.toNumber(d);throw Error(c.nodeErrorMessage(a,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===a.operator)return-1*e.toNumber(d);if("+"===a.operator)return 1*e.toNumber(d);throw Error(c.nodeErrorMessage(a,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}catch(g){throw g;}}function Q(b,a){try{var d=[B(b,a.left),B(b,a.right)],g=d[0],n=d[1];switch(a.operator){case "\x3d\x3d":return e.equalityTest(g,n);case "\x3d":return e.equalityTest(g,n);case "!\x3d":return!e.equalityTest(g,
n);case "\x3c":return e.greaterThanLessThan(g,n,a.operator);case "\x3e":return e.greaterThanLessThan(g,n,a.operator);case "\x3c\x3d":return e.greaterThanLessThan(g,n,a.operator);case "\x3e\x3d":return e.greaterThanLessThan(g,n,a.operator);case "+":return e.isString(g)||e.isString(n)?e.toString(g)+e.toString(n):e.toNumber(g)+e.toNumber(n);case "-":return e.toNumber(g)-e.toNumber(n);case "*":return e.toNumber(g)*e.toNumber(n);case "/":return e.toNumber(g)/e.toNumber(n);case "%":return e.toNumber(g)%
e.toNumber(n);default:throw Error(c.nodeErrorMessage(a,"RUNTIME","OPERATORNOTRECOGNISED"));}}catch(f){throw f;}}function K(b,a){try{if("Identifier"!==a.callee.type)throw Error(c.nodeErrorMessage(a,"RUNTIME","ONLYNODESSUPPORTED"));if(null!==b.localScope&&void 0!==b.localScope[a.callee.name.toLowerCase()]){var d=b.localScope[a.callee.name.toLowerCase()];if(d.value instanceof e.NativeFunction)return d.value.fn(b,a);if(d.value instanceof u)return V(b,a,d.value.definition);throw Error(c.nodeErrorMessage(a,
"RUNTIME","NOTAFUNCTION"));}if(void 0!==b.globalScope[a.callee.name.toLowerCase()]){d=b.globalScope[a.callee.name.toLowerCase()];if(d.value instanceof e.NativeFunction)return d.value.fn(b,a);if(d.value instanceof u)return V(b,a,d.value.definition);throw Error(c.nodeErrorMessage(a,"RUNTIME","NOTAFUNCTION"));}throw Error(c.nodeErrorMessage(a,"RUNTIME","NOTFOUND"));}catch(g){throw g;}}function J(b){return null==b?"":e.isArray(b)||e.isImmutableArray(b)?"Array":e.isDate(b)?"Date":e.isString(b)?"String":
e.isBoolean(b)?"Boolean":e.isNumber(b)?"Number":b instanceof d?"Dictionary":b instanceof r?"Feature":b instanceof h?"Point":b instanceof a?"Polygon":b instanceof k?"Polyline":b instanceof m?"Multipoint":b instanceof q?"Extent":e.isFunctionParameter(b)?"Function":b===e.voidOperation?"":"number"===typeof b&&isNaN(b)?"Number":"Unrecognised Type"}function O(b,c,a,d){try{var g=B(b,c.arguments[a]);if(e.equalityTest(g,d))return B(b,c.arguments[a+1]);var n=c.arguments.length-a;return 1===n?B(b,c.arguments[a]):
2===n?null:O(b,c,a+2,d)}catch(f){throw f;}}function G(b,c,a,d){try{if(!0===d)return B(b,c.arguments[a+1]);if(3===c.arguments.length-a)return B(b,c.arguments[a+2]);var g=B(b,c.arguments[a+2]);if(!1===e.isBoolean(g))throw Error("WHEN needs boolean test conditions");return G(b,c,a+2,g)}catch(n){throw n;}}function T(b,c){var a=b.length,d=Math.floor(a/2);if(0===a)return[];if(1===a)return[b[0]];for(var e=T(b.slice(0,d),c),a=T(b.slice(d,a),c),d=[];0<e.length||0<a.length;)if(0<e.length&&0<a.length){var g=
c(e[0],a[0]);isNaN(g)&&(g=0);0>=g?(d.push(e[0]),e=e.slice(1)):(d.push(a[0]),a=a.slice(1))}else 0<e.length?(d.push(e[0]),e=e.slice(1)):0<a.length&&(d.push(a[0]),a=a.slice(1));return d}function P(b,c,a){try{var d=b.body;if(a.length!==b.params.length)throw Error("Invalid Parameter calls to function.");for(var g=0;g<a.length;g++)c.localScope[b.params[g].name.toLowerCase()]={d:null,value:a[g],valueset:!0,node:null};var n=B(c,d);if(n instanceof e.ReturnResult)return n.value;if(n===e.breakResult)throw Error("Cannot Break from a Function");
if(n===e.continueResult)throw Error("Cannot Continue from a Function");return n instanceof e.ImplicitResult?n.value:n}catch(f){throw f;}}function V(b,c,a){return A(b,c,function(c,d,e){c={spatialReference:b.spatialReference,applicationCache:void 0===b.applicationCache?null:b.applicationCache,globalScope:b.globalScope,depthCounter:b.depthCounter+1,localScope:{}};if(64<c.depthCounter)throw Error("Exceeded maximum function depth");return P(a,c,e)})}function L(b){return function(){var c={applicationCache:void 0===
b.context.applicationCache?null:b.context.applicationCache,spatialReference:b.context.spatialReference,localScope:{},depthCounter:b.context.depthCounter+1,globalScope:b.context.globalScope};if(64<c.depthCounter)throw Error("Exceeded maximum function depth");return P(b.definition,c,arguments)}}var C=0,X={};s.registerFunctions(X,A);t.registerFunctions(X,A);b.registerFunctions(X,A);v.registerFunctions(X,A);n.registerFunctions(X,A);X["typeof"]=function(b,c){return A(b,c,function(b,c,a){e.pcCheck(a,1,
1);b=J(a[0]);if("Unrecognised Type"===b)throw Error("Unrecognised Type");return b})};X.iif=function(b,c){try{e.pcCheck(null===c.arguments?[]:c.arguments,3,3);var a=B(b,c.arguments[0]);if(!1===e.isBoolean(a))throw Error("IF Function must have a boolean test condition");return!0===a?B(b,c.arguments[1]):B(b,c.arguments[2])}catch(d){throw d;}};X.decode=function(b,c){try{if(2>c.arguments.length)throw Error("Missing Parameters");if(2===c.arguments.length)return B(b,c.arguments[1]);if(0===(c.arguments.length-
1)%2)throw Error("Must have a default value result.");var a=B(b,c.arguments[0]);return O(b,c,1,a)}catch(d){throw d;}};X.when=function(b,c){try{if(3>c.arguments.length)throw Error("Missing Parameters");if(0===c.arguments.length%2)throw Error("Must have a default value result.");var a=B(b,c.arguments[0]);if(!1===e.isBoolean(a))throw Error("WHEN needs boolean test conditions");return G(b,c,0,a)}catch(d){throw d;}};X.top=function(b,c){return A(b,c,function(b,c,a){e.pcCheck(a,2,2);if(e.isArray(a[0]))return e.toNumber(a[1])>=
a[0].length?a[0].slice(0):a[0].slice(0,e.toNumber(a[1]));if(e.isImmutableArray(a[0]))return e.toNumber(a[1])>=a[0].length()?a[0].slice(0):a[0].slice(0,e.toNumber(a[1]));throw Error("Top cannot accept this parameter type");})};X.first=function(b,c){return A(b,c,function(b,c,a){e.pcCheck(a,1,1);return e.isArray(a[0])?0===a[0].length?null:a[0][0]:e.isImmutableArray(a[0])?0===a[0].length()?null:a[0].get(0):null})};X.sort=function(b,c){return A(b,c,function(b,c,a){e.pcCheck(a,1,2);b=a[0];e.isImmutableArray(b)&&
(b=b.toArray());if(!1===e.isArray(b))throw Error("Illegal Argument");if(1<a.length){if(!1===e.isFunctionParameter(a[1]))throw Error("Illegal Argument");var d=L(a[1]);b=T(b,function(b,c){return d(b,c)})}else{if(0===b.length)return[];a={};for(c=0;c<b.length;c++){var g=J(b[c]);""!==g&&(a[g]=!0)}if(!0===a.Array||!0===a.Dictionary||!0===a.Feature||!0===a.Point||!0===a.Polygon||!0===a.Polyline||!0===a.Multipoint||!0===a.Extent||!0===a.Function)return b.slice(0);c=0;var g="",n;for(n in a)c++,g=n;b=1<c||
"String"===g?T(b,function(b,c){if(null===b||void 0===b||b===e.voidOperation)return null===c||void 0===c||c===e.voidOperation?0:1;if(null===c||void 0===c||c===e.voidOperation)return-1;var a=e.toString(b),d=e.toString(c);return a<d?-1:a===d?0:1}):"Number"===g?T(b,function(b,c){return b-c}):"Boolean"===g?T(b,function(b,c){return b===c?0:c?-1:1}):"Date"===g?T(b,function(b,c){return c-b}):b.slice(0)}return b})};f.functionHelper={fixSpatialReference:e.fixSpatialReference,parseArguments:y,standardFunction:A};
f.executeScript=function(b,c,a){a||(a=new g(102100));var n=c.vars,f=c.customfunctions,h={};n||(n={});f||(f={});var t=new d({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});t.immutable=!1;h.textformatting={value:t,valueset:!0,node:null};h.infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null};h.pi={value:Math.PI,valueset:!0,node:null};for(var k in X)h[k]={value:new e.NativeFunction(X[k]),valueset:!0,node:null};for(k in f)h[k]={value:new e.NativeFunction(f[k]),
"native":!0,valueset:!0,node:null};for(k in n)h[k]=n[k]instanceof l?{value:new r(n[k]),valueset:!0,node:null}:{value:n[k],valueset:!0,node:null};b=B({spatialReference:a,globalScope:h,localScope:null,depthCounter:1,applicationCache:void 0===c.applicationCache?null:c.applicationCache},b.body[0].body);b instanceof e.ReturnResult&&(b=b.value);b instanceof e.ImplicitResult&&(b=b.value);b===e.voidOperation&&(b=null);if(b===e.breakResult)throw Error("Cannot return BREAK");if(b===e.continueResult)throw Error("Cannot return CONTINUE");
if(b instanceof u)throw Error("Cannot return FUNCTION");if(b instanceof e.NativeFunction)throw Error("Cannot return FUNCTION");return b};f.extractFieldLiterals=function(b,a){void 0===a&&(a=!1);return c.findFieldLiterals(b,a)};f.validateScript=function(b,a){return c.validateScript(b,a,"simple")};f.referencesMember=function(b,a){return c.referencesMember(b,a)};f.referencesFunction=function(b,a){return c.referencesFunction(b,a)}})},"esri/arcade/languageUtils":function(){define("require exports ../geometry/Geometry ../moment dojo/number ./ImmutableArray ../kernel ./ImmutablePointArray ./ImmutablePathArray dojo/_base/array ../geometry/Point ./FunctionWrapper".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d){function r(b,c,a){if(""===c||null===c||void 0===c||c===a||c===a)return b;do b=b.replace(c,a);while(-1!==b.indexOf(c));return b}function u(b){return b instanceof M||b instanceof d}function s(b){return"string"===typeof b||b instanceof String}function t(b){return"boolean"===typeof b}function b(b){return"number"===typeof b}function v(b){return b instanceof Array}function n(b){return b instanceof Date}function w(b,c){if(!1===isNaN(b)){if(void 0===c||null===c||""===c)return b.toString();
c=r(c,"\u2030","");c=r(c,"\u00a4","");return k.format(b,{pattern:c})}return b.toString()}function x(b,c){var a=l(b);return void 0===c||null===c||""===c?a.format():a.format(c)}function z(b,c,a){switch(a){case "\x3e":return b>c;case "\x3c":return b<c;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return b<=c}return!1}function y(b,a){if(b===a||null===b&&a===f.voidOperation||null===a&&b===f.voidOperation)return!0;if(n(b)&&n(a))return b.getTime()===a.getTime();if(b instanceof g||b instanceof m)return b.equalityTest(a);
if(b instanceof c&&a instanceof c){var d=void 0,e=void 0;f.isVersion4?(d=b.cache._arcadeCacheId,e=a.cache._arcadeCacheId):(d=b.getCacheValue("_arcadeCacheId"),e=a.getCacheValue("_arcadeCacheId"));if(void 0!==d&&null!==d)return d===e}return void 0!==b&&void 0!==a&&null!==b&&null!==a&&"object"===typeof b&&"object"===typeof a&&b._arcadeCacheId===a._arcadeCacheId&&void 0!==b._arcadeCacheId&&null!==b._arcadeCacheId?!0:!1}function A(c,d){if(s(c))return c;if(null===c)return"";if(b(c))return w(c,d);if(t(c))return c.toString();
if(n(c))return x(c,d);if(c instanceof a)return JSON.stringify(c.toJson());if(v(c)){for(var e=[],g=0;g<c.length;g++)e[g]=F(c[g]);return"["+e.join(",")+"]"}if(c instanceof h){e=[];for(g=0;g<c.length();g++)e[g]=F(c.get(g));return"["+e.join(",")+"]"}return null!==c&&"object"===typeof c&&void 0!==c.castToText?c.castToText():u(c)?"object, Function":""}function B(c,d){if(s(c))return c;if(null===c)return"";if(b(c))return w(c,d);if(t(c))return c.toString();if(n(c))return x(c,d);if(c instanceof a)return JSON.stringify(c.toJson());
if(v(c)){for(var e=[],g=0;g<c.length;g++)e[g]=F(c[g]);return"["+e.join(",")+"]"}if(c instanceof h){e=[];for(g=0;g<c.length();g++)e[g]=F(c.get(g));return"["+e.join(",")+"]"}return null!==c&&"object"===typeof c&&void 0!==c.castToText?c.castToText():u(c)?"object, Function":""}function F(c){if(null!==c){if(t(c)||b(c)||s(c))return JSON.stringify(c);if(c instanceof a||c instanceof h||c instanceof Array)return B(c);if(c instanceof Date)return JSON.stringify(c);if(null!==c&&"object"===typeof c&&void 0!==
c.castToText)return c.castToText()}return"null"}function E(c,a){return b(c)?c:null===c||""===c?0:n(c)?NaN:t(c)?c?1:0:""===c||void 0===c?NaN:void 0!==a&&s(c)?(a=r(a,"\u2030",""),a=r(a,"\u00a4",""),k.parse(c,{pattern:a})):c===f.voidOperation?0:Number(c)}function H(b,c){var a;e.some(c.fields,function(c){c.name===b&&(a=c.domain);return!!a});return a}p=function(){return function(b){this.value=b}}();var I=function(){return function(b){this.value=b}}(),M=function(){return function(b){this.fn=b}}();f.NativeFunction=
M;f.ImplicitResult=I;f.ReturnResult=p;f.isVersion4=0===q.version.indexOf("4.");f.voidOperation={type:"VOID"};f.breakResult={type:"BREAK"};f.continueResult={type:"CONTINUE"};f.multiReplace=r;f.isFunctionParameter=u;f.isSimpleType=function(c){return s(c)||b(c)||n(c)||t(c)||null===c||c===f.voidOperation||"number"===typeof c?!0:!1};f.defaultUndefined=function(b,c){return void 0===b?c:b};f.isString=s;f.isBoolean=t;f.isNumber=b;f.isArray=v;f.isImmutableArray=function(b){return b instanceof h};f.isDate=
n;f.pcCheck=function(b,c,a){if(b.length<c||b.length>a)throw Error("Function called with wrong number of Parameters");};f.generateUUID=function(){var b=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var a=(b+16*Math.random())%16|0;b=Math.floor(b/16);return("x"===c?a:a&3|8).toString(16)})};f.formatNumber=w;f.formatDate=x;f.greaterThanLessThan=function(c,a,d){if(null===c){if(null===a||a===f.voidOperation)return z(null,null,d);if(b(a))return z(0,a,d);if(s(a)||
t(a))return z(0,E(a),d);if(n(a))return z(0,a.getTime(),d)}if(c===f.voidOperation){if(null===a||a===f.voidOperation)return z(null,null,d);if(b(a))return z(0,a,d);if(s(a)||t(a))return z(0,E(a),d);if(n(a))return z(0,a.getTime(),d)}else if(b(c)){if(b(a))return z(c,a,d);if(t(a))return z(c,E(a),d);if(null===a||a===f.voidOperation)return z(c,0,d);if(s(a))return z(c,E(a),d);if(n(a))return z(c,a.getTime(),d)}else if(s(c)){if(s(a))return z(A(c),A(a),d);if(n(a))return z(E(c),a.getTime(),d);if(b(a))return z(E(c),
a,d);if(null===a||a===f.voidOperation)return z(E(c),0,d);if(t(a))return z(E(c),E(a),d)}else if(n(c)){if(n(a))return z(c,a,d);if(null===a||a===f.voidOperation)return z(c.getTime(),0,d);if(b(a))return z(c.getTime(),a,d);if(t(a)||s(a))return z(c.getTime(),E(a),d)}else if(t(c)){if(t(a))return z(c,a,d);if(b(a))return z(E(c),E(a),d);if(n(a))return z(E(c),a.getTime(),d);if(null===a||a===f.voidOperation)return z(E(c),0,d);if(s(a))return z(E(c),E(a),d)}return y(c,a)&&("\x3c\x3d"===d||"\x3e\x3d"===d)?!0:!1};
f.equalityTest=y;f.toString=A;f.toNumberArray=function(b){var c=[];if(!1===v(b))return null;if(b instanceof h){for(var a=0;a<b.length();a++)c[a]=E(b.get(a));return c}for(a=0;a<b.length;a++)c[a]=E(b[a]);return c};f.toStringExplicit=B;f.toNumber=E;f.toDate=function(b,c){if(n(b))return b;if(s(b)){var a=l(b,[void 0===c||null===c||""===c?l.ISO_8601:c]);if(a.isValid())return a.toDate()}return null};f.toDateM=function(b,c){if(n(b))return l(b);if(s(b)){var a=l(b,[void 0===c||null===c||""===c?l.ISO_8601:c]);
if(a.isValid())return a}return null};f.toBoolean=function(c){if(t(c))return c;if(s(c)){if(c=c.toLowerCase(),"true"===c)return!0}else if(b(c))return 0===c||isNaN(c)?!1:!0;return!1};f.fixSpatialReference=function(b,c){if(null===b)return null;if(null===b.spatialReference||void 0===b.spatialReference)b.spatialReference=c;return b};f.getDomainValue=function(b,c){if(!b||!b.domain)return null;var a=null;c="esriFieldTypeString"===b.field.type?A(c):E(c);for(var d=0;d<b.domain.codedValues.length;d++){var e=
b.domain.codedValues[d];e.code===c&&(a=e)}return null===a?null:a.name};f.getDomainCode=function(b,c){if(!b||!b.domain)return null;var a=null;c=A(c);for(var d=0;d<b.domain.codedValues.length;d++){var e=b.domain.codedValues[d];e.name===c&&(a=e)}return null===a?null:a.code};f.getDomain=function(b,c,a,d){void 0===a&&(a=null);if(!c||!c.fields)return null;for(var g=null,n=0;n<c.fields.length;n++){var f=c.fields[n];f.name.toLowerCase()===b.toString().toLowerCase()&&(g=f)}if(null===g)return null;var h,r;
d||(d=a&&c.typeIdField&&a._field(c.typeIdField));null!=d&&e.some(c.types,function(b){if(b.id===d){if((h=b.domains&&b.domains[g.name])&&"inherited"===h.type)h=H(g.name,c),r=!0;return!0}return!1},this);!r&&!h&&(h=H(b,c));return{field:g,domain:h}}})},"esri/moment":function(){define(["require","exports","./plugins/moment!"],function(p,f,a){return a})},"esri/plugins/moment":function(){define(["require","exports","dojo/_base/kernel","moment/moment"],function(p,f,a,l){var k={ar:1,"ar-ma":1,"ar-sa":1,"ar-tn":1,
cs:1,da:1,de:1,"de-at":1,el:1,"en-au":1,"en-ca":1,"en-gb":1,"en-ie":1,"en-nz":1,es:1,et:1,fi:1,fr:1,"fr-ca":1,"fr-ch":1,he:1,hr:1,it:1,ja:1,ko:1,lt:1,lv:1,nb:1,nl:1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,sr:1,"sr-cyrl":1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-tw":1};f.load=function(f,q,m){f=a.locale;"zh-hk"===f&&(f="zh-tw");var g=f in k;if(!g){var e=f.split("-");1<e.length&&e[0]in k&&(f=e[0],g=!0)}g?q(["moment/locale/"+f],function(){m(l)}):m(l)}})},"moment/moment":function(){(function(p,f){"object"===typeof exports&&
"undefined"!==typeof module?module.exports=f():"function"===typeof define&&define.amd?define(f):p.moment=f()})(this,function(){function p(){return Fb.apply(null,arguments)}function f(b){return b instanceof Array||"[object Array]"===Object.prototype.toString.call(b)}function a(b){return b instanceof Date||"[object Date]"===Object.prototype.toString.call(b)}function l(b,c){var a=[],d;for(d=0;d<b.length;++d)a.push(c(b[d],d));return a}function k(b,c){return Object.prototype.hasOwnProperty.call(b,c)}function h(b,
c){for(var a in c)k(c,a)&&(b[a]=c[a]);k(c,"toString")&&(b.toString=c.toString);k(c,"valueOf")&&(b.valueOf=c.valueOf);return b}function q(b,c,a,d){return Oa(b,c,a,d,!0).utc()}function m(b){null==b._pf&&(b._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1});return b._pf}function g(b){if(null==b._isValid){var c=m(b);b._isValid=!isNaN(b._d.getTime())&&0>c.overflow&&!c.empty&&!c.invalidMonth&&!c.invalidWeekday&&
!c.nullInput&&!c.invalidFormat&&!c.userInvalidated;b._strict&&(b._isValid=b._isValid&&0===c.charsLeftOver&&0===c.unusedTokens.length&&void 0===c.bigHour)}return b._isValid}function e(b){var c=q(NaN);null!=b?h(m(c),b):m(c).userInvalidated=!0;return c}function c(b){return void 0===b}function d(b,a){var d,e,g;c(a._isAMomentObject)||(b._isAMomentObject=a._isAMomentObject);c(a._i)||(b._i=a._i);c(a._f)||(b._f=a._f);c(a._l)||(b._l=a._l);c(a._strict)||(b._strict=a._strict);c(a._tzm)||(b._tzm=a._tzm);c(a._isUTC)||
(b._isUTC=a._isUTC);c(a._offset)||(b._offset=a._offset);c(a._pf)||(b._pf=m(a));c(a._locale)||(b._locale=a._locale);if(0<yb.length)for(d in yb)e=yb[d],g=a[e],c(g)||(b[e]=g);return b}function r(b){d(this,b);this._d=new Date(null!=b._d?b._d.getTime():NaN);!1===ob&&(ob=!0,p.updateOffset(this),ob=!1)}function u(b){return b instanceof r||null!=b&&null!=b._isAMomentObject}function s(b){return 0>b?Math.ceil(b):Math.floor(b)}function t(b){b=+b;var c=0;0!==b&&isFinite(b)&&(c=s(b));return c}function b(b,c,a){var d=
Math.min(b.length,c.length),e=Math.abs(b.length-c.length),g=0,n;for(n=0;n<d;n++)(a&&b[n]!==c[n]||!a&&t(b[n])!==t(c[n]))&&g++;return g+e}function v(b){!1===p.suppressDeprecationWarnings&&("undefined"!==typeof console&&console.warn)&&console.warn("Deprecation warning: "+b)}function n(b,c){var a=!0;return h(function(){a&&(v(b+"\nArguments: "+Array.prototype.slice.call(arguments).join(", ")+"\n"+Error().stack),a=!1);return c.apply(this,arguments)},c)}function w(b,c){Db[b]||(v(c),Db[b]=!0)}function x(b){return b instanceof
Function||"[object Function]"===Object.prototype.toString.call(b)}function z(b,c){var a=h({},b),d;for(d in c)k(c,d)&&("[object Object]"===Object.prototype.toString.call(b[d])&&"[object Object]"===Object.prototype.toString.call(c[d])?(a[d]={},h(a[d],b[d]),h(a[d],c[d])):null!=c[d]?a[d]=c[d]:delete a[d]);return a}function y(b){null!=b&&this.set(b)}function A(b){var c=null;if(!ma[b]&&"undefined"!==typeof module&&module&&module.exports)try{c=rb._abbr,require("./locale/"+b),B(c)}catch(a){}return ma[b]}
function B(b,a){var d;b&&(d=c(a)?E(b):F(b,a))&&(rb=d);return rb._abbr}function F(b,c){if(null!==c)return c.abbr=b,null!=ma[b]?(w("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale"),c=z(ma[b]._config,c)):null!=c.parentLocale&&(null!=ma[c.parentLocale]?c=z(ma[c.parentLocale]._config,c):w("parentLocaleUndefined","specified parentLocale is not defined yet")),ma[b]=new y(c),
B(b),ma[b];delete ma[b];return null}function E(c){var a;c&&(c._locale&&c._locale._abbr)&&(c=c._locale._abbr);if(!c)return rb;if(!f(c)){if(a=A(c))return a;c=[c]}a:{a=0;for(var d,e,g,n;a<c.length;){n=(c[a]?c[a].toLowerCase().replace("_","-"):c[a]).split("-");d=n.length;for(e=(e=c[a+1]?c[a+1].toLowerCase().replace("_","-"):c[a+1])?e.split("-"):null;0<d;){if(g=A(n.slice(0,d).join("-"))){c=g;break a}if(e&&e.length>=d&&b(n,e,!0)>=d-1)break;d--}a++}c=null}return c}function H(b,c){var a=b.toLowerCase();gb[a]=
gb[a+"s"]=gb[c]=b}function I(b){return"string"===typeof b?gb[b]||gb[b.toLowerCase()]:void 0}function M(b){var c={},a,d;for(d in b)k(b,d)&&(a=I(d))&&(c[a]=b[d]);return c}function Q(b,c){return function(a){if(null!=a){if(this.isValid())this._d["set"+(this._isUTC?"UTC":"")+b](a);p.updateOffset(this,c);return this}return K(this,b)}}function K(b,c){return b.isValid()?b._d["get"+(b._isUTC?"UTC":"")+c]():NaN}function J(b,c){var a;if("object"===typeof b)for(a in b)this.set(a,b[a]);else if(b=I(b),x(this[b]))return this[b](c);
return this}function O(b,c,a){var d=""+Math.abs(b);return(0<=b?a?"+":"":"-")+Math.pow(10,Math.max(0,c-d.length)).toString().substr(1)+d}function G(b,c,a,d){var e=d;"string"===typeof d&&(e=function(){return this[d]()});b&&(Ta[b]=e);c&&(Ta[c[0]]=function(){return O(e.apply(this,arguments),c[1],c[2])});a&&(Ta[a]=function(){return this.localeData().ordinal(e.apply(this,arguments),b)})}function T(b){var c=b.match(Cb),a,d;a=0;for(d=c.length;a<d;a++)c[a]=Ta[c[a]]?Ta[c[a]]:c[a].match(/\[[\s\S]/)?c[a].replace(/^\[|\]$/g,
""):c[a].replace(/\\/g,"");return function(e){var g="";for(a=0;a<d;a++)g+=c[a]instanceof Function?c[a].call(e,b):c[a];return g}}function P(b,c){if(!b.isValid())return b.localeData().invalidDate();c=V(c,b.localeData());ib[c]=ib[c]||T(c);return ib[c](b)}function V(b,c){function a(b){return c.longDateFormat(b)||b}var d=5;for(qb.lastIndex=0;0<=d&&qb.test(b);)b=b.replace(qb,a),qb.lastIndex=0,d-=1;return b}function L(b,c,a){kb[b]=x(c)?c:function(b,d){return b&&a?a:c}}function C(b){return X(b.replace("\\",
"").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(b,c,a,d,e){return c||a||d||e}))}function X(b){return b.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$\x26")}function Y(b,c){var a,d=c;"string"===typeof b&&(b=[b]);"number"===typeof c&&(d=function(b,a){a[c]=t(b)});for(a=0;a<b.length;a++)lb[b[a]]=d}function la(b,c){Y(b,function(b,a,d,e){d._w=d._w||{};c(b,d._w,d,e)})}function aa(b,c){return(new Date(Date.UTC(b,c+1,0))).getUTCDate()}function ga(b,c){var a;if(!b.isValid())return b;if("string"===typeof c)if(/^\d+$/.test(c))c=
t(c);else if(c=b.localeData().monthsParse(c),"number"!==typeof c)return b;a=Math.min(b.date(),aa(b.year(),c));b._d["set"+(b._isUTC?"UTC":"")+"Month"](c,a);return b}function qa(b){return null!=b?(ga(this,b),p.updateOffset(this,!0),this):K(this,"Month")}function za(){function b(c,a){return a.length-c.length}var c=[],a=[],d=[],e,g;for(e=0;12>e;e++)g=q([2E3,e]),c.push(this.monthsShort(g,"")),a.push(this.months(g,"")),d.push(this.months(g,"")),d.push(this.monthsShort(g,""));c.sort(b);a.sort(b);d.sort(b);
for(e=0;12>e;e++)c[e]=X(c[e]),a[e]=X(a[e]),d[e]=X(d[e]);this._monthsShortRegex=this._monthsRegex=RegExp("^("+d.join("|")+")","i");this._monthsStrictRegex=RegExp("^("+a.join("|")+")$","i");this._monthsShortStrictRegex=RegExp("^("+c.join("|")+")$","i")}function ia(b){var c;if((c=b._a)&&-2===m(b).overflow){c=0>c[La]||11<c[La]?La:1>c[Ja]||c[Ja]>aa(c[Ha],c[La])?Ja:0>c[Ba]||24<c[Ba]||24===c[Ba]&&(0!==c[Na]||0!==c[Ua]||0!==c[nb])?Ba:0>c[Na]||59<c[Na]?Na:0>c[Ua]||59<c[Ua]?Ua:0>c[nb]||999<c[nb]?nb:-1;if(m(b)._overflowDayOfYear&&
(c<Ha||c>Ja))c=Ja;m(b)._overflowWeeks&&-1===c&&(c=Ob);m(b)._overflowWeekday&&-1===c&&(c=Pb);m(b).overflow=c}return b}function oa(b){var c,a;c=b._i;var d=Qb.exec(c)||Rb.exec(c),e,g,n,f;if(d){m(b).iso=!0;c=0;for(a=Gb.length;c<a;c++)if(Gb[c][1].exec(d[1])){g=Gb[c][0];e=!1!==Gb[c][2];break}if(null==g)b._isValid=!1;else{if(d[3]){c=0;for(a=Ib.length;c<a;c++)if(Ib[c][1].exec(d[3])){n=(d[2]||" ")+Ib[c][0];break}if(null==n){b._isValid=!1;return}}if(!e&&null!=n)b._isValid=!1;else{if(d[4])if(Sb.exec(d[4]))f=
"Z";else{b._isValid=!1;return}b._f=g+(n||"")+(f||"");va(b)}}}else b._isValid=!1}function xa(b){var c=Tb.exec(b._i);null!==c?b._d=new Date(+c[1]):(oa(b),!1===b._isValid&&(delete b._isValid,p.createFromInputFallback(b)))}function sa(b,c,a,d,e,g,n){c=new Date(b,c,a,d,e,g,n);100>b&&(0<=b&&isFinite(c.getFullYear()))&&c.setFullYear(b);return c}function ea(b){var c=new Date(Date.UTC.apply(null,arguments));100>b&&(0<=b&&isFinite(c.getUTCFullYear()))&&c.setUTCFullYear(b);return c}function pa(b){return 0===
b%4&&0!==b%100||0===b%400}function Aa(b,c,a){a=7+c-a;return-((7+ea(b,0,a).getUTCDay()-c)%7)+a-1}function Da(b,c,a,d,e){a=(7+a-d)%7;d=Aa(b,d,e);d=1+7*(c-1)+a+d;0>=d?(c=b-1,b=(pa(c)?366:365)+d):d>(pa(b)?366:365)?(c=b+1,b=d-(pa(b)?366:365)):(c=b,b=d);return{year:c,dayOfYear:b}}function Ea(b,c,a){var d=Aa(b.year(),c,a),d=Math.floor((b.dayOfYear()-d-1)/7)+1;1>d?(b=b.year()-1,c=d+ua(b,c,a)):d>ua(b.year(),c,a)?(c=d-ua(b.year(),c,a),b=b.year()+1):(b=b.year(),c=d);return{week:c,year:b}}function ua(b,c,a){var d=
Aa(b,c,a);c=Aa(b+1,c,a);return((pa(b)?366:365)-d+c)/7}function Ca(b,c,a){return null!=b?b:null!=c?c:a}function ta(b){var c,a=[],d;if(!b._d){d=new Date(p.now());d=b._useUTC?[d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()]:[d.getFullYear(),d.getMonth(),d.getDate()];if(b._w&&null==b._a[Ja]&&null==b._a[La]){var e,g,n,f,h,r;e=b._w;if(null!=e.GG||null!=e.W||null!=e.E){if(h=1,r=4,g=Ca(e.GG,b._a[Ha],Ea(ka(),1,4).year),n=Ca(e.W,1),f=Ca(e.E,1),1>f||7<f)c=!0}else if(h=b._locale._week.dow,r=b._locale._week.doy,
g=Ca(e.gg,b._a[Ha],Ea(ka(),h,r).year),n=Ca(e.w,1),null!=e.d){if(f=e.d,0>f||6<f)c=!0}else if(null!=e.e){if(f=e.e+h,0>e.e||6<e.e)c=!0}else f=h;1>n||n>ua(g,h,r)?m(b)._overflowWeeks=!0:null!=c?m(b)._overflowWeekday=!0:(c=Da(g,n,f,h,r),b._a[Ha]=c.year,b._dayOfYear=c.dayOfYear)}if(b._dayOfYear){c=Ca(b._a[Ha],d[Ha]);if(b._dayOfYear>(pa(c)?366:365))m(b)._overflowDayOfYear=!0;c=ea(c,0,b._dayOfYear);b._a[La]=c.getUTCMonth();b._a[Ja]=c.getUTCDate()}for(c=0;3>c&&null==b._a[c];++c)b._a[c]=a[c]=d[c];for(;7>c;c++)b._a[c]=
a[c]=null==b._a[c]?2===c?1:0:b._a[c];24===b._a[Ba]&&(0===b._a[Na]&&0===b._a[Ua]&&0===b._a[nb])&&(b._nextDay=!0,b._a[Ba]=0);b._d=(b._useUTC?ea:sa).apply(null,a);null!=b._tzm&&b._d.setUTCMinutes(b._d.getUTCMinutes()-b._tzm);b._nextDay&&(b._a[Ba]=24)}}function va(b){if(b._f===p.ISO_8601)oa(b);else{b._a=[];m(b).empty=!0;var c=""+b._i,a,d,e,g,n,f=c.length,h=0;e=V(b._f,b._locale).match(Cb)||[];for(a=0;a<e.length;a++){g=e[a];if(d=(c.match(!k(kb,g)?RegExp(C(g)):kb[g](b._strict,b._locale))||[])[0])n=c.substr(0,
c.indexOf(d)),0<n.length&&m(b).unusedInput.push(n),c=c.slice(c.indexOf(d)+d.length),h+=d.length;if(Ta[g]){if(d?m(b).empty=!1:m(b).unusedTokens.push(g),n=b,null!=d&&k(lb,g))lb[g](d,n._a,n,g)}else b._strict&&!d&&m(b).unusedTokens.push(g)}m(b).charsLeftOver=f-h;0<c.length&&m(b).unusedInput.push(c);!0===m(b).bigHour&&(12>=b._a[Ba]&&0<b._a[Ba])&&(m(b).bigHour=void 0);c=b._a;a=Ba;f=b._locale;e=b._a[Ba];h=b._meridiem;null!=h&&(null!=f.meridiemHour?e=f.meridiemHour(e,h):null!=f.isPM&&((f=f.isPM(h))&&12>e&&
(e+=12),!f&&12===e&&(e=0)));c[a]=e;ta(b);ia(b)}}function Ka(b){if(!b._d){var c=M(b._i);b._a=l([c.year,c.month,c.day||c.date,c.hour,c.minute,c.second,c.millisecond],function(b){return b&&parseInt(b,10)});ta(b)}}function Pa(b){var c=b._i,n=b._f;b._locale=b._locale||E(b._l);if(null===c||void 0===n&&""===c)return e({nullInput:!0});"string"===typeof c&&(b._i=c=b._locale.preparse(c));if(u(c))return new r(ia(c));if(f(n)){var t,k,s;if(0===b._f.length)m(b).invalidFormat=!0,b._d=new Date(NaN);else{for(c=0;c<
b._f.length;c++)if(n=0,t=d({},b),null!=b._useUTC&&(t._useUTC=b._useUTC),t._f=b._f[c],va(t),g(t)&&(n+=m(t).charsLeftOver,n+=10*m(t).unusedTokens.length,m(t).score=n,null==s||n<s))s=n,k=t;h(b,k||t)}}else n?va(b):a(c)?b._d=c:Za(b);g(b)||(b._d=null);return b}function Za(b){var c=b._i;void 0===c?b._d=new Date(p.now()):a(c)?b._d=new Date(+c):"string"===typeof c?xa(b):f(c)?(b._a=l(c.slice(0),function(b){return parseInt(b,10)}),ta(b)):"object"===typeof c?Ka(b):"number"===typeof c?b._d=new Date(c):p.createFromInputFallback(b)}
function Oa(b,c,a,d,e){var g={};"boolean"===typeof a&&(d=a,a=void 0);g._isAMomentObject=!0;g._useUTC=g._isUTC=e;g._l=a;g._i=b;g._f=c;g._strict=d;b=new r(ia(Pa(g)));b._nextDay&&(b.add(1,"d"),b._nextDay=void 0);return b}function ka(b,c,a,d){return Oa(b,c,a,d,!1)}function $a(b,c){var a,d;1===c.length&&f(c[0])&&(c=c[0]);if(!c.length)return ka();a=c[0];for(d=1;d<c.length;++d)if(!c[d].isValid()||c[d][b](a))a=c[d];return a}function Qa(b){b=M(b);var c=b.year||0,a=b.quarter||0,d=b.month||0,e=b.week||0,g=b.day||
0;this._milliseconds=+(b.millisecond||0)+1E3*(b.second||0)+6E4*(b.minute||0)+36E5*(b.hour||0);this._days=+g+7*e;this._months=+d+3*a+12*c;this._data={};this._locale=E();this._bubble()}function Va(b){return b instanceof Qa}function Wa(b,c){G(b,0,0,function(){var b=this.utcOffset(),a="+";0>b&&(b=-b,a="-");return a+O(~~(b/60),2)+c+O(~~b%60,2)})}function Ia(b,c){var a=(c||"").match(b)||[],a=((a[a.length-1]||[])+"").match(Wb)||["-",0,0],d=+(60*a[1])+t(a[2]);return"+"===a[0]?d:-d}function R(b,c){var d,e;
return c._isUTC?(d=c.clone(),e=(u(b)||a(b)?+b:+ka(b))-+d,d._d.setTime(+d._d+e),p.updateOffset(d,!1),d):ka(b).local()}function ya(){return this.isValid()?this._isUTC&&0===this._offset:!1}function Fa(b,c){var a=b,d=null;if(Va(b))a={ms:b._milliseconds,d:b._days,M:b._months};else if("number"===typeof b)a={},c?a[c]=b:a.milliseconds=b;else if(d=Xb.exec(b))a="-"===d[1]?-1:1,a={y:0,d:t(d[Ja])*a,h:t(d[Ba])*a,m:t(d[Na])*a,s:t(d[Ua])*a,ms:t(d[nb])*a};else if(d=Yb.exec(b))a="-"===d[1]?-1:1,a={y:$(d[2],a),M:$(d[3],
a),w:$(d[4],a),d:$(d[5],a),h:$(d[6],a),m:$(d[7],a),s:$(d[8],a)};else if(null==a)a={};else if("object"===typeof a&&("from"in a||"to"in a))d=ka(a.from),a=ka(a.to),!d.isValid()||!a.isValid()?d={milliseconds:0,months:0}:(a=R(a,d),d.isBefore(a)?a=Sa(d,a):(a=Sa(a,d),a.milliseconds=-a.milliseconds,a.months=-a.months),d=a),a={},a.ms=d.milliseconds,a.M=d.months;a=new Qa(a);Va(b)&&k(b,"_locale")&&(a._locale=b._locale);return a}function $(b,c){var a=b&&parseFloat(b.replace(",","."));return(isNaN(a)?0:a)*c}function Sa(b,
c){var a={milliseconds:0,months:0};a.months=c.month()-b.month()+12*(c.year()-b.year());b.clone().add(a.months,"M").isAfter(c)&&--a.months;a.milliseconds=+c-+b.clone().add(a.months,"M");return a}function Ma(b,c){return function(a,d){var e;null!==d&&!isNaN(+d)&&(w(c,"moment()."+c+"(period, number) is deprecated. Please use moment()."+c+"(number, period)."),e=a,a=d,d=e);e=Fa("string"===typeof a?+a:a,d);ca(this,e,b);return this}}function ca(b,c,a,d){var e=c._milliseconds,g=0>c._days?-1*Math.round(-1*
c._days):Math.round(c._days);c=0>c._months?-1*Math.round(-1*c._months):Math.round(c._months);if(b.isValid()){d=null==d?!0:d;e&&b._d.setTime(+b._d+e*a);if(g&&(e=K(b,"Date")+g*a,b.isValid()))b._d["set"+(b._isUTC?"UTC":"")+"Date"](e);c&&ga(b,K(b,"Month")+c*a);d&&p.updateOffset(b,g||c)}}function wa(b){if(void 0===b)return this._locale._abbr;b=E(b);null!=b&&(this._locale=b);return this}function S(){return this._locale}function fa(b,c){G(0,[b,b.length],0,c)}function D(b,c,a,d,e){var g;if(null==b)return Ea(this,
d,e).year;g=ua(b,d,e);c>g&&(c=g);b=Da(b,c,a,d,e);b=ea(b.year,0,b.dayOfYear);this.year(b.getUTCFullYear());this.month(b.getUTCMonth());this.date(b.getUTCDate());return this}function ba(){return this.hours()%12||12}function da(b,c){G(b,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),c)})}function ja(b,c){return c._meridiemParse}function W(b,c){c[nb]=t(1E3*("0."+b))}function Z(b){return b}function N(b,c,a,d){var e=E();c=q().set(d,c);return e[a](c,b)}function hb(b,c,a,d,e){"number"===
typeof b&&(c=b,b=void 0);b=b||"";if(null!=c)return N(b,c,a,e);var g=[];for(c=0;c<d;c++)g[c]=N(b,c,a,e);return g}function Eb(b,c,a,d){c=Fa(c,a);b._milliseconds+=d*c._milliseconds;b._days+=d*c._days;b._months+=d*c._months;return b._bubble()}function Ra(b){return function(){return this.as(b)}}function Xa(b){return function(){return this._data[b]}}function Hb(b,c,a,d,e){return e.relativeTime(c||1,!!a,b,d)}function pb(){var b=Jb(this._milliseconds)/1E3,c=Jb(this._days),a=Jb(this._months),d,e,g;d=s(b/60);
e=s(d/60);b%=60;d%=60;g=s(a/12);var a=a%12,n=this.asSeconds();return!n?"P0D":(0>n?"-":"")+"P"+(g?g+"Y":"")+(a?a+"M":"")+(c?c+"D":"")+(e||d||b?"T":"")+(e?e+"H":"")+(d?d+"M":"")+(b?b+"S":"")}var Fb,yb=p.momentProperties=[],ob=!1,Db={};p.suppressDeprecationWarnings=!1;var ma={},rb,gb={},Cb=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,qb=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,
ib={},Ta={},sb=/\d/,Ga=/\d\d/,tb=/\d{3}/,ub=/\d{4}/,ab=/[+-]?\d{6}/,ra=/\d\d?/,vb=/\d\d\d\d?/,wb=/\d\d\d\d\d\d?/,bb=/\d{1,3}/,xb=/\d{1,4}/,cb=/[+-]?\d{1,6}/,zb=/\d+/,db=/[+-]?\d+/,Ab=/Z|[+-]\d\d:?\d\d/gi,jb=/Z|[+-]\d\d(?::?\d\d)?/gi,eb=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,kb={},lb={},Ha=0,La=1,Ja=2,Ba=3,Na=4,Ua=5,nb=6,Ob=7,Pb=8;G("M",["MM",2],"Mo",function(){return this.month()+1});G("MMM",0,0,function(b){return this.localeData().monthsShort(this,
b)});G("MMMM",0,0,function(b){return this.localeData().months(this,b)});H("month","M");L("M",ra);L("MM",ra,Ga);L("MMM",function(b,c){return c.monthsShortRegex(b)});L("MMMM",function(b,c){return c.monthsRegex(b)});Y(["M","MM"],function(b,c){c[La]=t(b)-1});Y(["MMM","MMMM"],function(b,c,a,d){d=a._locale.monthsParse(b,d,a._strict);null!=d?c[La]=d:m(a).invalidMonth=b});var Kb=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/,Qb=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,
Rb=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,Sb=/Z|[+-]\d\d(?::?\d\d)?/,Gb=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Ib=
[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Tb=/^\/?Date\((\-?\d+)/i;p.createFromInputFallback=n("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",
function(b){b._d=new Date(b._i+(b._useUTC?" UTC":""))});G("Y",0,0,function(){var b=this.year();return 9999>=b?""+b:"+"+b});G(0,["YY",2],0,function(){return this.year()%100});G(0,["YYYY",4],0,"year");G(0,["YYYYY",5],0,"year");G(0,["YYYYYY",6,!0],0,"year");H("year","y");L("Y",db);L("YY",ra,Ga);L("YYYY",xb,ub);L("YYYYY",cb,ab);L("YYYYYY",cb,ab);Y(["YYYYY","YYYYYY"],Ha);Y("YYYY",function(b,c){c[Ha]=2===b.length?p.parseTwoDigitYear(b):t(b)});Y("YY",function(b,c){c[Ha]=p.parseTwoDigitYear(b)});Y("Y",function(b,
c){c[Ha]=parseInt(b,10)});p.parseTwoDigitYear=function(b){return t(b)+(68<t(b)?1900:2E3)};var Lb=Q("FullYear",!1);p.ISO_8601=function(){};var Ub=n("moment().min is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var b=ka.apply(null,arguments);return this.isValid()&&b.isValid()?b<this?this:b:e()}),Vb=n("moment().max is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var b=ka.apply(null,arguments);return this.isValid()&&
b.isValid()?b>this?this:b:e()});Wa("Z",":");Wa("ZZ","");L("Z",jb);L("ZZ",jb);Y(["Z","ZZ"],function(b,c,a){a._useUTC=!0;a._tzm=Ia(jb,b)});var Wb=/([\+\-]|\d\d)/gi;p.updateOffset=function(){};var Xb=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?\d*)?$/,Yb=/^(-)?P(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)W)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?$/;Fa.fn=Qa.prototype;var $b=Ma(1,"add"),cc=Ma(-1,"subtract");p.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var Mb=n("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",
function(b){return void 0===b?this.localeData():this.locale(b)});G(0,["gg",2],0,function(){return this.weekYear()%100});G(0,["GG",2],0,function(){return this.isoWeekYear()%100});fa("gggg","weekYear");fa("ggggg","weekYear");fa("GGGG","isoWeekYear");fa("GGGGG","isoWeekYear");H("weekYear","gg");H("isoWeekYear","GG");L("G",db);L("g",db);L("GG",ra,Ga);L("gg",ra,Ga);L("GGGG",xb,ub);L("gggg",xb,ub);L("GGGGG",cb,ab);L("ggggg",cb,ab);la(["gggg","ggggg","GGGG","GGGGG"],function(b,c,a,d){c[d.substr(0,2)]=t(b)});
la(["gg","GG"],function(b,c,a,d){c[d]=p.parseTwoDigitYear(b)});G("Q",0,"Qo","quarter");H("quarter","Q");L("Q",sb);Y("Q",function(b,c){c[La]=3*(t(b)-1)});G("w",["ww",2],"wo","week");G("W",["WW",2],"Wo","isoWeek");H("week","w");H("isoWeek","W");L("w",ra);L("ww",ra,Ga);L("W",ra);L("WW",ra,Ga);la(["w","ww","W","WW"],function(b,c,a,d){c[d.substr(0,1)]=t(b)});G("D",["DD",2],"Do","date");H("date","D");L("D",ra);L("DD",ra,Ga);L("Do",function(b,c){return b?c._ordinalParse:c._ordinalParseLenient});Y(["D","DD"],
Ja);Y("Do",function(b,c){c[Ja]=t(b.match(ra)[0],10)});var Nb=Q("Date",!0);G("d",0,"do","day");G("dd",0,0,function(b){return this.localeData().weekdaysMin(this,b)});G("ddd",0,0,function(b){return this.localeData().weekdaysShort(this,b)});G("dddd",0,0,function(b){return this.localeData().weekdays(this,b)});G("e",0,0,"weekday");G("E",0,0,"isoWeekday");H("day","d");H("weekday","e");H("isoWeekday","E");L("d",ra);L("e",ra);L("E",ra);L("dd",eb);L("ddd",eb);L("dddd",eb);la(["dd","ddd","dddd"],function(b,
c,a,d){d=a._locale.weekdaysParse(b,d,a._strict);null!=d?c.d=d:m(a).invalidWeekday=b});la(["d","e","E"],function(b,c,a,d){c[d]=t(b)});G("DDD",["DDDD",3],"DDDo","dayOfYear");H("dayOfYear","DDD");L("DDD",bb);L("DDDD",tb);Y(["DDD","DDDD"],function(b,c,a){a._dayOfYear=t(b)});G("H",["HH",2],0,"hour");G("h",["hh",2],0,ba);G("hmm",0,0,function(){return""+ba.apply(this)+O(this.minutes(),2)});G("hmmss",0,0,function(){return""+ba.apply(this)+O(this.minutes(),2)+O(this.seconds(),2)});G("Hmm",0,0,function(){return""+
this.hours()+O(this.minutes(),2)});G("Hmmss",0,0,function(){return""+this.hours()+O(this.minutes(),2)+O(this.seconds(),2)});da("a",!0);da("A",!1);H("hour","h");L("a",ja);L("A",ja);L("H",ra);L("h",ra);L("HH",ra,Ga);L("hh",ra,Ga);L("hmm",vb);L("hmmss",wb);L("Hmm",vb);L("Hmmss",wb);Y(["H","HH"],Ba);Y(["a","A"],function(b,c,a){a._isPm=a._locale.isPM(b);a._meridiem=b});Y(["h","hh"],function(b,c,a){c[Ba]=t(b);m(a).bigHour=!0});Y("hmm",function(b,c,a){var d=b.length-2;c[Ba]=t(b.substr(0,d));c[Na]=t(b.substr(d));
m(a).bigHour=!0});Y("hmmss",function(b,c,a){var d=b.length-4,e=b.length-2;c[Ba]=t(b.substr(0,d));c[Na]=t(b.substr(d,2));c[Ua]=t(b.substr(e));m(a).bigHour=!0});Y("Hmm",function(b,c,a){a=b.length-2;c[Ba]=t(b.substr(0,a));c[Na]=t(b.substr(a))});Y("Hmmss",function(b,c,a){a=b.length-4;var d=b.length-2;c[Ba]=t(b.substr(0,a));c[Na]=t(b.substr(a,2));c[Ua]=t(b.substr(d))});var Zb=Q("Hours",!0);G("m",["mm",2],0,"minute");H("minute","m");L("m",ra);L("mm",ra,Ga);Y(["m","mm"],Na);var ac=Q("Minutes",!1);G("s",
["ss",2],0,"second");H("second","s");L("s",ra);L("ss",ra,Ga);Y(["s","ss"],Ua);var bc=Q("Seconds",!1);G("S",0,0,function(){return~~(this.millisecond()/100)});G(0,["SS",2],0,function(){return~~(this.millisecond()/10)});G(0,["SSS",3],0,"millisecond");G(0,["SSSS",4],0,function(){return 10*this.millisecond()});G(0,["SSSSS",5],0,function(){return 100*this.millisecond()});G(0,["SSSSSS",6],0,function(){return 1E3*this.millisecond()});G(0,["SSSSSSS",7],0,function(){return 1E4*this.millisecond()});G(0,["SSSSSSSS",
8],0,function(){return 1E5*this.millisecond()});G(0,["SSSSSSSSS",9],0,function(){return 1E6*this.millisecond()});H("millisecond","ms");L("S",bb,sb);L("SS",bb,Ga);L("SSS",bb,tb);var Ya;for(Ya="SSSS";9>=Ya.length;Ya+="S")L(Ya,zb);for(Ya="S";9>=Ya.length;Ya+="S")Y(Ya,W);var dc=Q("Milliseconds",!1);G("z",0,0,"zoneAbbr");G("zz",0,0,"zoneName");var U=r.prototype;U.add=$b;U.calendar=function(b,c){var a=b||ka(),d=R(a,this).startOf("day"),d=this.diff(d,"days",!0),d=-6>d?"sameElse":-1>d?"lastWeek":0>d?"lastDay":
1>d?"sameDay":2>d?"nextDay":7>d?"nextWeek":"sameElse",e=c&&(x(c[d])?c[d]():c[d]);return this.format(e||this.localeData().calendar(d,this,ka(a)))};U.clone=function(){return new r(this)};U.diff=function(b,c,a){var d;if(!this.isValid())return NaN;b=R(b,this);if(!b.isValid())return NaN;d=6E4*(b.utcOffset()-this.utcOffset());c=I(c);if("year"===c||"month"===c||"quarter"===c){d=12*(b.year()-this.year())+(b.month()-this.month());var e=this.clone().add(d,"months"),g;0>b-e?(g=this.clone().add(d-1,"months"),
b=(b-e)/(e-g)):(g=this.clone().add(d+1,"months"),b=(b-e)/(g-e));b=-(d+b);"quarter"===c?b/=3:"year"===c&&(b/=12)}else b=this-b,b="second"===c?b/1E3:"minute"===c?b/6E4:"hour"===c?b/36E5:"day"===c?(b-d)/864E5:"week"===c?(b-d)/6048E5:b;return a?b:s(b)};U.endOf=function(b){b=I(b);return void 0===b||"millisecond"===b?this:this.startOf(b).add(1,"isoWeek"===b?"week":b).subtract(1,"ms")};U.format=function(b){b=P(this,b||p.defaultFormat);return this.localeData().postformat(b)};U.from=function(b,c){return this.isValid()&&
(u(b)&&b.isValid()||ka(b).isValid())?Fa({to:this,from:b}).locale(this.locale()).humanize(!c):this.localeData().invalidDate()};U.fromNow=function(b){return this.from(ka(),b)};U.to=function(b,c){return this.isValid()&&(u(b)&&b.isValid()||ka(b).isValid())?Fa({from:this,to:b}).locale(this.locale()).humanize(!c):this.localeData().invalidDate()};U.toNow=function(b){return this.to(ka(),b)};U.get=J;U.invalidAt=function(){return m(this).overflow};U.isAfter=function(b,a){var d=u(b)?b:ka(b);if(!this.isValid()||
!d.isValid())return!1;a=I(!c(a)?a:"millisecond");return"millisecond"===a?+this>+d:+d<+this.clone().startOf(a)};U.isBefore=function(b,a){var d=u(b)?b:ka(b);if(!this.isValid()||!d.isValid())return!1;a=I(!c(a)?a:"millisecond");return"millisecond"===a?+this<+d:+this.clone().endOf(a)<+d};U.isBetween=function(b,c,a){return this.isAfter(b,a)&&this.isBefore(c,a)};U.isSame=function(b,c){var a=u(b)?b:ka(b);if(!this.isValid()||!a.isValid())return!1;c=I(c||"millisecond");if("millisecond"===c)return+this===+a;
a=+a;return+this.clone().startOf(c)<=a&&a<=+this.clone().endOf(c)};U.isSameOrAfter=function(b,c){return this.isSame(b,c)||this.isAfter(b,c)};U.isSameOrBefore=function(b,c){return this.isSame(b,c)||this.isBefore(b,c)};U.isValid=function(){return g(this)};U.lang=Mb;U.locale=wa;U.localeData=S;U.max=Vb;U.min=Ub;U.parsingFlags=function(){return h({},m(this))};U.set=J;U.startOf=function(b){b=I(b);switch(b){case "year":this.month(0);case "quarter":case "month":this.date(1);case "week":case "isoWeek":case "day":this.hours(0);
case "hour":this.minutes(0);case "minute":this.seconds(0);case "second":this.milliseconds(0)}"week"===b&&this.weekday(0);"isoWeek"===b&&this.isoWeekday(1);"quarter"===b&&this.month(3*Math.floor(this.month()/3));return this};U.subtract=cc;U.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]};U.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),
milliseconds:this.milliseconds()}};U.toDate=function(){return this._offset?new Date(+this):this._d};U.toISOString=function(){var b=this.clone().utc();return 0<b.year()&&9999>=b.year()?x(Date.prototype.toISOString)?this.toDate().toISOString():P(b,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):P(b,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")};U.toJSON=function(){return this.isValid()?this.toISOString():null};U.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")};U.unix=function(){return Math.floor(+this/
1E3)};U.valueOf=function(){return+this._d-6E4*(this._offset||0)};U.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}};U.year=Lb;U.isLeapYear=function(){return pa(this.year())};U.weekYear=function(b){return D.call(this,b,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)};U.isoWeekYear=function(b){return D.call(this,b,this.isoWeek(),this.isoWeekday(),1,4)};U.quarter=U.quarters=function(b){return null==
b?Math.ceil((this.month()+1)/3):this.month(3*(b-1)+this.month()%3)};U.month=qa;U.daysInMonth=function(){return aa(this.year(),this.month())};U.week=U.weeks=function(b){var c=this.localeData().week(this);return null==b?c:this.add(7*(b-c),"d")};U.isoWeek=U.isoWeeks=function(b){var c=Ea(this,1,4).week;return null==b?c:this.add(7*(b-c),"d")};U.weeksInYear=function(){var b=this.localeData()._week;return ua(this.year(),b.dow,b.doy)};U.isoWeeksInYear=function(){return ua(this.year(),1,4)};U.date=Nb;U.day=
U.days=function(b){if(!this.isValid())return null!=b?this:NaN;var c=this._isUTC?this._d.getUTCDay():this._d.getDay();if(null!=b){var a=this.localeData();"string"===typeof b&&(isNaN(b)?(b=a.weekdaysParse(b),b="number"===typeof b?b:null):b=parseInt(b,10));return this.add(b-c,"d")}return c};U.weekday=function(b){if(!this.isValid())return null!=b?this:NaN;var c=(this.day()+7-this.localeData()._week.dow)%7;return null==b?c:this.add(b-c,"d")};U.isoWeekday=function(b){return!this.isValid()?null!=b?this:
NaN:null==b?this.day()||7:this.day(this.day()%7?b:b-7)};U.dayOfYear=function(b){var c=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864E5)+1;return null==b?c:this.add(b-c,"d")};U.hour=U.hours=Zb;U.minute=U.minutes=ac;U.second=U.seconds=bc;U.millisecond=U.milliseconds=dc;U.utcOffset=function(b,c){var a=this._offset||0,d;return!this.isValid()?null!=b?this:NaN:null!=b?("string"===typeof b?b=Ia(jb,b):16>Math.abs(b)&&(b*=60),!this._isUTC&&c&&(d=15*-Math.round(this._d.getTimezoneOffset()/
15)),this._offset=b,this._isUTC=!0,null!=d&&this.add(d,"m"),a!==b&&(!c||this._changeInProgress?ca(this,Fa(b-a,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,p.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?a:15*-Math.round(this._d.getTimezoneOffset()/15)};U.utc=function(b){return this.utcOffset(0,b)};U.local=function(b){this._isUTC&&(this.utcOffset(0,b),this._isUTC=!1,b&&this.subtract(15*-Math.round(this._d.getTimezoneOffset()/15),"m"));return this};U.parseZone=
function(){this._tzm?this.utcOffset(this._tzm):"string"===typeof this._i&&this.utcOffset(Ia(Ab,this._i));return this};U.hasAlignedHourOffset=function(b){if(!this.isValid())return!1;b=b?ka(b).utcOffset():0;return 0===(this.utcOffset()-b)%60};U.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()};U.isDSTShifted=function(){if(!c(this._isDSTShifted))return this._isDSTShifted;var a={};d(a,this);a=Pa(a);if(a._a){var e=a._isUTC?q(a._a):
ka(a._a);this._isDSTShifted=this.isValid()&&0<b(a._a,e.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted};U.isLocal=function(){return this.isValid()?!this._isUTC:!1};U.isUtcOffset=function(){return this.isValid()?this._isUTC:!1};U.isUtc=ya;U.isUTC=ya;U.zoneAbbr=function(){return this._isUTC?"UTC":""};U.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""};U.dates=n("dates accessor is deprecated. Use date instead.",Nb);U.months=n("months accessor is deprecated. Use month instead",
qa);U.years=n("years accessor is deprecated. Use year instead",Lb);U.zone=n("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",function(b,c){return null!=b?("string"!==typeof b&&(b=-b),this.utcOffset(b,c),this):-this.utcOffset()});var ha=y.prototype;ha._calendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};ha.calendar=function(b,c,a){b=this._calendar[b];
return x(b)?b.call(c,a):b};ha._longDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};ha.longDateFormat=function(b){var c=this._longDateFormat[b],a=this._longDateFormat[b.toUpperCase()];if(c||!a)return c;this._longDateFormat[b]=a.replace(/MMMM|MM|DD|dddd/g,function(b){return b.slice(1)});return this._longDateFormat[b]};ha._invalidDate="Invalid date";ha.invalidDate=function(){return this._invalidDate};ha._ordinal="%d";
ha.ordinal=function(b){return this._ordinal.replace("%d",b)};ha._ordinalParse=/\d{1,2}/;ha.preparse=Z;ha.postformat=Z;ha._relativeTime={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};ha.relativeTime=function(b,c,a,d){var e=this._relativeTime[a];return x(e)?e(b,c,a,d):e.replace(/%d/i,b)};ha.pastFuture=function(b,c){var a=this._relativeTime[0<b?"future":"past"];return x(a)?
a(c):a.replace(/%s/i,c)};ha.set=function(b){var c,a;for(a in b)c=b[a],x(c)?this[a]=c:this["_"+a]=c;this._config=b;this._ordinalParseLenient=RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)};ha.months=function(b,c){return f(this._months)?this._months[b.month()]:this._months[Kb.test(c)?"format":"standalone"][b.month()]};ha._months="January February March April May June July August September October November December".split(" ");ha.monthsShort=function(b,c){return f(this._monthsShort)?this._monthsShort[b.month()]:
this._monthsShort[Kb.test(c)?"format":"standalone"][b.month()]};ha._monthsShort="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");ha.monthsParse=function(b,c,a){var d,e;this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(d=0;12>d;d++)if(e=q([2E3,d]),a&&!this._longMonthsParse[d]&&(this._longMonthsParse[d]=RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[d]=RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),
!a&&!this._monthsParse[d]&&(e="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[d]=RegExp(e.replace(".",""),"i")),a&&"MMMM"===c&&this._longMonthsParse[d].test(b)||a&&"MMM"===c&&this._shortMonthsParse[d].test(b)||!a&&this._monthsParse[d].test(b))return d};ha._monthsRegex=eb;ha.monthsRegex=function(b){return this._monthsParseExact?(k(this,"_monthsRegex")||za.call(this),b?this._monthsStrictRegex:this._monthsRegex):this._monthsStrictRegex&&b?this._monthsStrictRegex:this._monthsRegex};
ha._monthsShortRegex=eb;ha.monthsShortRegex=function(b){return this._monthsParseExact?(k(this,"_monthsRegex")||za.call(this),b?this._monthsShortStrictRegex:this._monthsShortRegex):this._monthsShortStrictRegex&&b?this._monthsShortStrictRegex:this._monthsShortRegex};ha.week=function(b){return Ea(b,this._week.dow,this._week.doy).week};ha._week={dow:0,doy:6};ha.firstDayOfYear=function(){return this._week.doy};ha.firstDayOfWeek=function(){return this._week.dow};ha.weekdays=function(b,c){return f(this._weekdays)?
this._weekdays[b.day()]:this._weekdays[this._weekdays.isFormat.test(c)?"format":"standalone"][b.day()]};ha._weekdays="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");ha.weekdaysMin=function(b){return this._weekdaysMin[b.day()]};ha._weekdaysMin="Su Mo Tu We Th Fr Sa".split(" ");ha.weekdaysShort=function(b){return this._weekdaysShort[b.day()]};ha._weekdaysShort="Sun Mon Tue Wed Thu Fri Sat".split(" ");ha.weekdaysParse=function(b,c,a){var d,e;this._weekdaysParse||(this._weekdaysParse=
[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]);for(d=0;7>d;d++)if(e=ka([2E3,1]).day(d),a&&!this._fullWeekdaysParse[d]&&(this._fullWeekdaysParse[d]=RegExp("^"+this.weekdays(e,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[d]=RegExp("^"+this.weekdaysShort(e,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[d]=RegExp("^"+this.weekdaysMin(e,"").replace(".",".?")+"$","i")),this._weekdaysParse[d]||(e="^"+this.weekdays(e,"")+"|^"+this.weekdaysShort(e,"")+
"|^"+this.weekdaysMin(e,""),this._weekdaysParse[d]=RegExp(e.replace(".",""),"i")),a&&"dddd"===c&&this._fullWeekdaysParse[d].test(b)||a&&"ddd"===c&&this._shortWeekdaysParse[d].test(b)||a&&"dd"===c&&this._minWeekdaysParse[d].test(b)||!a&&this._weekdaysParse[d].test(b))return d};ha.isPM=function(b){return"p"===(b+"").toLowerCase().charAt(0)};ha._meridiemParse=/[ap]\.?m?\.?/i;ha.meridiem=function(b,c,a){return 11<b?a?"pm":"PM":a?"am":"AM"};B("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(b){var c=
b%10,c=1===t(b%100/10)?"th":1===c?"st":2===c?"nd":3===c?"rd":"th";return b+c}});p.lang=n("moment.lang is deprecated. Use moment.locale instead.",B);p.langData=n("moment.langData is deprecated. Use moment.localeData instead.",E);var fb=Math.abs,ec=Ra("ms"),fc=Ra("s"),gc=Ra("m"),hc=Ra("h"),ic=Ra("d"),jc=Ra("w"),kc=Ra("M"),lc=Ra("y"),mc=Xa("milliseconds"),nc=Xa("seconds"),oc=Xa("minutes"),pc=Xa("hours"),qc=Xa("days"),rc=Xa("months"),sc=Xa("years"),Bb=Math.round,mb={s:45,m:45,h:22,d:26,M:11},Jb=Math.abs,
na=Qa.prototype;na.abs=function(){var b=this._data;this._milliseconds=fb(this._milliseconds);this._days=fb(this._days);this._months=fb(this._months);b.milliseconds=fb(b.milliseconds);b.seconds=fb(b.seconds);b.minutes=fb(b.minutes);b.hours=fb(b.hours);b.months=fb(b.months);b.years=fb(b.years);return this};na.add=function(b,c){return Eb(this,b,c,1)};na.subtract=function(b,c){return Eb(this,b,c,-1)};na.as=function(b){var c,a=this._milliseconds;b=I(b);if("month"===b||"year"===b)return c=this._days+a/
864E5,c=this._months+4800*c/146097,"month"===b?c:c/12;c=this._days+Math.round(146097*this._months/4800);switch(b){case "week":return c/7+a/6048E5;case "day":return c+a/864E5;case "hour":return 24*c+a/36E5;case "minute":return 1440*c+a/6E4;case "second":return 86400*c+a/1E3;case "millisecond":return Math.floor(864E5*c)+a;default:throw Error("Unknown unit "+b);}};na.asMilliseconds=ec;na.asSeconds=fc;na.asMinutes=gc;na.asHours=hc;na.asDays=ic;na.asWeeks=jc;na.asMonths=kc;na.asYears=lc;na.valueOf=function(){return this._milliseconds+
864E5*this._days+2592E6*(this._months%12)+31536E6*t(this._months/12)};na._bubble=function(){var b=this._milliseconds,c=this._days,a=this._months,d=this._data;0<=b&&0<=c&&0<=a||0>=b&&0>=c&&0>=a||(b+=864E5*(0>146097*a/4800+c?Math.floor(146097*a/4800+c):Math.ceil(146097*a/4800+c)),a=c=0);d.milliseconds=b%1E3;b=s(b/1E3);d.seconds=b%60;b=s(b/60);d.minutes=b%60;b=s(b/60);d.hours=b%24;c+=s(b/24);b=s(4800*c/146097);a+=b;c-=0>146097*b/4800?Math.floor(146097*b/4800):Math.ceil(146097*b/4800);b=s(a/12);d.days=
c;d.months=a%12;d.years=b;return this};na.get=function(b){b=I(b);return this[b+"s"]()};na.milliseconds=mc;na.seconds=nc;na.minutes=oc;na.hours=pc;na.days=qc;na.weeks=function(){return s(this.days()/7)};na.months=rc;na.years=sc;na.humanize=function(b){var c=this.localeData(),a;a=!b;var d=Fa(this).abs(),e=Bb(d.as("s")),g=Bb(d.as("m")),n=Bb(d.as("h")),f=Bb(d.as("d")),h=Bb(d.as("M")),d=Bb(d.as("y")),e=e<mb.s&&["s",e]||1>=g&&["m"]||g<mb.m&&["mm",g]||1>=n&&["h"]||n<mb.h&&["hh",n]||1>=f&&["d"]||f<mb.d&&
["dd",f]||1>=h&&["M"]||h<mb.M&&["MM",h]||1>=d&&["y"]||["yy",d];e[2]=a;e[3]=0<+this;e[4]=c;a=Hb.apply(null,e);b&&(a=c.pastFuture(+this,a));return c.postformat(a)};na.toISOString=pb;na.toString=pb;na.toJSON=pb;na.locale=wa;na.localeData=S;na.toIsoString=n("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",pb);na.lang=Mb;G("X",0,0,"unix");G("x",0,0,"valueOf");L("x",db);L("X",/[+-]?\d+(\.\d{1,3})?/);Y("X",function(b,c,a){a._d=new Date(1E3*parseFloat(b,10))});Y("x",function(b,
c,a){a._d=new Date(t(b))});p.version="2.12.0";Fb=ka;p.fn=U;p.min=function(){var b=[].slice.call(arguments,0);return $a("isBefore",b)};p.max=function(){var b=[].slice.call(arguments,0);return $a("isAfter",b)};p.now=function(){return Date.now?Date.now():+new Date};p.utc=q;p.unix=function(b){return ka(1E3*b)};p.months=function(b,c){return hb(b,c,"months",12,"month")};p.isDate=a;p.locale=B;p.invalid=e;p.duration=Fa;p.isMoment=u;p.weekdays=function(b,c){return hb(b,c,"weekdays",7,"day")};p.parseZone=function(){return ka.apply(null,
arguments).parseZone()};p.localeData=E;p.isDuration=Va;p.monthsShort=function(b,c){return hb(b,c,"monthsShort",12,"month")};p.weekdaysMin=function(b,c){return hb(b,c,"weekdaysMin",7,"day")};p.defineLocale=F;p.updateLocale=function(b,c){if(null!=c){var a;null!=ma[b]&&(c=z(ma[b]._config,c));a=new y(c);a.parentLocale=ma[b];ma[b]=a;B(b)}else null!=ma[b]&&(null!=ma[b].parentLocale?ma[b]=ma[b].parentLocale:null!=ma[b]&&delete ma[b]);return ma[b]};p.locales=function(){return Object.keys(ma)};p.weekdaysShort=
function(b,c){return hb(b,c,"weekdaysShort",7,"day")};p.normalizeUnits=I;p.relativeTimeThreshold=function(b,c){if(void 0===mb[b])return!1;if(void 0===c)return mb[b];mb[b]=c;return!0};p.prototype=U;return p})},"esri/arcade/ImmutableArray":function(){define(["require","exports"],function(p,f){return function(){function a(a){void 0===a&&(a=[]);this._elements=a}a.prototype.length=function(){return this._elements.length};a.prototype.get=function(a){return this._elements[a]};a.prototype.toArray=function(){for(var a=
[],f=0;f<this.length();f++)a.push(this.get(f));return a};return a}()})},"esri/arcade/ImmutablePointArray":function(){define("require exports ../core/tsSupport/extendsHelper ./ImmutableArray ../geometry/Point ../kernel".split(" "),function(p,f,a,l,k,h){var q=0===h.version.indexOf("4.");return function(f){function g(a,c,d,g,h,k){f.call(this,a);this._lazyPt=[];this._hasM=this._hasZ=!1;this._spRef=c;this._hasZ=d;this._hasM=g;this._cacheId=h;this._partId=k}a(g,f);g.prototype.get=function(a){if(void 0===
this._lazyPt[a]){var c=this._elements[a];if(void 0===c)return;var d=this._hasZ,g=this._hasM,f=null,f=d&&!g?new k(c[0],c[1],c[2],void 0,this._spRef):g&&d?new k(c[0],c[1],void 0,c[2],this._spRef):d&&g?new k(c[0],c[1],c[2],c[3],this._spRef):new k(c[0],c[1],this._spRef);q?f.cache._arcadeCacheId=this._cacheId.toString()+"-"+this._partId.toString()+"-"+a.toString():f.setCacheValue("_arcadeCacheId",this._cacheId.toString()+"-"+this._partId.toString()+"-"+a.toString());this._lazyPt[a]=f}return this._lazyPt[a]};
g.prototype.equalityTest=function(a){return a===this?!0:null===a||!1===a instanceof g?!1:a.getUniqueHash()===this.getUniqueHash()};g.prototype.getUniqueHash=function(){return this._cacheId.toString()+"-"+this._partId.toString()};return g}(l)})},"esri/core/tsSupport/extendsHelper":function(){define([],function(){return function(p,f){function a(){this.constructor=p}for(var l in f)f.hasOwnProperty(l)&&(p[l]=f[l]);p.prototype=null===f?Object.create(f):(a.prototype=f.prototype,new a)}})},"esri/arcade/ImmutablePathArray":function(){define(["require",
"exports","../core/tsSupport/extendsHelper","./ImmutableArray","./ImmutablePointArray"],function(p,f,a,l,k){return function(f){function l(a,g,e,c,d){f.call(this,a);this._lazyPath=[];this._hasM=this._hasZ=!1;this._hasZ=e;this._hasM=c;this._spRef=g;this._cacheId=d}a(l,f);l.prototype.get=function(a){if(void 0===this._lazyPath[a]){var g=this._elements[a];if(void 0===g)return;this._lazyPath[a]=new k(g,this._spRef,this._hasZ,this._hasM,this._cacheId,a)}return this._lazyPath[a]};l.prototype.equalityTest=
function(a){return a===this?!0:null===a||!1===a instanceof l?!1:a.getUniqueHash()===this.getUniqueHash()};l.prototype.getUniqueHash=function(){return this._cacheId.toString()};return l}(l)})},"esri/arcade/FunctionWrapper":function(){define(["require","exports"],function(p,f){return function(){return function(a,f){this.context=this.definition=null;this.definition=a;this.context=f}}()})},"esri/arcade/treeAnalysis":function(){define(["require","exports"],function(p,f){function a(b,c,a,d){void 0!==b.fmin&&
(b.min=b.fmin);void 0!==b.fmax&&(b.max=b.fmax);return"0"!==b.min&&a.length<Number(b.min)||"*"!==b.max&&a.length>Number(b.max)?-2:1}function l(b,c,d){if(null!==d.localScope&&void 0!==d.localScope[b.toLowerCase()]){var e=d.localScope[b.toLowerCase()];if("FormulaFunction"===e.type||"any"===e.type)return void 0===e.signature&&(e.signature={min:"0",max:"*"}),a(e.signature,b,c,d)}return void 0!==d.globalScope[b.toLowerCase()]&&(e=d.globalScope[b.toLowerCase()],"FormulaFunction"===e.type||"any"===e.type)?
(void 0===e.signature&&(e.signature={min:"0",max:"*"}),a(e.signature,b,c,d)):-1}function k(b,c){void 0===c&&(c=!0);var a=r(b,"SYNTAX","UNREOGNISED");try{switch(b.type){case "VariableDeclarator":return null!==b.init&&"FunctionExpression"===b.init.type?r(b,"SYNTAX","FUNCTIONVARIABLEDECLARATOR"):"Identifier"!==b.id.type?r(b,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER"):null!==b.init?k(b.init,!1):"";case "VariableDeclaration":for(var d=0;d<b.declarations.length;d++)if(a=k(b.declarations[d],c),""!==a)return a;
return"";case "ForInStatement":a=k(b.left,c);if(""!==a)break;if("VariableDeclaration"===b.left.type){if(1<b.left.declarations.length)return r(b,"SYNTAX","ONLY1VAR");if(null!==b.left.declarations[0].init)return r(b,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==b.left.type)return r(b,"SYNTAX","LEFTNOTVAR");a=k(b.right,c);if(""!==a)break;a=k(b.body,c);if(""!==a)break;return"";case "ForStatement":if(null!==b.test&&(a=k(b.test,c),""!==a))break;if(null!==b.init&&(a=k(b.init,c),""!==a))break;if(null!==
b.update&&(a=k(b.update,c),""!==a))break;if(null!==b.body&&(a=k(b.body,c),""!==a))break;return"";case "ContinueStatement":return"";case "EmptyStatement":return"";case "BreakStatement":return"";case "IfStatement":a=k(b.test,c);if(""!==a)break;if(null!==b.consequent&&(a=k(b.consequent,!1),""!==a))break;if(null!==b.alternate&&(a=k(b.alternate,!1),""!==a))break;return"";case "BlockStatement":for(var e=[],d=0;d<b.body.length;d++)"EmptyStatement"!==b.body[d].type&&e.push(b.body[d]);b.body=e;for(d=0;d<b.body.length;d++)if(a=
k(b.body[d],c),""!==a)return a;return"";case "FunctionDeclaration":return!1===c?r(b,"SYNTAX","GLOBALFUNCTIONSONLY"):"Identifier"!==b.id.type?r(b,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"):k(b.body,!1);case "ReturnStatement":return null!==b.argument?k(b.argument,c):"";case "UpdateExpression":return"Identifier"!==b.argument.type&&"MemberExpression"!==b.argument.type?r(b,"SYNTAX","ASSIGNMENTTOVARSONLY"):k(b.argument,c);case "AssignmentExpression":if("Identifier"!==b.left.type&&"MemberExpression"!==b.left.type)return r(b,
"SYNTAX","ASSIGNMENTTOVARSONLY");a=k(b.left,c);if(""!==a)break;switch(b.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:return r(b,"SYNTAX","OPERATORNOTRECOGNISED")}return k(b.right,!1);case "ExpressionStatement":return k(b.expression,!1);case "Identifier":a="";break;case "MemberExpression":a=k(b.object,c);if(""!==a)break;return!0===b.computed?k(b.property,c):"";case "Literal":return"";case "ThisExpression":return r(b,"SYNTAX","NOTSUPPORTED");case "CallExpression":if("Identifier"!==
b.callee.type)return r(b,"SYNTAX","ONLYNODESSUPPORTED");a="";for(d=0;d<b.arguments.length;d++)if(a=k(b.arguments[d],c),""!==a)return a;return"";case "UnaryExpression":a=k(b.argument,c);break;case "BinaryExpression":a=k(b.left,c);if(""!==a)break;a=k(b.right,c);if(""!==a)break;switch(b.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;default:return r(b,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "LogicalExpression":a=
k(b.left,c);if(""!==a)break;a=k(b.right);if(""!==a)break;switch(b.operator){case "\x26\x26":case "||":break;default:return r(b,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "ConditionalExpression":return r(b,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":a="";for(d=0;d<b.elements.length&&!(a=k(b.elements[d],c),""!==a);d++);break;case "Array":return r(b,"SYNTAX","NOTSUPPORTED");case "ObjectExpression":a="";for(d=0;d<b.properties.length&&!(a="",null!==b.properties[d].key&&("Literal"!==b.properties[d].key.type&&
"Identifier"!==b.properties[d].key.type&&(a=r(b,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===b.properties[d].key.type&&(e=b.properties[d].key.value,"string"===typeof e||e instanceof String||(a=r(b,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")))),""===a&&(a=k(b.properties[d],c)),""!==a);d++);break;case "Property":if("Literal"!==b.key.type&&"Identifier"!==b.key.type)return r(b,"SYNTAX","ONLYLITERAL");if("Identifier"!==b.key.type&&(a=k(b.key,c),""!==a))break;a=k(b.value,c)}return a}catch(g){throw g;
}}function h(b,a){var d=r(b,"SYNTAX","UNREOGNISED"),g=null,f="";try{switch(b.type){case "VariableDeclarator":if(null!==b.init&&"FunctionExpression"===b.init.type)return r(b,"SYNTAX","FUNCTIONVARIABLEDECLARATOR");null!==a.localScope?void 0!==a.localScope[b.id.name.toLowerCase()]&&b.id.name.toLowerCase():void 0!==a.globalScope[b.id.name.toLowerCase()]&&b.id.name.toLowerCase();var t=null==b.init?"":h(b.init,a);if(""!==t)return t;null===a.localScope?a.globalScope[b.id.name.toLowerCase()]={type:"any"}:
a.localScope[b.id.name.toLowerCase()]={type:"any"};return"";case "FunctionDeclaration":g=e(b.id.name.toLowerCase(),b,a);f=c(b,a);if(""!==f)return f;if(null!==a.localScope)return r(b,"SYNTAX","GLOBALFUNCTIONSONLY");g.isnative=!1;a.globalScope[b.id.name.toLowerCase()]={type:"FormulaFunction",signature:[g]};return"";case "VariableDeclaration":for(var d="",k=0;k<b.declarations.length&&!(d=h(b.declarations[k],a),""!==d);k++);break;case "IfStatement":d=h(b.test,a);if(""!==d)break;if("AssignmentExpression"===
b.test.type||"UpdateExpression"===b.test.type)return r(b.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION");if(null!==b.consequent&&(d=h(b.consequent,a),""!==d))break;if(null!==b.alternate&&(d=h(b.alternate,a),""!==d))break;return"";case "EmptyStatement":return"";case "BlockStatement":for(k=0;k<b.body.length;k++)if(d=h(b.body[k],a),""!==d)return d;return"";case "ReturnStatement":return null!==b.argument?h(b.argument,a):"";case "ForInStatement":if("VariableDeclaration"===b.left.type){if(1<b.left.declarations.length)return r(b,
"SYNTAX","ONLY1VAR");if(null!==b.left.declarations[0].init)return r(b,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==b.left.type)return r(b,"SYNTAX","LEFTNOTVAR");d=h(b.left,a);if(""!==d)break;d=h(b.right,a);if(""!==d)break;d=h(b.body,a);if(""!==d)break;return"";case "ForStatement":if(null!==b.init&&(d=h(b.init,a),""!==d))break;if(null!==b.test&&(d=h(b.test,a),""!==d))break;if(null!==b.body&&(d=h(b.body,a),""!==d))break;if(null!==b.update&&(d=h(b.update,a),""!==d))break;return"";case "BreakStatement":return"";
case "ContinueStatement":return"";case "UpdateExpression":if("Identifier"!==b.argument.type&&"MemberExpression"!==b.argument.type)return r(b,"SYNTAX","ASSIGNMENTTOVARSONLY");var s=!1;if("MemberExpression"===b.argument.type)return h(b.argument,a);null!==a.localScope&&void 0!==a.localScope[b.argument.name.toLowerCase()]&&(s=!0);void 0!==a.globalScope[b.argument.name.toLowerCase()]&&(s=!0);return!1===s?"Identifier "+b.argument.name+" has not been declared.":"";case "AssignmentExpression":if("Identifier"!==
b.left.type&&"MemberExpression"!==b.left.type)return r(b,"SYNTAX","ASSIGNMENTTOVARSONLY");var m=h(b.right,a);if(""!==m)return m;s=!1;if("MemberExpression"===b.left.type)return m=h(b.left,a),""!==m?m:"";null!==a.localScope&&void 0!==a.localScope[b.left.name.toLowerCase()]&&(s=!0);void 0!==a.globalScope[b.left.name.toLowerCase()]&&(s=!0);return!1===s?"Identifier "+b.left.name+" has not been declared.":"";case "ExpressionStatement":return h(b.expression,a);case "Identifier":var u=b.name.toLowerCase();
if(null!==a.localScope&&void 0!==a.localScope[u])return"";d=void 0!==a.globalScope[u]?"":r(b,"SYNTAX","VARIABLENOTFOUND");break;case "MemberExpression":d=h(b.object,a);if(""!==d)break;return!0===b.computed?h(b.property,a):"";case "Literal":return"";case "ThisExpression":d=r(b,"SYNTAX","NOTSUPPORTED");break;case "CallExpression":if("Identifier"!==b.callee.type)return r(b,"SYNTAX","ONLYNODESSUPPORTED");d="";for(k=0;k<b.arguments.length;k++)if(d=h(b.arguments[k],a),""!==d)return d;var q=l(b.callee.name,
b.arguments,a);-1===q&&(d=r(b,"SYNTAX","NOTFOUND"));-2===q&&(d=r(b,"SYNTAX","WRONGSIGNATURE"));break;case "UnaryExpression":d=h(b.argument,a);break;case "BinaryExpression":d=h(b.left,a);if(""!==d)break;d=h(b.right,a);if(""!==d)break;return"";case "LogicalExpression":d=h(b.left,a);if(""!==d)break;if("AssignmentExpression"===b.left.type||"UpdateExpression"===b.left.type)return r(b.left,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION");d=h(b.right,a);if(""!==d)break;return"AssignmentExpression"===b.right.type||
"UpdateExpression"===b.right.type?r(b.right,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"):"";case "ConditionalExpression":return r(b,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":d="";for(k=0;k<b.elements.length&&!(d=h(b.elements[k],a),""!==d);k++);break;case "ObjectExpression":d="";for(k=0;k<b.properties.length;k++){d="";if(null!==b.properties[k].key&&("Literal"!==b.properties[k].key.type&&"Identifier"!==b.properties[k].key.type&&(d=r(b,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===b.properties[k].key.type)){var p=
b.properties[k].key.value;"string"===typeof p||p instanceof String||(d=r(b,"SYNTAX","OBJECTPROPERTYMUSTBESTRING"))}""===d&&(d=h(b.properties[k],a));if(""!==d)break}break;case "Property":if("Literal"!==b.key.type&&"Identifier"!==b.key.type)return r(b,"SYNTAX","ONLYLITERAL");if("Identifier"!==b.key.type&&(d=h(b.key,a),""!==d))break;d=h(b.value,a);break;case "Array":return r(b,"SYNTAX","NOTSUPPORTED")}return d}catch(I){throw I;}}function q(b,c){var a=!1;try{switch(b.type){case "VariableDeclarator":return null!==
b.init?q(b.init,c):a;case "FunctionDeclaration":return q(b.body,c);case "VariableDeclaration":for(var d=0;d<b.declarations.length;d++)if(q(b.declarations[d],c))return!0;return a;case "IfStatement":return q(b.test,c)||null!==b.consequent&&q(b.consequent,c)||null!==b.alternate&&q(b.alternate,c)?!0:a;case "EmptyStatement":return a;case "BlockStatement":for(d=0;d<b.body.length;d++)if(q(b.body[d],c))return!0;return a;case "ReturnStatement":return null!==b.argument?q(b.argument,c):a;case "UpdateExpression":return(a=
q(b.right,c))?a:q(b.left,c);case "AssignmentExpression":return q(b.right,c);case "ExpressionStatement":return q(b.expression,c);case "ForInStatement":return(a=q(b.left,c))||(a=q(b.right,c))?a:a=q(b.body,c);case "ForStatement":if(null!==b.init&&(a=q(b.init,c))||null!==b.test&&(a=q(b.test,c))||null!==b.body&&(a=q(b.body,c)))return a;null!==b.update&&(a=q(b.update,c));return a;case "BreakStatement":return a;case "ContinueStatement":return a;case "Compound":return a;case "Identifier":return c.toLowerCase()===
b.name.toLowerCase();case "MemberExpression":if(a=q(b.object,c))return a;!0===b.computed&&(a=q(b.property,c));return a;case "Literal":return a;case "ThisExpression":return a;case "CallExpression":for(d=0;d<b.arguments.length;d++)q(b.arguments[d],c)&&(a=!0);return a;case "ArrayExpression":for(d=0;d<b.elements.length;d++)q(b.elements[d],c)&&(a=!0);return a;case "UnaryExpression":return q(b.argument,c);case "BinaryExpression":return(a=q(b.left,c))?a:a=q(b.right,c);case "LogicalExpression":return(a=q(b.left,
c))?a:a=q(b.right,c);case "ObjectExpression":for(d=0;d<b.properties.length;d++)q(b.properties[d],c)&&(a=!0);return a;case "Property":return a=q(b.value,c);case "ConditionalExpression":return a;case "Array":return a;default:return a}}catch(e){throw e;}}function m(b,c){var a=!1;try{switch(b.type){case "VariableDeclarator":return null!==b.init?m(b.init,c):a;case "FunctionDeclaration":return m(b.body,c);case "VariableDeclaration":for(var d=0;d<b.declarations.length;d++)if(m(b.declarations[d],c))return!0;
return a;case "IfStatement":return m(b.test,c)||null!==b.consequent&&m(b.consequent,c)||null!==b.alternate&&m(b.alternate,c)?!0:a;case "EmptyStatement":return a;case "BlockStatement":for(d=0;d<b.body.length;d++)if(m(b.body[d],c))return!0;return a;case "ReturnStatement":return null!==b.argument?m(b.argument,c):a;case "UpdateExpression":return m(b.argument,c);case "AssignmentExpression":return m(b.left,c)?!0:m(b.right,c);case "ExpressionStatement":return m(b.expression,c);case "ForInStatement":return(a=
m(b.left,c))||(a=m(b.right,c))?a:a=m(b.body,c);case "ForStatement":if(null!==b.init&&(a=m(b.init,c))||null!==b.test&&(a=m(b.test,c))||null!==b.body&&(a=m(b.body,c)))return a;null!==b.update&&(a=m(b.update,c));return a;case "BreakStatement":return a;case "ContinueStatement":return a;case "Compound":return a;case "Identifier":return a;case "MemberExpression":if(a=m(b.object,c))return a;!0===b.computed&&(a=m(b.property,c));return a;case "Literal":return a;case "ThisExpression":return a;case "CallExpression":if(b.callee.name.toLowerCase()===
c.toLowerCase())return!0;for(d=0;d<b.arguments.length;d++)m(b.arguments[d],c)&&(a=!0);return a;case "ArrayExpression":for(d=0;d<b.elements.length;d++)m(b.elements[d],c)&&(a=!0);return a;case "UnaryExpression":return m(b.argument,c);case "BinaryExpression":return(a=m(b.left,c))?a:a=m(b.right,c);case "LogicalExpression":return(a=m(b.left,c))?a:a=m(b.right,c);case "ConditionalExpression":return a;case "ObjectExpression":for(d=0;d<b.properties.length;d++)m(b.properties[d],c)&&(a=!0);return a;case "Property":return a=
m(b.value,c);case "Array":return a;default:return a}}catch(e){throw e;}}function g(b,c){var a=[],d;try{switch(b.type){case "VariableDeclarator":return null!==b.init?g(b.init,c):a;case "FunctionDeclaration":return g(b.body,c);case "VariableDeclaration":for(var e=0;e<b.declarations.length;e++)d=g(b.declarations[e],c),a=a.concat(d);return a;case "ForInStatement":return d=g(b.left,c),a=a.concat(d),d=g(b.right,c),a=a.concat(d),d=g(b.body,c),a=a.concat(d);case "ForStatement":return null!==b.init&&(d=g(b.init,
c),a=a.concat(d)),null!==b.test&&(d=g(b.test,c),a=a.concat(d)),null!==b.body&&(d=g(b.body,c),a=a.concat(d)),null!==b.update&&(d=g(b.update,c),a=a.concat(d)),a;case "IfStatement":return d=g(b.test,c),a=a.concat(d),null!==b.consequent&&(d=g(b.consequent,c),a=a.concat(d)),null!==b.alternate&&(d=g(b.alternate,c),a=a.concat(d)),a;case "EmptyStatement":return a;case "BlockStatement":for(e=0;e<b.body.length;e++)d=g(b.body[e],c),a=a.concat(d);return a;case "ReturnStatement":return null!==b.argument?g(b.argument,
c):a;case "UpdateExpression":return g(b.argument,c);case "AssignmentExpression":return a=g(b.left,c),a=a.concat(g(b.right,c));case "ExpressionStatement":return g(b.expression,c);case "BreakStatement":return a;case "ContinueStatement":return a;case "Compound":return a;case "Identifier":return a;case "MemberExpression":if("Identifier"!==b.object.type)return a;if(!1===b.computed)a.push(b.object.name.toLowerCase()+"."+b.property.name.toLowerCase());else try{"Literal"===b.property.type&&"string"===typeof b.property.value&&
a.push(b.object.name.toLowerCase()+"."+b.property.value.toString().toLowerCase())}catch(f){}return a;case "Literal":return a;case "ThisExpression":return a;case "CallExpression":for(e=0;e<b.arguments.length;e++)d=g(b.arguments[e],c),a=a.concat(d);return a;case "ArrayExpression":for(e=0;e<b.elements.length;e++)d=g(b.elements[e],c),a=a.concat(d);return a;case "UnaryExpression":return g(b.argument,c);case "ObjectExpression":for(e=0;e<b.properties.length;e++)d=g(b.properties[e],c),a=a.concat(d);return a;
case "Property":return g(b.value,c);case "BinaryExpression":return d=g(b.left,c),a=a.concat(d),d=g(b.right,c),a=a.concat(d);case "LogicalExpression":return d=g(b.left,c),a=a.concat(d),d=g(b.right,c),a=a.concat(d);case "ConditionalExpression":return a;case "Array":return a;default:return a}}catch(h){throw h;}}function e(b,c,a){a=[];if(void 0!==c.params&&null!==c.params)for(var d=0;d<c.params.length;d++)a.push("any");return{name:b,"return":"any",params:a}}function c(b,c){for(var a={globalScope:c.globalScope,
localScope:{}},d=0;d<b.params.length;d++)a.localScope[b.params[d].name.toLowerCase()]={type:"any"};return h(b.body,a)}function d(b,c,a,d){var e={};if(void 0===b||null===b)b={};if(void 0===a||null===a)a={};e.infinity={type:"any"};e.textformatting={type:"any"};e.pi={type:"any"};for(var g in c)if("simple"!==d||"simple"===d&&"a"===c[g].av)e[g]={type:"FormulaFunction",signature:c[g]};for(c=0;c<a.length;c++)g=a[c],e[g.name]={type:"FormulaFunction",signature:g};for(g in b)e[g]=b[g],e[g].type="any";return e}
function r(b,c,a){var d="";switch(c){case "SYNTAX":d="Syntax Error: ";break;case "RUNTIME":d="Runtime Error: ";break;default:d="Syntax Error: "}try{switch(b.type){case "IfStatement":switch(a){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":d+=" Assignments not be made in logical tests";break;case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":d+=" Non Boolean used as Condition"}break;case "UpdateExpression":case "AssignmentExpression":switch(a){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":d+=" Assignments not be made in logical tests";
break;case "ASSIGNMENTTOVARSONLY":d+=" Assignments can only be made to identifiers"}break;case "ExpressionStatement":d+=" Assignments can only be made to identifiers";break;case "FunctionDeclaration":switch(a){case "GLOBALFUNCTIONSONLY":d+=" Functions cannot be declared as variables";break;case "FUNCTIONMUSTHAVEIDENTIFIER":d+=" Function Definition must have an identifier"}break;case "VariableDeclaration":d+=" Only 1 variable can be declared at a time";break;case "VariableDeclarator":switch(a){case "FUNCTIONVARIABLEDECLARATOR":d+=
" Functions cannot be declared as variables";break;case "VARIABLEMUSTHAVEIDENTIFIER":d+=" Variable Definition must have an identifier"}break;case "Identifier":d+=" Identifier Not Found. ";d+=b.name;break;case "ObjectExpression":switch(a){case "OBJECTPROPERTYMUSTBESTRING":d+=" Property name must be a string"}break;case "ForStatement":switch(a){case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":d+=" Non Boolean used as Condition"}break;case "ForInStatement":switch(a){case "ONLY1VAR":d+=" Can only declare 1 var for use with IN";
break;case "CANNOTDECLAREVAL":d+=" Can only declare value for use with IN";break;case "LEFTNOVAR":d+="Must provide a variable to iterate with.";break;case "VARIABLENOTDECLARED":d+="Variable must be declared before it is used..";break;case "CANNOTITERATETHISTYPE":d+="This type cannot be used in an IN loop"}break;case "MemberExpression":switch(a){case "PROPERTYNOTFOUND":d+="Cannot find member property. ";d+=!1===b.computed?b.property.name:"";break;case "OUTOFBOUNDS":d+="Out of Bounds. ";d+=!1===b.computed?
b.property.name:"";break;case "NOTFOUND":d+="Cannot call member method on null. ";d+=!1===b.computed?b.property.name:"";break;case "INVALIDTYPE":d+="Cannot call member property on object of this type. ",d+=!1===b.computed?b.property.name:""}break;case "Property":switch(a){case "ONLYLITERAL":d+="Property names must be literals or identifiers"}break;case "Literal":break;case "ThisExpression":d+="THIS construct is not supported.";case "CallExpression":switch(a){case "WRONGSIGNATURE":d+="Function signature does not match: ";
d+=b.callee.name;break;case "ONLYNODESUPPORTED":d+="Functions must be declared.";d+=b.callee.name;break;case "NOTAFUNCTION":d+="Not a Function: ";d+=b.callee.name;break;case "NOTFOUND":d+="Function Not Found: "+b.callee.name}break;case "UnaryExpression":switch(a){case "NOTSUPPORTEDUNARYOPERATOR":d+="Operator "+b.operator+" not allowed in this context. Only ! can be used with boolean, and - with a number";break;case "NOTSUPPORTEDTYPE":d+="Unary operator "+b.operator+" cannot be used with this argument.";
break}case "BinaryExpression":switch(a){case "OPERATORNOTRECOGNISED":d+="Binary Operator not recognised "+b.operator}break;case "LogicalExpression":return"";case "ConditionalExpression":d+="Conditional statements not supported.";break;case "ArrayExpression":switch(a){case "FUNCTIONCONTEXTILLEGAL":d+=" Cannot Put Function inside Array."}break;case "Array":d+="Expression contains unrecognised array structure.";break;default:d+="Expression contains unrecognised code structures."}}catch(e){throw e;}return d}
function u(b,c,a){return{line:b.loc.start.line,character:b.loc.start.column,reason:r(b,c,a)}}function s(b,c,a,d,e){c={globalScope:c.globalScope,localScope:{}};for(e=0;e<b.params.length;e++)c.localScope[b.params[e].name.toLowerCase()]={type:"any"};t(b.body,c,a,d,!1)}function t(b,c,a,d,g){void 0===g&&(g=!0);if(null===b)throw Error("Unnexpexted Expression Syntax");r(b,"SYNTAX","UNREOGNISED");var f=null;try{switch(b.type){case "VariableDeclarator":if(null!==b.init&&"FunctionExpression"===b.init.type){d.push(u(b,
"SYNTAX","FUNCTIONVARIABLEDECLARATOR"));break}"Identifier"!==b.id.type?d.push(u(b,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER")):(null!==c.localScope?void 0!==c.localScope[b.id.name.toLowerCase()]&&b.id.name.toLowerCase():void 0!==c.globalScope[b.id.name.toLowerCase()]&&b.id.name.toLowerCase(),null===c.localScope?c.globalScope[b.id.name.toLowerCase()]={type:"any"}:c.localScope[b.id.name.toLowerCase()]={type:"any"});null===b.init?"":t(b.init,c,a,d,g);break;case "FunctionDeclaration":!1===g&&d.push(u(b,"SYNTAX",
"GLOBALFUNCTIONSONLY"));"Identifier"!==b.id.type&&d.push(u(b,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"));f=e("",b,c);s(b,c,a,d,g);null!==c.localScope&&d.push(u(b,"SYNTAX","GLOBALFUNCTIONSONLY"));f.isnative=!1;"Identifier"===b.id.type&&(c.globalScope[b.id.name.toLowerCase()]={type:"FormulaFunction",signature:[f]});break;case "VariableDeclaration":for(var h=0;h<b.declarations.length;h++)t(b.declarations[h],c,a,d,g);break;case "IfStatement":null!==b.test&&(t(b.test,c,a,d,g),("AssignmentExpression"===b.test.type||
"UpdateExpression"===b.test.type)&&d.push(u(b.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION")));null!==b.consequent&&t(b.consequent,c,a,d,g);null!==b.alternate&&t(b.alternate,c,a,d,g);break;case "EmptyStatement":break;case "BlockStatement":if(null!==b.body)for(h=0;h<b.body.length;h++)t(b.body[h],c,a,d,g);break;case "ReturnStatement":null!==b.argument&&t(b.argument,c,a,d,g);break;case "ForInStatement":"VariableDeclaration"===b.left.type?(1<b.left.declarations.length&&d.push(u(b,"SYNTAX","ONLY1VAR")),
null!==b.left.declarations[0].init&&d.push(u(b,"SYNTAX","CANNOTDECLAREVAL"))):"Identifier"!==b.left.type&&d.push(u(b,"SYNTAX","LEFTNOTVAR"));t(b.left,c,a,d,g);t(b.right,c,a,d,g);t(b.body,c,a,d,g);break;case "ForStatement":null!==b.init&&t(b.init,c,a,d,g);null!==b.test&&t(b.test,c,a,d,g);null!==b.body&&t(b.body,c,a,d,g);null!==b.update&&t(b.update,c,a,d,g);break;case "BreakStatement":break;case "ContinueStatement":break;case "UpdateExpression":"Identifier"!==b.argument.type&&"MemberExpression"!==b.argument.type?
d.push(u(b,"SYNTAX","ASSIGNMENTTOVARSONLY")):("Identifier"===b.argument.type&&(f=!1,!1===a&&(null!==c.localScope&&void 0!==c.localScope[b.argument.name.toLowerCase()]&&(f=!0),void 0!==c.globalScope[b.argument.name.toLowerCase()]&&(f=!0),!1===f&&d.push({line:null===b?0:b.loc.start.line,character:null===b?0:b.loc.start.column,reason:"Identifier "+b.argument.name+" has not been declared."}))),"MemberExpression"===b.argument.type&&t(b.argument,c,a,d,g));break;case "AssignmentExpression":"Identifier"!==
b.left.type&&"MemberExpression"!==b.left.type&&d.push(u(b,"SYNTAX","ASSIGNMENTTOVARSONLY"));switch(b.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:d.push(u(b,"SYNTAX","OPERATORNOTRECOGNISED"))}t(b.right,c,a,d,g);f=!1;"Identifier"===b.left.type&&(null!==c.localScope&&void 0!==c.localScope[b.left.name.toLowerCase()]&&(f=!0),void 0!==c.globalScope[b.left.name.toLowerCase()]&&(f=!0),!1===a&&!1===f&&d.push({line:null===b?0:b.loc.start.line,character:null===
b?0:b.loc.start.column,reason:"Identifier "+b.argument.name+" has not been declared."}));"MemberExpression"===b.left.type&&t(b.left,c,a,d,g);break;case "ExpressionStatement":t(b.expression,c,a,d,g);break;case "Identifier":var k=b.name.toLowerCase();if(null!==c.localScope&&void 0!==c.localScope[k])break;if(void 0!==c.globalScope[k])break;else!1===a&&d.push(u(b,"SYNTAX","VARIABLENOTFOUND"));break;case "MemberExpression":t(b.object,c,a,d,g);!0===b.computed&&t(b.property,c,a,d,g);break;case "Literal":return"";
case "ThisExpression":d.push(u(b,"SYNTAX","NOTSUPPORTED"));break;case "CallExpression":"Identifier"!==b.callee.type&&d.push(u(b,"SYNTAX","ONLYNODESSUPPORTED"));for(h=0;h<b.arguments.length;h++)t(b.arguments[h],c,a,d,g);var m=l(b.callee.name,b.arguments,c);!1===a&&-1===m&&d.push(u(b,"SYNTAX","NOTFOUND"));-2===m&&d.push(u(b,"SYNTAX","WRONGSIGNATURE"));break;case "UnaryExpression":t(b.argument,c,a,d,g);break;case "BinaryExpression":t(b.left,c,a,d,g);t(b.right,c,a,d,g);switch(b.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;
default:d.push(u(b,"SYNTAX","OPERATORNOTRECOGNISED"))}break;case "LogicalExpression":switch(b.operator){case "\x26\x26":case "||":break;default:d.push(u(b,"SYNTAX","OPERATORNOTRECOGNISED"))}t(b.left,c,a,d,g);("AssignmentExpression"===b.left.type||"UpdateExpression"===b.left.type)&&d.push(u(b,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));t(b.right,c,a,d,g);("AssignmentExpression"===b.right.type||"UpdateExpression"===b.right.type)&&d.push(u(b,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));break;
case "ConditionalExpression":d.push(u(b,"SYNTAX","NOTSUPPORTED"));break;case "ArrayExpression":for(h=0;h<b.elements.length;h++)t(b.elements[h],c,a,d,g);break;case "Array":d.push(u(b,"SYNTAX","NOTSUPPORTED"));case "ObjectExpression":for(h=0;h<b.properties.length;h++)t(b.properties[h],c,a,d,g);break;case "Property":"Literal"!==b.key.type&&"Identifier"!==b.key.type&&d.push(u(b,"SYNTAX","ONLYLITERAL"));"Literal"===b.key.type&&t(b.key,c,a,d,g);t(b.value,c,a,d,g);break;default:d.push(u(b,"SYNTAX","UNRECOGNISED"))}}catch(q){d.push({line:null==
b?0:b.loc.start.line,character:null===b?0:b.loc.start.column,reason:"Unnexpected Syntax"})}}f.functionDecls={concatenate:{min:"0",max:"*",av:"a"},split:{min:"2",max:"4",av:"a"},guid:{min:"0",max:"1",av:"a"},today:{min:"0",max:"0",av:"a"},now:{min:"0",max:"0",av:"a"},timestamp:{min:"0",max:"0",av:"a"},day:{min:"1",max:"1",av:"a"},month:{min:"1",max:"1",av:"a"},year:{min:"1",max:"1",av:"a"},hour:{min:"1",max:"1",av:"a"},second:{min:"1",max:"1",av:"a"},millisecond:{min:"1",max:"1",av:"a"},minute:{min:"1",
max:"1",av:"a"},weekday:{min:"1",max:"1",av:"a"},toutc:{min:"1",max:"1",av:"a"},tolocal:{min:"1",max:"1",av:"a"},date:{min:"0",max:"7",av:"a"},datediff:{min:"2",max:"3",av:"a"},dateadd:{min:"2",max:"3",av:"a"},trim:{min:"1",max:"1",av:"a"},text:{min:"1",max:"2",av:"a"},left:{min:"2",max:"2",av:"a"},right:{min:"2",max:"2",av:"a"},mid:{min:"2",max:"3",av:"a"},upper:{min:"1",max:"1",av:"a"},proper:{min:"1",max:"2",av:"a"},lower:{min:"1",max:"1",av:"a"},find:{min:"2",max:"3",av:"a"},iif:{min:"3",max:"3",
av:"a"},decode:{min:"2",max:"*",av:"a"},when:{min:"2",max:"*",av:"a"},defaultvalue:{min:"2",max:"2",av:"a"},isempty:{min:"1",max:"1",av:"a"},maplayer:{min:"2",max:"3",av:"f"},domaincode:{min:"3",max:"4",av:"a"},domainname:{min:"2",max:"4",av:"a"},polygon:{min:"1",max:"1",av:"a"},point:{min:"1",max:"1",av:"a"},polyline:{min:"1",max:"1",av:"a"},extent:{min:"1",max:"1",av:"a"},multipoint:{min:"1",max:"1",av:"a"},geometry:{min:"1",max:"1",av:"a"},featurelayer:{min:"1",max:"3",av:"f"},featurecollection:{min:"1",
max:"1",av:"f"},buffer:{min:"2",max:"4",av:"f"},area:{min:"1",max:"2",av:"f"},sumarea:{min:"1",max:"2",av:"f"},length:{min:"1",max:"2",av:"f"},sumlength:{min:"1",max:"2",av:"f"},count:{min:"0",max:"*",av:"a"},filter:{min:"2",max:"2",av:"f"},envelopeintersects:{min:"2",max:"2",av:"f"},intersects:{min:"2",max:"2",av:"f"},contains:{min:"2",max:"2",av:"f"},overlaps:{min:"2",max:"2",av:"f"},within:{min:"2",max:"2",av:"f"},touches:{min:"2",max:"2",av:"f"},crosses:{min:"2",max:"2",av:"f"},union:{min:"1",
max:"2",av:"f",fmin:1},difference:{min:"2",max:"2",av:"f",fmin:2,fmax:3},intersection:{min:"2",max:"2",av:"f",fmin:2,fmax:3},symmetricdifference:{min:"2",max:"2",av:"f",fmin:2,fmax:3},number:{min:"1",max:"2",av:"a"},acos:{min:"1",max:"1",av:"a"},asin:{min:"1",max:"1",av:"a"},atan:{min:"1",max:"1",av:"a"},atan2:{min:"2",max:"2",av:"a"},ceil:{min:"1",max:"2",av:"a"},floor:{min:"1",max:"2",av:"a"},round:{min:"1",max:"2",av:"a"},cos:{min:"1",max:"1",av:"a"},exp:{min:"1",max:"1",av:"a"},log:{min:"1",max:"1",
av:"a"},min:{min:"0",max:"*",av:"a"},max:{min:"0",max:"*",av:"a"},pow:{min:"2",max:"2",av:"a"},random:{min:"0",max:"0",av:"a"},sqrt:{min:"1",max:"1",av:"a"},sin:{min:"1",max:"1",av:"a"},tan:{min:"1",max:"1",av:"a"},abs:{min:"1",max:"1",av:"a"},isnan:{min:"1",max:"1",av:"a"},stdev:{min:"0",max:"*",av:"a"},average:{min:"0",max:"*",av:"a"},mean:{min:"0",max:"*",av:"a"},sum:{min:"0",max:"*",av:"a"},variance:{min:"0",max:"*",av:"a"},distinct:{min:"0",max:"*",av:"a"},addfield:{min:"3",max:"3",av:"f"},removefield:{min:"2",
max:"2",av:"f"},aggregate:{min:"3",max:"3",av:"f"},dissolve:{min:"2",max:"3",av:"f"},changeshape:{min:"2",max:"4",av:"f"},first:{min:"1",max:"1",av:"a"},top:{min:"2",max:"2",av:"a"},orderby:{min:"2",max:"2",av:"f"},"boolean":{min:"1",max:"1",av:"a"},dictionary:{min:"0",max:"*",av:"a"},servicearea:{min:"2",max:"*",av:"f"},equals:{min:"2",max:"2",av:"a"},"typeof":{min:"1",max:"1",av:"a"},reverse:{min:"1",max:"1",av:"a"},replace:{min:"3",max:"4",av:"a"},sort:{min:"1",max:"2",av:"a"},feature:{min:"1",
max:"*",av:"a"},centroid:{min:"1",max:"1",av:"f"},multiparttosinglepart:{min:"1",max:"1",av:"f"}};f.checkFunctionSignature=a;f.findFunction=l;f.validateLanguageNode=k;f.testValidityOfExpression=h;f.referencesMemberImpl=q;f.referencesMember=function(b,c){return!0===q(b.body[0].body,c)?!0:!1};f.referencesFunctionImpl=m;f.referencesFunction=function(b,c){return!0===m(b.body[0].body,c)?!0:!1};f.findFieldLiteralsImpl=g;f.findFieldLiterals=function(b,c){return g(b.body[0].body,c)};f.extractFunctionDeclaration=
e;f.validateFunction=c;f.constructGlobalScope=d;f.validateScript=function(b,c,a){void 0===a&&(a="full");c={globalScope:d(c.vars,f.functionDecls,c.customFunctions,a),localScope:null};return h(b.body[0].body,c)};f.validateLanguage=function(b){return"BlockStatement"!==b.body[0].body.type?"Invalid formula content.":k(b.body[0].body)};f.nodeErrorMessage=r;f.makeError=u;f.extractAllIssuesInFunction=s;f.extractAllIssues=t;f.checkScript=function(b,c,a,e){void 0===e&&(e="full");var g=[];if("BlockStatement"!==
b.body[0].body.type)return[{line:0,character:0,reason:"Invalid Body"}];if(null===c||void 0===c)c={vars:{},customFunctions:[]};c={globalScope:d(c.vars,f.functionDecls,c.customFunctions,e),localScope:null};try{t(b.body[0].body,c,a,g)}catch(h){}return g}})},"esri/arcade/Dictionary":function(){define(["require","exports","./languageUtils","../geometry/Geometry","./ImmutableArray"],function(p,f,a,l,k){return function(){function f(a){this.attributes=null;this.plain=!1;this.immutable=!0;this.attributes=
a instanceof f?a.attributes:void 0===a?{}:null===a?{}:a}f.prototype.field=function(a){var f=a.toLowerCase();a=this.attributes[a];if(void 0!==a)return a;for(var g in this.attributes)if(g.toLowerCase()===f)return this.attributes[g];throw Error("Field not Found");};f.prototype.setField=function(a,f){if(this.immutable)throw Error("Dictionary is Immutable");var g=a.toLowerCase();if(void 0===this.attributes[a])for(var e in this.attributes)if(e.toLowerCase()===g){this.attributes[e]=f;return}this.attributes[a]=
f};f.prototype.hasField=function(a){var f=a.toLowerCase();if(void 0!==this.attributes[a])return!0;for(var g in this.attributes)if(g.toLowerCase()===f)return!0;return!1};f.prototype.keys=function(){var a=[],f;for(f in this.attributes)a.push(f);return a=a.sort()};f.prototype.castToText=function(){var f="",h;for(h in this.attributes){""!==f&&(f+=",");var g=this.attributes[h];null!=g&&(a.isBoolean(g)||a.isNumber(g)||a.isString(g)?f+=JSON.stringify(h)+":"+JSON.stringify(g):g instanceof l?f+=JSON.stringify(h)+
":"+a.toStringExplicit(g):g instanceof k?f+=JSON.stringify(h)+":"+a.toStringExplicit(g):g instanceof Array?f+=JSON.stringify(h)+":"+a.toStringExplicit(g):g instanceof Date?f+=JSON.stringify(h)+":"+JSON.stringify(g):null!==g&&"object"===typeof g&&void 0!==g.castToText&&(f+=JSON.stringify(h)+":"+g.castToText()))}return"{"+f+"}"};return f}()})},"esri/arcade/Feature":function(){define("require exports ../geometry/Geometry ../graphic ../geometry/jsonUtils ./Dictionary ./languageUtils ./ImmutableArray ../geometry/Point".split(" "),
function(p,f,a,l,k,h,q,m,g){return function(){function e(c,d,g){this._layer=this.attributes=this.geometry=null;this.immutable=!0;c instanceof e?(this.attributes=c.attributes,this.geometry=c.geometry,c._layer&&(this._layer=c._layer)):c instanceof l?(this.geometry=c.geometry,this.attributes=void 0===c.attributes?{}:null===c.attributes?{}:c.attributes,c._layer&&(this._layer=c._layer)):c instanceof h?(this.attributes=c.field("attributes"),null!==this.attributes&&(this.attributes=this.attributes instanceof
h?this.attributes.attributes:null),this.geometry=c.field("geometry"),null!==this.geometry&&(this.geometry instanceof h?this.geometry=e.parseGeometryFromDictionary(this.geometry):this.geometry instanceof a||(this.geometry=null))):(d instanceof a||null===d?(this.geometry=d,this.attributes=void 0===c?{}:null===c?{}:c):"string"===typeof c?(c=JSON.parse(c),null!==c.geometry&&void 0!==c.geometry&&(this.geometry=k.fromJson(c.geometry)),this.attributes=void 0===c.attributes?{}:null===c.attributes?{}:c.attributes):
(void 0===c?this.attributes={}:null===c&&(this.attributes={}),this.geometry=null),void 0!==g&&(this._layer=g))}e.prototype.castToText=function(){var c="",d;for(d in this.attributes){""!==c&&(c+=",");var e=this.attributes[d];null!=e&&(q.isBoolean(e)||q.isNumber(e)||q.isString(e)?c+=JSON.stringify(d)+":"+JSON.stringify(e):e instanceof a?c+=JSON.stringify(d)+":"+q.toStringExplicit(e):e instanceof m?c+=JSON.stringify(d)+":"+q.toStringExplicit(e):e instanceof Array?c+=JSON.stringify(d)+":"+q.toStringExplicit(e):
e instanceof Date?c+=JSON.stringify(d)+":"+JSON.stringify(e):null!==e&&"object"===typeof e&&void 0!==e.castToText&&(c+=JSON.stringify(d)+":"+e.castToText()))}return'{"geometry":'+(null===this.geometry?"null":q.toStringExplicit(this.geometry))+',"attributes":'+c+"}"};e.prototype._fixDateFields=function(c){for(var a=0;a<c.length;a++){var e=this.attributes[c[a]];if(null!==e)if(void 0===e)for(var g in this.attributes){if(g.toLowerCase()===c[a]){e=this.attributes[g];null!==e&&!(e instanceof Date)&&(this.attributes[g]=
new Date(e));break}}else e instanceof Date||(this.attributes[c[a]]=new Date(e))}};e.prototype.field=function(c){var a=c.toLowerCase();c=this.attributes[c];if(void 0!==c)return c;for(var e in this.attributes)if(e.toLowerCase()===a)return this.attributes[e];throw Error("Field not Found");};e.prototype._field=function(c){var a=c.toLowerCase();c=this.attributes[c];if(void 0!==c)return c;for(var e in this.attributes)if(e.toLowerCase()===a)return this.attributes[e];return null};e.prototype.setField=function(c,
a){if(this.immutable)throw Error("Feature is Immutable");if(!1===q.isSimpleType(a))throw Error("Illegal Value Assignment to Feature");var e=c.toLowerCase();if(void 0===this.attributes[c])for(var g in this.attributes)if(g.toLowerCase()===e){this.attributes[g]=a;return}this.attributes[c]=a};e.prototype.hasField=function(c){var a=c.toLowerCase();if(void 0!==this.attributes[c])return!0;for(var e in this.attributes)if(e.toLowerCase()===a)return!0;return!1};e.prototype.keys=function(){var c=[],a;for(a in this.attributes)c.push(a);
return c=c.sort()};e.fromFeature=function(c){return new e(c)};e.parseGeometryFromDictionary=function(c){c=e.convertDictionaryToJson(c,!0);void 0!==c.spatialreference&&(c.spatialReference=c.spatialreference,delete c.spatialreference);void 0!==c.rings&&(c.rings=this.fixPathArrays(c.rings,!0===c.hasZ,!0===c.hasM));void 0!==c.paths&&(c.paths=this.fixPathArrays(c.paths,!0===c.hasZ,!0===c.hasM));void 0!==c.points&&(c.points=this.fixPointArrays(c.points,!0===c.hasZ,!0===c.hasM));return k.fromJson(c)};e.fixPathArrays=
function(c,a,e){var g=[];if(c instanceof Array)for(var f=0;f<c.length;f++)g.push(this.fixPointArrays(c[f],a,e));else if(c instanceof m)for(f=0;f<c.length();f++)g.push(this.fixPointArrays(c.get(f),a,e));return g};e.fixPointArrays=function(c,a,e){var f=[];if(c instanceof Array)for(var h=0;h<c.length;h++){var t=c[h];t instanceof g?a&&e?f.push([t.x,t.y,t.z,t.m]):a?f.push([t.x,t.y,t.z]):e?f.push([t.x,t.y,t.m]):f.push([t.x,t.y]):f.push(t)}else if(c instanceof m)for(h=0;h<c.length();h++)t=c.get(h),t instanceof
g?a&&e?f.push([t.x,t.y,t.z,t.m]):a?f.push([t.x,t.y,t.z]):e?f.push([t.x,t.y,t.m]):f.push([t.x,t.y]):f.push(t);return f};e.convertDictionaryToJson=function(c,a){void 0===a&&(a=!1);var g={},f;for(f in c.attributes){var k=c.attributes[f];k instanceof h&&(k=e.convertDictionaryToJson(k));a?g[f.toLowerCase()]=k:g[f]=k}return g};e.parseAttributesFromDictionary=function(c){var a={},e;for(e in c.attributes){var g=c.attributes[e];if(q.isSimpleType(g))a[e]=g;else throw Error("Illegal Argument");}return a};e.fromJson=
function(c){var a=null;null!==c.geometry&&void 0!==c.geometry&&(a=k.fromJson(c.geometry));var g={};if(null!==c.attributes&&void 0!==c.attributes)for(var f in c.attributes){var h=c.attributes[f];if(q.isString(h)||q.isNumber(h)||q.isBoolean(h)||q.isDate(h))g[f]=h;else throw Error("Illegal Argument");}return new e(g,a)};e.prototype.domainValueLookup=function(c,a,e){if(null===this._layer||!this._layer.fields)return null;e=q.getDomain(c,this._layer,this,e);if(void 0===a)try{a=this.field(c)}catch(g){return null}return q.getDomainValue(e,
a)};e.prototype.domainCodeLookup=function(c,a,e){if(null===this._layer||!this._layer.fields)return null;c=q.getDomain(c,this._layer,this,e);return q.getDomainCode(c,a)};return e}()})},"esri/arcade/functions/date":function(){define(["require","exports","../../moment","../languageUtils"],function(p,f,a,l){function k(a){return null===a?a:isNaN(a.getTime())?null:a}f.registerFunctions=function(f,q){f.today=function(a,g){return q(a,g,function(a,c,d){l.pcCheck(d,0,0);a=new Date;a.setHours(0,0,0,0);return a})};
f.now=function(a,g){return q(a,g,function(a,c,d){l.pcCheck(d,0,0);return new Date})};f.timestamp=function(a,g){return q(a,g,function(a,c,d){l.pcCheck(d,0,0);a=new Date;return a=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())})};f.toutc=function(a,g){return q(a,g,function(a,c,d){l.pcCheck(d,1,1);a=l.toDate(d[0]);return null===a?null:new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),
a.getUTCSeconds(),a.getUTCMilliseconds())})};f.tolocal=function(f,g){return q(f,g,function(e,c,d){l.pcCheck(d,1,1);e=l.toDate(d[0]);return null===e?null:a.utc([e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()]).toDate()})};f.day=function(a,g){return q(a,g,function(a,c,d){l.pcCheck(d,1,1);a=l.toDate(d[0]);return null===a?NaN:a.getDate()})};f.month=function(a,g){return q(a,g,function(a,c,d){l.pcCheck(d,1,1);a=l.toDate(d[0]);return null===a?NaN:
a.getMonth()})};f.year=function(a,g){return q(a,g,function(a,c,d){l.pcCheck(d,1,1);a=l.toDate(d[0]);return null===a?NaN:a.getFullYear()})};f.hour=function(a,g){return q(a,g,function(a,c,d){l.pcCheck(d,1,1);a=l.toDate(d[0]);return null===a?NaN:a.getHours()})};f.second=function(a,g){return q(a,g,function(a,c,d){l.pcCheck(d,1,1);a=l.toDate(d[0]);return null===a?NaN:a.getSeconds()})};f.millisecond=function(a,g){return q(a,g,function(a,c,d){l.pcCheck(d,1,1);a=l.toDate(d[0]);return null===a?NaN:a.getMilliseconds()})};
f.minute=function(a,g){return q(a,g,function(a,c,d){l.pcCheck(d,1,1);a=l.toDate(d[0]);return null===a?NaN:a.getMinutes()})};f.weekday=function(a,g){return q(a,g,function(a,c,d){l.pcCheck(d,1,1);a=l.toDate(d[0]);return null===a?NaN:a.getDay()})};f.date=function(f,g){return q(f,g,function(e,c,d){l.pcCheck(d,0,7);if(3===d.length)return k(new Date(l.toNumber(d[0]),l.toNumber(d[1]),l.toNumber(d[2]),0,0,0,0));if(4===d.length)return k(new Date(l.toNumber(d[0]),l.toNumber(d[1]),l.toNumber(d[2]),l.toNumber(d[3]),
0,0,0));if(5===d.length)return k(new Date(l.toNumber(d[0]),l.toNumber(d[1]),l.toNumber(d[2]),l.toNumber(d[3]),l.toNumber(d[4]),0,0));if(6===d.length)return k(new Date(l.toNumber(d[0]),l.toNumber(d[1]),l.toNumber(d[2]),l.toNumber(d[3]),l.toNumber(d[4]),l.toNumber(d[5]),0));if(7===d.length)return k(new Date(l.toNumber(d[0]),l.toNumber(d[1]),l.toNumber(d[2]),l.toNumber(d[3]),l.toNumber(d[4]),l.toNumber(d[5]),l.toNumber(d[6])));if(2===d.length){e=l.toString(d[1]);if(""===e)return null;d=a(l.toString(d[0]),
e,!0);return!0===d.isValid()?d.toDate():null}if(1===d.length){if(l.isString(d[0])&&""===d[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))return null;e=l.toNumber(d[0]);return!1===isNaN(e)?k(new Date(e)):l.toDate(d[0])}if(0===d.length)return new Date})};f.datediff=function(a,g){return q(a,g,function(a,c,d){l.pcCheck(d,2,3);a=l.toDateM(d[0]);c=l.toDateM(d[1]);if(null===a||null===c)return NaN;switch(l.toString(d[2]).toLowerCase()){case "days":case "day":case "d":return a.diff(c,"days",!0);case "months":case "month":return a.diff(c,
"months",!0);case "minutes":case "minute":case "m":return"M"===d[2]?a.diff(c,"months",!0):a.diff(c,"minutes",!0);case "seconds":case "second":case "s":return a.diff(c,"seconds",!0);case "milliseconds":case "millisecond":case "ms":return a.diff(c);case "hours":case "hour":case "h":return a.diff(c,"hours",!0);case "years":case "year":case "y":return a.diff(c,"years",!0);default:return a.diff(c)}})};f.dateadd=function(a,g){return q(a,g,function(a,c,d){l.pcCheck(d,2,3);a=l.toDateM(d[0]);if(null===a)return null;
c="milliseconds";switch(l.toString(d[2]).toLowerCase()){case "days":case "day":case "d":c="days";break;case "months":case "month":c="months";break;case "minutes":case "minute":case "m":c="M"===d[2]?"months":"minutes";break;case "seconds":case "second":case "s":c="seconds";break;case "milliseconds":case "millisecond":case "ms":c="milliseconds";break;case "hours":case "hour":case "h":c="hours";break;case "years":case "year":case "y":c="years"}a.add(l.toNumber(d[1]),c);return a.toDate()})}}})},"esri/arcade/functions/string":function(){define(["require",
"exports","../languageUtils","../Feature"],function(p,f,a,l){f.registerFunctions=function(f,h){f.trim=function(f,k){return h(f,k,function(g,e,c){a.pcCheck(c,1,1);return a.toString(c[0]).trim()})};f.upper=function(f,k){return h(f,k,function(g,e,c){a.pcCheck(c,1,1);return a.toString(c[0]).toUpperCase()})};f.proper=function(f,k){return h(f,k,function(g,e,c){a.pcCheck(c,1,2);g=1;2===c.length&&"firstword"===a.toString(c[1]).toLowerCase()&&(g=2);e=/\s/;c=a.toString(c[0]);for(var d="",f=!0,h=0;h<c.length;h++){var k=
c[h];e.test(k)?1===g&&(f=!0):k.toUpperCase()!==k.toLowerCase()&&(f?(k=k.toUpperCase(),f=!1):k=k.toLowerCase());d+=k}return d})};f.lower=function(f,k){return h(f,k,function(g,e,c){a.pcCheck(c,1,1);return a.toString(c[0]).toLowerCase()})};f.guid=function(f,k){return h(f,k,function(g,e,c){a.pcCheck(c,0,1);if(0<c.length)switch(a.toString(c[0]).toLowerCase()){case "digits":return a.generateUUID().replace("-","").replace("-","").replace("-","").replace("-","");case "digits-hyphen":return a.generateUUID();
case "digits-hyphen-parentheses":return"("+a.generateUUID()+")"}return"{"+a.generateUUID()+"}"})};f.mid=function(f,k){return h(f,k,function(g,e,c){a.pcCheck(c,2,3);g=a.toNumber(c[1]);if(isNaN(g))return"";0>g&&(g=0);if(2===c.length)return a.toString(c[0]).substr(g);e=a.toNumber(c[2]);if(isNaN(e))return"";0>e&&(e=0);return a.toString(c[0]).substr(g,e)})};f.find=function(f,k){return h(f,k,function(g,e,c){a.pcCheck(c,2,3);g=0;if(2<c.length){g=a.toNumber(a.defaultUndefined(c[2],0));if(isNaN(g))return-1;
0>g&&(g=0)}return a.toString(c[1]).indexOf(a.toString(c[0]),g)})};f.left=function(f,k){return h(f,k,function(g,e,c){a.pcCheck(c,2,2);g=a.toNumber(c[1]);if(isNaN(g))return"";0>g&&(g=0);return a.toString(c[0]).substr(0,g)})};f.right=function(f,k){return h(f,k,function(g,e,c){a.pcCheck(c,2,2);g=a.toNumber(c[1]);if(isNaN(g))return"";0>g&&(g=0);return a.toString(c[0]).substr(-1*g,g)})};f.split=function(f,k){return h(f,k,function(g,e,c){a.pcCheck(c,2,4);g=a.toNumber(a.defaultUndefined(c[2],-1));-1===g||
null===g?g=a.toString(c[0]).split(a.toString(c[1])):(isNaN(g)&&(g=-1),-1>g&&(g=-1),g=a.toString(c[0]).split(a.toString(c[1]),g));c=a.defaultUndefined(c[3],!1);if(!1===a.isBoolean(c))throw Error("Invalid Parameter");if(!1===c)return g;c=[];for(e=0;e<g.length;e++)""!==g[e]&&void 0!==g[e]&&c.push(g[e]);return c})};f.text=function(f,k){return h(f,k,function(g,e,c){a.pcCheck(c,1,2);return a.toStringExplicit(c[0],c[1])})};f.concatenate=function(f,k){return h(f,k,function(g,e,c){g=[];if(1>c.length)return"";
if(a.isArray(c[0])){e=a.defaultUndefined(c[2],"");for(var d=0;d<c[0].length;d++)g[d]=a.toStringExplicit(c[0][d],e);return 1<c.length?g.join(c[1]):g.join("")}if(a.isImmutableArray(c[0])){e=a.defaultUndefined(c[2],"");for(d=0;d<c[0].length();d++)g[d]=a.toStringExplicit(c[0].get(d),e);return 1<c.length?g.join(c[1]):g.join("")}for(d=0;d<c.length;d++)g[d]=a.toStringExplicit(c[d]);return g.join("")})};f.reverse=function(f,k){return h(f,k,function(g,e,c){a.pcCheck(c,1,1);if(a.isArray(c[0]))return g=c[0].slice(0),
g.reverse(),g;if(a.isImmutableArray(c[0]))return g=c[0].toArray().slice(0),g.reverse(),g;throw Error("Invalid Parameter");})};f.replace=function(f,k){return h(f,k,function(g,e,c){a.pcCheck(c,3,4);g=a.toString(c[0]);e=a.toString(c[1]);var d=a.toString(c[2]);return(4===c.length?a.toBoolean(c[3]):1)?a.multiReplace(g,e,d):g.replace(e,d)})};f.domainname=function(f,k){return h(f,k,function(g,e,c){a.pcCheck(c,2,4);if(c[0]instanceof l)return c[0].domainValueLookup(a.toString(c[1]),c[2],void 0===c[3]?void 0:
a.toNumber(c[3]));throw Error("Invalid Parameter");})};f.domaincode=function(f,k){return h(f,k,function(g,e,c){a.pcCheck(c,3,4);if(c[0]instanceof l)return c[0].domainCodeLookup(a.toString(c[1]),c[2],void 0===c[3]?void 0:a.toNumber(c[3]));throw Error("Invalid Parameter");})}}})},"esri/arcade/functions/maths":function(){define(["require","exports","../languageUtils","dojo/number"],function(p,f,a,l){function k(a,f,k){if("undefined"===typeof k||0===+k)return Math[a](f);f=+f;k=+k;if(isNaN(f)||!("number"===
typeof k&&0===k%1))return NaN;f=f.toString().split("e");f=Math[a](+(f[0]+"e"+(f[1]?+f[1]-k:-k)));f=f.toString().split("e");return+(f[0]+"e"+(f[1]?+f[1]+k:k))}f.registerFunctions=function(f,q){f.number=function(f,g){return q(f,g,function(e,c,d){return q(f,g,function(c,d,e){a.pcCheck(e,1,2);c=e[0];return a.isNumber(c)?c:null===c?0:a.isDate(c)||a.isBoolean(c)||""===c||void 0===c?Number(c):a.isString(c)?void 0!==e[1]?(e=a.multiReplace(e[1],"\u2030",""),e=a.multiReplace(e,"\u00a4",""),l.parse(c,{pattern:e})):
Number(c.trim()):Number(c)})})};f.abs=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,1,1);return Math.abs(a.toNumber(d[0]))})};f.acos=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,1,1);return Math.acos(a.toNumber(d[0]))})};f.asin=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,1,1);return Math.asin(a.toNumber(d[0]))})};f.atan=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,1,1);return Math.atan(a.toNumber(d[0]))})};f.atan2=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,
2,2);return Math.atan2(a.toNumber(d[0]),a.toNumber(d[1]))})};f.ceil=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,1,2);return 2===d.length?(e=a.toNumber(d[1]),isNaN(e)&&(e=0),k("ceil",a.toNumber(d[0]),-1*e)):Math.ceil(a.toNumber(d[0]))})};f.round=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,1,2);return 2===d.length?(e=a.toNumber(d[1]),isNaN(e)&&(e=0),k("round",a.toNumber(d[0]),-1*e)):Math.round(a.toNumber(d[0]))})};f.floor=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,
1,2);return 2===d.length?(e=a.toNumber(d[1]),isNaN(e)&&(e=0),k("floor",a.toNumber(d[0]),-1*e)):Math.floor(a.toNumber(d[0]))})};f.cos=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,1,1);return Math.cos(a.toNumber(d[0]))})};f.isnan=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,1,1);return"number"===typeof d[0]&&isNaN(d[0])})};f.exp=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,1,1);return Math.exp(a.toNumber(d[0]))})};f.log=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,
1,1);return Math.log(a.toNumber(d[0]))})};f.pow=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,2,2);return Math.pow(a.toNumber(d[0]),a.toNumber(d[1]))})};f.random=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,0,0);return Math.random()})};f.sin=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,1,1);return Math.sin(a.toNumber(d[0]))})};f.sqrt=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,1,1);return Math.sqrt(a.toNumber(d[0]))})};f.tan=function(f,g){return q(f,g,function(e,
c,d){a.pcCheck(d,1,1);return Math.tan(a.toNumber(d[0]))})};f.defaultvalue=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,2,2);return null===d[0]||""===d[0]||void 0===d[0]?d[1]:d[0]})};f.isempty=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,1,1);return null===d[0]||""===d[0]||void 0===d[0]?!0:!1})};f["boolean"]=function(f,g){return q(f,g,function(e,c,d){a.pcCheck(d,1,1);return a.toBoolean(d[0])})}}})},"esri/arcade/functions/geometry":function(){define("require exports ../../geometry/Geometry ../../geometry/Polygon ../../geometry/Polyline ../../geometry/Point ../../geometry/Extent ../../geometry/Multipoint ../../geometry/jsonUtils ../languageUtils ../Dictionary ../Feature".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d){f.registerFunctions=function(f,u){f.polygon=function(a,f){return u(a,f,function(b,f,n){e.pcCheck(n,1,1);b=null;if(n[0]instanceof c){if(b=e.fixSpatialReference(d.parseGeometryFromDictionary(n[0]),a.spatialReference),!1===b instanceof l)throw Error("Illegal Parameter");}else b=n[0]instanceof l?g.fromJson(n[0].toJson()):e.fixSpatialReference(new l(JSON.parse(n[0])),a.spatialReference);if(null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return b})};f.polyline=function(a,f){return u(a,f,function(b,f,n){e.pcCheck(n,1,1);b=null;if(n[0]instanceof c){if(b=e.fixSpatialReference(d.parseGeometryFromDictionary(n[0]),a.spatialReference),!1===b instanceof k)throw Error("Illegal Parameter");}else b=n[0]instanceof k?g.fromJson(n[0].toJson()):e.fixSpatialReference(new k(JSON.parse(n[0])),a.spatialReference);if(null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return b})};f.point=function(a,f){return u(a,f,function(b,f,n){e.pcCheck(n,1,1);b=null;if(n[0]instanceof c){if(b=e.fixSpatialReference(d.parseGeometryFromDictionary(n[0]),a.spatialReference),!1===b instanceof h)throw Error("Illegal Parameter");}else b=n[0]instanceof h?g.fromJson(n[0].toJson()):e.fixSpatialReference(new h(JSON.parse(n[0])),a.spatialReference);if(null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return b})};f.multipoint=function(a,f){return u(a,f,function(b,f,n){e.pcCheck(n,1,1);b=null;if(n[0]instanceof c){if(b=e.fixSpatialReference(d.parseGeometryFromDictionary(n[0]),a.spatialReference),!1===b instanceof m)throw Error("Illegal Parameter");}else b=n[0]instanceof m?g.fromJson(n[0].toJson()):e.fixSpatialReference(new m(JSON.parse(n[0])),a.spatialReference);if(null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return b})};f.extent=function(a,f){return u(a,f,function(b,f,n){e.pcCheck(n,1,1);b=null;n[0]instanceof c?b=e.fixSpatialReference(d.parseGeometryFromDictionary(n[0]),a.spatialReference):n[0]instanceof h?(b={xmin:n[0].x,ymin:n[0].y,xmax:n[0].x,ymax:n[0].y,spatialReference:n[0].spatialReference.toJson()},n[0].hasZ?(b.zmin=n[0].z,b.zmax=n[0].z):n[0].hasM&&(b.mmin=n[0].m,b.mmax=n[0].m),b=g.fromJson(b)):b=n[0]instanceof l?g.fromJson(n[0].getExtent().toJson()):n[0]instanceof k?g.fromJson(n[0].getExtent().toJson()):
n[0]instanceof m?g.fromJson(n[0].getExtent().toJson()):n[0]instanceof q?g.fromJson(n[0].toJson()):e.fixSpatialReference(new q(JSON.parse(n[0])),a.spatialReference);if(null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return b})};f.geometry=function(a,f){return u(a,f,function(b,f,n){e.pcCheck(n,1,1);b=null;b=n[0]instanceof d?e.fixSpatialReference(n[0].geometry,a.spatialReference):
n[0]instanceof c?e.fixSpatialReference(d.parseGeometryFromDictionary(n[0]),a.spatialReference):e.fixSpatialReference(g.fromJson(JSON.parse(n[0])),a.spatialReference);if(null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return b})};f.feature=function(g,f){return u(g,f,function(b,f,n){if(0===n.length)throw Error("Missing Parameters");b=null;if(1===n.length)if(e.isString(n[0]))b=
d.fromJson(JSON.parse(n[0]));else if(n[0]instanceof d)b=new d(n[0]);else if(n[0]instanceof a)b=new d(null,n[0]);else if(n[0]instanceof c)b=n[0].hasField("geometry")?n[0].field("geometry"):null,f=n[0].hasField("attributes")?n[0].field("attributes"):null,null!==b&&b instanceof c&&(b=d.parseGeometryFromDictionary(b)),null!==f&&(f=d.parseAttributesFromDictionary(f)),b=new d(f,b);else throw Error("Illegal Argument");else{if(2===n.length){f=b=null;if(null!==n[0])if(n[0]instanceof a)b=n[0];else if(b instanceof
c)b=d.parseGeometryFromDictionary(n[0]);else throw Error("Illegal Argument");if(null!==n[1])if(n[1]instanceof c)f=d.parseAttributesFromDictionary(n[1]);else throw Error("Illegal Argument");}else{b=null;f={};if(null!==n[0])if(n[0]instanceof a)b=n[0];else if(b instanceof c)b=d.parseGeometryFromDictionary(n[0]);else throw Error("Illegal Argument");for(var h=1;h<n.length;h+=2){var r=e.toString(n[h]),k=n[h+1];if(null===k||void 0===k||e.isString(k)||isNaN(k)||e.isDate(k)||e.isNumber(k)||e.isBoolean(k)){if(e.isFunctionParameter(k)||
!1===e.isSimpleType(k))throw Error("Illegal Argument");f[r]=k===e.voidOperation?null:k}else throw Error("Illegal Argument");}}b=new d(f,b)}b.geometry=e.fixSpatialReference(b.geometry,g.spatialReference);b.immutable=!1;return b})};f.dictionary=function(a,d){return u(a,d,function(b,a,d){if(0===d.length)throw Error("Missing Parameters");if(0!==d.length%2)throw Error("Missing Parameters");b={};for(a=0;a<d.length;a+=2){var g=e.toString(d[a]),f=d[a+1];if(null===f||void 0===f||e.isString(f)||isNaN(f)||e.isDate(f)||
e.isNumber(f)||e.isBoolean(f)){if(e.isFunctionParameter(f))throw Error("Illegal Argument");b[g]=f===e.voidOperation?null:f}else throw Error("Illegal Argument");}d=new c(b);d.immutable=!1;return d})}}})},"esri/arcade/functions/stats":function(){define(["require","exports","../languageUtils","./fieldStats"],function(p,f,a,l){function k(f,k,m,g){if(1===g.length){if(a.isArray(g[0]))return l.calculateStat(f,g[0],-1);if(a.isImmutableArray(g[0]))return l.calculateStat(f,g[0].toArray(),-1)}return l.calculateStat(f,
g,-1)}f.registerFunctions=function(f,l){f.stdev=function(a,g){return l(a,g,function(a,c,d){return k("stdev",a,c,d)})};f.variance=function(a,g){return l(a,g,function(a,c,d){return k("variance",a,c,d)})};f.average=function(a,g){return l(a,g,function(a,c,d){return k("mean",a,c,d)})};f.mean=function(a,g){return l(a,g,function(a,c,d){return k("mean",a,c,d)})};f.sum=function(a,g){return l(a,g,function(a,c,d){return k("sum",a,c,d)})};f.min=function(a,g){return l(a,g,function(a,c,d){return k("min",a,c,d)})};
f.max=function(a,g){return l(a,g,function(a,c,d){return k("max",a,c,d)})};f.distinct=function(a,g){return l(a,g,function(a,c,d){return k("distinct",a,c,d)})};f.count=function(f,g){return l(f,g,function(e,c,d){a.pcCheck(d,1,1);if(a.isArray(d[0])||a.isString(d[0]))return d[0].length;if(a.isImmutableArray(d[0]))return d[0].length();throw Error("Invalid Parameters for Count");})}}})},"esri/arcade/functions/fieldStats":function(){define(["require","exports","../languageUtils"],function(p,f,a){function l(a){for(var f=
0,k=0;k<a.length;k++)f+=a[k];return f/a.length}function k(a){for(var f=l(a),k=0,g=0;g<a.length;g++)k+=Math.pow(f-a[g],2);return k/a.length}f.decodeStatType=function(a){switch(a.toLowerCase()){case "distinct":return"distinct";case "avg":case "mean":return"avg";case "min":return"min";case "sum":return"sum";case "max":return"max";case "stdev":case "stddev":return"stddev";case "var":case "variance":return"var";case "count":return"count"}return""};f.calculateStat=function(f,q,m){void 0===m&&(m=1E3);switch(f.toLowerCase()){case "distinct":a:{f=
m;m=[];for(var g={},e=[],c=0;c<q.length;c++){if(void 0!==q[c]&&null!==q[c]&&q[c]!==a.voidOperation){var d=q[c];if(a.isNumber(d)||a.isString(d))void 0===g[d]&&(m.push(d),g[d]=1);else{for(var r=!1,u=0;u<e.length;u++)!0===a.equalityTest(e[u],d)&&(r=!0);!1===r&&(e.push(d),m.push(d))}}if(m.length>=f&&-1!==f){q=m;break a}}q=m}return q;case "avg":case "mean":return l(a.toNumberArray(q));case "min":return Math.min.apply(Math,a.toNumberArray(q));case "sum":q=a.toNumberArray(q);for(m=f=0;m<q.length;m++)f+=
q[m];return f;case "max":return Math.max.apply(Math,a.toNumberArray(q));case "stdev":case "stddev":return Math.sqrt(k(a.toNumberArray(q)));case "var":case "variance":return k(a.toNumberArray(q));case "count":return q.length}return 0}})},"esri/arcade/parser":function(){define(["require","exports","./treeAnalysis","./lib/esprima"],function(p,f,a,l){f.parseScript=function(f){f=l.parse("function _() { "+f+"\n}");if(null===f.body||void 0===f.body)throw Error("No formula provided.");if(0===f.body.length)throw Error("No formula provided.");
if(0===f.body.length)throw Error("No formula provided.");if("BlockStatement"!==f.body[0].body.type)throw Error("Invalid formula content.");var h=a.validateLanguage(f);if(""!==h)throw Error(h);return f};f.scriptCheck=function(f,h,q,m){var g=[];try{var e=l.parse("function _() { "+f+"\n}",{tolerant:!0,loc:!0}),c=e.errors;if(0<c.length)for(var d=0;d<c.length;d++)g.push({line:c[d].lineNumber,character:c[d].column,reason:c[d].description});var r=a.checkScript(e,h,q,m);for(h=0;h<r.length;h++)g.push(r[h])}catch(u){try{"Unexpected token }"===
u.description&&(u.index=("function _() { "+f+"\n}").length-1)?g.push({line:u.lineNumber,character:u.column,reason:"Unexpected end of script"}):g.push({line:u.lineNumber,character:u.column,reason:u.description})}catch(s){}}return g};f.extractFieldLiterals=function(f,h){void 0===h&&(h=!1);return a.findFieldLiterals(f,h)};f.validateScript=function(f,h,l){void 0===l&&(l="full");return a.validateScript(f,h,l)};f.referencesMember=function(f,h){return a.referencesMember(f,h)};f.referencesFunction=function(f,
h){return a.referencesFunction(f,h)}})},"esri/arcade/lib/esprima":function(){(function(p,f){"function"===typeof define&&define.amd?define(["exports"],f):"undefined"!==typeof exports?f(exports):f(p.esprima={})})(this,function(p){function f(b,a){if(!b)throw Error("ASSERT: "+a);}function a(b){return 48<=b&&57>=b}function l(b){return 0<="0123456789abcdefABCDEF".indexOf(b)}function k(b){return 0<="01234567".indexOf(b)}function h(b){return 10===b||13===b||8232===b||8233===b}function q(b){return 36===b||
95===b||65<=b&&90>=b||97<=b&&122>=b||92===b||128<=b&&wa.NonAsciiIdentifierStart.test(String.fromCharCode(b))}function m(b){return 36===b||95===b||65<=b&&90>=b||97<=b&&122>=b||48<=b&&57>=b||92===b||128<=b&&wa.NonAsciiIdentifierPart.test(String.fromCharCode(b))}function g(b){switch(b){default:return!1}}function e(b){if(fa&&g(b))return!0;b=b.toLowerCase();switch(b.length){case 2:return"if"===b||"in"===b;case 3:return"var"===b||"for"===b;case 4:return"else"===b;case 5:return"break"===b;case 6:return"return"===
b;case 8:return"function"===b.toLowerCase()||"continue"===b;default:return!1}}function c(b,a,c,d,e){f("number"===typeof c,"Comment must have valid position");Z.lastCommentStart>=c||(Z.lastCommentStart=c,b={type:b,value:a},N.range&&(b.range=[c,d]),N.loc&&(b.loc=e),N.comments.push(b),N.attachComment&&(N.leadingComments.push(b),N.trailingComments.push(b)))}function d(b){var a,d,e;a=D-b;for(d={start:{line:ba,column:D-da-b}};D<ja;)if(e=S.charCodeAt(D),++D,h(e)){N.comments&&(b=S.slice(a+b,D-1),d.end={line:ba,
column:D-da-1},c("Line",b,a,D-1,d));13===e&&10===S.charCodeAt(D)&&++D;++ba;da=D;return}N.comments&&(b=S.slice(a+b,D),d.end={line:ba,column:D-da},c("Line",b,a,D,d))}function r(){var b,a;for(a=0===D;D<ja;)if(b=S.charCodeAt(D),32===b||9===b||11===b||12===b||160===b||5760<=b&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(b))++D;else if(h(b))++D,13===b&&10===S.charCodeAt(D)&&++D,++ba,da=D,a=!0;else if(47===b)if(b=S.charCodeAt(D+1),47===b)++D,++D,d(2),
a=!0;else if(42===b){++D;++D;a:{var e=b=void 0,g=void 0,g=void 0;N.comments&&(b=D-2,e={start:{line:ba,column:D-da-2}});for(;D<ja;)if(g=S.charCodeAt(D),h(g))13===g&&10===S.charCodeAt(D+1)&&++D,++ba,++D,da=D,D>=ja&&G();else{if(42===g&&47===S.charCodeAt(D+1)){++D;++D;N.comments&&(g=S.slice(b+2,D-2),e.end={line:ba,column:D-da},c("Block",g,b,D,e));break a}++D}G()}}else break;else if(a&&45===b)if(45===S.charCodeAt(D+1)&&62===S.charCodeAt(D+2))D+=3,d(3);else break;else if(60===b)if("!--"===S.slice(D+1,D+
4))++D,++D,++D,++D,d(4);else break;else break}function u(b){var a,c,d=0;a="u"===b?4:2;for(b=0;b<a;++b)if(D<ja&&l(S[D]))c=S[D++],d=16*d+"0123456789abcdef".indexOf(c.toLowerCase());else return"";return String.fromCharCode(d)}function s(){var b,a;b=S.charCodeAt(D++);a=String.fromCharCode(b);92===b&&(117!==S.charCodeAt(D)&&G(),++D,b=u("u"),(!b||"\\"===b||!q(b.charCodeAt(0)))&&G(),a=b);for(;D<ja;){b=S.charCodeAt(D);if(!m(b))break;++D;a+=String.fromCharCode(b);92===b&&(a=a.substr(0,a.length-1),117!==S.charCodeAt(D)&&
G(),++D,b=u("u"),(!b||"\\"===b||!m(b.charCodeAt(0)))&&G(),a+=b)}return a}function t(){var b=D,a=S.charCodeAt(D),c,d=S[D];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++D,N.tokenize&&(40===a?N.openParenToken=N.tokens.length:123===a&&(N.openCurlyToken=N.tokens.length)),{type:R.Punctuator,value:String.fromCharCode(a),lineNumber:ba,lineStart:da,start:b,end:D};default:if(c=S.charCodeAt(D+1),61===c)switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return D+=
2,{type:R.Punctuator,value:String.fromCharCode(a)+String.fromCharCode(c),lineNumber:ba,lineStart:da,start:b,end:D};case 33:case 61:return D+=2,61===S.charCodeAt(D)&&++D,{type:R.Punctuator,value:S.slice(b,D),lineNumber:ba,lineStart:da,start:b,end:D}}}a=S.substr(D,4);if("\x3e\x3e\x3e\x3d"===a)return D+=4,{type:R.Punctuator,value:a,lineNumber:ba,lineStart:da,start:b,end:D};a=a.substr(0,3);if("\x3e\x3e\x3e"===a||"\x3c\x3c\x3d"===a||"\x3e\x3e\x3d"===a)return D+=3,{type:R.Punctuator,value:a,lineNumber:ba,
lineStart:da,start:b,end:D};a=a.substr(0,2);if(d===a[1]&&0<="+-\x3c\x3e\x26|".indexOf(d)||"\x3d\x3e"===a)return D+=2,{type:R.Punctuator,value:a,lineNumber:ba,lineStart:da,start:b,end:D};if(0<="\x3c\x3e\x3d!+-*%\x26|^/".indexOf(d))return++D,{type:R.Punctuator,value:d,lineNumber:ba,lineStart:da,start:b,end:D};G()}function b(){var b,c,d;d=S[D];f(a(d.charCodeAt(0))||"."===d,"Numeric literal must start with a decimal digit or a decimal point");c=D;b="";if("."!==d){b=S[D++];d=S[D];if("0"===b){if("x"===
d||"X"===d){++D;for(b="";D<ja&&l(S[D]);)b+=S[D++];0===b.length&&G();q(S.charCodeAt(D))&&G();return{type:R.NumericLiteral,value:parseInt("0x"+b,16),lineNumber:ba,lineStart:da,start:c,end:D}}if("b"===d||"B"===d){++D;for(d="";D<ja;){b=S[D];if("0"!==b&&"1"!==b)break;d+=S[D++]}0===d.length&&G();D<ja&&(b=S.charCodeAt(D),(q(b)||a(b))&&G());return{type:R.NumericLiteral,value:parseInt(d,2),lineNumber:ba,lineStart:da,start:c,end:D}}if("o"===d||"O"===d||k(d)){k(d)?(d=!0,b="0"+S[D++]):(d=!1,++D,b="");for(;D<
ja&&k(S[D]);)b+=S[D++];!d&&0===b.length&&G();(q(S.charCodeAt(D))||a(S.charCodeAt(D)))&&G();return{type:R.NumericLiteral,value:parseInt(b,8),octal:d,lineNumber:ba,lineStart:da,start:c,end:D}}d&&a(d.charCodeAt(0))&&G()}for(;a(S.charCodeAt(D));)b+=S[D++];d=S[D]}if("."===d){for(b+=S[D++];a(S.charCodeAt(D));)b+=S[D++];d=S[D]}if("e"===d||"E"===d){b+=S[D++];d=S[D];if("+"===d||"-"===d)b+=S[D++];if(a(S.charCodeAt(D)))for(;a(S.charCodeAt(D));)b+=S[D++];else G()}q(S.charCodeAt(D))&&G();return{type:R.NumericLiteral,
value:parseFloat(b),lineNumber:ba,lineStart:da,start:c,end:D}}function v(){W=null;r();K("Regular Expression language structures not supported")}function n(){r();v()}function w(){var b;b=N.tokens[N.tokens.length-1];if(!b)return n();if("Punctuator"===b.type){if("]"===b.value)return t();if(")"===b.value)return(b=N.tokens[N.openParenToken-1])&&"Keyword"===b.type&&("if"===b.value.toLowerCase()||"while"===b.value.toLowerCase()||"for"===b.value.toLowerCase()||"with"===b.value.toLowerCase())?n():t();if("}"===
b.value){if(N.tokens[N.openCurlyToken-3]&&"Keyword"===N.tokens[N.openCurlyToken-3].type){if(b=N.tokens[N.openCurlyToken-4],!b)return t()}else if(N.tokens[N.openCurlyToken-4]&&"Keyword"===N.tokens[N.openCurlyToken-4].type){if(b=N.tokens[N.openCurlyToken-5],!b)return n()}else return t();if(0<=Fa.indexOf(b.value))return t()}return n()}return"Keyword"===b.type&&"this"!==b.value?n():t()}function x(){var c;r();if(D>=ja)return{type:R.EOF,lineNumber:ba,lineStart:da,start:D,end:D};c=S.charCodeAt(D);if(q(c)){var d;
c=D;if(92===S.charCodeAt(D))d=s();else a:{var g;for(d=D++;D<ja;){g=S.charCodeAt(D);if(92===g){D=d;d=s();break a}if(m(g))++D;else break}d=S.slice(d,D)}return{type:1===d.length?R.Identifier:e(d)?R.Keyword:"null"===d.toLowerCase()?R.NullLiteral:"true"===d.toLowerCase()||"false"===d.toLowerCase()?R.BooleanLiteral:R.Identifier,value:d,lineNumber:ba,lineStart:da,start:c,end:D}}if(40===c||41===c||59===c)return t();if(39===c||34===c){var n="",v,z,x;g=!1;var y,p;y=ba;p=da;c=S[D];f("'"===c||'"'===c,"String literal must starts with a quote");
d=D;for(++D;D<ja;)if(v=S[D++],v===c){c="";break}else if("\\"===v)if(v=S[D++],!v||!h(v.charCodeAt(0)))switch(v){case "u":case "x":if("{"===S[D]){++D;z=v=z=void 0;z=S[D];v=0;for("}"===z&&G();D<ja;){z=S[D++];if(!l(z))break;v=16*v+"0123456789abcdef".indexOf(z.toLowerCase())}(1114111<v||"}"!==z)&&G();65535>=v?v=String.fromCharCode(v):(z=(v-65536>>10)+55296,v=String.fromCharCode(z,(v-65536&1023)+56320));n+=v}else x=D,(z=u(v))?n+=z:(D=x,n+=v);break;case "n":n+="\n";break;case "r":n+="\r";break;case "t":n+=
"\t";break;case "b":n+="\b";break;case "f":n+="\f";break;case "v":n+="\x0B";break;default:k(v)?(z="01234567".indexOf(v),0!==z&&(g=!0),D<ja&&k(S[D])&&(g=!0,z=8*z+"01234567".indexOf(S[D++]),0<="0123".indexOf(v)&&(D<ja&&k(S[D]))&&(z=8*z+"01234567".indexOf(S[D++]))),n+=String.fromCharCode(z)):n+=v}else++ba,"\r"===v&&"\n"===S[D]&&++D,da=D;else if(h(v.charCodeAt(0)))break;else n+=v;""!==c&&G();return{type:R.StringLiteral,value:n,octal:g,startLineNumber:y,startLineStart:p,lineNumber:ba,lineStart:da,start:d,
end:D}}return 46===c?a(S.charCodeAt(D+1))?b():t():a(c)?b():N.tokenize&&47===c?w():t()}function z(){var b,a,c;r();b={start:{line:ba,column:D-da}};a=x();b.end={line:ba,column:D-da};a.type!==R.EOF&&(c=S.slice(a.start,a.end),b={type:ya[a.type],value:c,range:[a.start,a.end],loc:b},a.regex&&(b.regex={pattern:a.regex.pattern,flags:a.regex.flags}),N.tokens.push(b));return a}function y(){var b;b=W;D=b.end;ba=b.lineNumber;da=b.lineStart;W="undefined"!==typeof N.tokens?z():x();D=b.end;ba=b.lineNumber;da=b.lineStart;
return b}function A(){var b,a,c;b=D;a=ba;c=da;W="undefined"!==typeof N.tokens?z():x();D=b;ba=a;da=c}function B(){this.line=ba;this.column=D-da}function F(){this.start=new B;this.end=null}function E(b){this.start=b.type===R.StringLiteral?{line:b.startLineNumber,column:b.start-b.startLineStart}:{line:b.lineNumber,column:b.start-b.lineStart};this.end=null}function H(){D=W.start;W.type===R.StringLiteral?(ba=W.startLineNumber,da=W.startLineStart):(ba=W.lineNumber,da=W.lineStart);N.range&&(this.range=[D,
0]);N.loc&&(this.loc=new F)}function I(b){N.range&&(this.range=[b.start,0]);N.loc&&(this.loc=new E(b))}function M(){var b,a,c,d;b=D;a=ba;c=da;r();d=ba!==a;D=b;ba=a;da=c;return d}function Q(b,a,c){var d=Error("Line "+b+": "+c);d.index=a;d.lineNumber=b;d.column=a-da+1;d.description=c;return d}function K(b){var a,c;a=Array.prototype.slice.call(arguments,1);c=b.replace(/%(\d)/g,function(b,c){f(c<a.length,"Message reference must be in range");return a[c]});throw Q(ba,D,c);}function J(b){var a,c;a=Array.prototype.slice.call(arguments,
1);c=b.replace(/%(\d)/g,function(b,c){f(c<a.length,"Message reference must be in range");return a[c]});c=Q(ba,D,c);if(N.errors)N.errors.push(c);else throw c;}function O(b,a){var c=ca.UnexpectedToken;b&&(c=a?a:b.type===R.EOF?ca.UnexpectedEOS:b.type===R.Identifier?ca.UnexpectedIdentifier:b.type===R.NumericLiteral?ca.UnexpectedNumber:b.type===R.StringLiteral?ca.UnexpectedString:ca.UnexpectedToken,b.type===R.Keyword&&fa&&g(b.value)&&(c=ca.StrictReservedWord));c=c.replace("%0",b?b.value:"ILLEGAL");return b&&
"number"===typeof b.lineNumber?Q(b.lineNumber,b.start,c):Q(ba,D,c)}function G(b,a){throw O(b,a);}function T(b,a){var c=O(b,a);if(N.errors)N.errors.push(c);else throw c;}function P(b){var a=y();(a.type!==R.Punctuator||a.value!==b)&&G(a)}function V(){var b;N.errors?(b=W,b.type===R.Punctuator&&","===b.value?y():b.type===R.Punctuator&&";"===b.value?(y(),T(b)):T(b,ca.UnexpectedToken)):P(",")}function L(b){var a=y();(a.type!==R.Keyword||a.value.toLowerCase()!==b.toLowerCase())&&G(a)}function C(b){return W.type===
R.Punctuator&&W.value===b}function X(b){return W.type===R.Keyword&&W.value.toLowerCase()===b.toLowerCase()}function Y(){var b;59===S.charCodeAt(D)||C(";")?y():(b=ba,r(),ba===b&&W.type!==R.EOF&&!C("}")&&G(W))}function la(b){return b.type===$.Identifier||b.type===$.MemberExpression}function aa(b,a){var c,d,e=new H;c=fa;d=ka();fa=c;return e.finishFunctionExpression(null,b,[],d)}function ga(){var b,a;b=fa;fa=!0;a=Qa();a=aa(a.params);fa=b;return a}function qa(){var b,a=new H;b=y();return b.type===R.StringLiteral||
b.type===R.NumericLiteral?(fa&&b.octal&&T(b,ca.StrictOctalLiteral),a.finishLiteral(b)):a.finishIdentifier(b.value)}function za(){var b,a,c,d=new H;b=W;if(b.type===R.Identifier)return a=qa(),"get"===b.value&&!C(":")&&!C("(")?(a=qa(),P("("),P(")"),b=aa([]),d.finishProperty("get",a,b,!1,!1)):"set"===b.value&&!C(":")&&!C("(")?(a=qa(),P("("),b=W,b.type!==R.Identifier?(P(")"),T(b),b=aa([])):(c=[Ka()],P(")"),b=aa(c,b)),d.finishProperty("set",a,b,!1,!1)):C(":")?(y(),b=ta(),d.finishProperty("init",a,b,!1,
!1)):C("(")?(b=ga(),d.finishProperty("init",a,b,!0,!1)):d.finishProperty("init",a,a,!1,!0);if(b.type===R.EOF||b.type===R.Punctuator)G(b);else{a=qa();if(C(":"))return y(),b=ta(),d.finishProperty("init",a,b,!1,!1);if(C("("))return b=ga(),d.finishProperty("init",a,b,!0,!1);G(y())}}function ia(b){var a=[],c,d,e={},g=String,f=new H;for(!0!==b&&P("{");!C("}");)b=za(),c=b.key.type===$.Identifier?b.key.name:g(b.key.value),d="init"===b.kind?Ma.Data:"get"===b.kind?Ma.Get:Ma.Set,c="$"+c,Object.prototype.hasOwnProperty.call(e,
c)?(e[c]===Ma.Data?fa&&d===Ma.Data?J(ca.StrictDuplicateProperty):d!==Ma.Data&&J(ca.AccessorDataProperty):d===Ma.Data?J(ca.AccessorDataProperty):e[c]&d&&J(ca.AccessorGetSet),e[c]|=d):e[c]=d,a.push(b),C("}")||V();P("}");return f.finishObjectExpression(a)}function oa(){var b,a,c,d;if(C("("))return P("("),C(")")?(y(),a=Sa.ArrowParameterPlaceHolder):(++Z.parenthesisCount,a=va(),P(")")),a;if(C("[")){a=[];var e=new H;for(P("[");!C("]");)C(",")?(y(),a.push(null)):(a.push(ta()),C("]")||P(","));y();return e.finishArrayExpression(a)}if(C("{"))return ia();
b=W.type;d=new H;if(b===R.Identifier)c=d.finishIdentifier(y().value);else if(b===R.StringLiteral||b===R.NumericLiteral)fa&&W.octal&&T(W,ca.StrictOctalLiteral),c=d.finishLiteral(y());else if(b===R.Keyword){if(X("function")){d=null;var f,h=[],r=[],k;b=new H;L("function");C("(")||(c=W,d=Ka(),!fa&&g(c.value)&&(a=c,e=ca.StrictReservedWord));f=Qa(a);h=f.params;r=f.defaults;c=f.stricted;a=f.firstRestricted;f.message&&(e=f.message);k=fa;f=ka();fa&&a&&G(a,e);fa&&c&&T(c,e);fa=k;return b.finishFunctionExpression(d,
h,r,f)}X("this")?(y(),c=d.finishThisExpression()):G(y())}else b===R.BooleanLiteral?(a=y(),a.value="true"===a.value.toLowerCase(),c=d.finishLiteral(a)):b===R.NullLiteral?(a=y(),a.value=null,c=d.finishLiteral(a)):C("/")||C("/\x3d")?(c="undefined"!==typeof N.tokens?d.finishLiteral(n()):d.finishLiteral(v()),A()):G(y());return c}function xa(){var b=[];P("(");if(!C(")"))for(;D<ja;){b.push(ta());if(C(")"))break;V()}P(")");return b}function sa(){P(".");var b,a=new H;b=y();b.type===R.Identifier||(b.type===
R.Keyword||b.type===R.BooleanLiteral||b.type===R.NullLiteral)||G(b);return a.finishIdentifier(b.value)}function ea(){var b;P("[");b=va();P("]");return b}function pa(){var b,a,c=new H;L("new");var d;f(Z.allowIn,"callee of new expression always allow in keyword.");d=W;for(b=X("new")?pa():oa();;)if(C("["))a=ea(),b=(new I(d)).finishMemberExpression("[",b,a);else if(C("."))a=sa(),b=(new I(d)).finishMemberExpression(".",b,a);else break;a=C("(")?xa():[];return c.finishNewExpression(b,a)}function Aa(){var b,
a,c=W,d,e=Z.allowIn;a=W;Z.allowIn=!0;for(b=X("new")?pa():oa();;)if(C("."))d=sa(),b=(new I(a)).finishMemberExpression(".",b,d);else if(C("("))d=xa(),b=(new I(a)).finishCallExpression(b,d);else if(C("["))d=ea(),b=(new I(a)).finishMemberExpression("[",b,d);else break;Z.allowIn=e;if(W.type===R.Punctuator&&(C("++")||C("--"))&&!M())la(b)||J(ca.InvalidLHSInAssignment),a=y(),b=(new I(c)).finishPostfixExpression(a.value,b);return b}function Da(){var b,a,c;W.type!==R.Punctuator&&W.type!==R.Keyword?a=Aa():C("++")||
C("--")?(c=W,b=y(),a=Da(),la(a)||J(ca.InvalidLHSInAssignment),a=(new I(c)).finishUnaryExpression(b.value,a)):C("+")||C("-")||C("~")||C("!")?(c=W,b=y(),a=Da(),a=(new I(c)).finishUnaryExpression(b.value,a)):X("delete")||X("void")||X("typeof")?(c=W,b=y(),a=Da(),a=(new I(c)).finishUnaryExpression(b.value,a),fa&&("delete"===a.operator&&a.argument.type===$.Identifier)&&J(ca.StrictDelete)):a=Aa();return a}function Ea(b,a){var c=0;if(b.type!==R.Punctuator&&b.type!==R.Keyword)return 0;switch(b.value){case "||":c=
1;break;case "\x26\x26":c=2;break;case "|":c=3;break;case "^":c=4;break;case "\x26":c=5;break;case "\x3d\x3d":case "!\x3d":case "\x3d\x3d\x3d":case "!\x3d\x3d":c=6;break;case "\x3c":case "\x3e":case "\x3c\x3d":case "\x3e\x3d":case "instanceof":c=7;break;case "in":c=a?7:0;break;case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":c=8;break;case "+":case "-":c=9;break;case "*":case "/":case "%":c=11}return c}function ua(){var b,a,c,d,e,g;b=W;a=Da();if(a===Sa.ArrowParameterPlaceHolder)return a;c=W;d=
Ea(c,Z.allowIn);if(0===d)return a;c.prec=d;y();b=[b,W];g=Da();for(e=[a,c,g];0<(d=Ea(W,Z.allowIn));){for(;2<e.length&&d<=e[e.length-2].prec;)g=e.pop(),c=e.pop().value,a=e.pop(),b.pop(),a=(new I(b[b.length-1])).finishBinaryExpression(c,a,g),e.push(a);c=y();c.prec=d;e.push(c);b.push(W);a=Da();e.push(a)}d=e.length-1;a=e[d];for(b.pop();1<d;)a=(new I(b.pop())).finishBinaryExpression(e[d-1].value,e[d-2],a),d-=2;return a}function Ca(b){var a,c,d,e,g,f,n;e=[];g=[];f=0;n={paramSet:{}};a=0;for(c=b.length;a<
c;a+=1)if(d=b[a],d.type===$.Identifier)e.push(d),g.push(null),$a(n,d,d.name);else if(d.type===$.AssignmentExpression)e.push(d.left),g.push(d.right),++f,$a(n,d.left,d.left.name);else return null;n.message===ca.StrictParamDupe&&(b=fa?n.stricted:n.firstRestricted,G(b,n.message));0===f&&(g=[]);return{params:e,defaults:g,rest:null,stricted:n.stricted,firstRestricted:n.firstRestricted,message:n.message}}function ta(){var b,a,c,d;b=Z.parenthesisCount;d=W;var e,g,f;f=W;a=ua();a!==Sa.ArrowParameterPlaceHolder&&
C("?")&&(y(),e=Z.allowIn,Z.allowIn=!0,g=ta(),Z.allowIn=e,P(":"),e=ta(),a=(new I(f)).finishConditionalExpression(a,g,e));if(a===Sa.ArrowParameterPlaceHolder||C("\x3d\x3e"))if(Z.parenthesisCount===b||Z.parenthesisCount===b+1)if(a.type===$.Identifier?c=Ca([a]):a.type===$.AssignmentExpression?c=Ca([a]):a.type===$.SequenceExpression?c=Ca(a.expressions):a===Sa.ArrowParameterPlaceHolder&&(c=Ca([])),c)return b=c,d=new I(d),P("\x3d\x3e"),c=fa,a=C("{")?ka():ta(),fa&&b.firstRestricted&&G(b.firstRestricted,b.message),
fa&&b.stricted&&T(b.stricted,b.message),fa=c,d.finishArrowFunctionExpression(b.params,b.defaults,a,a.type!==$.BlockStatement);W.type!==R.Punctuator?b=!1:(b=W.value,b="\x3d"===b||"*\x3d"===b||"/\x3d"===b||"%\x3d"===b||"+\x3d"===b||"-\x3d"===b||"\x3c\x3c\x3d"===b||"\x3e\x3e\x3d"===b||"\x3e\x3e\x3e\x3d"===b||"\x26\x3d"===b||"^\x3d"===b||"|\x3d"===b);b&&(la(a)||J(ca.InvalidLHSInAssignment),b=y(),c=ta(),a=(new I(d)).finishAssignmentExpression(b.value,a,c));return a}function va(){var b,a=W;b=ta();if(C(",")){for(b=
[b];D<ja&&C(",");)y(),b.push(ta());b=(new I(a)).finishSequenceExpression(b)}return b}function Ka(){var b,a=new H;b=y();b.type!==R.Identifier&&(fa&&b.type===R.Keyword&&g(b.value)?T(b,ca.StrictReservedWord):G(b));return a.finishIdentifier(b.value)}function Pa(b){var a=null,c,d=new H;c=Ka();"const"===b?(P("\x3d"),a=ta()):C("\x3d")&&(y(),a=ta());return d.finishVariableDeclarator(c,a)}function Za(b){var a=[];do{a.push(Pa(b));if(!C(","))break;y()}while(D<ja);return a}function Oa(b){var a=W.type,c,d;a===
R.EOF&&G(W);if(a===R.Punctuator&&"{"===W.value){if(b){P("{");var e=W;b=D;c=ba;d=da;y();a=C(":");W=e;D=b;ba=c;da=d;if((W.type===R.Identifier||W.type===R.StringLiteral)&&a)return ia(!0);b=new H;for(c=[];D<ja&&!C("}");){d=Wa();if("undefined"===typeof d)break;c.push(d)}P("}");return b.finishBlockStatement(c)}return ia()}b=new H;if(a===R.Punctuator)switch(W.value){case ";":return b=new H,P(";"),b.finishEmptyStatement();case "(":return c=va(),Y(),b.finishExpressionStatement(c)}else if(a===R.Keyword)switch(W.value.toLowerCase()){case "break":return c=
null,L("break"),59===S.charCodeAt(D)?(y(),!Z.inIteration&&!Z.inSwitch&&K(ca.IllegalBreak),b=b.finishBreakStatement(null)):M()?(!Z.inIteration&&!Z.inSwitch&&K(ca.IllegalBreak),b=b.finishBreakStatement(null)):(W.type===R.Identifier&&(c=Ka(),d="$"+c.name,Object.prototype.hasOwnProperty.call(Z.labelSet,d)||K(ca.UnknownLabel,c.name)),Y(),null===c&&(!Z.inIteration&&!Z.inSwitch)&&K(ca.IllegalBreak),b=b.finishBreakStatement(c)),b;case "continue":return c=null,L("continue"),59===S.charCodeAt(D)?(y(),Z.inIteration||
K(ca.IllegalContinue),b=b.finishContinueStatement(null)):M()?(Z.inIteration||K(ca.IllegalContinue),b=b.finishContinueStatement(null)):(W.type===R.Identifier&&(c=Ka(),d="$"+c.name,Object.prototype.hasOwnProperty.call(Z.labelSet,d)||K(ca.UnknownLabel,c.name)),Y(),null===c&&!Z.inIteration&&K(ca.IllegalContinue),b=b.finishContinueStatement(c)),b;case "for":var g,f,n;f=Z.allowIn;g=a=e=null;L("for");P("(");if(C(";"))y();else{if(X("var")){Z.allowIn=!1;var h=new H;g=y();n=Za();g=h.finishVariableDeclaration(n,
g.value);Z.allowIn=f;1===g.declarations.length&&X("in")&&(y(),c=g,d=va(),g=null)}else Z.allowIn=!1,g=va(),Z.allowIn=f,X("in")&&(la(g)||J(ca.InvalidLHSInForIn),y(),c=g,d=va(),g=null);"undefined"===typeof c&&P(";")}"undefined"===typeof c&&(C(";")||(a=va()),P(";"),C(")")||(e=va()));P(")");n=Z.inIteration;Z.inIteration=!0;f=Oa(!0);Z.inIteration=n;return"undefined"===typeof c?b.finishForStatement(g,a,e,f):b.finishForInStatement(c,d,f);case "function":return Va(b);case "if":return L("if"),P("("),c=va(),
P(")"),d=Oa(!0),X("else")?(y(),a=Oa(!0)):a=null,b.finishIfStatement(c,d,a);case "return":return c=null,L("return"),Z.inFunctionBody||J(ca.IllegalReturn),32===S.charCodeAt(D)&&q(S.charCodeAt(D+1))?(c=va(),Y(),b=b.finishReturnStatement(c)):M()?b=b.finishReturnStatement(null):(C(";")||!C("}")&&W.type!==R.EOF&&(c=va()),Y(),b=b.finishReturnStatement(c)),b;case "var":return L("var"),c=Za(),Y(),b.finishVariableDeclaration(c,"var")}c=va();if(c.type===$.Identifier&&C(":"))return y(),a="$"+c.name,Object.prototype.hasOwnProperty.call(Z.labelSet,
a)&&K(ca.Redeclaration,"Label",c.name),Z.labelSet[a]=!0,d=Oa(!1),delete Z.labelSet[a],b.finishLabeledStatement(c,d);Y();return b.finishExpressionStatement(c)}function ka(){var b,a=[],c,d,e,g,f,n=new H;for(P("{");D<ja&&W.type===R.StringLiteral;){c=W;b=Wa();a.push(b);if(b.expression.type!==$.Literal)break;b=S.slice(c.start+1,c.end-1);"use strict"===b?(fa=!0,d&&T(d,ca.StrictOctalLiteral)):!d&&c.octal&&(d=c)}c=Z.labelSet;d=Z.inIteration;e=Z.inSwitch;g=Z.inFunctionBody;f=Z.parenthesizedCount;Z.labelSet=
{};Z.inIteration=!1;Z.inSwitch=!1;Z.inFunctionBody=!0;for(Z.parenthesizedCount=0;D<ja&&!C("}");){b=Wa();if("undefined"===typeof b)break;a.push(b)}P("}");Z.labelSet=c;Z.inIteration=d;Z.inSwitch=e;Z.inFunctionBody=g;Z.parenthesizedCount=f;return n.finishBlockStatement(a)}function $a(b,a,c){var d="$"+c;fa?Object.prototype.hasOwnProperty.call(b.paramSet,d)&&(b.stricted=a,b.message=ca.StrictParamDupe):b.firstRestricted||(g(c)?(b.firstRestricted=a,b.message=ca.StrictReservedWord):Object.prototype.hasOwnProperty.call(b.paramSet,
d)&&(b.firstRestricted=a,b.message=ca.StrictParamDupe));b.paramSet[d]=!0}function Qa(b){b={params:[],defaultCount:0,defaults:[],firstRestricted:b};P("(");if(!C(")"))for(b.paramSet={};D<ja;){var a=b,c=void 0,d=void 0,e=void 0,c=W,d=Ka();$a(a,c,c.value);C("\x3d")&&(y(),e=ta(),++a.defaultCount);a.params.push(d);a.defaults.push(e);if(C(")"))break;P(",")}P(")");0===b.defaultCount&&(b.defaults=[]);return{params:b.params,defaults:b.defaults,stricted:b.stricted,firstRestricted:b.firstRestricted,message:b.message}}
function Va(){var b,a=[],c=[],d,e,f,n,h,r=new H;L("function");a=W;b=Ka();!fa&&g(a.value)&&(f=a,n=ca.StrictReservedWord);d=Qa(f);a=d.params;c=d.defaults;e=d.stricted;f=d.firstRestricted;d.message&&(n=d.message);h=fa;d=ka();fa&&f&&G(f,n);fa&&e&&T(e,n);fa=h;return r.finishFunctionDeclaration(b,a,c,d)}function Wa(){if(W.type===R.Keyword)switch(W.value){default:return"function"==W.value.toLowerCase()?Va():Oa(!1)}if(W.type!==R.EOF)return Oa(!1)}function Ia(){var b,a,c,d=[];for(b=0;b<N.tokens.length;++b)a=
N.tokens[b],c={type:a.type,value:a.value},a.regex&&(c.regex={pattern:a.regex.pattern,flags:a.regex.flags}),N.range&&(c.range=a.range),N.loc&&(c.loc=a.loc),d.push(c);N.tokens=d}var R,ya,Fa,$,Sa,Ma,ca,wa,S,fa,D,ba,da,ja,W,Z,N;R={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9};ya={};ya[R.BooleanLiteral]="Boolean";ya[R.EOF]="\x3cend\x3e";ya[R.Identifier]="Identifier";ya[R.Keyword]="Keyword";ya[R.NullLiteral]="Null";ya[R.NumericLiteral]=
"Numeric";ya[R.Punctuator]="Punctuator";ya[R.StringLiteral]="String";ya[R.RegularExpression]="RegularExpression";Fa="( { [ in typeof instanceof new return case delete throw void \x3d +\x3d -\x3d *\x3d /\x3d %\x3d \x3c\x3c\x3d \x3e\x3e\x3d \x3e\x3e\x3e\x3d \x26\x3d |\x3d ^\x3d , + - * / % ++ -- \x3c\x3c \x3e\x3e \x3e\x3e\x3e \x26 | ^ ! ~ \x26\x26 || ? : \x3d\x3d\x3d \x3d\x3d \x3e\x3d \x3c\x3d \x3c \x3e !\x3d !\x3d\x3d".split(" ");$={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",
BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",
Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator"};Sa={ArrowParameterPlaceHolder:{type:"ArrowParameterPlaceHolder"}};Ma={Data:1,Get:2,Set:4};ca={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",
UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",
NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",
StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",
StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"};wa={NonAsciiIdentifierStart:RegExp("[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0-\u08b2\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]"),
NonAsciiIdentifierPart:RegExp("[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0966-\u096f\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1ab0-\u1abd\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\ua9e0-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]")};
I.prototype=H.prototype={processComment:function(){var b,a,c,d=N.bottomRightStack,e,g,f=d[d.length-1];if(!(this.type===$.Program&&0<this.body.length)){if(0<N.trailingComments.length){c=[];for(e=N.trailingComments.length-1;0<=e;--e)g=N.trailingComments[e],g.range[0]>=this.range[1]&&(c.unshift(g),N.trailingComments.splice(e,1));N.trailingComments=[]}else f&&(f.trailingComments&&f.trailingComments[0].range[0]>=this.range[1])&&(c=f.trailingComments,delete f.trailingComments);if(f)for(;f&&f.range[0]>=
this.range[0];)b=f,f=d.pop();if(b)b.leadingComments&&b.leadingComments[b.leadingComments.length-1].range[1]<=this.range[0]&&(this.leadingComments=b.leadingComments,b.leadingComments=void 0);else if(0<N.leadingComments.length){a=[];for(e=N.leadingComments.length-1;0<=e;--e)g=N.leadingComments[e],g.range[1]<=this.range[0]&&(a.unshift(g),N.leadingComments.splice(e,1))}a&&0<a.length&&(this.leadingComments=a);c&&0<c.length&&(this.trailingComments=c);d.push(this)}},finish:function(){N.range&&(this.range[1]=
D);N.loc&&(this.loc.end=new B,N.source&&(this.loc.source=N.source));N.attachComment&&this.processComment()},finishArrayExpression:function(b){this.type=$.ArrayExpression;this.elements=b;this.finish();return this},finishAssignmentExpression:function(b,a,c){this.type=$.AssignmentExpression;this.operator=b;this.left=a;this.right=c;this.finish();return this},finishBinaryExpression:function(b,a,c){this.type="||"===b||"\x26\x26"===b?$.LogicalExpression:$.BinaryExpression;this.operator=b;this.left=a;this.right=
c;this.finish();return this},finishBlockStatement:function(b){this.type=$.BlockStatement;this.body=b;this.finish();return this},finishBreakStatement:function(b){this.type=$.BreakStatement;this.label=b;this.finish();return this},finishCallExpression:function(b,a){this.type=$.CallExpression;this.callee=b;this.arguments=a;this.finish();return this},finishConditionalExpression:function(b,a,c){this.type=$.ConditionalExpression;this.test=b;this.consequent=a;this.alternate=c;this.finish();return this},finishContinueStatement:function(b){this.type=
$.ContinueStatement;this.label=b;this.finish();return this},finishEmptyStatement:function(){this.type=$.EmptyStatement;this.finish();return this},finishExpressionStatement:function(b){this.type=$.ExpressionStatement;this.expression=b;this.finish();return this},finishForStatement:function(b,a,c,d){this.type=$.ForStatement;this.init=b;this.test=a;this.update=c;this.body=d;this.finish();return this},finishForInStatement:function(b,a,c){this.type=$.ForInStatement;this.left=b;this.right=a;this.body=c;
this.each=!1;this.finish();return this},finishFunctionDeclaration:function(b,a,c,d){this.type=$.FunctionDeclaration;this.id=b;this.params=a;this.defaults=c;this.body=d;this.rest=null;this.expression=this.generator=!1;this.finish();return this},finishFunctionExpression:function(b,a,c,d){this.type=$.FunctionExpression;this.id=b;this.params=a;this.defaults=c;this.body=d;this.rest=null;this.expression=this.generator=!1;this.finish();return this},finishIdentifier:function(b){this.type=$.Identifier;this.name=
b;this.finish();return this},finishIfStatement:function(b,a,c){this.type=$.IfStatement;this.test=b;this.consequent=a;this.alternate=c;this.finish();return this},finishLiteral:function(b){this.type=$.Literal;this.value=b.value;this.raw=S.slice(b.start,b.end);b.regex&&(this.regex=b.regex);this.finish();return this},finishMemberExpression:function(b,a,c){this.type=$.MemberExpression;this.computed="["===b;this.object=a;this.property=c;this.finish();return this},finishObjectExpression:function(b){this.type=
$.ObjectExpression;this.properties=b;this.finish();return this},finishPostfixExpression:function(b,a){this.type=$.UpdateExpression;this.operator=b;this.argument=a;this.prefix=!1;this.finish();return this},finishProgram:function(b){this.type=$.Program;this.body=b;this.finish();return this},finishProperty:function(b,a,c,d,e){this.type=$.Property;this.key=a;this.value=c;this.kind=b;this.method=d;this.shorthand=e;this.finish();return this},finishReturnStatement:function(b){this.type=$.ReturnStatement;
this.argument=b;this.finish();return this},finishUnaryExpression:function(b,a){this.type="++"===b||"--"===b?$.UpdateExpression:$.UnaryExpression;this.operator=b;this.argument=a;this.prefix=!0;this.finish();return this},finishVariableDeclaration:function(b,a){this.type=$.VariableDeclaration;this.declarations=b;this.kind=a;this.finish();return this},finishVariableDeclarator:function(b,a){this.type=$.VariableDeclarator;this.id=b;this.init=a;this.finish();return this}};p.version="2.0.0-dev";p.tokenize=
function(b,a){var c,d;c=String;"string"!==typeof b&&!(b instanceof String)&&(b=c(b));S=b;D=0;ba=0<S.length?1:0;da=0;ja=S.length;W=null;Z={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1};N={};a=a||{};a.tokens=!0;N.tokens=[];N.tokenize=!0;N.openParenToken=-1;N.openCurlyToken=-1;N.range="boolean"===typeof a.range&&a.range;N.loc="boolean"===typeof a.loc&&a.loc;"boolean"===typeof a.comment&&a.comment&&(N.comments=[]);"boolean"===typeof a.tolerant&&a.tolerant&&(N.errors=
[]);try{A();if(W.type===R.EOF)return N.tokens;for(y();W.type!==R.EOF;)try{y()}catch(e){if(N.errors){N.errors.push(e);break}else throw e;}Ia();d=N.tokens;"undefined"!==typeof N.comments&&(d.comments=N.comments);"undefined"!==typeof N.errors&&(d.errors=N.errors)}catch(g){throw g;}finally{N={}}return d};p.parse=function(b,a){var c,d;d=String;"string"!==typeof b&&!(b instanceof String)&&(b=d(b));S=b;D=0;ba=0<S.length?1:0;da=0;ja=S.length;W=null;Z={allowIn:!0,labelSet:{},parenthesisCount:0,inFunctionBody:!1,
inIteration:!1,inSwitch:!1,lastCommentStart:-1};N={};"undefined"!==typeof a&&(N.range="boolean"===typeof a.range&&a.range,N.loc="boolean"===typeof a.loc&&a.loc,N.attachComment="boolean"===typeof a.attachComment&&a.attachComment,N.loc&&(null!==a.source&&void 0!==a.source)&&(N.source=d(a.source)),"boolean"===typeof a.tokens&&a.tokens&&(N.tokens=[]),"boolean"===typeof a.comment&&a.comment&&(N.comments=[]),"boolean"===typeof a.tolerant&&a.tolerant&&(N.errors=[]),N.attachComment&&(N.range=!0,N.comments=
[],N.bottomRightStack=[],N.trailingComments=[],N.leadingComments=[]));try{var e;r();A();e=new H;fa=!1;var g;d=[];for(var f,n,h;D<ja;){f=W;if(f.type!==R.StringLiteral)break;g=Wa();d.push(g);if(g.expression.type!==$.Literal)break;n=S.slice(f.start+1,f.end-1);"use strict"===n?(fa=!0,h&&T(h,ca.StrictOctalLiteral)):!h&&f.octal&&(h=f)}for(;D<ja;){g=Wa();if("undefined"===typeof g)break;d.push(g)}c=e.finishProgram(d);"undefined"!==typeof N.comments&&(c.comments=N.comments);"undefined"!==typeof N.tokens&&
(Ia(),c.tokens=N.tokens);"undefined"!==typeof N.errors&&(c.errors=N.errors)}catch(k){throw k;}finally{N={}}return c};p.Syntax=function(){var b,a={};"function"===typeof Object.create&&(a=Object.create(null));for(b in $)$.hasOwnProperty(b)&&(a[b]=$[b]);"function"===typeof Object.freeze&&Object.freeze(a);return a}()})},"esri/renderers/UniqueValueRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ./arcadeUtils".split(" "),
function(p,f,a,l,k,h,q,m,g){return p(m,{declaredClass:"esri.renderer.UniqueValueRenderer",constructor:function(a,c,d,g,h){this.values=[];this._symbols={};this.infos=[];a&&!a.declaredClass?(c=a,this.defaultSymbol=(a=c.defaultSymbol)&&(a.declaredClass?a:q.fromJson(a)),this.attributeField=c.field1,this.attributeField2=c.field2,this.attributeField3=c.field3,this.fieldDelimiter=c.fieldDelimiter,this.defaultLabel=c.defaultLabel,this.setValueExpression(c.valueExpression),c.backgroundFillSymbol&&(this.backgroundFillSymbol=
q.fromJson(c.backgroundFillSymbol)),f.forEach(c.uniqueValueInfos,this._addValueInfo,this)):(this.defaultSymbol=a,this.attributeField=c,this.attributeField2=d,this.attributeField3=g,this.fieldDelimiter=h);this._multiple=!!this.attributeField2},addValue:function(e,c){var d=a.isObject(e)?e:{value:e,symbol:c};this._addValueInfo(d)},removeValue:function(a){var c=f.indexOf(this.values,a);-1!==c&&(this.values.splice(c,1),delete this._symbols[a],this.infos.splice(c,1))},getUniqueValueInfo:function(e){var c=
this.attributeField,d=e.attributes,f,h;this._exprTree?c=g.executeExpression(this._exprTree,g.createExecContext(e)):this._multiple?(e=this.attributeField2,f=this.attributeField3,h=[],c&&h.push(d[c]),e&&h.push(d[e]),f&&h.push(d[f]),c=h.join(this.fieldDelimiter||"")):c=a.isFunction(c)?c(e):d[c];return this._symbols[c]},setValueExpression:function(a){this.valueExpression=a;this._exprTree=g.parseExpression(a)},getSymbol:function(a){return(a=this.getUniqueValueInfo(a))&&a.symbol||this.defaultSymbol},_addValueInfo:function(a){var c=
a.value;this.values.push(c);this.infos.push(a);var d=a.symbol;d&&!d.declaredClass&&(a.symbol=q.fromJson(d));this._symbols[c]=a},toJson:function(){var e=h.fixJson,c;c={type:"uniqueValue",field1:this.attributeField,field2:this.attributeField2,field3:this.attributeField3,fieldDelimiter:this.fieldDelimiter,valueExpression:this.valueExpression,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),defaultLabel:this.defaultLabel,uniqueValueInfos:f.map(this.infos||[],function(c){c=a.mixin({},c);c.symbol=
c.symbol&&c.symbol.toJson();c.value+="";return e(c)})};this.backgroundFillSymbol&&(c.backgroundFillSymbol=this.backgroundFillSymbol.toJson());c=a.mixin(this.inherited(arguments),c);return e(c)}})})},"esri/renderers/ClassBreaksRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ./arcadeUtils".split(" "),function(p,f,a,l,k,h,q,m,g){return p(m,{declaredClass:"esri.renderer.ClassBreaksRenderer",constructor:function(a,
c){this.breaks=[];this._symbols={};this.infos=[];this.isMaxInclusive=!0;if(a&&!a.declaredClass){var d=a;this.attributeField=d.field;this.setValueExpression(d.valueExpression);this.defaultSymbol=(a=d.defaultSymbol)&&(a.declaredClass?a:q.fromJson(a));this.backgroundFillSymbol=(a=d.backgroundFillSymbol)&&(a.declaredClass?a:q.fromJson(a));this._copy(["defaultLabel","classificationMethod:rest","normalizationType:rest","normalizationField","normalizationTotal"],d,this);var g=d.minValue;(d=d.classBreakInfos)&&
(d[0]&&h.isDefined(d[0].classMaxValue))&&f.forEach(d,function(a){var c=a.classMaxValue;a.minValue=g;g=a.maxValue=c},this);f.forEach(d,this._addBreakInfo,this)}else this.defaultSymbol=a,this.attributeField=c},addBreak:function(e,c,d){e=a.isObject(e)?e:{minValue:e,maxValue:c,symbol:d};this._addBreakInfo(e)},removeBreak:function(a,c){var d,g=this.breaks,f,h=g.length,k=this._symbols;for(f=0;f<h;f++)if(d=g[f],d[0]==a&&d[1]==c){g.splice(f,1);delete k[a+"-"+c];this.infos.splice(f,1);break}},clearBreaks:function(){this.breaks=
[];this._symbols={};this.infos=[]},getBreakIndex:function(e){var c=this.attributeField,d=e.attributes,f=this.breaks,h=f.length,k=this.isMaxInclusive;if(this._exprTree)e=g.executeExpression(this._exprTree,g.createExecContext(e));else if(a.isFunction(c))e=c(e);else{e=parseFloat(d[c]);var c=this.normalizationType,t;if(c)if(t=parseFloat(this.normalizationTotal),d=parseFloat(d[this.normalizationField]),"log"===c)e=Math.log(e)*Math.LOG10E;else if("percent-of-total"===c&&!isNaN(t))e=100*(e/t);else if("field"===
c)if(!isNaN(e)&&!isNaN(d))e/=d;else return-1}if(null!=e&&!isNaN(e))for(d=0;d<h;d++)if(c=f[d],c[0]<=e&&(k?e<=c[1]:e<c[1]))return d;return-1},getBreakInfo:function(a){a=this.getBreakIndex(a);return-1!==a?this.infos[a]:null},getSymbol:function(a){return(a=this.breaks[this.getBreakIndex(a)])?this._symbols[a[0]+"-"+a[1]]:this.defaultSymbol},setMaxInclusive:function(a){this.isMaxInclusive=a},setValueExpression:function(a){this.valueExpression=a;this._exprTree=g.parseExpression(a)},_normalizationTypeEnums:[["field",
"esriNormalizeByField"],["log","esriNormalizeByLog"],["percent-of-total","esriNormalizeByPercentOfTotal"]],_classificationMethodEnums:[["natural-breaks","esriClassifyNaturalBreaks"],["equal-interval","esriClassifyEqualInterval"],["quantile","esriClassifyQuantile"],["standard-deviation","esriClassifyStandardDeviation"],["geometrical-interval","esriClassifyGeometricalInterval"]],_copy:function(a,c,d){f.forEach(a,function(a){var e=a.split(":"),g,f,b;1<e.length&&(a=e[0],g=this["_"+a+"Enums"],"rest"===
e[1]?(f="1",b="0"):"sdk"===e[1]&&(f="0",b="1"));e=c[a];if(void 0!==e&&(d[a]=e,g&&f)){var h,n=g.length;for(h=0;h<n;h++)if(g[h][f]===e){d[a]=g[h][b];break}}},this)},_addBreakInfo:function(a){var c=a.minValue,d=a.maxValue;this.breaks.push([c,d]);this.infos.push(a);var g=a.symbol;g&&!g.declaredClass&&(a.symbol=q.fromJson(g));this._symbols[c+"-"+d]=a.symbol},toJson:function(){var e=this.infos||[],c=h.fixJson,d=e[0]&&e[0].minValue,g=this.backgroundFillSymbol,e=a.mixin(this.inherited(arguments),{type:"classBreaks",
field:this.attributeField,valueExpression:this.valueExpression,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),backgroundFillSymbol:g&&g.toJson(),minValue:-Infinity===d?-Number.MAX_VALUE:d,classBreakInfos:f.map(e,function(d){d=a.mixin({},d);d.symbol=d.symbol&&d.symbol.toJson();d.classMaxValue=Infinity===d.maxValue?Number.MAX_VALUE:d.maxValue;delete d.minValue;delete d.maxValue;return c(d)})});this._copy(["defaultLabel","classificationMethod:sdk","normalizationType:sdk","normalizationField",
"normalizationTotal"],this,e);e.hasOwnProperty("normalizationType")&&!e.normalizationType&&delete e.normalizationType;e.hasOwnProperty("classificationMethod")&&!e.classificationMethod&&delete e.classificationMethod;return c(e)}})})},"esri/renderers/VectorFieldRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/_base/array ../kernel ../lang ../Color ./Renderer ./ClassBreaksRenderer ../symbols/SimpleMarkerSymbol ../symbols/PictureMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/jsonUtils require".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u){var s=p(m,{declaredClass:"esri.renderer.VectorFieldRenderer",iconFolderPath:"../images/symbol/sfs/",constructor:function(a){h.isDefined(a)||(a={});a.attributeField=a.attributeField||"Magnitude";a.rotationInfo=a.rotationInfo||this._getRotationInfo(a);p.safeMixin(this,a);this.style=this.style||s.STYLE_SINGLE_ARROW;this.singleArrowSymbol&&(this.singleArrowSymbol=this.singleArrowSymbol.declaredClass?this.singleArrowSymbol:r.fromJson(this.singleArrowSymbol));this.renderer=
new g(this._getDefaultSymbol(),a.attributeField);this._updateRenderer(this.style);this.flowRepresentation=this.flowRepresentation||this.FLOW_FROM},getSymbol:function(a){return this.renderer&&this.renderer.getSymbol(a)},setVisualVariables:function(a){a=l.filter(a,function(b){if("sizeInfo"===b.type)return h.isDefined(this._updateSizeInfo(b))},this);this.inherited(arguments);return this},setSizeInfo:function(a){this._updateSizeInfo(a);this.inherited(arguments);return this},setProportionalSymbolInfo:function(a){this.setSizeInfo(a);
return this},setColorInfo:function(a){return this},_updateRenderer:function(a){return!h.isDefined(this.renderer)?Error("Invalid Renderer!"):a===s.STYLE_SINGLE_ARROW?this._createSingleArrowRenderer():a===s.STYLE_BEAUFORT_KN?this._createBeaufortKnotsRenderer():a===s.STYLE_BEAUFORT_METER?this._createBeaufortMeterRenderer():a===s.STYLE_BEAUFORT_FEET?this._createBeaufortFeetRenderer():a===s.STYLE_BEAUFORT_MILE?this._createBeaufortMilesRenderer():a===s.STYLE_BEAUFORT_KM?this._createBeaufortKilometersRenderer():
a===s.STYLE_OCEAN_CURRENT_M?this._createCurrentMeterRenderer():a===s.STYLE_OCEAN_CURRENT_KN?this._createCurrentKnotsRenderer():a===s.STYLE_SCALAR?this._createSimpleScalarRenderer():a===s.STYLE_WIND_BARBS?this._createWindBarbsRenderer():this._createClassifiedArrowRenderer()},_updateSizeInfo:function(a){return a&&h.isDefined(a.minSize)&&h.isDefined(a.maxSize)&&h.isDefined(a.minDataValue)&&h.isDefined(a.maxDataValue)?(this.style===s.STYLE_WIND_BARBS&&(a.minSize=a.maxSize),a.field=a.field||"Magnitude",
a.type="sizeInfo",a):null},_createClassifiedArrowRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new q([56,168,0]));var a=[0,1E-6,3.5,7,10.5,14];if(h.isDefined(this.minDataValue)&&h.isDefined(this.maxDataValue)){var b=(this.maxDataValue-this.minDataValue)/5,a=[],c,d;d=this.minDataValue;for(c=0;6>c;c++)a[c]=d,d+=b}this._addBreaks(a,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]])},_createSingleArrowRenderer:function(){this.renderer.defaultSymbol=this.singleArrowSymbol||
this._getDefaultSymbol()},_createBeaufortMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new q([214,47,39]));this._addBreaks([0,0.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new q([214,47,39]));this._addBreaks([0,
1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]])},_createBeaufortFeetRenderer:function(){var a=[0,0.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];l.forEach(a,function(b,c){a[c]*=3.28084});this.renderer.defaultSymbol=this._getDefaultSymbol(new q([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],
[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortMilesRenderer:function(){var a=[0,0.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];l.forEach(a,function(b,c){a[c]*=2.23694});this.renderer.defaultSymbol=this._getDefaultSymbol(new q([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKilometersRenderer:function(){var a=
[0,0.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];l.forEach(a,function(b,c){a[c]*=3.6});this.renderer.defaultSymbol=this._getDefaultSymbol(new q([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createCurrentMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new q([177,177,177]));this._addBreaks([0,0.5,1,1.5,2],[[78,
26,153],[179,27,26],[202,128,26],[177,177,177]])},_createCurrentKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new q([177,177,177]));this._addBreaks([0,0.25,0.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]])},_createSimpleScalarRenderer:function(){this.renderer.defaultSymbol=new c({url:u.toUrl(this.iconFolderPath+"scalar.png"),height:20,width:20,type:"esriPMS",angle:0})},_createWindBarbsRenderer:function(){var a=
[],b,g;for(b=0;150>=b;b+=5)a.push(b);g="M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20;M25 0 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40;M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35;M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15 M25 10 M25 5 L17.5 7.5".split(";");
var f=new c({url:u.toUrl(this.iconFolderPath+"windbarb.png"),height:20,width:20,type:"esriPMS",angle:0});this.renderer.defaultSymbol=f;for(b=0;b<a.length-1;b++)0==b?this.renderer.addBreak({minValue:a[b],maxValue:a[b+1],symbol:f}):this.renderer.addBreak({minValue:a[b],maxValue:a[b+1],symbol:(new e).setPath(g[b]).setOutline((new d).setWidth(1.5)).setSize(20).setColor(new q([0,0,0,255]))})},_getDefaultSymbol:function(a){return(new e).setPath("M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z").setOutline((new d).setWidth(0)).setSize(20).setColor(a||
new q([0,92,230]))},_getRotationInfo:function(a){var b=a&&a.flowRepresentation||s.FLOW_FROM,c=a&&a.rotationField||"Direction",d=s.FLOW_FROM;return{field:function(a){a=a.attributes[c];return b===d?a:a+180},type:"geographic"}},_addBreaks:function(a,b){if(!h.isDefined(this.renderer))return Error("Invalid Renderer!");if(!a||!b||!a.length||!b.length||!(a.length>=b.length))return Error("AddBreaks: Input arguments break values and colors not valid");var c;for(c=0;c<b.length;c++)this.renderer.addBreak({minValue:a[c],
maxValue:a[c+1],symbol:this._getDefaultSymbol(new q(b[c]))})},toJson:function(){var a=f.mixin(this.inherited(arguments),{type:"vectorField",style:this.style,attributeField:this.attributeField,flowRepresentation:this.flowRepresentation});this.renderer&&(this.renderer.defaultSymbol&&this.style===s.STYLE_SINGLE_ARROW)&&(a.singleArrowSymbol=this.renderer.defaultSymbol.toJson());return h.fixJson(a)}});f.mixin(s,{STYLE_WIND_BARBS:"wind_speed",STYLE_SINGLE_ARROW:"single_arrow",STYLE_CLASSIFIED_ARROW:"classified_arrow",
STYLE_BEAUFORT_KN:"beaufort_kn",STYLE_BEAUFORT_METER:"beaufort_m",STYLE_BEAUFORT_MILE:"beaufort_mi",STYLE_BEAUFORT_FEET:"beaufort_ft",STYLE_BEAUFORT_KM:"beaufort_km",STYLE_OCEAN_CURRENT_M:"ocean_current_m",STYLE_OCEAN_CURRENT_KN:"ocean_current_kn",STYLE_SCALAR:"simple_scalar"},{FLOW_FROM:"flow_from",FLOW_TO:"flow_to"});return s})},"esri/renderers/DotDensityRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Renderer ../symbols/PictureFillSymbol ../geometry/ScreenPoint ../geometry/Point".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r){return p(e,{declaredClass:"esri.renderer.DotDensityRenderer",constructor:function(a){this.dotSize=a.dotSize||3;this.dotValue=a.dotValue;this.fields=a.fields;this.outline=a.outline;this.backgroundColor=a.backgroundColor;this.exactCount=a.exactCount||!0;this.dotShape=a.dotShape||"square";this.legendOptions=a.legendOptions;this._exactCountMinArea=1E4;this._currentMapScale=this._map=this._canvas=null;this._symbolMap={};this._currentGraphic=this._currentResolution=this._objectIdField=
null;this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1;window.CanvasRenderingContext2D||console.log("The DotDensityRenderer requires a Canvas enabled Browser.  IE8 and less does not support Canvas.")},getSymbol:function(a){var d,e;this._currentGraphic=a;if(!this._supportsCanvas)return null;this._map||(this._map=a.getLayer()._map,this._objectIdField=a.getLayer().objectIdField,this._currentMapScale=this._map.getScale(),this._currentResolution=this._map.extent.getWidth()/this._map.width,this._map.on("zoom-end",
f.hitch(this,function(b){this._currentMapScale=this._map.getScale();this._currentResolution=b.extent.getWidth()/this._map.width;this._symbolMap[this._currentMapScale]={}})));if(this._symbolMap[this._currentMapScale]&&this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]])return d=this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]],e=this._getShapeProperties(a),d.setOffset(e.dx,e.dy),d;d=this._generateFieldsCount(this.fields,a.attributes,this.dotValue);e=this._getShapeProperties(a);
d=new c(this._generateImageSrc(e.width,e.height,d,e.minXY,e.maxXY),this.outline,e.width,e.height);d.setOffset(e.dx,e.dy);this._symbolMap[this._currentMapScale]||(this._symbolMap[this._currentMapScale]={});return this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]]=d},_generateFieldsCount:function(a,c,d){var b,e;for(e=a.length-1;0<=e;e--)b=c[a[e].name]/d,a[e].numPoints=Math.round(b);return a},_getShapeProperties:function(a){var c,d,b,e;c=a.geometry.getExtent();c.contains(this._map.extent)&&
(c=this._map.extent);b=Math.ceil(c.getWidth()/this._currentResolution);e=Math.ceil(c.getHeight()/this._currentResolution);d=this._map.toScreen(new r(c.xmin,c.ymin,c.spatialReference));c=this._map.toScreen(new r(c.xmax,c.ymax,c.spatialReference));a=a.getLayer().getNode().getCTM();return{minXY:d,maxXY:c,dx:(d.x-a.e)%b,dy:(c.y-a.f)%e,width:b,height:e}},_generateImageSrc:function(a,c,d,b,e,g){var f=this.dotSize,h,r,k;this._canvas?(this._canvas.width=a,this._canvas.height=c):this._canvas=this._initCanvas(a,
c);h=this._canvas.getContext("2d");if(g=g||this.backgroundColor)h.fillStyle=g.toCss(!0),h.fillRect(0,0,a,c),h.fill();for(g=d.length-1;0<=g;g--){h.fillStyle=d[g].color.toCss(!0);for(r=d[g].numPoints-1;0<=r;r--)k=this._getRandomPoint(a,c,b,e),"square"===this.dotShape?h.fillRect(k.x,k.y,f,f):"circle"===this.dotShape&&(h.beginPath(),h.arc(k.x,k.y,f/2,0,2*Math.PI,!0)),h.fill()}return this._canvas.toDataURL()},_initCanvas:function(a,c){var d=l.create("canvas",{id:"canvas",width:a+"px",height:c+"px",style:"position: absolute; left: -10000px; top: 0px;"},
null);document.body.appendChild(d);return d},_getRandomInt:function(a,c){return Math.floor(Math.random()*(c-a+1)+a)},_getRandomPoint:function(a,c,e,b){var g={},f=this.outline&&this.outline.width?this.outline.width:0;if(!0===this.exactCount&&a*c>this._exactCountMinArea){do g.x=this._getRandomInt(e.x,b.x),g.y=this._getRandomInt(b.y,e.y),a=new d(g.x,g.y),a=this._checkPointShapeBounds(a,this.dotSize+f,this._currentGraphic.geometry),!0===a&&(g.x-=e.x,g.y-=b.y);while(!1===a)}else g.x=this._getRandomInt(0,
a),g.y=this._getRandomInt(0,c);return g},_checkPointShapeBounds:function(a,c,d){var b=null,b=!1,e=!0,g=0;do{switch(g){case 1:a.x+=c;break;case 2:a.y+=c;break;case 3:a.x-=c}b=this._map.toMap(a);b=d.contains(b);!1===b&&(e=!1);g+=1}while(3>=g&&!0===e);return b},setDotSize:function(a){0<a&&(this.dotSize=a)},setDotValue:function(a){0<a&&(this.dotValue=a)},setOutline:function(a){this.outline=a},setBackgroundColor:function(a){this.backgroundColor=a},toJson:function(){var c=f.mixin(this.inherited(arguments),
{type:"dotDensity",backgroundColor:g.toJsonColor(this.backgroundColor),dotShape:this.dotShape,dotSize:0<this.dotSize?h.px2pt(this.dotSize):0,dotValue:this.dotValue,fields:a.map(this.fields,function(a){return m.fixJson({color:g.toJsonColor(a.color),name:a.name})}),legendOptions:this.legendOptions&&m.fixJson({backgroundColor:g.toJsonColor(this.legendOptions.backgroundColor),dotCoverage:this.legendOptions.dotCoverage,outline:this.legendOptions.outline&&this.legendOptions.outline.toJson(),valueUnit:this.legendOptions.valueUnit}),
outline:this.outline&&this.outline.toJson()});return m.fixJson(c)}})})},"esri/renderers/ScaleDependentRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ./Renderer".split(" "),function(p,f,a,l,k,h,q){return p(q,{declaredClass:"esri.renderer.ScaleDependentRenderer",constructor:function(a){this.setRendererInfos(a&&a.rendererInfos||[])},setRendererInfos:function(a){this.rendererInfos=a;this._setRangeType();return this},getSymbol:function(a){var g=
this.getRendererInfo(a);return g&&g.renderer&&g.renderer.getSymbol(a)},getRendererInfo:function(a){a=a.getLayer().getMap();return"zoom"===this.rangeType?this.getRendererInfoByZoom(a.getZoom()):this.getRendererInfoByScale(a.getScale())},getRendererInfoByZoom:function(a){var g,e=this.rendererInfos,c,d=0;do g=e[d],a>=g.minZoom&&a<=g.maxZoom&&(c=g),d++;while(!c&&d<e.length);return c},getRendererInfoByScale:function(a){var g,e=this.rendererInfos,c,d=0,f,h,k,t;do g=e[d],f=g.minScale,h=g.maxScale,k=!f,t=
!h,!k&&a<=f&&(k=!0),!t&&a>=h&&(t=!0),k&&t&&(c=g),d++;while(!c&&d<e.length);return c},addRendererInfo:function(a){var g,e=0,c,d=this.rendererInfos,f=a.hasOwnProperty("minZoom")?"minZoom":"minScale",h=d.length;do{c=d[e];if(h===e||a[f]<c[f])d.splice(e,0,a),this._setRangeType(),g=!0;e++}while(!g&&e<h);return this},_setRangeType:function(){var a=this.rendererInfos;if(a=a&&a[0])this.rangeType=a.hasOwnProperty("minZoom")?"zoom":a.hasOwnProperty("minScale")?"scale":""},toJson:function(){if("zoom"===this.rangeType)return null;
var k=this.rendererInfos||[],g=k[0]&&k[0].minScale,k=a.mixin(this.inherited(arguments),{type:"scaleDependent",minScale:0<g?g:0,rendererInfos:f.map(k,function(a){return h.fixJson({maxScale:0<a.maxScale?a.maxScale:0,renderer:a.renderer&&a.renderer.toJson()})})});return h.fixJson(k)}})})},"esri/renderers/TimeClassBreaksAger":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has dojo/date ../kernel ../lang ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),function(p,f,a,
l,k,h,q,m,g,e){var c=p(e,{declaredClass:"esri.renderer.TimeClassBreaksAger",constructor:function(a,c){this.infos=a;this.timeUnits=c||"day";a.sort(function(a,c){return a.minAge<c.minAge?-1:a.minAge>c.minAge?1:0})},getAgedSymbol:function(a,c){var e=c.getLayer(),g=c.attributes,h=q.isDefined;a=m.fromJson(a.toJson());var b=e._map.timeExtent.endTime;if(!b)return a;var l=k.difference(new Date(g[e._startTimeField]),b,this.timeUnits);f.some(this.infos,function(b){if(l>=b.minAge&&l<=b.maxAge){var c=b.color,
e=b.size;b=b.alpha;c&&a.setColor(c);h(e)&&this._setSymbolSize(a,e);h(b)&&a.color&&(a.color.a=b);return!0}},this);return a},toJson:function(){var a={agerClassBreakInfos:[]},c,e,f;a.timeUnits=this._getRestUnits(this.timeUnits);for(c=0;c<this.infos.length;c+=1)e=this.infos[c],f={},f.oldestAge=Infinity===e.maxAge?null:e.maxAge,f.size=e.size,e.color&&(f.color=g.toJsonColor(e.color)),e.alpha&&(f.alpha=Math.round(255*e.alpha)),a.agerClassBreakInfos[c]=f;return a},_getRestUnits:function(a){var e="esriTimeUnitsDays";
switch(a){case c.UNIT_SECONDS:e="esriTimeUnitsSeconds";break;case c.UNIT_MILLISECONDS:e="esriTimeUnitsMilliseconds";break;case c.UNIT_HOURS:e="esriTimeUnitsHours";break;case c.UNIT_MINUTES:e="esriTimeUnitsMinutes";break;case c.UNIT_MONTHS:e="esriTimeUnitsMonths";break;case c.UNIT_WEEKS:e="esriTimeUnitsWeeks";break;case c.UNIT_YEARS:e="esriTimeUnitsYears"}return e}});a.mixin(c,{UNIT_DAYS:"day",UNIT_HOURS:"hour",UNIT_MILLISECONDS:"millisecond",UNIT_MINUTES:"minute",UNIT_MONTHS:"month",UNIT_SECONDS:"second",
UNIT_WEEKS:"week",UNIT_YEARS:"year"});return c})},"esri/renderers/SymbolAger":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(p,f,a,l){return p(null,{declaredClass:"esri.renderer.SymbolAger",getAgedSymbol:function(a,f){},_setSymbolSize:function(a,f){switch(a.type){case "simplemarkersymbol":a.setSize(f);break;case "picturemarkersymbol":a.setWidth(f);a.setHeight(f);break;case "simplelinesymbol":case "cartographiclinesymbol":a.setWidth(f);break;case "simplefillsymbol":case "picturefillsymbol":a.outline&&
a.outline.setWidth(f)}}})})},"esri/renderers/TimeRampAger":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has ../kernel ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),function(p,f,a,l,k,h,q,m){return p(m,{declaredClass:"esri.renderer.TimeRampAger",constructor:function(a,e,c){this.colorRange=a;this.sizeRange=e;this.alphaRange=c},getAgedSymbol:function(g,e){var c=e.getLayer(),d=e.attributes;g=h.fromJson(g.toJson());var f=c._map.timeExtent,k=f.startTime,f=f.endTime;
if(!k||!f)return g;k=k.getTime();f=f.getTime();c=new Date(d[c._startTimeField]);c=c.getTime();c<k&&(c=k);k=f===k?1:(c-k)/(f-k);if(c=this.sizeRange)d=c[0],f=c[1],c=Math.abs(f-d)*k,this._setSymbolSize(g,d<f?d+c:d-c);if(c=this.colorRange){var f=c[0],s=c[1],t=Math.round,d=new a,b=f.r,m=s.r,c=Math.abs(m-b)*k;d.r=t(b<m?b+c:b-c);b=f.g;m=s.g;c=Math.abs(m-b)*k;d.g=t(b<m?b+c:b-c);b=f.b;m=s.b;c=Math.abs(m-b)*k;d.b=t(b<m?b+c:b-c);f=f.a;s=s.a;c=Math.abs(s-f)*k;d.a=f<s?f+c:f-c;g.setColor(d)}d=g.color;if((c=this.alphaRange)&&
d)f=c[0],s=c[1],c=Math.abs(s-f)*k,d.a=f<s?f+c:f-c;return g},toJson:function(){var a={};this.sizeRange&&(a.sizeRange=this.sizeRange);this.colorRange&&(a.colorRange=[q.toJsonColor(this.colorRange[0]),q.toJsonColor(this.colorRange[1])]);this.alphaRange&&(a.alphaRange=[Math.round(255*this.alphaRange[0]),Math.round(255*this.alphaRange[1])]);return a}})})},"esri/renderers/TemporalRenderer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Renderer"],function(p,f,a,l,k){return p(k,
{declaredClass:"esri.renderer.TemporalRenderer",constructor:function(a,f,k,g){this.observationRenderer=a;this.latestObservationRenderer=f;this.trackRenderer=k;this.observationAger=g},getSymbol:function(a){var f=a.getLayer(),k=this.getObservationRenderer(a),g=k&&k.getSymbol(a),e=this.observationAger;f.timeInfo&&(f._map.timeExtent&&k===this.observationRenderer&&e&&g)&&(g=e.getAgedSymbol(g,a));return g},getObservationRenderer:function(a){return 0===a.getLayer()._getKind(a)?this.observationRenderer:this.latestObservationRenderer||
this.observationRenderer},toJson:function(){var a={type:"temporal"};a.observationRenderer=this.observationRenderer.toJson();this.latestObservationRenderer&&(a.latestObservationRenderer=this.latestObservationRenderer.toJson());this.trackRenderer&&(a.trackRenderer=this.trackRenderer.toJson());this.observationAger&&(a.observationAger=this.observationAger.toJson());return a}})})},"esri/renderers/HeatmapRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct ../sniff ../kernel ../lang ../symbols/PictureMarkerSymbol ../Color ./Renderer".split(" "),
function(p,f,a,l,k,h,q,m,g,e){return p([e],{declaredClass:"esri.renderer.HeatmapRenderer",colors:null,blurRadius:10,maxPixelIntensity:100,minPixelIntensity:0,field:null,fieldOffset:null,colorStops:null,constructor:function(a){(this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1)?("string"==typeof a&&(a=JSON.parse(a)),f.mixin(this,a),this._canvas=null,!this.colors&&!this.colorStops&&(this.colorStops=[{ratio:0,color:"rgba(255, 140, 0, 0)"},{ratio:0.75,color:"rgba(255, 140, 0, 1)"},{ratio:0.9,
color:"rgba(255, 0,   0, 1)"}]),this.gradient=this._generateGradient(this.colorStops||this.colors)):console.log("The HeatmapRenderer requires a Canvas enabled Browser.  IE8 and less does not support Canvas.")},getSymbol:function(a){if(!this._supportsCanvas)return!1;var d=a.attributes.imageData;a=a.attributes.size;if(!a)return null;var e=this._getContext(a[0],a[1]),g=e.getImageData(0,0,a[0],a[1]);window.ArrayBuffer&&d instanceof ArrayBuffer?d=window.Uint8ClampedArray?new Uint8ClampedArray(d):new Uint8Array(d):
d.BYTES_PER_ELEMENT&&1!==d.BYTES_PER_ELEMENT&&(d=window.Uint8ClampedArray?new Uint8ClampedArray(d.buffer):new Uint8Array(d.buffer));if(window.CanvasPixelArray&&g.data instanceof window.CanvasPixelArray)for(var f=g.data,h=f.length;h--;)f[h]=d[h];else g.data.set(d);e.putImageData(g,0,0);return new m(e.canvas.toDataURL(),a[0],a[1])},setColors:function(a){if(a&&(a instanceof Array||a.colors))this.gradient=this._generateGradient(a.colors||a),this.colors=a;return this},setColorStops:function(a){if(a&&(a instanceof
Array||a.colorStops))this.gradient=this._generateGradient(a.colorStops||a),this.colorStops=a;return this},setMaxPixelIntensity:function(a){this.maxPixelIntensity=a;return this},setMinPixelIntensity:function(a){this.minPixelIntensity=a;return this},setField:function(a){this.field=a;return this},setFieldOffset:function(a){this.fieldOffset=a;return this},setBlurRadius:function(a){this.blurRadius=a;return this},getStats:function(){},getHistogramData:function(){},toJson:function(){var c=f.mixin(this.inherited(arguments),
{type:"heatmap",blurRadius:this.blurRadius,colorStops:this._colorsToStops(this.colorStops||this.colors),maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity,field:this.field});null!=this.fieldOffset&&(c.fieldOffset=this.fieldOffset);a.forEach(c.colorStops,function(a){a.color=g.toJsonColor(a.color)});return q.fixJson(c)},_getContext:function(a,d){this._canvas?(this._canvas.width=a,this._canvas.height=d):this._canvas=this._initCanvas(a,d);return this._canvas.getContext("2d")},
_initCanvas:function(a,d){var e=l.create("canvas",{id:"hm_canvas-"+Math.floor(1E3*Math.random()),style:"position: absolute; left: -10000px; top: 0px;"},null);e.width=a;e.height=d;document.body.appendChild(e);return e},_generateGradient:function(a,d){d||(d=512);for(var e=this._colorsToStops(a),g=this._getContext(1,d||512),f=g.createLinearGradient(0,0,0,d),h=0,b;h<e.length;h++)b=e[h],f.addColorStop(b.ratio,b.color.toCss(!0));g.fillStyle=f;g.fillRect(0,0,1,d);return g.getImageData(0,0,1,d).data},_colorsToStops:function(c){var d=
[];if(!c[0])return d;if(null!=c[0].ratio)d=a.map(c,function(b){return{ratio:b.ratio,color:this._toColor(b.color)}},this);else if(null!=c[0].value){var e=Infinity,d=-Infinity,g=0,f;for(f=0;f<c.length;f++){var h=c[f].value;h<e&&(e=h);h>d&&(d=h)}g=d-e;this.maxPixelIntensity=d;this.minPixelIntensity=e;d=a.map(c,function(b){var a=b.value;b=this._toColor(b.color);return{value:a,ratio:(a-e)/g,color:b}},this)}else var b=c.length-1,d=a.map(c,function(a,c){return{color:this._toColor(a),ratio:c/b}},this);return d},
_toColor:function(a){!a.toRgba&&!a.declaredClass&&(a=new g(a));return a}})})},"esri/dijit/PopupTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-construct ../kernel ../InfoTemplate ../PopupInfo ./PopupRenderer".split(" "),function(p,f,a,l,k,h,q,m){return p([h,q],{declaredClass:"esri.dijit.PopupTemplate","-chains-":{constructor:"manual"},chartTheme:null,constructor:function(a,e){f.mixin(this,e);this.initialize(a,e)},getTitle:function(a){var e;this.info&&(e=this.titleHasRelatedFields?
"":this._getPopupValues(a,!0).title);return e||""},getContent:function(a){return this.info?(new m({template:this,graphic:a,chartTheme:this.chartTheme},l.create("div"))).domNode:""}})})},"esri/PopupInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/i18n dojo/has dojo/Deferred dojo/sniff dojo/promise/all ./lang ./kernel ./request ./tasks/query ./tasks/QueryTask ./tasks/StatisticDefinition dojo/i18n!dojo/cldr/nls/number".split(" "),function(p,f,a,l,k,h,
q,m,g,e,c,d,r,u,s,t){return p(null,{declaredClass:"esri.PopupInfo",initialize:function(b,c){if(b){f.mixin(this,c);this.info=b;this.title=this.getTitle;this.content=this.getContent;var d=this._fieldLabels={},e=this._fieldsMap={};b.fieldInfos&&a.forEach(b.fieldInfos,function(b){var a=b.fieldName.toLowerCase();d[a]=b.label;e[a]=b});this._relatedFieldPrefix="relationships/";this.titleHasRelatedFields=!!(b.title&&-1!==b.title.indexOf("{"+this._relatedFieldPrefix))}},toJson:function(){return l.fromJson(l.toJson(this.info))},
getTitle:function(){},getContent:function(){},getFieldInfo:function(b){var c;a.some(this.info&&this.info.fieldInfos,function(a){a.fieldName===b&&(c=a);return!!c});return c},getComponents:function(b){var c=this.info,d=new q,e,g;c.fieldInfos&&(g=a.filter(c.fieldInfos,function(b){return-1!==b.fieldName.indexOf(this._relatedFieldPrefix)},this));g&&0<g.length&&(e=this._getRelatedRecords({graphic:b,fieldsInfo:g}));e?e.always(f.hitch(this,function(){d.resolve(this._getPopupValues(b))})):d.resolve(this._getPopupValues(b));
return d.promise},getAttachments:function(b){var a=b.getLayer();b=b.attributes;if(this.info.showAttachments&&(a&&a.hasAttachments&&a.objectIdField)&&(b=b&&b[a.objectIdField]))return a.queryAttachmentInfos(b)},_getPopupValues:function(b,c){var d=this.info,g=b.getLayer(),h=f.clone(b.attributes)||{},k=f.clone(h),r=d.fieldInfos,t="",s="",m,l,u,q,p,Q=g&&g._getDateOpts&&g._getDateOpts().properties,Q=Q&&Q.slice(0),K={dateFormat:{properties:Q,formatter:"DateFormat"+this._insertOffset(this._dateFormats.shortDateShortTime)}};
if(this._relatedInfo)for(q in this._relatedInfo)if(this._relatedInfo.hasOwnProperty(q)){var J=this._relatedInfo[q],O=this._relatedLayersInfo[q];J&&(a.forEach(J.relatedFeatures,function(b){for(p in b.attributes)if(b.attributes.hasOwnProperty(p)&&"esriRelCardinalityOneToOne"===O.relation.cardinality){var a=this._toRelatedFieldName([O.relation.id,p]);h[a]=k[a]=b.attributes[p]}},this),a.forEach(J.relatedStatsFeatures,function(b){for(p in b.attributes)if(b.attributes.hasOwnProperty(p)){var a=this._toRelatedFieldName([O.relation.id,
p]);h[a]=k[a]=b.attributes[p]}},this))}r&&a.forEach(r,function(b){l=b.fieldName;var c=this._getLayerFieldInfo(g,l);c&&(l=b.fieldName=c.name);k[l]=this._formatValue(k[l],l,K);Q&&(b.format&&b.format.dateFormat)&&(b=a.indexOf(Q,l),-1<b&&Q.splice(b,1))},this);if(g){q=g.types;var G=(J=g.typeIdField)&&h[J];for(l in h)if(h.hasOwnProperty(l)&&-1===l.indexOf(this._relatedFieldPrefix)&&(u=h[l],e.isDefined(u))){var T=this._getDomainName(g,b,q,G,l,u);e.isDefined(T)?k[l]=T:l===J&&(T=this._getTypeName(g,b,u),e.isDefined(T)&&
(k[l]=T))}}d.title&&(t=this._processFieldsInLinks(this._fixTokens(d.title,g),h),t=f.trim(e.substitute(k,t,K)||""));if(c)return{title:t};d.description&&(s=this._processFieldsInLinks(this._fixTokens(d.description,g),h),s=f.trim(e.substitute(k,s,K)||""));r&&(m=[],a.forEach(r,function(b){(l=b.fieldName)&&b.visible&&m.push([b.label||l,e.substitute(k,"${"+l+"}",K)||""])}));var P,V;d.mediaInfos&&(P=[],a.forEach(d.mediaInfos,function(b){V=0;u=b.value;switch(b.type){case "image":var c=u.sourceURL,c=c&&f.trim(e.substitute(h,
this._fixTokens(c,g)));V=!!c;break;case "piechart":case "linechart":case "columnchart":case "barchart":var d,c=u.normalizeField;u.fields=a.map(u.fields,function(b){return(d=this._getLayerFieldInfo(g,b))?d.name:b},this);c&&(d=this._getLayerFieldInfo(g,c),u.normalizeField=d?d.name:c);V=a.some(u.fields,function(b){return e.isDefined(h[b])||-1!==b.indexOf(this._relatedFieldPrefix)&&this._relatedInfo},this);break;default:return}if(V){b=f.clone(b);u=b.value;var c=b.title?this._processFieldsInLinks(this._fixTokens(b.title,
g),h):"",n=b.caption?this._processFieldsInLinks(this._fixTokens(b.caption,g),h):"";b.title=c?f.trim(e.substitute(k,c,K)||""):"";b.caption=n?f.trim(e.substitute(k,n,K)||""):"";if("image"===b.type)u.sourceURL=e.substitute(h,this._fixTokens(u.sourceURL,g)),u.linkURL&&(u.linkURL=f.trim(e.substitute(h,this._fixTokens(u.linkURL,g))||""));else{var r,t;a.forEach(u.fields,function(b,a){if(-1!==b.indexOf(this._relatedFieldPrefix))t=this._getRelatedChartInfos(b,u,h,K),t instanceof Array?u.fields=t:u.fields[a]=
t;else{var c=h[b],c=void 0===c?null:c;r=h[u.normalizeField]||0;c&&r&&(c/=r);u.fields[a]={y:c,tooltip:(this._fieldLabels[b.toLowerCase()]||b)+":\x3cbr/\x3e"+this._formatValue(c,b,K,!!r)}}},this)}P.push(b)}},this));return{title:t,description:s,hasDescription:!!d.description,fields:m&&m.length?m:null,mediaInfos:P&&P.length?P:null,formatted:k,editSummary:g&&g.getEditSummary?g.getEditSummary(b):""}},_getRelatedChartInfos:function(b,c,d,e){var g,f,h,k,r,t;g=[];t=this._fromRelatedFieldName(b);r=t[0];f=this._relatedInfo[r];
r=this._relatedLayersInfo[r];f&&a.forEach(f.relatedFeatures,function(a){a=a.attributes;var f,r;for(r in a)if(a.hasOwnProperty(r)&&r===t[1]){f={};k=a[r];c.normalizeField&&(h=-1!==c.normalizeField.indexOf(this._relatedFieldPrefix)?a[this._fromRelatedFieldName(c.normalizeField)[1]]:d[c.normalizeField]);k&&h&&(k/=h);if(c.tooltipField)if(-1!==c.tooltipField.indexOf(this._relatedFieldPrefix)){var s=this._fromRelatedFieldName(c.tooltipField)[1];f.tooltip=a[s]&&"string"===typeof a[s]?a[s]+":\x3cbr/\x3e"+
this._formatValue(k,a[s],e,!!h):s+":\x3cbr/\x3e"+this._formatValue(k,s,e,!!h)}else f.tooltip=(this._fieldLabels[b.toLowerCase()]||b)+":\x3cbr/\x3e"+this._formatValue(k,c.tooltipField,e,!!h);else f.tooltip=k;f.y=k;g.push(f)}},this);return"esriRelCardinalityOneToMany"===r.relation.cardinality||"esriRelCardinalityManyToMany"===r.relation.cardinality?g:g[0]},_dateFormats:{shortDate:"(datePattern: 'M/d/y', selector: 'date')",shortDateLE:"(datePattern: 'd/M/y', selector: 'date')",longMonthDayYear:"(datePattern: 'MMMM d, y', selector: 'date')",
dayShortMonthYear:"(datePattern: 'd MMM y', selector: 'date')",longDate:"(datePattern: 'EEEE, MMMM d, y', selector: 'date')",shortDateShortTime:"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateLEShortTime:"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateShortTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLEShortTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",
shortDateLongTime:"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLELongTime:"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLongTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')",shortDateLELongTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')",longMonthYear:"(datePattern: 'MMMM y', selector: 'date')",shortMonthYear:"(datePattern: 'MMM y', selector: 'date')",
year:"(datePattern: 'y', selector: 'date')"},_reHref:/href\s*=\s*\"([^\"]+)\"/ig,_reHrefApos:/href\s*=\s*\'([^\']+)\'/ig,_fixTokens:function(b,a){var c=this;return b.replace(/(\{([^\{\r\n]+)\})/g,function(b,d,e){b=c._getLayerFieldInfo(a,e);return"$"+(b?"{"+b.name+"}":d)})},_encodeAttributes:function(b){b=f.clone(b)||{};var a,c;for(a in b)if((c=b[a])&&"string"===typeof c)c=encodeURIComponent(c).replace(/\'/g,"\x26apos;"),b[a]=c;return b},_processFieldsInLinks:function(b,a){var c=this._encodeAttributes(a),
d=this;b&&(b=b.replace(this._reHref,function(b,e){return d._addValuesToHref(b,e,a,c)}).replace(this._reHrefApos,function(b,e){return d._addValuesToHref(b,e,a,c)}));return b},_addValuesToHref:function(b,a,c,d){a=a&&f.trim(a);return e.substitute(a&&0===a.indexOf("${")?c:d,b)},_getLayerFieldInfo:function(b,a){return b&&b.getField?b.getField(a):null},_formatValue:function(b,c,d,g){var h=this._fieldsMap[c.toLowerCase()],k=h&&h.format;c=-1!==a.indexOf(d.dateFormat.properties,c);var r="number"===typeof b&&
!c&&(!k||!k.dateFormat);if(!e.isDefined(b)||!h||!e.isDefined(k))return r?this._forceLTR(b):b;var s="",h=[],m=k.hasOwnProperty("places")||k.hasOwnProperty("digitSeparator"),l=k.hasOwnProperty("digitSeparator")?k.digitSeparator:!0;if(m&&!c)s="NumberFormat",h.push("places: "+(e.isDefined(k.places)&&(!g||0<k.places)?Number(k.places):"Infinity")),h.length&&(s+="("+h.join(",")+")");else if(k.dateFormat)s="DateFormat"+this._insertOffset(this._dateFormats[k.dateFormat]||this._dateFormats.shortDateShortTime);
else return r?this._forceLTR(b):b;var u=this._applyFormatting(b,s,d);m&&-1<b.constructor.toString().indexOf("Array")&&(u="",a.forEach(b,f.hitch(this,function(b){u=u+this._applyFormatting(b,s,d)+" "})));m&&!l&&t.group&&(u=u.replace(RegExp("\\"+t.group,"g"),""));return r?this._forceLTR(u):u},_applyFormatting:function(b,a,c){return e.substitute({myKey:b},"${myKey:"+a+"}",c)||""},_forceLTR:function(b){var a=m("ie");return a&&10>=a?b:"\x3cspan class\x3d'esriNumericValue'\x3e"+b+"\x3c/span\x3e"},_insertOffset:function(b){b&&
(b=e.isDefined(this.utcOffset)?b.replace(/\)\s*$/,", utcOffset:"+this.utcOffset+")"):b);return b},_getDomainName:function(b,a,c,d,e,g){return(b=b.getDomain&&b.getDomain(e,{feature:a}))&&b.codedValues?b.getName(g):null},_getTypeName:function(b,a,c){return(b=b.getType&&b.getType(a))&&b.name},_getRelatedRecords:function(b){var a=b.graphic,c=new q,d;this._relatedLayersInfo?this._queryRelatedLayers(a).then(f.hitch(this,function(b){this._setRelatedRecords(a,b);c.resolve(b)}),f.hitch(this,this._handlerErrorResponse,
c)):this._getRelatedLayersInfo(b).then(f.hitch(this,function(b){for(d in b)b.hasOwnProperty(d)&&b[d]&&(this._relatedLayersInfo[d].relatedLayerInfo=b[d]);this._queryRelatedLayers(a).then(f.hitch(this,function(b){this._setRelatedRecords(a,b);c.resolve(b)}),f.hitch(this,this._handlerErrorResponse,c))}),f.hitch(this,this._handlerErrorResponse,c));return c.promise},_getRelatedLayersInfo:function(b){var c=b.fieldsInfo,e,f,h={};e=b.graphic.getLayer();this._relatedLayersInfo||(this._relatedLayersInfo={});
a.forEach(c,function(b){var c,d,g,f;c=this._fromRelatedFieldName(b.fieldName);d=c[0];c=c[1];d&&(this._relatedLayersInfo[d]||(a.some(e.relationships,function(b){if(b.id==d)return f=b,!0}),f&&(this._relatedLayersInfo[d]={relation:f,relatedFields:[],outStatistics:[]})),this._relatedLayersInfo[d]&&(this._relatedLayersInfo[d].relatedFields.push(c),b.statisticType&&(g=new s,g.statisticType=b.statisticType,g.onStatisticField=c,g.outStatisticFieldName=c,this._relatedLayersInfo[d].outStatistics.push(g))))},
this);for(f in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(f)&&this._relatedLayersInfo[f]&&(b=this._relatedLayersInfo[f].relation,b=e.url.replace(/[0-9]+$/,b.relatedTableId),this._relatedLayersInfo[f].relatedLayerUrl=b,h[f]=d({url:b,content:{f:"json"},callbackParamName:"callback"}));return g(h)},_queryRelatedLayers:function(b){var a={},c;for(c in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(c)&&(a[c]=this._queryRelatedLayer({graphic:b,relatedInfo:this._relatedLayersInfo[c]}));
return g(a)},_queryRelatedLayer:function(b){var c,d,e,f,h,k,t,s,m,l;c=b.graphic;d=c.getLayer().url.match(/[0-9]+$/g)[0];s=b.relatedInfo;t=s.relatedLayerInfo;m=s.relatedLayerUrl;l=s.relation;a.some(t.relationships,function(b){if(b.relatedTableId===parseInt(d,10))return e=b,!0},this);e&&(b=new r,a.some(t.fields,function(b){if(b.name===e.keyField)return h=-1!==a.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],b.type)?"number":"string",!0}),f="string"===
h?e.keyField+"\x3d'"+c.attributes[l.keyField]+"'":e.keyField+"\x3d"+c.attributes[l.keyField],b.where=f,b.outFields=s.relatedFields,s.outStatistics&&(0<s.outStatistics.length&&t.supportsStatistics)&&(k=new r,k.where=b.where,k.outFields=b.outFields,k.outStatistics=s.outStatistics),c=new u(m),f=[],f.push(c.execute(b)),k&&f.push(c.execute(k)));return g(f)},_setRelatedRecords:function(b,a){this._relatedInfo=[];for(var c in a)if(a.hasOwnProperty(c)&&a[c]){var d=a[c];this._relatedInfo[c]={};this._relatedInfo[c].relatedFeatures=
d[0].features;e.isDefined(d[1])&&(this._relatedInfo[c].relatedStatsFeatures=d[1].features)}},_handlerErrorResponse:function(b,a){b.reject(a)},_fromRelatedFieldName:function(b){var a=[];-1!==b.indexOf(this._relatedFieldPrefix)&&(b=b.split("/"),a=b.slice(1));return a},_toRelatedFieldName:function(b){var a="";b&&0<b.length&&(a=this._relatedFieldPrefix+b[0]+"/"+b[1]);return a}})})},"esri/tasks/QueryTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ../geometry/Extent ../geometry/normalizeUtils ./Task ./FeatureSet".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r){p=p(d,{declaredClass:"esri.tasks.QueryTask",_eventMap:{complete:["featureSet"],"execute-for-count-complete":["count"],"execute-for-ids-complete":["objectIds"],"execute-relationship-query-complete":["featureSets"]},constructor:function(a,c){this._handler=f.hitch(this,this._handler);this._relationshipQueryHandler=f.hitch(this,this._relationshipQueryHandler);this._executeForIdsHandler=f.hitch(this,this._executeForIdsHandler);this._countHandler=f.hitch(this,this._countHandler);
this._extentHandler=f.hitch(this,this._extentHandler);this.source=c&&c.source;this.gdbVersion=c&&c.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",c:4,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForIds",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForCount",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForExtent",c:3,a:[{i:0,p:["geometry"]}],e:2}],onComplete:function(){},onExecuteRelationshipQueryComplete:function(){},onExecuteForIdsComplete:function(){},onExecuteForCountComplete:function(){},
onExecuteForExtentComplete:function(){},execute:function(a,c,d,b,e){var g=e.assembly;a=this._encode(f.mixin({},this._url.query,{f:"json"},a.toJson(g&&g[0])));var h=this._handler,r=this._errorHandler;this.source&&(g={source:this.source.toJson()},a.layer=k.toJson(g));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return m({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(b,a){h(b,a,c,d,e.dfd)},error:function(b){r(b,d,e.dfd)},callbackSuffix:b},this.requestOptions)},executeRelationshipQuery:function(a,
c,d){a=this._encode(f.mixin({},this._url.query,{f:"json"},a.toJson()));var b=this._relationshipQueryHandler,e=this._errorHandler;this.gdbVersion&&(a.gdbVersion=this.gdbVersion);var n=new l(g._dfdCanceller);n._pendingDfd=m({url:this._url.path+"/queryRelatedRecords",content:a,callbackParamName:"callback",load:function(a,e){b(a,e,c,d,n)},error:function(b){e(b,d,n)}},this.requestOptions);return n},executeForIds:function(a,c,d,b){var e=b.assembly;a=this._encode(f.mixin({},this._url.query,{f:"json",returnIdsOnly:!0},
a.toJson(e&&e[0])));var g=this._executeForIdsHandler,h=this._errorHandler;this.source&&(e={source:this.source.toJson()},a.layer=k.toJson(e));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return m({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,e){g(a,e,c,d,b.dfd)},error:function(a){h(a,d,b.dfd)}},this.requestOptions)},executeForCount:function(a,c,d,b){var e=b.assembly;a=this._encode(f.mixin({},this._url.query,{f:"json",returnIdsOnly:!0,returnCountOnly:!0},a.toJson(e&&
e[0])));var g=this._countHandler,h=this._errorHandler;this.source&&(e={source:this.source.toJson()},a.layer=k.toJson(e));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return m({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,e){g(a,e,c,d,b.dfd)},error:function(a){h(a,d,b.dfd)}},this.requestOptions)},executeForExtent:function(a,c,d,b){var e=b.assembly;a=this._encode(f.mixin({},this._url.query,{f:"json",returnExtentOnly:!0,returnCountOnly:!0},a.toJson(e&&e[0])));
var g=this._extentHandler,h=this._errorHandler;this.source&&(e={source:this.source.toJson()},a.layer=k.toJson(e));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return m({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,e){g(a,e,c,d,b.dfd)},error:function(a){h(a,d,b.dfd)}},this.requestOptions)},_handler:function(a,c,d,b,e){try{var g=new r(a);this._successHandler([g],"onComplete",d,e)}catch(f){this._errorHandler(f,b,e)}},_relationshipQueryHandler:function(c,d,e,b,
g){try{var f=c.geometryType,h=c.spatialReference,k={};a.forEach(c.relatedRecordGroups,function(b){var a={};a.geometryType=f;a.spatialReference=h;a.features=b.relatedRecords;a=new r(a);if(null!=b.objectId)k[b.objectId]=a;else for(var c in b)b.hasOwnProperty(c)&&"relatedRecords"!==c&&(k[b[c]]=a)});this._successHandler([k],"onExecuteRelationshipQueryComplete",e,g)}catch(m){this._errorHandler(m,b,g)}},_executeForIdsHandler:function(a,c,d,b,e){try{this._successHandler([a.objectIds],"onExecuteForIdsComplete",
d,e)}catch(g){this._errorHandler(g,b,e)}},_countHandler:function(a,c,d,b,e){try{var g,f=a.features,h=a.objectIds;if(h)g=h.length;else{if(f)throw Error("Unable to perform query. Please check your parameters.");g=a.count}this._successHandler([g],"onExecuteForCountComplete",d,e)}catch(k){this._errorHandler(k,b,e)}},_extentHandler:function(a,c,d,b,g){try{a.extent&&(a.extent=new e(a.extent)),this._successHandler([a],"onExecuteForExtentComplete",d,g)}catch(f){this._errorHandler(f,b,g)}}});c._createWrappers(p);
return p})},"esri/geometry/normalizeUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/Deferred dojo/has ../kernel ../config ../deferredUtils ./Polyline ./Polygon ./webMercatorUtils ./jsonUtils".split(" "),function(p,f,a,l,k,h,q,m,g,e,c){function d(b,a){return Math.ceil((b-a)/(2*a))}function r(b,a){var c=b.paths||b.rings,d,e,g=c.length,f;for(d=0;d<g;d++){f=c[d].length;for(e=0;e<f;e++){var n=b.getPoint(d,e);b.setPoint(d,e,n.offset(a,0))}}return b}function u(b,a){if(!(b instanceof
m||b instanceof g))throw console.error("_straightLineDensify: the input geometry is neither polyline nor polygon"),Error("_straightLineDensify: the input geometry is neither polyline nor polygon");var c=b instanceof m,d=[],e;p.forEach(c?b.paths:b.rings,function(b){d.push(e=[]);e.push([b[0][0],b[0][1]]);var c,g,f,n,h,k,r,t,s,m,l,u;for(h=0;h<b.length-1;h++){c=b[h][0];g=b[h][1];f=b[h+1][0];n=b[h+1][1];r=Math.sqrt((f-c)*(f-c)+(n-g)*(n-g));t=(n-g)/r;s=(f-c)/r;m=r/a;if(1<m){for(k=1;k<=m-1;k++)u=k*a,l=s*
u+c,u=t*u+g,e.push([l,u]);k=(r+Math.floor(m-1)*a)/2;l=s*k+c;u=t*k+g;e.push([l,u])}e.push([f,n])}});return c?new m({paths:d,spatialReference:b.spatialReference}):new g({rings:d,spatialReference:b.spatialReference})}function s(b,a,c){a&&(b=u(b,1E6),b=e.webMercatorToGeographic(b,!0));c&&(b=r(b,c));return b}function t(b,a,c){var e=b.x||b[0],g;e>a?(g=d(e,a),b.x?b=b.offset(g*-2*a,0):b[0]=e+g*-2*a):e<c&&(g=d(e,c),b.x?b=b.offset(g*-2*c,0):b[0]=e+g*-2*c);return b}function b(b,a){var c=-1;p.forEach(a.cutIndexes,
function(e,g){var f=a.geometries[g];p.forEach(f.rings||f.paths,function(b,a){p.some(b,function(c){if(!(180>c[0])){c=0;var e,g=b.length,n;for(e=0;e<g;e++)n=b[e][0],c=n>c?n:c;c=Number(c.toFixed(9));c=-360*d(c,180);g=b.length;for(e=0;e<g;e++)n=f.getPoint(a,e),f.setPoint(a,e,n.offset(c,0))}return!0})});e===c?f.rings?p.forEach(f.rings,function(a){b[e]=b[e].addRing(a)}):p.forEach(f.paths,function(a){b[e]=b[e].addPath(a)}):(c=e,b[e]=f)});return b}function v(f,n,k,l){var u=new a;u.addCallbacks(k,l);n=n||
h.defaults.geometryService;var q=[],w=[],v,x,Q,K,J,O,G,T,P=0;p.forEach(f,function(b){if(b)if(v||(v=b.spatialReference,x=v._getInfo(),K=(Q=v._isWebMercator())?2.0037508342788905E7:180,J=Q?-2.0037508342788905E7:-180,O=Q?102100:4326,G=new m({paths:[[[K,J],[K,K]]],spatialReference:{wkid:O}}),T=new m({paths:[[[J,J],[J,K]]],spatialReference:{wkid:O}})),x){var a=c.fromJson(b.toJson()),e=b.getExtent();"point"===b.type?q.push(t(a,K,J)):"multipoint"===b.type?(a.points=p.map(a.points,function(b){return t(b,
K,J)}),q.push(a)):"extent"===b.type?(a=e._normalize(null,null,x),q.push(a.rings?new g(a):a)):e?(b=d(e.xmin,J)*2*K,a=0===b?a:r(a,b),e=e.offset(b,0),e.intersects(G)&&e.xmax!==K?(P=e.xmax>P?e.xmax:P,a=s(a,Q),w.push(a),q.push("cut")):e.intersects(T)&&e.xmin!==J?(P=e.xmax*2*K>P?e.xmax*2*K:P,a=s(a,Q,360),w.push(a),q.push("cut")):q.push(a)):q.push(a)}else q.push(b);else q.push(b)});k=new m;l=d(P,K);for(var V=-90,L=l;0<l;){var C=-180+360*l;k.addPath([[C,V],[C,-1*V]]);V*=-1;l--}0<w.length&&0<L?n?n.cut(w,k,
function(a){w=b(w,a);var c=[];p.forEach(q,function(b,a){if("cut"===b){var d=w.shift();f[a].rings&&1<f[a].rings.length&&d.rings.length>=f[a].rings.length?(q[a]="simplify",c.push(d)):q[a]=!0===Q?e.geographicToWebMercator(d):d}});0<c.length?n.simplify(c,function(b){p.forEach(q,function(a,c){"simplify"===a&&(q[c]=!0===Q?e.geographicToWebMercator(b.shift()):b.shift())});u.callback(q)},function(b){u.errback(b)}):u.callback(q)},function(b){u.errback(b)}):u.errback(Error("esri.geometry.normalizeCentralMeridian: 'geometryService' argument is missing.")):
(p.forEach(q,function(b,a){if("cut"===b){var c=w.shift();q[a]=!0===Q?e.geographicToWebMercator(c):c}}),u.callback(q));return u}function n(b,a,c,d){var e=!1,g;f.isObject(b)&&b&&(f.isArray(b)?b.length&&((g=b[0]&&b[0].declaredClass)&&-1!==g.indexOf("Graphic")?(b=p.map(b,function(b){return b.geometry}),e=b.length?!0:!1):g&&-1!==g.indexOf("esri.geometry.")&&(e=!0)):(g=b.declaredClass)&&-1!==g.indexOf("FeatureSet")?(b=p.map(b.features||[],function(b){return b.geometry}),e=b.length?!0:!1):g&&-1!==g.indexOf("esri.geometry.")&&
(e=!0));e&&a.push({index:c,property:d,value:b})}function w(b,a){var c=[];p.forEach(a,function(a){var d=a.i,e=b[d];a=a.p;var g;if(f.isObject(e)&&e)if(a)if("*"===a[0])for(g in e)e.hasOwnProperty(g)&&n(e[g],c,d,g);else p.forEach(a,function(b){n(f.getObject(b,!1,e),c,d,b)});else n(e,c,d)});return c}function x(b,a){var c=0,d={};p.forEach(a,function(a){var e=a.index,g=a.property,n=a.value,h=n.length||1,k=b.slice(c,c+h);f.isArray(n)||(k=k[0]);c+=h;delete a.value;g?(d[e]=d[e]||{},d[e][g]=k):d[e]=k});return d}
return{normalizeCentralMeridian:v,_foldCutResults:b,_prepareGeometryForCut:s,_offsetMagnitude:d,_pointNormalization:t,_updatePolyGeometry:r,_straightLineDensify:u,_createWrappers:function(b){var c=f.isObject(b)?b.prototype:f.getObject(b+".prototype");p.forEach(c.__msigns,function(b){var d=c[b.n];c[b.n]=function(){var c=this,e=[],g,f=new a(q._dfdCanceller);b.f&&q._fixDfd(f);for(g=0;g<b.c;g++)e[g]=arguments[g];var n={dfd:f};e.push(n);var h,k=[],r;c.normalization&&!c._isTable&&(h=w(e,b.a),p.forEach(h,
function(b){k=k.concat(b.value)}),k.length&&(r=v(k)));r?(f._pendingDfd=r,r.addCallbacks(function(b){f.canceled||(n.assembly=x(b,h),f._pendingDfd=d.apply(c,e))},function(a){var d=c.declaredClass;d&&-1!==d.indexOf("FeatureLayer")?c._resolve([a],null,e[b.e],f,!0):c._errorHandler(a,e[b.e],f)})):f._pendingDfd=d.apply(c,e);return f}})},_disassemble:w,_addToBucket:n,_reassemble:x}})},"esri/tasks/Task":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../deferredUtils ../urlUtils ../Evented".split(" "),
function(p,f,a,l,k,h,q,m){return p(m,{declaredClass:"esri.tasks._Task",_eventMap:{error:["error"],complete:["result"]},constructor:function(a,e){a&&f.isString(a)&&(this._url=q.urlToObject(this.url=a));e&&e.requestOptions&&(this.requestOptions=e.requestOptions);this.normalization=!0;this._errorHandler=f.hitch(this,this._errorHandler);this.registerConnectEvents()},_useSSL:function(){var a=this._url,e=/^http:/i;this.url&&(this.url=this.url.replace(e,"https:"));a&&a.path&&(a.path=a.path.replace(e,"https:"))},
_encode:function(g,e,c){var d,h,k={},s,t;for(s in g)if("declaredClass"!==s&&(d=g[s],h=typeof d,null!==d&&void 0!==d&&"function"!==h))if(f.isArray(d)){k[s]=[];t=d.length;for(h=0;h<t;h++)k[s][h]=this._encode(d[h])}else"object"===h?d.toJson&&(h=d.toJson(c&&c[s]),"esri.tasks.FeatureSet"===d.declaredClass&&h.spatialReference&&(h.sr=h.spatialReference,delete h.spatialReference),k[s]=e?h:a.toJson(h)):k[s]=d;return k},_successHandler:function(a,e,c,d){e&&this[e].apply(this,a);c&&c.apply(null,a);d&&h._resDfd(d,
a)},_errorHandler:function(a,e,c){this.onError(a);e&&e(a);c&&c.errback(a)},setNormalization:function(a){this.normalization=a},onError:function(){}})})},"esri/tasks/FeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../graphic ../SpatialReference ../graphicsUtils ../geometry/jsonUtils ../symbols/jsonUtils".split(" "),function(p,f,a,l,k,h,q,m,g,e,c){return p(null,{declaredClass:"esri.tasks.FeatureSet",constructor:function(d){if(d){f.mixin(this,
d);var g=this.features,h=d.spatialReference,k=e.getGeometryType(d.geometryType),h=this.spatialReference=new m(h);this.geometryType=d.geometryType;d.fields&&(this.fields=d.fields);a.forEach(g,function(a,b){var d=a.geometry&&a.geometry.spatialReference;g[b]=new q(k&&a.geometry?new k(a.geometry):null,a.symbol&&c.fromJson(a.symbol),a.attributes);g[b].geometry&&!d&&g[b].geometry.setSpatialReference(h)});this._hydrate()}else this.features=[]},displayFieldName:null,geometryType:null,spatialReference:null,
fieldAliases:null,toJson:function(a){var c={};this.displayFieldName&&(c.displayFieldName=this.displayFieldName);this.fields&&(c.fields=this.fields);this.spatialReference?c.spatialReference=this.spatialReference.toJson():this.features[0]&&this.features[0].geometry&&(c.spatialReference=this.features[0].geometry.spatialReference.toJson());this.features[0]&&(this.features[0].geometry&&(c.geometryType=e.getJsonType(this.features[0].geometry)),c.features=g._encodeGraphics(this.features,a));c.exceededTransferLimit=
this.exceededTransferLimit;c.transform=this.transform;return h.fixJson(c)},_hydrate:function(){var a=this.transform,c=this.geometryType;if(a&&c)for(var e=this.features,g=a.translate[0],f=a.translate[1],b=a.scale[0],h=a.scale[1],n=function(b,a,c){if("esriGeometryPoint"===b)return function(b){b.x=a(b.x);b.y=c(b.y)};if("esriGeometryPolyline"===b||"esriGeometryPolygon"===b)return function(b){b=b.rings||b.paths;var d,e,g,f,n,h,k,r;d=0;for(e=b.length;d<e;d++){n=b[d];g=0;for(f=n.length;g<f;g++)h=n[g],0<
g?(k+=h[0],r+=h[1]):(k=h[0],r=h[1]),h[0]=a(k),h[1]=c(r)}};if("esriGeometryEnvelope"===b)return function(b){b.xmin=a(b.xmin);b.ymin=c(b.ymin);b.xmax=a(b.xmax);b.ymax=c(b.ymax)};if("esriGeometryMultipoint"===b)return function(b){b=b.points;var d,e,g,f,n;d=0;for(e=b.length;d<e;d++)g=b[d],0<d?(f+=g[0],n+=g[1]):(f=g[0],n=g[1]),g[0]=a(f),g[1]=c(n)}}(c,function(a){return a*b+g},function(b){return f-b*h}),a=0,c=e.length;a<c;a++)e[a].geometry&&n(e[a].geometry);this.transform=null},quantize:function(a){if(!this.geometryType)return this.transform=
null,this;var c=a.translate[0],e=a.translate[1],g=a.scale[0],f=a.scale[1],b=this.features,h=function(b,a,c){var d,e,g,f,n,h,k=[];d=0;for(e=b.length;d<e;d++)if(g=b[d],0<d){if(h=a(g[0]),g=c(g[1]),h!==f||g!==n)k.push([h-f,g-n]),f=h,n=g}else f=a(g[0]),n=c(g[1]),k.push([f,n]);return 0<k.length?k:null},n=function(b,a,c){if("esriGeometryPoint"===b)return function(b){b.x=a(b.x);b.y=c(b.y);return b};if("esriGeometryPolyline"===b||"esriGeometryPolygon"===b)return function(b){var d,e,g,f,n;g=b.rings||b.paths;
n=[];d=0;for(e=g.length;d<e;d++)f=g[d],(f=h(f,a,c))&&n.push(f);return 0<n.length?(b.rings?b.rings=n:b.paths=n,b):null};if("esriGeometryMultipoint"===b)return function(b){var d;d=h(b.points,a,c);return 0<d.length?(b.points=d,b):null};if("esriGeometryEnvelope"===b)return function(b){return b}}(this.geometryType,function(b){return Math.round((b-c)/g)},function(b){return Math.round((e-b)/f)}),k,m;k=0;for(m=b.length;k<m;k++)b[k].geometry&&(n(b[k].geometry)||b[k].setGeometry(null));this.transform=a;return this}})})},
"esri/graphicsUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","./kernel","./geometry/Extent"],function(p,f,a,l,k){return{graphicsExtent:function(a){var f=a[0].geometry,m=f.getExtent(),g,e,c=a.length;null===m&&(m=new k(f.x,f.y,f.x,f.y,f.spatialReference));for(e=1;e<c;e++)g=(f=a[e].geometry).getExtent(),null===g&&(g=new k(f.x,f.y,f.x,f.y,f.spatialReference)),m=m.union(g);return 0>m.getWidth()&&0>m.getHeight()?null:m},getGeometries:function(a){return f.map(a,function(a){return a.geometry})},
_encodeGraphics:function(a,k){var m=[],g,e,c;f.forEach(a,function(a,f){g=a.toJson();e={};g.geometry&&(c=k&&k[f],e.geometry=c&&c.toJson()||g.geometry);g.attributes&&(e.attributes=g.attributes);m[f]=e});return m}}})},"esri/tasks/StatisticDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(p,f,a,l){return p(null,{declaredClass:"esri.tasks.StatisticDefinition",toJson:function(){return{statisticType:this.statisticType,onStatisticField:this.onStatisticField,
outStatisticFieldName:this.outStatisticFieldName,maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount}}})})},"esri/dijit/PopupRenderer":function(){define("require dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/sniff dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojox/html/entities dijit/_Widget dijit/_Templated ../kernel ../urlUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w){var x=0;return f([n,s,t],{declaredClass:"esri.dijit._PopupRenderer",constructor:function(){this._nls=l.mixin({},w.widgets.popup)},templateString:"\x3cdiv class\x3d'esriViewPopup'\x3e\x3cdiv class\x3d'mainSection'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_title'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_description'\x3e\x3c/div\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'attachmentsSection hidden'\x3e\x3cdiv\x3e${_nls.NLS_attach}:\x3c/div\x3e\x3cul dojoAttachPoint\x3d'_attachmentsList'\x3e\x3c/ul\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaSection hidden'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_mediaTitle'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'caption' dojoAttachPoint\x3d'_mediaCaption'\x3e\x3c/div\x3e\x3cdiv class\x3d'gallery' dojoAttachPoint\x3d'_gallery'\x3e\x3cdiv class\x3d'mediaHandle prev' dojoAttachPoint\x3d'_prevMedia' dojoAttachEvent\x3d'onclick: _goToPrevMedia'\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaHandle next' dojoAttachPoint\x3d'_nextMedia' dojoAttachEvent\x3d'onclick: _goToNextMedia'\x3e\x3c/div\x3e\x3cul class\x3d'summary'\x3e\x3cli class\x3d'image mediaCount hidden' dojoAttachPoint\x3d'_imageCount'\x3e0\x3c/li\x3e\x3cli class\x3d'image mediaIcon hidden'\x3e\x3c/li\x3e\x3cli class\x3d'chart mediaCount hidden' dojoAttachPoint\x3d'_chartCount'\x3e0\x3c/li\x3e\x3cli class\x3d'chart mediaIcon hidden'\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'frame' dojoAttachPoint\x3d'_mediaFrame'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummarySection hidden' dojoAttachPoint\x3d'_editSummarySection'\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3cdiv class\x3d'break hidden' dojoAttachPoint\x3d'_mediaBreak'\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummary' dojoAttachPoint\x3d'_editSummary'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
showTitle:!0,startup:function(){this.inherited(arguments);this.template.getComponents(this.graphic).then(l.hitch(this,this._handleComponentsSuccess),l.hitch(this,this._handleComponentsError))},destroy:function(){this._dfd&&this._dfd.cancel();this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._dfd=null;this.inherited(arguments)},_goToPrevMedia:function(){0>this._mediaPtr-1||(this._mediaPtr--,this._updateUI(),this._displayMedia())},_goToNextMedia:function(){this._mediaPtr+
1!==this._mediaInfos.length&&(this._mediaPtr++,this._updateUI(),this._displayMedia())},_updateUI:function(){var b=this._mediaInfos,a=b.length,d=this.domNode,g=this._prevMedia,f=this._nextMedia;if(1<a){var n=0,r=0;k.forEach(b,function(b){"image"===b.type?n++:-1!==b.type.indexOf("chart")&&r++});n&&(e.set(this._imageCount,"innerHTML",n),h.query(".summary .image",d).removeClass("hidden"));r&&(e.set(this._chartCount,"innerHTML",r),h.query(".summary .chart",d).removeClass("hidden"))}else h.query(".summary",
d).addClass("hidden"),c.add(g,"hidden"),c.add(f,"hidden");b=this._mediaPtr;0===b?c.add(g,"hidden"):c.remove(g,"hidden");b===a-1?c.add(f,"hidden"):c.remove(f,"hidden");this._destroyFrame()},_displayMedia:function(){var b=this._mediaInfos[this._mediaPtr],a=b.title,d=b.caption,g=h.query(".mediaSection .hzLine",this.domNode)[0];e.set(this._mediaTitle,"innerHTML",a);c[a?"remove":"add"](this._mediaTitle,"hidden");e.set(this._mediaCaption,"innerHTML",d);c[d?"remove":"add"](this._mediaCaption,"hidden");c[a&&
d?"remove":"add"](g,"hidden");this._rid=null;if("image"===b.type)this._showImage(b.value);else{var f=this,a=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],d=b.value.theme||this.chartTheme;l.isString(d)&&(d=d.replace(/\./gi,"/"),-1===d.indexOf("/")&&(d="dojox/charting/themes/"+d));d||(d="./Rainbow");a.push(d);try{var n=this._rid=x++;p(a,function(a,c,d){n===f._rid&&(f._rid=null,f._showChart(b.type,b.value,a,c,d))})}catch(k){console.log("PopupRenderer: error loading modules")}}},_preventNewTab:function(b){return(b=
b&&l.trim(b).toLowerCase())&&(0===b.indexOf("mailto:")||0===b.indexOf("tel:"))},_showImage:function(b){c.add(this._mediaFrame,"image");var e=r.get(this._gallery,"height"),g;b.linkURL&&(g=d.create("a",{href:b.linkURL,target:this._preventNewTab(b.linkURL)?"":"_blank"},this._mediaFrame));d.create("img",{className:"esriPopupMediaImage",src:b.sourceURL},g||this._mediaFrame);var f=h.query(".esriPopupMediaImage",this._mediaFrame)[0],n=this,k;k=a.connect(f,"onload",function(){a.disconnect(k);k=null;n._imageLoaded(f,
e)})},_showChart:function(b,a,e,g,f){c.remove(this._mediaFrame,"image");e=this._chart=new e(d.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});f&&e.setTheme(f);switch(b){case "piechart":e.addPlot("default",{type:"Pie",labels:!1});e.addSeries("Series A",a.fields);break;case "linechart":e.addPlot("default",{type:"Markers"});e.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});e.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});k.forEach(a.fields,
function(b,a){b.x=a+1});e.addSeries("Series A",a.fields);break;case "columnchart":e.addPlot("default",{type:"Columns",gap:3});e.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});e.addSeries("Series A",a.fields);break;case "barchart":e.addPlot("default",{type:"Bars",gap:3}),e.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),e.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),e.addSeries("Series A",a.fields)}this._action=new g(e);e.render()},
_destroyFrame:function(){this._rid=null;this._chart&&(this._chart.destroy(),this._chart=null);this._action&&(this._action.destroy(),this._action=null);e.set(this._mediaFrame,"innerHTML","")},_imageLoaded:function(b,a){var c=b.height;c<a&&(c=Math.round((a-c)/2),r.set(b,"marginTop",c+"px"))},_attListHandler:function(b,a){if(b===this._dfd){this._dfd=null;var c="";!(a instanceof Error)&&(a&&a.length)&&k.forEach(a,function(b){c+="\x3cli\x3e";c+="\x3ca href\x3d'"+v.addProxy(b.url)+"' target\x3d'_blank'\x3e"+
(b.name||"[No name]")+"\x3c/a\x3e";c+="\x3c/li\x3e"});e.set(this._attachmentsList,"innerHTML",c||"\x3cli\x3e"+this._nls.NLS_noAttach+"\x3c/li\x3e")}},_handleComponentsSuccess:function(b){if(b){var a=this.showTitle?b.title:"",d=b.description,f=b.fields,n=b.mediaInfos,r=this.domNode,t=this._nls,s=this,m=this.template,q=this.graphic;this._prevMedia.title=t.NLS_prevMedia;this._nextMedia.title=t.NLS_nextMedia;e.set(this._title,"innerHTML",a);a||c.add(this._title,"hidden");!b.hasDescription&&f&&(d="",k.forEach(f,
function(b){d+="\x3ctr valign\x3d'top'\x3e";d+="\x3ctd class\x3d'attrName'\x3e"+u.encode(b[0])+"\x3c/td\x3e";d+="\x3ctd class\x3d'attrValue'\x3e"+b[1].replace(/^\s*(https?:\/\/[^\s]+)\s*$/i,"\x3ca target\x3d'_blank' href\x3d'$1' title\x3d'$1'\x3e"+t.NLS_moreInfo+"\x3c/a\x3e")+"\x3c/td\x3e";d+="\x3c/tr\x3e"}),d&&(d="\x3ctable class\x3d'attrTable' cellpadding\x3d'0px' cellspacing\x3d'0px'\x3e"+d+"\x3c/table\x3e"));e.set(this._description,"innerHTML",d);d||c.add(this._description,"hidden");h.query("a",
this._description).forEach(function(b){s._preventNewTab(b.href)?"_blank"===b.target&&e.remove(b,"target"):e.set(b,"target","_blank")});a&&d?h.query(".mainSection .hzLine",r).removeClass("hidden"):a||d?h.query(".mainSection .hzLine",r).addClass("hidden"):h.query(".mainSection",r).addClass("hidden");if(a=this._dfd=m.getAttachments(q))a.addBoth(l.hitch(this,this._attListHandler,a)),e.set(this._attachmentsList,"innerHTML","\x3cli\x3e"+t.NLS_searching+"...\x3c/li\x3e"),h.query(".attachmentsSection",r).removeClass("hidden");
n&&n.length&&(h.query(".mediaSection",r).removeClass("hidden"),g.setSelectable(this._mediaFrame,!1),this._mediaInfos=n,this._mediaPtr=0,this._updateUI(),this._displayMedia());b.editSummary&&(e.set(this._editSummary,"innerHTML",b.editSummary),n&&n.length&&c.remove(this._mediaBreak,"hidden"),c.remove(this._editSummarySection,"hidden"))}},_handleComponentsError:function(b){console.log("PopupRenderer: error loading template",b)}})})},"dojox/html/entities":function(){define(["dojo/_base/lang"],function(p){var f=
p.getObject("dojox.html.entities",!0),a=function(a,f){var l,m;if(f._encCache&&f._encCache.regexp&&f._encCache.mapper&&f.length==f._encCache.length)l=f._encCache.mapper,m=f._encCache.regexp;else{l={};m=["["];var g;for(g=0;g<f.length;g++)l[f[g][0]]="\x26"+f[g][1]+";",m.push(f[g][0]);m.push("]");m=RegExp(m.join(""),"g");f._encCache={mapper:l,regexp:m,length:f.length}}return a=a.replace(m,function(a){return l[a]})},l=function(a,f){var l,m;if(f._decCache&&f._decCache.regexp&&f._decCache.mapper&&f.length==
f._decCache.length)l=f._decCache.mapper,m=f._decCache.regexp;else{l={};m=["("];var g;for(g=0;g<f.length;g++){var e="\x26"+f[g][1]+";";g&&m.push("|");l[e]=f[g][0];m.push(e)}m.push(")");m=RegExp(m.join(""),"g");f._decCache={mapper:l,regexp:m,length:f.length}}return a=a.replace(m,function(a){return l[a]})};f.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];f.latin=[["\u00a1","iexcl"],["\u00a2","cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],["\u00a5",
"yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa","ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0","Agrave"],
["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5","Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da","Uacute"],
["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df","szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1","ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4","ocirc"],["\u00f5",
"otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9","ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0",
"Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4",
"tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1",
"uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248",
"asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665","hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],
["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039","lsaquo"],["\u203a","rsaquo"]];f.encode=function(k,h){k&&(h?k=a(k,h):(k=a(k,f.html),
k=a(k,f.latin)));return k};f.decode=function(a,h){a&&(h?a=l(a,h):(a=l(a,f.html),a=l(a,f.latin)));return a};return f})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r){function u(){}function s(c){return function(b,d,e,g){return b&&"string"==typeof d&&b[d]==
u?b.on(d.substring(2).toLowerCase(),q.hitch(e,g)):c.apply(a,arguments)}}p.around(a,"connect",s);h.connect&&p.around(h,"connect",s);p=l("dijit._Widget",[c,d,r],{onClick:u,onDblClick:u,onKeyDown:u,onKeyPress:u,onKeyUp:u,onMouseDown:u,onMouseMove:u,onMouseOut:u,onMouseOver:u,onMouseLeave:u,onMouseEnter:u,onMouseUp:u,constructor:function(a){this._toConnect={};for(var b in a)this[b]===u&&(this._toConnect[b.replace(/^on/,"").toLowerCase()]=a[b],delete a[b])},postCreate:function(){this.inherited(arguments);
for(var a in this._toConnect)this.on(a,this._toConnect[a]);delete this._toConnect},on:function(c,b){return this[this._onMap(c)]===u?a.connect(this.domNode,c.toLowerCase(),this,b):this.inherited(arguments)},_setFocusedAttr:function(a){this._focused=a;this._set("focused",a)},setAttribute:function(a,b){h.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(a,b)},attr:function(a,b){return 2<=arguments.length||"object"===typeof a?this.set.apply(this,
arguments):this.get(a)},getDescendants:function(){h.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?m("[widgetId]",this.containerNode).map(e.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});k("dijit-legacy-requires")&&g(0,function(){require(["dijit/_base"])});return p})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y){function A(b){return function(a){m[a?"set":"remove"](this.domNode,b,a);this._set(b,a)}}r.add("dijit-legacy-requires",!u.isAsync);r.add("dojo-bidi",!1);r("dijit-legacy-requires")&&b(0,function(){p(["dijit/_base/manager"])});var B={};l=h("dijit._WidgetBase",[v,x],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:A("lang"),dir:"",_setDirAttr:A("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",
baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(b){this._set("ownerDocument",b)},attributeMap:{},_blankGif:l.blankGif||p.toUrl("dojo/resources/blank.gif"),textDir:"",_introspect:function(){var b=this.constructor;if(!b._setterAttrs){var a=b.prototype,c=b._setterAttrs=[],b=b._onMap={},d;for(d in a.attributeMap)c.push(d);for(d in a)/^on/.test(d)&&(b[d.substring(2).toLowerCase()]=d),/^_set[A-Z](.*)Attr$/.test(d)&&(d=d.charAt(4).toLowerCase()+
d.substr(5,d.length-9),(!a.attributeMap||!(d in a.attributeMap))&&c.push(d))}},postscript:function(b,a){this.create(b,a)},create:function(b,a){this._introspect();this.srcNodeRef=q.byId(a);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&(this.srcNodeRef.id&&"string"==typeof this.srcNodeRef.id)&&(this.id=this.srcNodeRef.id);b&&(this.params=b,s.mixin(this,b));this.postMixInProperties();this.id||(this.id=y.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);
this.ownerDocument=this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=w.body(this.ownerDocument);y.add(this);this.buildRendering();var c;if(this.domNode){this._applyAttributes();var d=this.srcNodeRef;d&&(d.parentNode&&this.domNode!==d)&&(d.parentNode.replaceChild(this.domNode,d),c=!0);this.domNode.setAttribute("widgetId",this.id)}this.postCreate();c&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var b={},a;for(a in this.params||
{})b[a]=this._get(a);f.forEach(this.constructor._setterAttrs,function(a){if(!(a in b)){var c=this._get(a);c&&this.set(a,c)}},this);for(a in b)this.set(a,b[a])},postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var b=this.baseClass.split(" ");this.isLeftToRight()||(b=b.concat(f.map(b,function(b){return b+"Rtl"})));g.add(this.domNode,b)}},postCreate:function(){},startup:function(){this._started||
(this._started=!0,f.forEach(this.getChildren(),function(b){!b._started&&(!b._destroyed&&s.isFunction(b.startup))&&(b.startup(),b._started=!0)}))},destroyRecursive:function(b){this._beingDestroyed=!0;this.destroyDescendants(b);this.destroy(b)},destroy:function(b){function a(c){c.destroyRecursive?c.destroyRecursive(b):c.destroy&&c.destroy(b)}this._beingDestroyed=!0;this.uninitialize();f.forEach(this._connects,s.hitch(this,"disconnect"));f.forEach(this._supportingWidgets,a);this.domNode&&f.forEach(y.findWidgets(this.domNode,
this.containerNode),a);this.destroyRendering(b);y.remove(this.id);this._destroyed=!0},destroyRendering:function(b){this.bgIframe&&(this.bgIframe.destroy(b),delete this.bgIframe);this.domNode&&(b?m.remove(this.domNode,"widgetId"):e.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(b||e.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(b){f.forEach(this.getChildren(),function(a){a.destroyRecursive&&a.destroyRecursive(b)})},uninitialize:function(){return!1},_setStyleAttr:function(b){var a=
this.domNode;s.isObject(b)?d.set(a,b):a.style.cssText=a.style.cssText?a.style.cssText+("; "+b):b;this._set("style",b)},_attrToDom:function(b,a,c){c=3<=arguments.length?c:this.attributeMap[b];f.forEach(s.isArray(c)?c:[c],function(c){var d=this[c.node||c||"domNode"];switch(c.type||"attribute"){case "attribute":s.isFunction(a)&&(a=s.hitch(this,a));c=c.attribute?c.attribute:/^on[A-Z][a-zA-Z]*$/.test(b)?b.toLowerCase():b;d.tagName?m.set(d,c,a):d.set(c,a);break;case "innerText":d.innerHTML="";d.appendChild(this.ownerDocument.createTextNode(a));
break;case "innerHTML":d.innerHTML=a;break;case "class":g.replace(d,a,this[b]);break;case "toggleClass":g.toggle(d,c.className||b,a)}},this)},get:function(b){var a=this._getAttrNames(b);return this[a.g]?this[a.g]():this._get(b)},set:function(b,a){if("object"===typeof b){for(var c in b)this.set(c,b[c]);return this}c=this._getAttrNames(b);var d=this[c.s];if(s.isFunction(d))var e=d.apply(this,Array.prototype.slice.call(arguments,1));else{var d=this.focusNode&&!s.isFunction(this.focusNode)?"focusNode":
"domNode",g=this[d]&&this[d].tagName,f;if(f=g)if(!(f=B[g])){f=this[d];var n={},h;for(h in f)n[h.toLowerCase()]=!0;f=B[g]=n}h=f;c=b in this.attributeMap?this.attributeMap[b]:c.s in this?this[c.s]:h&&c.l in h&&"function"!=typeof a||/^aria-|^data-|^role$/.test(b)?d:null;null!=c&&this._attrToDom(b,a,c);this._set(b,a)}return e||this},_attrPairNames:{},_getAttrNames:function(b){var a=this._attrPairNames;if(a[b])return a[b];var c=b.replace(/^[a-z]|-[a-zA-Z]/g,function(b){return b.charAt(b.length-1).toUpperCase()});
return a[b]={n:b+"Node",s:"_set"+c+"Attr",g:"_get"+c+"Attr",l:c.toLowerCase()}},_set:function(b,a){var c=this[b];this[b]=a;if(this._created&&!(c===a||c!==c&&a!==a))this._watchCallbacks&&this._watchCallbacks(b,c,a),this.emit("attrmodified-"+b,{detail:{prevValue:c,newValue:a}})},_get:function(b){return this[b]},emit:function(b,a,c){a=a||{};void 0===a.bubbles&&(a.bubbles=!0);void 0===a.cancelable&&(a.cancelable=!0);a.detail||(a.detail={});a.detail.widget=this;var d,e=this["on"+b];e&&(d=e.apply(this,
c?c:[a]));this._started&&!this._beingDestroyed&&t.emit(this.domNode,b.toLowerCase(),a);return d},on:function(b,c){var d=this._onMap(b);return d?a.after(this,d,c,!0):this.own(t(this.domNode,b,c))[0]},_onMap:function(b){var a=this.constructor,c=a._onMap;if(!c){var c=a._onMap={},d;for(d in a.prototype)/^on/.test(d)&&(c[d.replace(/^on/,"").toLowerCase()]=d)}return c["string"==typeof b&&b.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?
y.findWidgets(this.containerNode):[]},getParent:function(){return y.getEnclosingWidget(this.domNode.parentNode)},connect:function(b,a,c){return this.own(k.connect(b,a,this,c))[0]},disconnect:function(b){b.remove()},subscribe:function(b,a){return this.own(n.subscribe(b,s.hitch(this,a)))[0]},unsubscribe:function(b){b.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():c.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&"none"!=d.get(this.domNode,"display")},
placeAt:function(b,a){var c=!b.tagName&&y.byId(b);c&&c.addChild&&(!a||"number"===typeof a)?c.addChild(this,a):(c=c&&"domNode"in c?c.containerNode&&!/after|before|replace/.test(a||"")?c.containerNode:c.domNode:q.byId(b,this.ownerDocument),e.place(this.domNode,c,a),!this._started&&(this.getParent()||{})._started&&this.startup());return this},defer:function(b,a){var c=setTimeout(s.hitch(this,function(){c&&(c=null,this._destroyed||s.hitch(this,b)())}),a||0);return{remove:function(){c&&(clearTimeout(c),
c=null);return null}}}});r("dojo-bidi")&&l.extend(z);return l})},"dijit/Destroyable":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(p,f,a){return a("dijit.Destroyable",null,{destroy:function(a){this._destroyed=!0},own:function(){var a=["destroyRecursive","destroy","remove"];p.forEach(arguments,function(k){function h(){m.remove();p.forEach(g,function(a){a.remove()})}var q,m=f.before(this,"destroy",function(a){k[q](a)}),g=[];k.then?(q="cancel",k.then(h,h)):p.forEach(a,
function(a){"function"===typeof k[a]&&(q||(q=a),g.push(f.after(k,a,h,!0)))})},this);return arguments}})})},"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),function(p,f,a,l,k,h){p=l("dijit._OnDijitClickMixin",null,{connect:function(a,f,g){return this.inherited(arguments,[a,"ondijitclick"==f?h:f,g])}});p.a11yclick=h;return p})},"dijit/_FocusMixin":function(){define(["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],
function(p,f,a,l){l.extend(f,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});return a("dijit._FocusMixin",null,{_focusManager:p})})},"dijit/hccss":function(){define(["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(p,f,a,l){a(function(){f("highcontrast")&&p.add(l.body(),"dijit_a11y")});return f})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),
function(p,f,a,l,k,h,q){k.add("highcontrast",function(){var a=q.doc.createElement("div");try{a.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+(f.blankGif||p.toUrl("./resources/blank.gif"))+'");';q.body().appendChild(a);var g=l.getComputedStyle(a),e=g.backgroundImage;return g.borderTopColor==g.borderRightColor||e&&("none"==e||"url(invalid-url:)"==e)}catch(c){return console.warn("hccss: exception detecting high-contrast mode, document is likely hidden: "+
c.toString()),!1}finally{8>=k("ie")?a.outerHTML="":q.body().removeChild(a)}});h(function(){k("highcontrast")&&a.add(q.body(),"dj_a11y")});return k})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),function(p,f,a,l,k,h,q){h.extend(p,{waiRole:"",waiState:""});return k("dijit._Templated",[f,a],{constructor:function(){q.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin",
"","2.0")},_processNode:function(a,g){var e=this.inherited(arguments),c=g(a,"waiRole");c&&a.setAttribute("role",c);(c=g(a,"waiState"))&&l.forEach(c.split(/\s*,\s*/),function(c){-1!=c.indexOf("-")&&(c=c.split("-"),a.setAttribute("aria-"+c[0],c[1]))});return e}})})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),function(p,f,a,l,k,h,q,m){var g=f("dijit._TemplatedMixin",m,{templateString:null,
templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(a){var c=this.declaredClass,d=this;return q.substitute(a,this,function(a,e){"!"==e.charAt(0)&&(a=l.getObject(e.substr(1),!1,d));if("undefined"==typeof a)throw Error(c+" template:"+e);return null==a?"":"!"==e.charAt(0)?a:this._escapeValue(""+a)},this)},_escapeValue:function(a){return a.replace(/["'<>&]/g,function(a){return{"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[a]})},buildRendering:function(){if(!this._rendered){this.templateString||
(this.templateString=p(this.templatePath,{sanitize:!0}));var e=g.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument),c;if(l.isString(e)){if(c=a.toDom(this._stringRepl(e),this.ownerDocument),1!=c.nodeType)throw Error("Invalid template: "+e);}else c=e.cloneNode(!0);this.domNode=c}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);this._rendered=!0},_fillContent:function(a){var c=this.containerNode;if(a&&c)for(;a.hasChildNodes();)c.appendChild(a.firstChild)}});
g._templateCache={};g.getCachedTemplate=function(e,c,d){var f=g._templateCache,h=e,k=f[h];if(k){try{if(!k.ownerDocument||k.ownerDocument==(d||document))return k}catch(t){}a.destroy(k)}e=q.trim(e);if(c||e.match(/\$\{([^\}]+)\}/g))return f[h]=e;c=a.toDom(e,d);if(1!=c.nodeType)throw Error("Invalid template: "+e);return f[h]=c};h("ie")&&k(window,"unload",function(){var e=g._templateCache,c;for(c in e){var d=e[c];"object"==typeof d&&a.destroy(d);delete e[c]}});return g})},"dojo/cache":function(){define(["./_base/kernel",
"./text"],function(p){return p.cache})},"dojo/text":function(){define(["./_base/kernel","require","./has","./request"],function(p,f,a,l){var k;k=function(a,c,d){l(a,{sync:!!c,headers:{"X-Requested-With":null}}).then(d)};var h={},q=function(a){if(a){a=a.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var c=a.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);c&&(a=c[1])}else a="";return a},m={},g={};p.cache=function(a,c,d){var g;"string"==typeof a?/\//.test(a)?(g=a,d=c):g=f.toUrl(a.replace(/\./g,
"/")+(c?"/"+c:"")):(g=a+"",d=c);a=void 0!=d&&"string"!=typeof d?d.value:d;d=d&&d.sanitize;if("string"==typeof a)return h[g]=a,d?q(a):a;if(null===a)return delete h[g],null;g in h||k(g,!0,function(a){h[g]=a});return d?q(h[g]):h[g]};return{dynamic:!0,normalize:function(a,c){var d=a.split("!"),g=d[0];return(/^\./.test(g)?c(g):g)+(d[1]?"!"+d[1]:"")},load:function(a,c,d){a=a.split("!");var f=1<a.length,l=a[0],s=c.toUrl(a[0]);a="url:"+s;var t=m,b=function(b){d(f?q(b):b)};l in h?t=h[l]:c.cache&&a in c.cache?
t=c.cache[a]:s in h&&(t=h[s]);if(t===m)if(g[s])g[s].push(b);else{var v=g[s]=[b];k(s,!c.async,function(b){h[l]=h[s]=b;for(var a=0;a<v.length;)v[a++](b);delete g[s]})}else b(t)}}})},"dojo/request":function(){define(["./request/default!"],function(p){return p})},"dojo/request/default":function(){define(["exports","require","../has"],function(p,f,a){var l=a("config-requestProvider");l||(l="./xhr");p.getPlatformDefaultId=function(){return"./xhr"};p.load=function(a,h,q,m){f(["platform"==a?"./xhr":l],function(a){q(a)})}})},
"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),function(p,f,a,l,k,h,q,m,g){var e=k.delegate(m,{mouseenter:h.enter,mouseleave:h.leave,keypress:a._keypress}),c;a=l("dijit._AttachMixin",null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);this._attachTemplateNodes(this.domNode);this._beforeFillContent()},
_beforeFillContent:function(){},_attachTemplateNodes:function(a){for(var c=a;;)if(1==c.nodeType&&(this._processTemplateNode(c,function(a,c){return a.getAttribute(c)},this._attach)||this.searchContainerNode)&&c.firstChild)c=c.firstChild;else{if(c==a)break;for(;!c.nextSibling;)if(c=c.parentNode,c==a)return;c=c.nextSibling}},_processTemplateNode:function(a,c,e){var g=!0,f=this.attachScope||this,b=c(a,"dojoAttachPoint")||c(a,"data-dojo-attach-point");if(b)for(var h=b.split(/\s*,\s*/);b=h.shift();)k.isArray(f[b])?
f[b].push(a):f[b]=a,g="containerNode"!=b,this._attachPoints.push(b);if(c=c(a,"dojoAttachEvent")||c(a,"data-dojo-attach-event")){b=c.split(/\s*,\s*/);for(h=k.trim;c=b.shift();)if(c){var n=null;-1!=c.indexOf(":")?(n=c.split(":"),c=h(n[0]),n=h(n[1])):c=h(c);n||(n=c);this._attachEvents.push(e(a,c,k.hitch(f,n)))}}return g},_attach:function(a,g,f){g=g.replace(/^on/,"").toLowerCase();g="dijitclick"==g?c||(c=p("./a11yclick")):e[g]||g;return q(a,g,f)},_detachTemplateNodes:function(){var a=this.attachScope||
this;f.forEach(this._attachPoints,function(c){delete a[c]});this._attachPoints=[];f.forEach(this._attachEvents,function(a){a.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();this.inherited(arguments)}});k.extend(g,{dojoAttachEvent:"",dojoAttachPoint:""});return a})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(p,f,a,l,k){return a("dijit._WidgetsInTemplateMixin",
null,{_earlyTemplatedStartup:!1,contextRequire:null,_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var a=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);k.parse(a,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(l.hitch(this,function(a){this._startupWidgets=a;for(var f=0;f<a.length;f++)this._processTemplateNode(a[f],
function(a,e){return a[e]},function(a,e,c){return e in a?a.connect(a,e,c):a.on(e,c,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}},_processTemplateNode:function(a,f,k){return f(a,"dojoType")||f(a,"data-dojo-type")?
!0:this.inherited(arguments)},startup:function(){p.forEach(this._startupWidgets,function(a){a&&(!a._started&&a.startup)&&a.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t){function b(b){return eval("("+b+")")}function v(b){var a=
b._nameCaseMap,c=b.prototype;if(!a||a._extendCnt<w){var a=b._nameCaseMap={},d;for(d in c)"_"!==d.charAt(0)&&(a[d.toLowerCase()]=d);a._extendCnt=w}return a}function n(b,c){c||(c=p);var d=c._dojoParserCtorMap||(c._dojoParserCtorMap={}),e=b.join();if(!d[e]){for(var g=[],f=0,n=b.length;f<n;f++){var h=b[f];g[g.length]=d[h]=d[h]||a.getObject(h)||~h.indexOf("/")&&c(h)}f=g.shift();d[e]=g.length?f.createSubclass?f.createSubclass(g):f.extend.apply(f,g):f}return d[e]}new Date("X");var w=0;g.after(a,"extend",
function(){w++},!0);var x={_clearCache:function(){w++;_ctorMap={}},_functionFromScript:function(b,a){var c="",d="",e=b.getAttribute(a+"args")||b.getAttribute("args"),g=b.getAttribute("with"),e=(e||"").split(/\s*,\s*/);g&&g.length&&l.forEach(g.split(/\s*,\s*/),function(b){c+="with("+b+"){";d+="}"});return new Function(e,c+b.innerHTML+d)},instantiate:function(b,a,c){a=a||{};c=c||{};var d=(c.scope||f._scopeName)+"Type",e="data-"+(c.scope||f._scopeName)+"-",g=e+"type",n=e+"mixins",h=[];l.forEach(b,function(b){var c=
d in a?a[d]:b.getAttribute(g)||b.getAttribute(d);if(c){var e=b.getAttribute(n),c=e?[c].concat(e.split(/\s*,\s*/)):[c];h.push({node:b,types:c})}});return this._instantiate(h,a,c)},_instantiate:function(b,a,c,d){function g(b){!a._started&&!c.noStart&&l.forEach(b,function(b){"function"===typeof b.startup&&!b._started&&b.startup()});return b}b=l.map(b,function(b){var d=b.ctor||n(b.types,c.contextRequire);if(!d)throw Error("Unable to resolve constructor for: '"+b.types.join()+"'");return this.construct(d,
b.node,a,c,b.scripts,b.inherited)},this);return d?e(b).then(g):g(b)},construct:function(d,e,n,h,k,t){function q(b){T&&a.setObject(T,b);for(O=0;O<X.length;O++)g[X[O].advice||"after"](b,X[O].method,a.hitch(b,X[O].func),!0);for(O=0;O<Y.length;O++)Y[O].call(b);for(O=0;O<la.length;O++)b.watch(la[O].prop,la[O].func);for(O=0;O<aa.length;O++)s(b,aa[O].event,aa[O].func);return b}var w=d&&d.prototype;h=h||{};var x={};h.defaults&&a.mixin(x,h.defaults);t&&a.mixin(x,t);var p;r("dom-attributes-explicit")?p=e.attributes:
r("dom-attributes-specified-flag")?p=l.filter(e.attributes,function(b){return b.specified}):(t=(/^input$|^img$/i.test(e.nodeName)?e:e.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),p=l.map(t.split(/\s+/),function(b){var a=b.toLowerCase();return{name:b,value:"LI"==e.nodeName&&"value"==b||"enctype"==a?e.getAttribute(a):e.getAttributeNode(a).value}}));var K=h.scope||f._scopeName;t="data-"+K+"-";var J={};"dojo"!==K&&(J[t+"props"]=
"data-dojo-props",J[t+"type"]="data-dojo-type",J[t+"mixins"]="data-dojo-mixins",J[K+"type"]="dojotype",J[t+"id"]="data-dojo-id");for(var O=0,G,K=[],T,P;G=p[O++];){var V=G.name,L=V.toLowerCase();G=G.value;switch(J[L]||L){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":P=G;break;case "data-dojo-id":case "jsid":T=G;break;case "data-dojo-attach-point":case "dojoattachpoint":x.dojoAttachPoint=G;break;case "data-dojo-attach-event":case "dojoattachevent":x.dojoAttachEvent=
G;break;case "class":x["class"]=e.className;break;case "style":x.style=e.style&&e.style.cssText;break;default:if(V in w||(V=v(d)[L]||V),V in w)switch(typeof w[V]){case "string":x[V]=G;break;case "number":x[V]=G.length?Number(G):NaN;break;case "boolean":x[V]="false"!=G.toLowerCase();break;case "function":""===G||-1!=G.search(/[^\w\.]+/i)?x[V]=new Function(G):x[V]=a.getObject(G,!1)||new Function(G);K.push(V);break;default:L=w[V],x[V]=L&&"length"in L?G?G.split(/\s*,\s*/):[]:L instanceof Date?""==G?new Date(""):
"now"==G?new Date:c.fromISOString(G):L instanceof m?f.baseUrl+G:b(G)}else x[V]=G}}for(p=0;p<K.length;p++)J=K[p].toLowerCase(),e.removeAttribute(J),e[J]=null;if(P)try{P=b.call(h.propsThis,"{"+P+"}"),a.mixin(x,P)}catch(C){throw Error(C.toString()+" in data-dojo-props\x3d'"+P+"'");}a.mixin(x,n);k||(k=d&&(d._noScript||w._noScript)?[]:u("\x3e script[type^\x3d'dojo/']",e));var X=[],Y=[],la=[],aa=[];if(k)for(O=0;O<k.length;O++)J=k[O],e.removeChild(J),n=J.getAttribute(t+"event")||J.getAttribute("event"),
h=J.getAttribute(t+"prop"),P=J.getAttribute(t+"method"),K=J.getAttribute(t+"advice"),p=J.getAttribute("type"),J=this._functionFromScript(J,t),n?"dojo/connect"==p?X.push({method:n,func:J}):"dojo/on"==p?aa.push({event:n,func:J}):x[n]=J:"dojo/aspect"==p?X.push({method:P,advice:K,func:J}):"dojo/watch"==p?la.push({prop:h,func:J}):Y.push(J);d=(k=d.markupFactory||w.markupFactory)?k(x,e,d):new d(x,e);return d.then?d.then(q):q(d)},scan:function(b,a){function c(b){if(!b.inherited){b.inherited={};var a=b.node,
d=c(b.parent),a={dir:a.getAttribute("dir")||d.dir,lang:a.getAttribute("lang")||d.lang,textDir:a.getAttribute(s)||d.textDir},e;for(e in a)a[e]&&(b.inherited[e]=a[e])}return b.inherited}var e=[],g=[],h={},k=(a.scope||f._scopeName)+"Type",r="data-"+(a.scope||f._scopeName)+"-",t=r+"type",s=r+"textdir",r=r+"mixins",m=b.firstChild,u=a.inherited;if(!u){var q=function(b,a){return b.getAttribute&&b.getAttribute(a)||b.parentNode&&q(b.parentNode,a)},u={dir:q(b,"dir"),lang:q(b,"lang"),textDir:q(b,s)},w;for(w in u)u[w]||
delete u[w]}for(var u={inherited:u},v,x;;)if(m)if(1!=m.nodeType)m=m.nextSibling;else if(v&&"script"==m.nodeName.toLowerCase())(V=m.getAttribute("type"))&&/^dojo\/\w/i.test(V)&&v.push(m),m=m.nextSibling;else if(x)m=m.nextSibling;else{var V=m.getAttribute(t)||m.getAttribute(k);w=m.firstChild;if(!V&&(!w||3==w.nodeType&&!w.nextSibling))m=m.nextSibling;else{x=null;if(V){var L=m.getAttribute(r);v=L?[V].concat(L.split(/\s*,\s*/)):[V];try{x=n(v,a.contextRequire)}catch(C){}x||l.forEach(v,function(b){~b.indexOf("/")&&
!h[b]&&(h[b]=!0,g[g.length]=b)});L=x&&!x.prototype._noScript?[]:null;u={types:v,ctor:x,parent:u,node:m,scripts:L};u.inherited=c(u);e.push(u)}else u={node:m,scripts:v,parent:u};v=L;x=m.stopParser||x&&x.prototype.stopParser&&!a.template;m=w}}else{if(!u||!u.node)break;m=u.node.nextSibling;x=!1;u=u.parent;v=u.scripts}var X=new d;g.length?(a.contextRequire||p)(g,function(){X.resolve(l.filter(e,function(b){if(!b.ctor)try{b.ctor=n(b.types,a.contextRequire)}catch(c){}for(var d=b.parent;d&&!d.types;)d=d.parent;
var e=b.ctor&&b.ctor.prototype;b.instantiateChildren=!(e&&e.stopParser&&!a.template);b.instantiate=!d||d.instantiate&&d.instantiateChildren;return b.instantiate}))}):X.resolve(e);return X.promise},_require:function(c,e){var g=b("{"+c.innerHTML+"}"),f=[],n=[],h=new d,k=e&&e.contextRequire||p,r;for(r in g)f.push(r),n.push(g[r]);k(n,function(){for(var b=0;b<f.length;b++)a.setObject(f[b],arguments[b]);h.resolve(arguments)});return h.promise},_scanAmd:function(b,a){var c=new d,e=c.promise;c.resolve(!0);
var g=this;u("script[type\x3d'dojo/require']",b).forEach(function(b){e=e.then(function(){return g._require(b,a)});b.parentNode.removeChild(b)});return e},parse:function(b,c){var d;!c&&b&&b.rootNode?(c=b,d=c.rootNode):b&&a.isObject(b)&&!("nodeType"in b)?c=b:d=b;d=d?h.byId(d):q.body();c=c||{};var e=c.template?{template:!0}:{},g=[],f=this,n=this._scanAmd(d,c).then(function(){return f.scan(d,c)}).then(function(b){return f._instantiate(b,e,c,!0)}).then(function(b){return g=g.concat(b)}).otherwise(function(b){console.error("dojo/parser::parse() error",
b);throw b;});a.mixin(g,n);return g}};f.parser=x;k.parseOnLoad&&t(100,x,"parse");return x})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(p,f){var a={};p.setObject("dojo.date.stamp",a);a.fromISOString=function(l,k){a._isoRegExp||(a._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var h=a._isoRegExp.exec(l),q=null;if(h){h.shift();h[1]&&h[1]--;h[6]&&(h[6]*=1E3);k&&(k=new Date(k),f.forEach(f.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),
function(a){return k["get"+a]()}),function(a,c){h[c]=h[c]||a}));q=new Date(h[0]||1970,h[1]||0,h[2]||1,h[3]||0,h[4]||0,h[5]||0,h[6]||0);100>h[0]&&q.setFullYear(h[0]||1970);var m=0,g=h[7]&&h[7].charAt(0);"Z"!=g&&(m=60*(h[8]||0)+(Number(h[9])||0),"-"!=g&&(m*=-1));g&&(m-=q.getTimezoneOffset());m&&q.setTime(q.getTime()+6E4*m)}return q};a.toISOString=function(a,f){var h=function(a){return 10>a?"0"+a:a};f=f||{};var q=[],m=f.zulu?"getUTC":"get",g="";"time"!=f.selector&&(g=a[m+"FullYear"](),g=["0000".substr((g+
"").length)+g,h(a[m+"Month"]()+1),h(a[m+"Date"]())].join("-"));q.push(g);if("date"!=f.selector){g=[h(a[m+"Hours"]()),h(a[m+"Minutes"]()),h(a[m+"Seconds"]())].join(":");m=a[m+"Milliseconds"]();f.milliseconds&&(g+="."+(100>m?"0":"")+h(m));if(f.zulu)g+="Z";else if("time"!=f.selector)var m=a.getTimezoneOffset(),e=Math.abs(m),g=g+((0<m?"-":"+")+h(Math.floor(e/60))+":"+h(e%60));q.push(g)}return q.join("T")};return a})},"esri/dijit/_EventedWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/on ../Evented dijit/_WidgetBase".split(" "),
function(p,f,a,l,k,h){return p([h,k],{_onMap:function(a){var f=this.constructor._onMap,g;if(!f||!f.FINAL)delete this.constructor._onMap,f=this.registerConnectEvents(),f.FINAL=!0;a=a.toLowerCase();f[a]?g=this[f[a].method]:(a=this._onCamelCase(a),this[a]&&(g=a));return g},on:function(a,f){var g=this._onMap(a),e=a.replace(/\-/g,""),c="on"+e in this.domNode;return g||!c?this.inherited(arguments):this.own(l(this.domNode,e,f))[0]},emit:function(a,h,g){var e,c,d,k=a.toLowerCase(),l=this.constructor._onMap||
this.registerConnectEvents();c=this[this._onMap(k)];h=h||{};h.target||(h.target=this);c&&(l&&l[k])&&(this._onObj2Arr(function(){e=Array.prototype.slice.call(arguments)},l[k].argKeys)(h),d=f.mixin({},arguments),d[2]=e,d[0]=l[k].name.replace(/^on/,""));return this.inherited(d||arguments)}})})},"esri/tasks/GeometryService":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../request ../deferredUtils ./Task ../geometry/Extent ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/jsonUtils".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s){p=p(e,{declaredClass:"esri.tasks.GeometryService",_eventMap:{"areas-and-lengths-complete":["result"],"auto-complete-complete":["geometries"],"buffer-complete":["geometries"],"convex-hull-complete":["geometry"],"cut-complete":["result"],"densify-complete":["geometries"],"difference-complete":["geometries"],"distance-complete":["distance"],"generalize-complete":["geometries"],"intersect-complete":["geometries"],"label-points-complete":["geometries"],"lengths-complete":["result"],
"offset-complete":["geometries"],"project-complete":["geometries"],"relation-complete":["relations"],"reshape-complete":["geometry"],"simplify-complete":["geometries"],"trim-extend-complete":["geometries"],"union-complete":["geometry"]},constructor:function(a){a=f.hitch;this._projectHandler=a(this,this._projectHandler);this._simplifyHandler=a(this,this._simplifyHandler);this._bufferHandler=a(this,this._bufferHandler);this._areasAndLengthsHandler=a(this,this._areasAndLengthsHandler);this._lengthsHandler=
a(this,this._lengthsHandler);this._labelPointsHandler=a(this,this._labelPointsHandler);this._relationHandler=a(this,this._relationHandler);this._convexHullHandler=a(this,this._convexHullHandler);this._unionHandler=a(this,this._unionHandler);this._autoCompleteHandler=a(this,this._autoCompleteHandler);this._reshapeHandler=a(this,this._reshapeHandler);this._cutHandler=a(this,this._cutHandler);this._intersectHandler=a(this,this._intersectHandler);this._differenceHandler=a(this,this._differenceHandler);
this._trimExtendHandler=a(this,this._trimExtendHandler);this._densifyHandler=a(this,this._densifyHandler);this._generalizeHandler=a(this,this._densifyHandler);this._offsetHandler=a(this,this._offsetHandler);this._distanceHandler=a(this,this._distanceHandler);this._toGeoCoordinateHandler=a(this,this._toGeoCoordinateHandler);this._fromGeoCoordinateHandler=a(this,this._fromGeoCoordinateHandler);this.registerConnectEvents()},_encodeGeometries:function(a){var b=[],c,d=a.length;for(c=0;c<d;c++)b.push(a[c].toJson());
return{geometryType:s.getJsonType(a[0]),geometries:b}},_decodeGeometries:function(c,b,d){var e=s.getGeometryType(b);c=c.geometries;var g=[],h={spatialReference:d.toJson()},k=f.mixin;a.forEach(c,function(b,a){g[a]=new e(k(b,h))});return g},_toProjectGeometry:function(a){var b=a.spatialReference.toJson();return a instanceof c?new r({rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]],spatialReference:b}):new d({paths:[[].concat(a.points)],spatialReference:b})},
_fromProjectedGeometry:function(a,b,d){return"esriGeometryEnvelope"===b?(a=a.rings[0],new c(a[0][0],a[0][1],a[2][0],a[2][1],d)):new u({points:a.paths[0],spatialReference:d.toJson()})},project:function(a,b,c,d){var e=f.mixin({},this._url.query,{f:"json"}),h;a.geometries?(d=c,c=b,b=a.outSR,h=a.geometries[0],e=f.mixin(e,a.toJson())):(h=a[0],e=f.mixin(e,{outSR:b.wkid||l.toJson(b.toJson()),inSR:h.spatialReference.wkid||l.toJson(h.spatialReference.toJson()),geometries:l.toJson(this._encodeGeometries(a))}));
var r=s.getJsonType(h),u=this._projectHandler,q=this._errorHandler,p=new k(g._dfdCanceller);p._pendingDfd=m({url:this._url.path+"/project",content:e,callbackParamName:"callback",load:function(a,e){u(a,e,r,b,c,d,p)},error:function(b){q(b,d,p)}});return p},_projectHandler:function(a,b,c,d,e,g,f){try{var h=this._decodeGeometries(a,c,d);this._successHandler([h],"onProjectComplete",e,f)}catch(k){this._errorHandler(k,g,f)}},onProjectComplete:function(){},simplify:function(a,b,c){var d=a[0].spatialReference,
e=f.mixin({},this._url.query,{f:"json",sr:d.wkid?d.wkid:l.toJson(d.toJson()),geometries:l.toJson(this._encodeGeometries(a))}),h=s.getJsonType(a[0]),r=this._simplifyHandler,u=this._errorHandler,q=new k(g._dfdCanceller);q._pendingDfd=m({url:this._url.path+"/simplify",content:e,callbackParamName:"callback",load:function(a,e){r(a,e,h,d,b,c,q)},error:function(b){u(b,c,q)}});return q},_simplifyHandler:function(a,b,c,d,e,g,f){try{var h=this._decodeGeometries(a,c,d);this._successHandler([h],"onSimplifyComplete",
e,f)}catch(k){this._errorHandler(k,g,f)}},onSimplifyComplete:function(){},convexHull:function(a,b,c){var d=a[0].spatialReference;a=f.mixin({},this._url.query,{f:"json",sr:l.toJson(d.toJson()),geometries:l.toJson(this._encodeGeometries(a))});var e=this._convexHullHandler,h=this._errorHandler,r=new k(g._dfdCanceller);r._pendingDfd=m({url:this._url.path+"/convexHull",content:a,callbackParamName:"callback",load:function(a,g){e(a,g,d,b,c,r)},error:function(b){h(b,c,r)}});return r},_convexHullHandler:function(a,
b,c,d,e,g){try{var f=s.fromJson(a.geometry).setSpatialReference(c);this._successHandler([f],"onConvexHullComplete",d,g)}catch(h){this._errorHandler(h,e,g)}},onConvexHullComplete:function(){},union:function(a,b,c){var d=a[0].spatialReference;a=f.mixin({},this._url.query,{f:"json",sr:l.toJson(d.toJson()),geometries:l.toJson(this._encodeGeometries(a))});var e=this._unionHandler,h=this._errorHandler,r=new k(g._dfdCanceller);r._pendingDfd=m({url:this._url.path+"/union",content:a,callbackParamName:"callback",
load:function(a,g){e(a,g,d,b,c,r)},error:function(b){h(b,c,r)}});return r},_unionHandler:function(a,b,c,d,e,g){try{var f=s.fromJson(a.geometry).setSpatialReference(c);this._successHandler([f],"onUnionComplete",d,g)}catch(h){this._errorHandler(h,e,g)}},onUnionComplete:function(){},autoComplete:function(a,b,c,d){var e=a[0].spatialReference;a=f.mixin({},this._url.query,{f:"json",sr:l.toJson(e.toJson()),polygons:l.toJson(this._encodeGeometries(a).geometries),polylines:l.toJson(this._encodeGeometries(b).geometries)});
var h=this._autoCompleteHandler,r=this._errorHandler,s=new k(g._dfdCanceller);s._pendingDfd=m({url:this._url.path+"/autoComplete",content:a,callbackParamName:"callback",load:function(b,a){h(b,a,e,c,d,s)},error:function(b){r(b,d,s)}});return s},_autoCompleteHandler:function(a,b,c,d,e,g){try{var f=a.geometries;a=[];var h,k=f.length;for(h=0;h<k;h++)a[h]=new r({spatialReference:c,rings:f[h].rings});this._successHandler([a],"onAutoCompleteComplete",d,g)}catch(s){this._errorHandler(s,e,g)}},onAutoCompleteComplete:function(){},
reshape:function(a,b,c,d){var e=a.spatialReference;a=f.mixin({},this._url.query,{f:"json",sr:l.toJson(e.toJson()),target:l.toJson({geometryType:s.getJsonType(a),geometry:a.toJson()}),reshaper:l.toJson(b.toJson())});var h=this._reshapeHandler,r=this._errorHandler,u=new k(g._dfdCanceller);u._pendingDfd=m({url:this._url.path+"/reshape",content:a,callbackParamName:"callback",load:function(b,a){h(b,a,e,c,d,u)},error:function(b){r(b,d,u)}});return u},_reshapeHandler:function(a,b,c,d,e,g){try{var f=s.fromJson(a.geometry).setSpatialReference(c);
this._successHandler([f],"onReshapeComplete",d,g)}catch(h){this._errorHandler(h,e,g)}},onReshapeComplete:function(){},cut:function(c,b,d,e){var h=c[0].spatialReference,r=a.map(c,function(b){return b.toJson()});c=f.mixin({},this._url.query,{f:"json",sr:l.toJson(h.toJson()),target:l.toJson({geometryType:s.getJsonType(c[0]),geometries:r}),cutter:l.toJson(b.toJson())});var u=this._cutHandler,q=this._errorHandler,p=new k(g._dfdCanceller);p._pendingDfd=m({url:this._url.path+"/cut",content:c,callbackParamName:"callback",
load:function(b,a){u(b,a,h,d,e,p)},error:function(b){q(b,e,p)}});return p},_cutHandler:function(c,b,d,e,g,f){try{var h=c.geometries,k={};k.cutIndexes=c.cutIndexes;k.geometries=[];a.forEach(h,function(b){k.geometries.push(s.fromJson(b).setSpatialReference(d))});this._successHandler([k],"onCutComplete",e,f)}catch(r){this._errorHandler(r,g,f)}},onCutComplete:function(){},intersect:function(a,b,c,d){var e=a[0].spatialReference;a=f.mixin({},this._url.query,{f:"json",sr:l.toJson(e.toJson()),geometries:l.toJson(this._encodeGeometries(a)),
geometry:l.toJson({geometryType:s.getJsonType(b),geometry:b.toJson()})});var h=this._intersectHandler,r=this._errorHandler,u=new k(g._dfdCanceller);u._pendingDfd=m({url:this._url.path+"/intersect",content:a,callbackParamName:"callback",load:function(b,a){h(b,a,e,c,d,u)},error:function(b){r(b,d,u)}});return u},_intersectHandler:function(c,b,d,e,g,f){try{var h=[];a.forEach(c.geometries,function(b){h.push(s.fromJson(b).setSpatialReference(d))});this._successHandler([h],"onIntersectComplete",e,f)}catch(k){this._errorHandler(k,
g,f)}},onIntersectComplete:function(){},difference:function(a,b,c,d){var e=a[0].spatialReference;a=f.mixin({},this._url.query,{f:"json",sr:l.toJson(e.toJson()),geometries:l.toJson(this._encodeGeometries(a)),geometry:l.toJson({geometryType:s.getJsonType(b),geometry:b.toJson()})});var h=this._differenceHandler,r=this._errorHandler,u=new k(g._dfdCanceller);u._pendingDfd=m({url:this._url.path+"/difference",content:a,callbackParamName:"callback",load:function(b,a){h(b,a,e,c,d,u)},error:function(b){r(b,
d,u)}});return u},_differenceHandler:function(c,b,d,e,g,f){try{var h=[];a.forEach(c.geometries,function(b){h.push(s.fromJson(b).setSpatialReference(d))});this._successHandler([h],"onDifferenceComplete",e,f)}catch(k){this._errorHandler(k,g,f)}},onDifferenceComplete:function(){},buffer:function(a,b,c){var d=f.mixin({},this._url.query,{f:"json"},a.toJson()),e=a.outSpatialReference||a.geometries[0].spatialReference,h=this._bufferHandler,r=this._errorHandler,s=new k(g._dfdCanceller);s._pendingDfd=m({url:this._url.path+
"/buffer",content:d,callbackParamName:"callback",load:function(a,d){h(a,d,e,b,c,s)},error:function(b){r(b,c,s)}});return s},_bufferHandler:function(a,b,c,d,e,g){try{var f=a.geometries;a=[];var h,k=f.length;for(h=0;h<k;h++)a[h]=new r({spatialReference:c,rings:f[h].rings});this._successHandler([a],"onBufferComplete",d,g)}catch(s){this._errorHandler(s,e,g)}},onBufferComplete:function(){},areasAndLengths:function(a,b,c){a=f.mixin({},this._url.query,{f:"json"},a.toJson());var d=this._areasAndLengthsHandler,
e=this._errorHandler,h=new k(g._dfdCanceller);h._pendingDfd=m({url:this._url.path+"/areasAndLengths",content:a,callbackParamName:"callback",load:function(a,e){d(a,e,b,c,h)},error:function(b){e(b,c,h)}});return h},_areasAndLengthsHandler:function(a,b,c,d,e){try{this._successHandler([a],"onAreasAndLengthsComplete",c,e)}catch(g){this._errorHandler(g,d,e)}},onAreasAndLengthsComplete:function(){},lengths:function(a,b,c){a=f.mixin({},this._url.query,{f:"json"},a.toJson());var d=this._lengthsHandler,e=this._errorHandler,
h=new k(g._dfdCanceller);h._pendingDfd=m({url:this._url.path+"/lengths",content:a,callbackParamName:"callback",load:function(a,e){d(a,e,b,c,h)},error:function(b){e(b,c,h)}});return h},_lengthsHandler:function(a,b,c,d,e){try{this._successHandler([a],"onLengthsComplete",c,e)}catch(g){this._errorHandler(g,d,e)}},onLengthsComplete:function(){},labelPoints:function(c,b,d){var e=a.map(c,function(b){return b.toJson()}),h=c[0].spatialReference,e=f.mixin({},this._url.query,{f:"json",sr:h.wkid?h.wkid:l.toJson(h.toJson()),
polygons:l.toJson(e)}),r=this._labelPointsHandler,s=this._errorHandler,u=new k(g._dfdCanceller);u._pendingDfd=m({url:this._url.path+"/labelPoints",content:e,callbackParamName:"callback",load:function(a,e){r(a,e,c,h,b,d,u)},error:function(b){s(b,d,u)}});return u},_labelPointsHandler:function(c,b,d,e,g,f,h){try{var k=[];a.forEach(c.labelPoints,function(b){k.push(s.fromJson(b).setSpatialReference(e))});this._successHandler([k],"onLabelPointsComplete",g,h)}catch(r){this._errorHandler(r,f,h)}},onLabelPointsComplete:function(){},
relation:function(a,b,c){a=f.mixin({},this._url.query,{f:"json"},a.toJson());var d=this._relationHandler,e=this._errorHandler,h=new k(g._dfdCanceller);h._pendingDfd=m({url:this._url.path+"/relation",content:a,callbackParamName:"callback",load:function(a,e){d(a,e,b,c,h)},error:function(b){e(b,c,h)}});return h},_relationHandler:function(a,b,c,d,e){try{this._successHandler([a.relations],"onRelationComplete",c,e)}catch(g){this._errorHandler(g,d,e)}},onRelationComplete:function(){},trimExtend:function(a,
b,c){var d=f.mixin({},this._url.query,{f:"json"},a.toJson()),e=a.sr,h=this._trimExtendHandler,r=this._errorHandler,s=new k(g._dfdCanceller);s._pendingDfd=m({url:this._url.path+"/trimExtend",content:d,callbackParamName:"callback",load:function(a,d){h(a,d,e,b,c,s)},error:function(b){r(b,c,s)}});return s},_trimExtendHandler:function(a,b,c,e,g,f){try{var h=a.geometries;a=[];var k,r=h.length;for(k=0;k<r;k++)a[k]=new d({spatialReference:c,paths:h[k].paths});this._successHandler([a],"onTrimExtendComplete",
e,f)}catch(s){this._errorHandler(s,g,f)}},onTrimExtendComplete:function(){},densify:function(a,b,c){var d=f.mixin({},this._url.query,{f:"json"},a.toJson()),e=a.geometries[0].spatialReference,h=this._densifyHandler,r=this._errorHandler,s=new k(g._dfdCanceller);s._pendingDfd=m({url:this._url.path+"/densify",content:d,callbackParamName:"callback",load:function(a,d){h(a,d,e,b,c,s)},error:function(b){r(b,c,s)}});return s},_densifyHandler:function(c,b,d,e,g,f){try{var h=[];a.forEach(c.geometries,function(b){h.push(s.fromJson(b).setSpatialReference(d))});
this._successHandler([h],"onDensifyComplete",e,f)}catch(k){this._errorHandler(k,g,f)}},onDensifyComplete:function(){},generalize:function(a,b,c){var d=f.mixin({},this._url.query,{f:"json"},a.toJson()),e=a.geometries[0].spatialReference,h=this._generalizeHandler,r=this._errorHandler,s=new k(g._dfdCanceller);s._pendingDfd=m({url:this._url.path+"/generalize",content:d,callbackParamName:"callback",load:function(a,d){h(a,d,e,b,c,s)},error:function(b){r(b,c,s)}});return s},_generalizeHandler:function(c,
b,d,e,g,f){try{var h=[];a.forEach(c.geometries,function(b){h.push(s.fromJson(b).setSpatialReference(d))});this._successHandler([h],"onGeneralizeComplete",e,f)}catch(k){this._errorHandler(k,g,f)}},onGeneralizeComplete:function(){},offset:function(a,b,c){var d=f.mixin({},this._url.query,{f:"json"},a.toJson()),e=a.geometries[0].spatialReference,h=this._offsetHandler,r=this._errorHandler,s=new k(g._dfdCanceller);s._pendingDfd=m({url:this._url.path+"/offset",content:d,callbackParamName:"callback",load:function(a,
d){h(a,d,e,b,c,s)},error:function(b){r(b,c,s)}});return s},_offsetHandler:function(c,b,d,e,g,f){try{var h=[];a.forEach(c.geometries,function(b){h.push(s.fromJson(b).setSpatialReference(d))});this._successHandler([h],"onOffsetComplete",e,f)}catch(k){this._errorHandler(k,g,f)}},onOffsetComplete:function(){},distance:function(a,b,c){var d=f.mixin({},this._url.query,{f:"json"},a.toJson()),e=a.geometry1.spatialReference,h=this._distanceHandler,r=this._errorHandler,s=new k(g._dfdCanceller);s._pendingDfd=
m({url:this._url.path+"/distance",content:d,callbackParamName:"callback",load:function(a,d){h(a,d,e,b,c,s)},error:function(b){r(b,c,s)}});return s},_distanceHandler:function(a,b,c,d,e,g){try{a=a&&a.distance,this._successHandler([a],"onDistanceComplete",d,g)}catch(f){this._errorHandler(f,e,g)}},onDistanceComplete:function(){},toGeoCoordinateString:function(a,b,c){var d={};f.isObject(a.sr)?d.sr=a.sr.wkid||l.toJson(a.sr.toJson()):d.sr=a.sr;d.coordinates=l.toJson(a.coordinates);d.conversionType=a.conversionType||
"MGRS";d.conversionMode=a.conversionMode;d.numOfDigits=a.numOfDigits;d.rounding=a.rounding;d.addSpaces=a.addSpaces;a=f.mixin({},this._url.query,{f:"json"},d);var e=this._toGeoCoordinateHandler,h=this._errorHandler,r=new k(g._dfdCanceller);r._pendingDfd=m({url:this._url.path+"/toGeoCoordinateString",content:a,callbackParamName:"callback",load:function(a,d){e(a,d,b,c,r)},error:function(b){h(b,c,r)}});return r},_toGeoCoordinateHandler:function(a,b,c,d,e){try{this._successHandler([a.strings],"onToGeoCoordinateStringComplete",
c,e)}catch(g){this._errorHandler(g,d,e)}},onToGeoCoordinateStringComplete:function(){},fromGeoCoordinateString:function(a,b,c){var d={};f.isObject(a.sr)?d.sr=a.sr.wkid||l.toJson(a.sr.toJson()):d.sr=a.sr;d.strings=l.toJson(a.strings);d.conversionType=a.conversionType||"MGRS";d.conversionMode=a.conversionMode;a=f.mixin({},this._url.query,{f:"json"},d);var e=this._fromGeoCoordinateHandler,h=this._errorHandler,r=new k(g._dfdCanceller);r._pendingDfd=m({url:this._url.path+"/fromGeoCoordinateString",content:a,
callbackParamName:"callback",load:function(a,d){e(a,d,b,c,r)},error:function(b){h(b,c,r)}});return r},_fromGeoCoordinateHandler:function(a,b,c,d,e){try{this._successHandler([a.coordinates],"onToGeoCoordinateStringComplete",c,e)}catch(g){this._errorHandler(g,d,e)}},onFromGeoCoordinateStringComplete:function(){}});f.mixin(p,{UNIT_METER:9001,UNIT_GERMAN_METER:9031,UNIT_FOOT:9002,UNIT_SURVEY_FOOT:9003,UNIT_CLARKE_FOOT:9005,UNIT_FATHOM:9014,UNIT_NAUTICAL_MILE:9030,UNIT_SURVEY_CHAIN:9033,UNIT_SURVEY_LINK:9034,
UNIT_SURVEY_MILE:9035,UNIT_KILOMETER:9036,UNIT_CLARKE_YARD:9037,UNIT_CLARKE_CHAIN:9038,UNIT_CLARKE_LINK:9039,UNIT_SEARS_YARD:9040,UNIT_SEARS_FOOT:9041,UNIT_SEARS_CHAIN:9042,UNIT_SEARS_LINK:9043,UNIT_BENOIT_1895A_YARD:9050,UNIT_BENOIT_1895A_FOOT:9051,UNIT_BENOIT_1895A_CHAIN:9052,UNIT_BENOIT_1895A_LINK:9053,UNIT_BENOIT_1895B_YARD:9060,UNIT_BENOIT_1895B_FOOT:9061,UNIT_BENOIT_1895B_CHAIN:9062,UNIT_BENOIT_1895B_LINK:9063,UNIT_INDIAN_FOOT:9080,UNIT_INDIAN_1937_FOOT:9081,UNIT_INDIAN_1962_FOOT:9082,UNIT_INDIAN_1975_FOOT:9083,
UNIT_INDIAN_YARD:9084,UNIT_INDIAN_1937_YARD:9085,UNIT_INDIAN_1962_YARD:9086,UNIT_INDIAN_1975_YARD:9087,UNIT_FOOT_1865:9070,UNIT_RADIAN:9101,UNIT_DEGREE:9102,UNIT_ARCMINUTE:9103,UNIT_ARCSECOND:9104,UNIT_GRAD:9105,UNIT_GON:9106,UNIT_MICRORADIAN:9109,UNIT_ARCMINUTE_CENTESIMAL:9112,UNIT_ARCSECOND_CENTESIMAL:9113,UNIT_MIL6400:9114,UNIT_BRITISH_1936_FOOT:9095,UNIT_GOLDCOAST_FOOT:9094,UNIT_INTERNATIONAL_CHAIN:109003,UNIT_INTERNATIONAL_LINK:109004,UNIT_INTERNATIONAL_YARD:109001,UNIT_STATUTE_MILE:9093,UNIT_SURVEY_YARD:109002,
UNIT_50KILOMETER_LENGTH:109030,UNIT_150KILOMETER_LENGTH:109031,UNIT_DECIMETER:109005,UNIT_CENTIMETER:109006,UNIT_MILLIMETER:109007,UNIT_INTERNATIONAL_INCH:109008,UNIT_US_SURVEY_INCH:109009,UNIT_INTERNATIONAL_ROD:109010,UNIT_US_SURVEY_ROD:109011,UNIT_US_NAUTICAL_MILE:109012,UNIT_UK_NAUTICAL_MILE:109013,UNIT_SQUARE_INCHES:"esriSquareInches",UNIT_SQUARE_FEET:"esriSquareFeet",UNIT_SQUARE_YARDS:"esriSquareYards",UNIT_ACRES:"esriAcres",UNIT_SQUARE_MILES:"esriSquareMiles",UNIT_SQUARE_MILLIMETERS:"esriSquareMillimeters",
UNIT_SQUARE_CENTIMETERS:"esriSquareCentimeters",UNIT_SQUARE_DECIMETERS:"esriSquareDecimeters",UNIT_SQUARE_METERS:"esriSquareMeters",UNIT_ARES:"esriAres",UNIT_HECTARES:"esriHectares",UNIT_SQUARE_KILOMETERS:"esriSquareKilometers"});return p})},"esri/layers/FeatureLayer":function(){define("require module dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/date/locale dojo/sniff dojo/io-query dojo/dom-construct dojo/i18n dojo/when dojo/promise/all ../kernel ../lang ../request ../config ../deferredUtils ../SpatialReference ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/jsonUtils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/jsonUtils ../tasks/QueryTask ../tasks/query ../tasks/FeatureSet ../tasks/StatisticDefinition ../geometry/Extent ../geometry/jsonUtils ../geometry/normalizeUtils ../geometry/scaleUtils ./GraphicsLayer ./Field ./TimeInfo ./FeatureType ./FeatureTemplate ./FeatureEditResult ./LabelClass ./SnapshotMode ./OnDemandMode ./SelectionMode ./StreamMode ./TrackManager ./HeatmapManager dojo/i18n!../nls/jsapi require".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A,B,F,E,H,I,M,Q,K,J,O,G,T,P,V,L,C,X,Y,la,aa,ga,qa,za,ia,oa,xa){var sa=n.defaults,ea=a(P,{declaredClass:"esri.layers.FeatureLayer",invalidParams:"query contains one or more unsupported parameters",reHostedFS:/(https?:)?\/\/services.*\.arcgis\.com/i,maxPointCountForAuto:4E3,maxRecordCountForAuto:2E3,maxVertexCountForAuto:25E4,generalizeForScale:4E3,_eventMap:{"add-attachment-complete":["result"],"before-apply-edits":["adds","updates","deletes"],
"delete-attachments-complete":["results"],"edits-complete":["adds","updates","deletes"],"query-attachment-infos-complete":["results"],"query-count-complete":["count"],"query-features-complete":["featureSet"],"query-ids-complete":["objectIds"],"query-related-features-complete":["featureSets"],"selection-complete":["features","method"],"update-end":["error","info"]},constructor:function(b,a){this._preventInit||this._initFeatureLayer(b,a)},_initFeatureLayer:function(a,c){this.i18n=xa;c=c||{};this.showLabels=
null!=c.showLabels?c.showLabels:!0;this._outFields=c.outFields;this._defnExpr=c.definitionExpression;this._loadCallback=c.loadCallback;var d=c._usePatch;this._usePatch=null===d||void 0===d?!0:d;this._trackIdField=c.trackIdField;this.objectIdField=c.objectIdField;this._maxOffset=null!=c.maxAllowableOffset?c.maxAllowableOffset:this.maxAllowableOffset;this.quantize=null!=c.quantize?c.quantize:!0;this._optEditable=c.editable;this._optAutoGen=c.autoGeneralize;this.editSummaryCallback=c.editSummaryCallback;
this.userId=c.userId;this.userIsAdmin=c.userIsAdmin;this.useMapTime=c.hasOwnProperty("useMapTime")?!!c.useMapTime:!0;this.source=c.source;this.gdbVersion=c.gdbVersion;this.orderByFields=c.orderByFields;this.maxPointCountForAuto=null!=c.maxPointCountForAuto?c.maxPointCountForAuto:this.maxPointCountForAuto;this.maxRecordCountForAuto=null!=c.maxRecordCountForAuto?c.maxRecordCountForAuto:this.maxRecordCountForAuto;this.maxVertexCountForAuto=null!=c.maxVertexCountForAuto?c.maxVertexCountForAuto:this.maxVertexCountForAuto;
this.generalizeForScale=null!=c.generalizeForScale?c.generalizeForScale:this.generalizeForScale;this.queryPagination=null!=c.queryPagination?c.queryPagination:this.url?this.reHostedFS.test(this.url):!1;this.multipatchOption=c.multipatchOption;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var e=ea,d=this.mode=b.isDefined(c.mode)?c.mode:e.MODE_ONDEMAND;this._isStream&&(this.mode=d=e.MODE_STREAM);switch(d){case e.MODE_SNAPSHOT:this.currentMode=
e.MODE_SNAPSHOT;this._mode=new aa(this);this._isSnapshot=!0;break;case e.MODE_ONDEMAND:case e.MODE_AUTO:this.currentMode=e.MODE_ONDEMAND;this._tileWidth=c.tileWidth||512;this._tileHeight=c.tileHeight||512;this._mode=new ga(this);this.latticeTiling=c.latticeTiling;break;case e.MODE_SELECTION:this.currentMode=e.MODE_SELECTION;this._mode=new qa(this);this._isSelOnly=!0;break;case e.MODE_STREAM:this.currentMode=e.MODE_STREAM,this._mode=new za(this),this._isStream=!0}this._initLayer=k.hitch(this,this._initLayer);
this._selectHandler=k.hitch(this,this._selectHandler);this._editable=!1;if(k.isObject(a)&&a.layerDefinition)return this._collection=!0,this.mode=this._isStream?e.MODE_STREAM:e.MODE_SNAPSHOT,this._initLayer(a),this;this._task=new I(this.url,{source:this.source,gdbVersion:this.gdbVersion});d=this._url.path;this._fserver=!1;-1!==d.search(/\/FeatureServer\//i)&&(this._fserver=!0);this.mode===e.MODE_AUTO&&this.reHostedFS.test(this.url)&&this._queryLimit();(e=c.resourceInfo)?this._initLayer(e):(this.source&&
(e={source:this.source.toJson()},this._url.query=k.mixin(this._url.query,{layer:q.toJson(e)})),this.gdbVersion&&(this._url.query=k.mixin(this._url.query,{gdbVersion:this.gdbVersion})),v({url:d,content:k.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler}));this.registerConnectEvents()},_initLayer:function(a,c){if(a||c){this._json=a;this._findCredential();if(this.credential&&this.credential.ssl||a&&a._ssl)this._useSSL(),this._task._useSSL();
this.version=a.currentVersion;this.version||(this.version="capabilities"in a||"drawingInfo"in a||"hasAttachments"in a||"htmlPopupType"in a||"relationships"in a||"timeInfo"in a||"typeIdField"in a||"types"in a?10:9.3);this._collection&&(this._isStream||(this.currentMode=ea.MODE_SNAPSHOT,this._mode=new aa(this)),this._isSnapshot=!0,this._featureSet=a.featureSet,this._nextId=a.nextObjectId,a=a.layerDefinition);this.geometryType=a.geometryType;"string"!==typeof this.multipatchOption&&"esriGeometryMultiPatch"===
this.geometryType&&(this.multipatchOption="xyFootprint");if(a.hasOwnProperty("capabilities")){var d=this.capabilities=a.capabilities;d&&-1!==d.toLowerCase().indexOf("editing")?this._editable=!0:this._editable=!1}else this._collection||(this._editable=this._fserver);b.isDefined(this._optEditable)?(this._editable=this._optEditable,delete this._optEditable):"esriGeometryMultiPatch"===this.geometryType&&(this._editable=!1);this._json=q.toJson(this._json);if(this.isEditable())this._setMaxOffset(null);
else if(this.mode!==ea.MODE_SNAPSHOT&&("esriGeometryPolyline"===this.geometryType||"esriGeometryPolygon"===this.geometryType||this.hasXYFootprint()))this._autoGeneralize=b.isDefined(this._optAutoGen)?this._optAutoGen:this.mode===ea.MODE_ONDEMAND||this.mode===ea.MODE_AUTO,delete this._optAutoGen;var d=a.effectiveMinScale||a.minScale,g=a.effectiveMaxScale||a.maxScale;!this._hasMin&&d&&this.setMinScale(d);!this._hasMax&&g&&this.setMaxScale(g);this.layerId=a.id;this.name=a.name;this.description=a.description;
this.copyright=a.copyrightText;this.type=a.type;this.displayField=a.displayField;this.defaultDefinitionExpression=a.definitionExpression;this.fullExtent=new J(a.extent);this.initialExtent=new J(this.fullExtent.toJson());this.fullExtent.spatialReference&&(this.spatialReference=new x(this.fullExtent.spatialReference.toJson()));this.defaultVisibility=a.defaultVisibility;if("esriGeometryPoint"===this.geometryType||"esriGeometryMultipoint"===this.geometryType)this.latticeTiling=!1;this.hasM=a.hasM||!1;
this.hasZ=a.hasZ||!1;this.indexedFields=a.indexedFields;this.maxRecordCount=a.maxRecordCount;this.canModifyLayer=a.canModifyLayer;this.supportsStatistics=a.supportsStatistics;this.supportsAdvancedQueries=this._collection?!1:a.supportsAdvancedQueries;this.supportsCalculate=a.supportsCalculate;this.supportsAttachmentsByUploadId=a.supportsAttachmentsByUploadId;this.supportsCoordinatesQuantization=a.supportsCoordinatesQuantization;this.quantize=this.quantize&&this.supportsCoordinatesQuantization;this.hasLabels=
a.hasLabels;this.canScaleSymbols=a.canScaleSymbols;this.supportsRollbackOnFailureParameter=this.supportsRollbackOnFailure=a.supportsRollbackOnFailure;this.syncCanReturnChanges=a.syncCanReturnChanges;this.isDataVersioned=a.isDataVersioned;this.editFieldsInfo=a.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=a.ownershipBasedAccessControlForFeatures;this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures&&(this.creatorField=this.editFieldsInfo.creatorField);this.relationships=a.relationships;
this.allowGeometryUpdates=b.isDefined(a.allowGeometryUpdates)?a.allowGeometryUpdates:!0;this.advancedQueryCapabilities=a.advancedQueryCapabilities||{supportsStatistics:this.supportsStatistics,supportsOrderBy:this.supportsAdvancedQueries,supportsDistinct:this.supportsAdvancedQueries};this.useStandardizedQueries=a.useStandardizedQueries;this.tileMaxRecordCount=a.tileMaxRecordCount;this.standardMaxRecordCount=a.standardMaxRecordCount;this._setMaxOffset(this._maxOffset,!0);this._isTable="Table"===this.type;
for(var f=this.fields=[],g=a.fields,d=0;d<g.length;d++)f.push(new V(g[d]));if(!this.objectIdField){this.objectIdField=a.objectIdField;if(!this.objectIdField){g=a.fields;for(d=0;d<g.length;d++)if(f=g[d],"esriFieldTypeOID"===f.type){this.objectIdField=f.name;break}}!this.objectIdField&&!this._isStream&&console.debug("esri.layers.FeatureLayer: "+b.substitute({url:this.url},"objectIdField is not set [url: ${url}]"))}if(!b.isDefined(this._nextId)){g=this.objectIdField;f=-1;if(this._collection&&g)for(var n=
(d=this._featureSet)&&d.features,r=n?n.length:0,s,d=0;d<r;d++)s=(s=n[d].attributes)&&s[g],s>f&&(f=s);this._nextId=f+1}this.globalIdField=a.globalIdField;if(d=this.typeIdField=a.typeIdField)if(d=!this._getField(d)&&this._getField(d,!0))this.typeIdField=d.name;this.visibilityField=a.visibilityField;if(g=a.defaultSymbol)this.defaultSymbol=B.fromJson(g);var m=this.types=[],t=a.types,l,u,f=(d=this.editFieldsInfo)&&d.creatorField,n=d&&d.editorField;s=f||n;r=[];if(t)for(d=0;d<t.length;d++)l=new C(t[d]),
u=l.templates,s&&(u&&u.length)&&(r=r.concat(u)),m.push(l);t=a.templates;l=this.templates=[];if(t)for(d=0;d<t.length;d++)m=new X(t[d]),s&&r.push(m),l.push(m);for(d=0;d<r.length;d++)if(s=k.getObject("prototype.attributes",!1,r[d]))f&&delete s[f],n&&delete s[n];if(d=a.timeInfo)this.timeInfo=new L(d),this._startTimeField=d.startTimeField,this._endTimeField=d.endTimeField,this._startTimeField&&this._endTimeField&&(this._twoTimeFields=!0),this._trackIdField?d.trackIdField=this._trackIdField:this._trackIdField=
d.trackIdField;this.hasAttachments=!this._collection&&a.hasAttachments?!0:!1;this.htmlPopupType=a.htmlPopupType;var d=a.drawingInfo,w;if((f=d&&d.labelingInfo)&&!this.labelingInfo)this.labelingInfo=h.map(f,function(b){return new la(b)}),this._fixLabelExpr();if(!this.renderer)if(d&&d.renderer){if(w=d.renderer,this.setRenderer(H.fromJson(w)),"classBreaks"===w.type&&this.renderer.setMaxInclusive(!0),!this._collection){var v=w.type,g=[];w=this.renderer;switch(v){case "simple":g.push(w.symbol);break;case "uniqueValue":case "classBreaks":g.push(w.defaultSymbol),
g=g.concat(h.map(w.infos,function(b){return b.symbol}))}var g=h.filter(g,b.isDefined),p=this._url.path+"/images/",M=this._getToken();h.forEach(g,function(b){var a=b.url;a&&(-1===a.search(/https?\:/)&&-1===a.indexOf("data:")&&(b.url=p+a),M&&-1!==b.url.search(/https?\:/)&&(b.url+="?token\x3d"+M))})}}else if(g)t=this.types,0<t.length?(w=new E(this.defaultSymbol,this.typeIdField),h.forEach(t,function(b){w.addValue(b.id,b.symbol)})):w=new F(this.defaultSymbol),this.setRenderer(w);else if(!this._isTable){switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":v=
new z;break;case "esriGeometryPolyline":v=new y;break;case "esriGeometryPolygon":v=new A;break;default:this.hasXYFootprint()&&(v=new A)}this.setRenderer(v?new F(v):null)}v=d&&d.transparency||0;!this.hasOwnProperty("opacity")&&0<v&&(this.opacity=1-v/100);if((e("ie")||7<=e("trident")||e("safari"))&&this.isEditable()&&10.02>this.version)this._ts=!0;this.statistics=a.statistics;this._fixRendererFields();this._checkFields();this._updateCaps();var I=function(){this.currentMode!==ea.MODE_SNAPSHOT&&(this.queryPagination=
!1);null!=this._maxOffset&&!this._isFractionalOffsetAllowed()&&this._setMaxOffset(this._maxOffset);this.loaded=!0;this.onLoad(this);var b=this._loadCallback;b&&(delete this._loadCallback,b(this))};this._collection?(v=this._featureSet,this._featureSet=null,this._mode._drawFeatures(new Q(v)),this._fcAdded=!0,I.call(this)):this._forceIdentity(this._limitPromise?function(){var b=this;this._limitPromise.then(function(a){b._checkMode(a)});this._limitPromise.always(function(){b._limitPromise=null;I.call(b)})}:
I)}},setShowLabels:function(b){this.showLabels=b;this.onShowLabelsChange()},onShowLabelsChange:function(){},onRendererChange:function(a){this.inherited(arguments);var c=this._map;this._ager=!(!a||!a.observationAger||!a.observationRenderer);a&&"colors"in a&&"blurRadius"in a&&"maxPixelIntensity"in a?"esriGeometryPoint"==this.geometryType&&(!this._heatmapManager&&c)&&(this._heatmapManager=new oa(this),this._heatmapManager.initialize(c)):this.renderer&&this.renderer.getRendererInfo?h.some(this.renderer.rendererInfos,
function(b){return b.renderer&&"colors"in b.renderer&&"blurRadius"in b.renderer})||(this._heatmapManager=null):this._heatmapManager=null;if(a){var d=[],c=h.filter([a,a.observationRenderer,a.latestObservationRenderer,a.trackRenderer],b.isDefined),e=function(b){return null!=b&&"function"!=typeof b&&b};h.forEach(c,function(b){var a=e(b.attributeField),c=e(b.attributeField2);b=e(b.attributeField3);!1!==a&&d.push(a);!1!==c&&d.push(c);!1!==b&&d.push(b)});this._rendererFields=d}else this._rendererFields=
[];this.loaded&&(this._fixRendererFields(),this._checkFields(this._rendererFields),this._collection&&(this._typesDirty=!0))},redraw:function(){this.inherited(arguments);this._trackManager&&this._trackManager.container&&this._trackManager.container.redraw()},_evalSDRenderer:function(){this.inherited(arguments);var b=this._getRenderer();this._ager=!(!b||!b.observationAger||!b.observationRenderer);this._trackManager&&this._trackManager.container&&this._trackManager.container.setRenderer(b&&b.trackRenderer)},
_setMap:function(b){var a=this.inherited(arguments),c=this._mode,d=this;c&&c.initialize(b);this.geometryType&&this.attr("data-geometry-type",this.geometryType.replace(/esriGeometry/i,"").toLowerCase());this._addHandle=this.on("graphic-node-add",function(b){b=b.graphic.attributes;(b=d._selectedFeatures[b&&b[d.objectIdField]])&&b.attr("data-selected","")});return a},_unsetMap:function(b){var a=this._mode;a&&a.suspend();this._trackManager&&(this._trackManager.destroy(),this._trackManager=null);l.disconnect(this._zoomConnect);
l.disconnect(this._addHandle);this._zoomConnect=this._addHandle=null;this._toggleTime(!1);this.inherited("_unsetMap",arguments)},refresh:function(){this._needsRefresh=!1;var b=this._mode;b&&b.refresh()},hasXYFootprint:function(){return"esriGeometryMultiPatch"===this.geometryType&&"xyFootprint"===this.multipatchOption},getOutFields:function(){return h.filter(this._getOutFields(),function(b){return"*"===b||!!this._getField(b)},this)},getField:function(b){return this._getField(b,!0)},getFieldLabel:function(b){var a=
this.infoTemplate,a=a&&a.getFieldInfo&&a.getFieldInfo(b);b=k.isFunction(b)?null:this.getField(b);var c=a||b,d="";c&&(d=a&&a.label||b&&b.alias||c.name||c.fieldName);return d},getDomain:function(b,a){var c,d,e=a&&a.feature,g=e&&this.typeIdField&&e.attributes&&e.attributes[this.typeIdField];null!=g&&h.some(this.types,function(a){if(a.id==g){if((c=a.domains&&a.domains[b])&&"inherited"===c.type)c=this._getLayerDomain(b),d=!0;return!0}return!1},this);!d&&!c&&(c=this._getLayerDomain(b));return c},_getLayerDomain:function(b){var a;
h.some(this.fields,function(c){c.name===b&&(a=c.domain);return!!a});return a},getType:function(b){var a,c=b&&this.typeIdField&&b.attributes&&b.attributes[this.typeIdField];h.some(this.types,function(b){b.id==c&&(a=b);return!!a});return a},setEditable:function(b){if(!this._collection)return console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service"),this;if(!this.loaded)return this._optEditable=b,this;var a=this._editable;this._editable=b;this._updateCaps();
if(a!==b)this.onCapabilitiesChange();return this},getEditCapabilities:function(b){var a={canCreate:!1,canUpdate:!1,canDelete:!1};if(!this.loaded||!this.isEditable())return a;var c=b&&b.feature;b=b&&b.userId||this.getUserId();var d=h.map(this.capabilities?this.capabilities.toLowerCase().split(","):[],k.trim),e=(a=-1<h.indexOf(d,"editing"))&&-1<h.indexOf(d,"create"),g=a&&-1<h.indexOf(d,"update"),d=a&&-1<h.indexOf(d,"delete"),f=this.ownershipBasedAccessControlForFeatures,n=this.editFieldsInfo,r=n&&n.creatorField,
n=n&&n.realm,c=(c=c&&c.attributes)&&r?c[r]:void 0,s=!!this.userIsAdmin,r=!f||s||!(!f.allowOthersToUpdate&&!f.allowUpdateToOthers),m=!f||s||!(!f.allowOthersToDelete&&!f.allowDeleteToOthers),t=!f||s||!f.hasOwnProperty("allowAnonymousToUpdate")||f.allowAnonymousToUpdate,f=!f||s||!f.hasOwnProperty("allowAnonymousToDelete")||f.allowAnonymousToDelete;b&&n&&(b=b+"@"+n);if(s||a&&!e&&!g&&!d)e=g=d=!0;a={canCreate:e,canUpdate:g,canDelete:d};b||(a.canUpdate=a.canUpdate&&t,a.canDelete=a.canDelete&&f);null===c?
(a.canUpdate=a.canUpdate&&r,a.canDelete=a.canDelete&&m):""!==c&&(c&&b.toLowerCase()!==c.toLowerCase())&&(a.canUpdate=a.canUpdate&&r,a.canDelete=a.canDelete&&m);return a},getUserId:function(){var b;this.loaded&&(b=this.credential&&this.credential.userId||this.userId||"");return b},setUserIsAdmin:function(b){this.userIsAdmin=b},setEditSummaryCallback:function(b){this.editSummaryCallback=b},getEditSummary:function(a,c,d){d=b.isDefined(d)?d:(new Date).getTime();var e="";d=this.getEditInfo(a,c,d);(c=c&&
c.callback||this.editSummaryCallback)&&(d=c(a,d)||"");if(k.isString(d))e=d;else{if(d){a=d.action;c=d.userId;var g=d.timeValue,f=0;a&&f++;c&&f++;b.isDefined(g)&&f++;1<f&&(e=("edit"===a?"edit":"create")+(c?"User":"")+(b.isDefined(g)?d.displayPattern:""))}e=e&&b.substitute(d,this.i18n.layers.FeatureLayer[e])}return e},getEditInfo:function(a,c,d){if(this.loaded){d=b.isDefined(d)?d:(new Date).getTime();c=c&&c.action||"last";var e=this.editFieldsInfo,g=e&&e.creatorField,f=e&&e.creationDateField,n=e&&e.editorField,
e=e&&e.editDateField,n=(a=a&&a.attributes)&&n?a[n]:void 0,e=a&&e?a[e]:null,g=this._getEditData(a&&g?a[g]:void 0,a&&f?a[f]:null,d);d=this._getEditData(n,e,d);var h;switch(c){case "creation":h=g;break;case "edit":h=d;break;case "last":h=d||g}h&&(h.action=h===d?"edit":"creation");return h}},_getEditData:function(a,c,d){var e,f,n;b.isDefined(c)&&(f=d-c,n=0>f?"Full":6E4>f?"Seconds":12E4>f?"Minute":36E5>f?"Minutes":72E5>f?"Hour":864E5>f?"Hours":6048E5>f?"WeekDay":"Full");if(void 0!==a||n)e=e||{},e.userId=
a,n&&(a=g.format,d=new Date(c),e.minutes=Math.floor(f/6E4),e.hours=Math.floor(f/36E5),e.weekDay=a(d,{datePattern:"EEEE",selector:"date"}),e.formattedDate=a(d,{selector:"date"}),e.formattedTime=a(d,{selector:"time"}),e.displayPattern=n,e.timeValue=c);return e},isEditable:function(){return!(!this._editable&&!this.userIsAdmin)},setMaxAllowableOffset:function(b){this.isEditable()||this._setMaxOffset(b,!0);return this},getMaxAllowableOffset:function(){var b=this._quantizationParameters?this._quantizationParameters.tolerance:
void 0;return null!=this._maxOffset?this._maxOffset:b},_setMaxOffset:function(b,a){if(null==b)return delete this._maxOffset,delete this._quantizationParameters,this;if(this.quantize&&this.supportsCoordinatesQuantization)"esriGeometryPolyline"===this.geometryType?this._maxOffset=b:delete this._maxOffset,this._quantizationParameters={mode:"view",originPosition:"upperLeft",tolerance:b,extent:this.fullExtent};else{if(!this._isFractionalOffsetAllowed()||!a)b=Math.floor(b);isNaN(b)||0===b?delete this._maxOffset:
this._maxOffset=b;delete this._quantizationParameters}return this},_isFractionalOffsetAllowed:function(){return null==this.version||10.1<=this.version||navigator.languages&&this._isLangWithDot(navigator.languages[0])},_isLangWithDot:function(b){b=(b=b&&b.split("-"))&&b[0]&&b[0].toLowerCase();return-1!==h.indexOf(this._langsWithDot,b)},_langsWithDot:"ar en et fr he ja ko th vi zh".split(" "),setAutoGeneralize:function(b){if(this.loaded){if(!this.isEditable()&&this.mode!==ea.MODE_SNAPSHOT&&("esriGeometryPolyline"===
this.geometryType||"esriGeometryPolygon"===this.geometryType||this.hasXYFootprint()))(this._autoGeneralize=b)?(this._autoSnapshot&&(this._prevScale=null),this._updateMaxOffset()):this._setMaxOffset(null)}else this._optAutoGen=b;return this},setGDBVersion:function(b){if(!this._collection&&b!==this.gdbVersion&&(b||this.gdbVersion))this.gdbVersion=b,this._task.gdbVersion=b,this._url.query=k.mixin(this._url.query,{gdbVersion:b}),this.loaded&&(this.clearSelection(),this._map&&this.refresh()),this.onGDBVersionChange();
return this},setDefinitionExpression:function(b){this._defnExpr=b;(b=this._mode)&&b.propertyChangeHandler(1);return this},getDefinitionExpression:function(){return this._defnExpr},setTimeDefinition:function(b){this._isSnapshot?(this._timeDefn=b,(b=this._mode)&&b.propertyChangeHandler(2)):console.log("FeatureLayer.setTimeDefinition: layer in on-demand or selection mode does not support time definitions. Layer id \x3d "+this.id+", Layer URL \x3d "+this.url);return this},getTimeDefinition:function(){return this._timeDefn},
setTimeOffset:function(b,a){this._timeOffset=b;this._timeOffsetUnits=a;var c=this._mode;c&&c.propertyChangeHandler(0);return this},setUseMapTime:function(b){this.useMapTime=b;this._toggleTime(!this.suspended);(b=this._mode)&&b.propertyChangeHandler(0)},selectFeatures:function(b,a,c,d){a=a||ea.SELECTION_NEW;b=this._getShallowClone(b);var e=this._map,g,f=this,n=w._fixDfd(new m(w._dfdCanceller));b.outFields=this.getOutFields();b.returnGeometry=!0;b.multipatchOption=this.multipatchOption;e&&(b.outSpatialReference=
new x(e.spatialReference.toJson()));if(!this._applyQueryFilters(b,!0))return g={features:[]},this._selectHandler(g,a,c,d,n),n;if(e=this._canDoClientSideQuery(b))n._pendingDfd=u(this._doQuery(b,e)),n._pendingDfd.then(function(b){g={features:b};f._selectHandler(g,a,c,d,n)});else{if(this._collection)return this._resolve([Error("FeatureLayer::selectFeatures - "+this.invalidParams)],null,d,n,!0),n;var h=this;this._ts&&(b._ts=(new Date).getTime());(n._pendingDfd=this._task.execute(b)).addCallbacks(function(b){h._selectHandler(b,
a,c,d,n)},function(b){h._resolve([b],null,d,n,!0)})}return n},getSelectedFeatures:function(){var b=this._selectedFeatures,a=[],c;for(c in b)b.hasOwnProperty(c)&&a.push(b[c]);return a},clearSelection:function(b){var a=this._selectedFeatures,c=this._mode,d;for(d in a)a.hasOwnProperty(d)&&(this._unSelectFeatureIIf(d,c),c._removeFeatureIIf(d));this._selectedFeatures={};this._isSelOnly&&c._applyTimeFilter(!0);if(!b)this.onSelectionClear();return this},setSelectionSymbol:function(b){if(this._selectionSymbol=
b){var a=this._selectedFeatures,c;for(c in a)a.hasOwnProperty(c)&&a[c].setSymbol(b)}return this},getSelectionSymbol:function(){return this._selectionSymbol},setLabelingInfo:function(b){b?(this.labelingInfo=b,this._fixLabelExpr()):delete this.labelingInfo;this._collection&&(this._typesDirty=!0);this.onLabelingInfoChange()},_fixLabelExpr:function(){var b=/\[([^\[\]]+)\]/ig,a,c=this,d=function(b,a){var d=c._getField(a,!0);return"["+(d&&d.name||a)+"]"};h.forEach(this.labelingInfo,function(c){if(a=c.labelExpression)c.labelExpression=
a.replace(b,d)})},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(b,a,c,d,e,g){var f=g.assembly,n=g.dfd;this._applyNormalized(b,f&&f[0]);this._applyNormalized(a,f&&f[1]);this.onBeforeApplyEdits(b,a,c);var r={},s=this.objectIdField,f={f:"json"},m=!1;if(this._collection)g={},g.addResults=b?h.map(b,function(){m=!0;return{objectId:this._nextId++,success:!0}},this):null,g.updateResults=a?h.map(a,function(b){m=!0;var a=b.attributes[s];r[a]=b;return{objectId:a,success:!0}},this):
null,g.deleteResults=c?h.map(c,function(b){m=!0;return{objectId:b.attributes[s],success:!0}},this):null,m?this._editHandler(g,b,r,d,e,n):this._resolve([g.addResults,g.updateResults,g.deleteResults],null,d,n);else{b&&0<b.length&&(f.adds=this._convertFeaturesToJson(b,0,1),m=!0);if(a&&0<a.length){for(g=0;g<a.length;g++){var t=a[g];r[t.attributes[s]]=t}f.updates=this._convertFeaturesToJson(a,0,0,1);m=!0}if(c&&0<c.length){a=[];for(g=0;g<c.length;g++)a.push(c[g].attributes[s]);f.deletes=a.join(",");m=!0}if(m){var l=
this;return v({url:this._url.path+"/applyEdits",content:k.mixin(f,this._url.query),callbackParamName:"callback",load:function(a){l._editHandler(a,b,r,d,e,n)},error:function(b){l._resolve([b],null,e,n,!0)}},{usePost:!0})}this._resolve([],null,d,n)}},queryFeatures:function(b,a,c){return this._query("execute","onQueryFeaturesComplete",b,a,c)},queryRelatedFeatures:function(b,a,c){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",b,a,c)},queryIds:function(b,a,c){return this._query("executeForIds",
"onQueryIdsComplete",b,a,c)},queryCount:function(b,a,c){return this._query("executeForCount","onQueryCountComplete",b,a,c)},queryExtent:function(b,a,c){return this._query("executeForExtent","onQueryExtentComplete",b,a,c)},queryAttachmentInfos:function(b,a,d){var e=this._url.path+"/"+b+"/attachments",g=new m(w._dfdCanceller),f=this;g._pendingDfd=v({url:e,content:k.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(d){d=d.attachmentInfos;var n;h.forEach(d,function(a){n=c.objectToQuery({gdbVersion:f._url.query&&
f._url.query.gdbVersion,layer:f._url.query&&f._url.query.layer,token:f._getToken()});a.url=e+"/"+a.id+(n?"?"+n:"");a.objectId=b});f._resolve([d],"onQueryAttachmentInfosComplete",a,g)},error:function(b){f._resolve([b],null,d,g,!0)}});return g},addAttachment:function(b,a,c,d){return this._sendAttachment("add",b,a,c,d)},updateAttachment:function(b,a,c,e,g){c.appendChild(d.create("input",{type:"hidden",name:"attachmentId",value:a}));return this._sendAttachment("update",b,c,e,g)},deleteAttachments:function(b,
a,c,d){var e=this._url.path+"/"+b+"/deleteAttachments",g=new m(w._dfdCanceller),f=this;a={f:"json",attachmentIds:a.join(",")};g._pendingDfd=v({url:e,content:k.mixin(a,this._url.query),callbackParamName:"callback",load:k.hitch(this,function(a){a=a.deleteAttachmentResults;a=h.map(a,function(a){a=new Y(a);a.attachmentId=a.objectId;a.objectId=b;return a});f._resolve([a],"onDeleteAttachmentsComplete",c,g)}),error:function(b){f._resolve([b],null,d,g,!0)}},{usePost:!0});return g},addType:function(b){var a=
this.types;if(a){if(h.some(a,function(a){return a.id==b.id?!0:!1}))return!1;a.push(b)}else this.types=[b];return this._typesDirty=!0},deleteType:function(b){if(this._collection){var a=this.types;if(a){var c=-1;h.some(a,function(a,d){return a.id==b?(c=d,!0):!1});if(-1<c)return this._typesDirty=!0,a.splice(c,1)[0]}}},toJson:function(){var b=this._json;if(b=k.isString(b)?q.fromJson(b):k.clone(b)){var b=b.layerDefinition?b:{layerDefinition:b},a=b.layerDefinition,c=this._collection;if(c&&this._typesDirty){a.types=
h.map(this.types||[],function(b){return b.toJson()});var d=this.renderer,e=this.labelingInfo,g=a.drawingInfo;if((d||e)&&!g)g=a.drawingInfo={};g&&(d&&-1===d.declaredClass.indexOf("TemporalRenderer"))&&(g.renderer=d.toJson());e&&(g.labelingInfo=h.map(e,function(b){return b.toJson()}))}d=null;if(!c||this._fcAdded)d={geometryType:a.geometryType,features:this._convertFeaturesToJson(this.graphics,!0)};b.featureSet=k.mixin({},b.featureSet||{},d);b.featureSet.transform&&(e=b.featureSet.transform,delete b.featureSet.transform,
d=new Q(b.featureSet),d.quantize(e),b.featureSet=d.toJson());c&&(b.nextObjectId=this._nextId,a.capabilities=this.capabilities);return b}},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryExtentComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},
onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},onLabelingInfoChange:function(){},_forceIdentity:function(b){var a=this,c,d=this._url&&this._url.path;c=d&&d.toLowerCase().indexOf("/rest/services");var e=this.editFieldsInfo,e=e&&(e.creatorField||e.editorField);(this.userIsAdmin||e)&&!this._getToken()&&-1<c&&t.id?(c=d.substring(0,c)+"/rest/info",v({url:c,content:{f:"json"},
handleAs:"json",callbackParamName:"callback"}).then(function(b){if(b.owningSystemUrl)return t.id.checkSignInStatus(b.owningSystemUrl+"/sharing")}).then(function(b){if(b)return t.id.getCredential(d)}).then(function(b){b&&a._findCredential()}).always(function(){b.call(a)})):b.call(this)},_checkMode:function(b){var a=this.geometryType,c=this.maxRecordCount;b=(b=b&&b.features&&b.features[0])&&b.attributes&&b.attributes.exceedslimit;if(this.mode===ea.MODE_AUTO&&!this.isEditable()&&0===b&&(this.queryPagination||
("esriGeometryPolyline"===a||"esriGeometryPolygon"===a||"esriGeometryMultipoint"===a||this.hasXYFootprint())&&c>=this.maxRecordCountForAuto||"esriGeometryPoint"===a&&c>=this.maxPointCountForAuto))this.currentMode=ea.MODE_SNAPSHOT,this._mode=new aa(this),this._isSnapshot=this._autoSnapshot=!0},_queryLimit:function(){var b=this,a=new m;this._limitPromise=a.promise;setTimeout(function(){var c=new M,d=new K;d.statisticType="exceedslimit";d.maxPointCount=b.maxPointCountForAuto;d.maxRecordCount=b.maxRecordCountForAuto;
d.maxVertexCount=b.maxVertexCountForAuto;d.outStatisticFieldName="exceedslimit";c.outStatistics=[d];b.queryFeatures(c).promise.then(function(b){a.resolve(b)},function(b){a.reject(b)})},0)},_updateCaps:function(){var b=this._editable,a=k.trim(this.capabilities||""),c=h.map(a?a.split(","):[],k.trim),d=h.map(a?a.toLowerCase().split(","):[],k.trim),a=h.indexOf(d,"editing"),e,d={Create:h.indexOf(d,"create"),Update:h.indexOf(d,"update"),Delete:h.indexOf(d,"delete")};if(b&&-1===a)c.push("Editing");else if(!b&&
-1<a){b=[a];for(e in d)-1<d[e]&&b.push(d[e]);b.sort();for(e=b.length-1;0<=e;e--)c.splice(b[e],1)}this.capabilities=c.join(",")},_counter:{value:0},_getUniqueId:function(){return this._counter.value++},onSuspend:function(){this.inherited(arguments);this._toggleTime(!1);var b=this._mode;b&&b.suspend()},onResume:function(b){this.inherited(arguments);this._toggleTime(!0);var a=this._mode,c=this._map,d=this._getRenderer();if(b.firstOccurrence){this._fixRendererFields();this._checkFields();this.clearSelection();
if(this.timeInfo&&!this._trackManager&&(this._trackIdField||d&&(d.latestObservationRenderer||d.trackRenderer)))this._trackManager=new ia(this),this._trackManager.initialize(c);d&&("colors"in d&&"blurRadius"in d&&"maxPixelIntensity"in d)&&("esriGeometryPoint"==this.geometryType&&!this._heatmapManager)&&(this._heatmapManager=new oa(this),this._heatmapManager.initialize(c));if(this._autoSnapshot&&this._autoGeneralize&&("esriGeometryPolyline"===this.geometryType||"esriGeometryPolygon"===this.geometryType||
this.hasXYFootprint())&&!this.isEditable()&&null==this.getMaxAllowableOffset())d=this.generalizeForScale,this._calculatedScale=d=this.maxScale?this.maxScale:this.minScale?Math.min(d,this.minScale):Math.min(d,T.getScale(c,this.initialExtent)),this._calcMaxOffset=c.extent.getWidth()/c.width/c.getScale()*d;this._zoomConnect=l.connect(c,"onZoomEnd",this,this._zoomEndHandler);this._updateMaxOffset();this._needsRefresh=!1;a&&a.startup()}else this._zoomEndHandler(),a&&a.resume()},_zoomEndHandler:function(){var b=
this._map;this._updateMaxOffset();this._prevScale=b.getScale();!this.suspended&&this._needsRefresh&&this.refresh()},_updateMaxOffset:function(){var b=this._map;b&&b.loaded&&this._autoGeneralize&&(this._autoSnapshot?(b=this.getMaxAllowableOffset(),this._setMaxOffset(this._getMaxOffsetForScale(),!0),this._needsRefresh||(this._needsRefresh=b!=this.getMaxAllowableOffset())):this._setMaxOffset(b.extent.getWidth()/b.width,!b.extent.spatialReference.isWebMercator()))},_getMaxOffsetForScale:function(){if(this._map){var b=
this._map.getScale(),a=this._calculatedScale,c=this._calcMaxOffset,d=this._prevScale;return b>=a&&(null==d||d<a)?c:b<a&&(null==d||d>=a)?null:this.getMaxAllowableOffset()}},_toggleTime:function(b){var a=this._map;b&&this.timeInfo&&this.useMapTime&&a?(this._mapTimeExtent=a.timeExtent,this._timeConnect||(this._timeConnect=l.connect(a,"onTimeExtentChange",this,this._timeChangeHandler))):(this._mapTimeExtent=null,l.disconnect(this._timeConnect),this._timeConnect=null)},_timeChangeHandler:function(b){this._mapTimeExtent=
b;(b=this._mode)&&b.propertyChangeHandler(0)},_getOffsettedTE:function(b){var a=this._timeOffset,c=this._timeOffsetUnits;return b&&a&&c?b.offset(-1*a,c):b},_getTimeOverlap:function(b,a){return b&&a?b.intersection(a):b||a},_getTimeFilter:function(b){var a=this.getTimeDefinition(),c;if(a&&(c=this._getTimeOverlap(a,null),!c))return[!1];if(b){if(b=c?this._getTimeOverlap(b,c):b,!b)return[!1]}else b=c;return[!0,b]},_getAttributeFilter:function(b){var a=this.getDefinitionExpression();return b?a?"("+a+") AND ("+
b+")":b:a},_applyQueryFilters:function(b,a){b.where=this._getAttributeFilter(b.where);b.maxAllowableOffset||(b.maxAllowableOffset=this._maxOffset);b.quantizationParameters=this._quantizationParameters;a&&this.supportsAdvancedQueries&&(b.orderByFields=b.orderByFields||this.getOrderByFields());if(this.timeInfo){var c=this._getTimeFilter(b.timeExtent);if(c[0])b.timeExtent=c[1];else return!1}return!0},_add:function(b){var a=this._selectionSymbol,c=b.attributes,d=this.visibilityField;a&&this._isSelOnly&&
b.setSymbol(a);if(d&&c&&c.hasOwnProperty(d))b[c[d]?"show":"hide"]();return this.add.apply(this,arguments)},_remove:function(){return this.remove.apply(this,arguments)},_canDoClientSideQuery:function(b){var a=[],c=this._map,d;if(!(this._isTable||!c&&!this._collection))if(!b.text&&!(b.where&&b.where!==this.getDefinitionExpression()||b.orderByFields&&b.orderByFields.length&&(d=this.getOrderByFields()||[])&&b.orderByFields.join()!==d.join()||b.outStatistics||b.returnDistinctValues)){d=this._isSnapshot;
var e=this._isSelOnly,g=b.geometry;if(g)if(!e&&b.spatialRelationship===M.SPATIAL_REL_INTERSECTS&&"extent"===g.type&&(d||c.extent.contains(g)))a.push(1);else return;if(c=b.objectIds)if(d)a.push(2);else{var g=c.length,f=this._mode,n=0,k;for(k=0;k<g;k++)f._getFeature(c[k])&&n++;if(n===g)a.push(2);else return}if(this.timeInfo)if(b=b.timeExtent,c=this._mapTimeExtent,d)b&&a.push(3);else if(e){if(b)return}else if(c)if(-1!==h.indexOf(a,2))b&&a.push(3);else if(-1!==h.indexOf(a,1))b==c&&a.push(3);else return;
else if(0<a.length)b&&a.push(3);else if(b)return;return 0<a.length?a:null}},_getAbsMid:function(b){return p.toAbsMid?p.toAbsMid(b):f.id.replace(/\/[^\/]*$/ig,"/")+b},_doQuery:function(b,a,c){var d=[],e=this.objectIdField,g=this,f=new m,n=new m,r=this.graphics;if(-1!==h.indexOf(a,1)){var s=this.spatialIndex||this._map&&this._map.spatialIndex,t,l=b.geometry._normalize(null,!0);null==s&&sa.autoSpatialIndexing?t=(this._map||this).addPlugin(this._getAbsMid("../plugins/spatialIndex")).then(k.hitch(this,
k.partial(this._getFromIndex,l,s)),function(b){n.resolve(k.hitch(this,k.partial(this._filterByExtent,r,l)))}):s&&(t=this._getFromIndex(l,s));t?t.then(function(b){for(var a=0;a<b.length;a++)b[a].results&&(d=d.concat(b[a].results));n.resolve(d)}).otherwise(function(b){n.reject(b)}):n.resolve(this._filterByExtent(r,l))}else n.resolve(r);n.then(function(n){d=n;if(-1!==h.indexOf(a,2)){var k=b.objectIds;d=h.filter(d,function(b){return-1<h.indexOf(k,b.attributes[e])})}-1!==h.indexOf(a,3)&&g.timeInfo&&(n=
b.timeExtent,d=g._filterByTime(d,n.startTime,n.endTime).match);c&&(d=h.map(d,function(b){return b.attributes[e]},this));f.resolve(d)});return f},_getFromIndex:function(b,a){a=a||this.spatialIndex||this._map.spatialIndex;b instanceof Array||(b=[b]);var c=this.id;return s(h.map(b,function(b){return a.intersects(b,c)}))},_filterByExtent:function(b,a){for(var c=[],d=0,e=b.length;d<e;d++){var g=b[d],f=g.geometry;f&&(this.normalization&&a.length?(a[0].intersects(f)||a[1].intersects(f))&&c.push(g):a.intersects(f)&&
c.push(g))}return c},_filterByTime:function(a,c,d){var e=this._startTimeField,g=this._endTimeField,f;this._twoTimeFields||(f=e||g);var n=b.isDefined,h=[],k=[],r,s=a.length,m,t;c=c?c.getTime():-Infinity;d=d?d.getTime():Infinity;if(f)for(r=0;r<s;r++)m=a[r],t=m.attributes,e=t[f],e>=c&&e<=d?h.push(m):k.push(m);else for(r=0;r<s;r++)m=a[r],t=m.attributes,f=t[e],t=t[g],f=n(f)?f:-Infinity,t=n(t)?t:Infinity,f>=c&&f<=d||t>=c&&t<=d||c>=f&&d<=t?h.push(m):k.push(m);return{match:h,noMatch:k}},_getSizeVariables:function(b){return b&&
h.filter(b.getVisualVariablesForType("sizeInfo",!1),function(b){return!(!b.field&&!b.valueExpression)})},_needClientSideSorting:function(b){return this._collection?!(!b||!b.length):h.some(b,function(b){return!!b.valueExpression})},_sortFeatures:function(b){var a=this.renderer,c=this._getSizeVariables(a);if(b&&1<b.length&&this._needClientSideSorting(c)){var d=c[0];b.sort(function(b,c){var e=a._getDataValue(b,d,"sizeInfo"),g=a._getDataValue(c,d,"sizeInfo");return null==e?-1:null==g?1:g-e})}return b},
_resolve:function(b,a,c,d,e){a&&this[a].apply(this,b);c&&c.apply(null,b);d&&w._resDfd(d,b,e)},_getShallowClone:function(b){var a=new M,c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},_query:function(b,a,c,d,e){var g=this,f=this._map,n=new m(w._dfdCanceller),k=c,r,s;if("executeRelationshipQuery"!==b){var k=this._getShallowClone(c),t=this.getOutFields();k.outFields||(k.outFields=t);k.outFields&&k.outFields.length&&(s=-1<h.indexOf(t,"*")?!1:!h.every(k.outFields,function(b){return-1<h.indexOf(t,
b)}));k.returnGeometry=c.hasOwnProperty("returnGeometry")?c.returnGeometry:!c.outStatistics;k.returnGeometry&&(k.multipatchOption=this.multipatchOption);var l;f&&(c=f&&f.spatialReference,(f=k.outSpatialReference)?r=!f.equals(c):k.outSpatialReference=new x(c.toJson()));if(!this._applyQueryFilters(k,"execute"===b&&!k.outStatistics)){switch(b){case "execute":l=new Q({features:[]});break;case "executeForIds":l=[];break;case "executeForCount":l=0;break;case "executeForExtent":l={}}this._resolve([l],a,
d,n);return n}if(c="executeForExtent"!==b&&!r&&!s&&this._canDoClientSideQuery(k))return n._pendingDfd=u(this._doQuery(k,c,"executeForIds"===b||"executeForCount"===b)),n._pendingDfd.then(function(c){switch(b){case "execute":l=new Q;l.features=c;break;case "executeForIds":l=c;break;case "executeForCount":l=c.length}g._resolve([l],a,d,n)}),n}if(this._collection)return this._resolve([Error("FeatureLayer::_query - "+this.invalidParams)],null,e,n,!0),n;this._ts&&(k._ts=(new Date).getTime());(n._pendingDfd=
this._task[b](k)).addCallbacks(function(c){var e=!!k.outStatistics||r||s;if("execute"===b||"executeRelationshipQuery"===b){var f,h;if("execute"===b){f=c.features;h=f.length;for(h-=1;0<=h;h--)if(f[h]._layer=g,!e&&!g._isTable){var m=g._mode._getFeature(f[h].attributes[g.objectIdField]);m&&f.splice(h,1,m)}}else for(m in c)if(c.hasOwnProperty(m)){f=c[m].features;h=f.length;for(h-=1;0<=h;h--)f[h]._layer=g}}g._resolve([c],a,d,n)},function(b){g._resolve([b],null,e,n,!0)});return n},_convertFeaturesToJson:function(b,
a,c,d){var e=[],g=this._selectionSymbol,f=this.visibilityField,n,r=this.objectIdField;if(this.loaded&&(c||d))n=h.filter(this.fields,function(b){return!1===b.editable&&(!d||b.name!==r)});for(c=0;c<b.length;c++){var s=b[c],m={},t=s.geometry,l=s.attributes,u=s.symbol;if(t&&(!d||!this.loaded||this.allowGeometryUpdates))m.geometry=t.toJson();f?(m.attributes=l=k.mixin({},l),l[f]=s.visible?1:0):l&&(m.attributes=k.mixin({},l));m.attributes&&(n&&n.length)&&h.forEach(n,function(b){delete m.attributes[b.name]});
u&&u!==g&&(m.symbol=u.toJson());e.push(m)}return a?e:q.toJson(e)},_selectHandler:function(b,a,c,d,e){var g;d=ea;switch(a){case d.SELECTION_NEW:this.clearSelection(!0);g=!0;break;case d.SELECTION_ADD:g=!0;break;case d.SELECTION_SUBTRACT:g=!1}d=b.features;var f=this._mode,n=[],h=this.objectIdField,k,r;if(g)for(g=0;g<d.length;g++)k=d[g],r=k.attributes[h],k=f._addFeatureIIf(r,k),n.push(k),this._selectFeatureIIf(r,k,f);else for(g=0;g<d.length;g++)k=d[g],r=k.attributes[h],this._unSelectFeatureIIf(r,f),
r=f._removeFeatureIIf(r),n.push(r||k);this._isSelOnly&&f._applyTimeFilter(!0);this._resolve([n,a,b.exceededTransferLimit?{queryLimitExceeded:!0}:null],"onSelectionComplete",c,e);if(b.exceededTransferLimit)this.onQueryLimitExceeded()},_selectFeatureIIf:function(b,a,c){var d=this._selectedFeatures,e=d[b];e||(c._incRefCount(b),d[b]=a,this._isTable||(this._setSelectSymbol(a),a.attr("data-selected","")));return e||a},_unSelectFeatureIIf:function(b,a){var c=this._selectedFeatures[b];c&&(a._decRefCount(b),
delete this._selectedFeatures[b],this._isTable||(this._setUnSelectSymbol(c),c.attr("data-selected")));return c},_isSelected:function(b){},_setSelectSymbol:function(b){var a=this._selectionSymbol;a&&!this._isSelOnly&&b.setSymbol(a)},_setUnSelectSymbol:function(b){var a=this._selectionSymbol;a&&!this._isSelOnly&&a===b.symbol&&b.setSymbol(null,!0)},_getOutFields:function(){var b=[this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._rendererFields).concat(this.dataAttributes),
b=h.filter(b,function(b,a,c){return!!b&&h.indexOf(c,b)===a}),a=k.clone(this._outFields);if(a){if(-1!==h.indexOf(a,"*"))return a;h.forEach(b,function(b){-1===h.indexOf(a,b)&&a.push(b)});return a}return b},_checkFields:function(a){var c=a||this._getOutFields();h.forEach(c,function(a){"*"!==a&&(this._getField(a)||console.debug("esri.layers.FeatureLayer: "+b.substitute({url:this.url,field:a},"unable to find '${field}' field in the layer 'fields' information [url: ${url}]")))},this);!a&&(!this._isTable&&
!this._fserver&&!this._collection&&!this._isStream)&&(h.some(this.fields,function(b){return b&&"esriFieldTypeGeometry"===b.type?!0:!1})||console.debug("esri.layers.FeatureLayer: "+b.substitute({url:this.url},"unable to find a field of type 'esriFieldTypeGeometry' in the layer 'fields' information. If you are using a map service layer, features will not have geometry [url: ${url}]")))},_fixFieldCase:function(b,a,c){var d=b&&b[a],e;if(d&&!k.isFunction(d)){if(e=!this._getField(d)&&this._getField(d,!0))d=
b[a]=e.name;c&&c.push(d)}return d},_fixRendererFields:function(){var a=this.renderer;this._orderBy=null;if(a&&0<this.fields.length){var c=[],d,a=h.filter([a,a.observationRenderer,a.latestObservationRenderer,a.trackRenderer],b.isDefined),e=[].concat(a);h.forEach(a,function(b){h.forEach(b.rendererInfos,function(b){b.renderer&&e.push(b.renderer)})});h.forEach(e,function(b){this._fixFieldCase(b,"attributeField",c);this._fixFieldCase(b,"attributeField2",c);this._fixFieldCase(b,"attributeField3",c);this._fixFieldCase(b.rotationInfo,
"field",c);if((d=this._fixFieldCase(b.sizeInfo,"field",c))&&!this._orderBy)this._orderBy=[d+" DESC"];this._fixFieldCase(b.sizeInfo,"normalizationField",c);this._fixFieldCase(b.colorInfo,"field",c);this._fixFieldCase(b.colorInfo,"normalizationField",c);this._fixFieldCase(b.field,"field",c);this._fixFieldCase(b.opacityInfo,"field",c);this._fixFieldCase(b.opacityInfo,"normalizationField",c);h.forEach(b.visualVariables,function(b){d=this._fixFieldCase(b,"field",c);"sizeInfo"===b.type&&(d&&!this._orderBy)&&
(this._orderBy=[d+" DESC"]);this._fixFieldCase(b,"normalizationField",c)},this);if(!this._orderBy&&b.addBreak&&!k.isFunction(b.attributeField)&&(b.backgroundFillSymbol||this._hasSizeDiff(b)))this._orderBy=[b.attributeField+" DESC"]},this);this._rendererFields=h.filter(c,b.isDefined)}},_hasSizeDiff:function(b){var a=Number.MAX_VALUE,c=-Number.MAX_VALUE,d,e;h.forEach(b.infos,function(b){if(e=b.symbol){d=0;switch(e.type){case "simplemarkersymbol":d=e.size;break;case "picturemarkersymbol":d=(e.width+
e.height)/2;break;case "simplelinesymbol":case "cartographiclinesymbol":d=e.width;break;case "simplefillsymbol":case "picturefillsymbol":d=e.outline&&e.outline.width}d&&(a=Math.min(a,d),c=Math.max(c,d))}});return a!==Number.MAX_VALUE&&c!==-Number.MAX_VALUE&&1<Math.abs(c-a)},getOrderByFields:function(){var b=this.orderByFields||this._orderBy;return this.supportsAdvancedQueries&&b?h.filter(b,function(b){b=b.split(" ")[0];return!!this._getField(b,!0)},this):null},_getField:function(b,a){var c=this.fields;
if(!c||0===c.length)return null;var d;a&&(b=b.toLowerCase());h.some(c,function(c){var e=!1;(e=a?c&&c.name.toLowerCase()===b?!0:!1:c&&c.name===b?!0:!1)&&(d=c);return e});return d},_getDateOpts:function(){this._dtOpts||(this._dtOpts={properties:h.map(h.filter(this.fields,function(b){return!!(b&&"esriFieldTypeDate"===b.type)}),function(b){return b.name})});return this._dtOpts},_applyNormalized:function(b,a){b&&a&&h.forEach(b,function(b,c){b&&a[c]&&b.setGeometry(a[c])})},_editHandler:function(b,a,c,d,
e,g){e=b.addResults;var f=b.updateResults;b=b.deleteResults;var n,r,s,m,t=this.objectIdField,l=this._mode,u=this._isTable;n=this.editFieldsInfo;var q=this.getOutFields()||[],w=n&&n.creatorField,v=n&&n.creationDateField,z=n&&n.editorField,x=n&&n.editDateField;n=n&&n.realm;-1===h.indexOf(q,"*")&&(w&&-1===h.indexOf(q,w)&&(w=null),v&&-1===h.indexOf(q,v)&&(v=null),z&&-1===h.indexOf(q,z)&&(z=null),x&&-1===h.indexOf(q,x)&&(x=null));var q=v||x?(new Date).getTime():null,p=w||z?this.getUserId():void 0;p&&n&&
(p=p+"@"+n);if(e)for(n=0;n<e.length;n++)e[n]=new Y(e[n]),u||(r=e[n],r.success&&(r=r.objectId,s=a[n],(m=s._graphicsLayer)&&m!==this&&m.remove(s),m=s.attributes||{},m[t]=r,w&&(m[w]=p),z&&(m[z]=p),v&&(m[v]=q),x&&(m[x]=q),s.setAttributes(m),l._init&&l.drawFeature(s)));if(f)for(n=0;n<f.length;n++)if(f[n]=new Y(f[n]),!u&&(r=f[n],r.success)){r=r.objectId;s=c[r];if(a=l._getFeature(r))a.geometry!==s.geometry&&s.geometry&&a.setGeometry(O.fromJson(s.geometry.toJson())),a.attributes!==s.attributes&&s.attributes&&
a.setAttributes(k.mixin(a.attributes,s.attributes)),this._repaint(a,r);s=a||s;m=s.attributes||{};z&&(m[z]=p);x&&(m[x]=q);s.setAttributes(m)}if(b){c=[];for(n=0;n<b.length;n++)if(b[n]=new Y(b[n]),!u&&(r=b[n],r.success&&(r=r.objectId,s=l._getFeature(r))))this._unSelectFeatureIIf(r,l)&&c.push(s),s._count=0,l._removeFeatureIIf(r);if(0<c.length)this.onSelectionComplete(c,ea.SELECTION_SUBTRACT)}this._resolve([e,f,b],"onEditsComplete",d,g)},_sendAttachment:function(b,a,c,d,e){var g=this;return v({url:this._url.path+
"/"+a+"/"+("add"===b?"addAttachment":"updateAttachment"),form:c,content:k.mixin(this._url.query,{f:"json",token:this._getToken()||void 0}),callbackParamName:"callback.html",handleAs:"json"}).addCallback(function(c){var e="add"===b?"onAddAttachmentComplete":"onUpdateAttachmentComplete";c=new Y(c["add"===b?"addAttachmentResult":"updateAttachmentResult"]);c.attachmentId=c.objectId;c.objectId=a;g._resolve([c],e,d);return c}).addErrback(function(b){g._resolve([b],null,e,null,!0)})},_repaint:function(a,
c,d){c=b.isDefined(c)?c:a.attributes[this.objectIdField];(!(c in this._selectedFeatures)||!this._selectionSymbol)&&a.setSymbol(a.symbol,d)},_getKind:function(b){var a=this._trackManager;return a?a.isLatestObservation(b)?1:0:0}});k.mixin(ea,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,MODE_AUTO:6,MODE_STREAM:7,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});
G._createWrappers(ea);return ea})},"esri/layers/Field":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./RangeDomain ./CodedValueDomain".split(" "),function(p,f,a,l,k,h){return p(null,{declaredClass:"esri.layers.Field",constructor:function(a){if(a&&f.isObject(a)&&(this.name=a.name,this.type=a.type,this.alias=a.alias,this.length=a.length,this.editable=a.editable,this.nullable=a.nullable,(a=a.domain)&&f.isObject(a)))switch(a.type){case "range":this.domain=new k(a);break;case "codedValue":this.domain=
new h(a)}}})})},"esri/layers/RangeDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./Domain".split(" "),function(p,f,a,l,k,h){return p([h],{declaredClass:"esri.layers.RangeDomain",constructor:function(a){a&&f.isObject(a)&&(this.minValue=a.range[0],this.maxValue=a.range[1])},toJson:function(){var a=this.inherited(arguments);a.range=[this.minValue,this.maxValue];return k.fixJson(a)}})})},"esri/layers/Domain":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/has","../kernel","../lang"],function(p,f,a,l,k){return p(null,{declaredClass:"esri.layers.Domain",constructor:function(a){a&&f.isObject(a)&&(this.name=a.name,this.type=a.type)},toJson:function(){return k.fixJson({name:this.name,type:this.type})}})})},"esri/layers/CodedValueDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ./Domain".split(" "),function(p,f,a,l,k,h,q){return p([q],{declaredClass:"esri.layers.CodedValueDomain",constructor:function(a){a&&
f.isObject(a)&&(this.codedValues=a.codedValues)},getName:function(f){var g;a.some(this.codedValues,function(a){a.code==f&&(g=a.name);return!!g});return g},toJson:function(){var a=this.inherited(arguments);a.codedValues=f.clone(this.codedValues);return h.fixJson(a)}})})},"esri/layers/FeatureType":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../symbols/jsonUtils ./RangeDomain ./CodedValueDomain ./InheritedDomain ./FeatureTemplate".split(" "),function(p,
f,a,l,k,h,q,m,g,e,c){return p(null,{declaredClass:"esri.layers.FeatureType",constructor:function(a){if(a&&f.isObject(a)){this.id=a.id;this.name=a.name;var h=a.symbol;h&&(this.symbol=q.fromJson(h));var h=a.domains,k,s=this.domains={};for(k in h)if(h.hasOwnProperty(k)){var t=h[k];switch(t.type){case "range":s[k]=new m(t);break;case "codedValue":s[k]=new g(t);break;case "inherited":s[k]=new e(t)}}if(k=a.templates){h=this.templates=[];for(a=0;a<k.length;a++)h.push(new c(k[a]))}}},toJson:function(){var c=
{id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()},e,g=this.domains,f=this.templates,k=h.fixJson;if(g){var b=c.domains={};for(e in g)g.hasOwnProperty(e)&&(b[e]=g[e]&&g[e].toJson());k(b)}f&&(c.templates=a.map(f,function(b){return b.toJson()}));return k(c)}})})},"esri/layers/InheritedDomain":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Domain"],function(p,f,a,l,k){return p([k],{declaredClass:"esri.layers.InheritedDomain"})})},"esri/layers/FeatureTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../graphic".split(" "),
function(p,f,a,l,k,h){p=p(null,{declaredClass:"esri.layers.FeatureTemplate",constructor:function(a){a&&f.isObject(a)&&(this.name=a.name,this.description=a.description,this.drawingTool=a.drawingTool,a=a.prototype,this.prototype=new h(a.geometry,null,a.attributes))},toJson:function(){return k.fixJson({name:this.name,description:this.description,drawingTool:this.drawingTool,prototype:this.prototype&&this.prototype.toJson()})}});f.mixin(p,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",
TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",
TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});return p})},"esri/layers/FeatureEditResult":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(p,f,a,l){return p(null,{declaredClass:"esri.layers.FeatureEditResult",constructor:function(a){a&&f.isObject(a)&&(this.objectId=a.objectId,this.success=a.success,a.success||(a=a.error,this.error=Error(),this.error.code=a.code,this.error.message=a.description))}})})},"esri/layers/LabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../symbols/TextSymbol ../symbols/ShieldLabelSymbol".split(" "),
function(p,f,a,l,k,h,q,m){return p(null,{declaredClass:"esri.layers.LabelClass",labelPlacement:null,labelExpression:null,format:null,fieldInfos:null,useCodedValues:null,symbol:null,maxScale:0,minScale:0,where:null,sizeInfo:null,_labelPlacementLookup:{"above-center":"esriServerPointLabelPlacementAboveCenter","above-left":"esriServerPointLabelPlacementAboveLeft","above-right":"esriServerPointLabelPlacementAboveRight","below-center":"esriServerPointLabelPlacementBelowCenter","below-left":"esriServerPointLabelPlacementBelowLeft",
"below-right":"esriServerPointLabelPlacementBelowRight","center-center":"esriServerPointLabelPlacementCenterCenter","center-left":"esriServerPointLabelPlacementCenterLeft","center-right":"esriServerPointLabelPlacementCenterRight","above-after":"esriServerLinePlacementAboveAfter","above-along":"esriServerLinePlacementAboveAlong","above-before":"esriServerLinePlacementAboveBefore","above-start":"esriServerLinePlacementAboveStart","above-end":"esriServerLinePlacementAboveEnd","below-after":"esriServerLinePlacementBelowAfter",
"below-along":"esriServerLinePlacementBelowAlong","below-before":"esriServerLinePlacementBelowBefore","below-start":"esriServerLinePlacementBelowStart","below-end":"esriServerLinePlacementBelowEnd","center-after":"esriServerLinePlacementCenterAfter","center-along":"esriServerLinePlacementCenterAlong","center-before":"esriServerLinePlacementCenterBefore","center-start":"esriServerLinePlacementCenterStart","center-end":"esriServerLinePlacementCenterEnd","always-horizontal":"esriServerPolygonPlacementAlwaysHorizontal"},
constructor:function(a){if(a&&(f.mixin(this,a),this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)||(this.labelPlacement=h.valueOf(this._labelPlacementLookup,a.labelPlacement)),a.format&&(this.format=a.format),a.fieldInfos&&(this.fieldInfos=a.fieldInfos),a.symbol&&(this.symbol="esriSHD"===a.symbol.type?new m(a.symbol):new q(a.symbol)),a=this.sizeInfo))a.minSize&&(a.minSize=l.pt2px(a.minSize)),a.maxSize&&(a.maxSize=l.pt2px(a.maxSize))},getSymbol:function(){return this.symbol},toJson:function(){var a=
this.sizeInfo;a&&(a=f.mixin({},a),a.minSize&&(a.minSize=l.px2pt(a.minSize)),a.maxSize&&(a.maxSize=l.px2pt(a.maxSize)));a={labelExpression:this.labelExpression,labelExpressionInfo:this.labelExpressionInfo&&f.clone(this.labelExpressionInfo),format:this.format,fieldInfos:this.fieldInfos,useCodedValues:this.useCodedValues,maxScale:this.maxScale,minScale:this.minScale,where:this.where,sizeInfo:a,labelPlacement:this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)?this._labelPlacementLookup[this.labelPlacement]:
this.labelPlacement,symbol:this.symbol&&this.symbol.toJson()};return h.fixJson(a)}})})},"esri/symbols/ShieldLabelSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol ./Font".split(" "),function(p,f,a,l,k,h,q,m,g){var e={url:"",width:12,height:12,angle:0,xoffset:0,yoffset:0};p=p(m,{declaredClass:"esri.symbol.ShieldLabelSymbol",type:"shieldlabelsymbol",color:[255,255,255,1],width:32,height:32,font:l.defaultFont,constructor:function(c,
d,g,h,k){c?f.isString(c)?(this.url=c,d&&(this.color=d),g&&(this.width=g),h&&(this.height=h),void 0!==k&&(this.font=k)):(this.width=l.pt2px(c.width),this.height=l.pt2px(c.height),d=c.imageData,!(9>a("ie"))&&d&&(g=this.url,this.url="data:"+(c.contentType||"image")+";base64,"+d,this.imageData=g)):f.mixin(this,e)},getStroke:function(){return null},getFill:function(){return this.color},setWidth:function(a){this.width=a;return this},setHeight:function(a){this.height=a;return this},setUrl:function(a){a!==
this.url&&(delete this.imageData,delete this.contentType);this.url=a;return this},setFont:function(a){this.font=a;return this},setText:function(a){this.text=a;return this},getWidth:function(){return this.width},getHeight:function(){return this.height},getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||""},fill:null,stroke:null}},toJson:function(){var a=this.url,d=this.imageData;
if(0===a.indexOf("data:"))var e=a,a=d,d=e.indexOf(";base64,")+8,d=e.substr(d);var a=q.getAbsoluteUrl(a),e=l.px2pt(this.width),e=isNaN(e)?void 0:e,k=l.px2pt(this.height),k=isNaN(k)?void 0:k,a=h.fixJson(f.mixin(this.inherited("toJson",arguments),{type:"esriSHD",url:a,imageData:d,contentType:this.contentType,width:e,height:k}));this.font?(d=new g(this.font),a.font=d.toJson()):a.font=null;delete a.size;a.imageData||delete a.imageData;return a}});p.defaultProps=e;return p})},"esri/layers/SnapshotMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ../tasks/query ./RenderMode".split(" "),
function(p,f,a,l,k,h,q){return p([q],{declaredClass:"esri.layers._SnapshotMode",constructor:function(a){this.featureLayer=a;this.pagination=a.queryPagination;this._featureMap={};this._drawFeatures=f.hitch(this,this._drawFeatures);this._queryErrorHandler=f.hitch(this,this._queryErrorHandler)},startup:function(){this.pagination=this.pagination&&null!=this.featureLayer.maxRecordCount;this.featureLayer._collection?this._applyTimeFilter():this._fetchAll()},propertyChangeHandler:function(a){this._init&&
(a?this.featureLayer._collection?console.log("FeatureLayer: layer created by value (from a feature collection) does not support definition expressions and time definitions. Layer id \x3d "+this.featureLayer.id):this._fetchAll():this._applyTimeFilter())},drawFeature:function(a){var g=a.attributes[this.featureLayer.objectIdField];this._addFeatureIIf(g,a);this._incRefCount(g)},resume:function(){this.propertyChangeHandler(0)},refresh:function(){var a=this.featureLayer;a._collection?(a._fireUpdateStart(),
a._refresh(!0),a._fireUpdateEnd()):this._fetchAll()},_getRequestId:function(a){return("_"+a.name+a.layerId+a._ulid).replace(/[^a-zA-Z0-9\_]+/g,"_")},_fetchAll:function(){var a=this.featureLayer;!a._collection&&!a.suspended&&(a._fireUpdateStart(),this._clearIIf(),this._sendRequest())},_sendRequest:function(a){var g=this.map,e=this.featureLayer,c=e.getDefinitionExpression(),d=new h;d.outFields=e.getOutFields();d.where=c||"1\x3d1";d.returnGeometry=!0;d.outSpatialReference=new k(g.spatialReference.toJson());
d.timeExtent=e.getTimeDefinition();d.maxAllowableOffset=e._maxOffset;d.quantizationParameters=e._quantizationParameters;e._ts&&(d._ts=(new Date).getTime());d.orderByFields=e.supportsAdvancedQueries?e.getOrderByFields():null;d.multipatchOption=e.multipatchOption;this.pagination&&(this._start=d.start=null==a?0:a,d.num=e.maxRecordCount);var f;e._usePatch&&(f=this._getRequestId(e),this._cancelPendingRequest(null,f));e._task.execute(d,this._drawFeatures,this._queryErrorHandler,f)},_drawFeatures:function(a){this._purgeRequests();
var g=a.features,e=this.featureLayer,c=e.objectIdField,d,f=g.length,h=a.exceededTransferLimit&&!e._collection,k=e._selectedFeatures,t=e.mode===e.constructor.MODE_AUTO,b,l,n;e._sortFeatures(g);for(d=0;d<f;d++)l=g[d],n=l.attributes[c],b=this._addFeatureIIf(n,l),this._incRefCount(n),t&&(b!==l&&k[n])&&(b.setGeometry(l.geometry),b.setAttributes(l.attributes));this._applyTimeFilter(!0);if(!this.pagination||!h)e._fireUpdateEnd(null,a.exceededTransferLimit?{queryLimitExceeded:!0}:null);h&&(this.pagination&&
this._sendRequest(this._start+e.maxRecordCount),e.onQueryLimitExceeded())},_queryErrorHandler:function(a){this._purgeRequests();var g=this.featureLayer;g._errorHandler(a);g._fireUpdateEnd(a)}})})},"esri/layers/RenderMode":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/io/script ../kernel".split(" "),function(p,f,a,l,k,h,q){return f(null,{declaredClass:"esri.layers._RenderMode",constructor:function(){this._prefix="jsonp_"+(p._scopeName||"dojo")+
"IoScript"},initialize:function(a){this.map=a;this._init=!0},startup:function(){},propertyChangeHandler:function(a){},destroy:function(){this._init=!1},drawFeature:function(a){},suspend:function(){},resume:function(){},refresh:function(){},_incRefCount:function(a){(a=this._featureMap[a])&&a._count++},_decRefCount:function(a){(a=this._featureMap[a])&&a._count--},_getFeature:function(a){return this._featureMap[a]},_addFeatureIIf:function(a,g){var e=this._featureMap,c=e[a],d=this.featureLayer;c||(e[a]=
g,d._add(g),g._count=0);return c||g},_removeFeatureIIf:function(a){var g=this._featureMap[a],e=this.featureLayer;if(g){if(g._count)return;delete this._featureMap[a];e._remove(g)}return g},_clearIIf:function(){var a;a=this.featureLayer;var g=a.graphics,e=a._selectedFeatures,c=a.objectIdField;for(a=g.length-1;0<=a;a--){var d=g[a],f=d.attributes[c];f in e?d._count=1:(d._count=0,this._removeFeatureIIf(f))}},_isPending:function(a){return h[this._prefix+a]?!0:!1},_cancelPendingRequest:function(a,g){if(a=
a||h[this._prefix+g])try{a.cancel(),h._validCheck(a)}catch(e){}},_purgeRequests:function(){h._validCheck(null)},_toggleVisibility:function(a){var g=this.featureLayer,e=g.graphics,c=a?"show":"hide",d,f=e.length;a=a&&g._ager;for(d=0;d<f;d++){var h=e[d];h[c]();a&&g._repaint(h)}},_applyTimeFilter:function(a){var g=this.featureLayer;if(g.timeInfo&&!g.suspended){a||g._fireUpdateStart();var e=g._trackManager;e&&e.clearTracks();var c=g.getTimeDefinition(),d=g._getOffsettedTE(g._mapTimeExtent);d?(d=g._getTimeOverlap(c,
d))?(c=g._filterByTime(g.graphics,d.startTime,d.endTime),e&&e.addFeatures(c.match),l.forEach(c.match,function(a){var c=a._shape;a.visible||(a.show(),(c=a._shape)&&c._moveToFront());g._ager&&c&&g._repaint(a)}),l.forEach(c.noMatch,function(a){a.visible&&a.hide()})):this._toggleVisibility(!1):(e&&e.addFeatures(g.graphics),this._toggleVisibility(!0));e&&(e.moveLatestToFront(),e.drawTracks());a||g._fireUpdateEnd()}}})})},"esri/layers/OnDemandMode":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/has ../kernel ../geometry/Point ../tasks/query ./RenderMode ./GridLayout".split(" "),
function(p,f,a,l,k,h,q,m,g,e){return p([g],{declaredClass:"esri.layers._OnDemandMode",constructor:function(c){this.featureLayer=c;this._featureMap={};this._queryErrorHandler=a.hitch(this,this._queryErrorHandler)},initialize:function(a){this.inherited(arguments);var d=this.featureLayer,g=d._srInfo;this._gridLayer=new e(new q(g?g.valid[0]:a.extent.xmin,g?g.valid[1]:a.extent.ymax,a.spatialReference),{width:d._tileWidth,height:d._tileHeight},{width:a.width,height:a.height},g);this._cellMap={};this._gridLayer.setResolution(a.extent)},
startup:function(){this._ioQueue=[];this.featureLayer.suspended||(this._zoomHandler(),this._enableConnectors())},propertyChangeHandler:function(a){this._init&&(2>a?this._zoomHandler():console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id \x3d "+this.featureLayer.id+", Layer URL \x3d "+this.featureLayer.url))},destroy:function(){this._disableConnectors();this.inherited(arguments)},drawFeature:function(a){var d=this._gridLayer,e=a.geometry,g=[];if(e)for(var g=
d.getCellsInExtent("point"===e.type?{xmin:e.x,ymin:e.y,xmax:e.x,ymax:e.y}:e.getExtent(),!1).cells,d=this._cellMap,f,h=a.attributes[this.featureLayer.objectIdField],b,k,n,e=0;e<g.length;e++)f=g[e],b=f.latticeID,k=f.row,n=f.col,b?f=d[b]=d[b]||f:(d[k]=d[k]||{},f=d[k][n]=d[k][n]||f),f.features=f.features||[],f.features.push(a),this._addFeatureIIf(h,a),this._incRefCount(h)},suspend:function(){this._init&&this._disableConnectors()},resume:function(){this._init&&(this._enableConnectors(),this._zoomHandler())},
refresh:function(){this._zoomHandler()},_enableConnectors:function(){var a=this.map;this._zoomConnect=f.connect(a,"onZoomEnd",this,this._zoomHandler);this._panConnect=f.connect(a,"onPanEnd",this,this._panHandler);this._resizeConnect=f.connect(a,"onResize",this,this._panHandler)},_disableConnectors:function(){f.disconnect(this._zoomConnect);f.disconnect(this._panConnect);f.disconnect(this._resizeConnect)},_zoomHandler:function(){this._processIOQueue(!0);var a=this.featureLayer,d=this.map;a.suspended||
(a._fireUpdateStart(),this._clearIIf(),(a=a._trackManager)&&a.clearTracks(),this._cellMap={},this._gridLayer.setResolution(d.extent),this._sendRequest())},_panHandler:function(a){this.featureLayer._fireUpdateStart();this._sendRequest(this.featureLayer._resized&&a)},_getRequestId:function(a,d){return("_"+a.name+a.layerId+a._ulid+"_"+d.resolution+"_"+(d.latticeID||d.row+"_"+d.col)).replace(/[^a-zA-Z0-9\_]+/g,"_")},_sendRequest:function(a){this._exceeds=!1;var d=this.featureLayer,e=this.map;a=a||e.extent;
e=this._gridLayer.getCellsInExtent(a,d.latticeTiling).cells;if(!d.isEditable())var g=this._cellMap,e=l.filter(e,function(b){if(b.lattice){if(g[b.latticeID])return!1}else if(g[b.row]&&g[b.row][b.col])return!1;return!0});var f=d.getOutFields(),h=d.getDefinitionExpression(),b=d._getOffsettedTE(d._mapTimeExtent),k=d.supportsAdvancedQueries?d.getOrderByFields():null,n=d._usePatch,q=this._ioQueue,x,z=this,p=this._drawFeatures,A,B,F;this._pending=this._pending||0;for(x=0;x<e.length;x++){A=e[x];B=new m;B.geometry=
A.extent||A.lattice;B.outFields=f;B.where=h;d.latticeTiling&&A.extent&&(B.spatialRelationship=m.SPATIAL_REL_CONTAINS);B.returnGeometry=!0;B.timeExtent=b;d._ts&&(B._ts=(new Date).getTime());B.orderByFields=k;B.multipatchOption=d.multipatchOption;B.maxAllowableOffset=d._maxOffset;B.quantizationParameters=d._quantizationParameters;if((F=d.advancedQueryCapabilities)&&F.supportsQueryWithResultType)B.resultType="tile";F=null;if(n&&(F=this._getRequestId(d,A),this._isPending(F)))continue;this._pending++;
q.push(d._task.execute(B,function(){var b=A;return function(a){p.apply(z,[a,b])}}.call(this),this._queryErrorHandler,F))}this._removeOldCells(a);this._endCheck()},_drawFeatures:function(a,d){this._exceeds=this._exceeds||a.exceededTransferLimit;this._finalizeIO();var e=this.featureLayer,g=this.map.extent,f=d.extent,h=d.row,b=d.col,k=e.objectIdField,n=a.features,l=this._gridLayer,m=this._cellMap,q=d.latticeID,p=q?m[q]:m[h]&&m[h][b];if(d.resolution!=l._resolution||(q?q!==l.getLatticeID(g):!l.intersects(f,
g)))p&&this._removeCell(h,b,q);else if(p)e._sortFeatures(n),this._updateCell(p,n);else{e._sortFeatures(n);d.features=n;q?m[q]=d:(m[h]=m[h]||{},m[h][b]=d);g=n.length;for(e=0;e<g;e++)f=n[e],h=f.attributes[k],this._addFeatureIIf(h,f),this._incRefCount(h)}this._endCheck()},_queryErrorHandler:function(a){this._finalizeIO();this.featureLayer._errorHandler(a);this._endCheck(!0)},_finalizeIO:function(){this._purgeRequests();this._pending--},_endCheck:function(a){if(0===this._pending){this._processIOQueue();
var d=this.featureLayer,e=d._trackManager;e&&(e.clearTracks(),e.addFeatures(d.graphics),d._ager&&l.forEach(d.graphics,function(a){a._shape&&d._repaint(a)}),e.moveLatestToFront(),e.drawTracks());this.featureLayer._fireUpdateEnd(a&&Error("FeatureLayer: an error occurred while updating the layer"),this._exceeds?{queryLimitExceeded:!0}:null);if(this._exceeds)d.onQueryLimitExceeded()}},_processIOQueue:function(a){this._ioQueue=l.filter(this._ioQueue,function(a){return-1<a.fired?!1:!0});a&&l.forEach(this._ioQueue,
this._cancelPendingRequest)},_removeOldCells:function(a){var d=this._cellMap,e=this._gridLayer,g,f;for(g in d)if(d[g]){var h=d[g],b=h.latticeID,k=0,n=0;if(b)k++,b!==e.getLatticeID(a)&&(this._removeCell(null,null,b),n++);else for(f in h)h[f]&&(k++,e.intersects(h[f].extent,a)||(this._removeCell(g,f),n++));n===k&&delete d[g]}},_updateCell:function(a,d){var e=this.featureLayer,g=e.objectIdField,e=e._selectedFeatures,f,h=d.length;a.features=a.features||[];for(f=0;f<h;f++){var b=d[f],k=b.attributes[g],
n=this._addFeatureIIf(k,b);n===b?(this._incRefCount(k),a.features.push(n)):k in e||(n.setGeometry(b.geometry),n.setAttributes(b.attributes))}},_removeCell:function(a,d,e){var g=this._cellMap,f=this.featureLayer,h=f.objectIdField,b=e?g[e]:g[a]&&g[a][d];if(b){e?delete g[e]:delete g[a][d];a=b.features;for(d=0;d<a.length;d++)e=a[d].attributes[h],this._decRefCount(e),e in f._selectedFeatures||this._removeFeatureIIf(e)}}})})},"esri/layers/GridLayout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../SpatialReference ../geometry/Extent ../geometry/Polyline".split(" "),
function(p,f,a,l,k,h,q,m){return p(null,{declaredClass:"esri.layers._GridLayout",constructor:function(a,e,c,d){this.origin=a;this.cellWidth=e.width;this.cellHeight=e.height;this.mapWidth=c.width;this.mapHeight=c.height;this.srInfo=d},setResolution:function(a){this._resolution=(a.xmax-a.xmin)/this.mapWidth;this.srInfo&&(a=Math.round(2*this.srInfo.valid[1]/this._resolution),a=Math.round(a/this.cellWidth),this._frameStats=[a,0,a-1])},getCellCoordinates:function(a){var e=this._resolution,c=this.origin;
return{row:Math.floor((c.y-a.y)/(this.cellHeight*e)),col:Math.floor((a.x-c.x)/(this.cellWidth*e))}},normalize:function(a){var e=this._frameStats;if(e){var c=e[0],d=e[1],e=e[2];a<d?(a%=c,a=a<d?a+c:a):a>e&&(a%=c)}return a},intersects:function(g,e){var c=this.srInfo;return c?a.some(e._getParts(c),function(a){return g.intersects(a.extent)}):g.intersects(e)},getCellExtent:function(a,e){var c=this._resolution,d=this.origin,f=this.cellWidth,k=this.cellHeight;return new q(e*f*c+d.x,d.y-(a+1)*k*c,(e+1)*f*
c+d.x,d.y-a*k*c,new h(d.spatialReference.toJson()))},getLatticeID:function(a){var e=this.getCellCoordinates({x:a.xmin,y:a.ymax}),c=this.getCellCoordinates({x:a.xmax,y:a.ymin});a=e.row;var d=c.row,e=this.normalize(e.col),c=this.normalize(c.col);return a+"_"+d+"_"+e+"_"+c},sorter:function(a,e){return a<e?-1:1},getCellsInExtent:function(a,e){var c=this.getCellCoordinates({x:a.xmin,y:a.ymax}),d=this.getCellCoordinates({x:a.xmax,y:a.ymin}),f=c.row,h=d.row,c=c.col,d=d.col,k=[],l,b,q,n=[],w=[],x,z,p,A=[];
for(l=f;l<=h;l++)for(b=c;b<=d;b++)q=this.normalize(b),a=this.getCellExtent(l,q),k.push({row:l,col:q,extent:a,resolution:this._resolution}),e&&(n.push(a.xmin,a.xmax),w.push(a.ymin,a.ymax));c=this.normalize(c);d=this.normalize(d);n.sort(this.sorter);w.sort(this.sorter);b=n.length;for(l=b-1;0<=l;l--)l<b-1&&n[l]===n[l+1]&&n.splice(l,1);b=w.length;for(l=b-1;0<=l;l--)l<b-1&&w[l]===w[l+1]&&w.splice(l,1);if(n.length&&w.length){q=n[0];x=n[n.length-1];z=w[0];p=w[w.length-1];b=n.length;for(l=0;l<b;l++)A.push([[n[l],
p],[n[l],z]]);b=w.length;for(l=0;l<b;l++)A.push([[q,w[l]],[x,w[l]]]);l=new m({paths:A,spatialReference:this.origin.spatialReference.toJson()});k.push({latticeID:f+"_"+h+"_"+c+"_"+d,lattice:l,resolution:this._resolution})}return{minRow:f,maxRow:h,minCol:c,maxCol:d,cells:k}}})})},"esri/layers/SelectionMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./RenderMode"],function(p,f,a,l,k){return p([k],{declaredClass:"esri.layers._SelectionMode",constructor:function(a){this.featureLayer=
a;this._featureMap={}},propertyChangeHandler:function(a){this._init&&0===a&&this._applyTimeFilter()},resume:function(){this.propertyChangeHandler(0)}})})},"esri/layers/StreamMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../SpatialReference ../tasks/query ../tasks/QueryTask ../geometry/jsonUtils ./RenderMode".split(" "),function(p,f,a,l,k,h,q,m,g,e){return p([e],{declaredClass:"esri.layers._StreamMode",constructor:function(a,d){this.featureLayer=a;
this._featureMap={};this._setRefreshRate();this._drawBuffer={adds:[],updates:[]};this._timeoutId=null;this._flushDrawBuffer=f.hitch(this,this._flushDrawBuffer);this._featuresByTime={};this._lastEndTimeCheck=null;this._maxFeatureAge=0;a.purgeOptions&&(a.purgeOptions.age&&"number"===typeof a.purgeOptions.age)&&(this._maxFeatureAge=1E3*Math.ceil(60*a.purgeOptions.age));this._drawFeatures=f.hitch(this,this._drawFeatures);this._queryErrorHandler=f.hitch(this,this._queryErrorHandler)},startup:function(){},
propertyChangeHandler:function(a){this._init&&(0===a?this._applyTimeFilter():3===a?this._redrawAllTracks():console.debug("StreamLayer: Stream Layer only supports changing map time or maximumTrackPoints. Layer id \x3d "+this.featureLayer.id))},drawFeature:function(a){var d=this.featureLayer,e=d.objectIdField;this._timeoutId||(this._timeoutId=setTimeout(this._flushDrawBuffer,this._refreshRate));d._joinField&&this._getFeature(a.attributes[e])?this._drawBuffer.updates.push({oid:a.attributes[e],updates:a}):
this._drawBuffer.adds.push(a)},resume:function(){this.propertyChangeHandler(0)},refresh:function(){var a=this.featureLayer;a&&(!a._relatedUrl&&!a._keepLatestUrl?(a._fireUpdateStart(),a.clear(),a._fireUpdateEnd()):(a._fireUpdateStart(),a._refreshing=!0,a.disconnect(),a.clear(),a._relatedQueried=!1,a._keepLatestQueried=!1,a.connect()))},_drawFeatures:function(a,d){this._purgeRequests();var e=this.featureLayer;e._create(a.features||[]);e._fireUpdateEnd(null,d)},_applyTimeFilter:function(a){this.inherited(arguments);
this._redrawAllTracks()},_removeFeatures:function(c){var d=this.featureLayer,e=d.objectIdField;c&&a.forEach(c,function(a){a=a.attributes[e];d._unSelectFeatureIIf(a,this);this._decRefCount(a);this._removeFeatureIIf(a)},this)},_addFeatures:function(c){var d=this.featureLayer,e=d._endTimeField,g=d._startTimeField,f,h,b,k=[],n=[],l=[];f=d._trackManager;h=d.objectIdField;if(f)for(b in c=f.addFeatures(c),c)c.hasOwnProperty(b)&&(k.push(b),c[b].adds&&(n=n.concat(c[b].adds)),c[b].deletes&&(l=l.concat(c[b].deletes)));
else n=c;a.forEach(n,function(b){var a=b.attributes[h],c;c=e&&b.attributes[e];!c&&this._maxFeatureAge&&(c=g&&b.attributes[g]?b.attributes[g]+this._maxFeatureAge:Date.now()+this._maxFeatureAge);c&&(c=1E3*Math.ceil(c/1E3),this._featuresByTime[c]?this._featuresByTime[c].push(a):this._featuresByTime[c]=[a]);this._addFeatureIIf(a,b);this._incRefCount(a)},this);l.length&&this._removeFeatures(l);f&&f.refreshTracks(k)},_updateFeatures:function(c){var d=this.featureLayer,e,g,f=[];e=d._trackManager;g=d._trackIdField;
a.forEach(c,function(a){var b=a.updates;a=this._getFeature(a.oid);var c;if(a){b.geometry&&a.setGeometry(b.geometry);b=b.attributes||{};for(c in b)b.hasOwnProperty(c)&&(a.attributes[c]=b[c]);a.visible=this._checkFeatureTimeIntersects(a);e&&a.attributes[g]?f.push(a.attributes[g]):d._repaint(a,null,!0)}},this);f.length&&e.refreshTracks(f)},_redrawAllTracks:function(){var a=this.featureLayer._trackManager,d;if(a&&(d=a.trimTracks())&&0<d.length)this._removeFeatures(d),a.refreshTracks()},_flushDrawBuffer:function(){clearTimeout(this._timeoutId);
var a=this._drawBuffer,d=a.adds.splice(0,a.adds.length),e=a.updates.splice(0,a.updates.length),a=this.featureLayer;if(!a)return!1;a.updating||a._fireUpdateStart();this._addFeatures(d);this._updateFeatures(e);if((d=this._getExpiredFeatures())&&d.length)this._removeFeatures(d),a._trackManager&&a._trackManager.removeFeatures(d);a._purge();a._fireUpdateEnd();this._timeoutId=null},_clearDrawBuffer:function(){var a=this._timeoutId,d=this._drawBuffer,e=d.adds,d=d.updates;a&&clearTimeout(a);e.splice(0,e.length);
d.splice(0,d.length);this._timeoutId=null},_clearTimeBin:function(){this._featuresByTime={};this._lastEndTimeCheck=1E3*Math.ceil(Date.now()/1E3)},_clearFeatureMap:function(){this._featureMap={}},_setRefreshRate:function(a){a=a||0===a?a:200;0>a&&(a=200);this._refreshRate=a},_checkFeatureTimeIntersects:function(a){var d=this.featureLayer,e=d.getMap(),e=e?e.timeExtent:null;return!e||!d.timeInfo||!d.timeInfo.startTimeField&&!d.timeInfo.endTimeField?!0:0<d._filterByTime([a],e.startTime,e.endTime).match.length},
_getRequestId:function(a){return("_"+a.name+a.layerId+a._ulid).replace(/[^a-zA-Z0-9\_]+/g,"_")},_fetchArchive:function(a){var d=this.featureLayer,e,f,k,l,b;d._fireUpdateStart();if(a&&this.map){e=new m(a);f=new q;a=this.map;k=d.getFilter()||{};l=k.where||"1\x3d1";b=k.geometry?g.fromJson(k.geometry):null;k=k.outFields?k.outFields.split(","):["*"];f.geometry=b;f.where=l;f.outFields=k;f.returnGeometry=!0;f.outSpatialReference=new h(a.spatialReference.toJson());d._usePatch&&(a=this._getRequestId(d),this._cancelPendingRequest(null,
a));var v=0,n=this,w=null,p=function(b){v++;e.execute(f).then(function(a){b(null,a)},function(a){b(a)})},z=function(b,a){b?2<=v||!d._relatedUrl?n._queryErrorHandler(Error("Could not get features from related feature service")):(w={relatedFeatureWarning:"Querying related feature service using the current filter failed. All related features are displayed, and the filter is applied to the stream service only"},f.where="1\x3d1",p(z)):n._drawFeatures(a,w)};p(z)}else return this._fireUpdateEnd({error:"Archive data cannot be fetched if no feature service url is provided or if the layer is not added to a map"}),
!1},_queryErrorHandler:function(a){this._purgeRequests();var d=this.featureLayer;d._errorHandler(a);d._fireUpdateEnd(a)},_getExpiredFeatures:function(){var c,d,e,f=[],g=[];if(!this.featureLayer._endTimeField&&!this._maxFeatureAge)return g;c=1E3*Math.floor(this._lastEndTimeCheck/1E3);this._lastEndTimeCheck=d=1E3*Math.ceil(Date.now()/1E3);if(c&&c!==d)for(e=this._featuresByTime;c<=d;c+=1E3)e[c]&&(f=f.concat(e[c]),delete e[c]);a.forEach(f,function(a){(a=this._getFeature(a))&&g.push(a)},this);return g}})})},
"esri/layers/TrackManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ../geometry/Polyline ./GraphicsLayer".split(" "),function(p,f,a,l,k,h,q,m){return p(null,{declaredClass:"esri.layers._TrackManager",constructor:function(a){this.layer=a;this.trackMap={};this.trackLineMap={}},initialize:function(a){this.map=a;var e=this.layer,c=e._getRenderer(),c=c&&c.trackRenderer;if("esriGeometryPoint"===e.geometryType){var d=this.container=new m._GraphicsLayer({id:e.id+
"_tracks",_child:!0,visible:e.visible,minScale:e.minScale,maxScale:e.maxScale});d.loaded=!0;d.onLoad(d);d._setMap(a,e._div);d.setRenderer(c);e.on("visibility-change",f.hitch(this,function(a){this.container.setVisibility(a.visible);this.container.evaluateSuspension()}));e.on("scale-range-change",f.hitch(this,function(){this.container.setScaleRange(this.layer.minScale,this.layer.maxScale)}))}},addFeatures:function(f){var e=this.trackMap,c=this.layer,d=c._trackIdField,h=[];a.forEach(f,function(b){var c=
b.attributes[d];(e[c]=e[c]||[]).push(b);-1===a.indexOf(h,c)&&h.push(c)});var k=c._startTimeField,l=c.objectIdField,m=function(b,a){var c=b.attributes[k],d=a.attributes[k];return c===d?b.attributes[l]<a.attributes[l]?-1:1:c<d?-1:1};a.forEach(h,function(b){e[b].sort(m)})},trimTracks:function(f){function e(a){for(a=c[a]||[];a.length>d;)h.push(a.shift())}var c=this.trackMap,d=this.layer.maximumTrackPoints||0,h=[],k;if(!d)return h;if(f)a.forEach(f,function(a){e(a)});else for(k in c)c.hasOwnProperty(k)&&
e(k);return h},drawTracks:function(f){function e(b){var a=k[b],e,f,g;f=c.trackLineMap[b];d.remove(f);delete c.trackLineMap[b];if(!a||2>a.length)return!1;f=[];for(e=a.length-1;0<=e;e--)(g=a[e].geometry)&&f.push([g.x,g.y]);a={};a[s]=b;1<f.length&&(f=new h(new q({paths:[f],spatialReference:l}),null,a),d.add(f),c.trackLineMap[b]=f)}var c=this,d=this.container,k,l,s,m;if(d)if(k=this.trackMap,l=this.map.spatialReference,s=this.layer._trackIdField,f)a.forEach(f,function(b){e(b)});else for(m in k)k.hasOwnProperty(m)&&
e(m)},refreshTracks:function(f){function e(a){var b,e;c.drawTracks([a]);if(k&&k.latestObservationRenderer){a=d[a]||[];b=a.length;for(e=0;e<b;e++)h._repaint(a[e],null,!0)}}var c=this,d=this.trackMap,h=this.layer,k=h._getRenderer(),l;if(f)a.forEach(f,function(a){e(a)});else for(l in d)d.hasOwnProperty(l)&&e(l);this.moveLatestToFront()},moveLatestToFront:function(f){a.forEach(this.getLatestObservations(f),function(a){var c=a._shape;c&&c._moveToFront();this._repaint(a,null,!0)},this.layer)},getLatestObservations:function(f){function e(a){a=
h[a];return a[a.length-1]}var c=[],d=this.layer._getRenderer(),h=this.trackMap,k;if(!d.latestObservationRenderer)return c;if(f)a.forEach(f,function(a){c.push(e(a))});else for(k in h)h.hasOwnProperty(k)&&c.push(e(k));return c},clearTracks:function(f){var e=this.getLatestObservations(f),c=this.container,d;f?a.forEach(f,function(a){delete this.trackMap[a];c&&(d=this.trackLineMap[a],c.remove(d),delete this.trackLineMap[a])},this):(this.trackMap={},this.trackLineMap={},c&&c.clear());a.forEach(e,function(a){this._repaint(a,
null,!0)},this.layer)},isLatestObservation:function(a){var e=this.trackMap[a.attributes[this.layer._trackIdField]];return e?e[e.length-1]===a:!1},destroy:function(){var a=this.container;a&&(a.clear(),a._unsetMap(this.map,this.layer._div));this.map=this.layer=this.trackMap=this.container=null}})})},"esri/layers/HeatmapManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/_base/array require ../kernel ../sniff ../geometry/Point ../geometry/webMercatorUtils ./MapImage ../renderers/HeatmapRenderer ../tasks/query dojo/_base/fx".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r){function u(){}function s(a){var b=a.layer;return{geometry:a.geometry,attributes:a.attributes,getLayer:function(){return b}}}return p(null,{declaredClass:"esri.layers.HeatmapManager",heatmapRenderer:null,sourceLayer:null,imageLayer:null,useTiles:!0,useWorker:!1,map:null,constructor:function(a){this.sourceLayer=a;this._hndls=[]},initialize:function(a){this.map=a;var b=this.sourceLayer,d=b.renderer;b.setDrawMode(!1);this.imageLayer=a._getMapImageLyr();var e=this;this.heatmapRenderer=
d instanceof c?d:(d.getRendererInfoByZoom(a.getZoom())||d.getRendererInfoByScale(a.getScale())).renderer;this._setupDraw=this._setupDraw.bind(this);this.recalculateHeatmap=this.recalculateHeatmap.bind(this);this._removeRenderer=this._removeRenderer.bind(this);this._handleRendererChange=this._handleRendererChange.bind(this);this._rendererChangeHandle=this.sourceLayer.on("renderer-change",this._handleRendererChange);this._handleOpacityChange=this._handleOpacityChange.bind(this);this._reprojectFeature=
this._reprojectFeature.bind(this);k(["../workers/heatmapCalculator"],function(b){e._calculator=new b(f.mixin({width:e.map.width,height:e.map.height},e._getOptions()));e._setupRenderer();e.heatmapRenderer.getStats=b.calculateStats;e.heatmapRenderer.getHistogramData=b.getHistogramData})},destroy:function(){this._removeHandlers();this._rendererChangeHandle&&this._rendererChangeHandle.remove();this._rendererChangeHandle=this.sourceLayer=this.imageLayer=this.map=this.heatmapRenderer=this._hndls=null},
_handleRendererChange:function(a){var b=a.renderer,d=b instanceof c;this.heatmapRenderer?d?this.heatmapRenderer=b:this._removeRenderer(a):d&&(this.heatmapRenderer=b,this.sourceLayer&&this.map&&this._setupRenderer())},_handleOpacityChange:function(a){a=a.opacity;var b=this._getImageBySourceId(this.sourceLayer.id);b&&b.setOpacity(a)},_setupRenderer:function(){var c=this._hndls,b=this.sourceLayer,d=this.map,e=this;b._originalDraw=b._draw;b._draw=u;b._div.clear();clearTimeout(this._resetTimer);this._resetTimer=
setTimeout(this._resetGraphics.bind(this),250);c.push(b.on("update-end",this._setupDraw));c.push(b.on("suspend",function(b){(b=e._getImageBySourceId(e.sourceLayer.id))&&b.hide()}));c.push(b.on("resume",function(b){(b=e._getImageBySourceId(e.sourceLayer.id))&&b.show()}));c.push(a.after(b,"redraw",this._setupDraw));c.push(d.on("layer-remove",function(a){a.layer==b&&((a=e._getImageBySourceId(e.sourceLayer.id))&&e.imageLayer.removeImage(a),e._removeRenderer({target:b}))}));b._collection&&c.push(b.on("graphic-add",
function(b){e._reprojectFeature(b.graphic);e._setupDraw()}));1!==b.mode&&(c.push(d.on("resize, pan-end",this._setupDraw)),c.push(d.on("zoom-end",this._setupDraw)));c.push(b.on("opacity-change",this._handleOpacityChange));this.imageLayer.suspended&&this.imageLayer.resume();b.graphics&&b.graphics.length&&(b.graphics[0].geometry&&!d.spatialReference.equals(b.graphics[0].geometry.spatialReference)&&l.forEach(b.graphics,function(b){this._reprojectFeature(b)}.bind(this)),this._setupDraw())},_setupDraw:function(){if(!this._drawTimer){var a=
this;this._drawTimer=setTimeout(function(){clearTimeout(a._drawTimer);a._drawTimer=null;a.sourceLayer._getRenderer().isInstanceOf(c)&&a.recalculateHeatmap()},16)}},_removeRenderer:function(a){var b=a.target;b._draw=b._originalDraw;delete b._originalDraw;b.setDrawMode(!0);this._removeHandlers();this._hndls=[];var c=this._getImageBySourceId(this.sourceLayer.id);c&&this.imageLayer.removeImage(c);clearTimeout(this._drawTimer);clearTimeout(this._resetTimer);this._drawTimer=this._resetTimer=null;b.renderer!=
a.renderer&&b.renderer.getRendererInfo?this.heatmapRenderer=null:(b.redraw(),this.destroy())},recalculateHeatmap:function(){this._calculator?this._doMainCalculation():this._calculatorClient&&this._doWorkerCalculation()},_reprojectFeature:function(a){if(a&&a.geometry){var b=a.geometry,c=this.map.spatialReference;c.equals(b.spatialReference)||(b=g.project(b,c),null==b?console.log("Unable to reproject features to map's spatial reference. Please convert feature geometry before adding to layer"):a.geometry=
b)}},_doWorkerCalculation:function(){},_doMainCalculation:function(){var a=this.sourceLayer,b=this.map,c=this.heatmapRenderer,g=this.map.extent,h=this.map.width,k=this.map.height,r=this._calculator,l=this,m=function(d){d=l._getScreenPoints(d.features,b,a);d=r.calculateImageData(f.mixin({screenPoints:d,mapinfo:{extent:[g.xmin,g.ymin,g.xmax,g.ymax],resolution:b.getResolution()},width:h,height:k},l._getOptions()));d=c.getSymbol(s({geometry:b.extent,attributes:{size:[h,k],imageData:d},layer:a}));d=new e({extent:b.extent,
href:d.url,opacity:0,sourceId:a.id});l._swapMapImages(d,l._getImageBySourceId(a.id));a.suspended&&d.hide()},u={geometry:b.extent,timeExtent:a.useMapTime?b.timeExtent:void 0,spatialRelationship:d.SPATIAL_REL_INTERSECTS};null!=a._canDoClientSideQuery(u)?a.queryFeatures(u,m):m({features:a.graphics})},_getScreenPoints:function(a,b,c){var d=[],e=a.length,f=0,g=0,h,k=new m(b.extent.xmin,b.extent.ymax,b.spatialReference),r=b.toScreen(k),s=r.x,r=r.y,u=b.getResolution(),q;for((g=b.extent.getCacheValue("_parts"))&&
(q=l.map(g,function(a){return c._intersects(b,a.extent)[0]}));e--;)g=a[e],g.geometry&&(h={x:Math.ceil((g.geometry.x-k.x)/u+s),y:Math.floor((k.y-g.geometry.y)/u-r),attributes:g.attributes},q&&(g=1<q.length&&h.x<-q[0]?q[1]:q[0],h.x+=g),d[f++]=h);return d},_getImageBySourceId:function(a){var b=this.imageLayer.getImages(),b=l.filter(b,function(b){return b.sourceId==a});if(b.length)return b[b.length-1]},_swapMapImages:function(a,b){function c(){d.removeImage(b)}var d=this.imageLayer,e=this.sourceLayer.opacity||
1;d.addImage(a);r.anim(a._node,{opacity:e},null,null,function(){a.opacity=e});null!=b&&r.anim(b._node,{opacity:0},null,null,c)},_removeHandlers:function(){if(null!=this._hndls)for(var a=this._hndls.length;a--;)this._hndls[a].remove()},_getOptions:function(){var a=this.heatmapRenderer;return{blurRadius:a.blurRadius,gradient:a.gradient,maxPixelIntensity:a.maxPixelIntensity,minPixelIntensity:a.minPixelIntensity,field:a.field,fieldOffset:a.fieldOffset}},_resetGraphics:function(){clearTimeout(this._resetTimer);
this._resetTimer=null;for(var a=this.sourceLayer.graphics,b=a.length,c;b--;)c=a[b],c._shape=c._offsets=void 0}})})},"esri/layers/MapImage":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-style dojo/has ../kernel ../domUtils ../geometry/Extent".split(" "),function(p,f,a,l,k,h,q){return p(null,{declaredClass:"esri.layers.MapImage",constructor:function(a){f.mixin(this,a);this.extent=new q(this.extent)},visible:!0,opacity:1,getLayer:function(){return this._layer},getNode:function(){return this._node},
show:function(){if(!this.visible){this.visible=!0;var a=this._node,f=this._layer,e;if(a){if(e=f&&f._div)f.suspended||f._setPos(a,e._left,e._top),(f._active||e).appendChild(a);h.show(a)}}},hide:function(){if(this.visible){this.visible=!1;var a=this._node;a&&(h.hide(a),a.parentNode&&a.parentNode.removeChild(a))}},setOpacity:function(f){var g=this._node;this.opacity=f;g&&a.set(g,"opacity",f)}})})},"esri/tasks/ProjectParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),
function(p,f,a,l,k,h,q,m){return p(null,{declaredClass:"esri.tasks.ProjectParameters",geometries:null,outSR:null,transformation:null,transformForward:null,toJson:function(){var f=a.map(this.geometries,function(a){return a.toJson()}),e={};e.outSR=this.outSR.wkid||l.toJson(this.outSR.toJson());e.inSR=this.geometries[0].spatialReference.wkid||l.toJson(this.geometries[0].spatialReference.toJson());e.geometries=l.toJson({geometryType:m.getJsonType(this.geometries[0]),geometries:f});this.transformation&&
(e.transformation=this.transformation.wkid||l.toJson(this.transformation));q.isDefined(this.transformForward)&&(e.transformForward=this.transformForward);return e}})})},"jimu/portalUrlUtils":function(){define(["dojo/_base/lang","jimu/shared/basePortalUrlUtils"],function(p,f){var a=p.clone(f);a.declaredClass="jimu.portalUrlUtils";a.getPortalUrlFromLocation=function(){return a.getPortalServerFromLocation()+a.getDeployContextFromLocation()};a.getPortalSignInUrlFromLocation=function(){var f=a.getPortalUrlFromLocation()+
"home/signin.html";return f=a.setHttpsProtocol(f)};a.getPortalServerFromLocation=function(){return window.location.protocol+"//"+window.location.host};a.getDeployContextFromLocation=function(){var a=window.location.href.split("?")[0],f=a.indexOf("/home");0>f&&(f=a.indexOf("/apps"));a=a.substring(a.indexOf(window.location.host)+window.location.host.length+1,f);"/"!==a&&(a="/"+a+"/");return a};a.getRestBaseUrlFromLocation=function(){return window.location.protocol+"//"+window.location.host+a.getDeployContextFromLocation()+
"sharing/rest/"};return a})},"jimu/shared/basePortalUrlUtils":function(){define(function(){var p={declaredClass:"jimu.shared.basePortalUrlUtils"};"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s*/gi,"").replace(/\s*$/gi,"")});"function"!==typeof String.prototype.startWith&&(String.prototype.startWith=function(f){return this.substr(0,f.length)===f});"function"!==typeof String.prototype.endWith&&(String.prototype.endWith=function(f){return this.substr(this.length-
f.length,f.length)===f});p.getServerByUrl=function(f){f=(f||"").trim();f=f.replace(/^(http(s?):?)\/\//gi,"");0===f.indexOf("//")&&(f=f.slice(2));return f.split("/")[0]};p.getServerWithProtocol=function(f){var a="";if(f=(f||"").trim()){var l=p.getServerByUrl(f);if(!l)return a;var k=p.getProtocol(f);k?a=k+"://"+l:0===f.indexOf("//")&&(a="//"+l)}return a};p.isSameServer=function(f,a){f=p.getServerByUrl(f)||"";a=p.getServerByUrl(a)||"";return f.toLowerCase()===a.toLowerCase()};p.getDomain=function(f){var a=
"";if(f=p.getServerByUrl(f))f=f.replace(/:\d+$/,""),f=f.match(/[^.]\w+\.\w+$/),null!==f&&(a=f[0],/^\d+\.\d+$/.test(a)&&(a=""));return a};p.isSameDomain=function(f,a){var l=p.getDomain(f),k=p.getDomain(a);return""!==l&&l===k};p.isOnline=function(f){return 0<=p.getServerByUrl(f).toLowerCase().indexOf(".arcgis.com")};p.isArcGIScom=function(f){f=p.getServerByUrl(f).toLowerCase();return"www.arcgis.com"===f||"arcgis.com"===f};p.getStandardPortalUrl=function(f){var a=p.getServerByUrl(f);if(""===a)return"";
p.isOnline(a)?(p.isArcGIScom(a)&&(a="www.arcgis.com"),f=p.addProtocol(f),f=p.getProtocol(f)+"://"+a):(f=(f||"").trim().replace(/sharing(.*)/gi,"").replace(/\/*$/g,""),f=p.addProtocol(f),f.replace(RegExp("http(s?)://"+a,"g"),"")||(f+="/arcgis"));return f};p.isSamePortalUrl=function(f,a){var l=/^http(s?):\/\//gi,k=/^\/\//gi;f=p.getStandardPortalUrl(f).toLowerCase().replace(l,"").replace(k,"");a=p.getStandardPortalUrl(a).toLowerCase().replace(l,"").replace(k,"");return f===a};p.addProtocol=function(f){if(-1>=
f.toLowerCase().indexOf("http://")&&-1>=f.toLowerCase().indexOf("https://")){var a="";"undefined"!==typeof window&&window.location?(a=window.location.protocol,f=f.startWith("//")?a+f:f.startWith("/")?a+"//"+window.location.host+f:a+"//"+f):(a="http:",f=f.startWith("//")?a+f:a+"//"+f)}return f};p.getProtocol=function(f){var a="";f=f.toLowerCase();0===f.indexOf("https://")?a="https":0===f.indexOf("http://")&&(a="http");return a};p.updateUrlProtocolByOtherUrl=function(f,a){a=a.toLowerCase();0===a.indexOf("https://")?
f=p.setHttpsProtocol(f):0===a.indexOf("http://")&&(f=p.setHttpProtocol(f));return f};p.removeProtocol=function(f){return f.replace(/^http(s?):\/\//i,"//")};p.setHttpProtocol=function(f){f=p.addProtocol(f);return f.replace(/^https:\/\//,"http://")};p.setHttpsProtocol=function(f){f=p.addProtocol(f);return f.replace(/^http:\/\//,"https://")};p.setProtocol=function(f,a){return 0<=a.indexOf("https")?p.setHttpsProtocol(f):0<=a.indexOf("http")?p.setHttpProtocol(f):f};p.getSharingUrl=function(f){var a="";
(f=p.getStandardPortalUrl(f))&&(a=f+"/sharing/rest");return a};p.getOAuth2Url=function(f){var a="";(f=p.getStandardPortalUrl(f))&&(a=f+"/sharing/rest/oauth2");return a};p.getAppIdUrl=function(f,a){var l="",k=p.getStandardPortalUrl(f);k&&(l=k+"/sharing/rest/oauth2/apps/"+a);return l};p.getSignInUrl=function(f){var a="";(f=p.getStandardPortalUrl(f))&&(a=f+"/home/signin.html");return a};p.getBaseSearchUrl=function(f){var a="";f=p.getStandardPortalUrl(f);(f=f.replace(/\/*$/g,""))&&(a=f+"/sharing/rest/search");
return a};p.getBaseItemUrl=function(f){var a="";(f=p.getStandardPortalUrl(f))&&(a=f+"/sharing/rest/content/items");return a};p.getItemUrl=function(f,a){var l="",k=p.getBaseItemUrl(f);k&&a&&(l=k+"/"+a);return l};p.getItemDataUrl=function(f,a){var l="",k=p.getItemUrl(f,a);k&&(l=k+"/data");return l};p.getGenerateTokenUrl=function(f){var a="";(f=p.getStandardPortalUrl(f))&&(a=f+"/sharing/rest/generateToken");return a};p.getItemDetailsPageUrl=function(f,a){var l="";f&&a&&(f=p.getStandardPortalUrl(f),l=
f+"/home/item.html?id\x3d"+a);return l};p.getUserProfilePageUrl=function(f,a){var l="";f&&a&&(f=p.getStandardPortalUrl(f),l=f+"/home/user.html?user\x3d"+a);return l};p.getBaseGroupUrl=function(f){var a="";(f=p.getStandardPortalUrl(f))&&(a=f+"/sharing/rest/community/groups");return a};p.getPortalSelfInfoUrl=function(f){var a="";(f=p.getStandardPortalUrl(f||""))&&(a=f+"/sharing/rest/portals/self");return a};p.getCommunitySelfUrl=function(f){var a="";(f=p.getStandardPortalUrl(f||""))&&(a=f+"/sharing/rest/community/self");
return a};p.getBaseUserUrl=function(f){var a="";(f=p.getStandardPortalUrl(f))&&(a=f+"/sharing/rest/community/users");return a};p.getUserUrl=function(f,a){var l="",k=p.getBaseUserUrl(f);f&&a&&(l=k+"/"+a);return l};p.getUserTagsUrl=function(f,a){var l="",k=p.getUserUrl(f,a);f&&a&&(l=k+"/tags");return l};p.getUserThumbnailUrl=function(f,a,l){var k="";(f=p.getUserUrl(f,a))&&l&&(k=f+"/info/"+l);return k};p.getContentUrl=function(f){var a="";f&&(f=p.getStandardPortalUrl(f),a=f+"/sharing/rest/content");
return a};p.getUserContentUrl=function(f,a,l){var k="",k="";f&&a&&(k=p.getContentUrl(f),k=l?k+"/users/"+a+"/"+l:k+"/users/"+a);return k};p.getAddItemUrl=function(f,a,l){var k="",k="";f&&a&&(k=p.getUserContentUrl(f,a,l),k+="/addItem");return k};p.getDeleteItemUrl=function(f,a,l){var k="";(f=p.getUserItemsUrl(f,a))&&(k=f+"/"+l+"/delete");return k};p.getUserItemsUrl=function(f,a,l){var k="",k="";f&&a&&(k=p.getUserContentUrl(f,a,l),k+="/items");return k};p.getUpdateItemUrl=function(f,a,l,k){var h="",
h="";f&&a&&(h=p.getUserItemsUrl(f,a,k),h=h+"/"+l+"/update");return h};p.shareItemUrl=function(f,a,l,k){var h="",h="";f&&a&&(h=p.getUserItemsUrl(f,a,k),h=h+"/"+l+"/share");return h};p.getHomeIndexUrl=function(f){var a="";(f=p.getStandardPortalUrl(f))&&(a=f+"/home/index.html");return a};p.getHomeMapViewerUrl=function(f,a){var l="",k=p.getStandardPortalUrl(f);k&&(l=k+"/home/webmap/viewer.html",l=a?l+("?webmap\x3d"+a):l+"?useExisting\x3d1");return l};p.getHomeSceneViewerUrl=function(f,a){var l="",k=p.getStandardPortalUrl(f);
k&&(l=k+"/home/webscene/viewer.html",a&&(l+="?webscene\x3d"+a));return l};p.getHomeGalleryUrl=function(f){var a="";(f=p.getStandardPortalUrl(f))&&(a=f+"/home/gallery.html");return a};p.getHomeGroupsUrl=function(f){var a="";(f=p.getStandardPortalUrl(f))&&(a=f+"/home/groups.html");return a};p.getHomeMyContentUrl=function(f){var a="";(f=p.getStandardPortalUrl(f))&&(a=f+"/home/content.html");return a};p.getHomeMyOrganizationUrl=function(f){var a="";(f=p.getStandardPortalUrl(f))&&(a=f+"/home/organization.html");
return a};p.getHomeUserUrl=function(f){var a="";(f=p.getStandardPortalUrl(f))&&(a=f+"/home/user.html");return a};p.getPortalHelpUrl=function(f,a){var l="",k=p.getStandardPortalUrl(f);k&&(l=k+"/portalhelp/"+(a||"en")+"/website/help/");return l};p.getPortalAdminHelpUrl=function(f,a){var l="",k=p.getStandardPortalUrl(f);k&&(l=k+"/portalhelp/"+(a||"en")+"/admin/help/");return l};p.getPortalProxyUrl=function(f){var a="";(f=p.getStandardPortalUrl(f))&&(a=f+"/sharing/proxy");return a};p.getOAuth2SignOutUrl=
function(f){var a="";(f=p.getStandardPortalUrl(f))&&(a=f+"/sharing/rest/oauth2/signout");return a};p.getNewPrintUrl=function(f){var a="";if(f=p.getStandardPortalUrl(f))f=p.setHttpProtocol(f),a=f+"/sharing/tools/newPrint";return a};return p})},"jimu/shared/utils":function(){define(["./basePortalUrlUtils"],function(p){function f(a,f){function l(f,g){var e,c,d,h,u="widgetOnScreen"===f;if(a[f]){if(a[f].groups)for(e=0;e<a[f].groups.length;e++)if(d=a[f].groups[e],g(d,{index:e,isWidget:!1,groupId:d.id,isThemeWidget:!1,
isOnScreen:u}),a[f].groups[e].widgets)for(c=0;c<a[f].groups[e].widgets.length;c++)h=a[f].groups[e].widgets[c],g(h,{index:c,isWidget:!0,groupId:d.id,isThemeWidget:h.uri&&-1<h.uri.indexOf("themes/"+a.theme.name),isOnScreen:u});if(a[f].widgets)for(e=0;e<a[f].widgets.length;e++)h=a[f].widgets[e],g(a[f].widgets[e],{index:e,isWidget:!0,groupId:f,isThemeWidget:h.uri&&-1<h.uri.indexOf("themes/"+a.theme.name),isOnScreen:u})}}l("widgetOnScreen",f);l("widgetPool",f)}var a={},l="inPanel hasLocale hasStyle hasConfig hasUIFile hasSettingPage hasSettingUIFile hasSettingLocale hasSettingStyle keepConfigAfterMapSwitched isController hasVersionManager isThemeWidget supportMultiInstance".split(" ");
a.visitElement=f;a.getConfigElementById=function(a,h){var l;if("map"===h)return a.map;f(a,function(a){if(a.id===h)return l=a,!0});return l};a.getConfigElementByLabel=function(a,h){var l;if("map"===h)return a.map;f(a,function(a){if(a.label||a.name===h)return l=a,!0});return l};a.getConfigElementsByName=function(a,h){var l=[];if("map"===h)return[a.map];f(a,function(a){a.name===h&&l.push(a)});return l};a.getWidgetNameFromUri=function(a){a=a.split("/");a.pop();return a.pop()};a.getAmdFolderFromUri=function(a){a=
a.split("/");a.pop();return a.join("/")+"/"};a.widgetProperties=l;a.processWidgetProperties=function(a){"undefined"===typeof a.properties.isController&&(a.properties.isController=!1);"undefined"===typeof a.properties.isThemeWidget&&(a.properties.isThemeWidget=!1);"undefined"===typeof a.properties.hasVersionManager&&(a.properties.hasVersionManager=!1);l.forEach(function(f){"undefined"===typeof a.properties[f]&&(a.properties[f]=!0)})};a.getControllerWidgets=function(a){var f=[];a.visitElement(function(a){a.isController&&
f.push(a)});return f};a.addI18NLabelToManifest=function(a,f,l){function m(c,d){d[g]&&(a.i18nLabels[c]=d[g]);"theme"===a.category&&(a.layouts&&a.layouts.forEach(function(e){a["i18nLabels_layout_"+e.name]||(a["i18nLabels_layout_"+e.name]={});a["i18nLabels_layout_"+e.name][c]=d["_layout_"+e.name]}),a.styles&&a.styles.forEach(function(e){a["i18nLabels_style_"+e.name]||(a["i18nLabels_style_"+e.name]={});a["i18nLabels_style_"+e.name][c]=d["_style_"+e.name]}));"widget"===a.category&&a.featureActions&&a.featureActions.forEach(function(e){a["i18nLabels_featureAction_"+
e.name]||(a["i18nLabels_featureAction_"+e.name]={});a["i18nLabels_featureAction_"+e.name][c]=d["_featureAction_"+e.name]})}a.i18nLabels={};var g="widget"===a.category?"_widgetLabel":"_themeLabel";f&&(f.root&&f.root[g])&&(a.i18nLabels.defaultLabel=f.root[g],"theme"===a.category&&(a.layouts&&a.layouts.forEach(function(c){a["i18nLabels_layout_"+c.name]={};a["i18nLabels_layout_"+c.name].defaultLabel=f.root["_layout_"+c.name]}),a.styles&&a.styles.forEach(function(c){a["i18nLabels_style_"+c.name]={};a["i18nLabels_style_"+
c.name].defaultLabel=f.root["_style_"+c.name]})),"widget"===a.category&&a.featureActions&&a.featureActions.forEach(function(c){a["i18nLabels_featureAction_"+c.name]={};a["i18nLabels_featureAction_"+c.name].defaultLabel=f.root["_featureAction_"+c.name]}));for(var e in l)m(e,l[e])};a.isHostedService=function(a){var f=p.getServerByUrl(a)+"/[^/]+/[^/]+/rest/services";return RegExp(f,"gi").test(a)};return a})},"jimu/portalUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/config dojo/Deferred dojo/topic dojo/json esri/request ./utils ./portalUrlUtils ./tokenUtils".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c){var d=p([],{declaredClass:"jimu.Portal",selfUrl:null,user:null,selfInfo:null,portalUrl:null,credential:null,constructor:function(b){this.portalUrl=e.getStandardPortalUrl(b);this.selfUrl=e.getPortalSelfInfoUrl(b)},loadSelfInfo:function(){var b=new k,a={url:this.selfUrl,content:{f:"json"},handleAs:"json",callbackParamName:"callback",preventCache:!0};this.isValidCredential()&&(a.content.token=this.credential.token);m(a).then(f.hitch(this,function(a){var c=a.user;delete a.user;
f.mixin(this,a);a.user=c;b.resolve(a)}),f.hitch(this,function(a){console.error(a);b.reject(a)}));return b},_checkCredential:function(){var b=c.isValidCredential(this.credential);b||this.clearCredentialAndUser();return b},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.credential=c.getPortalCredential(this.portalUrl))},signIn:function(){var b=new k;this.updateCredential();this.isValidCredential()?setTimeout(f.hitch(this,
function(){b.resolve(this.credential)}),0):b=c.signInPortal(this.portalUrl);return b},haveSignIn:function(){return c.userHaveSignInPortal(this.portalUrl)},clearCredentialAndUser:function(){this.user=this.credential=null},getUser:function(){this.updateCredential();var b=new k;this.user&&"jimu.PortalUser"===this.user.declaredClass?setTimeout(f.hitch(this,function(){this.user.updateCredential();b.resolve(this.user)}),0):this.isValidCredential()?this.credential.userId?this._getUser(this.credential.userId).then(f.hitch(this,
function(a){this.user=a;b.resolve(this.user)}),f.hitch(this,function(a){console.error(a);b.reject(a)})):c.getUserIdByToken(this.credential.token,this.portalUrl).then(f.hitch(this,function(a){this.credential.userId=a;this._getUser(this.credential.userId).then(f.hitch(this,function(a){this.user=a;b.resolve(this.user)}),f.hitch(this,function(a){console.error(a);b.reject(a)}))}),f.hitch(this,function(a){console.error(a);b.reject(a)})):setTimeout(f.hitch(this,function(){b.reject("credential is null.")}),
0);return b},queryItems:function(b){this.updateCredential();var c=new k,d=e.getBaseSearchUrl(this.portalUrl),g={f:"json"};b&&(g=f.mixin(g,b));this.isValidCredential()&&(g.token=this.credential.token);!g.sortField&&!g.sortOrder&&(g.sortField="title",g.sortOrder="asc");m({url:d,handleAs:"json",content:g,callbackParamName:"callback"}).then(f.hitch(this,function(b){b.results=a.map(b.results,f.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new s(a)}));
c.resolve(b)}),f.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getItemData:function(a){this.updateCredential();a={url:e.getItemDataUrl(this.portalUrl,a),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential.token);return m(a)},getItemById:function(a){var c=new k;this.updateCredential();a={url:e.getItemUrl(this.portalUrl,a),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&
(a.content.token=this.credential.token);m(a).then(f.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;a=new s(a);c.resolve(a)}),f.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getAppById:function(a){var c=new k;this.updateCredential();this.isValidCredential()?(a=e.getAppIdUrl(this.portalUrl,a),c=m({url:a,handleAs:"json",content:{f:"json",token:this.credential.token}})):setTimeout(f.hitch(this,function(){c.reject("token is null.")}),0);
return c},queryGroups:function(b){this.updateCredential();var c=new k,d=e.getBaseGroupUrl(this.portalUrl),g={f:"json"};b&&(g=f.mixin(g,b));this.isValidCredential()&&(g.token=this.credential.token);m({url:d,handleAs:"json",content:g,callbackParamName:"callback"}).then(f.hitch(this,function(b){b.results=a.map(b.results,f.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new u(a)}));c.resolve(b)}),f.hitch(this,function(a){console.error(a);c.reject(a)}));
return c},registerApp:function(a,c,d){var g=new k;this.updateCredential();if(this.isValidCredential())var h=this.credential&&this.credential.token,r=e.getOAuth2Url(this.portalUrl),g=m({url:r+"/registerApp",content:{itemId:a,appType:c,redirect_uris:q.stringify(d),token:h,f:"json"},handleAs:"json"},{usePost:!0});else setTimeout(f.hitch(this,function(){g.reject("token is null.")}),0);return g},createAndRegisterApp:function(a){var c=new k;this.updateCredential();this.isValidCredential()?this.getUser().then(f.hitch(this,
function(d){d.addItem({title:"Web AppBuilder for ArcGIS",type:"Web Mapping Application",text:"",snippet:"",tags:"Registered App for OAuth"},"").then(f.hitch(this,function(d){d.success?this.registerApp(d.id,"browser",a).then(f.hitch(this,function(a){c.resolve(a)}),f.hitch(this,function(a){console.error(a);c.reject(a)})):c.reject("create app failed")}),f.hitch(this,function(a){console.error(a);c.reject(a)}))}),f.hitch(this,function(a){console.error(a);c.reject(a)})):setTimeout(f.hitch(this,function(){c.reject("token is null.")}),
0);return c},_getUser:function(a){this.updateCredential();var c=new k;a={url:e.getUserUrl(this.portalUrl,a),content:{f:"json"},handleAs:"json",callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential&&this.credential.token);m(a).then(f.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;this.user=new r(a);c.resolve(this.user)}),f.hitch(this,function(a){console.error(a);c.reject(a)}));return c}}),r=p([],{declaredClass:"jimu.PortalUser",
portalUrl:null,credential:null,portal:null,constructor:function(a){a&&f.mixin(this,a)},_checkCredential:function(){var a=c.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},getGroups:function(){var b=[];this.groups&&(b=a.map(this.groups,f.hitch(this,function(a){a.portalUrl=
this.portalUrl;a.credential=this.credential;a.portal=this.portal;return new u(a)})));return b},getItemsByKeywords:function(a,c){return this.portal.queryItems({start:c||1,num:100,q:"owner:"+this.username+' AND typekeywords:"'+a+'"'})},getContent:function(){this.updateCredential();var a={url:e.getUserContentUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential&&(a.content.token=this.credential.token);return m(a)},getTags:function(){this.updateCredential();
var a={url:e.getUserTagsUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential.token);return m(a)},addItem:function(a,c){this.updateCredential();var d=new k;if(this.isValidCredential()){var g={f:"json",token:this.credential.token};a&&(g=f.mixin(g,a));m({url:e.getAddItemUrl(this.portalUrl,this.username,c),handleAs:"json",callbackParamName:"callback",content:g},{usePost:!0}).then(f.hitch(this,function(a){d.resolve(a)}),
f.hitch(this,function(a){console.error(a);d.reject(a)}))}else setTimeout(f.hitch(this,function(){d.reject("token is null.")}),0);return d},deleteItem:function(a){this.updateCredential();var c=new k;this.isValidCredential()?(a=e.getDeleteItemUrl(this.portalUrl,this.username,a),c=m({url:a,content:{token:this.credential.token,f:"json"},handleAs:"json"},{usePost:!0})):setTimeout(f.hitch(this,function(){c.reject("token is null.")}),0);return c},getItemById:function(a,c){this.updateCredential();var d=new k,
g={url:e.getUserItemsUrl(this.portalUrl,this.username,c)+"/"+a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(g.content.token=this.credential.token);m(g).then(f.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;a=new s(a);d.resolve(a)}),f.hitch(this,function(a){console.error(a);d.reject(a)}));return d},shareItem:function(a,c,d){this.updateCredential();var g=new k;this.isValidCredential()?(c={url:e.shareItemUrl(this.portalUrl,
this.username,c,d),handleAs:"json",callbackParamName:"callback",content:{f:"json",token:this.credential.token}},a&&(c.content=f.mixin(c.content,a)),m(c,{usePost:!0}).then(f.hitch(this,function(a){g.resolve(a)}),f.hitch(this,function(a){console.error(a);g.reject(a)}))):setTimeout(f.hitch(this,function(){g.reject("token is null.")}),0);return g},updateItem:function(a,c){this.updateCredential();var d=new k;this.isValidCredential()?this.portal.getItemById(a).then(f.hitch(this,function(g){var h={f:"json",
token:this.credential.token};c&&(h=f.mixin(h,c));m({url:e.getUpdateItemUrl(this.portalUrl,this.username,a,g.ownerFolder),handleAs:"json",callbackParamName:"callback",timeout:1E5,content:h},{usePost:!0}).then(f.hitch(this,function(a){d.resolve(a)}),f.hitch(this,function(a){console.error(a);d.reject(a)}))}),f.hitch(this,function(a){console.error(a);d.reject(a)})):setTimeout(f.hitch(this,function(){d.reject("token is null.")}),0);return d},isAdminRole:function(){return"org_admin"===this.role||"account_admin"===
this.role},isPublisherRole:function(){return"org_publisher"===this.role||"account_publisher"===this.role},isUserRole:function(){return"org_user"===this.role||"account_user"===this.role}}),u=p([],{declaredClass:"jimu.PortalGroup",portalUrl:null,credential:null,portal:null,constructor:function(a){a&&f.mixin(this,a)},_checkCredential:function(){var a=c.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},
updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},queryItems:function(a){a.q="group:"+this.id+" AND "+a.q;return this.portal.queryItems(a)}}),s=p([],{declaredClass:"jimu.PortalItem",itemUrl:null,detailsPageUrl:null,ownerPageUrl:null,portalUrl:null,credential:null,portal:null,token:null,constructor:function(a){a&&f.mixin(this,a);this.itemUrl=e.getItemUrl(this.portalUrl,this.id);!this.thumbnailUrl&&(this.thumbnail&&this.itemUrl)&&
(this.thumbnailUrl=this.itemUrl+"/info/"+this.thumbnail);this.token=this.credential&&this.credential.token;this.thumbnailUrl&&this.token&&(this.thumbnailUrl+="?token\x3d"+this.token);this.portalUrl&&this.id&&(this.detailsPageUrl=e.getItemDetailsPageUrl(this.portalUrl,this.id));this.portalUrl&&this.owner&&(this.ownerPageUrl=e.getUserProfilePageUrl(this.portalUrl,this.owner))},_checkCredential:function(){var a=c.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();
return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},getItemData:function(){return this.portal.getItemData(this.id)}}),t={portals:[],webMapQueryStr:" "+g.getItemQueryStringByTypes(["Web Map"])+" ",webSceneQueryStr:" "+g.getItemQueryStringByTypes(["Web Scene"])+" ",_findPortal:function(a){for(var c=0;c<this.portals.length;c++){var d=this.portals[c];if(e.isSamePortalUrl(a,d.portalUrl))return d.updateCredential(),
d}return null},getPortal:function(a){if(!a||!("string"===typeof a&&f.trim(a)))return null;a=e.getStandardPortalUrl(a);var g=this._findPortal(a);g||(g=new d(a),g.credential=c.getPortalCredential(g.portalUrl),g.updateCredential(),this.portals.push(g));return g},getPortalSelfInfo:function(a){return this.getPortal(a).loadSelfInfo()},getBasemapGalleryGroup:function(a){return this._getPortalSelfGroup(a,"basemapGalleryGroupQuery")},getTemplatesGroup:function(a){return this._getPortalSelfGroup(a,"templatesGroupQuery")},
getUnits:function(a){var c="english",d="",e=new k;this.getPortal(a).getUser().then(f.hitch(this,function(a){a&&a.units?c=a.units:(d=l.locale,c=d.startWith("en")?"english":"metric");e.resolve(c)}),f.hitch(this,function(g){console.warn(g);this.getPortalSelfInfo(a).then(f.hitch(this,function(a){var b=null;a&&a.units?b=a.units:(d=a&&a.culture||l.locale,b=d.startWith("en")?"english":"metric");e.resolve(b)}),f.hitch(this,function(a){console.warn(a);d=l.locale;c=d.startWith("en")?"english":"metric";e.resolve(c)}))}));
return e.promise},_getPortalSelfGroup:function(a,c){var d=new k,e=this.getPortal(a);e||setTimeout(f.hitch(this,function(){d.reject()}),0);this.getPortalSelfInfo(a).then(f.hitch(this,function(a){e.queryGroups({f:"json",q:a[c]}).then(f.hitch(this,function(a){0<a.results.length?(a=a.results[0],a.portalUrl=e.portalUrl,a.credential=e.credential,a.portal=e,a=new u(a),d.resolve(a)):d.reject("Can't find portal self group.")}),f.hitch(this,function(a){console.error(a);d.reject(a)}))}),f.hitch(this,function(a){console.error(a);
d.reject(a)}));return d},getWebMapsFromBasemapGalleryGroup:function(a){var c=new k;this.getBasemapGalleryGroup(a).then(f.hitch(this,function(a){a?a.queryItems({start:1,num:100,f:"json",q:this.webMapQueryStr}).then(f.hitch(this,function(a){c.resolve(a)}),f.hitch(this,function(a){console.error(a);c.reject(a)})):c.reject()}),f.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getDefaultWebScene:function(b){var c=e.getStandardPortalUrl(b);return this._searchWABDefaultWebScene(c).then(f.hitch(this,
function(b){return b?b:this._createWABDefaultWebScene(c).then(f.hitch(this,function(b){return this.getPortal(c).getUser().then(f.hitch(this,function(c){var d=!1;c&&(c.privileges&&0<c.privileges.length)&&(d=a.some(c.privileges,function(a){return 0<=a.indexOf("shareToPublic")}));return d?c.shareItem({everyone:!0},b).then(f.hitch(this,function(){return b}),f.hitch(this,function(){return b})):b}),f.hitch(this,function(a){console.error(a);return b}))}))}))},_searchWABDefaultWebScene:function(a){var c=
new k;a=e.getStandardPortalUrl(a);this.getPortal(a).queryItems({q:'typekeywords:"WABDefaultWebScene" access:public '+this.webSceneQueryStr}).then(f.hitch(this,function(a){a&&a.results&&0<a.results.length?c.resolve(a.results[0].id):c.resolve(null)}),f.hitch(this,function(a){console.error("_searchWABDefaultWebScene error:",a);c.reject(a)}));return c},_createWABDefaultWebScene:function(a){var c=new k;a=e.getStandardPortalUrl(a);this.getPortal(a).getUser().then(f.hitch(this,function(a){var b={title:"Default Web Scene",
type:"Web Scene",typeKeywords:"WABDefaultWebScene",tags:"default",text:q.stringify({operationalLayers:[],baseMap:{id:"151b431fe65-basemap-0",title:"Topographic",baseMapLayers:[{id:"defaultBasemap",url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer"}],elevationLayers:[{id:"globalElevation",url:"http://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}]},
version:"1.3",authoringApp:"WebSceneViewer",authoringAppVersion:"3.10.0.0",spatialReference:{wkid:102100,latestWkid:3857},viewingMode:"global",initialState:{viewpoint:{scale:4.5188197847224146E7,rotation:0,targetGeometry:{x:144770.99872895706,y:3232837.215000455,spatialReference:{wkid:102100,latestWkid:3857},z:-127.7412482528016},camera:{position:{x:144770.99767624016,y:3182557.105058348,spatialReference:{wkid:102100,latestWkid:3857},z:2.551254800000001E7},heading:0,tilt:0.0999986601088944}},environment:{lighting:{datetime:1426420488E3,
displayUTCOffset:0}}},presentation:{slides:[]}}),snippet:""};a.addItem(b,"").then(f.hitch(this,function(a){a.success?c.resolve(a.id):(console.error("Can't create default web scene:",a),c.reject())}))}),f.hitch(this,function(a){console.error("Can't create default web scene");c.reject(a)}));return c},getDefaultWebMap:function(a){var c=new k;this.getPortalSelfInfo(a).then(f.hitch(this,function(d){var e=d.defaultBasemap&&d.defaultBasemap.id;e?c.resolve(e):this._getDefaultWebMapByBasemapGallery(a,d).then(f.hitch(this,
function(d){d?c.resolve(d):this._getMostNumViewsWebMap(a).then(f.hitch(this,function(a){a?c.resolve(a):c.reject()}),f.hitch(this,function(a){console.error(a);c.reject(a)}))}),f.hitch(this,function(a){console.error(a);c.reject(a)}))}),f.hitch(this,function(a){console.error(a);c.reject(a)}));return c},_getDefaultWebMapByBasemapGallery:function(b,c){var d=new k,e=this.getPortal(b),g=c.defaultBasemap&&c.defaultBasemap.title;e.queryGroups({f:"json",q:c.basemapGalleryGroupQuery}).then(f.hitch(this,function(b){b=
b.results;0<b.length?e.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND group:"+b[0].id+" AND title:"+g}).then(f.hitch(this,function(b){b=b.results;b=a.filter(b,f.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<b.length?d.resolve(b[0].id):(console.log("Can't find web map under basemapGalleryGroupQuery."),e.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND title:"+g}).then(f.hitch(this,function(b){b=b.results;b=a.filter(b,f.hitch(this,function(a){return a.type&&
"web map"===a.type.toLowerCase()}));if(0<b.length){var c=b[0];e.getItemData(c.id).then(f.hitch(this,function(a){a&&(a.operationalLayers||a.baseMap||a.version)?d.resolve(c.id):d.resolve(null)}),f.hitch(this,function(){d.resolve(null)}))}else console.log("Can't find web map by defaultBasemap.title."),d.resolve(null)}),f.hitch(this,function(a){console.error(a);d.reject(a)})))}),f.hitch(this,function(a){console.error(a);d.reject(a)})):(console.log("Can't find group by basemapGalleryGroupQuery."),d.resolve(null))}),
f.hitch(this,function(a){console.error(a);d.reject(a)}));return d},_getMostNumViewsWebMap:function(b){var c=new k;this.getPortal(b).queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND access:public AND owner:esri_en",sortField:"numViews",sortOrder:"desc"}).then(f.hitch(this,function(b){b=b.results;b=a.filter(b,f.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<b.length?c.resolve(b[0].id):c.reject("Can't find most-num-views web map.")}),f.hitch(this,function(a){console.error(a);
c.reject(a)}));return c},comparePortalVersion:function(a,c){var d=a.split("."),e=parseInt(d[0],10),d=1<d.length?parseInt(d[1],10):0,f=c.split("."),g=parseInt(f[0],10),f=1<f.length?parseInt(f[1],10):0;return e>g?1:e<g?-1:d>f?1:d<f?-1:0}};h.subscribe("userSignOut",function(a){(a=t._findPortal(a))&&a.clearCredentialAndUser()});return t})},"jimu/tokenUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/Deferred dojo/cookie dojo/json dojo/topic dojo/request/script esri/kernel esri/config esri/request esri/urlUtils esri/IdentityManager esri/arcgis/OAuthInfo jimu/portalUrlUtils jimu/utils".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t){"function"!==typeof k.getAll&&(k.getAll=function(a){var c=[];(a=k(a))&&c.push(a);return c});r={portalUrl:null,cookiePath:"/",_started:!1,webTierPortalUrls:[],isInBuilderWindow:function(){return!!window.isBuilder},isInConfigOrPreviewWindow:function(){var a=!1;try{a=!window.isBuilder&&window.parent&&window.parent!==window&&window.parent.isBuilder}catch(c){console.log(c),a=!1}return!!a},isStringStartWith:function(a,c){return a.substr(0,c.length)===c},getCookiePath:function(){return this.cookiePath},
setPortalUrl:function(a){(a=s.getStandardPortalUrl(a))&&(a+="/");this.portalUrl=a},getPortalUrl:function(){return this.portalUrl},isWebTierPortal:function(a){var c=new l,f=s.getStandardPortalUrl(a);a=f+"/sharing";var h=s.setHttpsProtocol(f+"/sharing/rest/generateToken?f\x3djson"),k=s.setHttpsProtocol(a);m.get(h,{jsonp:"callback"}).then(p.hitch(this,function(a){a.token?(this.webTierPortalUrls.push(f),this.removeWabAuthCookie(),g.id.getCredential(k).then(p.hitch(this,function(b){b.token||(b.token=a.token);
b=d.canUseXhr(b.server,!0);-1<b&&e.defaults.io.corsEnabledServers.splice(b,1);this._pushCorsEnabledServerInfo({host:s.getServerByUrl(f),withCredentials:!0});c.resolve(!0)}),p.hitch(this,function(){c.resolve(!0)}))):c.resolve(!1)}),p.hitch(this,function(a){console.error(a);c.reject(a)}));return c},addAuthorizedCrossOriginDomains:function(a){if(a&&0<a.length)for(var c=0;c<a.length;c++)this.addWithCredentialDomain(a[c])},addWithCredentialDomain:function(a){if(a&&"string"===typeof a){var c=e.defaults.io.corsEnabledServers,
f=s.getServerByUrl(a);(a=s.getServerWithProtocol(a))||(a="http://"+f);a=d.canUseXhr(a,!0);-1<a&&c.splice(a,1);this._pushCorsEnabledServerInfo({host:f,withCredentials:!0})}},_pushCorsEnabledServerInfo:function(a){if(a){var c=e.defaults.io.corsEnabledServers,d="charAt charCodeAt concat endsWith indexOf lastIndexOf localeCompare match replace search slice split startsWith substr substring toLocaleLowerCase toLocaleUpperCase toLowerCase toString toUpperCase trim trimLeft trimRight valueOf".split(" ");
if("object"===typeof a&&"string"===typeof a.host){for(var g in a.host)a[g]="function"===typeof a.host[g]?function(){return a.host[g].apply(a.host,arguments)}:a.host[g];a.length=a.host.length;f.forEach(d,function(c){"function"===typeof a.host[c]&&(a[c]=function(){return a.host[c].apply(a.host,arguments)})})}c.push(a)}},tryRegisterCredential:function(a){return!this.isValidCredential(a)?!1:!f.some(g.id.credentials,p.hitch(this,function(c){return a.token===c.token}))?(g.id.credentials.push(a),!0):!1},
registerToken:function(a){var c=s.getSharingUrl(this.portalUrl);g.id.findCredential(c)&&f.some(g.id.credentials,p.hitch(this,function(a,b){if(this.isValidPortalCredentialOfPortalUrl(this.portalUrl,a))return g.id.credentials.splice(b,1),!0}));return this._getTokenInfo(a).then(function(a){g.id.registerToken(a)})},_getTokenInfo:function(a){var c=s.getPortalSelfInfoUrl(this.portalUrl);return m.get(c+("?f\x3djson\x26token\x3d"+a),{jsonp:"callback"}).then(p.hitch(this,function(c){if(c.user)return{server:s.getSharingUrl(this.portalUrl),
ssl:c.allSSL,token:a,userId:c.user.username};throw Error(window.jimuNls.urlParams.invalidToken);}),function(a){console.error(a);throw Error(window.jimuNls.urlParams.validateTokenError);})},_isInvalidPortalUrl:function(a){return a&&"string"===typeof a&&p.trim(a)},signInPortal:function(a){var c=new l;if(this._isInvalidPortalUrl(a)){a=s.getStandardPortalUrl(a);var d=s.getSharingUrl(a),e=this.getPortalCredential(a);e?setTimeout(p.hitch(this,function(){c.resolve(e)}),0):c=g.id.getCredential(d)}else setTimeout(p.hitch(this,
function(){c.reject("Invalid portalurl.")}),0);return c},_loadPortalSelfInfo:function(a){a=s.getPortalSelfInfoUrl(a);return c({url:a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"})},registerOAuthInfo:function(a,c){if(!a||!("string"===typeof a&&c&&"string"===typeof c))return null;var d=g.id.findOAuthInfo(a);d||(d=window.location.protocol+"//"+window.location.host+require.toUrl("jimu")+"/oauth-callback.html",d=new u({appId:c,expiration:20160,portalUrl:a,authNamespace:"/",popup:!0,
popupCallbackUrl:d}),g.id.registerOAuthInfos([d]));d.appId=c;return d},signOutAll:function(){var a=s.getStandardPortalUrl(this.portalUrl),c=!!g.id.findCredential(a+"/sharing/rest");window.appInfo.isRunInPortal?this.removeEsriAuthCookieStorage():this.removeWabAuthCookie();g.id.destroyCredentials();g.id._oAuthHash=null;c&&this._publishCurrentPortalUserSignOut(a)},userHaveSignInPortal:function(a){return!!this.getPortalCredential(p.trim(a||""))},isValidCredential:function(a){var c=!1;if(a){var c=a.token,
d=a.server,e=a.scope,c=c&&"string"===typeof c&&p.trim(c),d=d&&"string"===typeof d&&p.trim(d),e="portal"===e||"server"===e,f=!0;a.expires&&(a=parseInt(a.expires,10),f=(new Date).getTime(),f=a>f);c=c&&d&&e&&f}return c},isValidPortalCredentialOfPortalUrl:function(a,c){var d=!1;if(this.isValidCredential(c))var d="portal"===c.scope,e=s.isSameServer(a,c.server),d=d&&e;return d},getPortalCredential:function(a){var c=null;a=p.trim(a||"");if(!a)return null;a=s.getStandardPortalUrl(a);return c=this._filterPortalCredential(a,
g.id.credentials)},saveAndRegisterCookieToCredential:function(a){a=p.clone(a);a.referer=window.location.host;a.scope="portal";a.isAdmin=!!a.isAdmin;this.saveWabCookie(a);var c=a.server+"/sharing/rest";a.server=c;g.id.registerToken(a);return g.id.findCredential(c,a.userId)},registerAuth2Hash:function(a){a=p.clone(a);var c=1E3*parseInt(a.expires_in,10),c=(new Date).getTime()+c,d=s.getStandardPortalUrl(a.state.portalUrl);return this.saveAndRegisterCookieToCredential({referer:window.location.host,server:d,
token:a.access_token,expires:c,userId:a.username,scope:"portal",isAdmin:!!a.isAdmin})},saveWabCookie:function(a){this.removeCookie("wab_auth");k("wab_auth",h.stringify(a),{expires:new Date(a.expires),path:"/"})},removeWabAuthCookie:function(){this.removeCookie("wab_auth")},removeEsriAuthCookieStorage:function(){this.removeCookie("esri_auth");window.localStorage&&window.localStorage.removeItem("esriJSAPIOAuth");window.sessionStorage&&window.sessionStorage.removeItem("esriJSAPIOAuth")},_filterPortalCredential:function(a,
c){var d=null;if(c&&0<c.length){var e=f.filter(c,p.hitch(this,function(c){return this.isValidPortalCredentialOfPortalUrl(a,c)}));0<e.length&&(d=e[e.length-1])}return d},_removePortalCredential:function(a){var c=p.trim(a||"");if(c){c=s.getStandardPortalUrl(c);for(a=f.filter(g.id.credentials,p.hitch(this,function(a){return this.isValidPortalCredentialOfPortalUrl(c,a)}));0<a.length;)a[0].destroy(),a.splice(0,1);g.id.credentials=f.filter(g.id.credentials,p.hitch(this,function(a){return!this.isValidPortalCredentialOfPortalUrl(c,
a)}))}},getUserIdByToken:function(a,d){var e=new l;if(a&&"string"===typeof a&&d&&"string"===typeof d){var h=s.getStandardPortalUrl(d),k=f.filter(g.id.credentials,p.hitch(this,function(c){var d=c.token===a&&c.userId;c=s.isSameServer(h,c.server);return d&&c}));if(0<k.length){var r=k[0];setTimeout(p.hitch(this,function(){e.resolve(r.userId)}),0);return e}k=s.getCommunitySelfUrl(h);c({url:k,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(p.hitch(this,function(a){e.resolve(a&&a.username||
"")}),p.hitch(this,function(a){console.error(a);e.reject("fail to get userId by token")}))}else setTimeout(p.hitch(this,function(){e.reject("invalid parameters")}),0);return e},xtGetCredentialFromCookie:function(a){var c=k("wab_auth"),d=null;if(c)try{d=h.parse(c)}catch(e){console.error(e)}if(!(d&&"object"===typeof d)||!s.isSameServer(a,d.server)||window.location.host!==d.referer)return null;d.expires=parseInt(d.expires,10);c=(new Date).getTime();if(!(d.expires>c))return this.removeCookie("wab_auth"),
null;a+="/sharing/rest";d.server=a;(c=g.id.findCredential(a))||g.id.registerToken(d);return c=g.id.findCredential(a)},removeCookie:function(a){var c=this.getCookiePath();t.removeCookie(a,c)},_getDomainsByServerName:function(a){var c=a.split("."),d=c.length;return f.map(c,p.hitch(this,function(a,b){var e=c.slice(b,d),g="",h=e.length-1;f.forEach(e,p.hitch(this,function(a,b){g+=a;b!==h&&(g+=".")}));return g}))},_publishCurrentPortalUserSignIn:function(a){if(this.isValidCredential(a))try{q.publish("userSignIn",
a)}catch(c){console.error(c)}},_publishAnyUserSignIn:function(a){if(this.isValidCredential(a))try{q.publish("anyUserSignIn",a)}catch(c){console.error(c)}},_publishCurrentPortalUserSignOut:function(a){try{q.publish("userSignOut",a)}catch(c){console.error(c)}},_signInSuccess:function(a){try{this.isValidPortalCredentialOfPortalUrl(this.portalUrl,a)&&this._publishCurrentPortalUserSignIn(a),this._publishAnyUserSignIn(a)}catch(c){console.error(c)}},_bindEvents:function(){a.after(g.id,"signIn",p.hitch(this,
function(b,c){console.log(c[1]);a.after(b,"callback",p.hitch(this,function(a,b){this._signInSuccess(b[0],!1)}));return b}))},isStart:function(){return this._started},startup:function(){if(!this._started){if(this.isInConfigOrPreviewWindow()){var a=window.parent;if(a){var c=a.esri&&a.esri.id;c&&(g.id=c,c=window.esriConfig.defaults.io,a=a.esriConfig.defaults.io,c.corsEnabledServers=a.corsEnabledServers,c.webTierAuthServers=a.webTierAuthServers,c._processedCorsServers=a._processedCorsServers,c.corsStatus=
a.corsStatus)}}this._bindEvents();this._started=!0}}};r.startup();return r})},"esri/IdentityManager":function(){define(["./IdentityManagerDialog","./kernel","./OAuthSignInHandler","dojo/_base/declare"],function(p,f,a,l){p=new p;f.id=l.safeMixin(p,a);return f.id})},"esri/IdentityManagerDialog":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/has dojo/dom-attr dojo/keys dijit/registry dijit/Dialog ./kernel ./lang ./domUtils ./Credential ./IdentityManagerBase dojo/i18n!./nls/jsapi dojo/query dijit/form/Button dijit/form/Form dijit/form/ValidationTextBox".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t){return f([s],{declaredClass:"esri.IdentityManager",_eventMap:{"dialog-cancel":["info"]},constructor:function(a){k.mixin(this,a);this.registerConnectEvents()},_dialogContent:"\x3cdiv data-dojo-type\x3d'dijit.form.Form' data-dojo-props\x3d'\"class\":\"esriIdForm\"'\x3e\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3ctable style\x3d'width: 100%;'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblUser}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"text\", \"class\":\"esriIdUser\", required:true, trim:true, style:\"width: 100%;\", autocapitalize:\"none\", autocorrect:\"off\", spellcheck:false' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblPwd}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"password\", \"class\":\"esriIdPwd\", required:true, style:\"width: 100%;\"' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e",
onDialogCreate:function(){},onDialogCancel:function(){},signIn:function(b,c,d){this._nls||(this._nls=t.identity);this._loginDialog||(this._loginDialog=this.dialog=this._createLoginDialog(),this.onDialogCreate());var e=this._loginDialog,f=d&&d.error,g=d&&d.token,h=new l(function(){e.onCancel()});if(e.open)return b=Error("BUSY"),b.code="IdentityManager.1",b.log=a.isDebug,h.errback(b),h;r.hide(e.errMsg_);f&&(403==f.code&&g)&&(q.set(e.errMsg_,"innerHTML",this._nls.forbidden),r.show(e.errMsg_));e.dfd_=
h;e.serverInfo_=c;e.resUrl_=b;e.admin_=d&&d.isAdmin;q.set(e.resLink_,{title:b,innerHTML:"("+(this.getResourceName(b)||this._nls.lblItem)+")"});q.set(e.serverLink_,{title:c.server,innerHTML:(-1!==c.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":c.server)+" "});e.txtPwd_.set("value","");e.show();return h},_createLoginDialog:function(){var b=this._nls,f=d.substitute(b,this._dialogContent),f=d.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",
server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},f),n=new e({title:b.title,content:f,"class":"esriSignInDialog",style:"width: 18em;",esriIdMgr_:this,keypressed_:function(a){a.charOrCode===m.ENTER&&this.execute_()},execute_:function(){var a=this.txtUser_.get("value"),f=this.txtPwd_.get("value"),g=this.dfd_,n=this;if(this.form_.validate()&&a&&f){this.btnSubmit_.set("label",b.lblSigning);var h=c.id.findCredential(n.resUrl_,a),k=function(c){n.btnSubmit_.set("label",
b.lblOk);n.btnSubmit_.set("disabled",!1);r.hide(n.errMsg_);n.hide();e._DialogLevelManager.hide(n);var f=n.serverInfo_;n.dfd_=n.serverInfo_=n.generateDfd_=n.resUrl_=null;var k,l,s=h,m;c&&(k=c.token,l=d.isDefined(c.expires)?Number(c.expires):null,m=!!c.ssl,s?(s.userId=a,s.token=k,s.expires=l,s.validity=c.validity,s.ssl=m,s.creationTime=(new Date).getTime()):s=new u({userId:a,server:f.server,token:k,expires:l,ssl:m,isAdmin:n.admin_,validity:c.validity}));g.callback(s)};h&&!h._enqueued?k():(n.btnSubmit_.set("disabled",
!0),n.generateDfd_=c.id.generateToken(this.serverInfo_,{username:a,password:f},{isAdmin:this.admin_}).addCallback(k).addErrback(function(a){n.btnSubmit_.set("disabled",!1);n.generateDfd_=null;n.btnSubmit_.set("label",b.lblOk);q.set(n.errMsg_,"innerHTML",a&&a.code?b.invalidUser:b.noAuthService);r.show(n.errMsg_)}))}},cancel_:function(){n.generateDfd_&&n.generateDfd_.cancel();var b=n.dfd_,c=n.resUrl_,d=n.serverInfo_;n.btnSubmit_.set("disabled",!1);n.dfd_=n.serverInfo_=n.generateDfd_=n.resUrl_=null;
r.hide(n.errMsg_);e._DialogLevelManager.hide(n);n.esriIdMgr_.onDialogCancel({resourceUrl:c,serverInfo:d});c=Error("ABORTED");c.code="IdentityManager.2";c.log=a.isDebug;b.errback(c)}}),f=n.domNode;n.form_=g.byNode(p.query(".esriIdForm",f)[0]);n.txtUser_=g.byNode(p.query(".esriIdUser",f)[0]);n.txtPwd_=g.byNode(p.query(".esriIdPwd",f)[0]);n.btnSubmit_=g.byNode(p.query(".esriIdSubmit",f)[0]);n.btnCancel_=g.byNode(p.query(".esriIdCancel",f)[0]);n.resLink_=p.query(".resLink",f)[0];n.serverLink_=p.query(".serverLink",
f)[0];n.errMsg_=p.query(".esriErrorMsg",f)[0];n.connect(n.txtUser_,"onKeyPress",n.keypressed_);n.connect(n.txtPwd_,"onKeyPress",n.keypressed_);n.connect(n.btnSubmit_,"onClick",n.execute_);n.connect(n.btnCancel_,"onClick",n.onCancel);n.connect(n,"onCancel",n.cancel_);return n}})})},"dijit/Dialog":function(){define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/ready dojo/sniff dojo/window dojo/dnd/Moveable dojo/dnd/TimedMoveable ./focus ./_base/manager ./_Widget ./_TemplatedMixin ./_CssStateMixin ./form/_FormMixin ./_DialogMixin ./DialogUnderlay ./layout/ContentPane ./layout/utils dojo/text!./templates/Dialog.html ./a11yclick dojo/i18n!./nls/common".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A,B,F,E,H,I,M){function Q(){}var K=new k;K.resolve(!0);x=l("dijit._DialogBase"+(t("dojo-bidi")?"_NoBidi":""),[y,B,F,A],{templateString:M,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!1,duration:x.defaultDuration,refocus:!0,autofocus:!0,_firstFocusItem:null,_lastFocusItem:null,draggable:!0,_setDraggableAttr:function(a){this._set("draggable",a)},maxRatio:0.9,
closable:!0,_setClosableAttr:function(a){this.closeButtonNode.style.display=a?"":"none";this._set("closable",a)},postMixInProperties:function(){var a=c.getLocalization("dijit","common");r.mixin(this,a);this.inherited(arguments)},postCreate:function(){g.set(this.domNode,{display:"none",position:"absolute"});this.ownerDocumentBody.appendChild(this.domNode);this.inherited(arguments);a.after(this,"onExecute",r.hitch(this,"hide"),!0);a.after(this,"onCancel",r.hitch(this,"hide"),!0);this._modalconnects=
[]},onLoad:function(){this.resize();this._position();this.autofocus&&O.isTop(this)&&(this._getFocusItems(),w.focus(this._firstFocusItem));this.inherited(arguments)},focus:function(){this._getFocusItems();w.focus(this._firstFocusItem)},_endDrag:function(){var a=m.position(this.domNode),c=b.getBox(this.ownerDocument);a.y=Math.min(Math.max(a.y,0),c.h-a.h);a.x=Math.min(Math.max(a.x,0),c.w-a.w);this._relativePosition=a;this._position()},_setup:function(){var b=this.domNode;this.titleBar&&this.draggable?
(this._moveable=new (6==t("ie")?n:v)(b,{handle:this.titleBar}),a.after(this._moveable,"onMoveStop",r.hitch(this,"_endDrag"),!0)):q.add(b,"dijitDialogFixed");this.underlayAttrs={dialogId:this.id,"class":f.map(this["class"].split(/\s/),function(a){return a+"_underlay"}).join(" "),_onKeyDown:r.hitch(this,"_onKey"),ownerDocument:this.ownerDocument}},_size:function(){this.resize()},_position:function(){if(!q.contains(this.ownerDocumentBody,"dojoMove")){var a=this.domNode,c=b.getBox(this.ownerDocument),
d=this._relativePosition,e=m.position(a),f=Math.floor(c.l+(d?Math.min(d.x,c.w-e.w):(c.w-e.w)/2)),c=Math.floor(c.t+(d?Math.min(d.y,c.h-e.h):(c.h-e.h)/2));g.set(a,{left:f+"px",top:c+"px"})}},_onKey:function(a){if(a.keyCode==d.TAB){this._getFocusItems();var b=a.target;this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):b==this._firstFocusItem&&a.shiftKey?(w.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):b==this._lastFocusItem&&!a.shiftKey&&(w.focus(this._firstFocusItem),
a.stopPropagation(),a.preventDefault())}else this.closable&&a.keyCode==d.ESCAPE&&(this.onCancel(),a.stopPropagation(),a.preventDefault())},show:function(){if(this.open)return K.promise;this._started||this.startup();this._alreadyInitialized||(this._setup(),this._alreadyInitialized=!0);this._fadeOutDeferred&&(this._fadeOutDeferred.cancel(),O.hide(this));var a=b.get(this.ownerDocument);this._modalconnects.push(u(a,"scroll",r.hitch(this,"resize",null)));this._modalconnects.push(u(this.domNode,"keydown",
r.hitch(this,"_onKey")));g.set(this.domNode,{opacity:0,display:""});this._set("open",!0);this._onShow();this.resize();this._position();var c;this._fadeInDeferred=new k(r.hitch(this,function(){c.stop();delete this._fadeInDeferred}));this._fadeInDeferred.then(void 0,Q);a=this._fadeInDeferred.promise;c=e.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:r.hitch(this,function(){O.show(this,this.underlayAttrs)}),onEnd:r.hitch(this,function(){this.autofocus&&O.isTop(this)&&(this._getFocusItems(),
w.focus(this._firstFocusItem));this._fadeInDeferred.resolve(!0);delete this._fadeInDeferred})}).play();return a},hide:function(){if(!this._alreadyInitialized||!this.open)return K.promise;this._fadeInDeferred&&this._fadeInDeferred.cancel();var a;this._fadeOutDeferred=new k(r.hitch(this,function(){a.stop();delete this._fadeOutDeferred}));this._fadeOutDeferred.then(void 0,Q);this._fadeOutDeferred.then(r.hitch(this,"onHide"));var b=this._fadeOutDeferred.promise;a=e.fadeOut({node:this.domNode,duration:this.duration,
onEnd:r.hitch(this,function(){this.domNode.style.display="none";O.hide(this);this._fadeOutDeferred.resolve(!0);delete this._fadeOutDeferred})}).play();this._scrollConnected&&(this._scrollConnected=!1);for(var c;c=this._modalconnects.pop();)c.remove();this._relativePosition&&delete this._relativePosition;this._set("open",!1);return b},resize:function(a){if("none"!=this.domNode.style.display){this._checkIfSingleChild();if(!a){this._shrunk&&(this._singleChild&&"undefined"!=typeof this._singleChildOriginalStyle&&
(this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle,delete this._singleChildOriginalStyle),f.forEach([this.domNode,this.containerNode,this.titleBar,this.actionBarNode],function(a){a&&g.set(a,{position:"static",width:"auto",height:"auto"})}),this.domNode.style.position="absolute");var c=b.getBox(this.ownerDocument);c.w*=this.maxRatio;c.h*=this.maxRatio;var d=m.position(this.domNode);d.w>=c.w||d.h>=c.h?(a={w:Math.min(d.w,c.w),h:Math.min(d.h,c.h)},this._shrunk=!0):this._shrunk=!1}if(a){m.setMarginBox(this.domNode,
a);c=[];this.titleBar&&c.push({domNode:this.titleBar,region:"top"});this.actionBarNode&&c.push({domNode:this.actionBarNode,region:"bottom"});d={domNode:this.containerNode,region:"center"};c.push(d);var e=I.marginBox2contentBox(this.domNode,a);I.layoutChildren(this.domNode,e,c);this._singleChild?(c=I.marginBox2contentBox(this.containerNode,d),this._singleChild.resize({w:c.w,h:c.h})):(this.containerNode.style.overflow="auto",this._layoutChildren())}else this._layoutChildren();!t("touch")&&!a&&this._position()}},
_layoutChildren:function(){f.forEach(this.getChildren(),function(a){a.resize&&a.resize()})},destroy:function(){this._fadeInDeferred&&this._fadeInDeferred.cancel();this._fadeOutDeferred&&this._fadeOutDeferred.cancel();this._moveable&&this._moveable.destroy();for(var a;a=this._modalconnects.pop();)a.remove();O.hide(this);this.inherited(arguments)}});t("dojo-bidi")&&(x=l("dijit._DialogBase",x,{_setTitleAttr:function(a){this._set("title",a);this.titleNode.innerHTML=a;this.applyTextDir(this.titleNode)},
_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this.set("title",this.title))}}));var J=l("dijit.Dialog",[H,x],{});J._DialogBase=x;var O=J._DialogLevelManager={_beginZIndex:950,show:function(a,b){G[G.length-1].focus=w.curNode;var c=G[G.length-1].dialog?G[G.length-1].zIndex+2:J._DialogLevelManager._beginZIndex;g.set(a.domNode,"zIndex",c);E.show(b,c-1);G.push({dialog:a,underlayAttrs:b,zIndex:c})},hide:function(a){if(G[G.length-1].dialog==a){G.pop();var b=G[G.length-
1];1==G.length?E.hide():E.show(b.underlayAttrs,b.zIndex-1);if(a.refocus){a=b.focus;if(b.dialog&&(!a||!h.isDescendant(a,b.dialog.domNode)))b.dialog._getFocusItems(),a=b.dialog._firstFocusItem;if(a)try{a.focus()}catch(c){}}}else b=f.indexOf(f.map(G,function(a){return a.dialog}),a),-1!=b&&G.splice(b,1)},isTop:function(a){return G[G.length-1].dialog==a}},G=J._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];w.watch("curNode",function(a,b,c){a=G[G.length-1].dialog;if(c&&a&&!a._fadeOutDeferred&&
c.ownerDocument==a.ownerDocument){do if(c==a.domNode||q.contains(c,"dijitPopup"))return;while(c=c.parentNode);a.focus()}});t("dijit-legacy-requires")&&s(0,function(){p(["dijit/TooltipDialog"])});return J})},"dojo/dnd/Moveable":function(){define("../_base/array ../_base/declare ../_base/lang ../dom ../dom-class ../Evented ../on ../topic ../touch ./common ./Mover ../_base/window".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d){return f("dojo.dnd.Moveable",[h],{handle:"",delay:0,skip:!1,constructor:function(d,
e){this.node=l.byId(d);e||(e={});this.handle=e.handle?l.byId(e.handle):null;this.handle||(this.handle=this.node);this.delay=0<e.delay?e.delay:0;this.skip=e.skip;this.mover=e.mover?e.mover:c;this.events=[q(this.handle,g.press,a.hitch(this,"onMouseDown")),q(this.handle,"dragstart",a.hitch(this,"onSelectStart")),q(this.handle,"selectstart",a.hitch(this,"onSelectStart"))]},markupFactory:function(a,c,d){return new d(c,a)},destroy:function(){p.forEach(this.events,function(a){a.remove()});this.events=this.node=
this.handle=null},onMouseDown:function(c){if(!this.skip||!e.isFormElement(c)){if(this.delay)this.events.push(q(this.handle,g.move,a.hitch(this,"onMouseMove")),q(this.handle.ownerDocument,g.release,a.hitch(this,"onMouseUp"))),this._lastX=c.pageX,this._lastY=c.pageY;else this.onDragDetected(c);c.stopPropagation();c.preventDefault()}},onMouseMove:function(a){if(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)this.onMouseUp(a),this.onDragDetected(a);a.stopPropagation();
a.preventDefault()},onMouseUp:function(a){for(var c=0;2>c;++c)this.events.pop().remove();a.stopPropagation();a.preventDefault()},onSelectStart:function(a){if(!this.skip||!e.isFormElement(a))a.stopPropagation(),a.preventDefault()},onDragDetected:function(a){new this.mover(this.node,a,this)},onMoveStart:function(a){m.publish("/dnd/move/start",a);k.add(d.body(),"dojoMove");k.add(this.node,"dojoMoveItem")},onMoveStop:function(a){m.publish("/dnd/move/stop",a);k.remove(d.body(),"dojoMove");k.remove(this.node,
"dojoMoveItem")},onFirstMove:function(){},onMove:function(a,c){this.onMoving(a,c);var d=a.node.style;d.left=c.l+"px";d.top=c.t+"px";this.onMoved(a,c)},onMoving:function(){},onMoved:function(){}})})},"dojo/dnd/common":function(){define(["../sniff","../_base/kernel","../_base/lang","../dom"],function(p,f,a,l){var k=a.getObject("dojo.dnd",!0);k.getCopyKeyState=function(a){return a[p("mac")?"metaKey":"ctrlKey"]};k._uniqueId=0;k.getUniqueId=function(){var a;do a=f._scopeName+"Unique"+ ++k._uniqueId;while(l.byId(a));
return a};k._empty={};k.isFormElement=function(a){a=a.target;3==a.nodeType&&(a=a.parentNode);return 0<=" a button textarea input select option ".indexOf(" "+a.tagName.toLowerCase()+" ")};return k})},"dojo/dnd/Mover":function(){define("../_base/array ../_base/declare ../_base/lang ../sniff ../_base/window ../dom ../dom-geometry ../dom-style ../Evented ../on ../touch ./common ./autoscroll".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r){return f("dojo.dnd.Mover",[g],{constructor:function(d,f,g){function b(a){a.preventDefault();
a.stopPropagation()}this.node=h.byId(d);this.marginBox={l:f.pageX,t:f.pageY};this.mouseButton=f.button;f=this.host=g;d=d.ownerDocument;this.events=[e(d,c.move,a.hitch(this,"onFirstMove")),e(d,c.move,a.hitch(this,"onMouseMove")),e(d,c.release,a.hitch(this,"onMouseUp")),e(d,"dragstart",b),e(d.body,"selectstart",b)];r.autoScrollStart(d);if(f&&f.onMoveStart)f.onMoveStart(this)},onMouseMove:function(a){r.autoScroll(a);var c=this.marginBox;this.host.onMove(this,{l:c.l+a.pageX,t:c.t+a.pageY},a);a.preventDefault();
a.stopPropagation()},onMouseUp:function(a){(l("webkit")&&l("mac")&&2==this.mouseButton?0==a.button:this.mouseButton==a.button)&&this.destroy();a.preventDefault();a.stopPropagation()},onFirstMove:function(a){var c=this.node.style,d,b=this.host;switch(c.position){case "relative":case "absolute":d=Math.round(parseFloat(c.left))||0;c=Math.round(parseFloat(c.top))||0;break;default:c.position="absolute";c=q.getMarginBox(this.node);d=k.doc.body;var e=m.getComputedStyle(d),f=q.getMarginBox(d,e),e=q.getContentBox(d,
e);d=c.l-(e.l-f.l);c=c.t-(e.t-f.t)}this.marginBox.l=d-this.marginBox.l;this.marginBox.t=c-this.marginBox.t;if(b&&b.onFirstMove)b.onFirstMove(this,a);this.events.shift().remove()},destroy:function(){p.forEach(this.events,function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"dojo/dnd/autoscroll":function(){define("../_base/lang ../sniff ../_base/window ../dom-geometry ../dom-style ../window".split(" "),function(p,f,a,l,k,h){var q=
{};p.setObject("dojo.dnd.autoscroll",q);q.getViewport=h.getBox;q.V_TRIGGER_AUTOSCROLL=32;q.H_TRIGGER_AUTOSCROLL=32;q.V_AUTOSCROLL_VALUE=16;q.H_AUTOSCROLL_VALUE=16;var m,g=a.doc,e=Infinity,c=Infinity;q.autoScrollStart=function(d){g=d;m=h.getBox(g);d=a.body(g).parentNode;e=Math.max(d.scrollHeight-m.h,0);c=Math.max(d.scrollWidth-m.w,0)};q.autoScroll=function(d){var f=m||h.getBox(g),k=a.body(g).parentNode,l=0,t=0;d.clientX<q.H_TRIGGER_AUTOSCROLL?l=-q.H_AUTOSCROLL_VALUE:d.clientX>f.w-q.H_TRIGGER_AUTOSCROLL&&
(l=Math.min(q.H_AUTOSCROLL_VALUE,c-k.scrollLeft));d.clientY<q.V_TRIGGER_AUTOSCROLL?t=-q.V_AUTOSCROLL_VALUE:d.clientY>f.h-q.V_TRIGGER_AUTOSCROLL&&(t=Math.min(q.V_AUTOSCROLL_VALUE,e-k.scrollTop));window.scrollBy(l,t)};q._validNodes={div:1,p:1,td:1};q._validOverflow={auto:1,scroll:1};q.autoScrollNodes=function(c){for(var e,g,h,m,b,v,n=0,w=0,p=c.target;p;){if(1==p.nodeType&&p.tagName.toLowerCase()in q._validNodes){h=k.getComputedStyle(p);m=h.overflow.toLowerCase()in q._validOverflow;b=h.overflowX.toLowerCase()in
q._validOverflow;v=h.overflowY.toLowerCase()in q._validOverflow;if(m||b||v)e=l.getContentBox(p,h),g=l.position(p,!0);if(m||b){h=Math.min(q.H_TRIGGER_AUTOSCROLL,e.w/2);b=c.pageX-g.x;if(f("webkit")||f("opera"))b+=a.body().scrollLeft;n=0;0<b&&b<e.w&&(b<h?n=-h:b>e.w-h&&(n=h),p.scrollLeft+=n)}if(m||v){m=Math.min(q.V_TRIGGER_AUTOSCROLL,e.h/2);v=c.pageY-g.y;if(f("webkit")||f("opera"))v+=a.body().scrollTop;w=0;0<v&&v<e.h&&(v<m?w=-m:v>e.h-m&&(w=m),p.scrollTop+=w)}if(n||w)return}try{p=p.parentNode}catch(z){p=
null}}q.autoScroll(c)};return q})},"dojo/dnd/TimedMoveable":function(){define(["../_base/declare","./Moveable"],function(p,f){var a=f.prototype.onMove;return p("dojo.dnd.TimedMoveable",f,{timeout:40,constructor:function(a,f){f||(f={});f.timeout&&("number"==typeof f.timeout&&0<=f.timeout)&&(this.timeout=f.timeout)},onMoveStop:function(l){l._timer&&(clearTimeout(l._timer),a.call(this,l,l._leftTop));f.prototype.onMoveStop.apply(this,arguments)},onMove:function(f,k){f._leftTop=k;if(!f._timer){var h=this;
f._timer=setTimeout(function(){f._timer=null;a.call(h,f,f._leftTop)},this.timeout)}}})})},"dijit/_base/manager":function(){define(["dojo/_base/array","dojo/_base/config","dojo/_base/lang","../registry","../main"],function(p,f,a,l,k){var h={};p.forEach("byId getUniqueId findWidgets _destroyAll byNode getEnclosingWidget".split(" "),function(a){h[a]=l[a]});a.mixin(h,{defaultDuration:f.defaultDuration||200});a.mixin(k,h);return k})},"dijit/_CssStateMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-class dojo/has dojo/_base/lang dojo/on dojo/domReady dojo/touch dojo/_base/window ./a11yclick ./registry".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d){f=f("dijit._CssStateMixin",[],{hovering:!1,active:!1,_applyAttributes:function(){this.inherited(arguments);p.forEach("disabled readOnly checked selected focused state hovering active _opened".split(" "),function(a){this.watch(a,h.hitch(this,"_setStateClass"))},this);for(var a in this.cssStateNodes||{})this._trackMouseState(this[a],this.cssStateNodes[a]);this._trackMouseState(this.domNode,this.baseClass);this._setStateClass()},_cssMouseEvent:function(a){if(!this.disabled)switch(a.type){case "mouseover":case "MSPointerOver":case "pointerover":this._set("hovering",
!0);this._set("active",this._mouseDown);break;case "mouseout":case "MSPointerOut":case "pointerout":this._set("hovering",!1);this._set("active",!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":this._set("active",!0);break;case "mouseup":case "dojotouchend":case "MSPointerUp":case "pointerup":case "keyup":this._set("active",!1)}},_setStateClass:function(){function a(b){c=c.concat(p.map(c,function(a){return a+b}),"dijit"+b)}var c=this.baseClass.split(" ");
this.isLeftToRight()||a("Rtl");var d="mixed"==this.checked?"Mixed":this.checked?"Checked":"";this.checked&&a(d);this.state&&a(this.state);this.selected&&a("Selected");this._opened&&a("Opened");this.disabled?a("Disabled"):this.readOnly?a("ReadOnly"):this.active?a("Active"):this.hovering&&a("Hover");this.focused&&a("Focused");var d=this.stateNode||this.domNode,e={};p.forEach(d.className.split(" "),function(a){e[a]=!0});"_stateClasses"in this&&p.forEach(this._stateClasses,function(a){delete e[a]});p.forEach(c,
function(a){e[a]=!0});var b=[],f;for(f in e)b.push(f);d.className=b.join(" ");this._stateClasses=c},_subnodeCssMouseEvent:function(a,c,d){function e(b){l.toggle(a,c+"Active",b)}if(!this.disabled&&!this.readOnly)switch(d.type){case "mouseover":case "MSPointerOver":case "pointerover":l.toggle(a,c+"Hover",!0);break;case "mouseout":case "MSPointerOut":case "pointerout":l.toggle(a,c+"Hover",!1);e(!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":e(!0);
break;case "mouseup":case "MSPointerUp":case "pointerup":case "dojotouchend":case "keyup":e(!1);break;case "focus":case "focusin":l.toggle(a,c+"Focused",!0);break;case "blur":case "focusout":l.toggle(a,c+"Focused",!1)}},_trackMouseState:function(a,c){a._cssState=c}});m(function(){function f(c,b,e){if(!e||!a.isDescendant(e,b))for(;b&&b!=e;b=b.parentNode)if(b._cssState){var g=d.getEnclosingWidget(b);g&&(b==g.domNode?g._cssMouseEvent(c):g._subnodeCssMouseEvent(b,b._cssState,c))}}var h=e.body(),k;q(h,
g.over,function(a){f(a,a.target,a.relatedTarget)});q(h,g.out,function(a){f(a,a.target,a.relatedTarget)});q(h,c.press,function(a){k=a.target;f(a,k)});q(h,c.release,function(a){f(a,k);k=null});q(h,"focusin, focusout",function(a){var b=a.target;if(b._cssState&&!b.getAttribute("widgetId")){var c=d.getEnclosingWidget(b);c&&c._subnodeCssMouseEvent(b,b._cssState,a)}})});return f})},"dijit/form/_FormMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/on dojo/window".split(" "),
function(p,f,a,l,k,h){return f("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(a){var f=[];p.forEach(a||this.getChildren(),function(a){"value"in a?f.push(a):f=f.concat(this._getDescendantFormWidgets(a.getChildren()))},this);return f},reset:function(){p.forEach(this._getDescendantFormWidgets(),function(a){a.reset&&a.reset()})},validate:function(){var a=!1;return p.every(p.map(this._getDescendantFormWidgets(),function(f){f._hasBeenBlurred=!0;var g=f.disabled||!f.validate||
f.validate();!g&&!a&&(h.scrollIntoView(f.containerNode||f.domNode),f.focus(),a=!0);return g}),function(a){return a})},setValues:function(f){a.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",f)},_setValueAttr:function(a){var f={};p.forEach(this._getDescendantFormWidgets(),function(a){a.name&&(f[a.name]||(f[a.name]=[])).push(a)});for(var g in f)if(f.hasOwnProperty(g)){var e=f[g],c=l.getObject(g,!1,a);void 0!==c&&(c=[].concat(c),
"boolean"==typeof e[0].checked?p.forEach(e,function(a){a.set("value",-1!=p.indexOf(c,a._get("value")))}):e[0].multiple?e[0].set("value",c):p.forEach(e,function(a,e){a.set("value",c[e])}))}},getValues:function(){a.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},_getValueAttr:function(){var a={};p.forEach(this._getDescendantFormWidgets(),function(f){var g=f.name;if(g&&!f.disabled){var e=f.get("value");"boolean"==typeof f.checked?
/Radio/.test(f.declaredClass)?!1!==e?l.setObject(g,e,a):(e=l.getObject(g,!1,a),void 0===e&&l.setObject(g,null,a)):(f=l.getObject(g,!1,a),f||(f=[],l.setObject(g,f,a)),!1!==e&&f.push(e)):(f=l.getObject(g,!1,a),"undefined"!=typeof f?l.isArray(f)?f.push(e):l.setObject(g,[f,e],a):l.setObject(g,e,a))}});return a},isValid:function(){return""==this.state},onValidStateChange:function(){},_getState:function(){var a=p.map(this._descendants,function(a){return a.get("state")||""});return 0<=p.indexOf(a,"Error")?
"Error":0<=p.indexOf(a,"Incomplete")?"Incomplete":""},disconnectChildren:function(){},connectChildren:function(a){this._descendants=this._getDescendantFormWidgets();p.forEach(this._descendants,function(a){a._started||a.startup()});a||this._onChildChange()},_onChildChange:function(a){(!a||"state"==a||"disabled"==a)&&this._set("state",this._getState());if(!a||"value"==a||"disabled"==a||"checked"==a)this._onChangeDelayTimer&&this._onChangeDelayTimer.remove(),this._onChangeDelayTimer=this.defer(function(){delete this._onChangeDelayTimer;
this._set("value",this.get("value"))},10)},startup:function(){this.inherited(arguments);this._descendants=this._getDescendantFormWidgets();this.value=this.get("value");this.state=this._getState();var a=this;this.own(k(this.containerNode,"attrmodified-state, attrmodified-disabled, attrmodified-value, attrmodified-checked",function(f){f.target!=a.domNode&&a._onChildChange(f.type.replace("attrmodified-",""))}));this.watch("state",function(a,f,e){this.onValidStateChange(""==e)})},destroy:function(){this.inherited(arguments)}})})},
"dijit/_DialogMixin":function(){define(["dojo/_base/declare","./a11y"],function(p,f){return p("dijit._DialogMixin",null,{actionBarTemplate:"",execute:function(){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"))},_getFocusItems:function(){var a=f._getTabNavigable(this.domNode);this._firstFocusItem=a.lowest||a.first||this.closeButtonNode||this.domNode;this._lastFocusItem=a.last||a.highest||this._firstFocusItem}})})},"dijit/DialogUnderlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/dom-attr dojo/dom-style dojo/on dojo/window ./_Widget ./_TemplatedMixin ./BackgroundIframe ./Viewport ./main".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d){var r=p("dijit.DialogUnderlay",[m,g],{templateString:"\x3cdiv class\x3d'dijitDialogUnderlayWrapper'\x3e\x3cdiv class\x3d'dijitDialogUnderlay' tabIndex\x3d'-1' data-dojo-attach-point\x3d'node'\x3e\x3c/div\x3e\x3c/div\x3e",dialogId:"","class":"",_modalConnects:[],_setDialogIdAttr:function(a){l.set(this.node,"id",a+"_underlay");this._set("dialogId",a)},_setClassAttr:function(a){this.node.className="dijitDialogUnderlay "+a;this._set("class",a)},postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);
this.own(h(this.domNode,"keydown",f.hitch(this,"_onKeyDown")));this.inherited(arguments)},layout:function(){var a=this.node.style,c=this.domNode.style;c.display="none";var d=q.getBox(this.ownerDocument);c.top=d.t+"px";c.left=d.l+"px";a.width=d.w+"px";a.height=d.h+"px";c.display="block"},show:function(){this.domNode.style.display="block";this.open=!0;this.layout();this.bgIframe=new e(this.domNode);var a=q.get(this.ownerDocument);this._modalConnects=[c.on("resize",f.hitch(this,"layout")),h(a,"scroll",
f.hitch(this,"layout"))]},hide:function(){this.bgIframe.destroy();delete this.bgIframe;for(this.domNode.style.display="none";this._modalConnects.length;)this._modalConnects.pop().remove();this.open=!1},destroy:function(){for(;this._modalConnects.length;)this._modalConnects.pop().remove();this.inherited(arguments)},_onKeyDown:function(){}});r.show=function(a,c){var e=r._singleton;!e||e._destroyed?e=d._underlay=r._singleton=new r(a):a&&e.set(a);k.set(e.domNode,"zIndex",c);e.open||e.show()};r.hide=function(){var a=
r._singleton;a&&!a._destroyed&&a.hide()};return r})},"dijit/BackgroundIframe":function(){define("require ./main dojo/_base/config dojo/dom-construct dojo/dom-style dojo/_base/lang dojo/on dojo/sniff".split(" "),function(p,f,a,l,k,h,q,m){m.add("config-bgIframe",m("ie")&&!/IEMobile\/10\.0/.test(navigator.userAgent)||m("trident")&&/Windows NT 6.[01]/.test(navigator.userAgent));var g=new function(){var e=[];this.pop=function(){var c;e.length?(c=e.pop(),c.style.display=""):(9>m("ie")?(c="\x3ciframe src\x3d'"+
(a.dojoBlankHtmlUrl||p.toUrl("dojo/resources/blank.html")||'javascript:""')+"' role\x3d'presentation' style\x3d'position: absolute; left: 0px; top: 0px;z-index: -1; filter:Alpha(Opacity\x3d\"0\");'\x3e",c=document.createElement(c)):(c=l.create("iframe"),c.src='javascript:""',c.className="dijitBackgroundIframe",c.setAttribute("role","presentation"),k.set(c,"opacity",0.1)),c.tabIndex=-1);return c};this.push=function(a){a.style.display="none";e.push(a)}};f.BackgroundIframe=function(a){if(!a.id)throw Error("no id");
if(m("config-bgIframe")){var c=this.iframe=g.pop();a.appendChild(c);7>m("ie")||m("quirks")?(this.resize(a),this._conn=q(a,"resize",h.hitch(this,"resize",a))):k.set(c,{width:"100%",height:"100%"})}};h.extend(f.BackgroundIframe,{resize:function(a){this.iframe&&k.set(this.iframe,{width:a.offsetWidth+"px",height:a.offsetHeight+"px"})},destroy:function(){this._conn&&(this._conn.remove(),this._conn=null);this.iframe&&(this.iframe.parentNode.removeChild(this.iframe),g.push(this.iframe),delete this.iframe)}});
return f.BackgroundIframe})},"dijit/Viewport":function(){define(["dojo/Evented","dojo/on","dojo/domReady","dojo/sniff","dojo/window"],function(p,f,a,l,k){var h=new p,q;a(function(){var a=k.getBox();h._rlh=f(window,"resize",function(){var e=k.getBox();a.h==e.h&&a.w==e.w||(a=e,h.emit("resize"))});if(8==l("ie")){var g=screen.deviceXDPI;setInterval(function(){screen.deviceXDPI!=g&&(g=screen.deviceXDPI,h.emit("resize"))},500)}l("ios")&&(f(document,"focusin",function(a){q=a.target}),f(document,"focusout",
function(a){q=null}))});h.getEffectiveBox=function(a){a=k.getBox(a);var f=q&&q.tagName&&q.tagName.toLowerCase();if(l("ios")&&q&&!q.readOnly&&("textarea"==f||"input"==f&&/^(color|email|number|password|search|tel|text|url)$/.test(q.type)))a.h*=0==orientation||180==orientation?0.66:0.4,f=q.getBoundingClientRect(),a.h=Math.max(a.h,f.top+f.height);return a};return h})},"dijit/layout/ContentPane":function(){define("dojo/_base/kernel dojo/_base/lang ../_Widget ../_Container ./_ContentPaneResizeMixin dojo/string dojo/html dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-construct dojo/_base/xhr dojo/i18n dojo/when dojo/i18n!../nls/loading".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t){return g("dijit.layout.ContentPane",[a,l,k],{href:"",content:"",extractContent:!1,parseOnLoad:!0,parserScope:p._scopeName,preventCache:!1,preload:!1,refreshOnShow:!1,loadingMessage:"\x3cspan class\x3d'dijitContentPaneLoading'\x3e\x3cspan class\x3d'dijitInline dijitIconLoading'\x3e\x3c/span\x3e${loadingState}\x3c/span\x3e",errorMessage:"\x3cspan class\x3d'dijitContentPaneError'\x3e\x3cspan class\x3d'dijitInline dijitIconError'\x3e\x3c/span\x3e${errorState}\x3c/span\x3e",
isLoaded:!1,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:!0,template:!1,markupFactory:function(a,c,d){var e=new d(a,c);return!e.href&&e._contentSetter&&e._contentSetter.parseDeferred&&!e._contentSetter.parseDeferred.isFulfilled()?e._contentSetter.parseDeferred.then(function(){return e}):e},create:function(a,d){if((!a||!a.template)&&d&&!("href"in a)&&!("content"in a)){d=c.byId(d);for(var e=d.ownerDocument.createDocumentFragment();d.firstChild;)e.appendChild(d.firstChild);
a=f.delegate(a,{content:e})}this.inherited(arguments,[a,d])},postMixInProperties:function(){this.inherited(arguments);var a=s.getLocalization("dijit","loading",this.lang);this.loadingMessage=h.substitute(this.loadingMessage,a);this.errorMessage=h.substitute(this.errorMessage,a)},buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.domNode.removeAttribute("title")},startup:function(){this.inherited(arguments);this._contentSetter&&m.forEach(this._contentSetter.parseResults,
function(a){!a._started&&(!a._destroyed&&f.isFunction(a.startup))&&(a.startup(),a._started=!0)},this)},_startChildren:function(){m.forEach(this.getChildren(),function(a){!a._started&&(!a._destroyed&&f.isFunction(a.startup))&&(a.startup(),a._started=!0)});this._contentSetter&&m.forEach(this._contentSetter.parseResults,function(a){!a._started&&(!a._destroyed&&f.isFunction(a.startup))&&(a.startup(),a._started=!0)},this)},setHref:function(a){p.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.",
"","2.0");return this.set("href",a)},_setHrefAttr:function(a){this.cancel();this.onLoadDeferred=new e(f.hitch(this,"cancel"));this.onLoadDeferred.then(f.hitch(this,"onLoad"));this._set("href",a);this.preload||this._created&&this._isShown()?this._load():this._hrefChanged=!0;return this.onLoadDeferred},setContent:function(a){p.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",a)},_setContentAttr:function(a){this._set("href",
"");this.cancel();this.onLoadDeferred=new e(f.hitch(this,"cancel"));this._created&&this.onLoadDeferred.then(f.hitch(this,"onLoad"));this._setContent(a||"");this._isDownloaded=!1;return this.onLoadDeferred},_getContentAttr:function(){return this.containerNode.innerHTML},cancel:function(){this._xhrDfd&&-1==this._xhrDfd.fired&&this._xhrDfd.cancel();delete this._xhrDfd;this.onLoadDeferred=null},destroy:function(){this.cancel();this.inherited(arguments)},destroyRecursive:function(a){this._beingDestroyed||
this.inherited(arguments)},_onShow:function(){this.inherited(arguments);if(this.href&&!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow))return this.refresh()},refresh:function(){this.cancel();this.onLoadDeferred=new e(f.hitch(this,"cancel"));this.onLoadDeferred.then(f.hitch(this,"onLoad"));this._load();return this.onLoadDeferred},_load:function(){this._setContent(this.onDownloadStart(),!0);var a=this,c={preventCache:this.preventCache||this.refreshOnShow,url:this.href,handleAs:"text"};
f.isObject(this.ioArgs)&&f.mixin(c,this.ioArgs);var d=this._xhrDfd=(this.ioMethod||u.get)(c),e;d.then(function(c){e=c;try{return a._isDownloaded=!0,a._setContent(c,!1)}catch(d){a._onError("Content",d)}},function(c){d.canceled||a._onError("Download",c);delete a._xhrDfd;return c}).then(function(){a.onDownloadEnd();delete a._xhrDfd;return e});delete this._hrefChanged},_onLoadHandler:function(a){this._set("isLoaded",!0);try{this.onLoadDeferred.resolve(a)}catch(c){console.error("Error "+this.widgetId+
" running custom onLoad code: "+c.message)}},_onUnloadHandler:function(){this._set("isLoaded",!1);try{this.onUnload()}catch(a){console.error("Error "+this.widgetId+" running custom onUnload code: "+a.message)}},destroyDescendants:function(a){this.isLoaded&&this._onUnloadHandler();var c=this._contentSetter;m.forEach(this.getChildren(),function(c){c.destroyRecursive?c.destroyRecursive(a):c.destroy&&c.destroy(a);c._destroyed=!0});c&&(m.forEach(c.parseResults,function(c){c._destroyed||(c.destroyRecursive?
c.destroyRecursive(a):c.destroy&&c.destroy(a),c._destroyed=!0)}),delete c.parseResults);a||r.empty(this.containerNode);delete this._singleChild},_setContent:function(a,c){a=this.preprocessContent(a);this.destroyDescendants();var d=this._contentSetter;d&&d instanceof q._ContentSetter||(d=this._contentSetter=new q._ContentSetter({node:this.containerNode,_onError:f.hitch(this,this._onError),onContentError:f.hitch(this,function(a){a=this.onContentError(a);try{this.containerNode.innerHTML=a}catch(b){console.error("Fatal "+
this.id+" could not change content due to "+b.message,b)}})}));var e=f.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!a.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:!1,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{}),e=d.set(f.isObject(a)&&a.domNode?a.domNode:a,e),g=this;return t(e&&e.then?e:d.parseDeferred,function(){delete g._contentSetterParams;c||(g._started&&(g._startChildren(),g._scheduleLayout()),g._onLoadHandler(a))})},
preprocessContent:function(a){return a},_onError:function(a,c,d){this.onLoadDeferred.reject(c);a=this["on"+a+"Error"].call(this,c);d?console.error(d,c):a&&this._setContent(a,!0)},onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage},onContentError:function(){},onDownloadError:function(){return this.errorMessage},onDownloadEnd:function(){}})})},"dijit/_Container":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/_base/kernel"],
function(p,f,a,l){return f("dijit._Container",null,{buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode)},addChild:function(f,h){var l=this.containerNode;if(0<h){for(l=l.firstChild;0<h;)1==l.nodeType&&h--,l=l.nextSibling;l?h="before":(l=this.containerNode,h="last")}a.place(f.domNode,l,h);this._started&&!f._started&&f.startup()},removeChild:function(a){"number"==typeof a&&(a=this.getChildren()[a]);a&&(a=a.domNode)&&a.parentNode&&a.parentNode.removeChild(a)},
hasChildren:function(){return 0<this.getChildren().length},_getSiblingOfChild:function(a,f){var l=this.getChildren(),m=p.indexOf(l,a);return l[m+f]},getIndexOfChild:function(a){return p.indexOf(this.getChildren(),a)}})})},"dijit/layout/_ContentPaneResizeMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/query ../registry ../Viewport ./utils".split(" "),function(p,f,a,l,k,h,q,m,g,e){return f("dijit.layout._ContentPaneResizeMixin",
null,{doLayout:!0,isLayoutContainer:!0,startup:function(){if(!this._started){var a=this.getParent();this._childOfLayoutWidget=a&&a.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);this._isShown()&&this._onShow();this._childOfLayoutWidget||this.own(g.on("resize",h.hitch(this,"resize")))}},_checkIfSingleChild:function(){if(this.doLayout){var c=[],d=!1;q("\x3e *",this.containerNode).some(function(a){var e=m.byNode(a);e&&e.resize?c.push(e):!/script|link|style/i.test(a.nodeName)&&
a.offsetHeight&&(d=!0)});this._singleChild=1==c.length&&!d?c[0]:null;a.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild)}},resize:function(a,d){this._resizeCalled=!0;this._scheduleLayout(a,d)},_scheduleLayout:function(a,d){this._isShown()?this._layout(a,d):(this._needLayout=!0,this._changeSize=a,this._resultSize=d)},_layout:function(a,d){delete this._needLayout;!this._wasShown&&!1!==this.open&&this._onShow();a&&l.setMarginBox(this.domNode,a);var f=this.containerNode;if(f===
this.domNode){var g=d||{};h.mixin(g,a||{});if(!("h"in g)||!("w"in g))g=h.mixin(l.getMarginBox(f),g);this._contentBox=e.marginBox2contentBox(f,g)}else this._contentBox=l.getContentBox(f);this._layoutChildren()},_layoutChildren:function(){this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){var a=this._contentBox||l.getContentBox(this.containerNode);this._singleChild.resize({w:a.w,h:a.h})}else for(var a=this.getChildren(),d,e=0;d=a[e++];)d.resize&&d.resize()},_isShown:function(){if(this._childOfLayoutWidget)return this._resizeCalled&&
"open"in this?this.open:this._resizeCalled;if("open"in this)return this.open;var c=this.domNode,d=this.domNode.parentNode;return"none"!=c.style.display&&"hidden"!=c.style.visibility&&!a.contains(c,"dijitHidden")&&d&&d.style&&"none"!=d.style.display},_onShow:function(){this._wasShown=!0;this._needLayout&&this._layout(this._changeSize,this._resultSize);this.inherited(arguments)}})})},"dijit/layout/utils":function(){define(["dojo/_base/array","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang"],
function(p,f,a,l,k){function h(f,g){var e=f.resize?f.resize(g):a.setMarginBox(f.domNode,g);e?k.mixin(f,e):(k.mixin(f,a.getMarginBox(f.domNode)),k.mixin(f,g))}var q={marginBox2contentBox:function(f,g){var e=l.getComputedStyle(f),c=a.getMarginExtents(f,e),d=a.getPadBorderExtents(f,e);return{l:l.toPixelValue(f,e.paddingLeft),t:l.toPixelValue(f,e.paddingTop),w:g.w-(c.w+d.w),h:g.h-(c.h+d.h)}},layoutChildren:function(a,g,e,c,d){g=k.mixin({},g);f.add(a,"dijitLayoutContainer");e=p.filter(e,function(a){return"center"!=
a.region&&"client"!=a.layoutAlign}).concat(p.filter(e,function(a){return"center"==a.region||"client"==a.layoutAlign}));p.forEach(e,function(a){var e=a.domNode,k=a.region||a.layoutAlign;if(!k)throw Error("No region setting for "+a.id);var l=e.style;l.left=g.l+"px";l.top=g.t+"px";l.position="absolute";f.add(e,"dijitAlign"+(k.substring(0,1).toUpperCase()+k.substring(1)));e={};c&&c==a.id&&(e["top"==a.region||"bottom"==a.region?"h":"w"]=d);"leading"==k&&(k=a.isLeftToRight()?"left":"right");"trailing"==
k&&(k=a.isLeftToRight()?"right":"left");"top"==k||"bottom"==k?(e.w=g.w,h(a,e),g.h-=a.h,"top"==k?g.t+=a.h:l.top=g.t+g.h+"px"):"left"==k||"right"==k?(e.h=g.h,h(a,e),g.w-=a.w,"left"==k?g.l+=a.w:l.left=g.l+g.w+"px"):("client"==k||"center"==k)&&h(a,g)})}};k.setObject("dijit.layout.utils",q);return q})},"dojo/html":function(){define("./_base/kernel ./_base/lang ./_base/array ./_base/declare ./dom ./dom-construct ./parser".split(" "),function(p,f,a,l,k,h,q){var m=0,g={_secureForInnerHtml:function(a){return a.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,
"")},_emptyNode:h.empty,_setNodeContent:function(a,c){h.empty(a);if(c)if("number"==typeof c&&(c=c.toString()),"string"==typeof c&&(c=h.toDom(c,a.ownerDocument)),!c.nodeType&&f.isArrayLike(c))for(var d=c.length,g=0;g<c.length;g=d==c.length?g+1:0)h.place(c[g],a,"last");else h.place(c,a,"last");return a},_ContentSetter:l("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:!1,extractContent:!1,parseContent:!1,parserScope:p._scopeName,startup:!0,constructor:function(a,c){f.mixin(this,
a||{});c=this.node=k.byId(this.node||c);this.id||(this.id=["Setter",c?c.id||c.tagName:"",m++].join("_"))},set:function(a,c){void 0!==a&&(this.content=a);c&&this._mixin(c);this.onBegin();this.setContent();var d=this.onEnd();return d&&d.then?d:this.node},setContent:function(){var a=this.node;if(!a)throw Error(this.declaredClass+": setContent given no node");try{a=g._setNodeContent(a,this.content)}catch(c){var d=this.onContentError(c);try{a.innerHTML=d}catch(f){console.error("Fatal "+this.declaredClass+
".setContent could not change content due to "+f.message,f)}}this.node=a},empty:function(){this.parseDeferred&&(this.parseDeferred.isResolved()||this.parseDeferred.cancel(),delete this.parseDeferred);this.parseResults&&this.parseResults.length&&(a.forEach(this.parseResults,function(a){a.destroy&&a.destroy()}),delete this.parseResults);h.empty(this.node)},onBegin:function(){var a=this.content;if(f.isString(a)&&(this.cleanContent&&(a=g._secureForInnerHtml(a)),this.extractContent)){var c=a.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);
c&&(a=c[1])}this.empty();this.content=a;return this.node},onEnd:function(){this.parseContent&&this._parse();return this.node},tearDown:function(){delete this.parseResults;delete this.parseDeferred;delete this.node;delete this.content},onContentError:function(a){return"Error occurred setting content: "+a},onExecError:function(a){return"Error occurred executing scripts: "+a},_mixin:function(a){var c={},d;for(d in a)d in c||(this[d]=a[d])},_parse:function(){var e=this.node;try{var c={};a.forEach(["dir",
"lang","textDir"],function(a){this[a]&&(c[a]=this[a])},this);var d=this;this.parseDeferred=q.parse({rootNode:e,noStart:!this.startup,inherited:c,scope:this.parserScope}).then(function(a){return d.parseResults=a},function(a){d._onError("Content",a,"Error parsing in _ContentSetter#"+this.id)})}catch(f){this._onError("Content",f,"Error parsing in _ContentSetter#"+this.id)}},_onError:function(a,c,d){a=this["on"+a+"Error"].call(this,c);d?console.error(d,c):a&&g._setNodeContent(this.node,a,!0)}}),set:function(a,
c,d){void 0==c&&(console.warn("dojo.html.set: no cont argument provided, using empty string"),c="");"number"==typeof c&&(c=c.toString());return d?(new g._ContentSetter(f.mixin(d,{content:c,node:a}))).set():g._setNodeContent(a,c,!0)}};f.setObject("dojo.html",g);return g})},"esri/Credential":function(){define(["dojo/_base/declare","dojo/has","./kernel","./IdentityManagerBase"],function(p,f,a,l){return p(l.Credential,{})})},"esri/IdentityManagerBase":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/sniff dojo/cookie dojo/io-query dojo/regexp ./kernel ./config ./lang ./ServerInfo ./urlUtils ./deferredUtils ./request ./Evented ./OAuthCredential ./arcgis/OAuthInfo".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x){var z={},y=function(a){var b=(new q(a.owningSystemUrl)).host;a=(new q(a.server)).host;var c=/.+\.arcgis\.com$/i;return c.test(b)&&c.test(a)},A=function(a,b){return!(!y(a)||!b||!l.some(b,function(b){return b.test(a.server)}))},B,F=p(n,{declaredClass:"esri.IdentityManagerBase",constructor:function(){this._portalConfig=a.getObject("esriGeowConfig");this.serverInfos=[];this.oAuthInfos=[];this.credentials=[];this._soReqs=[];this._xoReqs=[];this._portals=
[];this._getOAuthHash()},defaultTokenValidity:60,tokenValidity:null,signInPage:null,useSignInPage:!0,normalizeWebTierAuth:!1,_busy:null,_oAuthHash:null,_gwTokenUrl:"/sharing/generateToken",_agsRest:"/rest/services",_agsPortal:/\/sharing(\/|$)/i,_agsAdmin:/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i,_adminSvcs:/\/admin\/services(\/|$)/i,_agolSuffix:".arcgis.com",_gwDomains:[{regex:/https?:\/\/www\.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/dev\.arcgis\.com/i,
tokenServiceUrl:"https://dev.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*dev[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://devext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*qa[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://qaext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"}],_legacyFed:[],_regexSDirUrl:/http.+\/rest\/services\/?/ig,_regexServerType:/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|GeoenrichmentServer|VectorTileServer)).*/ig,
_gwUser:/http.+\/users\/([^\/]+)\/?.*/i,_gwItem:/http.+\/items\/([^\/]+)\/?.*/i,_gwGroup:/http.+\/groups\/([^\/]+)\/?.*/i,_errorCodes:[499,498,403,401],_rePortalTokenSvc:/\/sharing(\/rest)?\/generatetoken/i,_publicUrls:[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],registerServers:function(a){var b=this.serverInfos;b?(a=l.filter(a,function(a){return!this.findServerInfo(a.server)},this),this.serverInfos=b.concat(a)):this.serverInfos=a;l.forEach(a,function(a){a.owningSystemUrl&&
this._portals.push(a.owningSystemUrl);if(a.hasPortal){this._portals.push(a.server);var b=r.defaults.io.corsEnabledServers,c=this._getOrigin(a.tokenServiceUrl);t.canUseXhr(a.server)||b.push(a.server.replace(/^https?:\/\//i,""));t.canUseXhr(c)||b.push(c.replace(/^https?:\/\//i,""))}},this)},registerOAuthInfos:function(a){var b=this.oAuthInfos;b?(a=l.filter(a,function(a){return!this.findOAuthInfo(a.portalUrl)},this),this.oAuthInfos=b.concat(a)):this.oAuthInfos=a},registerToken:function(b){var c=this._sanitizeUrl(b.server),
d=this.findServerInfo(c),e=!0,f;d||(d=new s,d.server=this._getServerInstanceRoot(c),d.tokenServiceUrl=this._getTokenSvcUrl(c),d.hasPortal=!0,this.registerServers([d]));(f=this.findCredential(c,b.userId))?(a.mixin(f,b),e=!1):(f=new B({userId:b.userId,server:d.server,token:b.token,expires:b.expires,ssl:b.ssl,scope:this._isServerRsrc(c)?"server":"portal"}),f.resources=[c],this.credentials.push(f));f.onTokenChange(!1);e||f.refreshServerTokens()},toJson:function(){return u.fixJson({serverInfos:l.map(this.serverInfos,
function(a){return a.toJson()}),oAuthInfos:l.map(this.oAuthInfos,function(a){return a.toJson()}),credentials:l.map(this.credentials,function(a){return a.toJson()})})},initialize:function(b){if(b){a.isString(b)&&(b=h.fromJson(b));var c=b.serverInfos,d=b.oAuthInfos;b=b.credentials;if(c){var e=[];l.forEach(c,function(a){a.server&&a.tokenServiceUrl&&e.push(a.declaredClass?a:new s(a))});e.length&&this.registerServers(e)}if(d){var f=[];l.forEach(d,function(a){a.appId&&f.push(a.declaredClass?a:new x(a))});
f.length&&this.registerOAuthInfos(f)}b&&l.forEach(b,function(a){a.userId&&(a.server&&a.token&&a.expires&&a.expires>(new Date).getTime())&&(a=a.declaredClass?a:new B(a),a.onTokenChange(),this.credentials.push(a))},this)}},findServerInfo:function(a){var b;a=this._sanitizeUrl(a);l.some(this.serverInfos,function(c){this._hasSameServerInstance(c.server,a)&&(b=c);return!!b},this);return b},findOAuthInfo:function(a){var b;a=this._sanitizeUrl(a);l.some(this.oAuthInfos,function(c){this._hasSameServerInstance(c.portalUrl,
a)&&(b=c);return!!b},this);return b},findCredential:function(a,b){var c,d;a=this._sanitizeUrl(a);d=this._isServerRsrc(a)?"server":"portal";b?l.some(this.credentials,function(e){this._hasSameServerInstance(e.server,a)&&(b===e.userId&&e.scope===d)&&(c=e);return!!c},this):l.some(this.credentials,function(b){this._hasSameServerInstance(b.server,a)&&(-1!==this._getIdenticalSvcIdx(a,b)&&b.scope===d)&&(c=b);return!!c},this);return c},getCredential:function(c,d){var e,g,n=!0;u.isDefined(d)&&(a.isObject(d)?
(e=!!d.token,g=d.error,n=!1!==d.prompt):e=d);c=this._sanitizeUrl(c);var h=new k(b._dfdCanceller),r=this._isAdminResource(c),l=e&&this._doPortalSignIn(c)?this._getEsriAuthCookie():null;e=e?this.findCredential(c):null;if(l||e)return n=Error("You are currently signed in as: '"+(l&&l.email||e&&e.userId)+"'. You do not have access to this resource: "+c),n.code="IdentityManagerBase.1",n.httpCode=g&&g.httpCode,n.messageCode=g?g.messageCode:null,n.subcode=g?g.subcode:null,n.details=g?g.details:null,n.log=
f.isDebug,h.errback(n),h;if(g=this._findCredential(c,d))return h.callback(g),h;if(g=this.findServerInfo(c))!g.hasServer&&this._isServerRsrc(c)&&(g._restInfoDfd=this._getTokenSvcUrl(c,!0),g.hasServer=!0);else{l=this._getTokenSvcUrl(c);if(!l)return n=Error("Unknown resource - could not find token service endpoint."),n.code="IdentityManagerBase.2",n.log=f.isDebug,h.errback(n),h;g=new s;g.server=this._getServerInstanceRoot(c);a.isString(l)?(g.tokenServiceUrl=l,n&&!this._findOAuthInfo(c)&&(g._selfDfd=
this._getPortalSelf(l.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),c)),g.hasPortal=!0):(g._restInfoDfd=l,g.hasServer=!0);this.registerServers([g])}return this._enqueue(c,g,d,h,r)},getResourceName:function(a){return this._isRESTService(a)?a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(a)&&a.replace(this._gwUser,"$1")||this._gwItem.test(a)&&a.replace(this._gwItem,"$1")||this._gwGroup.test(a)&&a.replace(this._gwGroup,"$1")||""},generateToken:function(b,
c,e){var g,n,h,k,r,l,s=this._rePortalTokenSvc.test(b.tokenServiceUrl),m=new q(window.location.href.toLowerCase()),u=this._getEsriAuthCookie(),w,p=!c;k=b.shortLivedTokenValidity;var x;c&&(x=d.id.tokenValidity||k||d.id.defaultTokenValidity,x>k&&(x=k));e&&(g=e.isAdmin,n=e.serverUrl,h=e.token,l=e.ssl,b.customParameters=e.customParameters);if(g)k=b.adminTokenServiceUrl;else{k=b.tokenServiceUrl;r=new q(k.toLowerCase());u&&(w=(w=u.auth_tier)&&w.toLowerCase());if(("web"===w||b.webTierAuth)&&e&&e.serverUrl&&
!l&&"http"===m.scheme&&(t.hasSameOrigin(m.uri,k,!0)||"https"===r.scheme&&m.host===r.host&&"7080"===m.port&&"7443"===r.port))k=k.replace(/^https:/i,"http:").replace(/:7443/i,":7080");p&&s&&(k=k.replace(/\/rest/i,""))}g=a.mixin({url:k,content:a.mixin({request:"getToken",username:c&&c.username,password:c&&c.password,serverUrl:n,token:h,expiration:x,referer:g||s?window.location.host:null,client:g?"referer":null,f:"json"},b.customParameters),handleAs:"json",callbackParamName:p?"callback":void 0},e&&e.ioArgs);
e={usePost:!p,disableIdentityLookup:!0,useProxy:this._useProxy(b,e)};s||(g.withCredentials=!1);s=v(g,e);s.addCallback(function(a){if(!a||!a.token)return a=Error("Unable to generate token"),a.code="IdentityManagerBase.3",a.log=f.isDebug,a;var d=b.server;z[d]||(z[d]={});c&&(z[d][c.username]=c.password);a.validity=x;return a});s.addErrback(function(a){});return s},isBusy:function(){return!!this._busy},checkSignInStatus:function(a){return this.getCredential(a,{prompt:!1})},setRedirectionHandler:function(a){this._redirectFunc=
a},setProtocolErrorHandler:function(a){this._protocolFunc=a},signIn:function(){},oAuthSignIn:function(){},onCredentialCreate:function(){},onCredentialsDestroy:function(){},destroyCredentials:function(){if(this.credentials){var a=this.credentials.slice();l.forEach(a,function(a){a.destroy()})}this.onCredentialsDestroy()},_getOAuthHash:function(){var a=window.location.hash;if(a){"#"===a.charAt(0)&&(a=a.substring(1));var a=e.queryToObject(a),b=!1;a.access_token&&a.expires_in&&a.state&&a.hasOwnProperty("username")?
(a.state=h.fromJson(a.state),this._oAuthHash=a,b=!0):a.error&&a.error_description&&(console.log("IdentityManager OAuth Error: ",a.error," - ",a.error_description),"access_denied"===a.error&&(b=!0));if(b&&(!m("ie")||8<m("ie")))window.location.hash=""}},_findCredential:function(a,b){var c=-1,d,e,f,g,n=b&&b.token;d=b&&b.resource;var h=this._isServerRsrc(a)?"server":"portal",k=l.filter(this.credentials,function(b){return this._hasSameServerInstance(b.server,a)&&b.scope===h},this);a=d||a;if(k.length)if(1===
k.length)if(d=k[0],f=(e=(g=this.findServerInfo(d.server))&&g.owningSystemUrl)&&this.findCredential(e,d.userId),c=this._getIdenticalSvcIdx(a,d),n)-1!==c&&(d.resources.splice(c,1),this._removeResource(a,f));else return-1===c&&d.resources.push(a),this._addResource(a,f),d;else{var r,s;l.some(k,function(b){s=this._getIdenticalSvcIdx(a,b);return-1!==s?(r=b,f=(e=(g=this.findServerInfo(r.server))&&g.owningSystemUrl)&&this.findCredential(e,r.userId),c=s,!0):!1},this);if(n)r&&(r.resources.splice(c,1),this._removeResource(a,
f));else if(r)return this._addResource(a,f),r}},_findOAuthInfo:function(a){var b=this.findOAuthInfo(a);b||l.some(this.oAuthInfos,function(c){this._isIdProvider(c.portalUrl,a)&&(b=c);return!!b},this);return b},_addResource:function(a,b){b&&-1===this._getIdenticalSvcIdx(a,b)&&b.resources.push(a)},_removeResource:function(a,b){var c=-1;b&&(c=this._getIdenticalSvcIdx(a,b),-1<c&&b.resources.splice(c,1))},_useProxy:function(a,b){return b&&b.isAdmin&&!t.hasSameOrigin(a.adminTokenServiceUrl,window.location.href)||
!this._isPortalDomain(a.tokenServiceUrl)&&10.1==a.currentVersion&&!t.hasSameOrigin(a.tokenServiceUrl,window.location.href)},_getOrigin:function(a){a=new q(a);return a.scheme+"://"+a.host+(u.isDefined(a.port)?":"+a.port:"")},_getServerInstanceRoot:function(a){var b=a.toLowerCase(),c=b.indexOf(this._agsRest);-1===c&&this._isAdminResource(a)&&(c=b.indexOf("/admin"));-1===c&&(c=b.indexOf("/sharing"));-1===c&&"/"===b.substr(-1)&&(c=b.length-1);return-1<c?a.substring(0,c):a},_hasSameServerInstance:function(a,
b){a=a.toLowerCase();b=this._getServerInstanceRoot(b).toLowerCase();a=a.substr(a.indexOf(":"));b=b.substr(b.indexOf(":"));return a===b},_sanitizeUrl:function(b){b=t.fixUrl(a.trim(b));var c=(r.defaults.io.proxyUrl||"").toLowerCase(),d=c?b.toLowerCase().indexOf(c+"?"):-1;-1!==d&&(b=b.substring(d+c.length+1));return t.urlToObject(b).path},_isRESTService:function(a){return-1<a.indexOf(this._agsRest)},_isAdminResource:function(a){return this._agsAdmin.test(a)||this._adminSvcs.test(a)},_isServerRsrc:function(a){return this._isRESTService(a)||
this._isAdminResource(a)},_isIdenticalService:function(a,b){var c;if(this._isRESTService(a)&&this._isRESTService(b)){var d=this._getSuffix(a).toLowerCase(),e=this._getSuffix(b).toLowerCase();c=d===e;c||(c=/(.*)\/(MapServer|FeatureServer).*/ig,c=d.replace(c,"$1")===e.replace(c,"$1"))}else this._isAdminResource(a)&&this._isAdminResource(b)?c=!0:!this._isServerRsrc(a)&&(!this._isServerRsrc(b)&&this._isPortalDomain(a))&&(c=!0);return c},_isPortalDomain:function(b){b=b.toLowerCase();var c=(new q(b)).authority,
d=this._portalConfig,e=-1!==c.indexOf(this._agolSuffix);!e&&d&&(e=this._hasSameServerInstance(this._getServerInstanceRoot(d.restBaseUrl),b));if(!e){if(!this._arcgisUrl&&(d=a.getObject("esri.arcgis.utils.arcgisUrl")))this._arcgisUrl=(new q(d)).authority;this._arcgisUrl&&(e=this._arcgisUrl.toLowerCase()===c)}e||(e=l.some(this._portals,function(a){return this._hasSameServerInstance(a,b)},this));return e=e||this._agsPortal.test(b)},_isIdProvider:function(a,b){var c=-1,d=-1;l.forEach(this._gwDomains,function(e,
f){-1===c&&e.regex.test(a)&&(c=f);-1===d&&e.regex.test(b)&&(d=f)});var e=!1;if(-1<c&&-1<d)if(0===c||4===c){if(0===d||4===d)e=!0}else if(1===c){if(1===d||2===d)e=!0}else 2===c?2===d&&(e=!0):3===c&&3===d&&(e=!0);if(!e){var f=this.findServerInfo(b),g=f&&f.owningSystemUrl;g&&(y(f)&&this._isPortalDomain(g)&&this._isIdProvider(a,g))&&(e=!0)}return e},_isPublic:function(a){a=this._sanitizeUrl(a);return l.some(this._publicUrls,function(b){return b.test(a)})},_getIdenticalSvcIdx:function(a,b){var c=-1;l.some(b.resources,
function(b,d){return this._isIdenticalService(a,b)?(c=d,!0):!1},this);return c},_getSuffix:function(a){return a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")},_getTokenSvcUrl:function(a){var b,c;if((b=this._isRESTService(a))||this._isAdminResource(a))return c=a.toLowerCase().indexOf(b?this._agsRest:"/admin/"),b=a.substring(0,c)+"/admin/generateToken",a=a.substring(0,c)+"/rest/info",c=v({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),c.adminUrl_=b,c;if(this._isPortalDomain(a)){var d=
"";l.some(this._gwDomains,function(b){b.regex.test(a)&&(d=b.tokenServiceUrl);return!!d});d||l.some(this._portals,function(b){this._hasSameServerInstance(b,a)&&(d=b+this._gwTokenUrl);return!!d},this);d||(c=a.toLowerCase().indexOf("/sharing"),-1!==c&&(d=a.substring(0,c)+this._gwTokenUrl));d||(d=this._getOrigin(a)+this._gwTokenUrl);d&&(b=(new q(a)).port,/^http:\/\//i.test(a)&&"7080"===b&&(d=d.replace(/:7080/i,":7443")),d=d.replace(/http:/i,"https:"));return d}if(-1!==a.toLowerCase().indexOf("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"},
_getPortalSelf:function(a,b){"https:"===window.location.protocol?a=a.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(b)&&(a=a.replace(/^https:/i,"http:").replace(/:7443/i,":7080"));return v({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{crossOrigin:!1,disableIdentityLookup:!0})},_hasPortalSession:function(){return!!this._getEsriAuthCookie()},_getEsriAuthCookie:function(){var a;if(g.isSupported()){var b=this._getAllCookies("esri_auth"),c;for(c=0;c<b.length;c++){var d=
h.fromJson(b[c]);if(d.portalApp){a=d;break}}}return a},_getAllCookies:function(a){var b=[],d=document.cookie.match(RegExp("(?:^|; )"+c.escapeString(a)+"\x3d([^;]*)","g"));if(d)for(a=0;a<d.length;a++){var e=d[a],f=e.indexOf("\x3d");-1<f&&(e=e.substring(f+1),b.push(decodeURIComponent(e)))}return b},_doPortalSignIn:function(a){if(g.isSupported()){var b=this._getEsriAuthCookie(),c=this._portalConfig,d=window.location.href,e=this.findServerInfo(a);if(this.useSignInPage&&(c||this._isPortalDomain(d)||b)&&
(e?e.hasPortal||e.owningSystemUrl&&this._isPortalDomain(e.owningSystemUrl):this._isPortalDomain(a))&&(this._isIdProvider(d,a)||c&&(this._hasSameServerInstance(this._getServerInstanceRoot(c.restBaseUrl),a)||this._isIdProvider(c.restBaseUrl,a))||t.hasSameOrigin(d,a,!0)))return!0}return!1},_checkProtocol:function(b,c,d,e){var g=!0;e=e?c.adminTokenServiceUrl:c.tokenServiceUrl;if(0===a.trim(e).toLowerCase().indexOf("https:")&&0!==window.location.href.toLowerCase().indexOf("https:")&&(!r.defaults.io.useCors||
!t.canUseXhr(e)&&!t.canUseXhr(t.getProxyUrl(!0).path)))g=this._protocolFunc?!!this._protocolFunc({resourceUrl:b,serverInfo:c}):!1,g||(b=Error("Aborted the Sign-In process to avoid sending password over insecure connection."),b.code="IdentityManagerBase.4",b.log=f.isDebug,console.log(b.message),d(b));return g},_enqueue:function(a,c,d,e,f,g){e||(e=new k(b._dfdCanceller));e.resUrl_=a;e.sinfo_=c;e.options_=d;e.admin_=f;e.refresh_=g;this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(a),
this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(e)):this._xoReqs.push(e):this._doSignIn(e);return e},_doSignIn:function(b){this._busy=b;var c=this,d=function(a){var d=b.options_&&b.options_.resource,e=b.resUrl_,f=b.refresh_,g=!1;-1===l.indexOf(c.credentials,a)&&(f&&-1!==l.indexOf(c.credentials,f)?(f.userId=a.userId,f.token=a.token,f.expires=a.expires,f.validity=a.validity,f.ssl=a.ssl,f.creationTime=a.creationTime,g=!0,a=f):c.credentials.push(a));
a.resources||(a.resources=[]);a.resources.push(d||e);a.scope=c._isServerRsrc(e)?"server":"portal";a.onTokenChange();var d=c._soReqs,n={};c._soReqs=[];l.forEach(d,function(b){if(!this._isIdenticalService(e,b.resUrl_)){var c=this._getSuffix(b.resUrl_);n[c]||(n[c]=!0,a.resources.push(b.resUrl_))}},c);b.callback(a);l.forEach(d,function(b){b.callback(a)});c._busy=b.resUrl_=b.sinfo_=b.refresh_=null;if(!g)c.onCredentialCreate({credential:a});c._soReqs.length&&c._doSignIn(c._soReqs.shift());c._xoReqs.length&&
c._doSignIn(c._xoReqs.shift())},e=function(a){b.errback(a);c._busy=b.resUrl_=b.sinfo_=b.refresh_=null;c._soReqs.length&&c._doSignIn(c._soReqs.shift());c._xoReqs.length&&c._doSignIn(c._xoReqs.shift())},g=function(a,g,n,h){var k=b.sinfo_,r=!b.options_||!1!==b.options_.prompt;c._doPortalSignIn(b.resUrl_)?(g=c._getEsriAuthCookie(),a=c._portalConfig,g?d(new B({userId:g.email,server:k.server,token:g.token,expires:null})):r?(r="",g=window.location.href,r=c.signInPage?c.signInPage:a?a.baseUrl+a.signin:c._isIdProvider(g,
b.resUrl_)?c._getOrigin(g)+"/home/signin.html":k.tokenServiceUrl.replace(c._rePortalTokenSvc,"")+"/home/signin.html",r=r.replace(/http:/i,"https:"),a&&!1===a.useSSL&&(r=r.replace(/https:/i,"http:")),0===g.toLowerCase().replace("https","http").indexOf(r.toLowerCase().replace("https","http"))?(k=Error("Cannot redirect to Sign-In page from within Sign-In page. URL of the resource that triggered this workflow: "+b.resUrl_),k.code="IdentityManagerBase.5",k.log=f.isDebug,e(k)):c._redirectFunc?c._redirectFunc({signInPage:r,
returnUrlParamName:"returnUrl",returnUrl:g,resourceUrl:b.resUrl_,serverInfo:k}):window.location=r+"?returnUrl\x3d"+window.escape(g)):(k=Error("User is not signed in."),k.code="IdentityManagerBase.6",k.log=f.isDebug,e(k))):a?d(new B({userId:a,server:k.server,token:n,expires:u.isDefined(h)?Number(h):null,ssl:!!g})):s?(a=s._oAuthCred,a||(g=new w(s,window.localStorage),n=new w(s,window.sessionStorage),g.isValid()&&n.isValid()?g.expires>n.expires?(a=g,n.destroy()):(a=n,g.destroy()):a=g.isValid()?g:n,s._oAuthCred=
a),a.isValid()?d(new B({userId:a.userId,server:k.server,token:a.token,expires:a.expires,ssl:a.ssl,_oAuthCred:a})):c._oAuthHash&&c._oAuthHash.state.portalUrl===s.portalUrl?(r=c._oAuthHash,k=new B({userId:r.username,server:k.server,token:r.access_token,expires:(new Date).getTime()+1E3*Number(r.expires_in),ssl:"true"===r.ssl,oAuthState:r.state,_oAuthCred:a}),a.storage=r.persist?window.localStorage:window.sessionStorage,a.token=k.token,a.expires=k.expires,a.userId=k.userId,a.ssl=k.ssl,a.save(),c._oAuthHash=
null,d(k)):r?b._pendingDfd=c.oAuthSignIn(b.resUrl_,k,s,b.options_).addCallbacks(d,e):(k=Error("User is not signed in."),k.code="IdentityManagerBase.6",k.log=f.isDebug,e(k))):r?c._checkProtocol(b.resUrl_,k,e,b.admin_)&&(r=b.options_,b.admin_&&(r=r||{},r.isAdmin=!0),b._pendingDfd=c.signIn(b.resUrl_,k,r).addCallbacks(d,e)):(k=Error("User is not signed in."),k.code="IdentityManagerBase.6",k.log=f.isDebug,e(k))},n=function(){var a=b.sinfo_,f=a.owningSystemUrl,g=b.options_,n,h,k;g&&(n=g.token,h=g.error);
k=c._findCredential(f,{token:n,resource:b.resUrl_});!k&&y(a)&&l.some(c.credentials,function(a){this._isIdProvider(f,a.server)&&(k=a);return!!k},c);k?(g=c.findCredential(b.resUrl_,k.userId))?d(g):A(a,c._legacyFed)?(g=k.toJson(),g.server=a.server,g.resources=null,d(new B(g))):(b._pendingDfd=c.generateToken(c.findServerInfo(k.server),null,{serverUrl:b.resUrl_,token:k.token,ssl:k.ssl})).addCallbacks(function(c){d(new B({userId:k.userId,server:a.server,token:c.token,expires:u.isDefined(c.expires)?Number(c.expires):
null,ssl:!!c.ssl,isAdmin:b.admin_,validity:c.validity}))},e):(c._busy=null,n&&(b.options_.token=null),(b._pendingDfd=c.getCredential(f.replace(/\/?$/,"/sharing"),{resource:b.resUrl_,token:n,error:h})).addCallbacks(function(a){c._enqueue(b.resUrl_,b.sinfo_,b.options_,b,b.admin_)},function(a){e(a)}))},h=b.sinfo_.owningSystemUrl,k=this._isServerRsrc(b.resUrl_),r=b.sinfo_._restInfoDfd,s=this._findOAuthInfo(b.resUrl_);r?r.addCallbacks(function(d){var e=b.sinfo_;e.adminTokenServiceUrl=e._restInfoDfd.adminUrl_;
e._restInfoDfd=null;e.tokenServiceUrl=a.getObject("authInfo.tokenServicesUrl",!1,d)||a.getObject("authInfo.tokenServiceUrl",!1,d)||a.getObject("tokenServiceUrl",!1,d);e.shortLivedTokenValidity=a.getObject("authInfo.shortLivedTokenValidity",!1,d);e.currentVersion=d.currentVersion;e.owningTenant=d.owningTenant;(d=e.owningSystemUrl=d.owningSystemUrl)&&c._portals.push(d);k&&d?n():g()},function(){b.sinfo_._restInfoDfd=null;var a=Error("Unknown resource - could not find token service endpoint.");a.code=
"IdentityManagerBase.2";a.log=f.isDebug;e(a)}):k&&h?n():b.sinfo_._selfDfd?(h=function(a){b.sinfo_._selfDfd=null;var d=a&&a.user&&a.user.username,e=a&&a.allSSL;b.sinfo_.webTierAuth=!!d;d&&c.normalizeWebTierAuth?(b.sinfo_._tokenDfd=c.generateToken(b.sinfo_,null,{ssl:e}),a=function(a){b.sinfo_._tokenDfd=null;g(d,e,a&&a.token,a&&a.expires)},b.sinfo_._tokenDfd.then(a,a)):g(d,e)},b.sinfo_._selfDfd.then(h,h)):g()}});B=p(n,{declaredClass:"esri.Credential",tokenRefreshBuffer:2,constructor:function(b){a.mixin(this,
b);this.resources=this.resources||[];u.isDefined(this.creationTime)||(this.creationTime=(new Date).getTime())},_oAuthCred:null,refreshToken:function(){var a=this,b=this.resources&&this.resources[0],c=d.id.findServerInfo(this.server),e=c&&c.owningSystemUrl,f=!!e&&"server"===this.scope,g=f&&A(c,d.id._legacyFed),n=f&&d.id.findServerInfo(e),h,k=(h=c.webTierAuth)&&d.id.normalizeWebTierAuth,r=z[this.server],r=r&&r[this.userId],s={username:this.userId,password:r},m;if(!h||k)if(f&&!n&&l.some(d.id.serverInfos,
function(a){d.id._isIdProvider(e,a.server)&&(n=a);return!!n}),h=n&&d.id.findCredential(n.server,this.userId),!f||h)if(g)h.refreshToken();else{if(f)m={serverUrl:b,token:h&&h.token,ssl:h&&h.ssl};else if(k)s=null,m={ssl:this.ssl};else if(r)this.isAdmin&&(m={isAdmin:!0});else{var t;b&&(b=d.id._sanitizeUrl(b),this._enqueued=1,t=d.id._enqueue(b,c,null,null,this.isAdmin,this),t.addCallback(function(){a._enqueued=0;a.refreshServerTokens()}).addErrback(function(){a._enqueued=0}));return t}return d.id.generateToken(f?
n:c,f?null:s,m).addCallback(function(b){a.token=b.token;a.expires=u.isDefined(b.expires)?Number(b.expires):null;a.creationTime=(new Date).getTime();a.validity=b.validity;a.onTokenChange();a.refreshServerTokens()}).addErrback(function(){})}},refreshServerTokens:function(){"portal"===this.scope&&l.forEach(d.id.credentials,function(a){var b=d.id.findServerInfo(a.server),c=b&&b.owningSystemUrl;if(a!==this&&a.userId===this.userId&&c&&"server"===a.scope&&(d.id._hasSameServerInstance(this.server,c)||d.id._isIdProvider(c,
this.server)))A(b,d.id._legacyFed)?(a.token=this.token,a.expires=this.expires,a.creationTime=this.creationTime,a.validity=this.validity,a.onTokenChange()):a.refreshToken()},this)},onTokenChange:function(a){clearTimeout(this._refreshTimer);var b=this.server&&d.id.findServerInfo(this.server),c=(b=b&&b.owningSystemUrl)&&d.id.findServerInfo(b);!1!==a&&((!b||"portal"===this.scope||c&&c.webTierAuth&&!d.id.normalizeWebTierAuth)&&(u.isDefined(this.expires)||u.isDefined(this.validity)))&&this._startRefreshTimer()},
onDestroy:function(){},destroy:function(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);var a=l.indexOf(d.id.credentials,this);-1<a&&d.id.credentials.splice(a,1);this.onTokenChange();this.onDestroy()},toJson:function(){return this._toJson()},_toJson:function(){var a=u.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,
isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),b=this.resources;b&&0<b.length&&(a.resources=b);return a},_startRefreshTimer:function(){clearTimeout(this._refreshTimer);var b=6E4*this.tokenRefreshBuffer,c=(this.validity?this.creationTime+6E4*this.validity:this.expires)-(new Date).getTime();0>c&&(c=0);this._refreshTimer=setTimeout(a.hitch(this,this.refreshToken),c>b?c-b:c)}});F.Credential=B;return F})},"esri/ServerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/has","./kernel","./lang"],function(p,f,a,l,k){return p(null,{declaredClass:"esri.ServerInfo",constructor:function(a){f.mixin(this,a)},toJson:function(){return k.fixJson({server:this.server,tokenServiceUrl:this.tokenServiceUrl,adminTokenServiceUrl:this.adminTokenServiceUrl,shortLivedTokenValidity:this.shortLivedTokenValidity,owningSystemUrl:this.owningSystemUrl,owningTenant:this.owningTenant,currentVersion:this.currentVersion,hasPortal:this.hasPortal,hasServer:this.hasServer,webTierAuth:this.webTierAuth})}})})},
"esri/OAuthCredential":function(){define(["./kernel","dojo/_base/declare","dojo/has","dojo/json"],function(p,f,a,l){return f(null,{declaredClass:"esri.OAuthCredential",oAuthInfo:null,storage:null,expires:null,ssl:null,token:null,userId:null,constructor:function(a,f){this.oAuthInfo=a;this.storage=f;this._init()},isValid:function(){var a=!1;if(this.oAuthInfo&&this.token&&this.userId){var f=(new Date).getTime();this.expires>f&&(this.expires-f)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&(a=!0)}return a},
save:function(){if(this.storage){var a=this._load(),f=this.oAuthInfo;if(f&&f.authNamespace&&f.portalUrl){var q=a[f.authNamespace];q||(q=a[f.authNamespace]={});q[f.portalUrl]={expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",l.stringify(a))}catch(m){console.log(m)}}}},destroy:function(){var a=this._load(),f=this.oAuthInfo;if(f&&f.authNamespace&&f.portalUrl&&this.storage){var q=a[f.authNamespace];if(q){delete q[f.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",
l.stringify(a))}catch(m){console.log(m)}}}f&&(this.oAuthInfo=f._oAuthCred=null)},_init:function(){var a=this._load(),f=this.oAuthInfo;if(f&&(f.authNamespace&&f.portalUrl)&&(a=a[f.authNamespace]))if(a=a[f.portalUrl])this.expires=a.expires,this.ssl=a.ssl,this.token=a.token,this.userId=a.userId},_load:function(){var a={};if(this.storage){var f=this.storage.getItem("esriJSAPIOAuth");if(f)try{a=l.parse(f)}catch(q){console.log(q)}}return a}})})},"esri/arcgis/OAuthInfo":function(){define(["../kernel","../lang",
"dojo/_base/declare","dojo/_base/lang","dojo/has"],function(p,f,a,l,k){return a(null,{declaredClass:"esri.arcgis.OAuthInfo",constructor:function(a){l.mixin(this,{expiration:20160,minTimeUntilExpiration:30,portalUrl:"https://www.arcgis.com",authNamespace:"/",forceLogin:!1,showSocialLogins:!1,popup:!1,popupCallbackUrl:"oauth-callback.html",popupWindowFeatures:"height\x3d480,width\x3d800,location,resizable,scrollbars,status"},a)},_oAuthCred:null,toJson:function(){return f.fixJson({appId:this.appId,expiration:this.expiration,
locale:this.locale,minTimeUntilExpiration:this.minTimeUntilExpiration,portalUrl:this.portalUrl,authNamespace:this.authNamespace,forceLogin:this.forceLogin,showSocialLogins:this.showSocialLogins,popup:this.popup,popupCallbackUrl:this.popupCallbackUrl,popupWindowFeatures:this.popupWindowFeatures})}})})},"dijit/form/Button":function(){define("require dojo/_base/declare dojo/dom-class dojo/has dojo/_base/kernel dojo/_base/lang dojo/ready ./_FormWidget ./_ButtonMixin dojo/text!./templates/Button.html ../a11yclick".split(" "),
function(p,f,a,l,k,h,q,m,g,e){l("dijit-legacy-requires")&&q(0,function(){p(["dijit/form/DropDownButton","dijit/form/ComboButton","dijit/form/ToggleButton"])});q=f("dijit.form.Button"+(l("dojo-bidi")?"_NoBidi":""),[m,g],{showLabel:!0,iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitButton",templateString:e,_setValueAttr:"valueNode",_setNameAttr:function(a){this.valueNode&&this.valueNode.setAttribute("name",a)},postCreate:function(){this.inherited(arguments);
this._setLabelFromContainer()},_setLabelFromContainer:function(){this.containerNode&&!this.label&&(this.label=h.trim(this.containerNode.innerHTML));this.onLabelSet()},_setShowLabelAttr:function(c){this.containerNode&&a.toggle(this.containerNode,"dijitDisplayNone",!c);this._set("showLabel",c)},setLabel:function(a){k.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},onLabelSet:function(){this.inherited(arguments);!this.showLabel&&
!("title"in this.params)&&(this.titleNode.title=h.trim(this.containerNode.innerText||this.containerNode.textContent||""))}});l("dojo-bidi")&&(q=f("dijit.form.Button",q,{onLabelSet:function(){this.inherited(arguments);this.titleNode.title&&this.applyTextDir(this.titleNode,this.titleNode.title)},_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this._setLabelAttr(this.label))}}));return q})},"dijit/form/_FormWidget":function(){define("dojo/_base/declare dojo/sniff dojo/_base/kernel dojo/ready ../_Widget ../_CssStateMixin ../_TemplatedMixin ./_FormWidgetMixin".split(" "),
function(p,f,a,l,k,h,q,m){f("dijit-legacy-requires")&&l(0,function(){require(["dijit/form/_FormValueWidget"])});return p("dijit.form._FormWidget",[k,q,h,m],{setDisabled:function(f){a.deprecated("setDisabled("+f+") is deprecated. Use set('disabled',"+f+") instead.","","2.0");this.set("disabled",f)},setValue:function(f){a.deprecated("dijit.form._FormWidget:setValue("+f+") is deprecated.  Use set('value',"+f+") instead.","","2.0");this.set("value",f)},getValue:function(){a.deprecated(this.declaredClass+
"::getValue() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},postMixInProperties:function(){this.nameAttrSetting=this.name&&!f("msapp")?'name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"";this.inherited(arguments)}})})},"dijit/form/_FormWidgetMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff dojo/window ../a11y".split(" "),function(p,f,a,l,k,h,q,m,g,e){return f("dijit.form._FormWidgetMixin",
null,{name:"",alt:"",value:"",type:"text","aria-label":"focusNode",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:!1,intermediateChanges:!1,scrollOnFocus:!0,_setIdAttr:"focusNode",_setDisabledAttr:function(c){this._set("disabled",c);/^(button|input|select|textarea|optgroup|option|fieldset)$/i.test(this.focusNode.tagName)?a.set(this.focusNode,"disabled",c):this.focusNode.setAttribute("aria-disabled",c?"true":"false");this.valueNode&&a.set(this.valueNode,"disabled",c);c?(this._set("hovering",!1),
this._set("active",!1),c="tabIndex"in this.attributeMap?this.attributeMap.tabIndex:"_setTabIndexAttr"in this?this._setTabIndexAttr:"focusNode",p.forEach(k.isArray(c)?c:[c],function(a){a=this[a];m("webkit")||e.hasDefaultTabStop(a)?a.setAttribute("tabIndex","-1"):a.removeAttribute("tabIndex")},this)):""!=this.tabIndex&&this.set("tabIndex",this.tabIndex)},_onFocus:function(a){if("mouse"==a&&this.isFocusable())var d=this.own(q(this.focusNode,"focus",function(){f.remove();d.remove()}))[0],e=m("pointer-events")?
"pointerup":m("MSPointer")?"MSPointerUp":m("touch-events")?"touchend, mouseup":"mouseup",f=this.own(q(this.ownerDocumentBody,e,k.hitch(this,function(a){f.remove();d.remove();this.focused&&("touchend"==a.type?this.defer("focus"):this.focus())})))[0];this.scrollOnFocus&&this.defer(function(){g.scrollIntoView(this.domNode)});this.inherited(arguments)},isFocusable:function(){return!this.disabled&&this.focusNode&&"none"!=l.get(this.domNode,"display")},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(a){}},
compare:function(a,d){return"number"==typeof a&&"number"==typeof d?isNaN(a)&&isNaN(d)?0:a-d:a>d?1:a<d?-1:0},onChange:function(){},_onChangeActive:!1,_handleOnChange:function(a,d){if(void 0==this._lastValueReported&&(null===d||!this._onChangeActive))this._resetValue=this._lastValueReported=a;this._pendingOnChange=this._pendingOnChange||typeof a!=typeof this._lastValueReported||0!=this.compare(a,this._lastValueReported);if((this.intermediateChanges||d||void 0===d)&&this._pendingOnChange)this._lastValueReported=
a,this._pendingOnChange=!1,this._onChangeActive&&(this._onChangeHandle&&this._onChangeHandle.remove(),this._onChangeHandle=this.defer(function(){this._onChangeHandle=null;this.onChange(a)}))},create:function(){this.inherited(arguments);this._onChangeActive=!0},destroy:function(){this._onChangeHandle&&(this._onChangeHandle.remove(),this.onChange(this._lastValueReported));this.inherited(arguments)}})})},"dijit/form/_ButtonMixin":function(){define(["dojo/_base/declare","dojo/dom","dojo/has","../registry"],
function(p,f,a,l){var k=p("dijit.form._ButtonMixin"+(a("dojo-bidi")?"_NoBidi":""),null,{label:"",type:"button",__onClick:function(a){a.stopPropagation();a.preventDefault();this.disabled||this.valueNode.click(a);return!1},_onClick:function(a){if(this.disabled)return a.stopPropagation(),a.preventDefault(),!1;!1===this.onClick(a)&&a.preventDefault();var f=a.defaultPrevented;if(!f&&"submit"==this.type&&!(this.valueNode||this.focusNode).form)for(var k=this.domNode;k.parentNode;k=k.parentNode){var g=l.byNode(k);
if(g&&"function"==typeof g._onSubmit){g._onSubmit(a);a.preventDefault();f=!0;break}}return!f},postCreate:function(){this.inherited(arguments);f.setSelectable(this.focusNode,!1)},onClick:function(){return!0},_setLabelAttr:function(a){this._set("label",a);(this.containerNode||this.focusNode).innerHTML=a;this.onLabelSet()},onLabelSet:function(){}});a("dojo-bidi")&&(k=p("dijit.form._ButtonMixin",k,{onLabelSet:function(){this.inherited(arguments);this.applyTextDir(this.containerNode||this.focusNode)}}));
return k})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),function(p,f,a,l,k,h,q,m){return p("dijit.form.Form",[k,h,q,m],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",
postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(a){f.set(this.domNode,"encType",a);l("ie")&&(this.domNode.encoding=a);this._set("encType",a)},reset:function(a){var e={returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:a?a.target:this.domNode,target:a?a.target:this.domNode};!1!==this.onReset(e)&&e.returnValue&&
this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(a){this.reset(a);a.stopPropagation();a.preventDefault();return!1},_onSubmit:function(f){var e=this.constructor.prototype;if(this.execute!=e.execute||this.onExecute!=e.onExecute)a.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),this.execute(this.getValues());!1===this.onSubmit(f)&&(f.stopPropagation(),f.preventDefault())},onSubmit:function(){return this.isValid()},
submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"dijit/form/ValidationTextBox":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/i18n ./TextBox ../Tooltip dojo/text!./templates/ValidationTextBox.html dojo/i18n!./nls/validate".split(" "),function(p,f,a,l,k,h,q){var m=p("dijit.form.ValidationTextBox",k,{templateString:q,required:!1,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},pattern:".*",regExp:"",
regExpGen:function(){},state:"",tooltipPosition:[],_deprecateRegExp:function(a,e){e!=m.prototype[a]&&(f.deprecated("ValidationTextBox id\x3d"+this.id+", set('"+a+"', ...) is deprecated.  Use set('pattern', ...) instead.","","2.0"),this.set("pattern",e))},_setRegExpGenAttr:function(a){this._deprecateRegExp("regExpGen",a);this._set("regExpGen",this._computeRegexp)},_setRegExpAttr:function(a){this._deprecateRegExp("regExp",a)},_setValueAttr:function(){this.inherited(arguments);this._refreshState()},
validator:function(a,e){return RegExp("^(?:"+this._computeRegexp(e)+")"+(this.required?"":"?")+"$").test(a)&&(!this.required||!this._isEmpty(a))&&(this._isEmpty(a)||void 0!==this.parse(a,e))},_isValidSubset:function(){return 0==this.textbox.value.search(this._partialre)},isValid:function(){return this.validator(this.textbox.value,this.get("constraints"))},_isEmpty:function(a){return(this.trim?/^\s*$/:/^$/).test(a)},getErrorMessage:function(){var a="$_unset_$"==this.invalidMessage?this.messages.invalidMessage:
!this.invalidMessage?this.promptMessage:this.invalidMessage,e="$_unset_$"==this.missingMessage?this.messages.missingMessage:!this.missingMessage?a:this.missingMessage;return this.required&&this._isEmpty(this.textbox.value)?e:a},getPromptMessage:function(){return this.promptMessage},_maskValidSubsetError:!0,validate:function(a){var e="",c=this.disabled||this.isValid(a);c&&(this._maskValidSubsetError=!0);var d=this._isEmpty(this.textbox.value),f=!c&&a&&this._isValidSubset();this._set("state",c?"":((!this._hasBeenBlurred||
a)&&d||f)&&(this._maskValidSubsetError||f&&!this._hasBeenBlurred&&a)?"Incomplete":"Error");this.focusNode.setAttribute("aria-invalid","Error"==this.state?"true":"false");"Error"==this.state?(this._maskValidSubsetError=a&&f,e=this.getErrorMessage(a)):"Incomplete"==this.state?(e=this.getPromptMessage(a),this._maskValidSubsetError=!this._hasBeenBlurred||a):d&&(e=this.getPromptMessage(a));this.set("message",e);return c},displayMessage:function(a){a&&this.focused?h.show(a,this.domNode,this.tooltipPosition,
!this.isLeftToRight()):h.hide(this.domNode)},_refreshState:function(){this._created&&this.validate(this.focused);this.inherited(arguments)},constructor:function(f){this.constraints=a.clone(this.constraints);this.baseClass+=" dijitValidationTextBox"},startup:function(){this.inherited(arguments);this._refreshState()},_setConstraintsAttr:function(a){!a.locale&&this.lang&&(a.locale=this.lang);this._set("constraints",a);this._refreshState()},_setPatternAttr:function(a){this._set("pattern",a);this._refreshState()},
_computeRegexp:function(a){var e=this.pattern;"function"==typeof e&&(e=e.call(this,a));if(e!=this._lastRegExp){var c="";this._lastRegExp=e;".*"!=e&&e.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(a){switch(a.charAt(0)){case "{":case "+":case "?":case "*":case "^":case "$":case "|":case "(":c+=a;break;case ")":c+="|$)";break;default:c+="(?:"+a+"|$)"}});try{"".search(c)}catch(d){c=this.pattern,console.warn("RegExp error in "+this.declaredClass+": "+this.pattern)}this._partialre="^(?:"+
c+")$"}return e},postMixInProperties:function(){this.inherited(arguments);this.messages=l.getLocalization("dijit.form","validate",this.lang);this._setConstraintsAttr(this.constraints)},_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",a);this._refreshState()},_setMessageAttr:function(a){this._set("message",a);this.displayMessage(a)},reset:function(){this._maskValidSubsetError=
!0;this.inherited(arguments)},_onBlur:function(){this.displayMessage("");this.inherited(arguments)},destroy:function(){h.hide(this.domNode);this.inherited(arguments)}});return m})},"dijit/form/TextBox":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-style dojo/_base/kernel dojo/_base/lang dojo/on dojo/sniff ./_FormValueWidget ./_TextBoxMixin dojo/text!./templates/TextBox.html ../main".split(" "),function(p,f,a,l,k,h,q,m,g,e,c){m=p("dijit.form.TextBox"+(q("dojo-bidi")?"_NoBidi":""),
[m,g],{templateString:e,_singleNodeTemplate:'\x3cinput class\x3d"dijit dijitReset dijitLeft dijitInputField" data-dojo-attach-point\x3d"textbox,focusNode" autocomplete\x3d"off" type\x3d"${type}" ${!nameAttrSetting} /\x3e',_buttonInputDisabled:q("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){var a=this.type.toLowerCase();if(this.templateString&&"input"==this.templateString.toLowerCase()||("hidden"==a||"file"==a)&&this.templateString==this.constructor.prototype.templateString)this.templateString=
this._singleNodeTemplate;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);9>q("ie")&&this.defer(function(){try{var c=a.getComputedStyle(this.domNode);if(c){var e=c.fontFamily;if(e){var f=this.domNode.getElementsByTagName("INPUT");if(f)for(c=0;c<f.length;c++)f[c].style.fontFamily=e}}}catch(g){}})},_setPlaceHolderAttr:function(a){this._set("placeHolder",a);this._phspan||(this._attachPoints.push("_phspan"),this._phspan=f.create("span",{className:"dijitPlaceHolder dijitInputField"},
this.textbox,"after"),this.own(h(this._phspan,"mousedown",function(a){a.preventDefault()}),h(this._phspan,"touchend, pointerup, MSPointerUp",k.hitch(this,function(){this.focus()}))));this._phspan.innerHTML="";this._phspan.appendChild(this._phspan.ownerDocument.createTextNode(a));this._updatePlaceHolder()},_onInput:function(a){this.inherited(arguments);this._updatePlaceHolder()},_updatePlaceHolder:function(){this._phspan&&(this._phspan.style.display=this.placeHolder&&!this.textbox.value?"":"none")},
_setValueAttr:function(a,c,e){this.inherited(arguments);this._updatePlaceHolder()},getDisplayedValue:function(){l.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.","","2.0");return this.get("displayedValue")},setDisplayedValue:function(a){l.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");this.set("displayedValue",a)},_onBlur:function(a){this.disabled||(this.inherited(arguments),
this._updatePlaceHolder(),q("mozilla")&&this.selectOnClick&&(this.textbox.selectionStart=this.textbox.selectionEnd=void 0))},_onFocus:function(a){!this.disabled&&!this.readOnly&&(this.inherited(arguments),this._updatePlaceHolder())}});9>q("ie")&&(m.prototype._isTextSelected=function(){var a=this.ownerDocument.selection.createRange();return a.parentElement()==this.textbox&&0<a.text.length},c._setSelectionRange=g._setSelectionRange=function(a,c,e){a.createTextRange&&(a=a.createTextRange(),a.collapse(!0),
a.moveStart("character",-99999),a.moveStart("character",c),a.moveEnd("character",e-c),a.select())});q("dojo-bidi")&&(m=p("dijit.form.TextBox",m,{_setPlaceHolderAttr:function(a){this.inherited(arguments);this.applyTextDir(this._phspan)}}));return m})},"dijit/form/_FormValueWidget":function(){define(["dojo/_base/declare","dojo/sniff","./_FormWidget","./_FormValueMixin"],function(p,f,a,l){return p("dijit.form._FormValueWidget",[a,l],{_layoutHackIE7:function(){if(7==f("ie"))for(var a=this.domNode,h=a.parentNode,
l=a.firstChild||a,m=l.style.filter,g=this;h&&0==h.clientHeight;)(function(){var a=g.connect(h,"onscroll",function(){g.disconnect(a);l.style.filter=(new Date).getMilliseconds();g.defer(function(){l.style.filter=m})})})(),h=h.parentNode}})})},"dijit/form/_FormValueMixin":function(){define("dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on ./_FormWidgetMixin".split(" "),function(p,f,a,l,k,h){return p("dijit.form._FormValueMixin",h,{readOnly:!1,_setReadOnlyAttr:function(a){f.set(this.focusNode,
"readOnly",a);this._set("readOnly",a)},postCreate:function(){this.inherited(arguments);void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.value)},_setValueAttr:function(a,f){this._handleOnChange(a,f)},_handleOnChange:function(a,f){this._set("value",a);this.inherited(arguments)},undo:function(){this._setValueAttr(this._lastValueReported,!1)},reset:function(){this._hasBeenBlurred=!1;this._setValueAttr(this._resetValue,!0)}})})},"dijit/form/_TextBoxMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/sniff dojo/keys dojo/_base/lang dojo/on ../main".split(" "),
function(p,f,a,l,k,h,q,m){var g=f("dijit.form._TextBoxMixin"+(l("dojo-bidi")?"_NoBidi":""),null,{trim:!1,uppercase:!1,lowercase:!1,propercase:!1,maxLength:"",selectOnClick:!1,placeHolder:"",_getValueAttr:function(){return this.parse(this.get("displayedValue"),this.constraints)},_setValueAttr:function(a,c,d){var f;void 0!==a&&(f=this.filter(a),"string"!=typeof d&&(d=null!==f&&("number"!=typeof f||!isNaN(f))?this.filter(this.format(f,this.constraints)):"",0!=this.compare(f,this.filter(this.parse(d,
this.constraints)))&&(d=null)));if(null!=d&&("number"!=typeof d||!isNaN(d))&&this.textbox.value!=d)this.textbox.value=d,this._set("displayedValue",this.get("displayedValue"));this.inherited(arguments,[f,c])},displayedValue:"",_getDisplayedValueAttr:function(){return this.filter(this.textbox.value)},_setDisplayedValueAttr:function(a){null==a?a="":"string"!=typeof a&&(a=String(a));this.textbox.value=a;this._setValueAttr(this.get("value"),void 0);this._set("displayedValue",this.get("displayedValue"))},
format:function(a){return null==a?"":a.toString?a.toString():a},parse:function(a){return a},_refreshState:function(){},onInput:function(){},_onInput:function(a){this._lastInputEventValue=this.textbox.value;this._processInput(this._lastInputProducingEvent||a);delete this._lastInputProducingEvent;this.intermediateChanges&&this._handleOnChange(this.get("value"),!1)},_processInput:function(){this._refreshState();this._set("displayedValue",this.get("displayedValue"))},postCreate:function(){this.textbox.setAttribute("value",
this.textbox.value);this.inherited(arguments);this.own(q(this.textbox,"keydown, keypress, paste, cut, compositionend",h.hitch(this,function(a){var c;if("keydown"==a.type&&229!=a.keyCode){c=a.keyCode;switch(c){case k.SHIFT:case k.ALT:case k.CTRL:case k.META:case k.CAPS_LOCK:case k.NUM_LOCK:case k.SCROLL_LOCK:return}if(!a.ctrlKey&&!a.metaKey&&!a.altKey){switch(c){case k.NUMPAD_0:case k.NUMPAD_1:case k.NUMPAD_2:case k.NUMPAD_3:case k.NUMPAD_4:case k.NUMPAD_5:case k.NUMPAD_6:case k.NUMPAD_7:case k.NUMPAD_8:case k.NUMPAD_9:case k.NUMPAD_MULTIPLY:case k.NUMPAD_PLUS:case k.NUMPAD_ENTER:case k.NUMPAD_MINUS:case k.NUMPAD_PERIOD:case k.NUMPAD_DIVIDE:return}if(65<=
c&&90>=c||48<=c&&57>=c||c==k.SPACE)return;c=!1;for(var d in k)if(k[d]===a.keyCode){c=!0;break}if(!c)return}}(c=32<=a.charCode?String.fromCharCode(a.charCode):a.charCode)||(c=65<=a.keyCode&&90>=a.keyCode||48<=a.keyCode&&57>=a.keyCode||a.keyCode==k.SPACE?String.fromCharCode(a.keyCode):a.keyCode);c||(c=229);if("keypress"==a.type){if("string"!=typeof c)return;if("a"<=c&&"z">=c||"A"<=c&&"Z">=c||"0"<=c&&"9">=c||" "===c)if(a.ctrlKey||a.metaKey||a.altKey)return}var f={faux:!0},g;for(g in a)/^(layer[XY]|returnValue|keyLocation)$/.test(g)||
(d=a[g],"function"!=typeof d&&"undefined"!=typeof d&&(f[g]=d));h.mixin(f,{charOrCode:c,_wasConsumed:!1,preventDefault:function(){f._wasConsumed=!0;a.preventDefault()},stopPropagation:function(){a.stopPropagation()}});this._lastInputProducingEvent=f;!1===this.onInput(f)&&(f.preventDefault(),f.stopPropagation());if(!f._wasConsumed&&9>=l("ie"))switch(a.keyCode){case k.TAB:case k.ESCAPE:case k.DOWN_ARROW:case k.UP_ARROW:case k.LEFT_ARROW:case k.RIGHT_ARROW:break;default:if(a.keyCode==k.ENTER&&"textarea"!=
this.textbox.tagName.toLowerCase())break;this.defer(function(){this.textbox.value!==this._lastInputEventValue&&q.emit(this.textbox,"input",{bubbles:!0})})}})),q(this.textbox,"input",h.hitch(this,"_onInput")),q(this.domNode,"keypress",function(a){a.stopPropagation()}))},_blankValue:"",filter:function(a){if(null===a)return this._blankValue;if("string"!=typeof a)return a;this.trim&&(a=h.trim(a));this.uppercase&&(a=a.toUpperCase());this.lowercase&&(a=a.toLowerCase());this.propercase&&(a=a.replace(/[^\s]+/g,
function(a){return a.substring(0,1).toUpperCase()+a.substring(1)}));return a},_setBlurValue:function(){this._setValueAttr(this.get("value"),!0)},_onBlur:function(a){this.disabled||(this._setBlurValue(),this.inherited(arguments))},_isTextSelected:function(){return this.textbox.selectionStart!=this.textbox.selectionEnd},_onFocus:function(a){!this.disabled&&!this.readOnly&&(this.selectOnClick&&"mouse"==a&&(this._selectOnClickHandle=q.once(this.domNode,"mouseup, touchend",h.hitch(this,function(a){this._isTextSelected()||
g.selectInputText(this.textbox)})),this.own(this._selectOnClickHandle),this.defer(function(){this._selectOnClickHandle&&(this._selectOnClickHandle.remove(),this._selectOnClickHandle=null)},500)),this.inherited(arguments),this._refreshState())},reset:function(){this.textbox.value="";this.inherited(arguments)}});l("dojo-bidi")&&(g=f("dijit.form._TextBoxMixin",g,{_setValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_setDisplayedValueAttr:function(){this.inherited(arguments);
this.applyTextDir(this.focusNode)},_onInput:function(){this.applyTextDir(this.focusNode);this.inherited(arguments)}}));g._setSelectionRange=m._setSelectionRange=function(a,c,d){a.setSelectionRange&&a.setSelectionRange(c,d)};g.selectInputText=m.selectInputText=function(e,c,d){e=a.byId(e);isNaN(c)&&(c=0);isNaN(d)&&(d=e.value?e.value.length:0);try{e.focus(),g._setSelectionRange(e,c,d)}catch(f){}};return g})},"dijit/Tooltip":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/fx dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff ./_base/manager ./place ./_Widget ./_TemplatedMixin ./BackgroundIframe dojo/text!./templates/Tooltip.html ./main".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v){function n(){}var w=f("dijit._MasterTooltip",[u,s],{duration:d.defaultDuration,templateString:b,postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);this.bgIframe=new t(this.domNode);this.fadeIn=a.fadeIn({node:this.domNode,duration:this.duration,onEnd:m.hitch(this,"_onShow")});this.fadeOut=a.fadeOut({node:this.domNode,duration:this.duration,onEnd:m.hitch(this,"_onHide")})},show:function(a,b,c,d,e,f,g){if(!this.aroundNode||!(this.aroundNode===
b&&this.containerNode.innerHTML==a))if("playing"==this.fadeOut.status())this._onDeck=arguments;else{this.containerNode.innerHTML=a;e&&this.set("textDir",e);this.containerNode.align=d?"right":"left";var h=r.around(this.domNode,b,c&&c.length?c:x.defaultPosition,!d,m.hitch(this,"orient")),k=h.aroundNodePos;"M"==h.corner.charAt(0)&&"M"==h.aroundCorner.charAt(0)?(this.connectorNode.style.top=k.y+(k.h-this.connectorNode.offsetHeight>>1)-h.y+"px",this.connectorNode.style.left=""):"M"==h.corner.charAt(1)&&
"M"==h.aroundCorner.charAt(1)?this.connectorNode.style.left=k.x+(k.w-this.connectorNode.offsetWidth>>1)-h.x+"px":(this.connectorNode.style.left="",this.connectorNode.style.top="");q.set(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=!0;this.aroundNode=b;this.onMouseEnter=f||n;this.onMouseLeave=g||n}},orient:function(a,b,d,e,f){this.connectorNode.style.top="";var g=e.h;e=e.w;a.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove",
"BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[b+"-"+d];this.domNode.style.width="auto";var n=h.position(this.domNode);if(c("ie")||c("trident"))n.w+=2;var k=Math.min(Math.max(e,1),n.w);h.setMarginBox(this.domNode,{w:k});"B"==d.charAt(0)&&"B"==b.charAt(0)?(a=h.position(a),b=
this.connectorNode.offsetHeight,a.h>g?(this.connectorNode.style.top=g-(f.h+b>>1)+"px",this.connectorNode.style.bottom=""):(this.connectorNode.style.bottom=Math.min(Math.max(f.h/2-b/2,0),a.h-b)+"px",this.connectorNode.style.top="")):(this.connectorNode.style.top="",this.connectorNode.style.bottom="");return Math.max(0,n.w-e)},_onShow:function(){c("ie")&&(this.domNode.style.filter="")},hide:function(a){this._onDeck&&this._onDeck[1]==a?this._onDeck=null:this.aroundNode===a&&(this.fadeIn.stop(),this.isShowingNow=
!1,this.aroundNode=null,this.fadeOut.play());this.onMouseEnter=this.onMouseLeave=n},_onHide:function(){this.domNode.style.cssText="";this.containerNode.innerHTML="";this._onDeck&&(this.show.apply(this,this._onDeck),this._onDeck=null)}});c("dojo-bidi")&&w.extend({_setAutoTextDir:function(a){this.applyTextDir(a);p.forEach(a.children,function(a){this._setAutoTextDir(a)},this)},_setTextDirAttr:function(a){this._set("textDir",a);"auto"==a?this._setAutoTextDir(this.containerNode):this.containerNode.dir=
this.textDir}});v.showTooltip=function(a,b,c,d,e,f,g){c&&(c=p.map(c,function(a){return{after:"after-centered",before:"before-centered"}[a]||a}));x._masterTT||(v._masterTT=x._masterTT=new w);return x._masterTT.show(a,b,c,d,e,f,g)};v.hideTooltip=function(a){return x._masterTT&&x._masterTT.hide(a)};var x=f("dijit.Tooltip",u,{label:"",showDelay:400,hideDelay:400,connectId:[],position:[],selector:"",_setConnectIdAttr:function(a){p.forEach(this._connections||[],function(a){p.forEach(a,function(a){a.remove()})},
this);this._connectIds=p.filter(m.isArrayLike(a)?a:a?[a]:[],function(a){return l.byId(a,this.ownerDocument)},this);this._connections=p.map(this._connectIds,function(a){a=l.byId(a,this.ownerDocument);var b=this.selector,c=b?function(a){return e.selector(b,a)}:function(a){return a},d=this;return[e(a,c(g.enter),function(){d._onHover(this)}),e(a,c("focusin"),function(){d._onHover(this)}),e(a,c(g.leave),m.hitch(d,"_onUnHover")),e(a,c("focusout"),m.hitch(d,"set","state","DORMANT"))]},this);this._set("connectId",
a)},addTarget:function(a){a=a.id||a;-1==p.indexOf(this._connectIds,a)&&this.set("connectId",this._connectIds.concat(a))},removeTarget:function(a){a=p.indexOf(this._connectIds,a.id||a);0<=a&&(this._connectIds.splice(a,1),this.set("connectId",this._connectIds))},buildRendering:function(){this.inherited(arguments);k.add(this.domNode,"dijitTooltipData")},startup:function(){this.inherited(arguments);var a=this.connectId;p.forEach(m.isArrayLike(a)?a:[a],this.addTarget,this)},getContent:function(a){return this.label||
this.domNode.innerHTML},state:"DORMANT",_setStateAttr:function(a){if(!(this.state==a||"SHOW TIMER"==a&&"SHOWING"==this.state||"HIDE TIMER"==a&&"DORMANT"==this.state)){this._hideTimer&&(this._hideTimer.remove(),delete this._hideTimer);this._showTimer&&(this._showTimer.remove(),delete this._showTimer);switch(a){case "DORMANT":this._connectNode&&(x.hide(this._connectNode),delete this._connectNode,this.onHide());break;case "SHOW TIMER":"SHOWING"!=this.state&&(this._showTimer=this.defer(function(){this.set("state",
"SHOWING")},this.showDelay));break;case "SHOWING":var b=this.getContent(this._connectNode);if(!b){this.set("state","DORMANT");return}x.show(b,this._connectNode,this.position,!this.isLeftToRight(),this.textDir,m.hitch(this,"set","state","SHOWING"),m.hitch(this,"set","state","HIDE TIMER"));this.onShow(this._connectNode,this.position);break;case "HIDE TIMER":this._hideTimer=this.defer(function(){this.set("state","DORMANT")},this.hideDelay)}this._set("state",a)}},_onHover:function(a){this._connectNode&&
a!=this._connectNode&&this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOW TIMER")},_onUnHover:function(a){this.set("state","HIDE TIMER")},open:function(a){this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOWING")},close:function(){this.set("state","DORMANT")},onShow:function(){},onHide:function(){},destroy:function(){this.set("state","DORMANT");p.forEach(this._connections||[],function(a){p.forEach(a,function(a){a.remove()})},this);this.inherited(arguments)}});
x._MasterTooltip=w;x.show=v.showTooltip;x.hide=v.hideTooltip;x.defaultPosition=["after-centered","before-centered"];return x})},"dijit/place":function(){define("dojo/_base/array dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/_base/window ./Viewport ./main".split(" "),function(p,f,a,l,k,h,q){function m(e,c,d,g){var l=h.getEffectiveBox(e.ownerDocument);(!e.parentNode||"body"!=String(e.parentNode.tagName).toLowerCase())&&k.body(e.ownerDocument).appendChild(e);var s=null;p.some(c,function(a){var b=
a.corner,c=a.pos,h=0,k={w:{L:l.l+l.w-c.x,R:c.x-l.l,M:l.w}[b.charAt(1)],h:{T:l.t+l.h-c.y,B:c.y-l.t,M:l.h}[b.charAt(0)]},m=e.style;m.left=m.right="auto";d&&(h=d(e,a.aroundCorner,b,k,g),h="undefined"==typeof h?0:h);var t=e.style,q=t.display,p=t.visibility;"none"==t.display&&(t.visibility="hidden",t.display="");m=f.position(e);t.display=q;t.visibility=p;q={L:c.x,R:c.x-m.w,M:Math.max(l.l,Math.min(l.l+l.w,c.x+(m.w>>1))-m.w)}[b.charAt(1)];p={T:c.y,B:c.y-m.h,M:Math.max(l.t,Math.min(l.t+l.h,c.y+(m.h>>1))-
m.h)}[b.charAt(0)];c=Math.max(l.l,q);t=Math.max(l.t,p);q=Math.min(l.l+l.w,q+m.w);p=Math.min(l.t+l.h,p+m.h);q-=c;p-=t;h+=m.w-q+(m.h-p);if(null==s||h<s.overflow)s={corner:b,aroundCorner:a.aroundCorner,x:c,y:t,w:q,h:p,overflow:h,spaceAvailable:k};return!h});s.overflow&&d&&d(e,s.aroundCorner,s.corner,s.spaceAvailable,g);c=s.y;var m=s.x,b=k.body(e.ownerDocument);/relative|absolute/.test(a.get(b,"position"))&&(c-=a.get(b,"marginTop"),m-=a.get(b,"marginLeft"));b=e.style;b.top=c+"px";b.left=m+"px";b.right=
"auto";return s}var g={TL:"BR",TR:"BL",BL:"TR",BR:"TL"};return q.place={at:function(a,c,d,f,h){d=p.map(d,function(a){var d={corner:a,aroundCorner:g[a],pos:{x:c.x,y:c.y}};f&&(d.pos.x+="L"==a.charAt(1)?f.x:-f.x,d.pos.y+="T"==a.charAt(0)?f.y:-f.y);return d});return m(a,d,h)},around:function(e,c,d,g,h){function k(a,b){F.push({aroundCorner:a,corner:b,pos:{x:{L:z,R:z+A,M:z+(A>>1)}[a.charAt(1)],y:{T:y,B:y+B,M:y+(B>>1)}[a.charAt(0)]}})}var t;if("string"==typeof c||"offsetWidth"in c||"ownerSVGElement"in c){if(t=
f.position(c,!0),/^(above|below)/.test(d[0])){var b=f.getBorderExtents(c),q=c.firstChild?f.getBorderExtents(c.firstChild):{t:0,l:0,b:0,r:0},n=f.getBorderExtents(e),w=e.firstChild?f.getBorderExtents(e.firstChild):{t:0,l:0,b:0,r:0};t.y+=Math.min(b.t+q.t,n.t+w.t);t.h-=Math.min(b.t+q.t,n.t+w.t)+Math.min(b.b+q.b,n.b+w.b)}}else t=c;if(c.parentNode){b="absolute"==a.getComputedStyle(c).position;for(c=c.parentNode;c&&1==c.nodeType&&"BODY"!=c.nodeName;){q=f.position(c,!0);n=a.getComputedStyle(c);/relative|absolute/.test(n.position)&&
(b=!1);if(!b&&/hidden|auto|scroll/.test(n.overflow)){var w=Math.min(t.y+t.h,q.y+q.h),x=Math.min(t.x+t.w,q.x+q.w);t.x=Math.max(t.x,q.x);t.y=Math.max(t.y,q.y);t.h=w-t.y;t.w=x-t.x}"absolute"==n.position&&(b=!0);c=c.parentNode}}var z=t.x,y=t.y,A="w"in t?t.w:t.w=t.width,B="h"in t?t.h:(l.deprecated("place.around: dijit/place.__Rectangle: { x:"+z+", y:"+y+", height:"+t.height+", width:"+A+" } has been deprecated.  Please use { x:"+z+", y:"+y+", h:"+t.height+", w:"+A+" }","","2.0"),t.h=t.height),F=[];p.forEach(d,
function(a){var b=g;switch(a){case "above-centered":k("TM","BM");break;case "below-centered":k("BM","TM");break;case "after-centered":b=!b;case "before-centered":k(b?"ML":"MR",b?"MR":"ML");break;case "after":b=!b;case "before":k(b?"TL":"TR",b?"TR":"TL");k(b?"BL":"BR",b?"BR":"BL");break;case "below-alt":b=!b;case "below":k(b?"BL":"BR",b?"TL":"TR");k(b?"BR":"BL",b?"TR":"TL");break;case "above-alt":b=!b;case "above":k(b?"TL":"TR",b?"BL":"BR");k(b?"TR":"TL",b?"BR":"BL");break;default:k(a.aroundCorner,
a.corner)}});e=m(e,F,h,{w:A,h:B});e.aroundNodePos=t;return e}}})},"esri/OAuthSignInHandler":function(){define("./Credential ./domUtils ./lang ./urlUtils dijit/Dialog dijit/registry dojo/_base/config dojo/_base/Deferred dojo/_base/kernel dojo/dom-attr dojo/i18n!./nls/jsapi dojo/io-query dojo/sniff dojo/json dijit/form/Button dojo/query".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r,u){return{_oAuthDfd:null,_oAuthIntervalId:0,_oAuthDialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${oAuthInfo}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e",
setOAuthRedirectionHandler:function(a){this._oAuthRedirectFunc=a},oAuthSignIn:function(a,d,b,g){var n=this._oAuthDfd=new m;n.resUrl_=a;n.sinfo_=d;n.oinfo_=b;var h=!g||!1!==g.oAuthPopupConfirmation;if(!b.popup||!h)return this._doOAuthSignIn(a,d,b),n;this._nls||(this._nls=c.identity);this.oAuthDialog||(this.oAuthDialog=this._createOAuthDialog());a=this.oAuthDialog;d=g&&g.error;g=g&&g.token;f.hide(a.errMsg_);d&&(403==d.code&&g)&&(e.set(a.errMsg_,"innerHTML",this._nls.forbidden),f.show(a.errMsg_));a.show();
return n},setOAuthResponseHash:function(a){var c=this._oAuthDfd;this._oAuthDfd=null;if(c&&a)if(clearInterval(this._oAuthIntervalId),"#"===a.charAt(0)&&(a=a.substring(1)),a=d.queryToObject(a),a.error)a=Error("access_denied"===a.error?"ABORTED":"OAuth: "+a.error+" - "+a.error_description),a.code="IdentityManagerBase.2",a.log=q.isDebug,c.errback(a);else{var b=c.oinfo_._oAuthCred,e=new p({userId:a.username,server:c.sinfo_.server,token:a.access_token,expires:(new Date).getTime()+1E3*Number(a.expires_in),
ssl:"true"===a.ssl,_oAuthCred:b});b.storage=a.persist?window.localStorage:window.sessionStorage;b.token=e.token;b.expires=e.expires;b.userId=e.userId;b.ssl=e.ssl;b.save();c.callback(e)}},_createOAuthDialog:function(){var c=this._nls,d=a.substitute(c,this._oAuthDialogContent),b=new k({title:c.title,content:d,"class":"esriOAuthSignInDialog",style:"min-width: 18em;",esriIdMgr_:this,execute_:function(){var a=b.esriIdMgr_._oAuthDfd;b.hide_();b.esriIdMgr_._doOAuthSignIn(a.resUrl_,a.sinfo_,a.oinfo_)},cancel_:function(){var a=
b.esriIdMgr_._oAuthDfd;b.esriIdMgr_._oAuthDfd=null;b.hide_();var c=Error("ABORTED");c.code="IdentityManager.2";c.log=q.isDebug;a.errback(c)},hide_:function(){f.hide(b.errMsg_);b.hide();k._DialogLevelManager.hide(b)}}),c=b.domNode;b.btnSubmit_=h.byNode(g.query(".esriIdSubmit",c)[0]);b.btnCancel_=h.byNode(g.query(".esriIdCancel",c)[0]);b.errMsg_=g.query(".esriErrorMsg",c)[0];b.connect(b.btnSubmit_,"onClick",b.execute_);b.connect(b.btnCancel_,"onClick",b.onCancel);b.connect(b,"onCancel",b.cancel_);return b},
_doOAuthSignIn:function(a,c,b){var e=this,f={client_id:b.appId,response_type:"token",state:u.stringify({portalUrl:b.portalUrl}),expiration:b.expiration,locale:b.locale,redirect_uri:b.popup?l.getAbsoluteUrl(b.popupCallbackUrl):window.location.href.replace(/#.*$/,"")};b.forceLogin&&(f.force_login=!0);b.showSocialLogins&&(f.showSocialLogins=!0);var g=b.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",h=g+"?"+d.objectToQuery(f);if(b.popup){var k;7===r("ie")?(k=window.open(b.popupCallbackUrl,
"esriJSAPIOAuth",b.popupWindowFeatures),k.location=h):k=window.open(h,"esriJSAPIOAuth",b.popupWindowFeatures);k?(k.focus(),this._oAuthDfd.oAuthWin_=k,this._oAuthIntervalId=setInterval(function(){if(k.closed){clearInterval(e._oAuthIntervalId);var a=e._oAuthDfd;if(a){var b=Error("ABORTED");b.code="IdentityManager.2";b.log=q.isDebug;a.errback(b)}}},500)):(a=Error("ABORTED"),a.code="IdentityManager.2",a.log=q.isDebug,this._oAuthDfd.errback(a))}else this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:f,
authorizeUrl:g,resourceUrl:a,serverInfo:c,oAuthInfo:b}):window.location=h}}})},"builder/tokenUtils":function(){define(["jimu/tokenUtils"],function(p){return p})},"builder/utils":function(){define(["dojo/request/xhr","dojo/cookie","jimu/portalUrlUtils","jimu/utils"],function(p,f,a,l){return{appendParamsToAppPath:function(a,f){var l=a,m;for(m in f)f.hasOwnProperty(m)&&(l=0>l.indexOf("?")?l+"?"+m+"\x3d"+f[m]:l+"\x26"+m+"\x3d"+f[m]);return l},removeActionFromUrl:function(a){return l.url.removeQueryParamFromUrl(a,
"action")},checkProtocolAndUpdateSigninInfo:function(k,h){var l=h.portalUrl,m=l,g="https"===a.getProtocol(l),e=!!k.allSSL;g!==e&&e&&(m=a.setHttpsProtocol(l));h.portalUrl=m;return p("/webappbuilder/rest/signininfo/setsignininfo",{handleAs:"json",data:h,method:"POST"}).then(function(a){a.success&&(f("wab_portalurl",m,{path:"/webappbuilder"}),f("wab_portalurl",m,{path:"/webappviewer"}),f("wab_portalurl_persistent",m,{path:"/",expires:365}));return a})}}})},"builder/PluginManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/Evented dojo/aspect dojo/promise/all jimu/utils".split(" "),
function(p,f,a,l,k,h,q,m,g){var e=null,c=p(h,{constructor:function(a){this.loaded=[];a&&(this.pluginsMeta=a)},loadPlugin:function(a){var c=new k,e;a=f.clone(a);if(e=this.getPluginByName(a.name))c.resolve(e);else{if(!1===a.properties.hasClass)return e={name:a.name},this.loaded.push(e),c.resolve(e),c;this.loadPluginClass(a).then(f.hitch(this,function(e){this.loadPluginResources(a).then(f.hitch(this,function(g){try{var b=this.createPlugin(a,e,g)}catch(h){console.log("create ["+a.uri+"] error:"+h.stack),
c.reject(h)}setTimeout(f.hitch(this,function(){c.resolve(b);this.emit("pluginCreated",b)}),50)}),function(a){c.reject(a)})}),function(a){c.reject(a)})}return c},getExtensions:function(a){var c=[],e;for(e in this.pluginsMeta)for(var f=this.pluginsMeta[e],g=0;g<f.extensions.length;g++){var b=f.extensions[g];b.point===a&&c.push(b)}return c},getStemappInfo:function(a){for(var c=this.getExtensions("startup.stemapps"),e={},f=0;f<c.length;f++){var g=c[f];if(g.parameters.appType===a){var b=this.pluginsMeta[g.pluginName];
e.appPath=g.parameters.appPath?b.folderUrl+g.parameters.appPath:b.folderUrl;e.appVersionManager=g.parameters.appVersionManager;e.appType=a;e.thumbnail=e.appPath+"images/thumbnail.png"}}return e},loadPluginClass:function(a){var c=new k;require([a.uri],f.hitch(this,function(a){c.resolve(a)}));return c},loadPluginResources:function(a){var c=new k,e,g,h=[];e=this.loadPluginI18n(a);g=this.loadPluginStyle(a);a=this.loadPluginTemplate(a);h.push(e);h.push(a);h.push(g);m(h).then(f.hitch(this,function(a){var d=
{};d.i18n=a[0];d.template=a[1];d.style=a[2];c.resolve(d)}),function(a){c.reject(a)});return c},createPlugin:function(a,c,e){if(this.getPluginByName(a.name))return this.getPluginByName(a.name);a.nls=e.i18n||{};e.template&&(a.templateString=e.template);a["class"]="builder-plugin";a.pluginsMeta=this.pluginsMeta;a.pluginManager=this;a=new c(a);q.before(a,"destroy",f.hitch(this,this._onDestroyPlugin,a));this.loaded.push(a);return a},getAllPlugins:function(){return this.loaded},destroyAllPlugins:function(){var c=
a.map(this.loaded,function(a){return a.id});a.forEach(c,function(a){this.destroyPlugin(a)},this);this.loaded=[]},getPluginByName:function(c){var e;a.some(this.loaded,function(a){if(a.name===c)return e=a,!0},this);return e},loadPluginStyle:function(a){var c="plugin/style/"+a.uri,e=new k;if(!1===a.properties.hasStyle)return e.resolve(null),e;c=this._replaceId(c);return l.byId(c)?(e.resolve("load"),e):g.loadStyleLink(c,a.amdFolder+"css/style.css")},loadPluginI18n:function(a){var c=new k;if(!1===a.properties.hasLocale)return c.resolve(null),
c;require(["dojo/i18n!"+a.amdFolder+"nls/strings"],function(a){c.resolve(a)});return c},loadPluginTemplate:function(a){var c=new k;if(!1===a.properties.hasUIFile)return c.resolve(null),c;require(["dojo/text!"+a.amdFolder+"Plugin.html"],function(a){c.resolve(a)});return c},removePluginStyle:function(a){l.destroy(this._replaceId("plugin/style/"+a.uri))},_remove:function(c){return a.some(this.loaded,function(a,e){if(a.id===c)return this.loaded.splice(e,1),!0},this)},_replaceId:function(a){return a.replace(/\//g,
"_").replace(/\./g,"_")},_onDestroyPlugin:function(a){"closed"!==a.state&&this.closePlugin(a);this._removePlugin(a)},_removePlugin:function(a){if("string"===typeof a&&(a=this.getPluginByName(a),!a))return;this.removePluginStyle(a);this._remove(a.id)}});c.getInstance=function(a){null===e?e=new c(a):a&&(e.pluginsMeta=a);return e};return c})},"builder/plugins/_build-generate_plugins_module":function(){define("builder/plugins/app-actions/launch-app/_build-generate_module builder/plugins/app-actions/preview-app/_build-generate_module builder/plugins/app-actions/save-app/_build-generate_module builder/plugins/app-actions/to-template-config/_build-generate_module builder/plugins/app-config/_build-generate_module builder/plugins/app-config-configpart/_build-generate_module builder/plugins/app-config-morepreview-selectionpart/_build-generate_module builder/plugins/app-config-template-configpart/_build-generate_module builder/plugins/app-config-templateconfig/_build-generate_module builder/plugins/app-list/_build-generate_module builder/plugins/attribute-config/_build-generate_module builder/plugins/creation-entry/_build-generate_module builder/plugins/header/_build-generate_module builder/plugins/map-config/_build-generate_module builder/plugins/popup-actions/configmode-switch/_build-generate_module builder/plugins/popup-actions/popup-agoltemplate/_build-generate_module builder/plugins/popup-actions/popup-saveas/_build-generate_module builder/plugins/popup-actions/popup-share/_build-generate_module builder/plugins/startup/_build-generate_module builder/plugins/stemapps/web2d/_build-generate_module builder/plugins/stemapps/web3d/_build-generate_module builder/plugins/theme-config/_build-generate_module builder/plugins/widget-config/_build-generate_module".split(" "),
function(){})},"builder/plugins/app-actions/launch-app/_build-generate_module":function(){define(["builder/plugins/app-actions/launch-app/Plugin","dojo/text!builder/plugins/app-actions/launch-app/css/style.css","dojo/i18n!builder/plugins/app-actions/launch-app/nls/strings"],function(){})},"builder/plugins/app-actions/launch-app/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/topic builder/BasePlugin dojo/_base/html jimu/portalUrlUtils jimu/utils builder/utils".split(" "),
function(p,f,a,l,k,h,q,m,g){return p([k],{baseClass:"plugin-app-actions-launch-app",postCreate:function(){this.inherited(arguments);var a;if(window.isXT)a=window.appInfo.appPath;else{var c=m.urlToObject(window.location.href).query||{};a="HTML3D"===window.appInfo.appType?"webappviewer3d":"webappviewer";a=c.appid?window.portalUrl+"apps/"+a+"/index.html?appid\x3d"+window.appInfo.id:window.portalUrl+"apps/"+a+"/index.html?id\x3d"+window.appInfo.id;delete c.id;delete c.appid;delete c.apiurl;delete c.apiurl3d;
delete c.edit;delete c.folderid;a=g.appendParamsToAppPath(a,c)}c=h.create("a",{href:a,target:"_blank"},this.domNode);h.create("div",{"class":"footer-button",title:this.nls.label,innerHTML:this.nls.label},c);this._bindEvent()},_bindEvent:function(){this.own(l.subscribe("app/appConfigLoaded",f.hitch(this,this._setAppConfig)));this.own(l.subscribe("app/appConfigChanged",f.hitch(this,this._setAppConfig)))},_setAppConfig:function(a){this.appConfig=a;this.visible=a.templateConfig&&!a.isTemplateApp&&!a._appData?
!1:!0}})})},"builder/BasePlugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),function(p,f,a,l,k,h){return p([k,h],{id:void 0,folderUrl:null,state:"closed",windowState:"normal",started:!1,name:"",baseClass:null,templateString:"\x3cdiv\x3e\x3c/div\x3e",constructor:function(){this.extensions={};this.own(l.subscribe("publishData",f.hitch(this,this._onReceiveData)));this.own(l.subscribe("dataFetched",f.hitch(this,
this._onReceiveData)));this.own(l.subscribe("noData",f.hitch(this,this._onNoData)))},getPluginsMetaByExtensionPoint:function(f){var h=[];a.forEach(this.extensionPoints[f].extensions,function(a){h.push(this.pluginsMeta[a.pluginName])},this);return h},filterExtensionsByAppType:function(f,h){if(!this.extensionPoints[f].parameters||!this.extensionPoints[f].parameters.supportAppTypes)return this.extensionPoints[f].extensions;var g=[];a.forEach(this.extensionPoints[f].extensions,function(a){("all"===a.parameters.supportAppTypes||
-1<a.parameters.supportAppTypes.indexOf(h))&&g.push(a)},this);return g},onOpen:function(){},onClose:function(){},onNormalize:function(){},onMinimize:function(){},onMaximize:function(){},onSignIn:function(a){},onSignOut:function(){},setState:function(a){this.state=a},setWindowState:function(a){this.windowState=a},resize:function(){},publishData:function(a,f){"undefined"===typeof f&&(f=!1);l.publish("publishData",this.name,this.id,a,f)},fetchData:function(f){f?l.publish("fetchData",f):0!==this.listenWidgetIds.length?
a.forEach(this.listenWidgetIds,function(a){l.publish("fetchData",a)},this):l.publish("fetchData")},fetchDataByName:function(f){f=this.widgetManager.getWidgetsByName(f);a.forEach(f,function(a){this.fetchData(a.id)},this)},_onReceiveData:function(a,f,g,e){if(f!==this.id&&!(0!==this.listenWidgetIds.length&&0>this.listenWidgetIds.indexOf(f)))this.onReceiveData(a,f,g,e)},onReceiveData:function(a,f,g,e){},_onNoData:function(a,f){if(!(0!==this.listenWidgetIds.length&&0>this.listenWidgetIds.indexOf(f)))this.onNoData(a,
f)},onNoData:function(a,f){}})})},"builder/plugins/app-actions/preview-app/_build-generate_module":function(){define(["builder/plugins/app-actions/preview-app/Plugin","dojo/text!builder/plugins/app-actions/preview-app/Plugin.html","dojo/text!builder/plugins/app-actions/preview-app/css/style.css","dojo/i18n!builder/plugins/app-actions/preview-app/nls/strings"],function(){})},"builder/plugins/app-actions/preview-app/Plugin":function(){define("dojo/_base/declare dojo/_base/lang builder/BasePlugin dojo/_base/html dojo/on dojo/topic".split(" "),
function(p,f,a,l,k,h){return p([a],{baseClass:"plugin-app-actions-preview-app",postCreate:function(){this.inherited(arguments);this.own(k(this.domNode,"click",f.hitch(this,this._onClick)));this._bindEvent();this.mode="config"},_onClick:function(){var a=this.pluginManager.getPluginByName("app-config"),f=this.pluginManager.getPluginByName("popup-actions.configmode-switch");"none"===l.getStyle(this.btnConfig,"display")?(a.switchToPreviewMore(),f.visible=!1,l.setStyle(this.btnPreview,"display","none"),
l.setStyle(this.btnConfig,"display","inline-block"),this.mode="preview"):(f.visible=this.appConfig.templateConfig&&this.appConfig.isTemplateApp||this.appConfig.templateConfig&&this.appConfig._appData?!0:!1,f.isAdvance?a.switchToPreviewConfig():a.switchToTemplateConfigPart(),l.setStyle(this.btnPreview,"display","inline-block"),l.setStyle(this.btnConfig,"display","none"),this.mode="config")},_bindEvent:function(){this.own(h.subscribe("app/appConfigLoaded",f.hitch(this,this._setAppConfig)));this.own(h.subscribe("app/appConfigChanged",
f.hitch(this,this._setAppConfig)))},_setAppConfig:function(a){this.appConfig=a}})})},"builder/plugins/app-actions/save-app/_build-generate_module":function(){define(["builder/plugins/app-actions/save-app/Plugin","dojo/text!builder/plugins/app-actions/save-app/Plugin.html","dojo/text!builder/plugins/app-actions/save-app/css/style.css","dojo/i18n!builder/plugins/app-actions/save-app/nls/strings"],function(){})},"builder/plugins/app-actions/save-app/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic dojo/Deferred dojo/on jimu/utils jimu/dijit/Message jimu/dijit/Popup builder/BasePlugin builder/serviceUtils jimu/portalUrlUtils builder/portalUtils".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r){return p([e],{baseClass:"plugin-app-actions-save-app",lastAppConfig:null,disabled:null,boxNodeOfMainAppActionPlugin:null,boxNodeOfSaveAppPluginInConfigTemplatePage:null,postMixInProperties:function(){this.inherited(arguments);this.nls=f.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);var a=d.getStandardPortalUrl(window.portalUrl);r.getPortal(a).getUser().then(f.hitch(this,function(a){this.username=a.username;this._isGuestAccessApp()&&
this._blockSaveButton()}));this.own(l.subscribe("app/appConfigChanged",f.hitch(this,this._onAppConfigChanged)));this.own(l.subscribe("app/appConfigLoaded",f.hitch(this,this._onAppConfigLoaded)));this.own(l.subscribe("closeAppConfigPage",f.hitch(this,this._onLeavePage)));this.own(h(this.domNode,"click",f.hitch(this,this._onClick)));this.label=this.nls.label},_onClick:function(){this.saveApp()},_isGuestAccessApp:function(){return!this.username||this.username!==window.appInfo.appOwner?!0:!1},_enableSaveButton:function(){a.addClass(this.actionNode,
"save-enable");a.removeClass(this.actionNode,"save-disabled");a.setStyle(this.domNode,"cursor","pointer");a.setAttr(this.actionNode,"innerHTML",this.nls.save);a.setAttr(this.actionNode,"title",this.nls.save);this.disabled=!1},_disableSaveButton:function(){a.removeClass(this.actionNode,"save-enable");a.addClass(this.actionNode,"save-disabled");a.setStyle(this.domNode,"cursor","default");a.setAttr(this.actionNode,"innerHTML",this.nls.saved);a.setAttr(this.actionNode,"title",this.nls.saved);this.disabled=
!0},_blockSaveButton:function(){a.addClass(this.actionNode,"save-block");a.setStyle(this.domNode,"cursor","default")},_onAppConfigLoaded:function(a){this.lastAppConfig=f.clone(a);this._setAppConfig(a)},_onAppConfigChanged:function(a){this.lastAppConfig||(this.lastAppConfig=f.clone(a));this._setAppConfig(a)},_setAppConfig:function(a){this.appConfig=f.clone(a);this._appHasChanged()?(this._enableSaveButton(),this._enableUnloadDlg()):(this._disableSaveButton(),this._disableUnloadDlg())},_appHasChanged:function(){if(this._isGuestAccessApp()||
!this.appConfig)return!1;var a=f.clone(this.appConfig.getCleanConfig()),c=f.clone(this.lastAppConfig.getCleanConfig());a.theme&&(a.theme.styles&&c.theme&&c.theme.styles)&&(a.theme.styles.splice(1,a.theme.styles.length),c.theme.styles.splice(1,c.theme.styles.length));return!q.isEqual(a,c)},saveApp:function(){var c=new k;this._appHasChanged()?(a.setAttr(this.actionNode,"innerHTML",this.nls.saving),a.setAttr(this.actionNode,"title",this.nls.saving),this._saveApp().then(f.hitch(this,function(a){a.success?
(this._disableSaveButton(),this._disableUnloadDlg(),c.resolve()):c.reject()}),f.hitch(this,function(a){this._enableSaveButton();c.reject(a)}))):c.resolve();return c},_saveApp:function(){var a=new k,d=this.appConfig;c.saveApp(window.appInfo.id,d.getCleanConfig()).then(f.hitch(this,function(c){c.success?(this.lastAppConfig=f.clone(d),a.resolve(c),(c=this.pluginManager.getPluginByName("app-list"))&&window.isXT&&c.refreshAppPage()):(new m({message:this.nls.saveFailedMeg+": "+c.message}),a.reject())}),
f.hitch(this,function(c){new m({message:this.nls.saveFailedMeg});console.error(c);a.reject()}));return a},_enableUnloadDlg:function(){window.onbeforeunload=f.hitch(this,function(){return this.nls.theApp+' "'+this.options.name+'" '+this.nls.unloadMessage})},_disableUnloadDlg:function(){window.onbeforeunload=null},_onLeavePage:function(a){var c=this.pluginManager.getPluginByName("header");if(this._appHasChanged())var d=new g({content:"\x3cdiv style\x3d'font-size: 14px'\x3e\x3cimg class\x3d'alert-image jimu-float-leading'  src\x3d'"+
this.folderUrl+"css/images/alert.png'  style\x3d'margin-left:20px;margin-right:20px;'\x3e\x3c/img\x3e\x3cspan style\x3d'display:inline-block;width:285px'\x3e"+this.nls.unSaveMegBegin+this.options.name+this.nls.unSaveMegEnd+"\x3c/span\x3e\x3c/div\x3e",titleLabel:this.nls.toHomeTitle,width:525,height:180,buttons:[{label:this.nls.save,onClick:f.hitch(this,function(){this._saveApp().then(f.hitch(this,function(b){d.close();b.success&&(window.onbeforeunload=null,c.setAppName(""),a())}),f.hitch(this,function(a){console.error(this.nls.saveFailedMeg,
a)}))})},{label:this.nls.doNotSave,onClick:f.hitch(this,function(){d.close();window.onbeforeunload=null;c.setAppName("");a()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:f.hitch(this,function(){d.close()})}]});else window.onbeforeunload=null,a()}})})},"jimu/dijit/Message":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/keys dojo/on jimu/dijit/Popup".split(" "),function(p,f,a,l,k,h){return p(h,{baseClass:"jimu-popup jimu-message",declaredClass:"jimu.dijit.Message",
type:"message",message:"",autoHeight:!0,maxWidth:350,maxHeight:180,postMixInProperties:function(){this.content=this.message},_createTitleNode:function(){this.titleLabel&&(this.titleNode=a.create("div",{"class":"title"},this.domNode),this.titleLabeNode=a.create("span",{"class":"title-label jimu-float-leading",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode),this.closeBtnNode=a.create("div",{"class":"close-btn jimu-float-trailing"},this.titleNode),this.own(k(this.closeBtnNode,"click",f.hitch(this,
this.close))))},_preProcessing:function(){0===this.buttons.length&&this.buttons.push({label:"OK",key:l.ENTER,onClick:f.hitch(this,this.close)})},_increaseZIndex:function(){a.setStyle(this.domNode,"zIndex",501);a.setStyle(this.overlayNode,"zIndex",500)}})})},"jimu/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/on dojo/sniff dojo/touch dojo/query dojo/dnd/move dijit/_WidgetBase jimu/utils".split(" "),function(p,f,a,l,k,h,q,m,g,
e,c,d){var r=0;return p(c,{declaredClass:"jimu.dijit.Popup",baseClass:"jimu-popup",titleLabel:"",content:null,container:null,buttons:[],enabledButtons:[],disabledButtons:[],onClose:null,_fixedHeight:!1,autoHeight:!1,maxHeight:800,maxWidth:1024,constructor:function(){this.buttons=[];this.enabledButtons=[];this.disabledButtons=[];this.pauseKeyHandles=[];this.container=jimuConfig.layoutId},postCreate:function(){this._preProcessing();this.inherited(arguments);this._initDomNode();this._positioning();l.place(this.domNode,
this.container);setTimeout(f.hitch(this,function(){this._moveToMiddle()}),50);this.own(h(window,"resize",f.hitch(this,function(){this._fixedHeight||this.autoHeight?(this._calculatePosition(),this._moveToMiddle()):this._positioning()})));this.overlayNode=l.create("div",{"class":"jimu-overlay"},this.container);this._increaseZIndex();k.animateProperty({node:this.domNode,properties:{opacity:1},duration:200}).play();this.domNode.focus()},_preProcessing:function(){"number"===typeof this.height&&(this._fixedHeight=
!0,this.autoHeight=!1);this.autoHeight&&(this.maxHeight=598)},_createTitleNode:function(){this.titleNode=l.create("div",{"class":"title"},this.domNode);this.titleLabeNode=l.create("span",{"class":"title-label jimu-float-leading",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode);this.closeBtnNode=l.create("div",{"class":"close-btn jimu-icon jimu-icon-close jimu-float-trailing"},this.titleNode);var a=null,a="ontouchstart"in document?m.press:"click";this.own(h(this.closeBtnNode,a,f.hitch(this,this.close)))},
_initDomNode:function(){this._createTitleNode();this.contentContainerNode=l.create("div",{"class":"content"},this.domNode);this.content&&("string"===typeof this.content?this.contentContainerNode.innerHTML=this.content:this.content.domNode?(this.content.placeAt(this.contentContainerNode),this.content.popup=this):1===this.content.nodeType&&l.place(this.content,this.contentContainerNode));this.buttonContainer=l.create("div",{"class":"button-container"},this.domNode);0===this.buttons.length&&l.setStyle(this.buttonContainer,
"display","none");for(var a=this.buttons.length-1;-1<a;a--)this._createButton(this.buttons[a]),this.buttons[a].disable&&this.disableButton(a)},_limitButtonsMaxWidth:function(){var c=this.enabledButtons.length;if(0!==c){var d=l.getContentBox(this.buttonContainer),e=l.getMarginExtents(this.enabledButtons[0]),b=l.getPadBorderExtents(this.enabledButtons[0]),g=0,b=8===q("ie")?b.l+b.r:0,g=(d.w-(e.l+e.r+b)*c)/c;0<g&&(a.forEach(this.enabledButtons,f.hitch(this,function(a){l.setStyle(a,"maxWidth",g+"px")})),
a.forEach(this.disabledButtons,f.hitch(this,function(a){l.setStyle(a,"maxWidth",g+"px")})))}},_moveableNode:function(a,c){this.moveable&&(this.moveable.destroy(),this.moveable=null);var d=l.getMarginBox(this.container);d.l=d.l-a+c;d.w+=2*(a-c);this.moveable=new e.boxConstrainedMoveable(this.domNode,{box:d,handle:this.titleNode||this.contentContainerNode,within:!0});this.own(h(this.moveable,"Moving",f.hitch(this,this.onMoving)));this.own(h(this.moveable,"MoveStop",f.hitch(this,this.onMoveStop)))},
_getHeaderBox:function(){return 0===g("#header").length?{t:0,l:0,w:0,h:0}:l.getMarginBox("header")},_getFooterBox:function(){return 0===g(".footer",this.container).length?{t:0,l:0,w:0,h:0}:l.getMarginBox(g(".footer",this.container)[0])},_calculatePosition:function(){var a=l.getContentBox(this.container),c=this._getHeaderBox(),d=this._getFooterBox(),d=a.h-c.h-d.h-40,b=0;b=this._fixedHeight?this.height:this.autoHeight?d-200:this.height=d>this.maxHeight?this.maxHeight:d;d=(d-b)/2+c.h+20;d=d<c.h?c.h:
d;this.width=this.width||this.maxWidth;l.setStyle(this.domNode,{left:(a.w-this.width)/2+"px",top:d+"px",width:this.width+"px"})},_calculateHeight:function(){this.autoHeight?(l.setStyle(this.domNode,"height","auto"),l.addClass(this.contentContainerNode,"content-static"),0===this.buttons.length&&l.setStyle(this.contentContainerNode,{marginBottom:"15px"})):(l.setStyle(this.domNode,"height",this.height+"px"),l.addClass(this.contentContainerNode,"content-absolute"),l.addClass(this.buttonContainer,"button-container-absolute"),
0===this.buttons.length&&l.setStyle(this.contentContainerNode,{bottom:"15px"}));this._moveableNode(this.width,100)},_moveToMiddle:function(){if(this.autoHeight){var a=l.getMarginBox(this.domNode),c=l.getContentBox(this.container),d=this._getHeaderBox(),b=this._getFooterBox(),b=c.h-d.h-b.h-40,e=0,e=a.h||b-200,a=(b-e)/2+d.h+20,a=a<d.h?d.h:a;l.setStyle(this.domNode,{left:(c.w-this.width)/2+"px",top:a+"px",width:this.width+"px"})}},_positioning:function(){this._calculatePosition();this._calculateHeight()},
_increaseZIndex:function(){l.setStyle(this.domNode,"zIndex",r+200+1);l.setStyle(this.overlayNode,"zIndex",r+200);r++},setTitleLabel:function(a){this.titleNode.innerHTML=d.stripHTML(a)},onMoving:function(a){l.setStyle(a.node,"opacity",0.9)},onMoveStop:function(a){l.setStyle(a.node,"opacity",1)},close:function(){if(!(this.onClose&&!1===this.onClose())){var a=this.domNode.parentNode,c=f.clone(this.domNode);l.setStyle(this.domNode,"display","none");l.destroy(this.overlayNode);this.destroy();this.moveable.destroy();
l.place(c,a);k.animateProperty({node:c,properties:{opacity:0},duration:200,onEnd:function(){l.destroy(c)}}).play()}},addButton:function(a){this._createButton(a)},_createButton:function(a){var c=" ";a.classNames&&0<a.classNames.length&&"function"===typeof a.classNames.join&&(c+=a.classNames.join(" "));var d=l.create("div",{"class":"jimu-btn jimu-float-trailing jimu-trailing-margin1 "+c,innerHTML:a.label,title:a.title||a.label},this.buttonContainer);this.enabledButtons.unshift(d);c=l.create("div",{"class":"jimu-btn jimu-state-disabled jimu-float-trailing jimu-trailing-margin1 "+
c,title:a.title||a.label,innerHTML:a.label,style:{display:"none"}},this.buttonContainer);this.disabledButtons.unshift(c);this.own(h(d,"click",f.hitch(this,function(b){if(a.onClick)a.onClick(b);else this.close()})))},setButtonProps:function(a,c){"number"===typeof a&&isFinite(a)||(c=a,a=0);if(c&&0!==this.enabledButtons.length)for(var d in c)"title"===d?(l.setAttr(this.enabledButtons[a],"title",c[d]),l.setAttr(this.disabledButtons[a],"title",c[d])):"label"===d&&(l.setProp(this.enabledButtons[a],"innerHTML",
c[d]),l.setProp(this.disabledButtons[a],"innerHTML",c[d]))},enableButton:function(c){"number"===typeof c&&isFinite(c)&&c<this.enabledButtons.length?(l.setStyle(this.enabledButtons[c],"display","inline-block"),l.setStyle(this.disabledButtons[c],"display","none")):(a.forEach(this.enabledButtons[c],f.hitch(this,function(a){l.setStyle(a,"display","inline-block")})),a.forEach(this.disabledButtons[c],f.hitch(this,function(a){l.setStyle(a,"display","none")})))},disableButton:function(c){"number"===typeof c&&
isFinite(c)&&c<this.disabledButtons.length?(l.setStyle(this.disabledButtons[c],"display","inline-block"),l.setStyle(this.enabledButtons[c],"display","none")):(a.forEach(this.disabledButtons,f.hitch(this,function(a){l.setStyle(a,"display","inline-block")})),a.forEach(this.enabledButtons,f.hitch(this,function(a){l.setStyle(a,"display","none")})))},showButton:function(a){this.enableButton(a)},hideButton:function(c){"number"===typeof c&&isFinite(c)&&c<this.disabledButtons.length?(l.setStyle(this.disabledButtons[c],
"display","none"),l.setStyle(this.enabledButtons[c],"display","none")):(a.forEach(this.disabledButtons,f.hitch(this,function(a){l.setStyle(a,"display","none")})),a.forEach(this.enabledButtons,f.hitch(this,function(a){l.setStyle(a,"display","none")})))}})})},"dojo/dnd/move":function(){define("../_base/declare ../dom-geometry ../dom-style ./common ./Mover ./Moveable".split(" "),function(p,f,a,l,k,h){l=p("dojo.dnd.move.constrainedMoveable",h,{constraints:function(){},within:!1,constructor:function(a,
f){f||(f={});this.constraints=f.constraints;this.within=f.within},onFirstMove:function(a){var h=this.constraintBox=this.constraints.call(this,a);h.r=h.l+h.w;h.b=h.t+h.h;this.within&&(a=f.getMarginSize(a.node),h.r-=a.w,h.b-=a.h)},onMove:function(a,f){var g=this.constraintBox,e=a.node.style;this.onMoving(a,f);f.l=f.l<g.l?g.l:g.r<f.l?g.r:f.l;f.t=f.t<g.t?g.t:g.b<f.t?g.b:f.t;e.left=f.l+"px";e.top=f.t+"px";this.onMoved(a,f)}});k=p("dojo.dnd.move.boxConstrainedMoveable",l,{box:{},constructor:function(a,
f){var g=f&&f.box;this.constraints=function(){return g}}});p=p("dojo.dnd.move.parentConstrainedMoveable",l,{area:"content",constructor:function(h,k){var g=k&&k.area;this.constraints=function(){var e=this.node.parentNode,c=a.getComputedStyle(e),d=f.getMarginBox(e,c);if("margin"==g)return d;var h=f.getMarginExtents(e,c);d.l+=h.l;d.t+=h.t;d.w-=h.w;d.h-=h.h;if("border"==g)return d;h=f.getBorderExtents(e,c);d.l+=h.l;d.t+=h.t;d.w-=h.w;d.h-=h.h;if("padding"==g)return d;h=f.getPadExtents(e,c);d.l+=h.l;d.t+=
h.t;d.w-=h.w;d.h-=h.h;return d}}});return{constrainedMoveable:l,boxConstrainedMoveable:k,parentConstrainedMoveable:p}})},"builder/serviceUtils":function(){define("dojo/_base/lang dojo/request/xhr dojo/Deferred dojo/json dojo/_base/array jimu/utils jimu/portalUrlUtils jimu/portalUtils builder/portalUtils dojo/promise/all builder/tokenUtils".split(" "),function(p,f,a,l,k,h,q,m,g,e,c){function d(a){return f("/webappbuilder/rest/signininfo/getsignininfo",{query:{portalUrl:a},handleAs:"json"})}function r(a){var b=
[];a&&0<a.length&&k.forEach(a,function(a){a&&"string"===typeof a&&(a=q.getServerByUrl(a),b.push(a))});return b}function u(a,b,c,d,e,f){b.title=a.name;b.isWebTier=f;b.authorizedCrossOriginDomains=r(e.authorizedCrossOriginDomains);b.portalUrl=c;b.map.itemId=d;b.geometryService=e.helperServices.geometry.url;b.map.mapOptions||(b.map.mapOptions={});"HTML"===a.appType&&!a.webmap&&(b.map.mapOptions.extent=e.defaultExtent);a="/proxy.js";window.isXT||(a=q.getPortalProxyUrl(b.portalUrl),a=q.removeProtocol(a));
b.httpProxy={useProxy:!0,url:a}}function s(b,c,d){var e=new a,f=new a,h={title:b.name,type:"Web Mapping Application",typeKeywords:"Web AppBuilder, Ready To Use, JavaScript, "+("HTML"===b.appType?"WAB2D":"WAB3D"),text:l.stringify(c),snippet:b.description,tags:b.tags},n=q.getStandardPortalUrl(window.portalUrl),k=g.getPortal(n);k.getUser().then(function(a){b.folderId===a.username&&(b.folderId="");var c={q:"owner:"+a.username+" title:"+h.title+' type:"Web Mapping Application"'};d?f.resolve(a):k.queryItems(c).then(function(b){0<
b.total?(f.reject(),e.resolve({success:!1,unsuccessCode:"01-01"})):f.resolve(a)},function(a){f.reject();e.reject(a)})},function(a){f.reject();e.reject(a)});f.then(function(a){a.addItem(h,b.folderId).then(function(d){d.success?(d.user=a,e.resolve(d),(!c.appConfig||!c.appConfig.templateConfig||!c.appConfig._appData)&&a.addItem({title:b.name,type:"Code Attachment",typeKeywords:"Code, Web Mapping Application, Javascript",relationshipType:"WMA2Code",originItemId:d.id,url:q.getItemUrl(q.getPortalUrlFromLocation(),
d.id)+"/package"},b.folderId).then(function(a){a.success||console.error(builderNls.createCodeAttachmentError)},function(a){console.error(builderNls.createCodeAttachmentError,a.message)})):e.resolve(d)},function(a){e.reject(a)})});return e}function t(c){var d=new a;f(window.stemappInfo.name+"/"+c+"/list.json",{handleAs:"json"}).then(function(a){return b(a,c).then(function(a){d.resolve({success:!0,manifests:a})})},function(a){d.reject({success:!1,message:a.message})});return d}function b(b,c){var d=
[],g=new a;b._buildInfo&&b._buildInfo.manifestsMerged?f(window.stemappInfo.name+"/"+c+"/"+c+"-manifest-builder.json",{handleAs:"json"}).then(function(a){var h=[];k.forEach(b[c],function(b){var e;(e="themes"===c?a["themes/"+b+"/main"]:a["widgets/"+b+"/Widget"])?h.push(e):d.push(f(window.stemappInfo.name+"/"+c+"/"+b+"/manifest.json",{handleAs:"json"}))});e(d).then(function(a){h=h.concat(a);v(h,c).then(function(){g.resolve(h)})})}):(k.forEach(b[c],function(a){d.push(f(window.stemappInfo.name+"/"+c+"/"+
a+"/manifest.json",{handleAs:"json"}))}),e(d).then(function(a){v(a,c).then(function(){g.resolve(a)})}));return g}function v(b,c){var d=[],f=new a;k.forEach(b,function(a){a.category="widgets"===c?"widget":"theme";a.url=window.stemappInfo.name+"/"+a.category+"s/"+a.name+"/";a.amdFolder=a.category+"s/"+a.name+"/";d.push(n(a))});e(d).then(function(){f.resolve()},function(a){f.reject(a)});return f}function n(a){h.manifest.addManifestProperies(a);return h.manifest.addI18NLabel(a)}var w={},x=["HTML","HTML3D"];
w.checkAppVersion=function(b,c){var d=new a;f("/webappbuilder/rest/apps/checkVersion",{method:"POST",data:{appConfig:l.stringify(b),appType:c.appType},handleAs:"json"}).then(p.hitch(this,function(a){a.success?d.resolve(a):d.reject(a)}),p.hitch(this,function(a){d.reject(a)}));return d.promise};w.importPortalApp=function(b,c){var d=new a;delete b.agolTemplateInfo;f("/webappbuilder/rest/apps/importportalapp",{method:"POST",handleAs:"json",data:{appConfig:l.stringify(b),appInfo:l.stringify(c)}}).then(p.hitch(this,
function(a){a.success?d.resolve(a):d.reject(a)}),p.hitch(this,function(a){d.reject(a)}));return d.promise};w.getTemplateList=function(b){var c=new a,d=q.getStandardPortalUrl(window.portalUrl),e;isXT?(e=g.getPortal(d),e.getUser().then(function(a){f((b?"/webappbuilder/rest/apps/templatelist?portalUrl\x3d"+d:"/webappbuilder/rest/apps/templatelist?username\x3d"+a.username+"\x26portalUrl\x3d"+d)+"\x26locale\x3d"+dojoConfig.locale,{handleAs:"json"}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},
function(a){c.reject(a)})):c.resolve([]);return c};w.getAppList=function(){var b=new a,c=q.getStandardPortalUrl(window.portalUrl),d;isXT?(d=g.getPortal(c),d.getUser().then(function(a){f("/webappbuilder/rest/apps/list?username\x3d"+a.username+"\x26portalUrl\x3d"+c,{handleAs:"json"}).then(function(a){b.resolve(a)},function(a){b.reject(a)})},function(a){b.reject(a)})):(d=g.getPortal(c))?d.getUser().then(function(a){a.getItemsByKeywords("Web AppBuilder").then(function(a){var c=[];(a=a&&a.results)&&0<
a.length&&(c=k.map(a,function(a){return{name:a.title,description:a.description,id:a.id}}));b.resolve(c)},function(a){console.error(a);b.reject({success:!1,message:""})})},function(a){console.error(a);b.reject({success:!1,message:""})}):b.reject({success:!1,message:""});return b};w.getAppInfo=function(b){var c=new a;if(isXT)return-1<x.indexOf(b)?(c.resolve({id:b,appType:b,name:"stem app"}),c):f("/webappbuilder/rest/apps/"+b,{handleAs:"json"});var d=q.getStandardPortalUrl(window.portalUrl);if(-1<x.indexOf(b))return c.resolve({id:b,
appType:b,name:"stem app"}),c;g.getPortal(d).getItemById(b).then(function(a){var b;b=0<=a.typeKeywords.indexOf("Web AppBuilder")?0<=a.typeKeywords.indexOf("WAB3D")?"HTML3D":"HTML":a.url&&0<=a.url.indexOf("webappviewer3d")?"HTML3D":"HTML";c.resolve({name:a.title,description:a.description,id:a.id,owner:a.owner,appType:b})});return c};w.updateApp=function(b){var c=new a,d=q.getStandardPortalUrl(window.portalUrl);isXT?g.getPortal(d).getUser().then(function(a){f("/webappbuilder/rest/apps/updateapp",{handleAs:"json",
method:"POST",data:{id:b.id,name:b.name,description:b.description,modified:a.username||"",creator:b.creator,thumbnail:b.thumbnail,icon:b.icon,portalUrl:d}}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){c.reject(a)}):c.resolve({success:!0});return c};w.createApp=function(b){var h=new a,n,k=q.getStandardPortalUrl(window.portalUrl),l=g.getPortal(k);n=l.loadSelfInfo();var r=l.getUser(),l=null;b.webmap?(l=new a,l.resolve(b.webmap)):b.webscene?(l=new a,l.resolve(b.webscene)):l=
"HTML3D"===b.appType?g.getDefaultWebScene(k):g.getDefaultWebMap(k);if(isXT){var m=d(k);n=[n,r,l,m];e(n).then(function(a){var c=a[0],d=a[1],e=a[2];a=a[3];var g={map:{}};u(b,g,q.getStandardPortalUrl(a.info.portalUrl),e,c,a.info.isWebTier?!0:!1);f("/webappbuilder/rest/apps/createapp",{handleAs:"json",method:"POST",data:{name:b.name,description:b.description,creator:d.username||"",modified:d.username||"",extraPropertyOfAppConfig:JSON.stringify(g),portalUrl:k,fromAppId:b.fromAppId,icon:b.icon,thumbnail:b.thumbnail}}).then(function(a){h.resolve(a)},
function(a){h.reject(a)})},function(a){console.error(a);h.reject({success:!1,message:builderNls.createError})})}else r=w.getPredefinedAppConfig(),m=c.isWebTierPortal(k),n=[n,r,l,m],e(n).then(function(a){var c=a[1];u(b,c,k,a[2],a[0],a[3]);s(b,c,!0).then(function(a){var c=q.getStandardPortalUrl(window.portalUrl);if(a.success)h.resolve({success:!0,newAppId:a.id}),setTimeout(p.hitch(this,function(){a.user.updateItem(a.id,{url:"HTML3D"===b.appType?c+"/apps/webappviewer3d/index.html?id\x3d"+a.id:c+"/apps/webappviewer/index.html?id\x3d"+
a.id}).then(function(a){a.success||console.error(builderNls.createUrlError)},function(a){console.error(builderNls.createUrlError,a.message||"")})}),2E3);else{var d=builderNls.titleExist.replace("${TITLE}",b.name),e;e=b.webmap?c+"/home/webmap/viewer.html?webmap\x3d"+b.webmap:b.webscene?c+"/home/webscene/viewer.html?webmap\x3d"+b.webscene:c+"/home/content.html";switch(a.unsuccessCode){case "01-01":h.resolve({success:!1,message:d,href:e});console.error(builderNls.createError,d);break;default:h.resolve({success:!1,
message:builderNls.createError,href:e}),console.error(builderNls.createError,builderNls.addItemUnsuccess)}}},function(a){h.reject({success:!1,message:builderNls.createError});console.error(builderNls.createError,a.message||"")})},function(a){h.reject({success:!1,message:builderNls.createError});console.error(builderNls.createError,a.message||"")});return h};w.duplicateApp=function(b){var c=new a,d=q.getStandardPortalUrl(window.portalUrl);isXT?g.getPortal(d).getUser().then(function(a){f("/webappbuilder/rest/apps/duplicateapp",
{handleAs:"json",method:"POST",data:{fromAppId:b.fromAppId,creator:a.username||"",modified:a.username||"",portalUrl:d}}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){console.error(builderNls.createError,a);c.reject({message:builderNls.createError})}):c.resolve();return c};w.saveAs=function(b,c){var d=new a,h=q.getStandardPortalUrl(window.portalUrl),n=g.getPortal(h);if(isXT)g.getPortal(h).getUser().then(function(a){f("/webappbuilder/rest/apps/"+b.fromAppId+"/saveas",{handleAs:"json",
method:"POST",data:{name:b.name,description:b.description,fromAppId:b.fromAppId,creator:a.username||"",modified:a.username||"",portalUrl:h,appConfig:l.stringify(c),saveAsTemplate:b.saveAsTemplate,thumbnail:b.thumbnail}}).then(function(a){d.resolve(a)},function(a){d.reject(a)})},function(a){console.error(builderNls.createError,a);d.reject({message:builderNls.createError})});else{var k=p.clone(c).getCleanConfig();delete k.agolTemplateInfo;var r=new a,m=q.getStandardPortalUrl(window.portalUrl),t;c.templateConfig&&
c._appData?n.getItemData(b.fromAppId).then(function(a){t="HTML3D"===b.appType?m+"/apps/webappviewer3d/index.html?appid\x3d":m+"/apps/webappviewer/index.html?appid\x3d";a.appConfig=k;a.values.app_title=k.title;a.values.app_subtitle=k.subtitle;a.values.webmap=k.map.itemId;r.resolve(a)},function(a){r.reject({success:!1,message:a.message})}):(t="HTML3D"===b.appType?m+"/apps/webappviewer3d/index.html?id\x3d":m+"/apps/webappviewer/index.html?id\x3d",r.resolve(k));n=n.getItemById(b.fromAppId);e({itemData:r,
item:n}).then(function(a){var c=a.item;s(b,a.itemData).then(function(a){if(a.success)d.resolve({success:!0,newAppId:a.id}),setTimeout(p.hitch(this,function(){a.user.updateItem(a.id,{url:t+a.id,typeKeywords:c.typeKeywords.join(",")}).then(function(a){},function(a){console.error(builderNls.duplicateUrlError,a.message||"")})}),2E3);else{var e=builderNls.titleExist.replace("${TITLE}",b.name);switch(a.unsuccessCode){case "01-01":d.resolve({success:!1,message:e});console.error(builderNls.saveAsError,e);
break;default:d.resolve({success:!1,message:builderNls.saveAsError}),console.error(builderNls.saveAsError,builderNls.addItemUnsuccess)}}},function(a){d.reject({success:!1,message:builderNls.saveAsError});console.error(builderNls.saveAsError,a.message||"")})},function(a){d.reject({success:!1,message:builderNls.saveAsError});console.error(builderNls.saveAsError,a.message||"")})}return d};w.removeApp=function(a){if(isXT)return f("/webappbuilder/rest/apps/removeapp",{handleAs:"json",method:"POST",data:{id:a}})};
w.saveApp=function(b,c){var h=new a,n=q.getStandardPortalUrl(window.portalUrl),k=g.getPortal(n),s=k.getUser(),m;c.authorizedCrossOriginDomains=r(k.authorizedCrossOriginDomains);isXT?(m=d(n),e({user:s,signininfo:m}).then(function(a){c.portalUrl=q.getStandardPortalUrl(a.signininfo.info.portalUrl);f("/webappbuilder/rest/apps/"+b+"/saveconfig",{data:{appConfig:l.stringify(c),modified:a.user.username},method:"POST",handleAs:"json"}).then(function(a){h.resolve(a)},function(a){h.reject(a)})},function(a){h.reject(a)})):
s.then(function(a){k.getItemData(b).then(function(d){var e;c.templateConfig&&c._appData?(e=d.appConfig,d.appConfig=c,d.values.app_title=c.title,d.values.app_subtitle=c.subtitle,d.values.webmap=c.map.itemId):(e=d,d=c);c.agolTemplateInfo=e?e.agolTemplateInfo:null;c.portalUrl=n;a.updateItem(b,{text:l.stringify(d)}).then(function(a){h.resolve({success:!0,newAppId:a.id})},function(a){h.reject({success:!1,message:a.message})})},function(a){console.error(a.message||a);h.reject({success:!1,message:a.message})});
k.getItemById(b).then(p.hitch(this,function(c){if(!c.url||""===c.url)c=q.getStandardPortalUrl(window.portalUrl),c="HTML3D"===window.appInfo.appType?c+"/apps/webappviewer3d/index.html?id\x3d"+b:c+"/apps/webappviewer/index.html?id\x3d"+b,a.updateItem(b,{url:c}).then(function(a){})}))},function(a){h.reject({success:!1,message:a.message})});return h};w.getPredefinedAppConfig=function(){return f(window.stemappInfo.name+"/predefined-apps/default/config.json",{handleAs:"json"})};w.copyThemeToApp=function(b,
c,d){if(isXT)return-1<x.indexOf(b)?(b=new a,b.resolve({success:!0}),b):f("/webappbuilder/rest/apps/"+b+"/copytheme",{handleAs:"json",method:"POST",data:{themeName:c,layoutConfig:JSON.stringify(d)}});b=new a;b.resolve({success:!0});return b};w.copyWidgetToApp=function(b,c){var d;if(isXT)return-1<x.indexOf(b)?(d=new a,d.resolve({success:!0}),d):f.post("/webappbuilder/rest/apps/"+b+"/copywidget",{data:{widgetName:c},handleAs:"json"});d=new a;d.resolve({success:!0});return d};w.getAllThemes=function(){if(isXT)return f("/webappbuilder/rest/themes/search?q\x3d"+
JSON.stringify({platform:window.stemappInfo.appType}),{handleAs:"json"}).then(function(a){k.forEach(a.themes,function(a){h.manifest.processManifestLabel(a,window.dojoConfig.locale)},this);return a});var b=new a;t("themes").then(function(a){k.forEach(a.manifests,function(a){h.manifest.processManifestLabel(a,window.dojoConfig.locale)},this);b.resolve({success:!0,themes:a.manifests})},function(a){b.reject(a)});return b};w.searchWidgets=function(b){if(isXT)return f("/webappbuilder/rest/widgets/search?q\x3d"+
JSON.stringify(b),{handleAs:"json"}).then(function(a){if(!q.isOnline(window.portalUrl)){var b=!0;window.portalVersion&&0<=m.comparePortalVersion(window.portalVersion,"3.10")&&(b=!1);var c=k.filter(a.widgets,function(a){return"Analysis"===a.name&&b?!1:!0});a.widgets=c}return a});var c=new a;t("widgets").then(function(a){var d=[];k.forEach(a.manifests,function(a){if("undefined"===typeof b["properties.inPanel"]||b["properties.inPanel"]===a.properties.inPanel)(b.support2D===a.support2D||b.support3D===
a.support3D)&&d.push(a)});c.resolve({success:!0,widgets:d})},function(a){c.reject(a)});return c};w.saveAgolTemplate=function(b,c){var d=new a,e=q.getStandardPortalUrl(window.portalUrl);if(isXT)f("/webappbuilder/rest/apps/updateagoltemplateinapp",{handleAs:"json",method:"POST",data:{id:b.id,agolTemplateInfo:l.stringify(c)}}).then(p.hitch(this,function(a){!0===a.success?d.resolve():(console.error("The response of save agol template is 'unsuccess'!"),d.reject("The response of save agol template is 'unsuccess'!"))}),
function(a){console.error(a.message||a);d.reject("Save AGOLTemplate failed!")});else{var h=g.getPortal(e);h.getUser().then(function(a){h.getItemData(b.id).then(function(e){delete e.agolTemplateJson;e.agolTemplateInfo=c;a.updateItem(b.id,{text:l.stringify(e)}).then(function(){d.resolve()},function(a){console.error(a.message||a);d.reject("Save AGOLTemplate failed when updateItem!")})},function(a){console.error(a.message||a);d.reject("Save AGOLTemplate failed when get app's itemData!")})},function(a){console.error(a.message||
a);d.reject("Save AGOLTemplate failed when get current user!")})}return d};return w})},"builder/portalUtils":function(){define(["jimu/portalUtils"],function(p){return p})},"builder/plugins/app-actions/to-template-config/_build-generate_module":function(){define(["builder/plugins/app-actions/to-template-config/Plugin","dojo/text!builder/plugins/app-actions/to-template-config/css/style.css","dojo/i18n!builder/plugins/app-actions/to-template-config/nls/strings"],function(){})},"builder/plugins/app-actions/to-template-config/Plugin":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/topic","dojo/on","builder/BasePlugin"],function(p,f,a,l,k){return p([k],{baseClass:"plugin-app-actions-to-template-config",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"footer-button" title\x3d"${nls.label}" data-dojo-attach-point\x3d"actionNode"\x3e${nls.label}\x3c/div\x3e\x3c/div\x3e',postCreate:function(){this.inherited(arguments);this.visible=!1;this.own(l(this.domNode,"click",f.hitch(this,this._onClick)));this._bindEvent()},_bindEvent:function(){this.own(a.subscribe("app/appConfigLoaded",
f.hitch(this,this._setAppConfig)));this.own(a.subscribe("app/appConfigChanged",f.hitch(this,this._setAppConfig)))},_onClick:function(){this.pluginManager.getPluginByName("app-config").switchToConfigTemplate()},_setAppConfig:function(a){this.appConfig=a;this.visible=a.templateConfig&&!a.isTemplateApp&&!a._appData?!0:!1}})})},"builder/plugins/app-config/_build-generate_module":function(){define(["builder/plugins/app-config/Plugin","dojo/text!builder/plugins/app-config/Plugin.html","dojo/text!builder/plugins/app-config/css/style.css"],
function(){})},"builder/plugins/app-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/topic dojo/promise/all dojo/query builder/utils jimu/utils jimu/WidgetManager jimu/dijit/ViewStack jimu/dijit/LoadingShelter jimu/ConfigLoader jimu/LayerInfos/LayerInfos esri/tasks/GeometryService esri/config builder/BasePlugin".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v){return p([v],{baseClass:"plugin-config-app",_PreviewMoreIframeSrc:"",
_isPortrait:!0,_deviceInfo:null,appId:null,postCreate:function(){this.inherited(arguments);this.atLoading=new r;this.atLoading.placeAt(this.domNode);this.atLoading.show();this.optsLoading=new r({loadingText:"",hidden:!0,showLoading:!1});this.optsLoading.placeAt(this.leftPaneNode);this.republishEvents=[];this.pluginsLoadDefs=[];this._createAppTemplateViewStack();this._createOptsViewStack();this._createPreviewViewStack();this._bindEvent();this.saveTemplatePluginBox=this.saveAppPluginBox=null},startup:function(){this.pluginsLoadDefs.push(this._loadConfigOptsPlugin());
this.pluginsLoadDefs.push(this._loadMorePreviewOptsPlugin());this.pluginsLoadDefs.push(this._loadTemplateConfigOptsPlugin());this.pluginsLoadDefs.push(this._loadConfigTemplatePlugin());this.pluginsLoadDefs.push(this._createMainAppActions());this.pluginsLoadDefs.push(this._createPopupAppActions());this.widgetManager=c.getInstance();this._defineSetConfigViewerTopicFunction();this._defineSetPreviewViewerTopicFunction();this._updateAppId()},addRepublishEvent:function(a){a=a.replace(/\s/g,"");this.own(h.subscribe(a,
f.hitch(this,function(b){this.configViewerTopic.publish("builder/"+a,b)})))},showLoadingCover:function(){this.optsLoading.show()},hideLoadingCover:function(){this.optsLoading.hide()},switchToPreviewConfig:function(){this.optsViewStack.switchView(this.configOptsPaneNode);this.previewViewStack.switchView(this.previewConfig);this.pluginManager.getPluginByName("app-config-template-configpart").visible=!1},switchToTemplateConfigPart:function(){this.optsViewStack.switchView(this.templateOptsPaneNode);this.previewViewStack.switchView(this.previewConfig);
var a=this.pluginManager.getPluginByName("app-config-template-configpart");a.visible=!0;a.refresh()},switchToPreviewMore:function(){this.optsViewStack.switchView(this.morePreviewOptsPaneNode);this.previewViewStack.switchView(this.previewMore);this._showPreviewMore()},switchToConfigApp:function(a){l.setStyle(this.configAppNode,"visibility","visible");a=a||this.appConfig;this.atViewStack.switchView(this.configAppNode);a.templateConfig&&a.isTemplateApp||a.templateConfig&&a._appData?this.switchToTemplateConfigPart():
(a=this.pluginManager.getPluginByName("app-actions.preview-app"))&&"config"!==a.mode?this.switchToPreviewMore():this.switchToPreviewConfig();(a=this.pluginManager.getPluginByName("app-actions.save-app"))&&this.saveAppPluginBox&&l.place(a.domNode,this.saveAppPluginBox);this.pluginManager.getPluginByName("app-config-templateconfig").visible=!1},switchToConfigTemplate:function(){l.setStyle(this.configAppNode,"visibility","hidden");this.atViewStack.switchView(this.configTemplateNode);this.switchToPreviewConfig();
var a=this.pluginManager.getPluginByName("app-actions.save-app");a&&this.saveTemplatePluginBox&&l.place(a.domNode,this.saveTemplatePluginBox);a=this.pluginManager.getPluginByName("app-config-templateconfig");a.visible=!0;a.refresh()},_bindEvent:function(){this.own(h.subscribe("app/preloadWidgetsLoaded",f.hitch(this,this._onPreloadWidgetsLoaded)));this.own(h.subscribe("app/mapCreatedFailed",f.hitch(this,this._onMapCreatedFailed)));this.own(k(this.btnPortrait,"click",f.hitch(this,function(){this._resizePreviewMore(!0)})));
this.own(k(this.btnLandscape,"click",f.hitch(this,function(){this._resizePreviewMore(!1)})));this.own(k(document.body,"click",f.hitch(this,function(){l.setStyle(this.popupActionsMenu,"display","none")})));this.own(h.subscribe("iframeClick",f.hitch(this,function(){l.setStyle(this.popupActionsMenu,"display","none")})));this._bindFrameEvent()},_bindFrameEvent:function(){this.own(k(this.previewConfigFrameNode,"load",f.hitch(this,function(){window.configWindow=this.previewConfigFrameNode.contentWindow;
this.own(k(this.previewConfigFrameNode.contentWindow.document.body,"click",f.hitch(this,function(a){h.publish("iframeClick",a)})))})));this.own(k(this.previewMoreFrameNode,"load",f.hitch(this,function(){window.previewWindow=this.previewMoreFrameNode.contentWindow;this.own(k(this.previewMoreFrameNode.contentWindow.document.body,"click",f.hitch(this,function(a){h.publish("iframeClick",a)})))})))},_createAppTemplateViewStack:function(){this.atViewStack=new d({viewType:"dom",views:[this.configAppNode,
this.configTemplateNode]},this.atViewStackNode)},_createOptsViewStack:function(){this.optsViewStack=new d({viewType:"dom",views:[this.configOptsPaneNode,this.morePreviewOptsPaneNode,this.templateOptsPaneNode]},this.optsViewStackNode)},_createPreviewViewStack:function(){this.previewViewStack=new d({viewType:"dom",views:[this.previewConfig,this.previewMore]},this.rightPreviewSection)},_defineSetConfigViewerTopicFunction:function(){window.setConfigViewerTopic=f.hitch(this,function(a){this.configViewerTopic=
a;this.own(this.configViewerTopic.subscribe("appConfigLoaded",f.hitch(this,this.onAppConfigLoaded)));this.own(this.configViewerTopic.subscribe("appConfigChanged",f.hitch(this,this.onAppConfigChanged)));this.own(this.configViewerTopic.subscribe("mapLoaded",f.hitch(this,this.onMapLoaded)));this.own(this.configViewerTopic.subscribe("mapChanged",f.hitch(this,this.onMapChanged)));this.own(this.configViewerTopic.subscribe("sceneViewLoaded",f.hitch(this.onSceneViewLoaded)));this.own(this.configViewerTopic.subscribe("sceneViewChanged",
f.hitch(this.onSceneViewChanged)));this.own(this.configViewerTopic.subscribe("preloadWidgetsLoaded",f.hitch(this,this.onPreloadWidgetsLoaded)));this.own(this.configViewerTopic.subscribe("mapCreatedFailed",f.hitch(this,this.onMapCreatedFailed)));this._onConfigViewerLoaded()})},_defineSetPreviewViewerTopicFunction:function(){window.setPreviewViewerTopic=f.hitch(this,function(a){this.previewViewerTopic=a;a=f.clone(this.appConfig);a.mode="preview";this.previewViewerTopic.publish("builder/setAppConfig",
a);this.own(this.previewViewerTopic.subscribe("mapLoaded",f.hitch(this,function(){this._syncPreviewMapExtentWithConfigMapExtent()})));this.own(this.previewViewerTopic.subscribe("sceneViewLoaded",f.hitch(this,function(){this._syncPreviewViewpointWithConfigViewpoint()})));this._onPreviewViewerLoaded()})},_loadConfigOptsPlugin:function(){var a=this.filterExtensionsByAppType("config-part",this.options.appInfo.appType),a=this.pluginsMeta[a[0].pluginName];a.options=this.options;return this.pluginManager.loadPlugin(a).then(f.hitch(this,
function(a){l.place(a.domNode,this.configOptsPaneNode);a.startup();return a}))},_loadMorePreviewOptsPlugin:function(){var a=this.filterExtensionsByAppType("morepreview-selction-part",this.options.appInfo.appType);if(0!==a.length)return this.pluginManager.loadPlugin(this.pluginsMeta[a[0].pluginName]).then(f.hitch(this,function(a){l.place(a.domNode,this.morePreviewOptsPaneNode);a.startup();return a}))},_updateAppId:function(){window.jimuConfig.widgetsPackage={name:"widgets",location:window.appInfo.appPath+
"widgets"};window.jimuConfig.themesPackage={name:"themes",location:window.appInfo.appPath+"themes"};window.jimuConfig.configsPackage={name:"configs",location:window.appInfo.appPath+"configs"};var a=e.urlToObject(window.location.href).query||{},b=window.appInfo.appPath+"index.html";delete a.id;window.isXT||a.appid||(b=b+"?id\x3d"+window.appInfo.id);a.mode="preview";this._PreviewMoreIframeSrc=g.appendParamsToAppPath(b,a);a.mode="config";l.attr(this.previewConfigFrameNode,"src",g.appendParamsToAppPath(b,
a))},_onConfigViewerLoaded:function(){q(this.pluginsLoadDefs).then(f.hitch(this,function(){window.stemappInfo.appVersionManager?require([window.appInfo.appPath+window.stemappInfo.appVersionManager],f.hitch(this,function(a){this._loadAppConfig(a)})):this._loadAppConfig()}))},_loadAppConfig:function(a){var b=e.urlToObject(window.location.href).query||{};window.isXT?(delete b.id,b.config=window.appInfo.appPath+"config.json"):(b.appid&&(b.config=window.path+"stemapp/config.json"),"stemapp"===b.id&&(b.config=
window.path+"stemapp/config.json",delete b.id));b.mode="config";u.getInstance(b,{versionManager:a?new a:null}).loadConfig().then(f.hitch(this,function(a){this.atLoading.hide();this.showLoadingCover();a.templateConfig&&a.isTemplateApp||a.templateConfig&&a._appData||!a.templateConfig?(this.switchToConfigApp(a),a.templateConfig?q(this._loadWidgetConfigsInTemplateConfig(a)).then(f.hitch(this,function(){this.configViewerTopic.publish("builder/setAppConfig",a)})):this.configViewerTopic.publish("builder/setAppConfig",
a)):(this.switchToConfigTemplate(),this.configViewerTopic.publish("builder/setAppConfig",a))}))},_loadWidgetConfigsInTemplateConfig:function(b){var c=e.template.getConfigedWidgetsByTemplateConfig(b.templateConfig),d=[];a.forEach(c,function(a){a=b.getConfigElementById(a);d.push(this.widgetManager.tryLoadWidgetConfig(a))},this);return d},_onPreviewViewerLoaded:function(){},_republishBuilderEvents:function(){a.forEach(this.republishEvents,function(a){this.own(h.subscribe(a,f.hitch(this,function(b){this.configViewerTopic.publish(a,
b)})))},this)},previewOnDevice:function(a,b){this._deviceInfo=a;l.setStyle(this.previewMoreDes,"display","block");this.previewMoreDes.innerHTML=b?a.width+" x "+a.height:a.title+" "+a.width+" x "+a.height;this._resizePreviewMore(this._isPortrait)},_createMainAppActions:function(){var b=this.filterExtensionsByAppType("main-app-actions",window.appInfo.appType),c=360/b.length;b.sort(function(a,b){return a.parameters.index-b.parameters.index});a.forEach(b,function(a,b){this._createMainAppActionNode(a,
b,c)},this);return q([])},_createMainAppActionNode:function(a,b,c){0<b&&l.create("div",{"class":"seprate jimu-float-leading"},this.mainActionBoxNode);var d=l.create("div",{"class":"footer-button-box jimu-float-leading",pname:a.pluginName},this.mainActionBoxNode);l.setStyle(d,"width",c+"px");b=this.pluginsMeta[a.pluginName];b.options=this.options.appInfo;return this.pluginManager.loadPlugin(b).then(f.hitch(this,function(b){"app-actions.save-app"===a.pluginName&&(this.saveAppPluginBox=d);l.place(b.domNode,
d);b.startup();return b}))},_refreshAppActions:function(){var b=this.filterExtensionsByAppType("main-app-actions",window.appInfo.appType),c=0;a.forEach(b,function(a){var b=this.pluginManager.getPluginByName(a.pluginName);a=m('div[pname\x3d"'+a.pluginName+'"]',this.mainActionBoxNode)[0];!1===b.visible?l.setStyle(a,"display","none"):(l.setStyle(a,"display",""),c++)},this);var d=360/c,b=m(".footer-button-box",this.mainActionBoxNode);a.forEach(b,function(a){l.setStyle(a,"width",d+"px")})},_createPopupAppActions:function(){var b=
this.filterExtensionsByAppType("popup-app-actions",window.appInfo.appType);b.sort(function(a,b){return a.parameters.index-b.parameters.index});if(0===b.length)l.setStyle(this.btnArrow,"display","none");else{l.setStyle(this.popupActionsMenu,"top",-30*b.length+"px");var c=[];a.forEach(b,function(a){c.push(this._createPopupAppActionNode(a))},this);return q(c)}},_createPopupAppActionNode:function(a){var b=a.parameters,c=l.create("div",{id:a.pluginName},this.popupActionsMenu);return this.pluginManager.loadPlugin(this.pluginsMeta[a.pluginName]).then(f.hitch(this,
function(a){c.innerHTML=a.label;this.own(k(c,"click",f.hitch(a,a[b.onClickAction])));return a}))},_onBtnArrowClick:function(b){if("none"===l.getStyle(this.popupActionsMenu,"display")){l.setStyle(this.popupActionsMenu,"display","block");var c=this.filterExtensionsByAppType("popup-app-actions",window.appInfo.appType),d=0;a.forEach(c,function(a){var b=this.pluginManager.getPluginByName(a.pluginName);a=m('div[id\x3d"'+a.pluginName+'"]',this.popupActionsMenu)[0];a.innerHTML=b.label;!1===b.visible?l.setStyle(a,
"display","none"):(l.setStyle(a,"display",""),d++);b.disabled?l.addClass(a,"disable"):a&&l.removeClass(a,"disable")},this);l.setStyle(this.popupActionsMenu,"top",-30*d+"px")}else l.setStyle(this.popupActionsMenu,"display","none");b.stopPropagation()},_getGeomtryServiceByAppConfig:function(a){return new t(a.geometryService)},onAppConfigLoaded:function(a){a=this._processAppConfig(a);h.publish("app/appConfigLoaded",a);this._refreshAppActions()},onMapLoaded:function(a){s.getInstance(a,a.itemInfo).then(f.hitch(this,
function(){h.publish("app/mapLoaded",a)}))},onMapChanged:function(a){s.getInstance(a,a.itemInfo).then(f.hitch(this,function(){h.publish("app/mapChanged",a)}))},onSceneViewLoaded:function(a){h.publish("app/sceneViewLoaded",a)},onSceneViewChanged:function(a){h.publish("app/sceneViewChanged",a)},onAppConfigChanged:function(a,b,c){a=this._processAppConfig(a);h.publish("app/appConfigChanged",a,b,c);this._refreshAppActions()},onPreloadWidgetsLoaded:function(){h.publish("app/preloadWidgetsLoaded")},onMapCreatedFailed:function(){h.publish("app/mapCreatedFailed")},
_processAppConfig:function(a){a=e.reCreateObject(a);b.defaults.geometryService=this._getGeomtryServiceByAppConfig(a);this.appConfig=a;return window.appConfig=a},_showPreviewMore:function(){this.previewViewStack.switchView(this.previewMore);if(!this.previewMoreFrameNode.src&&this._PreviewMoreIframeSrc)this._initPreviewMoreViewerPosition(),l.attr(this.previewMoreFrameNode,"src",this._PreviewMoreIframeSrc);else{var a=f.clone(this.appConfig);a.mode="preview";this._syncPreviewMapExtentWithConfigMapExtent();
this.previewViewerTopic.publish("builder/setAppConfig",a)}},_syncPreviewMapExtentWithConfigMapExtent:function(){var a=window.configWindow&&window.configWindow._viewerMap,b=window.previewWindow&&window.previewWindow._viewerMap;a&&(b&&this.previewViewerTopic)&&this.previewViewerTopic.publish("builder/syncExtent",a)},_syncPreviewViewpointWithConfigViewpoint:function(){var a=window.configWindow&&window.configWindow._sceneView,b=window.previewWindow&&window.previewWindow._sceneView;a&&(b&&this.previewViewerTopic)&&
this.previewViewerTopic.publish("builder/syncViewpoint",a.viewpoint)},_initPreviewMoreViewerPosition:function(){var a=l.getMarginBox(this.previewMore);l.setStyle(this.previewMoreContainer,{width:a.w-220+"px",height:a.h-130+"px"});l.setStyle(this.previewMoreIframeSection,"marginTop","50px")},_setPreviewMoreViewerPosition:function(){var a=l.getMarginBox(this.previewMore).h,b=l.getMarginBox(this.previewMoreContainer),c=l.getStyle(this.previewMoreContainer,"paddingTop"),d=l.getStyle(this.previewMoreContainer,
"paddingBottom"),a=(a-(b.h+c+d))/2;0>a&&(a=0);l.setStyle(this.previewMoreIframeSection,"marginTop",a+"px")},_resizePreviewMore:function(a){a?this._showPortrait():this._showLandscape();setTimeout(f.hitch(this,function(){this._syncPreviewMapExtentWithConfigMapExtent()}),500)},_showPortrait:function(){this._deviceInfo&&(this._isPortrait=!0,l.setStyle(this.previewMoreContainer,{width:this._deviceInfo.width+44+"px",height:this._deviceInfo.height+44+"px"}),l.addClass(this.btnPortrait,"selected"),l.removeClass(this.btnLandscape,
"selected"),this._setPreviewMoreViewerPosition())},_showLandscape:function(){this._deviceInfo&&(this._isPortrait=!1,l.setStyle(this.previewMoreContainer,{width:this._deviceInfo.height+44+"px",height:this._deviceInfo.width+44+"px"}),l.removeClass(this.btnPortrait,"selected"),l.addClass(this.btnLandscape,"selected"),this._setPreviewMoreViewerPosition())},_onPreloadWidgetsLoaded:function(){this.hideLoadingCover()},_onMapCreatedFailed:function(){this.hideLoadingCover()},_loadTemplateConfigOptsPlugin:function(){var a=
this.filterExtensionsByAppType("template-config-part",this.options.appInfo.appType);if(0!==a.length)return this.pluginManager.loadPlugin(this.pluginsMeta[a[0].pluginName]).then(f.hitch(this,function(a){l.place(a.domNode,this.templateOptsPaneNode);a.startup();return a}))},_loadConfigTemplatePlugin:function(){var a=this.filterExtensionsByAppType("config-template",this.options.appInfo.appType);if(0!==a.length)return this.pluginManager.loadPlugin(this.pluginsMeta[a[0].pluginName]).then(f.hitch(this,function(a){l.place(a.domNode,
this.configTemplateNode);a.startup();this.saveTemplatePluginBox=a.savePluginNode;return a}))}})})},"jimu/WidgetManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/topic dojo/Evented dojo/on dojo/aspect dojo/json dojo/query dojo/request/xhr dojo/promise/all ./utils jimu/tokenUtils ./dijit/Message".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t){var b=null,v=p(q,{constructor:function(){this.loaded=[];this.missedActions=[];this.activeWidget=
null;window.isBuilder?(h.subscribe("app/mapLoaded",f.hitch(this,this._onMapLoaded)),h.subscribe("app/mapChanged",f.hitch(this,this._onMapChanged))):(h.subscribe("mapLoaded",f.hitch(this,this._onMapLoaded)),h.subscribe("mapChanged",f.hitch(this,this._onMapChanged)));window.isBuilder?(h.subscribe("app/sceneViewLoaded",f.hitch(this,this._onSceneViewLoaded)),h.subscribe("app/sceneViewChanged",f.hitch(this,this._onSceneViewChanged))):(h.subscribe("sceneViewLoaded",f.hitch(this,this._onSceneViewLoaded)),
h.subscribe("sceneViewChanged",f.hitch(this,this._onSceneViewChanged)));window.isBuilder?(h.subscribe("app/appConfigLoaded",f.hitch(this,this._onAppConfigLoaded)),h.subscribe("app/appConfigChanged",f.hitch(this,this._onAppConfigChanged))):(h.subscribe("appConfigLoaded",f.hitch(this,this._onAppConfigLoaded)),h.subscribe("appConfigChanged",f.hitch(this,this._onAppConfigChanged)));h.subscribe("userSignIn",f.hitch(this,this._onUserSignIn));h.subscribe("userSignOut",f.hitch(this,this._onUserSignOut));
h.subscribe("builder/actionTriggered",f.hitch(this,this._onActionTriggered));h.subscribe("/dnd/move/start",f.hitch(this,this._onMoveStart))},loadWidget:function(a){var b=new k,c;a=f.clone(a);a.folderUrl||u.widgetJson.processWidgetJson(a);(c=this.getWidgetById(a.id))?b.resolve(c):r([this.loadWidgetClass(a),this.loadWidgetManifest(a)]).then(f.hitch(this,function(a){var c=a[0],d=a[1];this.loadWidgetResources(d).then(f.hitch(this,function(a){try{var e=this.createWidget(d,c,a);l.setAttr(e.domNode,"data-widget-name",
d.name);console.log("widget ["+d.uri+"] created.")}catch(g){console.log("create ["+d.uri+"] error:"+g.stack),new t({message:window.jimuNls.widgetManager.createWidgetError+": "+d.uri}),b.reject(g)}setTimeout(f.hitch(this,function(){b.resolve(e);this.emit("widget-created",e);h.publish("widgetCreated",e)}),50)}),function(a){b.reject(a)})}),function(a){b.reject(a)});return b},loadWidgetClass:function(a){var b=new k;require(u.getRequireConfig(),[a.uri],f.hitch(this,function(a){b.resolve(a)}));u.checkError(a.uri,
b);return b},loadWidgetResources:function(a){var b=new k,c,d,e,g=[];e=f.clone(a);a=this.tryLoadWidgetConfig(e);c=this._tryLoadResource(e,"i18n");d=this._tryLoadResource(e,"style");e=this._tryLoadResource(e,"template");g.push(a);g.push(c);g.push(e);g.push(d);r(g).then(f.hitch(this,function(a){var c={};c.config=a[0];c.i18n=a[1];c.template=a[2];c.style=a[3];b.resolve(c)}),function(a){b.reject(a)});return b},loadWidgetManifest:function(a){var b=new k,c=a.folderUrl+"manifest.json";if(a.manifest)return b.resolve(a),
b;d(c,{handleAs:"json",headers:{"X-Requested-With":null}}).then(f.hitch(this,function(c){c.amdFolder=a.amdFolder;c.category="widget";u.manifest.addI18NLabel(c).then(f.hitch(this,function(){this._processManifest(c);u.widgetJson.addManifest2WidgetJson(a,c);b.resolve(a)}))}),function(a){b.reject(a)});return b},getWidgetMarginBox:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return{};if(a._marginBox)return a._marginBox;a.setPosition({left:-9999,top:-9999,relativeTo:a.position.relativeTo});
this.openWidget(a);a._marginBox=a.getMarginBox();this.closeWidget(a);return a._marginBox},_processManifest:function(a){u.manifest.addManifestProperies(a);u.manifest.processManifestLabel(a,window.dojoConfig.locale)},createWidget:function(a,b,c){if(this.getWidgetById(a.id))return this.getWidgetById(a.id);c.config&&c.i18n&&(c.config=u.replacePlaceHolder(c.config,c.i18n));a.rawConfig=a.config;a.config=c.config||{};this.appConfig._appData&&this._mergeAgolConfig(a);a.nls=c.i18n||{};c.template&&(a.templateString=
c.template);a["class"]="jimu-widget";a.label||(a.label=a.name);this.map&&(a.map=this.map);a.appConfig=this.appConfig;c={};for(var d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);c.widgetManager=this;a=new b(c);a.clazz=b;g.after(a,"startup",f.hitch(this,this._postWidgetStartup,a));g.before(a,"destroy",f.hitch(this,this._onDestroyWidget,a));m(a.domNode,"click",f.hitch(this,this._onClickWidget,a));this.loaded.push(a);return a},getAllWidgets:function(){return this.loaded},destroyAllWidgets:function(){var b=a.map(this.loaded,
function(a){return a.id});a.forEach(b,function(a){this.destroyWidget(a)},this);this.loaded=[]},loadWidgetSettingPage:function(a){var b=new k;a=f.clone(a);a.id+="_setting";r([this.loadWidgetSettingClass(a)]).then(f.hitch(this,function(c){var d=c[0];this.loadWidgetSettingPageResources(a).then(f.hitch(this,function(c){var e;c={nls:c.i18n,templateString:c.template,appConfig:this.appConfig,"class":"jimu-widget-setting"};"HTML3D"===window.appInfo.appType?c.sceneView=this.sceneView:c.map=this.map;for(var h in a)a.hasOwnProperty(h)&&
(c[h]=a[h]);try{e=new d(c),l.setAttr(e.domNode,"data-widget-name-setting",c.name),g.before(e,"destroy",f.hitch(this,this._onDestroyWidgetSetting,e)),b.resolve(e)}catch(k){new t({message:window.jimuNls.widgetManager.createWidgetSettingPageError+":"+a.uri}),b.reject(k)}}),function(a){console.log(a)})}),function(a){b.reject(a)});return b},loadWidgetSettingClass:function(a){var b=new k;require(u.getRequireConfig(),[a.folderUrl+"setting/Setting.js"],f.hitch(this,function(a){b.resolve(a)}));u.checkError(a.folderUrl+
"setting/Setting.js",b);return b},loadWidgetSettingPageResources:function(a){var b=new k,c,d,e=[];a=f.clone(a);c=this._tryLoadResource(a,"settingI18n");d=this._tryLoadResource(a,"settingTemplate");a=this._tryLoadResource(a,"settingStyle");e.push(c);e.push(d);e.push(a);r(e).then(f.hitch(this,function(a){var c={};c.i18n=a[0]||{};c.template=a[1];c.style=a[2];b.resolve(c)}),function(a){console.log(a)});return b},getWidgetById:function(b){var c;a.some(this.loaded,function(a){if(a.id===b)return c=a,!0},
this);return c},getWidgetByLabel:function(b){var c;a.some(this.loaded,function(a){if(a.label===b)return c=a,!0},this);return c},getWidgetsByName:function(b){var c=[];a.some(this.loaded,function(a){a.name===b&&c.push(a)},this);return c},changeWindowStateTo:function(a,b){"normal"===b?this.normalizeWidget(a):"minimized"===b?this.minimizeWidget(a):"maximized"===b?this.maximizeWidget(a):console.log("error state: "+b)},closeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;
if("closed"!==a.state){this.activeWidget&&this.activeWidget.id===a.id&&(this.activeWidget.onDeActive(),this.activeWidget=null);l.setStyle(a.domNode,"display","none");a.setState("closed");try{a.onClose()}catch(b){console.log(console.error("fail to close widget "+a.name+". "+b.stack))}}},openWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;if(!a.started)try{a.started=!0,a.startup()}catch(b){console.error("fail to startup widget "+a.name+". "+b.stack)}if("closed"===a.state){l.setStyle(a.domNode,
"display","");a.setState("opened");try{a.onOpen()}catch(c){console.error("fail to open widget "+a.name+". "+c.stack)}}},activateWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"opened"===a.state&&this._activeWidget(a)},maximizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("maximized");try{a.onMaximize()}catch(b){console.log(console.error("fail to maximize widget "+a.name+". "+b.stack))}},
minimizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("minimized");try{a.onMinimize()}catch(b){console.log(console.error("fail to minimize widget "+a.name+". "+b.stack))}},normalizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("normal");try{a.onNormalize()}catch(b){console.log(console.error("fail to normalize widget "+a.name+
". "+b.stack))}},destroyWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this._removeWidget(a);try{a.destroy()}catch(b){console.log(console.error("fail to destroy widget "+a.name+". "+b.stack))}},tryLoadWidgetConfig:function(a){return this._tryLoadWidgetConfig(a).then(f.hitch(this,function(b){return this._upgradeWidgetConfig(a,b).then(function(b){return a.config=b})}))},triggerWidgetOpen:function(a){function b(a){var d=g.after(a,"onOpen",function(){d.remove();c.resolve(a)})}
var c=new k,d=this.getWidgetById(a);if(d){if("closed"!==d.state)return c.resolve(d),c;b(d)}else var e=h.subscribe("widgetCreated",f.hitch(this,function(b){b.id===a&&(e.remove(),c.resolve(b))}));h.publish("openWidget",a);return c},_tryLoadWidgetConfig:function(a){var b=new k;if(a.config&&f.isObject(a.config))return b.resolve(a.config),b;if(a.config){if(require.cache["url:"+a.config])return b.resolve(e.parse(require.cache["url:"+a.config])),b;b=u.processUrlInAppConfig(a.config);b=b.split("/");b[b.length-
1]=encodeURIComponent(b[b.length-1]);b=b.join("/");return d(b,{handleAs:"json",headers:{"X-Requested-With":null}})}return this._tryLoadResource(a,"config").then(function(b){a.isDefaultConfig=!0;return b})},_upgradeWidgetConfig:function(a,b){var c=new k,d=a.manifest.version,e=a.version,g;if(d===e)return c.resolve(b),c;if(!1===a.hasVersionManager)return a.version=d,c.resolve(b),c;require(u.getRequireConfig(),[a.amdFolder+"VersionManager"],f.hitch(this,function(f){f=new f;var h=f.getVersionIndex(e),
k=f.getVersionIndex(d);if(h>k)c.reject("Bad widget version number, "+a.name+","+e);else try{g=f.upgrade(b,e,d),a.version=d,c.resolve(g)}catch(l){console.log("Read widget ["+a.name+"] old config error,"+l.stack),c.resolve(b)}}));return c},loadWidgetStyle:function(a){var b="widget/style/"+a.uri,c=new k,b=this._replaceId(b);return l.byId(b)?(c.resolve("load"),c):u.loadStyleLink(b,a.styleFile,"theme_"+this.appConfig.theme.name+"_style_common")},loadWidgetSettingStyle:function(a){var b="widget/style/"+
a.uri+"/setting",c=new k,b=this._replaceId(b);return l.byId(b)?(c.resolve("load"),c):u.loadStyleLink(b,a.settingStyleFile)},loadWidgetConfig:function(a){a=require(u.getRequireConfig()).toUrl(a.configFile);if(require.cache["url:"+a]){var b=new k;b.resolve(e.parse(require.cache["url:"+a]));return b}return d(a,{handleAs:"json",headers:{"X-Requested-With":null}})},loadWidgetI18n:function(a){var b=new k;require(u.getRequireConfig(),["dojo/i18n!"+a.i18nFile],function(a){b.resolve(a)});return b},loadWidgetSettingI18n:function(a){var b=
new k;require(u.getRequireConfig(),["dojo/i18n!"+a.settingI18nFile],function(a){b.resolve(a)});return b},loadWidgetTemplate:function(a){var b=new k;require(u.getRequireConfig(),["dojo/text!"+a.templateFile],function(a){b.resolve(a)});u.checkError(a.templateFile,b);return b},loadWidgetSettingTemplate:function(a){var b=new k;require(u.getRequireConfig(),["dojo/text!"+a.settingTemplateFile],function(a){b.resolve(a)});u.checkError(a.settingTemplateFile,b);return b},removeWidgetStyle:function(a){l.destroy(this._replaceId("widget/style/"+
a.uri))},removeWidgetSettingStyle:function(a){l.destroy(this._replaceId("widget/style/"+a.uri+"/setting"))},getControllerWidgets:function(){return a.filter(this.loaded,function(a){return a.isController})},getOffPanelWidgets:function(){return a.filter(this.loaded,function(a){return!a.inPanel})},getOnScreenOffPanelWidgets:function(){return a.filter(this.loaded,function(a){return a.isOnScreen&&!a.inPanel})},closeOtherWidgetsInTheSameGroup:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),
!a))return;for(var b=0;b<this.loaded.length;b++)this.loaded[b].gid===a.gid&&this.loaded[b].id!==a.id&&this.closeWidget(this.loaded[b])},closeAllWidgetsInGroup:function(a){for(var b=0;b<this.loaded.length;b++)this.loaded[b].gid===a&&this.closeWidget(this.loaded[b])},_mergeAgolConfig:function(a){var b=this.appConfig._appData.values,c="widgets["+a.id+"]",d;for(d in b){var e=d.replace(/\//g,"_").indexOf(c+"_config");0<=e&&u.template.setConfigValue(a,d.replace(/\//g,"_").substr(e,d.length).replace(c,"widget"),
b[d])}},_onUserSignIn:function(b){a.forEach(this.loaded,function(a){a.onSignIn(b)},this)},_onUserSignOut:function(){a.forEach(this.loaded,function(a){a.onSignOut()},this)},_activeWidget:function(a){if(this.activeWidget){if(this.activeWidget.id===a.id){!1===this.activeWidget.inPanel&&this.activeWidget.moveTopOnActive&&l.setStyle(this.activeWidget.domNode,"zIndex",101);return}"active"===this.activeWidget.state&&(this.activeWidget.setState("opened"),!1===this.activeWidget.inPanel&&l.setStyle(a.domNode,
"zIndex","zIndex"in a.position?a.position.zIndex:"auto"),this.activeWidget.onDeActive())}this.activeWidget=a;"opened"===this.activeWidget.state&&(this.activeWidget.setState("active"),!1===this.activeWidget.inPanel&&this.activeWidget.moveTopOnActive&&l.setStyle(this.activeWidget.domNode,"zIndex",101),this.activeWidget.onActive(),h.publish("widgetActived",a))},_onClickWidget:function(a,b){var d=c(".jimu-widget",a.domNode);if(0<d.length)for(var e=0;e<d.length;e++)if(b.target===d[e]||l.isDescendant(b.target,
d[e]))return;this._activeWidget(a)},_onMoveStart:function(b){a.forEach(this.loaded,function(a){a.domNode===b.node&&this._activeWidget(a)},this)},_onAppConfigLoaded:function(a){this.appConfig=a=f.clone(a);s.setPortalUrl(a.portalUrl)},_onMapLoaded:function(a){this.map=a},_onMapChanged:function(a){this.map=a},_onSceneViewLoaded:function(a){this.sceneView=a},_onSceneViewChanged:function(a){this.sceneView=a},_onAppConfigChanged:function(b,c,d,e){var g=f.clone(b);this.appConfig=g;a.forEach(this.loaded,
function(a){a&&(a.onAppConfigChanged(g,c,d,e),"widgetChange"===c&&this._onConfigChanged(d.id,d.config,e))},this)},_onConfigChanged:function(a,b){var c=this.getWidgetById(a);c&&(c.onConfigChanged(b),f.mixin(c.config,b))},_onActionTriggered:function(b){if(!("map"===b.elementId||"app"===b.elementId)){var c=this.getWidgetById(b.elementId);if(c)c.onAction(b.action,b.data);else this.missedActions.push({id:b.elementId,action:{name:b.action,data:b.data}});a.forEach(this.getControllerWidgets(),function(a){if(a.widgetIsControlled(b.elementId))a.onAction(b.action,
{widgetId:b.elementId,data:b.data})},this)}},_postWidgetStartup:function(a){a.started=!0;u.setVerticalCenter(a.domNode);g.after(a,"resize",f.hitch(this,u.setVerticalCenter,a.domNode));this.openWidget(a);var b=s.getPortalCredential(this.appConfig.portalUrl);if(b)a.onSignIn(b);else a.onSignOut();this._triggerMissedAction(a)},_triggerMissedAction:function(a){this.missedActions.forEach(function(b){if(b.id===a.id)a.onAction(b.action.name,b.action.data)})},_remove:function(b){return a.some(this.loaded,
function(a,c){if(a.id===b)return this.loaded.splice(c,1),!0},this)},_tryLoadResource:function(a,b){var c,d=new k;if("config"===b)c=a.amdFolder+"config.json",a.configFile=c,c="hasConfig";else if("style"===b)c=a.amdFolder+"css/style.css",a.styleFile=c,c="hasStyle";else if("i18n"===b)c=a.amdFolder+"nls/strings.js",a.i18nFile=a.isRemote?c:a.amdFolder+"nls/strings",c="hasLocale";else if("template"===b)c=a.amdFolder+"Widget.html",a.templateFile=c,c="hasUIFile";else if("settingTemplate"===b)c=a.amdFolder+
"setting/Setting.html",a.settingTemplateFile=c,c="hasSettingUIFile";else if("settingI18n"===b)c=a.amdFolder+"setting/nls/strings.js",a.settingI18nFile=a.amdFolder+"setting/nls/strings",c="hasSettingLocale";else if("settingStyle"===b)c=a.amdFolder+"setting/css/style.css",a.settingStyleFile=c,c="hasSettingStyle";else return d;a[c]?function(){var c;if("config"===b)c=this.loadWidgetConfig(a);else if("style"===b)c=this.loadWidgetStyle(a);else if("i18n"===b)c=this.loadWidgetI18n(a);else if("template"===
b)c=this.loadWidgetTemplate(a);else if("settingTemplate"===b)c=this.loadWidgetSettingTemplate(a);else if("settingStyle"===b)c=this.loadWidgetSettingStyle(a);else if("settingI18n"===b)c=this.loadWidgetSettingI18n(a);else return d;c.then(function(a){d.resolve(a)},function(b){new t({message:window.jimuNls.widgetManager.loadWidgetResourceError+": "+a.uri});d.reject(b)})}.apply(this):d.resolve(null);return d},_replaceId:function(a){return a.replace(/\//g,"_").replace(/\./g,"_")},_onDestroyWidget:function(a){"closed"!==
a.state&&this.closeWidget(a);this._removeWidget(a);this.emit("widget-destroyed",a.id);h.publish("widgetDestroyed",a.id);console.log("destroy widget ["+a.uri+"].")},_onDestroyWidgetSetting:function(a){this.removeWidgetSettingStyle(a)},_removeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this.activeWidget&&this.activeWidget.id===a.id&&(this.activeWidget=null);this._remove(a.id);0===this.getWidgetsByName(a.name).length&&this.removeWidgetStyle(a)}});v.getInstance=function(a){null===
b&&(b=new v(a),window._widgetManager=b);return b};return v})},"jimu/dijit/ViewStack":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dojo/_base/array","dijit/_WidgetBase"],function(p,f,a,l,k){return p(k,{baseClass:"jimu-viewstack",declaredClass:"jimu.dijit.ViewStack",_currentView:null,postCreate:function(){this.inherited(arguments);this.views||(this.views=[]);l.forEach(this.views,f.hitch(this,function(f){1===f.nodeType?(a.place(f,this.domNode),a.addClass(f,"view"),a.setStyle(f,
"display","none")):f.domNode&&(a.place(f.domNode,this.domNode),a.addClass(f.domNode,"view"),a.setStyle(f.domNode,"display","none"))}))},startup:function(){this.inherited(arguments);0<this.views.length&&this.switchView(0)},getSelectedView:function(){return this._currentView},getSelectedLabel:function(){var a="",f=this.getSelectedView();f&&(a=f.label);return a},getViewByLabel:function(a){for(var f=0;f<this.views.length;f++)if(a===this.views[f].label)return this.views[f];return null},addView:function(f){this.views.push(f);
1===f.nodeType?(a.place(f,this.domNode),a.addClass(f,"view")):f.domNode&&(a.place(f.domNode,this.domNode),a.addClass(f.domNode,"view"))},removeView:function(f){var k=this.views.length;this.views=l.filter(this.views,function(a){return f!==a});k!==this.views.length&&(1===f.nodeType?a.destroy(f):f.domNode&&f.destroyRecursive())},switchView:function(h){var k,l;k="number"===typeof h?this.views[h]:"string"===typeof h?this.getViewByLabel(h):h;this.views.forEach(f.hitch(this,function(f){f&&(1===f.nodeType?
l=f:f.domNode&&(l=f.domNode),f===k?(a.setStyle(l,"display","block"),f.domNode&&!f._started&&(f.startup(),f._started=!0)):a.setStyle(l,"display","none"))}));this._currentView=k;this.onViewSwitch(k)},onViewSwitch:function(){}})})},"jimu/dijit/LoadingShelter":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/LoadingShelter.html","dojo/_base/html"],function(p,f,a,l,k){return p([f,a],{baseClass:"jimu-loading-shelter",declaredClass:"jimu.dijit.LoadingShelter",
templateString:l,loadingText:null,hidden:!1,showLoading:!0,postMixInProperties:function(){this.nls=window.jimuNls.loadingShelter},postCreate:function(){this.inherited(arguments);this.hidden&&k.setStyle(this.domNode,"display","none");k.setStyle(this.domNode,{width:"100%",height:"100%"});this.loadingImg.src=require.toUrl("jimu")+"/images/loading2.gif";this.showLoading||k.setStyle(this.imgDiv,"display","none");"string"===typeof this.loadingText&&(this.textNode.innerHTML=this.loadingText)},show:function(a){this.domNode&&
this.hidden&&("string"===typeof a&&(this.textNode.innerHTML=a),k.setStyle(this.domNode,"display","block"),this.hidden=!1)},hide:function(){this.domNode&&!this.hidden&&(k.setStyle(this.domNode,"display","none"),this.hidden=!0)}})})},"jimu/ConfigLoader":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/config dojo/cookie dojo/Deferred dojo/promise/all dojo/request/xhr ./utils ./WidgetManager ./shared/utils ./tokenUtils ./portalUtils ./portalUrlUtils ./AppStateManager esri/IdentityManager esri/config esri/urlUtils esri/arcgis/utils".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w){var x=null,z;z=p(null,{urlParams:null,appConfig:null,rawAppConfig:null,configFile:null,_configLoaded:!1,portalSelf:null,constructor:function(a,b){this._removeHash(a);this.urlParams=a||{};this.widgetManager=c.getInstance();f.mixin(this,b)},loadConfig:function(){console.time("Load Config");return this._tryLoadConfig().then(f.hitch(this,function(a){var b=this.checkConfig(a);if(b)throw Error(b);this.rawAppConfig=f.clone(a);t.getInstance().setRawAppConfig(this.rawAppConfig);
a=this._upgradeAppConfig(a);this._processAfterTryLoad(a);this.appConfig=a;if(this.urlParams.id)return this.loadWidgetsManifest(a).then(f.hitch(this,function(){return this.loadAndUpgradeAllWidgetsConfig(a)})).then(f.hitch(this,function(){this._configLoaded=!0;this._setDocumentTitle(a);return this.getAppConfig()}));r.setPortalUrl(a.portalUrl);w.arcgisUrl=s.getBaseItemUrl(a.portalUrl);return this._proesssWebTierAndSignin(a).then(f.hitch(this,function(){return this.urlParams.appid?window.appInfo.isRunInPortal?
this._getAppConfigFromTemplateAppId(a.portalUrl,this.urlParams.appid).then(f.hitch(this,function(a){this._tryUpdateAppConfigByLocationUrl(a);return this._processInPortalAppProtocol(a)})):this._processNotInPortalAppProtocol(a).then(f.hitch(this,function(a){return this._getAppDataAddTemplateDataFromTemplateAppId(a.portalUrl,this.urlParams.appid).then(f.hitch(this,function(b){b.appData.appConfig&&(a=b.appData.appConfig);a._appData=b.appData;a.templateConfig=b.templateData;a.isTemplateApp=!0;return a}))})):
this._processNotInPortalAppProtocol(a)})).then(f.hitch(this,function(a){this._processAfterTryLoad(a);this.appConfig=a;return a.map.itemId?a:(a.map["3D"]?u.getDefaultWebScene(a.portalUrl):u.getDefaultWebMap(a.portalUrl)).then(function(b){a.map.itemId=b;return a})})).then(f.hitch(this,function(a){return this.loadWidgetsManifest(a)})).then(f.hitch(this,function(a){return a._appData?a._appData.values&&a._appData.values.webmap?u.getPortal(a.portalUrl).getItemById(a._appData.values.webmap).then(f.hitch(this,
function(b){return e.template.mergeTemplateAppConfigToAppConfig(a,a._appData,b)})):e.template.mergeTemplateAppConfigToAppConfig(a,a._appData):a})).then(f.hitch(this,function(a){return this.loadAndUpgradeAllWidgetsConfig(a)})).then(f.hitch(this,function(a){this._configLoaded=!0;this._setDocumentTitle(a);return this.getAppConfig()}))}),f.hitch(this,function(a){this.showError(a)}))},_setDocumentTitle:function(a){!window.isBuilder&&(a&&a.title)&&(document.title=e.stripHTML(a.title))},getAppConfig:function(){var a=
f.clone(this.appConfig);a.getConfigElementById=function(a){return e.getConfigElementById(this,a)};a.getConfigElementsByName=function(a){return e.getConfigElementsByName(this,a)};a.visitElement=function(a){e.visitElement(this,a)};this._addAuthorizedCrossOriginDomains(this.portalSelf,a);return a},_addAuthorizedCrossOriginDomains:function(a,b){a&&a.authorizedCrossOriginDomains&&r.addAuthorizedCrossOriginDomains(a.authorizedCrossOriginDomains);b&&b.authorizedCrossOriginDomains&&r.addAuthorizedCrossOriginDomains(b.authorizedCrossOriginDomains)},
checkConfig:function(a){return(a=this._getRepeatedId(a))?"repeated id:"+a:null},processProxy:function(b){v.defaults.io.alwaysUseProxy=b.httpProxy&&b.httpProxy.useProxy&&b.httpProxy.alwaysUseProxy;v.defaults.io.proxyUrl="";v.defaults.io.proxyRules=[];b.httpProxy&&(b.httpProxy.useProxy&&b.httpProxy.url)&&(v.defaults.io.proxyUrl=b.httpProxy.url);b.httpProxy&&(b.httpProxy.useProxy&&b.httpProxy.rules)&&a.forEach(b.httpProxy.rules,function(a){n.addProxyRule(a)})},addNeedValues:function(a){this._processNoUriWidgets(a);
this._addElementId(a);this._processWidgetJsons(a)},showError:function(a){a&&a.message&&l.create("div",{"class":"app-error",innerHTML:a.message},document.body)},_tryLoadConfig:function(){"stemapp"===this.urlParams.id&&(this.urlParams.config=window.appInfo.appPath+"config.json",delete this.urlParams.id);if(this.urlParams.config)return this.configFile=this.urlParams.config,g(this.configFile,{handleAs:"json",headers:{"X-Requested-With":null}}).then(f.hitch(this,function(a){r.setPortalUrl(a.portalUrl);
return this.urlParams.token?r.registerToken(this.urlParams.token).then(function(){return a}):a}));if(this.urlParams.id){window.appInfo.isRunInPortal=!0;var a=s.getPortalUrlFromLocation(),b=new q;r.setPortalUrl(a);w.arcgisUrl=s.getBaseItemUrl(a);var c;this.urlParams.token?c=r.registerToken(this.urlParams.token):(c=new q,c.resolve());c.then(f.hitch(this,function(){u.getPortal(a).loadSelfInfo().then(f.hitch(this,function(c){this.portalSelf=c;c.allSSL&&"http:"===window.location.protocol?(console.log("redirect from http to https"),
window.location.href=s.setHttpsProtocol(window.location.href),b.reject()):this._processSignIn(a).then(f.hitch(this,function(){this._getAppConfigFromAppId(a,this.urlParams.id).then(f.hitch(this,function(a){this._tryUpdateAppConfigByLocationUrl(a);return this._processInPortalAppProtocol(a)})).then(function(a){b.resolve(a)},function(a){b.reject(a)})}))}))}),f.hitch(this,function(a){this.showError(a)}));return b}this.configFile="config.json";return g(this.configFile,{handleAs:"json"}).then(f.hitch(this,
function(a){r.setPortalUrl(a.portalUrl);return this.urlParams.token?r.registerToken(this.urlParams.token).then(function(){return a}):a}))},_upgradeAppConfig:function(a){var b=window.wabVersion,c=a.wabVersion;if(b===c)return a;var d=this.versionManager.getVersionIndex(c),e=this.versionManager.getVersionIndex(b);if(d>e)throw Error("Bad version number, "+c);a=this.versionManager.upgrade(a,c,b);a.wabVersion=b;return a},loadAndUpgradeAllWidgetsConfig:function(a){var b=new q,c=[];d.visitElement(a,f.hitch(this,
function(a){a.uri&&(a=this.widgetManager.tryLoadWidgetConfig(a),c.push(a))}));m(c).then(f.hitch(this,function(){b.resolve(a)}),function(a){b.reject(a)});return b},_processAfterTryLoad:function(a){this._setPortalUrl(a);this._tryUpdateAppConfigByLocationUrl(a);this._processUrlParams(a);this.addNeedValues(a);this.processProxy(a);b.tokenValidity=10080;return a},_tryUpdateAppConfigByLocationUrl:function(a){if(!(this.urlParams.config&&-1<this.urlParams.config.indexOf("arcgis.com/sharing/rest/content/items/"))){var b=
s.getPortalUrlFromLocation(),b=s.getStandardPortalUrl(b);s.isOnline(b)&&(b=s.updateUrlProtocolByOtherUrl(b,a.portalUrl),a.map.portalUrl&&s.isSamePortalUrl(a.portalUrl,a.map.portalUrl)&&(a.map.portalUrl=b),a.portalUrl=b,a.httpProxy&&a.httpProxy.url&&(a.httpProxy.url=s.getPortalProxyUrl(b)))}},_processWidgetJsons:function(a){d.visitElement(a,function(a,b){b.isWidget&&a.uri&&e.widgetJson.processWidgetJson(a)})},_processNoUriWidgets:function(a){var b=0;d.visitElement(a,function(a,c){c.isWidget&&!a.uri&&
(b++,a.placeholderIndex=b)})},_addElementId:function(a){var b=0,c;d.visitElement(a,function(a){if(a.id){a.id=a.id.replace(/\//g,"_");var d=a.id.lastIndexOf("_");-1<d&&(c=a.id.substr(d+1),b=Math.max(b,c))}});d.visitElement(a,function(a){a.id||(b++,a.id=a.uri?a.uri.replace(/\//g,"_")+"_"+b:"_"+b)})},_setPortalUrl:function(a){if(a.portalUrl){var b=s.getPortalUrlFromLocation(),c=s.isOnline(b);!s.isSamePortalUrl(a.portalUrl,b)&&!c&&(window.appInfo.isRunInPortal=!1)}else window.isXT&&h("wab_portalurl")?
a.portalUrl=h("wab_portalurl"):(window.appInfo.isRunInPortal=!0,a.portalUrl=s.getPortalUrlFromLocation())},_changePortalUrlProtocol:function(b,c){b.portalUrl=s.setProtocol(b.portalUrl,c);b.map.portalUrl&&(b.map.portalUrl=s.setProtocol(b.map.portalUrl,c));b.httpProxy&&(b.httpProxy.url=s.setProtocol(b.httpProxy.url,c),b.httpProxy&&b.httpProxy.rules&&a.forEach(b.httpProxy.rules,f.hitch(this,function(a){a.proxyUrl=s.setProtocol(a.proxyUrl,c)})))},_processInPortalAppProtocol:function(a){var b=new q,c=
u.getPortal(a.portalUrl),d=f.hitch(this,function(c){if("https:"===window.location.protocol)this._changePortalUrlProtocol(a,"https");else{if(c){console.log("redirect from http to https");window.location.href=s.setHttpsProtocol(window.location.href);b.reject();return}this._changePortalUrlProtocol(a,"http")}this._checkLocale();b.resolve(a)});c.loadSelfInfo().then(f.hitch(this,function(b){"private"===b.access?(b=0===a.portalUrl.toLowerCase().indexOf("https://"),d(b)):d(b.allSSL)}),f.hitch(this,function(a){b.reject(a)}));
return b},_processNotInPortalAppProtocol:function(a){var b=new q;a.portalUrl?u.getPortal(a.portalUrl).loadSelfInfo().then(f.hitch(this,function(c){var d="https:"===window.location.protocol;(c.allSSL||d)&&this._changePortalUrlProtocol(a,"https");0===a.portalUrl.toLowerCase().indexOf("https://")&&!d&&!r.isInConfigOrPreviewWindow()?(console.log("redirect from http to https"),window.location.href=s.setHttpsProtocol(window.location.href),b.reject()):b.resolve(a)}),f.hitch(this,function(a){b.reject(a)})):
b.resolve(a);return b},_proesssWebTierAndSignin:function(a){var b=new q,c=!1,d=a.portalUrl;this._processWebTier(a).then(f.hitch(this,function(a){c=a;return u.getPortal(d).loadSelfInfo()})).then(f.hitch(this,function(a){this.portalSelf=a;return this._processSignIn(d,c)})).then(f.hitch(this,function(){b.resolve()}),function(a){b.reject(a)});return b},_processWebTier:function(a){var b=new q,c=a.portalUrl;a.isWebTier?(r.addAuthorizedCrossOriginDomains([c]),r.isWebTierPortal(c).then(f.hitch(this,function(){var d=
r.getPortalCredential(c);d&&d.ssl&&"http:"===window.location.protocol&&!r.isInConfigOrPreviewWindow()?(console.log("redirect from http to https"),window.location.href=s.setHttpsProtocol(window.location.href)):b.resolve(a.isWebTier)}),f.hitch(this,function(a){b.reject(a)}))):b.resolve(!1);return b},_processSignIn:function(a,c){var d=new q,e=u.getPortal(a),g=s.getSharingUrl(a);window.appInfo.isRunInPortal?(g=b.checkSignInStatus(g),g.promise.always(f.hitch(this,function(){d.resolve()}))):(!r.isInBuilderWindow()&&
(!r.isInConfigOrPreviewWindow()&&this.portalSelf.supportsOAuth&&this.rawAppConfig.appId&&!c)&&r.registerOAuthInfo(a,this.rawAppConfig.appId),g=b.checkSignInStatus(g),g.promise.always(f.hitch(this,function(){r.xtGetCredentialFromCookie(a);e.loadSelfInfo().then(f.hitch(this,function(a){this.portalSelf=a;this._checkLocale();d.resolve()}))})));return d},_checkLocale:function(){if(!r.isInConfigOrPreviewWindow()){var a=this.portalSelf.user&&this.portalSelf.user.culture||k.locale,a=a.toLowerCase();!this.urlParams.locale&&
e.isLocaleChanged(k.locale,a)&&(h("wab_app_locale",a),window.location.reload())}},_getAppConfigFromTemplateAppId:function(a,b){var c=u.getPortal(a);return this._getWabAppIdAndDataFromTemplateAppId(a,b).then(f.hitch(this,function(b){var d=b.appData;return m([this._getAppConfigFromAppId(a,b.appId),c.getItemData(d.source)]).then(f.hitch(this,function(a){var b;d.appConfig?(b=d.appConfig,delete d.appConfig):b=a[0];b=this._upgradeAppConfig(b);a=a[1];b._appData=d;b.templateConfig=a;b.isTemplateApp=!0;return b}))}))},
_getAppDataAddTemplateDataFromTemplateAppId:function(a,b){var c=u.getPortal(a);return c.getItemData(b).then(function(a){return c.getItemData(a.source).then(function(b){return{appData:a,templateData:b}})})},_getWabAppIdAndDataFromTemplateAppId:function(a,b){var c=new q,d=u.getPortal(a);d.getItemData(b).then(f.hitch(this,function(a){d.getItemById(a.source).then(f.hitch(this,function(b){b=n.urlToObject(b.url);c.resolve({appId:b.query.id,appData:a})}))}),function(a){c.reject(a)});return c},_getAppConfigFromAppId:function(a,
b){return u.getPortal(a).getItemData(b)},_removeHash:function(a){for(var b in a)a[b]&&(a[b]=a[b].replace("#",""))},loadWidgetsManifest:function(a){var b=[],c=new q;a._buildInfo&&a._buildInfo.widgetManifestsMerged?this._loadMergedWidgetManifests().then(f.hitch(this,function(g){d.visitElement(a,f.hitch(this,function(a){!a.widgets&&a.uri&&(g[a.uri]?(this._addNeedValuesForManifest(g[a.uri]),e.widgetJson.addManifest2WidgetJson(a,g[a.uri])):b.push(this.widgetManager.loadWidgetManifest(a)))}));m(b).then(function(){c.resolve(a)})})):
(d.visitElement(a,f.hitch(this,function(a){!a.widgets&&a.uri&&b.push(this.widgetManager.loadWidgetManifest(a))})),m(b).then(function(){c.resolve(a)}));setTimeout(function(){function b(a){function c(b){a[b]&&a[b].widgets&&(a[b].widgets=a[b].widgets.filter(function(a){a.uri&&!a.manifest&&console.error("Widget is removed because it is not loaded successfully.",a.uri);return a.manifest}));a[b]&&a[b].groups&&a[b].groups.forEach(function(a){a.widgets&&(a.widgets=a.widgets.filter(function(a){a.uri&&!a.manifest&&
console.error("Widget is removed because it is not loaded successfully.",a.uri);return a.manifest}))})}c("widgetOnScreen");c("widgetPool")}c.isResolved()||(b(a),c.resolve(a))},6E4);return c},_addNeedValuesForManifest:function(a){e.manifest.addManifestProperies(a);e.manifest.processManifestLabel(a,k.locale)},_loadMergedWidgetManifests:function(){return g(window.appInfo.appPath+"widgets/widgets-manifest.json",{handleAs:"json"})},_getRepeatedId:function(a){var b=[],c;d.visitElement(a,function(a){if(0<=
b.indexOf(a.id))return c=a.id,!0;b.push(a.id)});return c},_processUrlParams:function(a){var b=this.urlParams.itemid||this.urlParams.webmap;b&&a.map.itemId!==b&&(a.map.mapOptions&&e.deleteMapOptions(a.map.mapOptions),a.map.itemId=b);this.urlParams.mode&&(a.mode=this.urlParams.mode);a.map.mapOptions||(a.map.mapOptions={});this.urlParams.scale&&(a.map.mapOptions.scale=this.urlParams.scale);if(this.urlParams.level||this.urlParams.zoom)a.map.mapOptions.zoom=this.urlParams.level||this.urlParams.zoom}});
z.getInstance=function(a,b){null===x?x=new z(a,b):(x.urlParams=a,x.options=b);return x};return z})},"jimu/AppStateManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/json esri/geometry/Extent esri/SpatialReference libs/storejs/store libs/md5/md5 jimu/tokenUtils".split(" "),function(p,f,a,l,k,h,q,m,g){var e=null,c=p(null,{rawAppConfig:null,mapMd5:null,appStateKey:null,setRawAppConfig:function(a){this.rawAppConfig=a},_getAppStateMd5:function(){if("string"!==typeof this.mapMd5){var a=
l.stringify(this.rawAppConfig.map);this.mapMd5=m(a)}return this.mapMd5},_getAppStateKey:function(){return this.appStateKey?this.appStateKey:this.appStateKey="wab_appstate_"+this.urlParams.id||this.urlParams.appid||window.path},getWabAppState:function(){var c=new a,e={};if(g.isInConfigOrPreviewWindow()||!this.rawAppConfig||!this.rawAppConfig.map)return c.resolve(e),c;var f=this._getAppStateKey(),l=q.get(f);l&&l.appStateMd5===this._getAppStateMd5()?(f=l.map&&l.map.extent,l=l.map&&l.map.layers,f&&(e.extent=
new k(f.xmin,f.ymin,f.xmax,f.ymax,new h(f.spatialReference))),l&&(e.layers=l)):q.remove(f);c.resolve(e);return c},saveWabAppState:function(a,c){if(a&&!g.isInConfigOrPreviewWindow()){var e=this._getAppStateKey(),h={extent:{xmin:a.extent.xmin,xmax:a.extent.xmax,ymin:a.extent.ymin,ymax:a.extent.ymax,spatialReference:{wkid:a.extent.spatialReference.wkid,wkt:a.extent.spatialReference.wkt}},layers:{}};c&&c.traversal&&c.traversal(f.hitch(this,function(a){h.layers[a.id]={visible:a.isVisible()}}));q.set(e,
{map:h,appStateMd5:this._getAppStateMd5()})}}});c.getInstance=function(a){null===e&&(e=new c);e.urlParams=a;return e};return c})},"libs/storejs/store":function(){(function(p){var f={},a=p.document,l;f.disabled=!1;f.set=function(a,c){};f.get=function(a){};f.remove=function(a){};f.clear=function(){};f.transact=function(a,c,d){var e=f.get(a);null==d&&(d=c,c=null);"undefined"==typeof e&&(e=c||{});d(e);f.set(a,e)};f.getAll=function(){};f.forEach=function(){};f.serialize=function(a){return JSON.stringify(a)};
f.deserialize=function(a){if("string"==typeof a)try{return JSON.parse(a)}catch(c){return a||void 0}};var k;try{k="localStorage"in p&&p.localStorage}catch(h){k=!1}if(k)l=p.localStorage,f.set=function(a,c){if(void 0===c)return f.remove(a);l.setItem(a,f.serialize(c));return c},f.get=function(a){return f.deserialize(l.getItem(a))},f.remove=function(a){l.removeItem(a)},f.clear=function(){l.clear()},f.getAll=function(){var a={};f.forEach(function(c,d){a[c]=d});return a},f.forEach=function(a){for(var c=
0;c<l.length;c++){var d=l.key(c);a(d,f.get(d))}};else if(a.documentElement.addBehavior){var q,m;try{m=new ActiveXObject("htmlfile"),m.open(),m.write('\x3cscript\x3edocument.w\x3dwindow\x3c/script\x3e\x3ciframe src\x3d"/favicon.ico"\x3e\x3c/iframe\x3e'),m.close(),q=m.w.frames[0].document,l=q.createElement("div")}catch(g){l=a.createElement("div"),q=a.body}var a=function(a){return function(){var c=Array.prototype.slice.call(arguments,0);c.unshift(l);q.appendChild(l);l.addBehavior("#default#userData");
l.load("localStorage");c=a.apply(f,c);q.removeChild(l);return c}},e=RegExp("[!\"#$%\x26'()*+,/\\\\:;\x3c\x3d\x3e?@[\\]^`{|}~]","g"),c=function(a){return a.replace(/^d/,"___$\x26").replace(e,"___")};f.set=a(function(a,d,e){d=c(d);if(void 0===e)return f.remove(d);a.setAttribute(d,f.serialize(e));a.save("localStorage");return e});f.get=a(function(a,d){d=c(d);return f.deserialize(a.getAttribute(d))});f.remove=a(function(a,d){d=c(d);a.removeAttribute(d);a.save("localStorage")});f.clear=a(function(a){var c=
a.XMLDocument.documentElement.attributes;a.load("localStorage");for(var d=0,e;e=c[d];d++)a.removeAttribute(e.name);a.save("localStorage")});f.getAll=function(a){var c={};f.forEach(function(a,d){c[a]=d});return c};f.forEach=a(function(a,c){for(var d=a.XMLDocument.documentElement.attributes,e=0,b;b=d[e];++e)c(b.name,f.deserialize(a.getAttribute(b.name)))})}try{f.set("__storejs__","__storejs__"),"__storejs__"!=f.get("__storejs__")&&(f.disabled=!0),f.remove("__storejs__")}catch(d){f.disabled=!0}f.enabled=
!f.disabled;"undefined"!=typeof module&&module.exports&&this.module!==module?module.exports=f:"function"===typeof define&&define.amd?define(f):p.store=f})(Function("return this")())},"libs/md5/md5":function(){(function(p){function f(a,c){var d=(a&65535)+(c&65535);return(a>>16)+(c>>16)+(d>>16)<<16|d&65535}function a(a,c,d,b,e,g){a=f(f(c,a),f(b,g));return f(a<<e|a>>>32-e,d)}function l(c,d,e,b,f,g,h){return a(d&e|~d&b,c,d,f,g,h)}function k(c,d,e,b,f,g,h){return a(d&b|e&~b,c,d,f,g,h)}function h(c,d,e,
b,f,g,h){return a(e^(d|~b),c,d,f,g,h)}function q(c,d){c[d>>5]|=128<<d%32;c[(d+64>>>9<<4)+14]=d;var e,b,g,n,r,m=1732584193,q=-271733879,p=-1732584194,A=271733878;for(e=0;e<c.length;e+=16)b=m,g=q,n=p,r=A,m=l(m,q,p,A,c[e],7,-680876936),A=l(A,m,q,p,c[e+1],12,-389564586),p=l(p,A,m,q,c[e+2],17,606105819),q=l(q,p,A,m,c[e+3],22,-1044525330),m=l(m,q,p,A,c[e+4],7,-176418897),A=l(A,m,q,p,c[e+5],12,1200080426),p=l(p,A,m,q,c[e+6],17,-1473231341),q=l(q,p,A,m,c[e+7],22,-45705983),m=l(m,q,p,A,c[e+8],7,1770035416),
A=l(A,m,q,p,c[e+9],12,-1958414417),p=l(p,A,m,q,c[e+10],17,-42063),q=l(q,p,A,m,c[e+11],22,-1990404162),m=l(m,q,p,A,c[e+12],7,1804603682),A=l(A,m,q,p,c[e+13],12,-40341101),p=l(p,A,m,q,c[e+14],17,-1502002290),q=l(q,p,A,m,c[e+15],22,1236535329),m=k(m,q,p,A,c[e+1],5,-165796510),A=k(A,m,q,p,c[e+6],9,-1069501632),p=k(p,A,m,q,c[e+11],14,643717713),q=k(q,p,A,m,c[e],20,-373897302),m=k(m,q,p,A,c[e+5],5,-701558691),A=k(A,m,q,p,c[e+10],9,38016083),p=k(p,A,m,q,c[e+15],14,-660478335),q=k(q,p,A,m,c[e+4],20,-405537848),
m=k(m,q,p,A,c[e+9],5,568446438),A=k(A,m,q,p,c[e+14],9,-1019803690),p=k(p,A,m,q,c[e+3],14,-187363961),q=k(q,p,A,m,c[e+8],20,1163531501),m=k(m,q,p,A,c[e+13],5,-1444681467),A=k(A,m,q,p,c[e+2],9,-51403784),p=k(p,A,m,q,c[e+7],14,1735328473),q=k(q,p,A,m,c[e+12],20,-1926607734),m=a(q^p^A,m,q,c[e+5],4,-378558),A=a(m^q^p,A,m,c[e+8],11,-2022574463),p=a(A^m^q,p,A,c[e+11],16,1839030562),q=a(p^A^m,q,p,c[e+14],23,-35309556),m=a(q^p^A,m,q,c[e+1],4,-1530992060),A=a(m^q^p,A,m,c[e+4],11,1272893353),p=a(A^m^q,p,A,c[e+
7],16,-155497632),q=a(p^A^m,q,p,c[e+10],23,-1094730640),m=a(q^p^A,m,q,c[e+13],4,681279174),A=a(m^q^p,A,m,c[e],11,-358537222),p=a(A^m^q,p,A,c[e+3],16,-722521979),q=a(p^A^m,q,p,c[e+6],23,76029189),m=a(q^p^A,m,q,c[e+9],4,-640364487),A=a(m^q^p,A,m,c[e+12],11,-421815835),p=a(A^m^q,p,A,c[e+15],16,530742520),q=a(p^A^m,q,p,c[e+2],23,-995338651),m=h(m,q,p,A,c[e],6,-198630844),A=h(A,m,q,p,c[e+7],10,1126891415),p=h(p,A,m,q,c[e+14],15,-1416354905),q=h(q,p,A,m,c[e+5],21,-57434055),m=h(m,q,p,A,c[e+12],6,1700485571),
A=h(A,m,q,p,c[e+3],10,-1894986606),p=h(p,A,m,q,c[e+10],15,-1051523),q=h(q,p,A,m,c[e+1],21,-2054922799),m=h(m,q,p,A,c[e+8],6,1873313359),A=h(A,m,q,p,c[e+15],10,-30611744),p=h(p,A,m,q,c[e+6],15,-1560198380),q=h(q,p,A,m,c[e+13],21,1309151649),m=h(m,q,p,A,c[e+4],6,-145523070),A=h(A,m,q,p,c[e+11],10,-1120210379),p=h(p,A,m,q,c[e+2],15,718787259),q=h(q,p,A,m,c[e+9],21,-343485551),m=f(m,b),q=f(q,g),p=f(p,n),A=f(A,r);return[m,q,p,A]}function m(a){var c,d="";for(c=0;c<32*a.length;c+=8)d+=String.fromCharCode(a[c>>
5]>>>c%32&255);return d}function g(a){var c,d=[];d[(a.length>>2)-1]=void 0;for(c=0;c<d.length;c+=1)d[c]=0;for(c=0;c<8*a.length;c+=8)d[c>>5]|=(a.charCodeAt(c/8)&255)<<c%32;return d}function e(a){return m(q(g(a),8*a.length))}function c(a){var c="",d,b;for(b=0;b<a.length;b+=1)d=a.charCodeAt(b),c+="0123456789abcdef".charAt(d>>>4&15)+"0123456789abcdef".charAt(d&15);return c}function d(a,c){var d=unescape(encodeURIComponent(a)),b=unescape(encodeURIComponent(c)),e=g(d),f=[],h=[];f[15]=h[15]=void 0;16<e.length&&
(e=q(e,8*d.length));for(d=0;16>d;d+=1)f[d]=e[d]^909522486,h[d]=e[d]^1549556828;b=q(f.concat(g(b)),512+8*b.length);return m(q(h.concat(b),640))}function r(a,f,g){return!f?!g?c(e(unescape(encodeURIComponent(a)))):e(unescape(encodeURIComponent(a))):!g?c(d(f,a)):d(f,a)}"function"===typeof define&&define.amd?define(function(){return r}):p.md5=r})(this)},"jimu/LayerInfos/LayerInfos":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/on dojo/topic dojo/Evented dojo/promise/all ./LayerInfoFactory".split(" "),
function(p,f,a,l,k,h,q,m,g){var e=p([q],{map:null,_operLayers:null,_layerInfos:null,_finalLayerInfos:null,_tableInfos:null,_finalTableInfos:null,_basemapLayers:null,constructor:function(a,c){this._basemapLayers=c.baseMap.baseMapLayers;this._operLayers=c.operationalLayers;this._tables=c.tables;this.map=a;this._initLayerInfos();this._initTablesInfos();this.update();this._bindEvents()},update:function(){this._extraSetLayerInfos();this._clearAddedFlag(this._layerInfos);this._initFinalTableInfos();this._initFinalLayerInfos(this._layerInfos);
this._markFirstOrLastNode()},getLayerInfoArrayOfWebmap:function(){var a=[];f.forEach(this.getLayerInfoArray(),function(c){for(var b=0;b<this._operLayers.length;b++)if(c.id===this._operLayers[b].id){a.push(c);break}b===this._operLayers.length&&0<=this._removedLayerInfoIdsFromFeatureCollection.indexOf(c.id)&&a.push(c)},this);return a},getLayerInfoArray:function(){return this._finalLayerInfos},getTableInfoArray:function(){return this._finalTableInfos},addFeatureCollection:function(a,c){var b=this._getUniqueTopLayerInfoId(c),
d={layers:[]};f.forEach(a,function(a,c){a.id=b+"_"+c;d.layers.push({id:a.id,layerObject:a})},this);this.map.addLayers(a);var e;try{e=g.getInstance().create({featureCollection:d,title:c||b,id:b},this.map),e.init()}catch(h){console.warn(h.message),e=null}e&&(e._extraOfWebmapLayerInfo=!0,this._layerInfos.push(e),this.update(),this._onUpdated())},addTable:function(a){var c=[];a=this._addTable(a,this._finalTableInfos);this._tableInfos.push(a);c.push(a);this._onTableChange(c,"added");return a},removeTable:function(a){var c=
-1,b=!1;f.forEach(this._tableInfos,function(b,d){a.id===b.id&&(c=d)});0<=c&&(this._tableInfos.splice(c,1),b=!0);c=-1;f.forEach(this._finalTableInfos,function(b,d){a.id===b.id&&(c=d)});0<=c&&(this._finalTableInfos.splice(c,1),b=!0);b&&this._onTableChange([a],"removed")},_addTable:function(a,c){var b;try{a.layerObject={url:a.url,featureCollectionData:a.featureCollectionData,empty:!0},a.id=this._getUniqueTableId(a.id),a.selfType="table",b=g.getInstance().create(a),b.init()}catch(d){console.warn(d.message),
b=null}b&&c&&c.push(b);return b},_getUniqueTableId:function(a){var c=this._tableInfos.concat(this._finalTableInfos||[]);return this._getUniqueLayerOrTableId(a,c)},_getUniqueTopLayerInfoId:function(a){return this._getUniqueLayerOrTableId(a,this._finalLayerInfos)},_getUniqueLayerOrTableId:function(a,c){var b=1,d;a||(a="table");for(d=a;;){for(var e=0;e<c.length&&c[e].id!==d;e++);if(e===c.length)return d;d=a+"_"+b.toString();b++}},_traversal:function(a,c){for(var b=0;b<c.length;b++)if(c[b].traversal(a))return!0;
return!1},traversal:function(a){var c=this.getLayerInfoArray();return this._traversal(a,c)},traversalLayerInfosOfWebmap:function(a){var c=this.getLayerInfoArrayOfWebmap();return this._traversal(a,c)},traversalAll:function(a){var c=this.getLayerInfoArray(),b=this.getTableInfoArray();return this._traversal(a,c.concat(b))},getLayerInfoById:function(a){return this._findLayerInfoById(a)},getTableInfoById:function(a){var c=null;f.some(this.getTableInfoArray(),function(b){if(b.id===a)return c=b,!0});return c},
getLayerInfoByTopLayerId:function(a){return this._findTopLayerInfoById(a)},moveUpLayer:function(a,c){var b=null;c=c?c:1;var d=this._getTopLayerInfoIndexById(a.id);0<=d-c&&(b=this._finalLayerInfos[d-c].obtainLayerIndexesInMap().length,this._finalLayerInfos[d].moveLayerByIndex(this._finalLayerInfos[d-c].obtainLayerIndexesInMap()[b-1].index),b=this._finalLayerInfos[d-c],h.publish("layerInfos/layerReorder",d,c,"moveup"));return b},_reorderLayerInfosArray:function(a,c,b){"moveup"===b?(b=this._finalLayerInfos[a],
this._finalLayerInfos.splice(a,1),this._finalLayerInfos.splice(a-c,0,b)):(b=this._finalLayerInfos[a],this._finalLayerInfos.splice(a+c+1,0,b),this._finalLayerInfos.splice(a,1));this._markFirstOrLastNode()},moveDownLayer:function(a,c){var b=null;c=c?c:1;var d=this._getTopLayerInfoIndexById(a.id);d+c<=this._finalLayerInfos.length-1&&(this._finalLayerInfos[d].moveLayerByIndex(this._finalLayerInfos[d+c].obtainLayerIndexesInMap()[0].index),b=this._finalLayerInfos[d+c],h.publish("layerInfos/layerReorder",
d,c,"movedown"));return b},getBasemapLayers:function(){var a=[];f.forEach(this.map.layerIds,function(c){c=this.map.getLayer(c);("basemap"===c._basemapGalleryLayerType||"reference"===c._basemapGalleryLayerType)&&a.push(c)},this);0===a.length&&(a=this._basemapLayers);return a},getMapNotesLayerInfoArray:function(){return f.filter(this.getLayerInfoArray(),function(a){return a.isMapNotesLayerInfo()},this)},restoreState:function(a){var c=a&&a.layerOptions?a.layerOptions:null;f.forEach(this.getLayerInfoArray(),
function(a){a.resetLayerObjectVisibility(c)},this)},_initLayerInfos:function(){var a;this._layerInfos=[];f.forEach(this._operLayers,function(c){try{a=g.getInstance().create(c),a.init()}catch(b){console.warn(b.message),a=null}a&&this._layerInfos.push(a)},this)},_extraSetLayerInfos:function(){this._removedLayerInfoIdsFromFeatureCollection=[];f.forEach(this._layerInfos,function(a,c){var b;if("esri.layers.GeoRSSLayer"===a.layerObject.declaredClass||"esri.layers.KMLLayer"===a.layerObject.declaredClass){try{b=
g.getInstance().create(a.originOperLayer),b.init()}catch(d){console.warn(d.message),b=null}b&&(a.destroyLayerInfo(),this._layerInfos[c]=b)}else if(a.originOperLayer.featureCollection){var e=[];f.forEach(a.getSubLayers(),function(a){e.push(a.id)});f.forEach(e,function(b){this.map.getLayer(b)||a.removeSubLayerById(b)},this);1===a.getSubLayers().length&&(b=a.getSubLayers()[0],this.map.getLayer(b.id).title=a.title,a.removeSubLayerById(b.id),this._removedLayerInfoIdsFromFeatureCollection.push(b.id))}},
this)},_initFinalLayerInfos:function(a){var c,b;this._finalLayerInfos=[];for(c=this.map.graphicsLayerIds.length-1;0<=c;c--)b=this.map.graphicsLayerIds[c],this._isBasemap(b)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(b,a),b,!0);for(c=this.map.layerIds.length-1;0<=c;c--)b=this.map.layerIds[c],this._isBasemap(b)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(b,a),b,!1)},_isBasemap:function(a){for(var c=!1,b=this.getBasemapLayers(),d=0;d<b.length;d++)b[d].id===
a&&(c=!0);return c},_addToFinalLayerInfos:function(c,d,b){var e;if(c)!c._addedFlag&&c.isGraphicLayer()===b&&(this._finalLayerInfos.push(c),c._addedFlag=!0);else{c=this.map.getLayer(d);if("esri.layers.GraphicsLayer"!==c.declaredClass&&"labels"!==c.id){try{e=g.getInstance().create({layerObject:c,title:this._getLayerTitle(c),id:c.id||" "},this.map),e.init()}catch(h){console.warn(h.message),e=null}e&&this._finalLayerInfos.push(e)}("esri.layers.ArcGISDynamicMapServiceLayer"===c.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===
c.declaredClass)&&e&&e._getLayerDefinition().then(a.hitch(this,function(a){var b=[];f.forEach(a.tables,function(a){a.url=e.getUrl()+"/"+a.id;a.id=e.id+"_"+a.id;a.title=this._getLayerTitle(a);(a=this._addTable(a,this._finalTableInfos))&&b.push(a)},this);this._onTableChange(b,"added")}))}},_getLayerTitle:function(a){if(a.title)return a.title;var c=a.label||a.name||"";if(a.url){var b;b=a.url.indexOf("rest/services/");-1<b&&(b=a.url.substring(b+14).split("/")[0],c=c?b+" - "+c:b)}return c||a.id},_findLayerInfoByIdAndReturnTopLayer:function(a,
c){var b,d=null;c||(c=this._finalLayerInfos);for(b=0;b<c.length;b++)if(d=c[b].findLayerInfoById(a)){d=c[b];break}return d},_findLayerInfoById:function(a,c){var b,d=null;c||(c=this._finalLayerInfos);for(b=0;b<c.length&&!(d=c[b].findLayerInfoById(a));b++);return d},_findTopLayerInfoById:function(a){var c,b=null,d=this._finalLayerInfos;for(c=0;c<d.length;c++)if(d[c].id===a){b=d[c];break}return b},_getTopLayerInfoIndexById:function(a){var c,b=-1;for(c=0;c<this._finalLayerInfos.length;c++)if(this._finalLayerInfos[c].id===
a){b=c;break}return b},_clearAddedFlag:function(a){f.forEach(a,function(a){a._addedFlag=!1})},_markFirstOrLastNode:function(){var a;if(this._finalLayerInfos.length){for(a=0;a<this._finalLayerInfos.length;a++)this._finalLayerInfos[a].isFirst=!1,this._finalLayerInfos[a].isLast=!1;this._finalLayerInfos[0].isFirst=!0;this._finalLayerInfos[this._finalLayerInfos.length-1].isLast=!0;for(a=0;a<this._finalLayerInfos.length;a++)if(!this._finalLayerInfos[a].isGraphicLayer()){a&&(this._finalLayerInfos[a-1].isLast=
!0);this._finalLayerInfos[a].isFirst=!0;break}}},_onReceiveBasemapGalleryeData:function(c,d,b){"BasemapGallery"===c&&(this._basemapLayers.length=0,f.forEach(b,a.hitch(this,function(a){this._basemapLayers.push({layerObject:a,id:a.id})}),this),this.update(),this.emit("layerInfosChanged"))},_onBasemapChange:function(a){var c;for(c=this._basemapLayers.length=0;c<a.layers.length;c++)this._basemapLayers.push({layerObject:a.layer[c],id:a.layers[c].id})},_destroyLayerInfos:function(){f.forEach(this.getLayerInfoArray(),
a.hitch(this,function(a){a.destroyLayerInfo()}))},_bindEvents:function(){var c,d,b,e,f,g,l,r;c=k(this.map,"layer-add-result",a.hitch(this,this._onLayersChange,"added"));d=k(this.map,"layer-remove",a.hitch(this,this._onLayersChange,"removed"));l=h.subscribe("layerInfos/layerReorder",a.hitch(this,this._onLayerReorder));e=h.subscribe("layerInfos/layerInfo/isShowInMapChanged",a.hitch(this,this._onShowInMapChanged));f=h.subscribe("layerInfos/layerInfo/visibleChanged",a.hitch(this,this._onVisibleChanged));
g=h.subscribe("layerInfos/layerInfo/filterChanged",a.hitch(this,this._onFilterChanged));r=h.subscribe("layerInfos/layerInfo/rendererChanged",a.hitch(this,this._onRendererChanged));b=k(this.map,"before-unload",a.hitch(this,function(){c.remove();d.remove();l.remove();e.remove();f.remove();g.remove();r.remove();b.remove();this._destroyLayerInfos()}))},_onLayersChange:function(a,c){var b=null,d;!c.error&&("esri.layers.GraphicsLayer"!==c.layer.declaredClass&&!c.layer._basemapGalleryLayerType)&&("added"===
a?(this.update(),b=this._findTopLayerInfoById(c.layer.id),d=this._findLayerInfoById(c.layer.id)):(b=this._findTopLayerInfoById(c.layer.id),d=this._findLayerInfoById(c.layer.id),this.update()),this.emit("layerInfosChanged",b,a,d))},_onShowInMapChanged:function(a){this.emit("layerInfosIsShowInMapChanged",a)},_onVisibleChanged:function(a){this.emit("layerInfosIsVisibleChanged",a)},_onFilterChanged:function(a){this.emit("layerInfosFilterChanged",a)},_onLayerReorder:function(a,c,b){this._reorderLayerInfosArray(a,
c,b);this.emit("layerInfosReorder")},_onRendererChanged:function(a){this.emit("layerInfosRendererChanged",a)},_initTablesInfos:function(){this._tableInfos=[];f.forEach(this._tables&&this._tables.reverse(),function(a){this._addTable(a,this._tableInfos)},this)},_initFinalTableInfos:function(){this._finalTableInfos=[];f.forEach(this._tableInfos,function(a){this._finalTableInfos.push(a)},this)},_onTableChange:function(a,c){this.emit("tableInfosChanged",a,c)},_onUpdated:function(){this.emit("updated")}});
e.getLayerInfoArrayByType=function(a,c){var b=new l,d=[],g=[];e.getInstance(a,a.iteminfo).then(function(a){a.traversal(function(a){var b=a.getLayerType();b.layerInfo=a;d.push(b)});m(d).then(function(a){f.forEach(a,function(a,b){c===a&&g.push(d[b].layerInfo)});b.resolve(g)})});return b};var c=!0,d=null,r=null,u=new l;e.getInstance=function(f,h){d&&d!==f&&(c=!0,r=d=null,u=new l);r?u.resolve(r):c&&(c=!1,g.getInstance(f).init().then(a.hitch(this,function(){var a=new e(f,h.itemData);d=f;r=a;u.resolve(a)})));
return u};e.getInstanceSync=function(){return r};return e})},"jimu/LayerInfos/LayerInfoFactory":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred"],function(p,f,a){var l=null,k=p(null,{constructor:function(){},init:function(){var h=new a;require("jimu/LayerInfos/LayerInfoForCollection jimu/LayerInfos/LayerInfoForMapService jimu/LayerInfos/LayerInfoForKML jimu/LayerInfos/LayerInfoForGeoRSS jimu/LayerInfos/LayerInfoForDefault jimu/LayerInfos/LayerInfoForWMS jimu/LayerInfos/LayerInfoForGroup jimu/LayerInfos/LayerInfoForDefaultDynamic jimu/LayerInfos/LayerInfoForDefaultTile jimu/LayerInfos/LayerInfoForDefaultWMS jimu/LayerInfos/LayerInfoForDefaultTable jimu/LayerInfos/LayerInfoForDefaultImage jimu/LayerInfos/LayerInfoForDefaultStream".split(" "),
f.hitch(this,function(a,f,g,e,c,d,k,l,s,t,b,p,n){this.LayerInfoForCollection=a;this.LayerInfoForMapService=f;this.LayerInfoForKML=g;this.LayerInfoForGeoRSS=e;this.LayerInfoForDefault=c;this.LayerInfoForWMS=d;this.LayerInfoForGroup=k;this.LayerInfoForDefaultDynamic=l;this.LayerInfoForDefaultTile=s;this.LayerInfoForDefaultWMS=t;this.LayerInfoForDefaultTable=b;this.LayerInfoForDefaultImage=p;this.LayerInfoForDefaultStream=n;h.resolve()}));return h},create:function(a){if(a.featureCollection)return new this.LayerInfoForCollection(a,
this.map);if("esri.layers.KMLLayer"===a.layerObject.declaredClass)return new this.LayerInfoForKML(a,this.map);if("esri.layers.GeoRSSLayer"===a.layerObject.declaredClass)return new this.LayerInfoForGeoRSS(a,this.map);if("esri.layers.WMSLayer"===a.layerObject.declaredClass&&!a.selfType)return new this.LayerInfoForWMS(a,this.map);if("esri.layers.ArcGISDynamicMapServiceLayer"===a.layerObject.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===a.layerObject.declaredClass)return new this.LayerInfoForMapService(a,
this.map);if("esri.layers.ArcGISImageServiceLayer"===a.layerObject.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===a.layerObject.declaredClass)return new this.LayerInfoForDefaultImage(a,this.map);if("esri.layers.StreamLayer"===a.layerObject.declaredClass)return new this.LayerInfoForDefaultStream(a,this.map);"Table"===a.layerObject.type&&(a.selfType="table");switch(a.selfType){case "mapservice_dynamic_group":return new this.LayerInfoForGroup(a,this.map);case "mapservice_tiled_group":return new this.LayerInfoForGroup(a,
this.map,!0);case "mapservice_dynamic":return new this.LayerInfoForDefaultDynamic(a,this.map);case "mapservice_tiled":return new this.LayerInfoForDefaultTile(a,this.map);case "wms":return new this.LayerInfoForDefaultWMS(a,this.map);case "table":return new this.LayerInfoForDefaultTable(a,this.map);default:return new this.LayerInfoForDefault(a,this.map)}}});k.getInstance=function(a){null===l&&(l=new k);a&&(l.map=a);return l};return k})},"builder/plugins/app-config-configpart/_build-generate_module":function(){define(["builder/plugins/app-config-configpart/Plugin",
"dojo/text!builder/plugins/app-config-configpart/Plugin.html","dojo/text!builder/plugins/app-config-configpart/css/style.css","dojo/i18n!builder/plugins/app-config-configpart/nls/strings"],function(){})},"builder/plugins/app-config-configpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all ./TabContainer2 builder/BasePlugin".split(" "),function(p,f,a,l,k,h){return p([h],{baseClass:"plugin-appconfig-configpart",postCreate:function(){this.inherited(arguments);
this.plugins=[];this.republishEvents=[]},startup:function(){this._createConfigTab();this._addRepublishEvents()},_addRepublishEvents:function(){var f=this.pluginManager.getPluginByName("app-config");a.forEach(this.republishEvents,function(a){f.addRepublishEvent(a)},this)},_createConfigTab:function(){var h=this.filterExtensionsByAppType("config-sections",window.appInfo.appType);a.some(h,f.hitch(this,function(a){return"map-config"===a.pluginName?(a.parameters.label="HTML3D"===window.appInfo.appType?
window.jimuNls.common.scene:window.jimuNls.common.map,!0):!1}));var m=[];a.forEach(h,function(a){m.push(this.pluginManager.loadPlugin(this.pluginsMeta[a.pluginName]));a=a.parameters.republishEvents.split(",");this.republishEvents=this.republishEvents.concat(a)},this);l(m).then(f.hitch(this,function(f){var e=[];a.forEach(f,function(a,d){var f=h[d];this.plugins.push(a);e.push({title:f.parameters.label,icon:f.parameters.icon,selectedIcon:f.parameters.selectedIcon,content:a,index:f.parameters.index})},
this);e.sort(function(a,d){return a.index-d.index});this.tab=new k({tabs:e,selected:e[0].title},this.tabsNode);this.tab.startup()}),f.hitch(this,function(a){console.error(a)}))},_onMapChanged:function(a){this.map=a}})})},"builder/plugins/app-config-configpart/TabContainer2":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./TabContainer2.html jimu/dijit/ViewStack".split(" "),function(p,
f,a,l,k,h,q,m,g,e,c){return p([m,g,h],{templateString:e,_controlNodes:null,selected:"",tabs:null,"class":"jimu-tab2",postCreate:function(){this.inherited(arguments);this._controlNodes=[];this.viewStack=new c(null,this.containerNode);a.forEach(this.tabs,function(a){this._createTab(a)},this)},startup:function(){this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title)},_createTab:function(a){var c=l.toDom('\x3ctd\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3cdiv class\x3d"tab-item-icon"\x3e\x3c/div\x3e\x3cdiv class\x3d"tab-item-title"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e');
l.place(c,this.tabTr);var e=q(".tab-item-div",c)[0],g=q(".tab-item-icon",c)[0];q(".tab-item-title",c)[0].innerHTML=a.title||"";l.setAttr(e,"title",a.title||"");l.setStyle(g,"backgroundImage","url("+a.icon+")");this.viewStack.viewType=a.content.domNode?"dijit":"dom";e.tabConfig=a;e.iconNode=g;a.content.label=a.title;this.viewStack.addView(a.content);this.own(k(e,"click",f.hitch(this,this.onSelect,a.title)));this._controlNodes.push(e)},onSelect:function(a){this.selectTab(a)},selectTab:function(c){a.forEach(this._controlNodes,
f.hitch(this,function(a){var e="";a.tabConfig.title===c?(l.addClass(a,"selected-tab-item-div"),e=a.tabConfig.selectedIcon):(l.removeClass(a,"selected-tab-item-div"),e=a.tabConfig.icon);l.setStyle(a.iconNode,"backgroundImage","url("+e+")")}));this.viewStack.switchView(c);this.emit("tabChanged",c)}})})},"builder/plugins/app-config-morepreview-selectionpart/_build-generate_module":function(){define(["builder/plugins/app-config-morepreview-selectionpart/Plugin","dojo/text!builder/plugins/app-config-morepreview-selectionpart/Plugin.html",
"dojo/text!builder/plugins/app-config-morepreview-selectionpart/css/style.css","dojo/i18n!builder/plugins/app-config-morepreview-selectionpart/nls/strings"],function(){})},"builder/plugins/app-config-morepreview-selectionpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/query builder/BasePlugin jimu/portalUrlUtils jimu/dijit/QRCode".split(" "),function(p,f,a,l,k,h,q,m){return p([h],{baseClass:"plugin-appconfig-morepreview-selectionpart",postCreate:function(){this.inherited(arguments);
this._bindEvents();this._appConfigPlugin=this.pluginManager.getPluginByName("app-config")},startup:function(){this.inherited(arguments);this._initPreviewItems();this._initQRCode()},_bindEvents:function(){this.own(l(this.customWidth,"blur",f.hitch(this,this._onCustomSizeChanged)));this.own(l(this.customHeight,"blur",f.hitch(this,this._onCustomSizeChanged)))},_initPreviewItems:function(){a.empty(this.previewTbody);var f=[];f.push({"class":"iPhone6",title:"iPhone6s",width:375,height:667});f.push({"class":"iPhone6-plus",
title:"iPhone6s plus",width:414,height:736});f.push({"class":"iPhone6",title:"iPhone6",width:375,height:667});f.push({"class":"iPhone6-plus",title:"iPhone6 plus",width:414,height:736});f.push({"class":"iPhone5",title:"iPhone5/5C/5S",width:320,height:568});f.push({"class":"iPhone4",title:"iPhone4/4S",width:320,height:480});f.push({"class":"iPad-Air",title:"iPad Air",width:768,height:1024});f.push({"class":"iPad4",title:"iPad with Retina Display",width:768,height:1024});f.push({"class":"new-iPad",title:"The New iPad",
width:768,height:1024});f.push({"class":"iPad-mini",title:"iPad Mini",width:768,height:1024});f.push({"class":"Samsung-Galaxy-S4",title:"Samsung Galaxy S4",width:360,height:640});f.push({"class":"Samsung-Note-3",title:"Samsung Note 3",width:360,height:640});f.push({"class":"Nexus-5",title:"Nexus 5",width:360,height:598});f.push({"class":"Nexus-4",title:"Nexus 4",width:384,height:598});f.push({"class":"Nexus-7",title:"Nexus 7",width:600,height:960});f.push({"class":"htc-one",title:"HTC One",width:360,
height:640});f.push({"class":"xiaomi-3",title:"Xiaomi 3",width:360,height:640});f.push({"class":"LG-G2",title:"LG G2",width:360,height:598});var e=Math.ceil(f.length/4),c;for(c=0;c<e;c++){var d=a.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");a.place(d,this.previewTbody)}e=k("td",this.previewTbody);for(c=0;c<f.length;c++){var d=e[c],h=this._createPreviewItem(f[c]);a.place(h,d)}},_createPreviewItem:function(g){var e=a.toDom('\x3cdiv class\x3d"preview-item"\x3e\x3cdiv class\x3d"preview-item-bg"\x3e\x3cdiv class\x3d"preview-item-thumbnail"\x3e\x3c/div\x3e\x3cdiv class\x3d"preview-selected-icon"\x3e\x3c/div\x3e\x3c/div\x3e\x3cspan class\x3d"preview-item-title"\x3e\x3c/span\x3e\x3c/div\x3e');
e.args=g;var c=k(".preview-item-bg",e)[0],d=k(".preview-item-thumbnail",e)[0],h=k(".preview-item-title",e)[0];this.own(l(c,"click",f.hitch(this,this._onPreviewItemBgClick)));g["class"]&&a.addClass(d,g["class"]);h.innerHTML=g.title||"";return e},_onPreviewItemBgClick:function(f){f=f.target||f.srcElement;a.hasClass(f,"preview-item-thumbnail")&&(f=f.parentNode,k(".preview-item-bg",this.previewTbody).removeClass("selected"),a.addClass(f,"selected"),f=f.parentNode.args,this.customWidth.value=f.width,this.customHeight.value=
f.height,this._appConfigPlugin.previewOnDevice(f,!1))},_onCustomSizeChanged:function(){var a=function(a){var c=!1;!isNaN(a)&&!isNaN(parseFloat(a))&&0<parseInt(a,10)&&(c=!0);return c},e=this.customWidth.value,c=this.customHeight.value;a(e)&&a(c)&&(k(".preview-item-bg",this.previewTbody).removeClass("selected"),e=parseInt(e,10),c=parseInt(c,10),this._appConfigPlugin.previewOnDevice({width:e,height:c},!0))},_initQRCode:function(){var f="";window.isXT?f=window.location.protocol+"//"+window.location.host+
path+"apps/"+window.appInfo.id:(f=q.getStandardPortalUrl(window.portalUrl),f=q.setProtocol(f,window.location.protocol),f=window.queryObject.appid?f+"/apps/webappviewer/index.html?appid\x3d"+window.appInfo.id:f+"/apps/webappviewer/index.html?id\x3d"+window.appInfo.id);new m({text:f,width:75,height:75},this.qrcodeImage);a.setAttr(this.qrcodeDescription,"innerHTML",this.nls.qrcodeDesc);setTimeout(function(){k(".qrcode-image table").style("margin","0px")},100)}})})},"jimu/dijit/QRCode":function(){define(["dojo/_base/declare",
"dijit/_WidgetBase","libs/qrcode"],function(p,f){return p([f],{baseClass:"jimu-qrcode",declaredClass:"jimu.dijit.QRCode",postCreate:function(){new QRCode(this.domNode,{text:this.text,width:this.width||128,height:this.height||128,colorDark:this.colorDark||" #000000",colorLight:this.colorLight||"#ffffff",correctLevel:this.correctLevel||QRCode.CorrectLevel.L})}})})},"libs/qrcode":function(){define(["dojo","dijit","dojox"],function(p,f,a){var l;(function(){function a(b){this.mode=c.MODE_8BIT_BYTE;this.data=
b;this.parsedData=[];b=0;for(var d=this.data.length;b<d;b++){var e=[],f=this.data.charCodeAt(b);65536<f?(e[0]=240|(f&1835008)>>>18,e[1]=128|(f&258048)>>>12,e[2]=128|(f&4032)>>>6,e[3]=128|f&63):2048<f?(e[0]=224|(f&61440)>>>12,e[1]=128|(f&4032)>>>6,e[2]=128|f&63):128<f?(e[0]=192|(f&1984)>>>6,e[1]=128|f&63):e[0]=f;this.parsedData.push(e)}this.parsedData=Array.prototype.concat.apply([],this.parsedData);this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),
this.parsedData.unshift(239))}function f(a,b){this.typeNumber=a;this.errorCorrectLevel=b;this.modules=null;this.moduleCount=0;this.dataCache=null;this.dataList=[]}function q(a,b){if(void 0==a.length)throw Error(a.length+"/"+b);for(var c=0;c<a.length&&0==a[c];)c++;this.num=Array(a.length-c+b);for(var d=0;d<a.length-c;d++)this.num[d]=a[d+c]}function m(a,b){this.totalCount=a;this.dataCount=b}function g(){this.buffer=[];this.length=0}function e(){var a=!1,b=navigator.userAgent;/android/i.test(b)&&(a=
!0,(aMat=b.toString().match(/android ([0-9]\.[0-9])/i))&&aMat[1]&&(a=parseFloat(aMat[1])));return a}a.prototype={getLength:function(a){return this.parsedData.length},write:function(a){for(var b=0,c=this.parsedData.length;b<c;b++)a.put(this.parsedData[b],8)}};f.prototype={addData:function(b){b=new a(b);this.dataList.push(b);this.dataCache=null},isDark:function(a,b){if(0>a||this.moduleCount<=a||0>b||this.moduleCount<=b)throw Error(a+","+b);return this.modules[a][b]},getModuleCount:function(){return this.moduleCount},
make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(a,b){this.moduleCount=4*this.typeNumber+17;this.modules=Array(this.moduleCount);for(var c=0;c<this.moduleCount;c++){this.modules[c]=Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++)this.modules[c][d]=null}this.setupPositionProbePattern(0,0);this.setupPositionProbePattern(this.moduleCount-7,0);this.setupPositionProbePattern(0,this.moduleCount-7);this.setupPositionAdjustPattern();this.setupTimingPattern();this.setupTypeInfo(a,
b);7<=this.typeNumber&&this.setupTypeNumber(a);null==this.dataCache&&(this.dataCache=f.createData(this.typeNumber,this.errorCorrectLevel,this.dataList));this.mapData(this.dataCache,b)},setupPositionProbePattern:function(a,b){for(var c=-1;7>=c;c++)if(!(-1>=a+c||this.moduleCount<=a+c))for(var d=-1;7>=d;d++)-1>=b+d||this.moduleCount<=b+d||(this.modules[a+c][b+d]=0<=c&&6>=c&&(0==d||6==d)||0<=d&&6>=d&&(0==c||6==c)||2<=c&&4>=c&&2<=d&&4>=d?!0:!1)},getBestMaskPattern:function(){for(var a=0,b=0,c=0;8>c;c++){this.makeImpl(!0,
c);var d=r.getLostPoint(this);if(0==c||a>d)a=d,b=c}return b},createMovieClip:function(a,b,c){a=a.createEmptyMovieClip(b,c);this.make();for(b=0;b<this.modules.length;b++){c=1*b;for(var d=0;d<this.modules[b].length;d++){var e=1*d;this.modules[b][d]&&(a.beginFill(0,100),a.moveTo(e,c),a.lineTo(e+1,c),a.lineTo(e+1,c+1),a.lineTo(e,c+1),a.endFill())}}return a},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++)null==this.modules[a][6]&&(this.modules[a][6]=0==a%2);for(a=8;a<this.moduleCount-
8;a++)null==this.modules[6][a]&&(this.modules[6][a]=0==a%2)},setupPositionAdjustPattern:function(){for(var a=r.getPatternPosition(this.typeNumber),b=0;b<a.length;b++)for(var c=0;c<a.length;c++){var d=a[b],e=a[c];if(null==this.modules[d][e])for(var f=-2;2>=f;f++)for(var g=-2;2>=g;g++)this.modules[d+f][e+g]=-2==f||2==f||-2==g||2==g||0==f&&0==g?!0:!1}},setupTypeNumber:function(a){for(var b=r.getBCHTypeNumber(this.typeNumber),c=0;18>c;c++){var d=!a&&1==(b>>c&1);this.modules[Math.floor(c/3)][c%3+this.moduleCount-
8-3]=d}for(c=0;18>c;c++)d=!a&&1==(b>>c&1),this.modules[c%3+this.moduleCount-8-3][Math.floor(c/3)]=d},setupTypeInfo:function(a,b){for(var c=r.getBCHTypeInfo(this.errorCorrectLevel<<3|b),d=0;15>d;d++){var e=!a&&1==(c>>d&1);6>d?this.modules[d][8]=e:8>d?this.modules[d+1][8]=e:this.modules[this.moduleCount-15+d][8]=e}for(d=0;15>d;d++)e=!a&&1==(c>>d&1),8>d?this.modules[8][this.moduleCount-d-1]=e:9>d?this.modules[8][15-d-1+1]=e:this.modules[8][15-d-1]=e;this.modules[this.moduleCount-8][8]=!a},mapData:function(a,
b){for(var c=-1,d=this.moduleCount-1,e=7,f=0,g=this.moduleCount-1;0<g;g-=2)for(6==g&&g--;;){for(var h=0;2>h;h++)if(null==this.modules[d][g-h]){var k=!1;f<a.length&&(k=1==(a[f]>>>e&1));r.getMask(b,d,g-h)&&(k=!k);this.modules[d][g-h]=k;e--; -1==e&&(f++,e=7)}d+=c;if(0>d||this.moduleCount<=d){d-=c;c=-c;break}}}};f.PAD0=236;f.PAD1=17;f.createData=function(a,b,c){b=m.getRSBlocks(a,b);for(var d=new g,e=0;e<c.length;e++){var k=c[e];d.put(k.mode,4);d.put(k.getLength(),r.getLengthInBits(k.mode,a));k.write(d)}for(e=
a=0;e<b.length;e++)a+=b[e].dataCount;if(d.getLengthInBits()>8*a)throw Error("code length overflow. ("+d.getLengthInBits()+"\x3e"+8*a+")");for(d.getLengthInBits()+4<=8*a&&d.put(0,4);0!=d.getLengthInBits()%8;)d.putBit(!1);for(;!(d.getLengthInBits()>=8*a);){d.put(f.PAD0,8);if(d.getLengthInBits()>=8*a)break;d.put(f.PAD1,8)}return f.createBytes(d,b)};f.createBytes=function(a,b){for(var c=0,d=0,e=0,f=Array(b.length),g=Array(b.length),h=0;h<b.length;h++){var k=b[h].dataCount,l=b[h].totalCount-k,d=Math.max(d,
k),e=Math.max(e,l);f[h]=Array(k);for(var m=0;m<f[h].length;m++)f[h][m]=255&a.buffer[m+c];c+=k;m=r.getErrorCorrectPolynomial(l);k=(new q(f[h],m.getLength()-1)).mod(m);g[h]=Array(m.getLength()-1);for(m=0;m<g[h].length;m++)l=m+k.getLength()-g[h].length,g[h][m]=0<=l?k.get(l):0}for(m=h=0;m<b.length;m++)h+=b[m].totalCount;c=Array(h);for(m=k=0;m<d;m++)for(h=0;h<b.length;h++)m<f[h].length&&(c[k++]=f[h][m]);for(m=0;m<e;m++)for(h=0;h<b.length;h++)m<g[h].length&&(c[k++]=g[h][m]);return c};for(var c={MODE_NUMBER:1,
MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},d={L:1,M:0,Q:3,H:2},r={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,
86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var b=a<<10;0<=r.getBCHDigit(b)-r.getBCHDigit(r.G15);)b^=r.G15<<r.getBCHDigit(b)-r.getBCHDigit(r.G15);return(a<<10|b)^r.G15_MASK},getBCHTypeNumber:function(a){for(var b=a<<12;0<=r.getBCHDigit(b)-r.getBCHDigit(r.G18);)b^=r.G18<<r.getBCHDigit(b)-
r.getBCHDigit(r.G18);return a<<12|b},getBCHDigit:function(a){for(var b=0;0!=a;)b++,a>>>=1;return b},getPatternPosition:function(a){return r.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,b,c){switch(a){case 0:return 0==(b+c)%2;case 1:return 0==b%2;case 2:return 0==c%3;case 3:return 0==(b+c)%3;case 4:return 0==(Math.floor(b/2)+Math.floor(c/3))%2;case 5:return 0==b*c%2+b*c%3;case 6:return 0==(b*c%2+b*c%3)%2;case 7:return 0==(b*c%3+(b+c)%2)%2;default:throw Error("bad maskPattern:"+a);}},getErrorCorrectPolynomial:function(a){for(var b=
new q([1],0),c=0;c<a;c++)b=b.multiply(new q([1,u.gexp(c)],0));return b},getLengthInBits:function(a,b){if(1<=b&&10>b)switch(a){case c.MODE_NUMBER:return 10;case c.MODE_ALPHA_NUM:return 9;case c.MODE_8BIT_BYTE:return 8;case c.MODE_KANJI:return 8;default:throw Error("mode:"+a);}else if(27>b)switch(a){case c.MODE_NUMBER:return 12;case c.MODE_ALPHA_NUM:return 11;case c.MODE_8BIT_BYTE:return 16;case c.MODE_KANJI:return 10;default:throw Error("mode:"+a);}else if(41>b)switch(a){case c.MODE_NUMBER:return 14;
case c.MODE_ALPHA_NUM:return 13;case c.MODE_8BIT_BYTE:return 16;case c.MODE_KANJI:return 12;default:throw Error("mode:"+a);}else throw Error("type:"+b);},getLostPoint:function(a){for(var b=a.getModuleCount(),c=0,d=0;d<b;d++)for(var e=0;e<b;e++){for(var f=0,g=a.isDark(d,e),h=-1;1>=h;h++)if(!(0>d+h||b<=d+h))for(var k=-1;1>=k;k++)0>e+k||b<=e+k||0==h&&0==k||g==a.isDark(d+h,e+k)&&f++;5<f&&(c+=3+f-5)}for(d=0;d<b-1;d++)for(e=0;e<b-1;e++)if(f=0,a.isDark(d,e)&&f++,a.isDark(d+1,e)&&f++,a.isDark(d,e+1)&&f++,
a.isDark(d+1,e+1)&&f++,0==f||4==f)c+=3;for(d=0;d<b;d++)for(e=0;e<b-6;e++)a.isDark(d,e)&&(!a.isDark(d,e+1)&&a.isDark(d,e+2)&&a.isDark(d,e+3)&&a.isDark(d,e+4)&&!a.isDark(d,e+5)&&a.isDark(d,e+6))&&(c+=40);for(e=0;e<b;e++)for(d=0;d<b-6;d++)a.isDark(d,e)&&(!a.isDark(d+1,e)&&a.isDark(d+2,e)&&a.isDark(d+3,e)&&a.isDark(d+4,e)&&!a.isDark(d+5,e)&&a.isDark(d+6,e))&&(c+=40);for(e=f=0;e<b;e++)for(d=0;d<b;d++)a.isDark(d,e)&&f++;a=Math.abs(100*f/b/b-50)/5;return c+10*a}},u={glog:function(a){if(1>a)throw Error("glog("+
a+")");return u.LOG_TABLE[a]},gexp:function(a){for(;0>a;)a+=255;for(;256<=a;)a-=255;return u.EXP_TABLE[a]},EXP_TABLE:Array(256),LOG_TABLE:Array(256)},s=0;8>s;s++)u.EXP_TABLE[s]=1<<s;for(s=8;256>s;s++)u.EXP_TABLE[s]=u.EXP_TABLE[s-4]^u.EXP_TABLE[s-5]^u.EXP_TABLE[s-6]^u.EXP_TABLE[s-8];for(s=0;255>s;s++)u.LOG_TABLE[u.EXP_TABLE[s]]=s;q.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},multiply:function(a){for(var b=Array(this.getLength()+a.getLength()-1),c=0;c<
this.getLength();c++)for(var d=0;d<a.getLength();d++)b[c+d]^=u.gexp(u.glog(this.get(c))+u.glog(a.get(d)));return new q(b,0)},mod:function(a){if(0>this.getLength()-a.getLength())return this;for(var b=u.glog(this.get(0))-u.glog(a.get(0)),c=Array(this.getLength()),d=0;d<this.getLength();d++)c[d]=this.get(d);for(d=0;d<a.getLength();d++)c[d]^=u.gexp(u.glog(a.get(d))+b);return(new q(c,0)).mod(a)}};m.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],
[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,
2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,
43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],
[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],
[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],
[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];m.getRSBlocks=function(a,b){var c=m.getRsBlockTable(a,b);if(void 0==c)throw Error("bad rs block @ typeNumber:"+a+"/errorCorrectLevel:"+b);for(var d=c.length/3,e=[],f=0;f<d;f++)for(var g=c[3*f+0],h=c[3*f+1],k=c[3*f+2],l=0;l<g;l++)e.push(new m(h,k));return e};
m.getRsBlockTable=function(a,b){switch(b){case d.L:return m.RS_BLOCK_TABLE[4*(a-1)+0];case d.M:return m.RS_BLOCK_TABLE[4*(a-1)+1];case d.Q:return m.RS_BLOCK_TABLE[4*(a-1)+2];case d.H:return m.RS_BLOCK_TABLE[4*(a-1)+3]}};g.prototype={get:function(a){return 1==(this.buffer[Math.floor(a/8)]>>>7-a%8&1)},put:function(a,b){for(var c=0;c<b;c++)this.putBit(1==(a>>>b-c-1&1))},getLengthInBits:function(){return this.length},putBit:function(a){var b=Math.floor(this.length/8);this.buffer.length<=b&&this.buffer.push(0);
a&&(this.buffer[b]|=128>>>this.length%8);this.length++}};var t=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,
751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],s=function(){var a=function(a,b){this._el=a;this._htOption=b};a.prototype.draw=function(a){function b(a,c){var d=document.createElementNS("http://www.w3.org/2000/svg",a),e;for(e in c)c.hasOwnProperty(e)&&
d.setAttribute(e,c[e]);return d}var c=this._htOption,d=this._el,e=a.getModuleCount();this.clear();var f=b("svg",{viewBox:"0 0 "+String(e)+" "+String(e),width:"100%",height:"100%",fill:c.colorLight});f.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");d.appendChild(f);f.appendChild(b("rect",{fill:c.colorDark,width:"1",height:"1",id:"template"}));for(c=0;c<e;c++)for(d=0;d<e;d++)if(a.isDark(c,d)){var g=b("use",{x:String(c),y:String(d)});g.setAttributeNS("http://www.w3.org/1999/xlink",
"href","#template");f.appendChild(g)}};a.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)};return a}(),b="svg"===document.documentElement.tagName.toLowerCase()?s:"undefined"==typeof CanvasRenderingContext2D?function(){var a=function(a,b){this._el=a;this._htOption=b};a.prototype.draw=function(a){for(var b=this._htOption,c=this._el,d=a.getModuleCount(),e=Math.floor(b.width/d),f=Math.floor(b.height/d),g=['\x3ctable style\x3d"border:0;border-collapse:collapse;"\x3e'],
h=0;h<d;h++){g.push("\x3ctr\x3e");for(var k=0;k<d;k++)g.push('\x3ctd style\x3d"border:0;border-collapse:collapse;padding:0;margin:0;width:'+e+"px;height:"+f+"px;background-color:"+(a.isDark(h,k)?b.colorDark:b.colorLight)+';"\x3e\x3c/td\x3e');g.push("\x3c/tr\x3e")}g.push("\x3c/table\x3e");c.innerHTML=g.join("");a=c.childNodes[0];c=(b.width-a.offsetWidth)/2;b=(b.height-a.offsetHeight)/2;0<c&&0<b&&(a.style.margin=b+"px "+c+"px")};a.prototype.clear=function(){this._el.innerHTML=""};return a}():function(){function a(){this._elImage.src=
this._elCanvas.toDataURL("image/png");this._elImage.style.display="block";this._elCanvas.style.display="none"}function b(a,c){var d=this;d._fFail=c;d._fSuccess=a;if(null===d._bSupportDataURI){var e=document.createElement("img"),f=function(){d._bSupportDataURI=!1;d._fFail&&_fFail.call(d)};e.onabort=f;e.onerror=f;e.onload=function(){d._bSupportDataURI=!0;d._fSuccess&&d._fSuccess.call(d)};e.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg\x3d\x3d"}else!0===
d._bSupportDataURI&&d._fSuccess?d._fSuccess.call(d):!1===d._bSupportDataURI&&d._fFail&&d._fFail.call(d)}if(this._android&&2.1>=this._android){var c=1/window.devicePixelRatio,d=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(a,b,e,f,g,h,k,n,l){if("nodeName"in a&&/img/i.test(a.nodeName))for(var r=arguments.length-1;1<=r;r--)arguments[r]*=c;else"undefined"==typeof n&&(arguments[1]*=c,arguments[2]*=c,arguments[3]*=c,arguments[4]*=c);d.apply(this,arguments)}}var f=
function(a,b){this._bIsPainted=!1;this._android=e();this._htOption=b;this._elCanvas=document.createElement("canvas");this._elCanvas.width=b.width;this._elCanvas.height=b.height;a.appendChild(this._elCanvas);this._el=a;this._oContext=this._elCanvas.getContext("2d");this._bIsPainted=!1;this._elImage=document.createElement("img");this._elImage.alt="Scan me!";this._elImage.style.display="none";this._el.appendChild(this._elImage);this._bSupportDataURI=null};f.prototype.draw=function(a){var b=this._elImage,
c=this._oContext,d=this._htOption,e=a.getModuleCount(),f=d.width/e,g=d.height/e,h=Math.round(f),k=Math.round(g);b.style.display="none";this.clear();for(b=0;b<e;b++)for(var n=0;n<e;n++){var l=a.isDark(b,n),r=n*f,m=b*g;c.strokeStyle=l?d.colorDark:d.colorLight;c.lineWidth=1;c.fillStyle=l?d.colorDark:d.colorLight;c.fillRect(r,m,f,g);c.strokeRect(Math.floor(r)+0.5,Math.floor(m)+0.5,h,k);c.strokeRect(Math.ceil(r)-0.5,Math.ceil(m)-0.5,h,k)}this._bIsPainted=!0};f.prototype.makeImage=function(){this._bIsPainted&&
b.call(this,a)};f.prototype.isPainted=function(){return this._bIsPainted};f.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height);this._bIsPainted=!1};f.prototype.round=function(a){return!a?a:Math.floor(1E3*a)/1E3};return f}();l=function(a,c){this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:d.H};"string"===typeof c&&(c={text:c});if(c)for(var f in c)this._htOption[f]=c[f];"string"==typeof a&&(a=document.getElementById(a));
this._android=e();this._el=a;this._oQRCode=null;this._oDrawing=new b(this._el,this._htOption);this._htOption.text&&this.makeCode(this._htOption.text)};l.prototype.makeCode=function(a){var b=this._htOption.correctLevel,c=1,e;e=encodeURI(a).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");e=e.length+(e.length!=a?3:0);for(var g=0,k=t.length;g<=k;g++){var l=0;switch(b){case d.L:l=t[g][0];break;case d.M:l=t[g][1];break;case d.Q:l=t[g][2];break;case d.H:l=t[g][3]}if(e<=l)break;else c++}if(c>t.length)throw Error("Too long data");
this._oQRCode=new f(c,this._htOption.correctLevel);this._oQRCode.addData(a);this._oQRCode.make();this._el.title=a;this._oDrawing.draw(this._oQRCode);this.makeImage()};l.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||3<=this._android)&&this._oDrawing.makeImage()};l.prototype.clear=function(){this._oDrawing.clear()};l.CorrectLevel=d;window.QRCode=l})()})},"dojox/main":function(){define(["dojo/_base/kernel"],function(p){return p.dojox})},"builder/plugins/app-config-template-configpart/_build-generate_module":function(){define(["builder/plugins/app-config-template-configpart/Plugin",
"dojo/text!builder/plugins/app-config-template-configpart/Plugin.html","dojo/text!builder/plugins/app-config-template-configpart/css/style.css","dojo/i18n!builder/plugins/app-config-template-configpart/nls/strings"],function(){})},"builder/plugins/app-config-template-configpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/html dojo/promise/all dojo/_base/array dojo/topic builder/BasePlugin jimu/utils builder/dijit/TemplateAttributes".split(" "),function(p,
f,a,l,k,h,q,m,g,e){return p([m],{baseClass:"plugin-appconfig-template-configpart",_appConfig:null,_appConfigLoadDef:null,postCreate:function(){this.inherited(arguments);this._appConfigLoadDef=new a;this._bindEvent()},startup:function(){this.inherited(arguments);this.isAdvance=!1;k({appConfig:this._appConfigLoadDef}).then(f.hitch(this,function(){this._init()}))},_init:function(){if(this.visible&&this._appConfig){var a=this._getCleanTemplateConfigByAppConfig(this._appConfig.templateConfig);this.agoltempAttrs&&
this.agoltempAttrs.destroy();this.agoltempAttrs=(new e({templateConfig:a})).placeAt(this.configPart);this.agoltempAttrs.on("fieldChanged",f.hitch(this,this._onAGOLTemplateAttributeChanged))}},_getCleanTemplateConfigByAppConfig:function(a){var d={configurationSettings:[],values:{}};if(a)return h.forEach(a.configurationSettings,function(a){var c={category:a.category,fields:[]};h.forEach(a.fields,function(a){if(a.fieldName){var e=g.template.getConfigValueWithId(this._appConfig,a.fieldName);void 0!==
e&&(c.fields.push(a),d.values[a.fieldName]=e)}},this);0<c.fields.length&&d.configurationSettings.push(c)},this),d},_getTemplateAppConfigByTemplateConfig:function(a,d){var e=this._getDefaultTemplateAppConfig();if(d)return h.forEach(d.configurationSettings,function(d){h.forEach(d.fields,function(d){if(d.fieldName){var f=g.template.getConfigValueWithId(a,d.fieldName);void 0!==f&&(e.values[d.fieldName]=f)}},this)},this),e},_getChangedTemplateAppConfigFromTemplateAttirbuts:function(a){var d=this._getDefaultTemplateAppConfig(),
e=this.agoltempAttrs.getElementDijits(),f;for(f in e)if(e.hasOwnProperty(f)&&"function"!==typeof e[f]){var h=g.template.getConfigValueWithId(a,f);void 0!==h&&h!==e[f].getDijitValue()&&(d.values[f]=h)}return d},_getDefaultTemplateConfig:function(){return{configurationSettings:[{category:"",fields:[]}],values:{}}},_getDefaultTemplateAppConfig:function(){return{source:null,folderId:null,values:{}}},_onAGOLTemplateAttributeChanged:function(a){g.template.setConfigValueWithId(this._appConfig,a.fieldName,
a.value);"Attribute"===a.categoryName?q.publish("appAttributeChanged",{title:this._appConfig.title,subtitle:this._appConfig.subtitle,links:this._appConfig.links,logo:this._appConfig.logo}):(a=g.template.getKeyInfo(a.fieldName),"widget"===a.type?(a=this._appConfig.getConfigElementById(a.id),q.publish("widgetChanged",a)):"group"===a.type?(a=this._appConfig.getConfigElementById(a.id),q.publish("groupChanged",a)):console.errror("errror"))},_bindEvent:function(){this.own(q.subscribe("app/appConfigLoaded",
f.hitch(this,this._onAppConfigLoaded)));this.own(q.subscribe("app/appConfigChanged",f.hitch(this,this._onAppConfigChanged)));this.own(q.subscribe("new-webmap-item-selected",f.hitch(this,this._onWebmapItemSelected)));this.own(q.subscribe("app/mapLoaded",f.hitch(this,this._onMapLoaded)));var a=this.pluginManager.getPluginByName("map-config");a?l.setAttr(this.selectMapBtn,"innerHTML",a.nls.selectWebMap):this.own(this.pluginManager.on("pluginCreated",f.hitch(this,function(a){"map-config"===a.name&&l.setAttr(this.selectMapBtn,
"innerHTML",a.nls.selectWebMap)})))},_onAppConfigLoaded:function(a){this._appConfig=f.clone(a);this._appConfigLoadDef.resolve(this._appConfig)},_onAppConfigChanged:function(a){this._appConfig=f.clone(a)},_onSelectMapClick:function(){var a=this.pluginManager.getPluginByName("map-config");a&&a.showMapSelector()},_onWebmapItemSelected:function(a){l.setAttr(this.mapName,"innerHTML",a.title);l.setAttr(this.mapName,"title",a.title)},_onMapLoaded:function(a){l.setAttr(this.mapName,"innerHTML",a.itemInfo.item.title);
l.setAttr(this.mapName,"title",a.itemInfo.item.title)},refresh:function(){this._init()}})})},"builder/dijit/TemplateAttributes":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/html dojo/on dojo/promise/all dojo/Evented jimu/utils dijit/_WidgetBase dijit/_TemplatedMixin dijit/form/_FormMixin dijit/Tooltip dijit/form/CheckBox dijit/form/NumberTextBox dijit/form/Select dijit/form/ValidationTextBox dijit/form/SimpleTextarea dijit/Editor esri/dijit/ColorPicker dijit/_editor/plugins/TextColor dijit/_editor/plugins/LinkDialog".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w){var x=p([e,c,d,m],{templateString:'\x3cdiv dojoAttachPoint\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"agoltemplate-attributes",item:null,itemTitle:null,defaultMaxSelectHeight:"150px",defaultTextAreaSize:5,_appConfig:null,_templateConfig:null,_templateAppConfig:null,_elementDijits:null,constructor:function(a){this.nls=f.mixin(this.nls,builderNls);this._init(a.templateConfig,a.templateAppConfig)},destroy:function(){a.forEach(this.tooltips,function(a){a.destroy()});
this.inherited(arguments)},startup:function(){this.buildConfigurationPanel();this.inherited(arguments)},update:function(a){for(var b in a.values)a.values.hasOwnProperty(b)&&"function"!==typeof a.values[b]&&this._elementDijits[b].setDijitValue(a.values[b])},getElementDijits:function(){return this._elementDijits},getTemplateAppConfig:function(){var a=this._getValuesObjOfElementDijits();f.mixin(this._templateAppConfig.values,a);return this._templateAppConfig},onFieldChange:function(a,b,c){this.emit("fieldChanged",
{categoryName:a,fieldName:b,value:c})},_init:function(a,b){this._templateConfig=a||{configurationSettings:{},values:{}};this._templateAppConfig=b||{source:null,folderId:null,values:{webmap:null}};f.mixin(this._templateConfig.values,this._templateAppConfig.values);this._elementDijits={};(!this._templateConfig.configurationSettings||!this._templateAppConfig.values)&&console.error("AGOLTemplate config page: please provide correct parameters in the constructor");this.tooltips=[];this.originalItem={id:this._templateConfig.values.webmap||
this._templateConfig.values.group,type:this._templateConfig.values.webmap?"webmap":"group"}},_getWebmapOrGroupItem:function(a,b){var c=new l;try{"webmap"===b?this.portal.queryItems({q:"id:"+a}).then(f.hitch(this,function(a){0<a.results.length&&(this.item=a=a.results[0],this.itemTitle=a.title);c.resolve()})):this.portal.queryGroups({q:"id:"+a}).then(f.hitch(this,function(a){0<a.results.length&&(this.item=a=a.results[0],this.itemTitle=a.title);c.resolve()}))}catch(d){c.resolve()}return c.promise},buildConfigurationPanel:function(){var b=
[];a.forEach(this._templateConfig.configurationSettings,f.hitch(this,function(c){var d=c.category,e=c.fields,g=k.create("fieldset",{},this.containerNode);k.create("legend",f.mixin(c.params||{},{innerHTML:d}),g);a.forEach(e,f.hitch(this,function(c){b.push(this._createField(c,d).then(f.hitch(this,function(b){a.forEach(b.nodes,function(a){k.place(a.domNode||a,g)});k.create("br",{},g);"paragraph"!==b.type&&null!==b.fieldDijit&&c.tooltip&&c.tooltip.length&&this.tooltips.push(new r({connectId:[b.fieldDijit.id],
label:c.tooltip}))})))}))}));q(b).then(f.hitch(this,function(){}))},_createField:function(a,b){var c=new l,d=null,e=a.type&&a.type.toLowerCase()||"string",f=[],h=k.create("layerandfieldselector"===e?"p":"label",{innerHTML:g.stripHTML(a.label)||"",id:e+"_"+a.fieldName,"class":e},null);f.push(h);"boolean"===e?(f.splice(0,0,d=this._createBooleanField(a,b)),k.addClass(h,"checkout-box-label")):"number"===e?f.push(d=this._createNumberField(a,b)):"paragraph"===e?f.splice(0,1,d=this._createParagraph(a)):
a.options?f.push(d=this._createOptionsField(a,b)):"color"===e?f.push(d=this._createColor(a,b)):f.push(d=this._createStringField(a,b));k.setAttr(h,"for",d.id);c.resolve({nodes:f,fieldDijit:d,type:e});return c.promise},_createBooleanField:function(a,b){var c=f.mixin({value:!0,name:a.fieldName},a),d=this._templateConfig.values;c.checked=d&&void 0!==d[a.fieldName]?d[a.fieldName]:!0;c=new u(c);this._afterCreateNormalField(c,b,a.fieldName);return c},_createNumberField:function(a,b){var c=f.mixin({name:a.fieldName,
"class":"field-input"},a),d=this._templateConfig.values;c.value=d&&void 0!==d[a.fieldName]?d[a.fieldName]:a.min||NaN;c=new s(c);this._afterCreateNormalField(c,b,a.fieldName);return c},_createParagraph:function(a){var b=f.mixin({name:a.fieldName||""},a);b.innerHTML=a.value||"";return k.create("p",b)},_createOptionsField:function(b,c){var d={maxHeight:this.defaultMaxSelectHeight,name:b.fieldName,"class":"field-input"},d=f.mixin(d,b),e=-1,g=a.some(d.options,f.hitch(this,function(a,c){e=c;return a.value===
this._templateConfig.values[b.fieldName]?c:!1}));d.options[g?e:0].selected=!0;d=new t(d);this._afterCreateNormalField(d,c,b.fieldName);return d},_createStringField:function(a,c){var d=null,d={regExp:".*",constraints:{},trim:!0,name:a.fieldName,value:(this._templateConfig.values[a.fieldName]||"").toString(),"class":" "},d=f.mixin(d,a);a.stringFieldOption&&a.stringFieldOption===x.STRING_FIELD_OPTION_TEXTAREA?(d["class"]+=" field-input text-area-field",d.rows=a.rows||this.defaultTextAreaSize,d.columns=
a.columns||this.defaultTextAreaSize,d=new v(d)):a.stringFieldOption&&a.stringFieldOption===x.STRING_FIELD_OPTION_RICHTEXT?(d["class"]+=" rich-text-field",d.plugins="bold italic underline foreColor hiliteColor removeFormat | justifyLeft indent outdent | insertOrderedList insertUnorderedList |".split(" "),d.extraPlugins=["createLink","unlink","insertImage"],d=new n(d)):(d["class"]+=" field-input",d=new b(d));this._afterCreateNormalField(d,c,a.fieldName);return d},_createColor:function(a,b){var c=new w({name:a.fieldName,
required:!0,showTransparencySlider:!1,showRecentColors:!1,"class":"color-picker-field"});this._templateConfig.values[a.fieldName]&&c.set("color",this._templateConfig.values[a.fieldName]);c.setDijitValue=f.hitch(c,function(a){this.set("color",a,!1)});c.getDijitValue=f.hitch(c,function(){this.get("color")});this._elementDijits[a.fieldName]=c;c.on("color-change",f.hitch(this,function(c){if(c&&c.color)this.onFieldChange(b,a.fieldName,c.color.toHex())}));return c},_afterCreateNormalField:function(a,b,
c){a.setDijitValue=f.hitch(a,function(a){this.set("value",a,!1)});a.getDijitValue=f.hitch(a,function(){return this.get("value")});this._elementDijits[c]=a;this.own(h(a,"change",f.hitch(this,this.onFieldChange,b,c)))},_getValuesObjOfElementDijits:function(){var a={},b=this.getElementDijits(),c;for(c in b)b.hasOwnProperty(c)&&"function"!==typeof b[c]&&(a[c]=b[c].getDijitValue());return a}});f.mixin(x,{STRING_FIELD_OPTION_TEXTBOX:"textbox",STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_RICHTEXT:"richtext"});
return x})},"dijit/form/CheckBox":function(){define("require dojo/_base/declare dojo/dom-attr dojo/has dojo/query dojo/ready ./ToggleButton ./_CheckBoxMixin dojo/text!./templates/CheckBox.html dojo/NodeList-dom ../a11yclick".split(" "),function(p,f,a,l,k,h,q,m,g){l("dijit-legacy-requires")&&h(0,function(){p(["dijit/form/RadioButton"])});return f("dijit.form.CheckBox",[q,m],{templateString:g,baseClass:"dijitCheckBox",_setValueAttr:function(a,c){"string"==typeof a&&(this.inherited(arguments),a=!0);
this._created&&this.set("checked",a,c)},_getValueAttr:function(){return this.checked&&this._get("value")},_setIconClassAttr:null,_setNameAttr:"focusNode",postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=""},_fillContent:function(){},_onFocus:function(){this.id&&k("label[for\x3d'"+this.id+"']").addClass("dijitFocusedLabel");this.inherited(arguments)},_onBlur:function(){this.id&&k("label[for\x3d'"+this.id+"']").removeClass("dijitFocusedLabel");this.inherited(arguments)}})})},
"dijit/form/ToggleButton":function(){define(["dojo/_base/declare","dojo/_base/kernel","./Button","./_ToggleButtonMixin"],function(p,f,a,l){return p("dijit.form.ToggleButton",[a,l],{baseClass:"dijitToggleButton",setChecked:function(a){f.deprecated("setChecked("+a+") is deprecated. Use set('checked',"+a+") instead.","","2.0");this.set("checked",a)}})})},"dijit/form/_ToggleButtonMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(p,f){return p("dijit.form._ToggleButtonMixin",null,
{checked:!1,_aria_attr:"aria-pressed",_onClick:function(a){var f=this.checked;this._set("checked",!f);var k=this.inherited(arguments);this.set("checked",k?this.checked:f);return k},_setCheckedAttr:function(a,l){this._set("checked",a);var k=this.focusNode||this.domNode;this._created&&f.get(k,"checked")!=!!a&&f.set(k,"checked",!!a);k.setAttribute(this._aria_attr,String(a));this._handleOnChange(a,l)},postCreate:function(){this.inherited(arguments);var a=this.focusNode||this.domNode;this.checked&&a.setAttribute("checked",
"checked");void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.checked)},reset:function(){this._hasBeenBlurred=!1;this.set("checked",this.params.checked||!1)}})})},"dijit/form/_CheckBoxMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(p,f){return p("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:!1,_aria_attr:"aria-checked",_setReadOnlyAttr:function(a){this._set("readOnly",a);f.set(this.focusNode,"readOnly",a)},_setLabelAttr:void 0,
_getSubmitValue:function(a){return null==a||""===a?"on":a},_setValueAttr:function(a){a=this._getSubmitValue(a);this._set("value",a);f.set(this.focusNode,"value",a)},reset:function(){this.inherited(arguments);this._set("value",this._getSubmitValue(this.params.value));f.set(this.focusNode,"value",this.value)},_onClick:function(a){return this.readOnly?(a.stopPropagation(),a.preventDefault(),!1):this.inherited(arguments)}})})},"dijit/form/NumberTextBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/i18n dojo/string dojo/number ./RangeBoundTextBox".split(" "),
function(p,f,a,l,k,h){var q=function(f){f=f||{};var e=a.getLocalization("dojo.cldr","number",a.normalizeLocale(f.locale)),c=f.pattern?f.pattern:e[(f.type||"decimal")+"Format"];f="number"==typeof f.places?f.places:"string"===typeof f.places&&0<f.places.length?f.places.replace(/.*,/,""):-1!=c.indexOf(".")?c.split(".")[1].replace(/[^#0]/g,"").length:0;return{sep:e.decimal,places:f}},m=p("dijit.form.NumberTextBoxMixin",null,{pattern:function(a){return"("+(this.focused&&this.editOptions?this._regExpGenerator(f.delegate(a,
this.editOptions))+"|":"")+this._regExpGenerator(a)+")"},value:NaN,editOptions:{pattern:"#.######"},_formatter:k.format,_regExpGenerator:k.regexp,_decimalInfo:q(),postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},_setConstraintsAttr:function(a){var e="number"==typeof a.places?a.places:0;e&&e++;"number"!=typeof a.max&&(a.max=9*Math.pow(10,15-e));"number"!=typeof a.min&&(a.min=-9*Math.pow(10,15-e));this.inherited(arguments,[a]);this.focusNode&&(this.focusNode.value&&
!isNaN(this.value))&&this.set("value",this.value);this._decimalInfo=q(a)},_onFocus:function(){if(!this.disabled&&!this.readOnly){var a=this.get("value");"number"==typeof a&&!isNaN(a)&&(a=this.format(a,this.constraints),void 0!==a&&(this.textbox.value=a));this.inherited(arguments)}},format:function(a,e){var c=String(a);if("number"!=typeof a)return c;if(isNaN(a))return"";if(!("rangeCheck"in this&&this.rangeCheck(a,e))&&!1!==e.exponent&&/\de[-+]?\d/i.test(c))return c;this.editOptions&&this.focused&&
(e=f.mixin({},e,this.editOptions));return this._formatter(a,e)},_parser:k.parse,parse:function(a,e){var c=f.mixin({},e,this.editOptions&&this.focused?this.editOptions:{});if(this.focused&&null!=c.places){var d=c.places,d="number"===typeof d?d:Number(d.split(",").pop());c.places="0,"+d}c=this._parser(a,c);this.editOptions&&(this.focused&&isNaN(c))&&(c=this._parser(a,e));return c},_getDisplayedValueAttr:function(){var a=this.inherited(arguments);return isNaN(a)?this.textbox.value:a},filter:function(a){if(null==
a||"string"==typeof a&&""==a)return NaN;"number"==typeof a&&(!isNaN(a)&&0!=a)&&(a=k.round(a,this._decimalInfo.places));return this.inherited(arguments,[a])},serialize:function(a,e){return"number"!=typeof a||isNaN(a)?"":this.inherited(arguments)},_setBlurValue:function(){var a=f.hitch(f.delegate(this,{focused:!0}),"get")("value");this._setValueAttr(a,!0)},_setValueAttr:function(a,e,c){if(void 0!==a&&void 0===c)if(c=String(a),"number"==typeof a)if(isNaN(a))c="";else{if("rangeCheck"in this&&this.rangeCheck(a,
this.constraints)||!1===this.constraints.exponent||!/\de[-+]?\d/i.test(c))c=void 0}else a?a=void 0:(c="",a=NaN);this.inherited(arguments,[a,e,c])},_getValueAttr:function(){var a=this.inherited(arguments);if(isNaN(a)&&""!==this.textbox.value){if(!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)&&RegExp("^"+k._realNumberRegexp(f.delegate(this.constraints))+"$").test(this.textbox.value))return a=Number(this.textbox.value),isNaN(a)?void 0:a}else return a},isValid:function(a){if(!this.focused||
this._isEmpty(this.textbox.value))return this.inherited(arguments);var e=this.get("value");return!isNaN(e)&&this.rangeCheck(e,this.constraints)?!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)?!0:this.inherited(arguments):!1},_isValidSubset:function(){var a="number"==typeof this.constraints.min,e="number"==typeof this.constraints.max,c=this.get("value");if(isNaN(c)||!a&&!e)return this.inherited(arguments);var d=c|0,f=0>c,h=-1!=this.textbox.value.indexOf(this._decimalInfo.sep),
k=(this.maxLength||20)-this.textbox.value.length,m=h?this.textbox.value.split(this._decimalInfo.sep)[1].replace(/[^0-9]/g,""):"",d=h?d+"."+m:d+"",k=l.rep("9",k),h=c;f?h=Number(d+k):c=Number(d+k);return!(a&&c<this.constraints.min||e&&h>this.constraints.max)}});p=p("dijit.form.NumberTextBox",[h,m],{baseClass:"dijitTextBox dijitNumberTextBox"});p.Mixin=m;return p})},"dijit/form/RangeBoundTextBox":function(){define(["dojo/_base/declare","dojo/i18n","./MappedTextBox","dojo/i18n!./nls/validate"],function(p,
f,a){return p("dijit.form.RangeBoundTextBox",a,{rangeMessage:"",rangeCheck:function(a,f){return("min"in f?0<=this.compare(a,f.min):!0)&&("max"in f?0>=this.compare(a,f.max):!0)},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints)},_isDefinitelyOutOfRange:function(){var a=this.get("value");if(null==a)return!1;var f=!1;"min"in this.constraints&&(f=this.constraints.min,f=0>this.compare(a,"number"==typeof f&&0<=f&&0!=a?0:f));!f&&"max"in this.constraints&&(f=this.constraints.max,
f=0<this.compare(a,"number"!=typeof f||0<f?f:0));return f},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange()},isValid:function(a){return this.inherited(arguments)&&(this._isEmpty(this.textbox.value)&&!this.required||this.isInRange(a))},getErrorMessage:function(a){var f=this.get("value");return null!=f&&""!==f&&("number"!=typeof f||!isNaN(f))&&!this.isInRange(a)?this.rangeMessage:this.inherited(arguments)},postMixInProperties:function(){this.inherited(arguments);
this.rangeMessage||(this.messages=f.getLocalization("dijit.form","validate",this.lang),this.rangeMessage=this.messages.rangeMessage)}})})},"dijit/form/MappedTextBox":function(){define(["dojo/_base/declare","dojo/sniff","dojo/dom-construct","./ValidationTextBox"],function(p,f,a,l){return p("dijit.form.MappedTextBox",l,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting=""},_setNameAttr:"valueNode",serialize:function(a){return a.toString?a.toString():""},toString:function(){var a=
this.filter(this.get("value"));return null!=a?"string"==typeof a?a:this.serialize(a,this.constraints):""},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.valueNode=a.place("\x3cinput type\x3d'hidden'"+(this.name&&!f("msapp")?' name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"")+"/\x3e",this.textbox,"after")},reset:function(){this.valueNode.value="";this.inherited(arguments)}})})},"dijit/form/Select":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff ./_FormSelectWidget ../_HasDropDown ../DropDownMenu ../MenuItem ../MenuSeparator ../Tooltip ../_KeyNavMixin ../registry dojo/text!./templates/Select.html dojo/i18n!./nls/validate".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n){function w(a){return function(b){this._isLoaded?this.inherited(a,arguments):this.loadDropDown(m.hitch(this,a,b))}}var x=f("dijit.form._SelectMenu",r,{autoFocus:!0,buildRendering:function(){this.inherited(arguments);this.domNode.setAttribute("role","listbox")},postCreate:function(){this.inherited(arguments);this.own(g(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}))},focus:function(){var a=!1,b=this.parentWidget.value;
m.isArray(b)&&(b=b[b.length-1]);b&&p.forEach(this.parentWidget._getChildren(),function(c){c.option&&b===c.option.value&&(a=!0,this.focusChild(c,!1))},this);a||this.inherited(arguments)}});k=f("dijit.form.Select"+(e("dojo-bidi")?"_NoBidi":""),[c,d,b],{baseClass:"dijitSelect dijitValidationTextBox",templateString:n,_buttonInputDisabled:e("ie")?"disabled":"",required:!1,state:"",message:"",tooltipPosition:[],emptyLabel:"\x26#160;",_isLoaded:!1,_childrenLoaded:!1,labelType:"html",_fillContent:function(){this.inherited(arguments);
if(this.options.length&&!this.value&&this.srcNodeRef){var a=this.srcNodeRef.selectedIndex||0;this._set("value",this.options[0<=a?a:0].value)}this.dropDown=new x({id:this.id+"_menu",parentWidget:this});l.add(this.dropDown.domNode,this.baseClass.replace(/\s+|$/g,"Menu "))},_getMenuItemForOption:function(a){if(!a.value&&!a.label)return new s({ownerDocument:this.ownerDocument});var b=m.hitch(this,"_setValueAttr",a);a=new u({option:a,label:("text"===this.labelType?(a.label||"").toString().replace(/&/g,
"\x26amp;").replace(/</g,"\x26lt;"):a.label)||this.emptyLabel,onClick:b,ownerDocument:this.ownerDocument,dir:this.dir,textDir:this.textDir,disabled:a.disabled||!1});a.focusNode.setAttribute("role","option");return a},_addOptionItem:function(a){this.dropDown&&this.dropDown.addChild(this._getMenuItemForOption(a))},_getChildren:function(){return!this.dropDown?[]:this.dropDown.getChildren()},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(a){}},focusChild:function(a){a&&
this.set("value",a.option)},_getFirst:function(){var a=this._getChildren();return a.length?a[0]:null},_getLast:function(){var a=this._getChildren();return a.length?a[a.length-1]:null},childSelector:function(a){return(a=v.byNode(a))&&a.getParent()==this.dropDown},onKeyboardSearch:function(a,b,c,d){a&&this.focusChild(a)},_loadChildren:function(a){if(!0===a)if(this.dropDown&&(delete this.dropDown.focusedChild,this.focusedChild=null),this.options.length)this.inherited(arguments);else{p.forEach(this._getChildren(),
function(a){a.destroyRecursive()});var b=new u({ownerDocument:this.ownerDocument,label:this.emptyLabel});this.dropDown.addChild(b)}else this._updateSelection();this._isLoaded=!1;this._childrenLoaded=!0;this._loadingStore||this._setValueAttr(this.value,!1)},_refreshState:function(){this._started&&this.validate(this.focused)},startup:function(){this.inherited(arguments);this._refreshState()},_setValueAttr:function(b){this.inherited(arguments);a.set(this.valueNode,"value",this.get("value"));this._refreshState()},
_setNameAttr:"valueNode",_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",a);this._refreshState()},_setOptionsAttr:function(a){this._isLoaded=!1;this._set("options",a)},_setDisplay:function(a){a=("text"===this.labelType?(a||"").replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a)||this.emptyLabel;this.containerNode.innerHTML='\x3cspan role\x3d"option" aria-selected\x3d"true" class\x3d"dijitReset dijitInline '+
this.baseClass.replace(/\s+|$/g,"Label ")+'"\x3e'+a+"\x3c/span\x3e"},validate:function(a){a=this.disabled||this.isValid(a);this._set("state",a?"":this._hasBeenBlurred?"Error":"Incomplete");this.focusNode.setAttribute("aria-invalid",a?"false":"true");var b=a?"":this._missingMsg;b&&this.focused&&this._hasBeenBlurred?t.show(b,this.domNode,this.tooltipPosition,!this.isLeftToRight()):t.hide(this.domNode);this._set("message",b);return a},isValid:function(){return!this.required||0===this.value||!/^\s*$/.test(this.value||
"")},reset:function(){this.inherited(arguments);t.hide(this.domNode);this._refreshState()},postMixInProperties:function(){this.inherited(arguments);this._missingMsg=h.getLocalization("dijit.form","validate",this.lang).missingMessage},postCreate:function(){this.inherited(arguments);this.own(g(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}));this.domNode.setAttribute("aria-expanded","false");var a=this._keyNavCodes;delete a[q.LEFT_ARROW];delete a[q.RIGHT_ARROW]},_setStyleAttr:function(a){this.inherited(arguments);
l.toggle(this.domNode,this.baseClass.replace(/\s+|$/g,"FixedWidth "),!!this.domNode.style.width)},isLoaded:function(){return this._isLoaded},loadDropDown:function(a){this._loadChildren(!0);this._isLoaded=!0;a()},destroy:function(a){this.dropDown&&!this.dropDown._destroyed&&(this.dropDown.destroyRecursive(a),delete this.dropDown);t.hide(this.domNode);this.inherited(arguments)},_onFocus:function(){this.validate(!0)},_onBlur:function(){t.hide(this.domNode);this.inherited(arguments);this.validate(!1)}});
e("dojo-bidi")&&(k=f("dijit.form.Select",k,{_setDisplay:function(a){this.inherited(arguments);this.applyTextDir(this.containerNode)}}));k._Menu=x;k.prototype._onContainerKeydown=w("_onContainerKeydown");k.prototype._onContainerKeypress=w("_onContainerKeypress");return k})},"dijit/form/_FormSelectWidget":function(){define("dojo/_base/array dojo/_base/Deferred dojo/aspect dojo/data/util/sorter dojo/_base/declare dojo/dom dojo/dom-class dojo/_base/kernel dojo/_base/lang dojo/query dojo/when dojo/store/util/QueryResults ./_FormValueWidget".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r){return k("dijit.form._FormSelectWidget",r,{multiple:!1,options:null,store:null,_setStoreAttr:function(a){this._created&&this._deprecatedSetStore(a)},query:null,_setQueryAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{query:a})},queryOptions:null,_setQueryOptionsAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{queryOptions:a})},labelAttr:"",onFetch:null,sortByLabel:!0,loadChildrenOnOpen:!1,
onLoadDeferred:null,getOptions:function(a){var c=this.options||[];if(null==a)return c;if(g.isArrayLike(a))return p.map(a,"return this.getOptions(item);",this);g.isString(a)&&(a={value:a});g.isObject(a)&&(p.some(c,function(c,b){for(var d in a)if(!(d in c)||c[d]!=a[d])return!1;a=b;return!0})||(a=-1));return 0<=a&&a<c.length?c[a]:null},addOption:function(a){p.forEach(g.isArrayLike(a)?a:[a],function(a){a&&g.isObject(a)&&this.options.push(a)},this);this._loadChildren()},removeOption:function(a){a=this.getOptions(g.isArrayLike(a)?
a:[a]);p.forEach(a,function(a){a&&(this.options=p.filter(this.options,function(c){return c.value!==a.value||c.label!==a.label}),this._removeOptionItem(a))},this);this._loadChildren()},updateOption:function(a){p.forEach(g.isArrayLike(a)?a:[a],function(a){var c=this.getOptions({value:a.value}),b;if(c)for(b in a)c[b]=a[b]},this);this._loadChildren()},setStore:function(a,c,d){m.deprecated(this.declaredClass+"::setStore(store, selectedValue, fetchArgs) is deprecated. Use set('query', fetchArgs.query), set('queryOptions', fetchArgs.queryOptions), set('store', store), or set('value', selectedValue) instead.",
"","2.0");this._deprecatedSetStore(a,c,d)},_deprecatedSetStore:function(e,h,k){var b=this.store;k=k||{};if(b!==e){for(var r;r=this._notifyConnections.pop();)r.remove();e.get||(g.mixin(e,{_oldAPI:!0,get:function(a){var b=new f;this.fetchItemByIdentity({identity:a,onItem:function(a){b.resolve(a)},onError:function(a){b.reject(a)}});return b.promise},query:function(a,b){var c=new f(function(){e.abort&&e.abort()});c.total=new f;var e=this.fetch(g.mixin({query:a,onBegin:function(a){c.total.resolve(a)},
onComplete:function(a){c.resolve(a)},onError:function(a){c.reject(a)}},b));return new d(c)}}),e.getFeatures()["dojo.data.api.Notification"]&&(this._notifyConnections=[a.after(e,"onNew",g.hitch(this,"_onNewItem"),!0),a.after(e,"onDelete",g.hitch(this,"_onDeleteItem"),!0),a.after(e,"onSet",g.hitch(this,"_onSetItem"),!0)]));this._set("store",e)}this.options&&this.options.length&&this.removeOption(this.options);this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&
(this._observeHandle.remove(),this._observeHandle=null);k.query&&this._set("query",k.query);k.queryOptions&&this._set("queryOptions",k.queryOptions);e&&e.query&&(this._loadingStore=!0,this.onLoadDeferred=new f,this._queryRes=e.query(this.query,this.queryOptions),c(this._queryRes,g.hitch(this,function(a){if(this.sortByLabel&&!k.sort&&a.length)if(e.getValue)a.sort(l.createSortFunction([{attribute:e.getLabelAttributes(a[0])[0]}],e));else{var b=this.labelAttr;a.sort(function(a,c){return a[b]>c[b]?1:c[b]>
a[b]?-1:0})}k.onFetch&&(a=k.onFetch.call(this,a,k));p.forEach(a,function(a){this._addOptionForItem(a)},this);this._queryRes.observe&&(this._observeHandle=this._queryRes.observe(g.hitch(this,function(a,b,c){b==c?this._onSetItem(a):(-1!=b&&this._onDeleteItem(a),-1!=c&&this._onNewItem(a))}),!0));this._loadingStore=!1;this.set("value","_pendingValue"in this?this._pendingValue:h);delete this._pendingValue;this.loadChildrenOnOpen?this._pseudoLoadChildren(a):this._loadChildren();this.onLoadDeferred.resolve(!0);
this.onSetStore()}),g.hitch(this,function(a){console.error("dijit.form.Select: "+a.toString());this.onLoadDeferred.reject(a)})));return b},_setValueAttr:function(a,c){this._onChangeActive||(c=null);if(this._loadingStore)this._pendingValue=a;else if(null!=a){a=g.isArrayLike(a)?p.map(a,function(a){return g.isObject(a)?a:{value:a}}):g.isObject(a)?[a]:[{value:a}];a=p.filter(this.getOptions(a),function(a){return a&&a.value});var d=this.getOptions()||[];if(!this.multiple&&(!a[0]||!a[0].value)&&d.length)a[0]=
d[0];p.forEach(d,function(b){b.selected=p.some(a,function(a){return a.value===b.value})});d=p.map(a,function(a){return a.value});if(!("undefined"==typeof d||"undefined"==typeof d[0])){var b=p.map(a,function(a){return a.label});this._setDisplay(this.multiple?b:b[0]);this.inherited(arguments,[this.multiple?d:d[0],c]);this._updateSelection()}}},_getDisplayedValueAttr:function(){var a=p.map([].concat(this.get("selectedOptions")),function(a){return a&&"label"in a?a.label:a?a.value:null},this);return this.multiple?
a:a[0]},_setDisplayedValueAttr:function(a){this.set("value",this.getOptions("string"==typeof a?{label:a}:a))},_loadChildren:function(){this._loadingStore||(p.forEach(this._getChildren(),function(a){a.destroyRecursive()}),p.forEach(this.options,this._addOptionItem,this),this._updateSelection())},_updateSelection:function(){this.focusedChild=null;this._set("value",this._getValueFromOpts());var a=[].concat(this.value);if(a&&a[0]){var c=this;p.forEach(this._getChildren(),function(d){var b=p.some(a,function(a){return d.option&&
a===d.option.value});b&&!c.multiple&&(c.focusedChild=d);q.toggle(d.domNode,this.baseClass.replace(/\s+|$/g,"SelectedOption "),b);d.domNode.setAttribute("aria-selected",b?"true":"false")},this)}},_getValueFromOpts:function(){var a=this.getOptions()||[];if(!this.multiple&&a.length){var c=p.filter(a,function(a){return a.selected})[0];if(c&&c.value)return c.value;a[0].selected=!0;return a[0].value}return this.multiple?p.map(p.filter(a,function(a){return a.selected}),function(a){return a.value})||[]:""},
_onNewItem:function(a,c){(!c||!c.parent)&&this._addOptionForItem(a)},_onDeleteItem:function(a){this.removeOption({value:this.store.getIdentity(a)})},_onSetItem:function(a){this.updateOption(this._getOptionObjForItem(a))},_getOptionObjForItem:function(a){var c=this.store,d=this.labelAttr&&this.labelAttr in a?a[this.labelAttr]:c.getLabel(a);return{value:d?c.getIdentity(a):null,label:d,item:a}},_addOptionForItem:function(a){var c=this.store;c.isItemLoaded&&!c.isItemLoaded(a)?c.loadItem({item:a,onItem:function(a){this._addOptionForItem(a)},
scope:this}):(a=this._getOptionObjForItem(a),this.addOption(a))},constructor:function(a){this._oValue=(a||{}).value||null;this._notifyConnections=[]},buildRendering:function(){this.inherited(arguments);h.setSelectable(this.focusNode,!1)},_fillContent:function(){this.options||(this.options=this.srcNodeRef?e("\x3e *",this.srcNodeRef).map(function(a){return"separator"===a.getAttribute("type")?{value:"",label:"",selected:!1,disabled:!1}:{value:a.getAttribute("data-"+m._scopeName+"-value")||a.getAttribute("value"),
label:String(a.innerHTML),selected:a.getAttribute("selected")||!1,disabled:a.getAttribute("disabled")||!1}},this):[]);this.value?this.multiple&&"string"==typeof this.value&&this._set("value",this.value.split(",")):this._set("value",this._getValueFromOpts())},postCreate:function(){this.inherited(arguments);a.after(this,"onChange",g.hitch(this,"_updateSelection"));var c=this.store;if(c&&(c.getIdentity||c.getFeatures()["dojo.data.api.Identity"]))this.store=null,this._deprecatedSetStore(c,this._oValue,
{query:this.query,queryOptions:this.queryOptions});this._storeInitialized=!0},startup:function(){this._loadChildren();this.inherited(arguments)},destroy:function(){for(var a;a=this._notifyConnections.pop();)a.remove();this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&(this._observeHandle.remove(),this._observeHandle=null);this.inherited(arguments)},_addOptionItem:function(){},_removeOptionItem:function(){},_setDisplay:function(){},_getChildren:function(){return[]},
_getSelectedOptionsAttr:function(){return this.getOptions({selected:!0})},_pseudoLoadChildren:function(){},onSetStore:function(){}})})},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(p){var f={};p.setObject("dojo.data.util.sorter",f);f.basicComparator=function(a,f){var k=-1;null===a&&(a=void 0);null===f&&(f=void 0);if(a==f)k=0;else if(a>f||null==a)k=1;return k};f.createSortFunction=function(a,l){function k(a,c,d,e){return function(b,f){var g=e.getValue(b,a),h=e.getValue(f,
a);return c*d(g,h)}}for(var h=[],q,m=l.comparatorMap,g=f.basicComparator,e=0;e<a.length;e++){q=a[e];var c=q.attribute;if(c){q=q.descending?-1:1;var d=g;m&&("string"!==typeof c&&"toString"in c&&(c=c.toString()),d=m[c]||g);h.push(k(c,q,d,l))}}return function(a,c){for(var d=0;d<h.length;){var e=h[d++](a,c);if(0!==e)return e}return 0}};return f})},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../when"],function(p,f,a){var l=function(k){function h(f){k[f]=
function(){var g=arguments,e=a(k,function(a){Array.prototype.unshift.call(g,a);return l(p[f].apply(p,g))});if("forEach"!==f||q)return e}}if(!k)return k;var q=!!k.then;q&&(k=f.delegate(k));h("forEach");h("filter");h("map");null==k.total&&(k.total=a(k,function(a){return a.length}));return k};f.setObject("dojo.store.util.QueryResults",l);return l})},"dijit/_HasDropDown":function(){define("dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on dojo/touch ./registry ./focus ./popup ./_FocusMixin".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t){return p("dijit._HasDropDown",t,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:!0,forceWidth:!1,maxHeight:-1,dropDownPosition:["below","above"],_stopClickEvents:!0,_onDropDownMouseDown:function(a){!this.disabled&&!this.readOnly&&("MSPointerDown"!=a.type&&"pointerdown"!=a.type&&a.preventDefault(),this.own(c.once(this.ownerDocument,d.release,e.hitch(this,"_onDropDownMouseUp"))),this.toggleDropDown())},
_onDropDownMouseUp:function(a){var c=this.dropDown,d=!1;if(a&&this._opened){var e=h.position(this._buttonNode,!0);if(!(a.pageX>=e.x&&a.pageX<=e.x+e.w)||!(a.pageY>=e.y&&a.pageY<=e.y+e.h)){for(e=a.target;e&&!d;)k.contains(e,"dijitPopup")?d=!0:e=e.parentNode;if(d){e=a.target;if(c.onItemClick){for(var f;e&&!(f=r.byNode(e));)e=e.parentNode;if(f&&f.onClick&&f.getParent)f.getParent().onItemClick(f,a)}return}}}if(this._opened){if(c.focus&&(!1!==c.autoFocus||"mouseup"==a.type&&!this.hovering))this._focusDropDownTimer=
this.defer(function(){c.focus();delete this._focusDropDownTimer})}else this.focus&&this.defer("focus")},_onDropDownClick:function(a){this._stopClickEvents&&(a.stopPropagation(),a.preventDefault())},buildRendering:function(){this.inherited(arguments);this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;var a={after:this.isLeftToRight()?"Right":"Left",before:this.isLeftToRight()?"Left":"Right",above:"Up",below:"Down",
left:"Left",right:"Right"}[this.dropDownPosition[0]]||this.dropDownPosition[0]||"Down";k.add(this._arrowWrapperNode||this._buttonNode,"dijit"+a+"ArrowButton")},postCreate:function(){this.inherited(arguments);var a=this.focusNode||this.domNode;this.own(c(this._buttonNode,d.press,e.hitch(this,"_onDropDownMouseDown")),c(this._buttonNode,"click",e.hitch(this,"_onDropDownClick")),c(a,"keydown",e.hitch(this,"_onKey")),c(a,"keyup",e.hitch(this,"_onKeyUp")))},destroy:function(){this._opened&&this.closeDropDown(!0);
this.dropDown&&(this.dropDown._destroyed||this.dropDown.destroyRecursive(),delete this.dropDown);this.inherited(arguments)},_onKey:function(a){if(!this.disabled&&!this.readOnly){var c=this.dropDown,d=a.target;if(c&&(this._opened&&c.handleKey)&&!1===c.handleKey(a))a.stopPropagation(),a.preventDefault();else if(c&&this._opened&&a.keyCode==g.ESCAPE)this.closeDropDown(),a.stopPropagation(),a.preventDefault();else if(!this._opened&&(a.keyCode==g.DOWN_ARROW||(a.keyCode==g.ENTER||a.keyCode==g.SPACE&&(!this._searchTimer||
a.ctrlKey||a.altKey||a.metaKey))&&("input"!==(d.tagName||"").toLowerCase()||d.type&&"text"!==d.type.toLowerCase())))this._toggleOnKeyUp=!0,a.stopPropagation(),a.preventDefault()}},_onKeyUp:function(){if(this._toggleOnKeyUp){delete this._toggleOnKeyUp;this.toggleDropDown();var a=this.dropDown;a&&a.focus&&this.defer(e.hitch(a,"focus"),1)}},_onBlur:function(){this.closeDropDown(!1);this.inherited(arguments)},isLoaded:function(){return!0},loadDropDown:function(a){a()},loadAndOpenDropDown:function(){var a=
new f,c=e.hitch(this,function(){this.openDropDown();a.resolve(this.dropDown)});this.isLoaded()?c():this.loadDropDown(c);return a},toggleDropDown:function(){!this.disabled&&!this.readOnly&&(this._opened?this.closeDropDown(!0):this.loadAndOpenDropDown())},openDropDown:function(){var a=this.dropDown,c=a.domNode,d=this._aroundNode||this.domNode,f=this,g=s.open({parent:this,popup:a,around:d,orient:this.dropDownPosition,maxHeight:this.maxHeight,onExecute:function(){f.closeDropDown(!0)},onCancel:function(){f.closeDropDown(!0)},
onClose:function(){l.set(f._popupStateNode,"popupActive",!1);k.remove(f._popupStateNode,"dijitHasDropDownOpen");f._set("_opened",!1)}});if(this.forceWidth||this.autoWidth&&d.offsetWidth>a._popupWrapper.offsetWidth){var d=d.offsetWidth-a._popupWrapper.offsetWidth,r={w:a.domNode.offsetWidth+d};this._origStyle=c.style.cssText;e.isFunction(a.resize)?a.resize(r):h.setMarginBox(c,r);"R"==g.corner[1]&&(a._popupWrapper.style.left=a._popupWrapper.style.left.replace("px","")-d+"px")}l.set(this._popupStateNode,
"popupActive","true");k.add(this._popupStateNode,"dijitHasDropDownOpen");this._set("_opened",!0);this._popupStateNode.setAttribute("aria-expanded","true");this._popupStateNode.setAttribute("aria-owns",a.id);"presentation"!==c.getAttribute("role")&&!c.getAttribute("aria-labelledby")&&c.setAttribute("aria-labelledby",this.id);return g},closeDropDown:function(a){this._focusDropDownTimer&&(this._focusDropDownTimer.remove(),delete this._focusDropDownTimer);this._opened&&(this._popupStateNode.setAttribute("aria-expanded",
"false"),a&&this.focus&&this.focus(),s.close(this.dropDown),this._opened=!1);this._origStyle&&(this.dropDown.domNode.style.cssText=this._origStyle,delete this._origStyle)}})})},"dijit/popup":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on ./place ./BackgroundIframe ./Viewport ./main dojo/touch".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t){function b(){this._popupWrapper&&
(h.destroy(this._popupWrapper),delete this._popupWrapper)}a=a(null,{_stack:[],_beginZIndex:1E3,_idGen:1,_repositionAll:function(){if(this._firstAroundNode){var a=this._firstAroundPosition,b=q.position(this._firstAroundNode,!0),d=b.x-a.x,a=b.y-a.y;if(d||a){this._firstAroundPosition=b;for(b=0;b<this._stack.length;b++){var e=this._stack[b].wrapper.style;e.top=parseFloat(e.top)+a+"px";"auto"==e.right?e.left=parseFloat(e.left)+d+"px":e.right=parseFloat(e.right)-d+"px"}}this._aroundMoveListener=setTimeout(c.hitch(this,
"_repositionAll"),d||a?10:50)}},_createWrapper:function(a){var c=a._popupWrapper,e=a.domNode;c||(c=h.create("div",{"class":"dijitPopup",style:{display:"none"},role:"region","aria-label":a["aria-label"]||a.label||a.name||a.id},a.ownerDocumentBody),c.appendChild(e),e=e.style,e.display="",e.visibility="",e.position="",e.top="0px",a._popupWrapper=c,f.after(a,"destroy",b,!0),"ontouchend"in document&&d(c,"touchend",function(a){/^(input|button|textarea)$/i.test(a.target.tagName)||a.preventDefault()}),c.dojoClick=
!0);return c},moveOffScreen:function(a){var b=this._createWrapper(a);a=q.isBodyLtr(a.ownerDocument);var c={visibility:"hidden",top:"-9999px",display:""};c[a?"left":"right"]="-9999px";c[a?"right":"left"]="auto";m.set(b,c);return b},hide:function(a){var b=this._createWrapper(a);m.set(b,{display:"none",height:"auto",overflowY:"visible",border:""});a=a.domNode;"_originalStyle"in a&&(a.style.cssText=a._originalStyle)},getTopPopup:function(){for(var a=this._stack,b=a.length-1;0<b&&a[b].parent===a[b-1].widget;b--);
return a[b]},open:function(a){for(var b=this._stack,f=a.popup,h=f.domNode,t=a.orient||["below","below-alt","above","above-alt"],p=a.parent?a.parent.isLeftToRight():q.isBodyLtr(f.ownerDocument),A=a.around,B=a.around&&a.around.id?a.around.id+"_dropdown":"popup_"+this._idGen++;b.length&&(!a.parent||!l.isDescendant(a.parent.domNode,b[b.length-1].widget.domNode));)this.close(b[b.length-1].widget);var F=this.moveOffScreen(f);f.startup&&!f._started&&f.startup();var E,H=q.position(h);if("maxHeight"in a&&
-1!=a.maxHeight)E=a.maxHeight||Infinity;else{E=s.getEffectiveBox(this.ownerDocument);var I=A?q.position(A,!1):{y:a.y-(a.padding||0),h:2*(a.padding||0)};E=Math.floor(Math.max(I.y,E.h-(I.y+I.h)))}H.h>E&&(H=m.getComputedStyle(h),m.set(F,{overflowY:"scroll",height:E+"px",border:H.borderLeftWidth+" "+H.borderLeftStyle+" "+H.borderLeftColor}),h._originalStyle=h.style.cssText,h.style.border="none");k.set(F,{id:B,style:{zIndex:this._beginZIndex+b.length},"class":"dijitPopup "+(f.baseClass||f["class"]||"").split(" ")[0]+
"Popup",dijitPopupParent:a.parent?a.parent.id:""});0==b.length&&A&&(this._firstAroundNode=A,this._firstAroundPosition=q.position(A,!0),this._aroundMoveListener=setTimeout(c.hitch(this,"_repositionAll"),50));g("config-bgIframe")&&!f.bgIframe&&(f.bgIframe=new u(F));B=f.orient?c.hitch(f,"orient"):null;t=A?r.around(F,A,t,p,B):r.at(F,a,"R"==t?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],a.padding,B);F.style.visibility="visible";h.style.visibility="visible";h=[];h.push(d(F,"keydown",c.hitch(this,function(b){if(b.keyCode==
e.ESCAPE&&a.onCancel)b.stopPropagation(),b.preventDefault(),a.onCancel();else if(b.keyCode==e.TAB&&(b.stopPropagation(),b.preventDefault(),(b=this.getTopPopup())&&b.onCancel))b.onCancel()})));f.onCancel&&a.onCancel&&h.push(f.on("cancel",a.onCancel));h.push(f.on(f.onExecute?"execute":"change",c.hitch(this,function(){var a=this.getTopPopup();if(a&&a.onExecute)a.onExecute()})));b.push({widget:f,wrapper:F,parent:a.parent,onExecute:a.onExecute,onCancel:a.onCancel,onClose:a.onClose,handlers:h});if(f.onOpen)f.onOpen(t);
return t},close:function(a){for(var b=this._stack;a&&p.some(b,function(b){return b.widget==a})||!a&&b.length;){var c=b.pop(),d=c.widget,e=c.onClose;d.bgIframe&&(d.bgIframe.destroy(),delete d.bgIframe);if(d.onClose)d.onClose();for(var f;f=c.handlers.pop();)f.remove();d&&d.domNode&&this.hide(d);e&&e()}0==b.length&&this._aroundMoveListener&&(clearTimeout(this._aroundMoveListener),this._firstAroundNode=this._firstAroundPosition=this._aroundMoveListener=null)}});return t.popup=new a})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare",
"dojo/keys","dojo/text!./templates/Menu.html","./_MenuBase"],function(p,f,a,l){return p("dijit.DropDownMenu",l,{templateString:a,baseClass:"dijitMenu",_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(a){this._moveToPopup(a);a.stopPropagation();a.preventDefault()},_onLeftArrow:function(a){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();else this.onCancel(!1);else a.stopPropagation(),a.preventDefault()}})})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s){return f("dijit._MenuBase",[d,s,u,r],{selected:null,_setSelectedAttr:function(a){this.selected!=a&&(this.selected&&(this.selected._setSelected(!1),this._onChildDeselect(this.selected)),a&&a._setSelected(!0),this._set("selected",a))},activated:!1,_setActivatedAttr:function(a){k.toggle(this.domNode,"dijitMenuActive",a);k.toggle(this.domNode,"dijitMenuPassive",!a);this._set("activated",a)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,
childSelector:function(a){var b=c.byNode(a);return a.parentNode==this.containerNode&&b&&b.focus},postCreate:function(){var a=this,b="string"==typeof this.childSelector?this.childSelector:h.hitch(this,"childSelector");this.own(m(this.containerNode,m.selector(b,q.enter),function(){a.onItemHover(c.byNode(this))}),m(this.containerNode,m.selector(b,q.leave),function(){a.onItemUnhover(c.byNode(this))}),m(this.containerNode,m.selector(b,e),function(b){a.onItemClick(c.byNode(this),b);b.stopPropagation()}),
m(this.containerNode,m.selector(b,"focusin"),function(){a._onItemFocus(c.byNode(this))}));this.inherited(arguments)},onKeyboardSearch:function(a,b,c,d){this.inherited(arguments);if(a&&(-1==d||a.popup&&1==d))this.onItemClick(a,b)},_keyboardSearchCompare:function(a,b){return a.shortcutKey?b==a.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(a){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,
a);else(a=this._getTopMenu())&&a._isMenuBar&&a.focusNext()},_onPopupHover:function(){this.set("selected",this.currentPopupItem);this._stopPendingCloseTimer()},onItemHover:function(a){this.activated?(this.set("selected",a),a.popup&&(!a.disabled&&!this.hover_timer)&&(this.hover_timer=this.defer(function(){this._openItemPopup(a)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(a,
{type:"click"})},this.passivePopupDelay));this._hoveredChild=a;a._set("hovering",!0)},_onChildDeselect:function(a){this._stopPopupTimer();this.currentPopupItem==a&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;a._closePopup()},this.popupDelay))},onItemUnhover:function(a){this._hoveredChild==a&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);a._set("hovering",
!1)},_stopPopupTimer:function(){this.hover_timer&&(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var a=this;a.parentMenu;a=a.parentMenu);return a},onItemClick:function(a,b){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(a);if(a.disabled)return!1;if(a.popup){this.set("selected",a);this.set("activated",!0);var c=/^key/.test(b._origType||
b.type)||0==b.clientX&&0==b.clientY;this._openItemPopup(a,c)}else this.onExecute(),a._onClick?a._onClick(b):a.onClick(b)},_openItemPopup:function(a,b){if(a!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var c=a.popup;c.parentMenu=this;this.own(this._mouseoverHandle=m.once(c.domNode,"mouseover",h.hitch(this,"_onPopupHover")));var d=this;a._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){b&&
d.focusChild(a);d._cleanUp()},onExecute:h.hitch(this,"_cleanUp",!0),onClose:function(){d._mouseoverHandle&&(d._mouseoverHandle.remove(),delete d._mouseoverHandle)}},b);this.currentPopupItem=a}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(l.set(this.selected.focusNode,"tabIndex",this.tabIndex),
this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),this.currentPopupItem=null)},_onItemFocus:function(a){if(this._hoveredChild&&this._hoveredChild!=a)this.onItemUnhover(this._hoveredChild);this.set("selected",a)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(a){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);a&&this.set("selected",null)}})})},"dijit/_KeyNavContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),
function(p,f,a,l,k,h,q,m,g,e){return f("dijit._KeyNavContainer",[g,e,m],{connectKeyNavHandlers:function(a,d){var e=this._keyNavCodes={},f=h.hitch(this,"focusPrev"),g=h.hitch(this,"focusNext");p.forEach(a,function(a){e[a]=f});p.forEach(d,function(a){e[a]=g});e[k.HOME]=h.hitch(this,"focusFirstChild");e[k.END]=h.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){l.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments);p.forEach(this.getChildren(),
h.hitch(this,"_startupChild"))},addChild:function(a,d){this.inherited(arguments);this._startupChild(a)},_startupChild:function(a){a.set("tabIndex","-1")},_getFirst:function(){var a=this.getChildren();return a.length?a[0]:null},_getLast:function(){var a=this.getChildren();return a.length?a[a.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(a){return(a=
q.byNode(a))&&a.getParent()==this}})})},"dijit/_KeyNavMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "),function(p,f,a,l,k,h,q,m){return f("dijit._KeyNavMixin",m,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments);a.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var f=this._keyNavCodes={};f[l.HOME]=k.hitch(this,"focusFirstChild");f[l.END]=k.hitch(this,
"focusLastChild");f[this.isLeftToRight()?l.LEFT_ARROW:l.RIGHT_ARROW]=k.hitch(this,"_onLeftArrow");f[this.isLeftToRight()?l.RIGHT_ARROW:l.LEFT_ARROW]=k.hitch(this,"_onRightArrow");f[l.UP_ARROW]=k.hitch(this,"_onUpArrow");f[l.DOWN_ARROW]=k.hitch(this,"_onDownArrow")}var e=this,f="string"==typeof this.childSelector?this.childSelector:k.hitch(this,"childSelector");this.own(h(this.domNode,"keypress",k.hitch(this,"_onContainerKeypress")),h(this.domNode,"keydown",k.hitch(this,"_onContainerKeydown")),h(this.domNode,
"focus",k.hitch(this,"_onContainerFocus")),h(this.containerNode,h.selector(f,"focusin"),function(a){e._onChildFocus(q.getEnclosingWidget(this),a)}))},_onLeftArrow:function(){},_onRightArrow:function(){},_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},
focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(a,e){a&&(this.focusedChild&&a!==this.focusedChild&&this._onChildBlur(this.focusedChild),a.set("tabIndex",this.tabIndex),a.focus(e?"end":"start"))},_onContainerFocus:function(a){a.target!==this.domNode||this.focusedChild||this.focus()},_onFocus:function(){a.set(this.domNode,"tabIndex","-1");this.inherited(arguments)},_onBlur:function(f){a.set(this.domNode,"tabIndex",this.tabIndex);this.focusedChild&&(this.focusedChild.set("tabIndex",
"-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null));this.inherited(arguments)},_onChildFocus:function(a){a&&a!=this.focusedChild&&(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),a.set("tabIndex",this.tabIndex),this.lastFocused=a,this._set("focusedChild",a))},_searchString:"",multiCharSearchDuration:1E3,onKeyboardSearch:function(a,e,c,d){a&&this.focusChild(a)},_keyboardSearchCompare:function(a,e){var c=a.domNode,c=(a.label||(c.focusNode?
c.focusNode.label:"")||c.innerText||c.textContent||"").replace(/^\s+/,"").substr(0,e.length).toLowerCase();return e.length&&c==e?-1:0},_isFormElement:function(a){return"INPUT"===a.tagName||"TEXTAREA"===a.tagName||"SELECT"===a.tagName||"BUTTON"===a.tagName},_onContainerKeydown:function(a){if(!this._isFormElement(document.activeElement)){var e=this._keyNavCodes[a.keyCode];e?(e(a,this.focusedChild),a.stopPropagation(),a.preventDefault(),this._searchString=""):a.keyCode==l.SPACE&&(this._searchTimer&&
!a.ctrlKey&&!a.altKey&&!a.metaKey)&&(a.stopImmediatePropagation(),a.preventDefault(),this._keyboardSearch(a," "))}},_onContainerKeypress:function(a){if(!this._isFormElement(document.activeElement)&&!(a.charCode<=l.SPACE||a.ctrlKey||a.altKey||a.metaKey))a.preventDefault(),a.stopPropagation(),this._keyboardSearch(a,String.fromCharCode(a.charCode).toLowerCase())},_keyboardSearch:function(a,e){var c=null,d,f=0;k.hitch(this,function(){this._searchTimer&&this._searchTimer.remove();this._searchString+=e;
var a=/^(.)\1*$/.test(this._searchString)?1:this._searchString.length;d=this._searchString.substr(0,a);this._searchTimer=this.defer(function(){this._searchTimer=null;this._searchString=""},this.multiCharSearchDuration);var g=this.focusedChild||null;if(1==a||!g)if(g=this._getNextFocusableChild(g,1),!g)return;a=g;do{var h=this._keyboardSearchCompare(g,d);h&&0==f++&&(c=g);if(-1==h){f=-1;break}g=this._getNextFocusableChild(g,1)}while(g&&g!=a)})();this.onKeyboardSearch(c,a,d,f)},_onChildBlur:function(){},
_getNextFocusableChild:function(a,e){var c=a;do{if(a)a=this._getNext(a,e);else if(a=this[0<e?"_getFirst":"_getLast"](),!a)break;if(null!=a&&a!=c&&a.isFocusable())return a}while(a!=c);return null},_getFirst:function(){return null},_getLast:function(){return null},_getNext:function(a,e){if(a)for(a=a.domNode;a;)if((a=a[0>e?"previousSibling":"nextSibling"])&&"getAttribute"in a){var c=q.byNode(a);if(c)return c}return null}})})},"dijit/MenuItem":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d){q=p("dijit.MenuItem"+(h("dojo-bidi")?"_NoBidi":""),[m,g,e,c],{templateString:d,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(a){this._set("label",a);var c="",d;d=a.search(/{\S}/);if(0<=d){var c=a.charAt(d+1),e=a.substr(0,d);a=a.substr(d+3);d=e+c+a;a=e+'\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e'+c+"\x3c/span\x3e"+a}else d=a;this.domNode.setAttribute("aria-label",d+" "+this.accelKey);this.containerNode.innerHTML=a;this._set("shortcutKey",c)},iconClass:"dijitNoIcon",
_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(a){a&&!("label"in this.params)&&this._set("label",a.innerHTML)},buildRendering:function(){this.inherited(arguments);a.set(this.containerNode,"id",this.id+"_text");this.accelKeyNode&&a.set(this.accelKeyNode,"id",this.id+"_accel");f.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{8==h("ie")&&this.containerNode.focus(),this.focusNode.focus()}catch(a){}},_setSelected:function(a){l.toggle(this.domNode,
"dijitMenuItemSelected",a)},setLabel:function(a){k.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},setDisabled:function(a){k.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",a)},_setDisabledAttr:function(a){this.focusNode.setAttribute("aria-disabled",a?"true":"false");this._set("disabled",a)},_setAccelKeyAttr:function(c){this.accelKeyNode&&(this.accelKeyNode.style.display=
c?"":"none",this.accelKeyNode.innerHTML=c,a.set(this.containerNode,"colSpan",c?"1":"2"));this._set("accelKey",c)}});h("dojo-bidi")&&(q=p("dijit.MenuItem",q,{_setLabelAttr:function(a){this.inherited(arguments);"auto"===this.textDir&&this.applyTextDir(this.textDirNode)}}));return q})},"dijit/_Contained":function(){define(["dojo/_base/declare","./registry"],function(p,f){return p("dijit._Contained",null,{_getSibling:function(a){var f=this.getParent();return f&&f._getSiblingOfChild&&f._getSiblingOfChild(this,
"previous"==a?-1:1)||null},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var a=this.getParent();return!a||!a.getIndexOfChild?-1:a.getIndexOfChild(this)}})})},"dijit/MenuSeparator":function(){define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "),function(p,f,a,l,k,h){return p("dijit.MenuSeparator",[a,l,k],{templateString:h,
buildRendering:function(){this.inherited(arguments);f.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/form/SimpleTextarea":function(){define(["dojo/_base/declare","dojo/dom-class","dojo/sniff","./TextBox"],function(p,f,a,l){return p("dijit.form.SimpleTextarea",l,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"\x3ctextarea ${!nameAttrSetting} data-dojo-attach-point\x3d'focusNode,containerNode,textbox' autocomplete\x3d'off'\x3e\x3c/textarea\x3e",
postMixInProperties:function(){!this.value&&this.srcNodeRef&&(this.value=this.srcNodeRef.value);this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);a("ie")&&this.cols&&f.add(this.textbox,"dijitTextAreaCols")},filter:function(a){a&&(a=a.replace(/\r/g,""));return this.inherited(arguments)},_onInput:function(f){if(this.maxLength){var h=parseInt(this.maxLength),l=this.textbox.value.replace(/\r/g,""),h=l.length-h;if(0<h){var m=this.textbox;if(m.selectionStart){var g=m.selectionStart,
e=0;a("opera")&&(e=(this.textbox.value.substring(0,g).match(/\r/g)||[]).length);this.textbox.value=l.substring(0,g-h-e)+l.substring(g-e);m.setSelectionRange(g-h,g-h)}else this.ownerDocument.selection&&(m.focus(),l=this.ownerDocument.selection.createRange(),l.moveStart("character",-h),l.text="",l.select())}}this.inherited(arguments)}})})},"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A,B){function F(a){return new w({command:a.name})}function E(a){return new w({buttonClass:n,command:a.name})}a=a("dijit.Editor",A,{plugins:null,extraPlugins:null,constructor:function(){c.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",x]);this._plugins=
[];this._editInterval=1E3*this.editActionInterval;if(d("ie")||d("trident")||d("edge"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new l;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);c.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=k.getLocalization("dijit._editor",
"commands",this.lang);d("webkit")&&g.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new t({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));f.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);q.add(this.iframe.parentNode,"dijitEditorIFrameContainer");q.add(this.iframe,"dijitEditorIFrame");h.set(this.iframe,"allowTransparency",
!0);this.toolbar.startup();this.onNormalizedDisplayChanged()},destroy:function(){f.forEach(this._plugins,function(a){a&&a.destroy&&a.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(a,b){var d=c.isString(a)?{name:a}:c.isFunction(a)?{ctor:a}:a;if(!d.setEditor){var e={args:d,plugin:null,editor:this};d.name&&(w.registry[d.name]?e.plugin=w.registry[d.name](d):u.publish(B._scopeName+".Editor.getPlugin",e));if(!e.plugin)try{var f=
d.ctor||c.getObject(d.name)||p(d.name);f&&(e.plugin=new f(d))}catch(g){throw Error(this.id+": cannot find plugin ["+d.name+"]");}if(!e.plugin)throw Error(this.id+": cannot find plugin ["+d.name+"]");a=e.plugin}1<arguments.length?this._plugins[b]=a:this._plugins.push(a);a.setEditor(this);c.isFunction(a.setToolbar)&&a.setToolbar(this.toolbar)},resize:function(a){a&&v.prototype.resize.apply(this,arguments)},layout:function(){var a=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+m.getPadBorderExtents(this.iframe.parentNode).h+
m.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=a+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(a){var b,c=this.document.body,d=c.clientWidth,e=c.clientHeight,f=c.clientLeft,g=c.offsetWidth,h=c.offsetHeight,k=c.offsetLeft;/^rtl$/i.test(c.dir||"")?d<g&&(a.x>d&&a.x<g)&&(b=!0):a.x<f&&a.x>k&&(b=!0);b||e<h&&(a.y>e&&a.y<h)&&(b=!0);b||(delete this._cursorToStart,delete this._savedSelection,"BODY"==a.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(a){this.customUndo&&this.endEditing(!0);"BODY"!=a.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(a){this._inEditing||(this._inEditing=!0,this._beginEditing(a));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(a){if(this.customUndo&&
("undo"==a||"redo"==a))return this[a]();this.customUndo&&(this.endEditing(),this._beginEditing());var b=this.inherited(arguments);this.customUndo&&this._endEditing();return b},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(a){var b;try{if(b=this.document.execCommand(a,!1,null),d("webkit")&&!b)throw{};}catch(c){b=r.substitute,alert(b(this.commands.systemShortcut,
[this.commands[a],b(this.commands[d("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[a]])])),b=!1}return b},queryCommandEnabled:function(a){return this.customUndo&&("undo"==a||"redo"==a)?"undo"==a?1<this._steps.length:0<this._undoedSteps.length:this.inherited(arguments)},_moveToBookmark:function(a){var b=a.mark,e=a.mark;a=a.isCollapsed;var g,h,k;if(e)if(9>d("ie")||9===d("ie")&&d("quirks"))if(c.isArray(e))b=[],f.forEach(e,function(a){b.push(y.getNode(a,this.editNode))},this),this.selection.moveToBookmark({mark:b,
isCollapsed:a});else{if(e.startContainer&&e.endContainer&&(k=y.getSelection(this.window))&&k.removeAllRanges)k.removeAllRanges(),a=y.create(this.window),g=y.getNode(e.startContainer,this.editNode),h=y.getNode(e.endContainer,this.editNode),g&&h&&(a.setStart(g,e.startOffset),a.setEnd(h,e.endOffset),k.addRange(a))}else if((k=y.getSelection(this.window))&&k.removeAllRanges)k.removeAllRanges(),a=y.create(this.window),g=y.getNode(e.startContainer,this.editNode),h=y.getNode(e.endContainer,this.editNode),
g&&h&&(a.setStart(g,e.startOffset),a.setEnd(h,e.endOffset),k.addRange(a))},_changeToStep:function(a,b){this.setValue(b.text);var c=b.bookmark;c&&this._moveToBookmark(c)},undo:function(){var a=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._steps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(b,this._steps[this._steps.length-1]),this._undoedSteps.push(b),this.onDisplayChanged(),delete this._undoRedoActive,a=!0);delete this._undoRedoActive}return a},
redo:function(){var a=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._undoedSteps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],b),this._steps.push(b),this.onDisplayChanged(),a=!0);delete this._undoRedoActive}return a},endEditing:function(a){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(a),this._inEditing=!1)},_getBookmark:function(){var a=this.selection.getBookmark(),
b=[];if(a&&a.mark){var e=a.mark;if(9>d("ie")||9===d("ie")&&d("quirks")){var g=y.getSelection(this.window);if(c.isArray(e))f.forEach(a.mark,function(a){b.push(y.getIndex(a,this.editNode).o)},this),a.mark=b;else if(g){var h;g.rangeCount&&(h=g.getRangeAt(0));a.mark=h?h.cloneRange():this.selection.getBookmark()}}try{a.mark&&a.mark.startContainer&&(b=y.getIndex(a.mark.startContainer,this.editNode).o,a.mark={startContainer:b,startOffset:a.mark.startOffset,endContainer:a.mark.endContainer===a.mark.startContainer?
b:y.getIndex(a.mark.endContainer,this.editNode).o,endOffset:a.mark.endOffset})}catch(k){a.mark=null}}return a},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:z.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var a=z.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:a,bookmark:this._getBookmark()})},onKeyDown:function(a){!d("ie")&&(!this.iframe&&a.keyCode==e.TAB&&!this.tabIndent)&&this._saveSelection();if(this.customUndo){var b=
a.keyCode;if(a.ctrlKey&&!a.shiftKey&&!a.altKey){if(90==b||122==b){a.stopPropagation();a.preventDefault();this.undo();return}if(89==b||121==b){a.stopPropagation();a.preventDefault();this.redo();return}}this.inherited(arguments);switch(b){case e.ENTER:case e.BACKSPACE:case e.DELETE:this.beginEditing();break;case 88:case 86:if(a.ctrlKey&&!a.altKey&&!a.metaKey){this.endEditing();88==a.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!a.ctrlKey&&!a.altKey&&
!a.metaKey&&(a.keyCode<e.F1||a.keyCode>e.F15)){this.beginEditing();break}case e.ALT:this.endEditing();break;case e.UP_ARROW:case e.DOWN_ARROW:case e.LEFT_ARROW:case e.RIGHT_ARROW:case e.HOME:case e.END:case e.PAGE_UP:case e.PAGE_DOWN:this.endEditing(!0);case e.CTRL:case e.SHIFT:case e.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(a){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(a){this.customUndo?this.isClosed?this.setValue(a):(this.beginEditing(),a||(a="\x26#160;"),this.setValue(a),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(a){this.setValueDeferred.then(c.hitch(this,function(){!this.disabled&&a||!this._buttonEnabledPlugins&&a?
f.forEach(this._plugins,function(a){a.set("disabled",!0)}):this.disabled&&!a&&f.forEach(this._plugins,function(a){a.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&g.set(this.document.body,"color",g.get(this.iframe,"color"))}catch(a){}}});c.mixin(w.registry,{undo:F,redo:F,cut:F,copy:F,paste:F,insertOrderedList:F,insertUnorderedList:F,indent:F,outdent:F,justifyCenter:F,justifyFull:F,justifyLeft:F,justifyRight:F,
"delete":F,selectAll:F,removeFormat:F,unlink:F,insertHorizontalRule:F,bold:E,italic:E,underline:E,strikethrough:E,subscript:E,superscript:E,"|":function(){return new w({setEditor:function(a){this.editor=a;this.button=new b({ownerDocument:a.ownerDocument})}})}});return a})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(p,f,a,l,k,h,q,m){a("dijit-legacy-requires")&&k(0,function(){p(["dijit/ToolbarSeparator"])});
return f("dijit.Toolbar",[h,m,q],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],function(p,f,a,l){return p("dijit.ToolbarSeparator",[a,l],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',
buildRendering:function(){this.inherited(arguments);f.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/layout/_LayoutWidget":function(){define("dojo/_base/lang ../_Widget ../_Container ../_Contained ../Viewport dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style".split(" "),function(p,f,a,l,k,h,q,m,g){return h("dijit.layout._LayoutWidget",[f,a,l],{baseClass:"dijitLayoutContainer",isLayoutContainer:!0,_setTitleAttr:null,buildRendering:function(){this.inherited(arguments);
q.add(this.domNode,"dijitContainer")},startup:function(){if(!this._started){this.inherited(arguments);var a=this.getParent&&this.getParent();if(!a||!a.isLayoutContainer)this.resize(),this.own(k.on("resize",p.hitch(this,"resize")))}},resize:function(a,c){var d=this.domNode;a&&m.setMarginBox(d,a);var f=c||{};p.mixin(f,a||{});if(!("h"in f)||!("w"in f))f=p.mixin(m.getMarginBox(d),f);var h=g.getComputedStyle(d),k=m.getMarginExtents(d,h),l=m.getBorderExtents(d,h),f=this._borderBox={w:f.w-(k.w+l.w),h:f.h-
(k.h+l.h)},k=m.getPadExtents(d,h);this._contentBox={l:g.toPixelValue(d,h.paddingLeft),t:g.toPixelValue(d,h.paddingTop),w:f.w-k.w,h:f.h-k.h};this.layout()},layout:function(){},_setupChild:function(a){q.add(a.domNode,this.baseClass+"-child "+(a.baseClass?this.baseClass+"-"+a.baseClass:""))},addChild:function(a,c){this.inherited(arguments);this._started&&this._setupChild(a)},removeChild:function(a){q.remove(a.domNode,this.baseClass+"-child"+(a.baseClass?" "+this.baseClass+"-"+a.baseClass:""));this.inherited(arguments)}})})},
"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(p,f,a,l,k){f=f("dijit._editor._Plugin",l,{constructor:function(f){this.params=f||{};a.mixin(this,this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:!0,buttonClass:k,disabled:!1,getLabel:function(a){return this.editor.commands[a]},_initButton:function(){if(this.command.length){var f=
this.getLabel(this.command),k=this.editor,l=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(f=a.mixin({label:f,ownerDocument:k.ownerDocument,dir:k.dir,lang:k.lang,showLabel:!1,iconClass:l,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete f.name,this.button=new this.buttonClass(f))}this.get("disabled")&&this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();
this.inherited(arguments)},connect:function(a,f,k){this.own(p.connect(a,f,this,k))},updateState:function(){var a=this.editor,f=this.command,k,g;if(a&&a.isLoaded&&f.length){var e=this.get("disabled");if(this.button)try{g=!e&&a.queryCommandEnabled(f),this.enabled!==g&&(this.enabled=g,this.button.set("disabled",!g)),g&&"boolean"==typeof this.button.checked&&(k=a.queryCommandState(f),this.checked!==k&&(this.checked=k,this.button.set("checked",a.queryCommandState(f))))}catch(c){console.log(c)}}},setEditor:function(f){this.editor=
f;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",a.hitch(this.editor,"execCommand",this.command,this.commandArg))):this.button.domNode.style.display="none");this.own(this.editor.on("NormalizedDisplayChanged",a.hitch(this,"updateState")))},setToolbar:function(a){this.button&&a.addChild(this.button)},set:function(a,f){if("object"===typeof a){for(var k in a)this.set(k,a[k]);return this}k=this._getAttrNames(a);if(this[k.s])var g=
this[k.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(a,f);return g||this},get:function(a){var f=this._getAttrNames(a);return this[f.g]?this[f.g]():this[a]},_setDisabledAttr:function(a){this._set("disabled",a);this.updateState()},_getAttrNames:function(a){var f=this._attrPairNames;if(f[a])return f[a];var k=a.charAt(0).toUpperCase()+a.substr(1);return f[a]={s:"_set"+k+"Attr",g:"_get"+k+"Attr"}},_set:function(a,f){this[a]=f}});f.registry={};return f})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c){return p("dijit._editor.plugins.EnterKeyHandling",g,{blockNodeForEnter:"BR",constructor:function(a){a&&("blockNodeForEnter"in a&&(a.blockNodeForEnter=a.blockNodeForEnter.toUpperCase()),l.mixin(this,a))},setEditor:function(c){if(this.editor!==c)if(this.editor=c,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,c.onLoadDeferred.then(l.hitch(this,function(e){this.own(k(c.document,"keydown",l.hitch(this,function(c){if(c.keyCode==a.ENTER){var d=l.mixin({},c);d.shiftKey=
!0;this.handleEnterKey(d)||(c.stopPropagation(),c.preventDefault())}})));9<=h("ie")&&10>=h("ie")&&this.own(k(c.document,"paste",l.hitch(this,function(a){setTimeout(l.hitch(this,function(){var a=this.editor.document.selection.createRange();a.move("character",-1);a.select();a.move("character",1);a.select()}),0)})));return e}));else if(this.blockNodeForEnter){var e=l.hitch(this,"handleEnterKey");c.addKeyHandler(13,0,0,e);c.addKeyHandler(13,0,1,e);this.own(this.editor.on("KeyPressed",l.hitch(this,"onKeyPressed")))}},
onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var a=this.editor.selection.getAncestorElement("LI");if(a){h("mozilla")&&"LI"==a.parentNode.parentNode.nodeName&&(a=a.parentNode.parentNode);var f=a.firstChild;if(f&&1==f.nodeType&&("UL"==f.nodeName||"OL"==f.nodeName))a.insertBefore(f.ownerDocument.createTextNode("\u00a0"),f),f=c.create(this.editor.window),f.setStart(a.firstChild,0),a=c.getSelection(this.editor.window,!0),a.removeAllRanges(),a.addRange(f)}else e.prototype.execCommand.call(this.editor,
"formatblock",this.blockNodeForEnter),(a=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?(a.innerHTML=this.bogusHtmlContent,9>=h("ie")&&(a=this.editor.document.selection.createRange(),a.move("character",-1),a.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",
blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(a){var g,k,l,q,b=this.editor.document,p,n,w;if(a.shiftKey){a=this.editor.selection.getParentElement();if(q=c.getAncestor(a,this.blockNodes)){if("LI"==q.tagName)return!0;a=c.getSelection(this.editor.window);g=a.getRangeAt(0);g.collapsed||(g.deleteContents(),a=c.getSelection(this.editor.window),g=a.getRangeAt(0));if(c.atBeginningOfContainer(q,g.startContainer,g.startOffset))p=b.createElement("br"),g=c.create(this.editor.window),q.insertBefore(p,
q.firstChild),g.setStartAfter(p),a.removeAllRanges(),a.addRange(g);else if(c.atEndOfContainer(q,g.startContainer,g.startOffset))g=c.create(this.editor.window),p=b.createElement("br"),q.appendChild(p),q.appendChild(b.createTextNode("\u00a0")),g.setStart(q.lastChild,0),a.removeAllRanges(),a.addRange(g);else return(n=g.startContainer)&&3==n.nodeType?(w=n.nodeValue,k=b.createTextNode(w.substring(0,g.startOffset)),l=b.createTextNode(w.substring(g.startOffset)),q=b.createElement("br"),""==l.nodeValue&&
h("webkit")&&(l=b.createTextNode("\u00a0")),f.place(k,n,"after"),f.place(q,k,"after"),f.place(l,q,"after"),f.destroy(n),g=c.create(this.editor.window),g.setStart(l,0),a.removeAllRanges(),a.addRange(g),!1):!0}else if(a=c.getSelection(this.editor.window),a.rangeCount){if((g=a.getRangeAt(0))&&g.startContainer)g.collapsed||(g.deleteContents(),a=c.getSelection(this.editor.window),g=a.getRangeAt(0)),(n=g.startContainer)&&3==n.nodeType?(q=g.startOffset,n.length<q&&(l=this._adjustNodeAndOffset(n,q),n=l.node,
q=l.offset),w=n.nodeValue,k=b.createTextNode(w.substring(0,q)),l=b.createTextNode(w.substring(q)),q=b.createElement("br"),l.length||(l=b.createTextNode("\u00a0")),k.length?f.place(k,n,"after"):k=n,f.place(q,k,"after"),f.place(l,q,"after"),f.destroy(n)):(0<=g.startOffset&&(p=n.childNodes[g.startOffset]),q=b.createElement("br"),l=b.createTextNode("\u00a0"),p?(f.place(q,p,"before"),f.place(l,q,"after")):(n.appendChild(q),n.appendChild(l))),g=c.create(this.editor.window),g.setStart(l,0),g.setEnd(l,l.length),
a.removeAllRanges(),a.addRange(g),this.editor.selection.collapse(!0)}else e.prototype.execCommand.call(this.editor,"inserthtml","\x3cbr\x3e");return!1}var x=!0;a=c.getSelection(this.editor.window);g=a.getRangeAt(0);g.collapsed||(g.deleteContents(),a=c.getSelection(this.editor.window),g=a.getRangeAt(0));p=c.getBlockAncestor(g.endContainer,null,this.editor.editNode);var z=p.blockNode;if(this._checkListLater=z&&("LI"==z.nodeName||"LI"==z.parentNode.nodeName))return h("mozilla")&&(this._pressedEnterInBlock=
z),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(z.innerHTML)&&(z.innerHTML="",h("webkit")&&(g=c.create(this.editor.window),g.setStart(z,0),a.removeAllRanges(),a.addRange(g)),this._checkListLater=!1),!0;if(!p.blockNode||p.blockNode===this.editor.editNode){try{e.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(y){}p={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),
blockContainer:this.editor.editNode};if(p.blockNode){if(p.blockNode!=this.editor.editNode&&!(p.blockNode.textContent||p.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)return this.removeTrailingBr(p.blockNode),!1}else p.blockNode=this.editor.editNode;a=c.getSelection(this.editor.window);g=a.getRangeAt(0)}z=b.createElement(this.blockNodeForEnter);z.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(p.blockNode);l=g.endOffset;x=g.endContainer;x.length<l&&(l=this._adjustNodeAndOffset(x,l),x=
l.node,l=l.offset);if(c.atEndOfContainer(p.blockNode,x,l))p.blockNode===p.blockContainer?p.blockNode.appendChild(z):f.place(z,p.blockNode,"after"),x=!1,g=c.create(this.editor.window),g.setStart(z,0),a.removeAllRanges(),a.addRange(g),this.editor.height&&m.scrollIntoView(z);else if(c.atBeginningOfContainer(p.blockNode,g.startContainer,g.startOffset))f.place(z,p.blockNode,p.blockNode===p.blockContainer?"first":"before"),z.nextSibling&&this.editor.height&&(g=c.create(this.editor.window),g.setStart(z.nextSibling,
0),a.removeAllRanges(),a.addRange(g),m.scrollIntoView(z.nextSibling)),x=!1;else{p.blockNode===p.blockContainer?p.blockNode.appendChild(z):f.place(z,p.blockNode,"after");x=!1;p.blockNode.style&&(z.style&&p.blockNode.style.cssText)&&(z.style.cssText=p.blockNode.style.cssText);if((n=g.startContainer)&&3==n.nodeType){l=g.endOffset;n.length<l&&(l=this._adjustNodeAndOffset(n,l),n=l.node,l=l.offset);w=n.nodeValue;k=b.createTextNode(w.substring(0,l));l=b.createTextNode(w.substring(l,w.length));f.place(k,
n,"before");f.place(l,n,"after");f.destroy(n);for(k=k.parentNode;k!==p.blockNode;){w=b.createElement(k.tagName);k.style&&(w.style&&k.style.cssText)&&(w.style.cssText=k.style.cssText);"FONT"===k.tagName&&(k.color&&(w.color=k.color),k.face&&(w.face=k.face),k.size&&(w.size=k.size));for(g=l;g;)n=g.nextSibling,w.appendChild(g),g=n;f.place(w,k,"after");l=w;k=k.parentNode}g=l;if(1==g.nodeType||3==g.nodeType&&g.nodeValue)z.innerHTML="";for(k=g;g;)n=g.nextSibling,z.appendChild(g),g=n}g=c.create(this.editor.window);
b=k;if("BR"!==this.blockNodeForEnter){for(;b;)q=b,b=n=b.firstChild;q&&q.parentNode?(z=q.parentNode,g.setStart(z,0),a.removeAllRanges(),a.addRange(g),this.editor.height&&m.scrollIntoView(z),h("mozilla")&&(this._pressedEnterInBlock=p.blockNode)):x=!0}else g.setStart(z,0),a.removeAllRanges(),a.addRange(g),this.editor.height&&m.scrollIntoView(z),h("mozilla")&&(this._pressedEnterInBlock=p.blockNode)}return x},_adjustNodeAndOffset:function(a,c){for(;a.length<c&&a.nextSibling&&3==a.nextSibling.nodeType;)c-=
a.length,a=a.nextSibling;return{node:a,offset:c}},removeTrailingBr:function(a){if(a=/P|DIV|LI/i.test(a.tagName)?a:this.editor.selection.getParentOfType(a,["P","DIV","LI"]))a.lastChild&&(1<a.childNodes.length&&3==a.lastChild.nodeType&&/^[\s\xAD]*$/.test(a.lastChild.nodeValue)||"BR"==a.lastChild.tagName)&&f.destroy(a.lastChild),a.childNodes.length||(a.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/string dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A,B,F,E,H,I){var M=a("dijit._editor.RichText",[y,A],{constructor:function(a){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};a&&r.isString(a.value)&&(this.value=a.value);this.onLoadDeferred=new l},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[r.trim,r.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);b("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));b("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(b("ie")||b("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[r.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[r.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);n.publish(I._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var a=r.hitch(this,function(a,b){return function(){return!this.execCommand(a,b)}}),c={b:a("bold"),i:a("italic"),u:a("underline"),a:a("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:a("formatblock",
"h1"),2:a("formatblock","h2"),3:a("formatblock","h3"),4:a("formatblock","h4"),"\\":a("insertunorderedlist")};b("ie")||(c.Z=a("redo"));for(var d in c)this.addKeyHandler(d,!0,!1,c[d])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(M._editorCommandsLocalized)this._local2NativeFormatNames=M._local2NativeFormatNames,this._native2LocalFormatNames=M._native2LocalFormatNames;else{M._editorCommandsLocalized=!0;M._local2NativeFormatNames={};
M._native2LocalFormatNames={};this._local2NativeFormatNames=M._local2NativeFormatNames;this._native2LocalFormatNames=M._native2LocalFormatNames;for(var a="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),b="",c,d=0;c=a[d++];)b="l"!==c.charAt(1)?b+("\x3c"+c+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+c+"\x3e\x3cbr/\x3e"):b+("\x3c"+c+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+c+"\x3e\x3cbr/\x3e");var e=m.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:0.01},innerHTML:b});this.ownerDocumentBody.appendChild(e);
a=r.hitch(this,function(){for(var a=e.firstChild;a;)try{this.selection.selectElement(a.firstChild);var b=a.tagName.toLowerCase();this._local2NativeFormatNames[b]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[b]]=b;a=a.nextSibling.nextSibling}catch(c){}m.destroy(e)});this.defer(a)}},open:function(a){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new l;this.isClosed||this.close();n.publish(I._scopeName+"._editor.RichText::open",
this);1===arguments.length&&a.nodeName&&(this.domNode=a);var c=this.domNode,d;if(r.isString(this.value))d=this.value,c.innerHTML="";else if(c.nodeName&&"textarea"==c.nodeName.toLowerCase()){var g=this.textarea=c;this.name=g.name;d=g.value;c=this.domNode=this.ownerDocument.createElement("div");c.setAttribute("widgetId",this.id);g.removeAttribute("widgetId");c.cssText=g.cssText;c.className+=" "+g.className;m.place(c,g,"before");var s=r.hitch(this,function(){e.set(g,{display:"block",position:"absolute",
top:"-1000px"});if(b("ie")){var a=g.style;this.__overflow=a.overflow;a.overflow="hidden"}});b("ie")?this.defer(s,10):s();if(g.form){var p=g.value;this.reset=function(){this.getValue()!==p&&this.replaceValue(p)};u(g.form,"submit",r.hitch(this,function(){h.set(g,"disabled",this.disabled);g.value=this.getValue()}))}}else d=E.getChildrenHtml(c),c.innerHTML="";this.value=d;c.nodeName&&"LI"===c.nodeName&&(c.innerHTML=" \x3cbr\x3e");this.header=c.ownerDocument.createElement("div");c.appendChild(this.header);
this.editingArea=c.ownerDocument.createElement("div");c.appendChild(this.editingArea);this.footer=c.ownerDocument.createElement("div");c.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!f.useXDomain||f.allowXdRichTextSave)){if((d=k.byId(I._scopeName+"._editor.RichText.value"))&&""!==d.value)for(var s=d.value.split(this._SEPARATOR),t=0,v;v=s[t++];)if(v=v.split(this._NAME_CONTENT_SEP),v[0]===this.name){this.value=v[1];s=s.splice(t,1);d.value=s.join(this._SEPARATOR);
break}M._globalSaveHandler||(M._globalSaveHandler={},w.addOnUnload(function(){for(var a in M._globalSaveHandler){var b=M._globalSaveHandler[a];r.isFunction(b)&&b()}}));M._globalSaveHandler[this.id]=r.hitch(this,"_saveContent")}this.isClosed=!1;d=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");d.id=this.id+"_iframe";d.style.border="none";d.style.width="100%";this._layoutMode?d.style.height="100%":7<=b("ie")?(this.height&&(d.style.height=this.height),this.minHeight&&(d.style.minHeight=
this.minHeight)):d.style.height=this.height?this.height:this.minHeight;d.frameBorder=0;d._loadFunc=r.hitch(this,function(a){this.window=a;this.document=a.document;this.selection=new B.SelectionManager(a);b("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});s=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");s=11>b("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+s+"');document.close()":"javascript: '"+
s+"'";this.editingArea.appendChild(d);d.src=s;"LI"===c.nodeName&&(c.lastChild.style.marginTop="-1.2em");q.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var a=e.getComputedStyle(this.domNode),d;if(this["aria-label"])d=this["aria-label"];else{var f=s('label[for\x3d"'+this.id+'"]',this.ownerDocument)[0]||k.byId(this["aria-labelledby"],this.ownerDocument);f&&(d=f.textContent||f.innerHTML||"")}var f="\x3cdiv id\x3d'dijitEditorBody' role\x3d'textbox' aria-multiline\x3d'true' "+
(d?" aria-label\x3d'"+v.escape(d)+"'":"")+"\x3e\x3c/div\x3e",g=[a.fontWeight,a.fontSize,a.fontFamily].join(" "),h=a.lineHeight,h=0<=h.indexOf("px")?parseFloat(h)/parseFloat(a.fontSize):0<=h.indexOf("em")?parseFloat(h):"normal",l="",n=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(a){a=a.replace(/^;/ig,"")+";";var b=a.split(":")[0];if(b){var b=r.trim(b),b=b.toLowerCase(),c,d="";for(c=0;c<b.length;c++){var f=b.charAt(c);switch(f){case "-":c++,f=b.charAt(c).toUpperCase();default:d+=
f}}e.set(n.domNode,d,"")}l+=a+";"});this.iframe.setAttribute("title",d);return["\x3c!DOCTYPE html\x3e","\x3chtml lang\x3d'"+(this.lang||c.locale.replace(/-.*/,""))+"'"+(this.isLeftToRight()?"":" dir\x3d'rtl'")+"\x3e\n","\x3chead\x3e\n\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n",d?"\x3ctitle\x3e"+v.escape(d)+"\x3c/title\x3e":"","\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",g,";\n",this.height||b("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",h,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",b("ie")||b("trident")||b("edge")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'application'",d?" aria-label\x3d'"+v.escape(d)+"'":"","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+l+"'\x3e",f,"\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var a=[];this.styleSheets&&(a=this.styleSheets.split(";"),this.styleSheets=
"");a=a.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var b="",c=0,d,e=z.get(this.ownerDocument);d=a[c++];)d=(new x(e.location,d)).toString(),this.editingAreaStyleSheets.push(d),b+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+d+'"/\x3e';return b},addStyleSheet:function(a){var b=a.toString(),c=z.get(this.ownerDocument);if("."===b.charAt(0)||"/"!==b.charAt(0)&&!a.host)b=(new x(c.location,b)).toString();-1<p.indexOf(this.editingAreaStyleSheets,b)||(this.editingAreaStyleSheets.push(b),
this.onLoadDeferred.then(r.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(b);else{var a=this.document.getElementsByTagName("head")[0],c=this.document.createElement("link");c.rel="stylesheet";c.type="text/css";c.href=b;a.appendChild(c)}})))},removeStyleSheet:function(a){var b=a.toString(),c=z.get(this.ownerDocument);if("."===b.charAt(0)||"/"!==b.charAt(0)&&!a.host)b=(new x(c.location,b)).toString();a=p.indexOf(this.editingAreaStyleSheets,b);-1!==a&&(delete this.editingAreaStyleSheets[a],
s('link[href\x3d"'+b+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(a){a=!!a;this._set("disabled",a);if(this.isLoaded){var c=b("ie")&&(this.isLoaded||!this.focusOnLoad);c&&(this.editNode.unselectable="on");this.editNode.contentEditable=!a;this.editNode.tabIndex=a?"-1":this.tabIndex;c&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(b("mozilla")&&!a&&this._mozSettingProps){a=this._mozSettingProps;for(var d in a)if(a.hasOwnProperty(d))try{this.document.execCommand(d,
!1,a[d])}catch(e){}}this._disabledOK=!0}},onLoad:function(a){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=H.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var c=this;this.beforeIframeNode=m.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=m.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){c.editNode.focus()};this.focusNode=
this.editNode;var d=this.events.concat(this.captureEvents),e=this.iframe?this.document:this.editNode;this.own.apply(this,p.map(d,function(a){var b=a.toLowerCase().replace(/^on/,"");return u(e,b,r.hitch(this,a))},this));this.own(u(e,"mouseup",r.hitch(this,"onClick")));b("ie")&&(this.own(u(this.document,"mousedown",r.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);b("webkit")&&(this._webkitListener=this.own(u(this.document,"mouseup",r.hitch(this,"onDisplayChanged")))[0],this.own(u(this.document,
"mousedown",r.hitch(this,function(a){(a=a.target)&&(a===this.document.body||a===this.document)&&this.defer("placeCursorAtEnd")}))));if(b("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(f){}this.isLoaded=!0;this.set("disabled",this.disabled);d=r.hitch(this,function(){this.setValue(a);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&t(r.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(d):d()},onKeyDown:function(a){if(a.keyCode===d.SHIFT||a.keyCode===d.ALT||a.keyCode===d.META||a.keyCode===d.CTRL)return!0;if(a.keyCode===d.TAB&&this.isTabIndent&&(a.stopPropagation(),a.preventDefault(),this.queryCommandEnabled(a.shiftKey?"outdent":"indent")))this.execCommand(a.shiftKey?"outdent":"indent");if(a.keyCode==d.TAB&&!this.isTabIndent&&!a.ctrlKey&&!a.altKey)return a.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>b("ie")&&(a.keyCode===d.BACKSPACE&&"Control"===this.document.selection.type)&&(a.stopPropagation(),a.preventDefault(),this.execCommand("delete"));b("ff")&&(a.keyCode===d.PAGE_UP||a.keyCode===d.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&a.preventDefault();var c=this._keyHandlers[a.keyCode],e=arguments;c&&!a.altKey&&p.some(c,function(b){if(!(b.shift^a.shiftKey)&&!(b.ctrl^(a.ctrlKey||a.metaKey)))return b.handler.apply(this,e)||a.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(a){c.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",a)},_setValueAttr:function(a){this.setValue(a)},_setDisableSpellCheckAttr:function(a){this.document?h.set(this.document.body,"spellcheck",!a):this.onLoadDeferred.then(r.hitch(this,function(){h.set(this.document.body,"spellcheck",!a)}));this._set("disableSpellCheck",a)},addKeyHandler:function(a,b,c,d){"string"==
typeof a&&(a=a.toUpperCase().charCodeAt(0));r.isArray(this._keyHandlers[a])||(this._keyHandlers[a]=[]);this._keyHandlers[a].push({shift:c||!1,ctrl:b||!1,handler:d})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(a){this.onDisplayChanged(a)},_onIEMouseDown:function(){!this.focused&&!this.disabled&&this.focus()},_onBlur:function(a){(b("ie")||b("trident"))&&this.defer(function(){H.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var c=this.getValue(!0);if(c!==this.value)this.onChange(c);
this._set("value",c)},_onFocus:function(a){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!b("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>b("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(a,c){var d=a.toLowerCase();"formatblock"===d?b("safari")&&void 0===c&&(d="heading"):"hilitecolor"===d&&!b("mozilla")&&(d="backcolor");return d},_qcaCache:{},queryCommandAvailable:function(a){var b=this._qcaCache[a];return void 0!==
b?b:this._qcaCache[a]=this._queryCommandAvailable(a)},_queryCommandAvailable:function(a){switch(a.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":case "cut":case "copy":case "paste":return!0;
case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":return b("ie")||b("trident")||b("edge");case "inserttable":case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":return!b("webkit");default:return!1}},execCommand:function(a,c){var d;this.focused&&this.focus();a=this._normalizeCommand(a,c);if(void 0!==c){if("heading"===a)throw Error("unimplemented");if("formatblock"===
a&&(b("ie")||b("trident")))c="\x3c"+c+"\x3e"}var e="_"+a+"Impl";if(this[e])d=this[e](c);else if((c=1<arguments.length?c:null)||"createlink"!==a)d=this.document.execCommand(a,!1,c);this.onDisplayChanged();return d},queryCommandEnabled:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);var b="_"+a+"EnabledImpl";return this[b]?this[b](a):this._browserQueryCommandEnabled(a)},queryCommandState:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);
try{return this.document.queryCommandState(a)}catch(b){return!1}},queryCommandValue:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);if(b("ie")&&"formatblock"===a)a=this._native2LocalFormatNames[this.document.queryCommandValue(a)];else if(b("mozilla")&&"hilitecolor"===a){var c;try{c=this.document.queryCommandValue("styleWithCSS")}catch(d){c=!1}this.document.execCommand("styleWithCSS",!1,!0);a=this.document.queryCommandValue(a);this.document.execCommand("styleWithCSS",
!1,c)}else a=this.document.queryCommandValue(a);return a},_sCall:function(a,b){return this.selection[a].apply(this.selection,b)},placeCursorAtStart:function(){this.focus();var a=!1;if(b("mozilla"))for(var c=this.editNode.firstChild;c;){if(3===c.nodeType){if(0<c.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(c);break}}else if(1===c.nodeType){var a=!0,d=c.tagName?c.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(d)?this.selection.selectElement(c):
this.selection.selectElementChildren(c);break}c=c.nextSibling}else a=!0,this.selection.selectElementChildren(this.editNode);a&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var a=!1;if(b("mozilla"))for(var c=this.editNode.lastChild;c;){if(3===c.nodeType){if(0<c.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(c);break}}else if(1===c.nodeType){a=!0;this.selection.selectElement(c.lastChild||c);break}c=c.previousSibling}else a=!0,this.selection.selectElementChildren(this.editNode);
a&&this.selection.collapse(!1)},getValue:function(a){return this.textarea&&(this.isClosed||!this.isLoaded)?this.textarea.value:this.isLoaded?this._postFilterContent(null,a):this.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(a){if(this.isLoaded){if(this.textarea&&(this.isClosed||!this.isLoaded))this.textarea.value=a;else{a=this._preFilterContent(a);var b=this.isClosed?this.domNode:this.editNode;b.innerHTML=a;this._preDomFilterContent(b)}this.onDisplayChanged();this._set("value",
this.getValue(!0))}else this.onLoadDeferred.then(r.hitch(this,function(){this.setValue(a)}))},replaceValue:function(a){this.isClosed?this.setValue(a):this.window&&this.window.getSelection&&!b("mozilla")?this.setValue(a):this.window&&this.window.getSelection?(a=this._preFilterContent(a),this.execCommand("selectall"),this.execCommand("inserthtml",a),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(a);this._set("value",this.getValue(!0))},_preFilterContent:function(a){var b=
a;p.forEach(this.contentPreFilters,function(a){a&&(b=a(b))});return b},_preDomFilterContent:function(a){a=a||this.editNode;p.forEach(this.contentDomPreFilters,function(b){b&&r.isFunction(b)&&b(a)},this)},_postFilterContent:function(a,b){var c;r.isString(a)?c=a:(a=a||this.editNode,this.contentDomPostFilters.length&&(b&&(a=r.clone(a)),p.forEach(this.contentDomPostFilters,function(b){a=b(a)})),c=E.getChildrenHtml(a));r.trim(c.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(c="");p.forEach(this.contentPostFilters,
function(a){c=a(c)});return c},_saveContent:function(){var a=k.byId(I._scopeName+"._editor.RichText.value");a&&(a.value&&(a.value+=this._SEPARATOR),a.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(a,b){a=a.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");b||(a=a.replace(/'/gm,"\x26#39;"));return a},getNodeHtml:function(a){c.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",
2);return E.getNodeHtml(a)},getNodeChildrenHtml:function(a){c.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return E.getChildrenHtml(a)},close:function(a){if(!this.isClosed){arguments.length||(a=!0);a&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);b("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&
(this._iframeRegHandle.remove(),delete this._iframeRegHandle);if(this.textarea){var c=this.textarea.style;c.position="";c.left=c.top="";b("ie")&&(c.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;m.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;q.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=
null);this.editorObject=this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);M._globalSaveHandler&&delete M._globalSaveHandler[this.id]},_removeMozBogus:function(a){return a.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(a){a=a.replace(/\sclass="webkit-block-placeholder"/gi,"");a=a.replace(/\sclass="apple-style-span"/gi,
"");return a=a.replace(/<meta charset=\"utf-8\" \/>/gi,"")},_normalizeFontStyle:function(a){return a.replace(/<(\/)?strong([ \>])/gi,"\x3c$1b$2").replace(/<(\/)?em([ \>])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(a){return a.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(a){if(!a)return!1;
var c=9>b("ie")?this.document.selection.createRange():this.document;try{return c.queryCommandEnabled(a)}catch(d){return!1}},_createlinkEnabledImpl:function(){var a=!0;return a=b("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var a=!0;return a=b("mozilla")||b("webkit")?this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var a=
!0;return a=b("mozilla")||b("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var a=!0;b("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("cut");return a},_copyEnabledImpl:function(){var a=!0;b("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("copy");return a},_pasteEnabledImpl:function(){var a=!0;return b("webkit")?!0:a=this._browserQueryCommandEnabled("paste")},
_inserthorizontalruleImpl:function(a){return b("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,a)},_unlinkImpl:function(a){return this.queryCommandEnabled("unlink")&&(b("mozilla")||b("webkit"))?(a=this.selection.getAncestorElement("a"),this.selection.selectElement(a),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",!1,a)},_hilitecolorImpl:function(a){var c;this._handleTextColorOrProperties("hilitecolor",a)||(b("mozilla")?
(this.document.execCommand("styleWithCSS",!1,!0),console.log("Executing color command."),c=this.document.execCommand("hilitecolor",!1,a),this.document.execCommand("styleWithCSS",!1,!1)):c=this.document.execCommand("hilitecolor",!1,a));return c},_backcolorImpl:function(a){b("ie")&&(a=a?a:null);var c=this._handleTextColorOrProperties("backcolor",a);c||(c=this.document.execCommand("backcolor",!1,a));return c},_forecolorImpl:function(a){b("ie")&&(a=a?a:null);var c=!1;(c=this._handleTextColorOrProperties("forecolor",
a))||(c=this.document.execCommand("forecolor",!1,a));return c},_inserthtmlImpl:function(a){a=this._preFilterContent(a);var c=!0;if(9>b("ie")){var d=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var e=d.item(0);d.length;)d.remove(d.item(0));e.outerHTML=a}else d.pasteHTML(a);d.select()}else if(8>b("trident")){var f=F.getSelection(this.window);if(f&&f.rangeCount&&f.getRangeAt){d=f.getRangeAt(0);d.deleteContents();var g=m.create("div");g.innerHTML=
a;for(var h,e=this.document.createDocumentFragment();a=g.firstChild;)h=e.appendChild(a);d.insertNode(e);h&&(d=d.cloneRange(),d.setStartAfter(h),d.collapse(!1),f.removeAllRanges(),f.addRange(d))}}else b("mozilla")&&!a.length?this.selection.remove():c=this.document.execCommand("inserthtml",!1,a);return c},_boldImpl:function(a){var c=!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("bold");c||(c=this.document.execCommand("bold",!1,a));return c},_italicImpl:function(a){var c=
!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("italic");c||(c=this.document.execCommand("italic",!1,a));return c},_underlineImpl:function(a){var c=!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("underline");c||(c=this.document.execCommand("underline",!1,a));return c},_strikethroughImpl:function(a){var c=!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("strikethrough");c||(c=this.document.execCommand("strikethrough",
!1,a));return c},_superscriptImpl:function(a){var c=!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("superscript");c||(c=this.document.execCommand("superscript",!1,a));return c},_subscriptImpl:function(a){var c=!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("subscript");c||(c=this.document.execCommand("subscript",!1,a));return c},_fontnameImpl:function(a){var c;if(b("ie")||b("trident"))c=this._handleTextColorOrProperties("fontname",
a);c||(c=this.document.execCommand("fontname",!1,a));return c},_fontsizeImpl:function(a){var c;if(b("ie")||b("trident"))c=this._handleTextColorOrProperties("fontsize",a);c||(c=this.document.execCommand("fontsize",!1,a));return c},_insertorderedlistImpl:function(a){var c=!1;if(b("ie")||b("trident")||b("edge"))c=this._adaptIEList("insertorderedlist",a);c||(c=this.document.execCommand("insertorderedlist",!1,a));return c},_insertunorderedlistImpl:function(a){var c=!1;if(b("ie")||b("trident")||b("edge"))c=
this._adaptIEList("insertunorderedlist",a);c||(c=this.document.execCommand("insertunorderedlist",!1,a));return c},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(a){var b=0;if(a&&a.childNodes){var c;for(c=0;c<a.childNodes.length;c++)var d=g.position(a.childNodes[c]),b=b+d.h}return b},_isNodeEmpty:function(a,b){return 1===a.nodeType?0<a.childNodes.length?this._isNodeEmpty(a.childNodes[0],
b):!0:3===a.nodeType?""===a.nodeValue.substring(b):!1},_removeStartingRangeFromRange:function(a,b){if(a.nextSibling)b.setStart(a.nextSibling,0);else{for(var c=a.parentNode;c&&null==c.nextSibling;)c=c.parentNode;c&&b.setStart(c.nextSibling,0)}return b},_adaptIESelection:function(){var a=F.getSelection(this.window);if(a&&a.rangeCount&&!a.isCollapsed){for(var b=a.getRangeAt(0),c=b.startContainer,d=b.startOffset;3===c.nodeType&&d>=c.length&&c.nextSibling;)d-=c.length,c=c.nextSibling;for(var e=null;this._isNodeEmpty(c,
d)&&c!==e;)e=c,b=this._removeStartingRangeFromRange(c,b),c=b.startContainer,d=0;a.removeAllRanges();a.addRange(b)}},_adaptIEFormatAreaAndExec:function(a){var b=F.getSelection(this.window),c=this.document,d,e,f,g,h,k,l;if(a&&b&&b.isCollapsed){if(this.queryCommandValue(a)){a=this._tagNamesForCommand(a);f=b.getRangeAt(0);g=f.startContainer;3===g.nodeType&&(e=f.endOffset,g.length<e&&(e=this._adjustNodeAndOffset(d,e),g=e.node));for(;g&&g!==this.editNode;){d=g.tagName?g.tagName.toLowerCase():"";if(-1<p.indexOf(a,
d)){l=g;break}g=g.parentNode}if(l&&(d=f.startContainer,a=c.createElement(l.tagName),m.place(a,l,"after"),d&&3===d.nodeType)){e=f.endOffset;d.length<e&&(e=this._adjustNodeAndOffset(d,e),d=e.node,e=e.offset);g=d.nodeValue;f=c.createTextNode(g.substring(0,e));var n=g.substring(e,g.length);n&&(h=c.createTextNode(n));m.place(f,d,"before");h&&(k=c.createElement("span"),k.className="ieFormatBreakerSpan",m.place(k,d,"after"),m.place(h,k,"after"),h=k);m.destroy(d);f=f.parentNode;for(d=[];f!==l;){g=f.tagName;
e={tagName:g};d.push(e);g=c.createElement(g);f.style&&(g.style&&f.style.cssText)&&(g.style.cssText=f.style.cssText,e.cssText=f.style.cssText);"FONT"===f.tagName&&(f.color&&(g.color=f.color,e.color=f.color),f.face&&(g.face=f.face,e.face=f.face),f.size&&(g.size=f.size,e.size=f.size));f.className&&(g.className=f.className,e.className=f.className);if(h)for(;h;)e=h.nextSibling,g.appendChild(h),h=e;g.tagName==f.tagName?(k=c.createElement("span"),k.className="ieFormatBreakerSpan",m.place(k,f,"after"),m.place(g,
k,"after")):m.place(g,f,"after");h=g;f=f.parentNode}if(h){if(1===h.nodeType||3===h.nodeType&&h.nodeValue)a.innerHTML="";for(;h;)e=h.nextSibling,a.appendChild(h),h=e}if(d.length){e=d.pop();h=c.createElement(e.tagName);e.cssText&&h.style&&(h.style.cssText=e.cssText);e.className&&(h.className=e.className);"FONT"===e.tagName&&(e.color&&(h.color=e.color),e.face&&(h.face=e.face),e.size&&(h.size=e.size));for(m.place(h,a,"before");d.length;)e=d.pop(),l=c.createElement(e.tagName),e.cssText&&l.style&&(l.style.cssText=
e.cssText),e.className&&(l.className=e.className),"FONT"===e.tagName&&(e.color&&(l.color=e.color),e.face&&(l.face=e.face),e.size&&(l.size=e.size)),h.appendChild(l),h=l;l=c.createTextNode(".");k.appendChild(l);h.appendChild(l)}else k=c.createElement("span"),k.className="ieFormatBreakerSpan",l=c.createTextNode("."),k.appendChild(l),m.place(k,a,"before");h=F.create(this.window);h.setStart(l,0);h.setEnd(l,l.length);b.removeAllRanges();b.addRange(h);this.selection.collapse(!1);l.parentNode.innerHTML="";
a.firstChild||m.destroy(a);return!0}return!1}f=b.getRangeAt(0);if((d=f.startContainer)&&3===d.nodeType)return e=f.startOffset,d.length<e&&(e=this._adjustNodeAndOffset(d,e),d=e.node,e=e.offset),g=d.nodeValue,f=c.createTextNode(g.substring(0,e)),n=g.substring(e),""!==n&&(h=c.createTextNode(g.substring(e))),k=c.createElement("span"),l=c.createTextNode("."),k.appendChild(l),f.length?m.place(f,d,"after"):f=d,m.place(k,f,"after"),h&&m.place(h,k,"after"),m.destroy(d),h=F.create(this.window),h.setStart(l,
0),h.setEnd(l,l.length),b.removeAllRanges(),b.addRange(h),c.execCommand(a),m.place(k.firstChild,k,"before"),m.destroy(k),h.setStart(l,0),h.setEnd(l,l.length),b.removeAllRanges(),b.addRange(h),this.selection.collapse(!1),l.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(a){var b=F.getSelection(this.window);if(b.isCollapsed&&b.rangeCount&&!this.queryCommandValue(a)){var c=b.getRangeAt(0),d=c.startContainer;if(d&&3==d.nodeType&&!c.startOffset)return c="ul","insertorderedlist"===a&&(c=
"ol"),a=this.document.createElement(c),c=m.create("li",null,a),m.place(a,d,"before"),c.appendChild(d),m.create("br",null,a,"after"),a=F.create(this.window),a.setStart(d,0),a.setEnd(d,d.length),b.removeAllRanges(),b.addRange(a),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(a,c){var d=F.getSelection(this.window),f=this.document,g,h,k,l,n;c=c||null;if(a&&(d&&d.isCollapsed)&&d.rangeCount&&(h=d.getRangeAt(0),(g=h.startContainer)&&3===g.nodeType)){n=h.startOffset;g.length<
n&&(h=this._adjustNodeAndOffset(g,n),g=h.node,n=h.offset);k=g.nodeValue;h=f.createTextNode(k.substring(0,n));""!==k.substring(n)&&(l=f.createTextNode(k.substring(n)));k=f.createElement("span");n=f.createTextNode(".");k.appendChild(n);f=f.createElement("span");k.appendChild(f);h.length?m.place(h,g,"after"):h=g;m.place(k,h,"after");l&&m.place(l,k,"after");m.destroy(g);g=F.create(this.window);g.setStart(n,0);g.setEnd(n,n.length);d.removeAllRanges();d.addRange(g);if(b("webkit")){d="color";if("hilitecolor"===
a||"backcolor"===a)d="backgroundColor";e.set(k,d,c);this.selection.remove();m.destroy(f);k.innerHTML="\x26#160;";this.selection.selectElement(k);this.focus()}else this.execCommand(a,c),m.place(k.firstChild,k,"before"),m.destroy(k),g.setStart(n,0),g.setEnd(n,n.length),d.removeAllRanges(),d.addRange(g),this.selection.collapse(!1),n.parentNode.removeChild(n);return!0}return!1},_adjustNodeAndOffset:function(a,b){for(;a.length<b&&a.nextSibling&&3===a.nextSibling.nodeType;)b-=a.length,a=a.nextSibling;return{node:a,
offset:b}},_tagNamesForCommand:function(a){return"bold"===a?["b","strong"]:"italic"===a?["i","em"]:"strikethrough"===a?["s","strike"]:"superscript"===a?["sup"]:"subscript"===a?["sub"]:"underline"===a?["u"]:[]},_stripBreakerNodes:function(a){if(this.isLoaded)return s(".ieFormatBreakerSpan",a).forEach(function(a){for(;a.firstChild;)m.place(a.firstChild,a,"before");m.destroy(a)}),a},_stripTrailingEmptyNodes:function(a){for(;a.lastChild&&(/^(p|div|br)$/i.test(a.lastChild.nodeName)&&0==a.lastChild.children.length&&
/^[\s\xA0]*$/.test(a.lastChild.textContent||a.lastChild.innerText||"")||3===a.lastChild.nodeType&&/^[\s\xA0]*$/.test(a.lastChild.nodeValue));)m.destroy(a.lastChild);return a},_setTextDirAttr:function(a){this._set("textDir",a);this.onLoadDeferred.then(r.hitch(this,function(){this.editNode.dir=a}))}});return M})},"dijit/selection":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/sniff dojo/_base/window dijit/focus".split(" "),function(p,f,a,l,k,h){var q=function(g){var e=g.document;
this.getType=function(){if(e.getSelection){var a="text",d;try{d=g.getSelection()}catch(f){}d&&1==d.rangeCount&&(d=d.getRangeAt(0),d.startContainer==d.endContainer&&(1==d.endOffset-d.startOffset&&3!=d.startContainer.nodeType)&&(a="control"));return a}return e.selection.type.toLowerCase()};this.getSelectedText=function(){if(e.getSelection){var a=g.getSelection();return a?a.toString():""}return"control"==this.getType()?null:e.selection.createRange().text};this.getSelectedHtml=function(){if(e.getSelection){var a=
g.getSelection();if(a&&a.rangeCount){var d,f="";for(d=0;d<a.rangeCount;d++){var h=a.getRangeAt(d).cloneContents(),k=e.createElement("div");k.appendChild(h);f+=k.innerHTML}return f}return null}return"control"==this.getType()?null:e.selection.createRange().htmlText};this.getSelectedElement=function(){if("control"==this.getType()){if(e.getSelection){var a=g.getSelection();return a.anchorNode.childNodes[a.anchorOffset]}if((a=e.selection.createRange())&&a.item)return e.selection.createRange().item(0)}return null};
this.getParentElement=function(){if("control"==this.getType()){var a=this.getSelectedElement();if(a)return a.parentNode}else if(e.getSelection){if(a=e.getSelection()){for(a=a.anchorNode;a&&1!=a.nodeType;)a=a.parentNode;return a}}else return a=e.selection.createRange(),a.collapse(!0),a.parentElement();return null};this.hasAncestorElement=function(a){return null!=this.getAncestorElement.apply(this,arguments)};this.getAncestorElement=function(a){var d=this.getSelectedElement()||this.getParentElement();
return this.getParentOfType(d,arguments)};this.isTag=function(a,d){if(a&&a.tagName)for(var e=a.tagName.toLowerCase(),f=0;f<d.length;f++){var g=String(d[f]).toLowerCase();if(e==g)return g}return""};this.getParentOfType=function(a,d){for(;a;){if(this.isTag(a,d).length)return a;a=a.parentNode}return null};this.collapse=function(a){if(e.getSelection){var d=g.getSelection();d.removeAllRanges?a?d.collapseToStart():d.collapseToEnd():d.collapse(a)}else d=e.selection.createRange(),d.collapse(a),d.select()};
this.remove=function(){var a=e.selection;e.getSelection?(a=g.getSelection(),a.deleteFromDocument()):"none"!=a.type.toLowerCase()&&a.clear();return a};this.selectElementChildren=function(a,d){var h;a=f.byId(a);if(e.getSelection){var k=g.getSelection();l("opera")?(h=k.rangeCount?k.getRangeAt(0):e.createRange(),h.setStart(a,0),h.setEnd(a,3==a.nodeType?a.length:a.childNodes.length),k.addRange(h)):k.selectAllChildren(a)}else if(h=a.ownerDocument.body.createTextRange(),h.moveToElementText(a),!d)try{h.select()}catch(m){}};
this.selectElement=function(a,d){var g;a=f.byId(a);if(e.getSelection){var h=e.getSelection();g=e.createRange();h.removeAllRanges&&(l("opera")&&h.getRangeAt(0)&&(g=h.getRangeAt(0)),g.selectNode(a),h.removeAllRanges(),h.addRange(g))}else try{h=a.tagName?a.tagName.toLowerCase():"",g="img"===h||"table"===h?k.body(e).createControlRange():k.body(e).createRange(),g.addElement(a),d||g.select()}catch(m){this.selectElementChildren(a,d)}};this.inSelection=function(a){if(a){var d,f;if(e.getSelection){var h=g.getSelection();
h&&0<h.rangeCount&&(f=h.getRangeAt(0));if(f&&f.compareBoundaryPoints&&e.createRange)try{if(d=e.createRange(),d.setStart(a,0),1===f.compareBoundaryPoints(f.START_TO_END,d))return!0}catch(k){}}else{f=e.selection.createRange();try{d=a.ownerDocument.body.createTextRange(),d.moveToElementText(a)}catch(l){}if(f&&d&&1===f.compareEndPoints("EndToStart",d))return!0}}return!1};this.getBookmark=function(){var a,d,f=e.selection,k=h.curNode;if(e.getSelection){if(f=g.getSelection())if(f.isCollapsed){if(a=k?k.tagName:
"")if(a=a.toLowerCase(),"textarea"==a||"input"==a&&(!k.type||"text"==k.type.toLowerCase()))return f={start:k.selectionStart,end:k.selectionEnd,node:k,pRange:!0},{isCollapsed:f.end<=f.start,mark:f};a={isCollapsed:!0};f.rangeCount&&(a.mark=f.getRangeAt(0).cloneRange())}else d=f.getRangeAt(0),a={isCollapsed:!1,mark:d.cloneRange()}}else if(f){a=k?k.tagName:"";a=a.toLowerCase();if(k&&a&&("button"==a||"textarea"==a||"input"==a)){if(f.type&&"none"==f.type.toLowerCase())return{isCollapsed:!0,mark:null};d=
f.createRange();return{isCollapsed:d.text&&d.text.length?!1:!0,mark:{range:d,pRange:!0}}}a={};try{d=f.createRange(),a.isCollapsed=!("Text"==f.type?d.htmlText.length:d.length)}catch(l){return a.isCollapsed=!0,a}if("CONTROL"==f.type.toUpperCase())if(d.length){a.mark=[];f=0;for(k=d.length;f<k;)a.mark.push(d.item(f++))}else a.isCollapsed=!0,a.mark=null;else a.mark=d.getBookmark()}else console.warn("No idea how to store the current selection for this browser!");return a};this.moveToBookmark=function(c){if(c=
c.mark)if(e.getSelection){var d=g.getSelection();d&&d.removeAllRanges?c.pRange?(d=c.node,d.selectionStart=c.start,d.selectionEnd=c.end):(d.removeAllRanges(),d.addRange(c)):console.warn("No idea how to restore selection for this browser!")}else if(e.selection&&c){var f;c.pRange?f=c.range:a.isArray(c)?(f=e.body.createControlRange(),p.forEach(c,function(a){f.addElement(a)})):(f=e.body.createTextRange(),f.moveToBookmark(c));f.select()}};this.isCollapsed=function(){return this.getBookmark().isCollapsed}},
m=new q(window);m.SelectionManager=q;return m})},"dijit/_editor/range":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang"],function(p,f,a){var l={getIndex:function(a,f){for(var g=[],e=[],c=a,d,h;a!=f;){var k=0;for(d=a.parentNode;h=d.childNodes[k++];)if(h===a){--k;break}g.unshift(k);e.unshift(k-d.childNodes.length);a=d}if(0<g.length&&3==c.nodeType){for(h=c.previousSibling;h&&3==h.nodeType;)g[g.length-1]--,h=h.previousSibling;for(h=c.nextSibling;h&&3==h.nodeType;)e[e.length-
1]++,h=h.nextSibling}return{o:g,r:e}},getNode:function(f,h){if(!a.isArray(f)||0==f.length)return h;var g=h;p.every(f,function(a){if(0<=a&&a<g.childNodes.length)g=g.childNodes[a];else return g=null,!1;return!0});return g},getCommonAncestor:function(a,f,g){g=g||a.ownerDocument.body;var e=function(a){for(var c=[];a;)if(c.unshift(a),a!==g)a=a.parentNode;else break;return c};a=e(a);f=e(f);for(var e=Math.min(a.length,f.length),c=a[0],d=1;d<e;d++)if(a[d]===f[d])c=a[d];else break;return c},getAncestor:function(a,
f,g){for(g=g||a.ownerDocument.body;a&&a!==g;){var e=a.nodeName.toUpperCase();if(f.test(e))return a;a=a.parentNode}return null},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(a,f,g){g=g||a.ownerDocument.body;f=f||l.BlockTagNames;for(var e=null,c;a&&a!==g;){var d=a.nodeName.toUpperCase();!e&&f.test(d)&&(e=a);!c&&/^(?:BODY|TD|TH|CAPTION)$/.test(d)&&(c=a);a=a.parentNode}return{blockNode:e,blockContainer:c||a.ownerDocument.body}},atBeginningOfContainer:function(a,
f,g){var e=!1,c=0==g;!c&&3==f.nodeType&&/^[\s\xA0]+$/.test(f.nodeValue.substr(0,g))&&(c=!0);if(c)for(e=!0;f&&f!==a;){if(f.previousSibling){e=!1;break}f=f.parentNode}return e},atEndOfContainer:function(a,f,g){var e=!1,c=g==(f.length||f.childNodes.length);!c&&3==f.nodeType&&/^[\s\xA0]+$/.test(f.nodeValue.substr(g))&&(c=!0);if(c)for(e=!0;f&&f!==a;){if(f.nextSibling){e=!1;break}f=f.parentNode}return e},adjacentNoneTextNode:function(a,f){for(var g=a,e=0-a.length||0,c=f?"nextSibling":"previousSibling";g&&
3==g.nodeType;)e+=g.length,g=g[c];return[g,e]},create:function(a){a=a||window;return a.getSelection?a.document.createRange():new h},getSelection:function(a,f){if(a.getSelection)return a.getSelection();var g=new k.selection(a);f||g._getCurrentSelection();return g}};if(!window.getSelection)var k=l.ie={cachedSelection:{},selection:function(a){this._ranges=[];this.addRange=function(a,f){this._ranges.push(a);f||a._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=
[];this.rangeCount=0};this.getRangeAt=function(a){return this._ranges[a]};this._getCurrentSelection=function(){this.removeAllRanges();var f;f=a.document.selection.createRange();f="CONTROL"==a.document.selection.type.toUpperCase()?new h(k.decomposeControlRange(f)):new h(k.decomposeTextRange(f));f?(this.addRange(f,!0),this.isCollapsed=f.collapsed):this.isCollapsed=!0}},decomposeControlRange:function(a){var f=a.item(0),g=a.item(a.length-1);a=f.parentNode;var e=g.parentNode,f=l.getIndex(f,a).o[0],g=l.getIndex(g,
e).o[0]+1;return[a,f,e,g]},getEndPoint:function(a,f){var g=a.duplicate();g.collapse(!f);var e="EndTo"+(f?"End":"Start"),c=g.parentElement(),d,h,k;0<c.childNodes.length?p.every(c.childNodes,function(f,b){var m;if(3!=f.nodeType)if(g.moveToElementText(f),0<g.compareEndPoints(e,a))if(k&&3==k.nodeType)d=k,m=!0;else return d=c,h=b,!1;else{if(b==c.childNodes.length-1)return d=c,h=c.childNodes.length,!1}else b==c.childNodes.length-1&&(d=f,m=!0);if(m&&d){d=(m=l.adjacentNoneTextNode(d)[0])?m.nextSibling:c.firstChild;
var n=l.adjacentNoneTextNode(d);m=n[0];n=n[1];m?(g.moveToElementText(m),g.collapse(!1)):g.moveToElementText(c);g.setEndPoint(e,a);h=g.text.length-n;return!1}k=f;return!0}):(d=c,h=0);if(!f&&1==d.nodeType&&h==d.childNodes.length){var s=d.nextSibling;s&&3==s.nodeType&&(d=s,h=0)}return[d,h]},setEndPoint:function(a,f,g){a=a.duplicate();var e;if(3!=f.nodeType)if(0<g){if(e=f.childNodes[g-1])if(3==e.nodeType)f=e,g=e.length;else if(e.nextSibling&&3==e.nextSibling.nodeType)f=e.nextSibling,g=0;else{a.moveToElementText(e.nextSibling?
e:f);var c=e.parentNode;e=c.insertBefore(e.ownerDocument.createTextNode(" "),e.nextSibling);a.collapse(!1);c.removeChild(e)}}else a.moveToElementText(f),a.collapse(!0);3==f.nodeType&&(e=l.adjacentNoneTextNode(f),c=e[0],e=e[1],c?(a.moveToElementText(c),a.collapse(!1),"inherit"!=c.contentEditable&&e++):(a.moveToElementText(f.parentNode),a.collapse(!0),a.move("character",1),a.move("character",-1)),g+=e,0<g&&a.move("character",g)!=g&&console.error("Error when moving!"));return a},decomposeTextRange:function(a){var f=
k.getEndPoint(a),g=f[0],e=f[1],c=f[0],f=f[1];a.htmlText.length&&(a.htmlText==a.text?f=e+a.text.length:(f=k.getEndPoint(a,!0),c=f[0],f=f[1]));return[g,e,c,f]},setRange:function(a,f,g,e,c,d){f=k.setEndPoint(a,f,g);a.setEndPoint("StartToStart",f);if(!d)var h=k.setEndPoint(a,e,c);a.setEndPoint("EndToEnd",h||f);return a}},h=l.W3CRange=f(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=
null,this.startOffset=0,this.endContainer=null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=this.startContainer!==this.endContainer?l.getCommonAncestor(this.startContainer,this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(a,f){f=parseInt(f);this.startContainer===a&&this.startOffset==f||(delete this._cachedBookmark,this.startContainer=a,this.startOffset=f,
this.endContainer?this._updateInternal():this.setEnd(a,f))},setEnd:function(a,f){f=parseInt(f);this.endContainer===a&&this.endOffset==f||(delete this._cachedBookmark,this.endContainer=a,this.endOffset=f,this.startContainer?this._updateInternal():this.setStart(a,f))},setStartAfter:function(a,f){this._setPoint("setStart",a,f,1)},setStartBefore:function(a,f){this._setPoint("setStart",a,f,0)},setEndAfter:function(a,f){this._setPoint("setEnd",a,f,1)},setEndBefore:function(a,f){this._setPoint("setEnd",
a,f,0)},_setPoint:function(a,f,g,e){g=l.getIndex(f,f.parentNode).o;this[a](f.parentNode,g.pop()+e)},_getIERange:function(){var a=(this._body||this.endContainer.ownerDocument.body).createTextRange();k.setRange(a,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return a},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var a=this.startContainer,f=this._getIERange();3===
a.nodeType&&!this.startOffset&&this.setStartBefore(a);f.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var a=new h([this.startContainer,this.startOffset,this.endContainer,this.endOffset]);a._body=this._body;return a},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});a.setObject("dijit.range",l);return l})},"dijit/_editor/html":function(){define(["dojo/_base/array",
"dojo/_base/lang","dojo/sniff"],function(p,f,a){var l={};f.setObject("dijit._editor.html",l);var k=l.escapeXml=function(a,f){a=a.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");f||(a=a.replace(/'/gm,"\x26#39;"));return a};l.getNodeHtml=function(a){var f=[];l.getNodeHtmlHelper(a,f);return f.join("")};l.getNodeHtmlHelper=function(f,q){switch(f.nodeType){case 1:var m=f.nodeName.toLowerCase();if(!m||"/"==m.charAt(0))return"";q.push("\x3c",m);var g=
[],e={},c;if(a("dom-attributes-explicit")||a("dom-attributes-specified-flag"))for(var d=0;c=f.attributes[d++];){var r=c.name;if("_dj"!==r.substr(0,3)&&(!a("dom-attributes-specified-flag")||c.specified)&&!(r in e)){c=c.value;if("src"==r||"href"==r)f.getAttribute("_djrealurl")&&(c=f.getAttribute("_djrealurl"));8===a("ie")&&"style"===r&&(c=c.replace("HEIGHT:","height:").replace("WIDTH:","width:"));g.push([r,c]);e[r]=c}}else{var u=(/^input$|^img$/i.test(f.nodeName)?f:f.cloneNode(!1)).outerHTML,e=u.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi),
u=u.substr(0,u.indexOf("\x3e"));p.forEach(e,function(a){if(a){var c=a.indexOf("\x3d");if(0<c&&(a=a.substring(0,c),"_dj"!=a.substr(0,3)))if(("src"==a||"href"==a)&&f.getAttribute("_djrealurl"))g.push([a,f.getAttribute("_djrealurl")]);else{var b;switch(a){case "style":b=f.style.cssText.toLowerCase();break;case "class":b=f.className;break;case "width":if("img"===m){(c=/width=(\S+)/i.exec(u))&&(b=c[1]);break}case "height":if("img"===m){(c=/height=(\S+)/i.exec(u))&&(b=c[1]);break}default:b=f.getAttribute(a)}null!=
b&&g.push([a,b.toString()])}}},this)}g.sort(function(a,c){return a[0]<c[0]?-1:a[0]==c[0]?0:1});for(e=0;c=g[e++];)q.push(" ",c[0],'\x3d"',"string"===typeof c[1]?k(c[1],!0):c[1],'"');switch(m){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":q.push(" /\x3e");break;case "script":q.push("\x3e",f.innerHTML,"\x3c/",m,"\x3e");break;default:q.push("\x3e"),f.hasChildNodes()&&l.getChildrenHtmlHelper(f,q),q.push("\x3c/",m,"\x3e")}break;case 4:case 3:q.push(k(f.nodeValue,
!0));break;case 8:q.push("\x3c!--",k(f.nodeValue,!0),"--\x3e");break;default:q.push("\x3c!-- Element not recognized - Type: ",f.nodeType," Name: ",f.nodeName,"--\x3e")}};l.getChildrenHtml=function(a){var f=[];l.getChildrenHtmlHelper(a,f);return f.join("")};l.getChildrenHtmlHelper=function(f,k){if(f)for(var m=f.childNodes||f,g=!a("ie")||m!==f,e,c=0;e=m[c++];)(!g||e.parentNode==f)&&l.getNodeHtmlHelper(e,k)};return l})},"esri/dijit/ColorPicker":function(){define("../Color ../kernel ./_EventedWidget ./_Tooltip ./ColorPicker/colorUtil ./ColorPicker/HexPalette dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/on dojo/query dojo/sniff dojo/dom-style dojo/i18n!../nls/jsapi dojo/text!./ColorPicker/templates/ColorPicker.html ./HorizontalSlider dijit/form/RadioButton dijit/form/TextBox dijit/form/ToggleButton dojo/NodeList-dom".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n){f=e("esri.dijit.ColorPicker",[a,q,m,l],{_DEFAULT_COLORS_PER_ROW:13,templateString:n,labels:v.widgets.colorPicker,baseClass:"esriColorPicker",css:{container:"esriContainer",header:"esriHeader",footer:"esriFooter",middle:"esriMiddle",swatch:"esriSwatch",swatchRow:"esriSwatchRow",swatchEmpty:"esriSwatchEmpty",swatchPreview:"esriSwatchPreview",swatchTransparencyBackground:"esriSwatchTransparencyBackground",palette:"esriPalette",paletteOptions:"esriPaletteOptions",
paletteToggle:"esriPaletteToggle",label:"esriLabel",hexInput:"esriHexInput",recent:"esriRecent",suggested:"esriSuggested",selected:"esriSelected",disabled:"esriDisabled",section:"esriSection",displayNone:"esriDisplayNone",transparencySlider:"esriTransparencySlider",alt:"esriAlt"},color:null,trackColors:!0,_required:!1,_activePalette:null,recentColors:[],_showRecentColors:!0,_showTransparencySlider:!0,colorsPerRow:void 0,_brightsPalette:null,_pastelsPalette:null,_swatches:null,_colorInstance:null,
_swatchCreator:null,_noColorSwatchNode:null,constructor:function(a,b){a=a||{};this._colorInstance=new p;this._brightsPalette=new h({colors:a.palette});this._pastelsPalette=new h({colors:this._toPastels(this._brightsPalette.get("colors"))});this._activePalette=this._brightsPalette;this._swatchCreator=a.swatchCreator||this._createSwatch;a.hasOwnProperty("required")&&(this._required=a.required);a.hasOwnProperty("showRecentColors")&&(this._showRecentColors=a.showRecentColors);a.hasOwnProperty("showSuggestedColors")&&
(this._showSuggestedColors=a.showSuggestedColors);a.hasOwnProperty("showTransparencySlider")&&(this._showTransparencySlider=a.showTransparencySlider);a.color&&(a.color=k.normalizeColor(a.color));this.colorsPerRow=0<a.colorsPerRow?a.colorsPerRow:this._DEFAULT_COLORS_PER_ROW;this._swatches={}},_toPastels:function(a){var b=this._colorInstance,c=new p([238,238,238]);return g.map(a,function(a){return p.blendColors(b.setColor(a),c,0.2)},this)},_createSwatch:function(a){return r.create("span",{className:a.className,
style:{background:a.hexColor||"transparent"}},a.paletteNode)},_createSwatches:function(a,b){var c=this.css.swatch,d=this.css.swatchRow,e=this.colorsPerRow,f=b.get("colors"),h,k;g.forEach(f,function(b,f){0===f%e&&(h=r.create("div",{className:d},a));k=this._swatchCreator({className:c,hexColor:b,paletteNode:h});this._swatches[b]=k},this)},_selectColor:function(){var a=this.color||this._activePalette.get("colors")[0];this.set("color",a)},_setColorWithCurrentAlpha:function(a){"no-color"!==a&&"no-color"!==
this.color&&(a=k.normalizeColor(a),a.a=this.color.a);this.set("color",a)},_updatePreviewSwatch:function(a){var c=this.css.swatchEmpty,e=this.dap_previewSwatch,f,g;"no-color"===a?(d.add(e,c),b.set(e,{backgroundColor:"",borderColor:""})):(f=k.getContrastingColor(a),g=8!==t("ie"),d.remove(e,c),c=a.toCss(g),f=f.toCss(g),f={backgroundColor:c,borderColor:f},g||(f.opacity=a.a),b.set(e,f))},_showBrights:function(){d.remove(this.dap_paletteContainer,this.css.alt);this._activePalette=this._brightsPalette},
_showPastels:function(){d.add(this.dap_paletteContainer,this.css.alt);this._activePalette=this._pastelsPalette},_setColorFromSwatch:function(a){a=b.get(a,"backgroundColor");this._setColorWithCurrentAlpha(a)},_checkSelection:function(){var a=this.get("color");this._activePalette.contains(a)?this._highlightColor(a):this._clearSelection()},_addListeners:function(){var a="."+this.css.swatch;this.own(u(this.dap_paletteContainer,u.selector(a,"click"),c.hitch(this,function(a){this._setColorFromSwatch(a.target)})));
this.own(u(this.dap_recentColorPalette,u.selector(a,"click"),c.hitch(this,function(a){this._setColorFromSwatch(a.target)})));this.own(u(this.dap_suggestedColorPalette,u.selector(a,"click"),c.hitch(this,function(a){this._setColorFromSwatch(a.target)})));this._required||this.own(u(this._noColorSwatchNode,"click",c.hitch(this,function(a){this.set("color","no-color")})));var b=this.dap_hexInput;b.on("blur",c.hitch(this,function(){var a=k.normalizeHex(b.get("value"));k.isShorthandHex(a)?this._setColorWithCurrentAlpha(a):
this._silentlyUpdateHexInput(this.color)}));b.on("change",c.hitch(this,function(){var a=k.normalizeHex(b.get("value"));k.isLonghandHex(a)&&this.color.toHex()!==a&&this._setColorWithCurrentAlpha(a)}));this.dap_transparencySlider.on("change",c.hitch(this,function(a){var b=this.get("color");"no-color"!==b&&(b=k.normalizeColor(this._colorInstance.setColor(b)),b.a=1-a,this._updatePreviewSwatch(b),this._silentlyUpdateHexInput(b),this.set("color",b))}));this.dap_paletteToggle.on("change",c.hitch(this,this._togglePalette))},
_togglePalette:function(a){this.dap_paletteToggle.set("checked",a,!1);a?this._showPastels():this._showBrights();this._checkSelection()},postCreate:function(){this.inherited(arguments);this._addListeners();this._selectColor();this.dap_hexInput.intermediateChanges=!0;this.dap_transparencySlider.intermediateChanges=!0;this.createTooltips([{node:this.dap_paletteContainer,label:this.labels.paletteTooltip},{node:this.dap_hexInput,label:this.labels.hexInputTooltip},{node:this._noColorSwatchNode,label:this.labels.noColorTooltip},
{node:this.dap_paletteToggle,label:this.labels.moreColorsTooltip}])},buildRendering:function(){this.inherited(arguments);this._createPalettes();var a=this.css.swatch,b=this.css.swatchEmpty;this._required||(this._noColorSwatchNode=r.create("div",{className:a+" "+b},this.dap_hexInput.domNode,"after"));a=this.css.displayNone;this._showTransparencySlider||d.add(this.dap_transparencySection,a);this._showRecentColors||d.add(this.dap_recentColorSection,a);this._showSuggestedColors||d.add(this.dap_suggestedColorSection,
a)},_createPalettes:function(){this._swatches={};r.empty(this.dap_primaryPalette);r.empty(this.dap_secondaryPalette);this._createSwatches(this.dap_primaryPalette,this._brightsPalette);this._createSwatches(this.dap_secondaryPalette,this._pastelsPalette)},_silentlyUpdateHexInput:function(a){a="no-color"===a?"":a.toHex();this._silentlyUpdateIntermediateChangingValueWidget(this.dap_hexInput,a)},_silentlyUpdateIntermediateChangingValueWidget:function(a,b){a.intermediateChanges=!1;a.set("value",b,!1);a.intermediateChanges=
!0},addRecentColor:function(a){a&&"no-color"!==a&&this._addRecentColor(k.normalizeColor(a).toHex())},_addRecentColor:function(a){if(a){var b=this.recentColors,c=g.indexOf(b,a);-1<c&&b.splice(c,1);b.unshift(a);b.length>this.colorsPerRow&&b.pop();this._renderRecentSwatches()}},_renderRecentSwatches:function(){if(this.recentColors){var a=this.css.recent,c=this.css.swatch,d=s("."+a+"."+c,this.dap_recentColorPalette);g.forEach(this.recentColors,function(e,f){if(f<this.colorsPerRow){if(f+1>d.length){var g=
this._swatchCreator({hexColor:e,className:c+" "+a,paletteNode:this.dap_recentColorPalette});d.push(g)}b.set(d[f],"backgroundColor",e)}},this)}},_renderSuggestedSwatches:function(){if(this.suggestedColors){var a=this.css.suggested,c=this.css.swatch,d=s("."+a+"."+c,this.dap_recentColorPalette);g.forEach(this.suggestedColors,function(e,f){if(f<this.colorsPerRow){if(f+1>d.length){var g=this._swatchCreator({hexColor:e,className:c+" "+a,paletteNode:this.dap_suggestedColorPalette});d.push(g)}b.set(d[f],
"backgroundColor",e)}},this)}},_clearRecentSwatches:function(){r.empty(this.dap_recentColorPalette)},_clearSuggestedSwatches:function(){r.empty(this.dap_suggestedColorPalette)},_clearSelection:function(){var a=this.css.selected;s("."+a,this.dap_paletteContainer).removeClass(a)},_highlightColor:function(a){var c=this.css.selected,e=this._findColorSwatch(a);e&&(a=k.normalizeColor(a),a=k.getContrastingColor(a),d.add(e,c),b.set(e,"borderColor",a.toHex()))},_findColorSwatch:function(a){var b=this._activePalette.get("colors");
a=this._colorInstance.setColor(a).toHex();var c;-1<g.indexOf(b,a)&&(c=this._swatches[a]);return c},_getColorAttr:function(){return"no-color"===this.color?"no-color":new p(this.color)},_previousColor:null,_enableTransparencySlider:function(){d.remove(this.dap_transparencyLabel,this.css.disabled);this.dap_transparencySlider.set("disabled",!1)},_disableTransparencySlider:function(){d.add(this.dap_transparencyLabel,this.css.disabled);this.dap_transparencySlider.set("disabled",!0)},_setColorAttr:function(a,
c){a=a||"no-color";c=c||void 0===c;if(!this._required){if("no-color"===a){this._set("color","no-color");this._previousColor="no-color";this._disableTransparencySlider();this._clearSelection();this._silentlyUpdateHexInput("no-color");this._updatePreviewSwatch(a);d.add(this._noColorSwatchNode,this.css.selected);c&&this.emit("color-change",{color:"no-color"});return}this._enableTransparencySlider();d.remove(this._noColorSwatchNode,this.css.selected)}var e=k.normalizeColor(a),f=this._previousColor,g=
this._colorInstance,h=this.css.selected;if(f){if(k.equal(f,e))return;if(f=this._findColorSwatch(f))d.remove(f,h),b.set(f,"borderColor","")}g.setColor(e);h=g.toHex();this._set("color",new p(g));this._previousColor=e;this._silentlyUpdateIntermediateChangingValueWidget(this.dap_transparencySlider,1-g.a);this._updatePreviewSwatch(g);this._checkSelection();this._silentlyUpdateHexInput(g);this.trackColors&&this._addRecentColor(h);c&&this.emit("color-change",{color:new p(g)})},_getRecentColorsAttr:function(){return g.map(this.recentColors,
function(a){return k.normalizeColor(a)})},_setRecentColorsAttr:function(a){this.recentColors=a||[];this._showRecentColors&&(this.recentColors=g.map(this.recentColors,function(a){return k.normalizeColor(a).toHex()}));0===this.recentColors.length?this._clearRecentSwatches():this._renderRecentSwatches()},suggestedColors:null,_getSuggestedColorsAttr:function(){return g.map(this.suggestedColors,function(a){return k.normalizeColor(a)})},_setSuggestedColorsAttr:function(a){this._showSuggestedColors&&(this._clearSuggestedSwatches(),
this.suggestedColors=a||[],this.suggestedColors=g.map(this.suggestedColors,function(a){return k.normalizeColor(a).toHex()}),0<this.suggestedColors.length&&this._renderSuggestedSwatches())},_setPaletteAttr:function(a){var b=this._activePalette===this._brightsPalette;this._brightsPalette.set("colors",a);this._pastelsPalette.set("colors",this._toPastels(this._brightsPalette.get("colors")));this._activePalette=b?this._brightsPalette:this._pastelsPalette;this._createPalettes();this._togglePalette(!b)},
saveRecentColors:function(a){localStorage.setItem(a,JSON.stringify(this.get("recentColors")))},loadRecentColors:function(a){this.set("recentColors",JSON.parse(localStorage.getItem(a)))}});f.NO_COLOR="no-color";return f})},"esri/dijit/_Tooltip":function(){define(["dijit/Tooltip","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom"],function(p,f,a,l,k){return a(null,{declaredClass:"esri.dijit._Tooltip",_tooltips:null,constructor:function(){this._tooltips=[]},startup:function(){this.inherited(arguments);
this._started||f.forEach(this._tooltips,function(a){a.startup()})},destroy:function(){this.inherited(arguments);f.forEach(this._tooltips,function(a){a.destroy()});this._tooltips=null},createTooltips:function(a){f.forEach(a,function(a){this.createTooltip(a.node,a.label)},this)},createTooltip:function(a,f){var k=this._getConnectId(a);k&&(k="object"===typeof f?l.mixin({},f,{connectId:k}):{connectId:k,label:f},k=new p(k),this._started&&k.startup(),this._tooltips.push(k))},_getConnectId:function(a){var k,
m;if(a){if(l.isArray(a)){if(k=[],f.forEach(a,function(a){(m=this._getNode(a))&&k.push(m)}),0===k.length)return}else if(k=this._getNode(a),!k)return;return k}},_getNode:function(a){return k.byId(a.domNode||a)},findTooltip:function(a){var k=this._getNode(a),m,g,e;if(a){a=this._tooltips;m=a.length;for(var c=0;c<m;c++)if(g=a[c],e=l.isArray(g.connectId)?-1<f.indexOf(g.connectId,k):g.connectId===k)return g}}})})},"esri/dijit/ColorPicker/colorUtil":function(){define(["dojo/_base/lang","../../Color"],function(p,
f){var a={equal:function(a,f){return a&&f&&a.r===f.r&&a.g===f.g&&a.b===f.b&&a.a===f.a},normalizeHex:function(a){return"#"+p.trim(a).replace(/#/g,"").substr(0,6)},normalizeColor:function(a){return new f(a)},isValidHex:function(f){return a.isShorthandHex(f)||a.isLonghandHex(f)},_shortHandHex:/^#[0-9A-F]{3}$/i,isShorthandHex:function(f){return f&&4===f.length&&a._shortHandHex.test(f)},_longhandHex:/^#[0-9A-F]{6}$/i,isLonghandHex:function(f){return f&&7===f.length&&a._longhandHex.test(f)},getContrastingColor:function(f){return a.isBright(f)?
this.darker(f):this.brighter(f,3)},isBright:function(a){return 127<=0.299*a.r+0.587*a.g+0.114*a.b},darker:function(a,k){var h=Math.pow(0.7,k?k:1);return new f([Math.round(a.r*h),Math.round(a.g*h),Math.round(a.b*h),a.a])},brighter:function(a,k){var h=Math.pow(0.7,k?k:1),q=a.r,m=a.g,g=a.b;30>q&&(q=30);30>m&&(m=30);30>g&&(g=30);return new f([Math.min(255,Math.round(q/h)),Math.min(255,Math.round(m/h)),Math.min(255,Math.round(g/h)),a.a])}};return a})},"esri/dijit/ColorPicker/HexPalette":function(){define(["dojo/_base/array",
"dojo/_base/Color","dojo/_base/declare","dojo/Stateful"],function(p,f,a,l){var k="#ffffff #858585 #ffbebe #ffebbe #ffebaf #ffffbe #e9ffbe #d3ffbe #beffe8 #bee8ff #bed2ff #e8beff #ffbee8 #ebebeb #707070 #ff7f7f #ffa77f #ffd37f #ffff73 #d1ff73 #a3ff73 #73ffdf #73dfff #73b2ff #df73ff #ff73df #d6d6d6 #5c5c5c #ff0000 #ff5500 #ffaa00 #ffff00 #aaff00 #55ff00 #00ffc5 #00c5ff #0070ff #c500ff #ff00c5 #c2c2c2 #474747 #e60000 #e64c00 #e69800 #e6e600 #98e600 #4ce600 #00e6a9 #00a9e6 #005ce6 #a900e6 #e600a9 #adadad #242424 #a80000 #a83800 #a87000 #a8a800 #70a800 #38a800 #00a884 #0084a8 #004da8 #8400a8 #a80084 #999999 #1a1a1a #730000 #732600 #734c00 #737300 #4c7300 #267300 #00734c #004c73 #002673 #4c0073 #73004c".split(" ");
f=a([l],{constructor:function(a){a=a||{};this.set("colors",a.colors)},_colorInstance:new f,_colors:null,_colorsGetter:function(){return this._colors},_colorsSetter:function(a){a=a?a:k;this._colors=this._normalizeColors(a)},_normalizeColors:function(a){var f=this._colorInstance;return p.map(a,function(a){return f.setColor(a).toHex()},this)},contains:function(a){var f=this._colorInstance;f.setColor(a);return-1<p.indexOf(this._colors,f.toHex())}});f.DEFAULT_COLORS=k;return f})},"esri/dijit/HorizontalSlider":function(){define("dijit/form/HorizontalRuleLabels dijit/form/HorizontalSlider dojo/_base/declare dojo/_base/lang dojo/has ../kernel".split(" "),
function(p,f,a,l,k,h){return a("esri.dijit.HorizontalSlider",f,{baseClass:"esriHorizontalSlider",showButtons:!1,labels:null,constructor:function(a){a=a||{};a.labels&&(this.labels=a.labels)},buildRendering:function(){this.inherited(arguments);this.labels&&(new p({labels:this.labels})).placeAt(this.bottomDecoration)}})})},"dijit/form/HorizontalRuleLabels":function(){define("dojo/_base/declare dojo/has dojo/number dojo/query dojo/_base/lang ./HorizontalRule".split(" "),function(p,f,a,l,k,h){p=p("dijit.form.HorizontalRuleLabels",
h,{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH"\x3e\x3c/div\x3e',labelStyle:"",labels:[],numericMargin:0,minimum:0,maximum:1,constraints:{pattern:"#%"},_positionPrefix:'\x3cdiv class\x3d"dijitRuleLabelContainer dijitRuleLabelContainerH" style\x3d"left:',_labelPrefix:'"\x3e\x3cdiv class\x3d"dijitRuleLabel dijitRuleLabelH"\x3e',_suffix:"\x3c/div\x3e\x3c/div\x3e",_calcPosition:function(a){return a},_genHTML:function(a,f){var g=
this.labels[f];return this._positionPrefix+this._calcPosition(a)+this._positionSuffix+this.labelStyle+this._genDirectionHTML(g)+this._labelPrefix+g+this._suffix},_genDirectionHTML:function(a){return""},getLabels:function(){var f=this.labels;!f.length&&this.srcNodeRef&&(f=l("\x3e li",this.srcNodeRef).map(function(a){return String(a.innerHTML)}));if(!f.length&&1<this.count)for(var f=[],h=this.minimum,g=(this.maximum-h)/(this.count-1),e=0;e<this.count;e++)f.push(e<this.numericMargin||e>=this.count-this.numericMargin?
"":a.format(h,this.constraints)),h+=g;return f},postMixInProperties:function(){this.inherited(arguments);this.labels=this.getLabels();this.count=this.labels.length}});f("dojo-bidi")&&p.extend({_setTextDirAttr:function(a){this.textDir!=a&&(this._set("textDir",a),l(".dijitRuleLabelContainer",this.domNode).forEach(k.hitch(this,function(a){a.style.direction=this.getTextDir(a.innerText||a.textContent||"")})))},_genDirectionHTML:function(a){return this.textDir?"direction:"+this.getTextDir(a)+";":""}});
return p})},"dijit/form/HorizontalRule":function(){define(["dojo/_base/declare","../_Widget","../_TemplatedMixin"],function(p,f,a){return p("dijit.form.HorizontalRule",[f,a],{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH"\x3e\x3c/div\x3e',count:3,container:"containerNode",ruleStyle:"",_positionPrefix:'\x3cdiv class\x3d"dijitRuleMark dijitRuleMarkH" style\x3d"left:',_positionSuffix:"%;",_suffix:'"\x3e\x3c/div\x3e',_genHTML:function(a){return this._positionPrefix+a+this._positionSuffix+
this.ruleStyle+this._suffix},_isHorizontal:!0,buildRendering:function(){this.inherited(arguments);var a;if(1==this.count)a=this._genHTML(50,0);else{var f,h=100/(this.count-1);if(!this._isHorizontal||this.isLeftToRight()){a=this._genHTML(0,0);for(f=1;f<this.count-1;f++)a+=this._genHTML(h*f,f);a+=this._genHTML(100,this.count-1)}else{a=this._genHTML(100,0);for(f=1;f<this.count-1;f++)a+=this._genHTML(100-h*f,f);a+=this._genHTML(0,this.count-1)}}this.domNode.innerHTML=a}})})},"dijit/form/HorizontalSlider":function(){define("dojo/_base/array dojo/_base/declare dojo/dnd/move dojo/_base/fx dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/dnd/Moveable dojo/dnd/Mover dojo/query dojo/mouse dojo/on ../_base/manager ../focus ../typematic ./Button ./_FormValueWidget ../_Container dojo/text!./templates/HorizontalSlider.html".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x){var z=f("dijit.form._SliderMover",c,{onMouseMove:function(a){var b=this.widget,c=b._abspos;c||(c=b._abspos=k.position(b.sliderBarContainer,!0),b._setPixelValue_=m.hitch(b,"_setPixelValue"),b._isReversed_=b._isReversed());a=a[b._mousePixelCoord]-c[b._startingPixelCoord];b._setPixelValue_(b._isReversed_?c[b._pixelCount]-a:a,c[b._pixelCount],!1)},destroy:function(a){c.prototype.destroy.apply(this,arguments);var b=this.widget;b._abspos=null;b._setValueAttr(b.value,
!0)}});a=f("dijit.form.HorizontalSlider",[n,w],{templateString:x,value:0,showButtons:!0,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:!0,slideDuration:s.defaultDuration,_setIdAttr:"",_setNameAttr:"valueNode",baseClass:"dijitSlider",cssStateNodes:{incrementButton:"dijitSliderIncrementButton",decrementButton:"dijitSliderDecrementButton",focusNode:"dijitSliderThumb"},_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_handleOffsetCoord:"left",_progressPixelSize:"width",
_onKeyUp:function(a){!this.disabled&&(!this.readOnly&&!a.altKey&&!a.ctrlKey&&!a.metaKey)&&this._setValueAttr(this.value,!0)},_onKeyDown:function(a){if(!this.disabled&&!this.readOnly&&!a.altKey&&!a.ctrlKey&&!a.metaKey){switch(a.keyCode){case q.HOME:this._setValueAttr(this.minimum,!1);break;case q.END:this._setValueAttr(this.maximum,!1);break;case this._descending||this.isLeftToRight()?q.RIGHT_ARROW:q.LEFT_ARROW:case !1===this._descending?q.DOWN_ARROW:q.UP_ARROW:case !1===this._descending?q.PAGE_DOWN:
q.PAGE_UP:this.increment(a);break;case this._descending||this.isLeftToRight()?q.LEFT_ARROW:q.RIGHT_ARROW:case !1===this._descending?q.UP_ARROW:q.DOWN_ARROW:case !1===this._descending?q.PAGE_UP:q.PAGE_DOWN:this.decrement(a);break;default:return}a.stopPropagation();a.preventDefault()}},_onHandleClick:function(a){!this.disabled&&!this.readOnly&&(g("ie")||t.focus(this.sliderHandle),a.stopPropagation(),a.preventDefault())},_isReversed:function(){return!this.isLeftToRight()},_onBarClick:function(a){if(!this.disabled&&
!this.readOnly&&this.clickSelect){t.focus(this.sliderHandle);a.stopPropagation();a.preventDefault();var b=k.position(this.sliderBarContainer,!0),c=a[this._mousePixelCoord]-b[this._startingPixelCoord];this._setPixelValue(this._isReversed()?b[this._pixelCount]-c:c,b[this._pixelCount],!0);this._movable.onMouseDown(a)}},_setPixelValue:function(a,b,c){if(!this.disabled&&!this.readOnly){var d=this.discreteValues;if(1>=d||Infinity==d)d=b;d--;a=Math.round(a/(b/d));this._setValueAttr(Math.max(Math.min((this.maximum-
this.minimum)*a/d+this.minimum,this.maximum),this.minimum),c)}},_setValueAttr:function(a,b){this._set("value",a);this.valueNode.value=a;this.focusNode.setAttribute("aria-valuenow",a);this.inherited(arguments);var c=this.maximum>this.minimum?(a-this.minimum)/(this.maximum-this.minimum):0,d=!1===this._descending?this.remainingBar:this.progressBar,e=!1===this._descending?this.progressBar:this.remainingBar;this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);if(b&&
0<this.slideDuration&&d.style[this._progressPixelSize]){var f=this,g={},h=parseFloat(d.style[this._progressPixelSize]),k=this.slideDuration*(c-h/100);0!=k&&(0>k&&(k=0-k),g[this._progressPixelSize]={start:h,end:100*c,units:"%"},this._inProgressAnim=l.animateProperty({node:d,duration:k,onAnimate:function(a){e.style[f._progressPixelSize]=100-parseFloat(a[f._progressPixelSize])+"%"},onEnd:function(){delete f._inProgressAnim},properties:g}),this._inProgressAnim.play())}else d.style[this._progressPixelSize]=
100*c+"%",e.style[this._progressPixelSize]=100*(1-c)+"%"},_bumpValue:function(a,b){if(!this.disabled&&!(this.readOnly||this.maximum<=this.minimum)){var c=h.getComputedStyle(this.sliderBarContainer),d=k.getContentBox(this.sliderBarContainer,c),c=this.discreteValues;if(1>=c||Infinity==c)c=d[this._pixelCount];c--;d=Math.round((this.value-this.minimum)*c/(this.maximum-this.minimum))+a;0>d&&(d=0);d>c&&(d=c);d=d*(this.maximum-this.minimum)/c+this.minimum;this._setValueAttr(d,b)}},_onClkBumper:function(a){!this.disabled&&
(!this.readOnly&&this.clickSelect)&&this._setValueAttr(a,!0)},_onClkIncBumper:function(){this._onClkBumper(!1===this._descending?this.minimum:this.maximum)},_onClkDecBumper:function(){this._onClkBumper(!1===this._descending?this.maximum:this.minimum)},decrement:function(a){this._bumpValue(a.keyCode==q.PAGE_DOWN?-this.pageIncrement:-1)},increment:function(a){this._bumpValue(a.keyCode==q.PAGE_UP?this.pageIncrement:1)},_mouseWheeled:function(a){this.focused&&(a.stopPropagation(),a.preventDefault(),this._bumpValue(0>
a.wheelDelta?-1:1,!0))},startup:function(){this._started||(p.forEach(this.getChildren(),function(a){this[a.container]!=this.containerNode&&this[a.container].appendChild(a.domNode)},this),this.inherited(arguments))},_typematicCallback:function(a,b,c){if(-1==a)this._setValueAttr(this.value,!0);else this[b==(this._descending?this.incrementButton:this.decrementButton)?"decrement":"increment"](c)},buildRendering:function(){this.inherited(arguments);this.showButtons&&(this.incrementButton.style.display=
"",this.decrementButton.style.display="");var a=d('label[for\x3d"'+this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+"_label"),this.focusNode.setAttribute("aria-labelledby",a[0].id));this.focusNode.setAttribute("aria-valuemin",this.minimum);this.focusNode.setAttribute("aria-valuemax",this.maximum)},postCreate:function(){this.inherited(arguments);this.showButtons&&this.own(b.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500),b.addMouseListener(this.incrementButton,this,"_typematicCallback",
25,500));this.own(u(this.domNode,r.wheel,m.hitch(this,"_mouseWheeled")));var a=f(z,{widget:this});this._movable=new e(this.sliderHandle,{mover:a});this._layoutHackIE7()},destroy:function(){this._movable.destroy();this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);this.inherited(arguments)}});a._Mover=z;return a})},"dijit/typematic":function(){define("dojo/_base/array dojo/_base/connect dojo/_base/lang dojo/on dojo/sniff ./main".split(" "),function(p,f,a,l,
k,h){var q=h.typematic={_fireEventAndReload:function(){this._timer=null;this._callback(++this._count,this._node,this._evt);this._currentTimeout=Math.max(0>this._currentTimeout?this._initialDelay:1<this._subsequentDelay?this._subsequentDelay:Math.round(this._currentTimeout*this._subsequentDelay),this._minDelay);this._timer=setTimeout(a.hitch(this,"_fireEventAndReload"),this._currentTimeout)},trigger:function(f,g,e,c,d,h,k,l){if(d!=this._obj){this.stop();this._initialDelay=k||500;this._subsequentDelay=
h||0.9;this._minDelay=l||10;this._obj=d;this._node=e;this._count=this._currentTimeout=-1;this._callback=a.hitch(g,c);this._evt={faux:!0};for(var q in f)"layerX"!=q&&"layerY"!=q&&(g=f[q],"function"!=typeof g&&"undefined"!=typeof g&&(this._evt[q]=g));this._fireEventAndReload()}},stop:function(){this._timer&&(clearTimeout(this._timer),this._timer=null);this._obj&&(this._callback(-1,this._node,this._evt),this._obj=null)},addKeyListener:function(h,g,e,c,d,k,u){var s="keyCode"in g?"keyCode":"charCode"in
g?"charCode":"charOrCode",t=[l(h,"keyCode"in g?"keydown":"charCode"in g?"keypress":f._keypress,a.hitch(this,function(a){a[s]==g[s]&&(void 0===g.ctrlKey||g.ctrlKey==a.ctrlKey)&&(void 0===g.altKey||g.altKey==a.altKey)&&(void 0===g.metaKey||g.metaKey==(a.metaKey||!1))&&(void 0===g.shiftKey||g.shiftKey==a.shiftKey)?(a.stopPropagation(),a.preventDefault(),q.trigger(a,e,h,c,g,d,k,u)):q._obj==g&&q.stop()})),l(h,"keyup",a.hitch(this,function(){q._obj==g&&q.stop()}))];return{remove:function(){p.forEach(t,
function(a){a.remove()})}}},addMouseListener:function(f,g,e,c,d,h){var u=[l(f,"mousedown",a.hitch(this,function(a){a.preventDefault();q.trigger(a,g,f,e,f,c,d,h)})),l(f,"mouseup",a.hitch(this,function(a){this._obj&&a.preventDefault();q.stop()})),l(f,"mouseout",a.hitch(this,function(a){this._obj&&a.preventDefault();q.stop()})),l(f,"dblclick",a.hitch(this,function(l){l.preventDefault();9>k("ie")&&(q.trigger(l,g,f,e,f,c,d,h),setTimeout(a.hitch(this,q.stop),50))}))];return{remove:function(){p.forEach(u,
function(a){a.remove()})}}},addListener:function(a,f,e,c,d,h,k,l){var q=[this.addKeyListener(f,e,c,d,h,k,l),this.addMouseListener(a,c,d,h,k,l)];return{remove:function(){p.forEach(q,function(a){a.remove()})}}}};return q})},"dijit/form/RadioButton":function(){define(["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],function(p,f,a){return p("dijit.form.RadioButton",[f,a],{baseClass:"dijitRadio"})})},"dijit/form/_RadioButtonMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/lang dojo/query!css2 ../registry".split(" "),
function(p,f,a,l,k,h){return f("dijit.form._RadioButtonMixin",null,{type:"radio",_getRelatedWidgets:function(){var a=[];k("input[type\x3dradio]",this.focusNode.form||this.ownerDocument).forEach(l.hitch(this,function(f){f.name==this.name&&f.form==this.focusNode.form&&(f=h.getEnclosingWidget(f))&&a.push(f)}));return a},_setCheckedAttr:function(a){this.inherited(arguments);this._created&&a&&p.forEach(this._getRelatedWidgets(),l.hitch(this,function(a){a!=this&&a.checked&&a.set("checked",!1)}))},_getSubmitValue:function(a){return null==
a?"on":a},_onClick:function(f){if(this.checked||this.disabled)return f.stopPropagation(),f.preventDefault(),!1;if(this.readOnly)return f.stopPropagation(),f.preventDefault(),p.forEach(this._getRelatedWidgets(),l.hitch(this,function(e){a.set(this.focusNode||this.domNode,"checked",e.checked)})),!1;var h=!1,g;p.some(this._getRelatedWidgets(),function(a){return a.checked?(g=a,!0):!1});this.checked=!0;g&&(g.checked=!1);if(!1===this.onClick(f)||f.defaultPrevented)h=!0;this.checked=!1;g&&(g.checked=!0);
h?f.preventDefault():this.set("checked",!0);return!h}})})},"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),function(p,f,a,l,k,h){var q=a("dijit._editor.plugins.TextColor",k,{buttonClass:h,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var a=this;this.button.loadDropDown=function(f){function e(c){a.button.dropDown=
new c({dir:a.editor.dir,ownerDocument:a.editor.ownerDocument,value:a.value,onChange:function(c){a.editor.execCommand(a.command,c)},onExecute:function(){a.editor.execCommand(a.command,this.get("value"))}});f()}"string"==typeof a.colorPicker?p([a.colorPicker],e):e(a.colorPicker)}},updateState:function(){var a=this.editor,g=this.command;if(a&&a.isLoaded&&g.length){if(this.button){var e=this.get("disabled");this.button.set("disabled",e);if(e)return;var c;try{c=a.queryCommandValue(g)||""}catch(d){c=""}}""==
c&&(c="#000000");"transparent"==c&&(c="#ffffff");"string"==typeof c?-1<c.indexOf("rgb")&&(c=f.fromRgb(c).toHex()):(c=((c&255)<<16|c&65280|(c&16711680)>>>16).toString(16),c="#000000".slice(0,7-c.length)+c);this.value=c;(a=this.button.dropDown)&&(a.get&&c!==a.get("value"))&&a.set("value",c,!1)}}});k.registry.foreColor=function(a){return new q(a)};k.registry.hiliteColor=function(a){return new q(a)};return q})},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],
function(p,f,a,l){var k={};f.setObject("dojo.colors",k);var h=function(a,f,e){0>e&&++e;1<e&&--e;var c=6*e;return 1>c?a+(f-a)*c:1>2*e?f:2>3*e?a+6*(f-a)*(2/3-e):a};p.colorFromRgb=a.fromRgb=function(f,g){var e=f.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(e){var c=e[2].split(/\s*,\s*/),d=c.length,e=e[1];if("rgb"==e&&3==d||"rgba"==e&&4==d)return e=c[0],"%"==e.charAt(e.length-1)?(e=l.map(c,function(a){return 2.56*parseFloat(a)}),4==d&&(e[3]=c[3]),a.fromArray(e,g)):a.fromArray(c,g);if("hsl"==
e&&3==d||"hsla"==e&&4==d){var e=(parseFloat(c[0])%360+360)%360/360,k=parseFloat(c[1])/100,q=parseFloat(c[2])/100,k=0.5>=q?q*(k+1):q+k-q*k,q=2*q-k,e=[256*h(q,k,e+1/3),256*h(q,k,e),256*h(q,k,e-1/3),1];4==d&&(e[3]=c[3]);return a.fromArray(e,g)}}return null};var q=function(a,f,e){a=Number(a);return isNaN(a)?e:a<f?f:a>e?e:a};a.prototype.sanitize=function(){this.r=Math.round(q(this.r,0,255));this.g=Math.round(q(this.g,0,255));this.b=Math.round(q(this.b,0,255));this.a=q(this.a,0,1);return this};k.makeGrey=
a.makeGrey=function(f,g){return a.fromArray([f,f,f,g])};f.mixin(a.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],
darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,
105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,
128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,
112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,
239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,
99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return a})},"dijit/form/DropDownButton":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/query ../registry ../popup ./Button ../_Container ../_HasDropDown dojo/text!./templates/DropDownButton.html ../a11yclick".split(" "),function(p,f,a,l,k,h,q,m,g,e){return p("dijit.form.DropDownButton",[q,m,g],{baseClass:"dijitDropDownButton",templateString:e,_fillContent:function(){var a=
this.srcNodeRef,d=this.containerNode;if(a&&d)for(;a.hasChildNodes();){var e=a.firstChild;e.hasAttribute&&(e.hasAttribute("data-dojo-type")||e.hasAttribute("dojoType")||e.hasAttribute("data-"+f._scopeName+"-type")||e.hasAttribute(f._scopeName+"Type"))?(this.dropDownContainer=this.ownerDocument.createElement("div"),this.dropDownContainer.appendChild(e)):d.appendChild(e)}},startup:function(){this._started||(!this.dropDown&&this.dropDownContainer&&(this.dropDown=k.byNode(this.dropDownContainer.firstChild),
delete this.dropDownContainer),this.dropDown&&h.hide(this.dropDown),this.inherited(arguments))},isLoaded:function(){var a=this.dropDown;return!!a&&(!a.href||a.isLoaded)},loadDropDown:function(c){var d=this.dropDown,e=d.on("load",a.hitch(this,function(){e.remove();c()}));d.refresh()},isFocusable:function(){return this.inherited(arguments)&&!this._mouseDown}})})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d){var r=f("dijit._editor.plugins.LinkDialog",e,{buttonClass:c,useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=k.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(a){p("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),k.hitch(this,function(c,b,d){var e=this;this.tag="insertImage"==this.command?"img":"a";c=k.delegate(c.getLocalization("dijit","common",this.lang),c.getLocalization("dijit._editor",
"LinkDialog",this.lang));var f=this.dropDown=this.button.dropDown=new b({title:c[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:k.hitch(this,"setValue"),onOpen:function(){e._onOpenDialog();b.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(k.hitch(e,"_onCloseDialog"),0)}});c.urlRegExp=this.urlRegExp;c.id=d.getUniqueId(this.editor.id);this._uniqueId=c.id;this._setContent(f.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
g.substitute(this.linkDialogTemplate,c));f.startup();this._urlInput=d.byId(this._uniqueId+"_urlInput");this._textInput=d.byId(this._uniqueId+"_textInput");this._setButton=d.byId(this._uniqueId+"_setButton");this.own(d.byId(this._uniqueId+"_cancelButton").on("click",k.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",k.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",k.hitch(this,"_checkAndFixInput")));this._urlRegExp=RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=k.hitch(this,function(){var a=this._urlInput.get("value");return this._urlRegExp.test(a)||this._emailRegExp.test(a)});this.own(h(f.domNode,"keydown",k.hitch(this,k.hitch(this,function(a){a&&(a.keyCode==l.ENTER&&!a.shiftKey&&!a.metaKey&&!a.ctrlKey&&!a.altKey)&&!this._setButton.get("disabled")&&(f.onExecute(),f.execute(f.get("value")))}))));a()}))},_checkAndFixInput:function(){var a=this,c=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var b=c,d=!1,e=!1;b&&1<b.length&&(b=k.trim(b),0!==b.indexOf("mailto:")&&(0<b.indexOf("/")?-1===b.indexOf("://")&&"/"!==b.charAt(0)&&b.indexOf("./")&&0!==b.indexOf("../")&&a._hostRxp.test(b)&&(d=!0):a._userAtRxp.test(b)&&(e=!0)));d&&a._urlInput.set("value","http://"+b);e&&a._urlInput.set("value","mailto:"+b);a._setButton.set("disabled",!a._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(k.hitch(this,
function(){this.own(h(this.editor.editNode,"dblclick",k.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(a){this.dropDown.set({parserScope:"dojo",content:a})},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));return a},setValue:function(c){this._onCloseDialog();if(9>q("ie")){var e=d.getSelection(this.editor.window).getRangeAt(0).endContainer;3===e.nodeType&&(e=e.parentNode);
e&&(e.nodeName&&e.nodeName.toLowerCase()!==this.tag)&&(e=this.editor.selection.getSelectedElement(this.tag));e&&(e.nodeName&&e.nodeName.toLowerCase()===this.tag)&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(e),this.editor.execCommand("unlink"))}c=this._checkValues(c);this.editor.execCommand("inserthtml",g.substitute(this.htmlTemplate,c));m("a",this.editor.document).forEach(function(b){!b.innerHTML&&!a.has(b,"name")&&b.parentNode.removeChild(b)},this)},_onCloseDialog:function(){this.editor.focused&&
this.editor.focus()},_getCurrentValues:function(a){var c,b,d;a&&a.tagName.toLowerCase()===this.tag?(c=a.getAttribute("_djrealurl")||a.getAttribute("href"),d=a.getAttribute("target")||"_self",b=a.textContent||a.innerText,this.editor.selection.selectElement(a,!0)):b=this.editor.selection.getSelectedText();return{urlInput:c||"",textInput:b||"",targetSelect:d||""}},_onOpenDialog:function(){var a,c;if(q("ie")){if(c=d.getSelection(this.editor.window),c.rangeCount){var b=c.getRangeAt(0);a=b.endContainer;
3===a.nodeType&&(a=a.parentNode);a&&(a.nodeName&&a.nodeName.toLowerCase()!==this.tag)&&(a=this.editor.selection.getSelectedElement(this.tag));if(!a||a.nodeName&&a.nodeName.toLowerCase()!==this.tag)if((c=this.editor.selection.getAncestorElement(this.tag))&&c.nodeName&&c.nodeName.toLowerCase()==this.tag)a=c,this.editor.selection.selectElement(a);else if(b.startContainer===b.endContainer&&(c=b.startContainer.firstChild)&&c.nodeName&&c.nodeName.toLowerCase()==this.tag)a=c,this.editor.selection.selectElement(a)}}else a=
this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(a))},_onDblClick:function(c){if(c&&c.target&&(c=c.target,(c.tagName?c.tagName.toLowerCase():"")===this.tag&&a.get(c,"href"))){var d=this.editor;this.editor.selection.selectElement(c);d.onDisplayChanged();d._updateTimer&&(d._updateTimer.remove(),delete d._updateTimer);d.onNormalizedDisplayChanged();var b=this.button;setTimeout(function(){b.set("disabled",
!1);b.loadAndOpenDropDown().then(function(){b.dropDown.focus&&b.dropDown.focus()})},10)}}}),u=f("dijit._editor.plugins.ImgLinkDialog",[r],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(a){var c,b;a&&a.tagName.toLowerCase()===this.tag?(c=a.getAttribute("_djrealurl")||a.getAttribute("src"),b=a.getAttribute("alt"),this.editor.selection.selectElement(a,!0)):b=this.editor.selection.getSelectedText();return{urlInput:c||"",textInput:b||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);this.editor.onLoadDeferred.then(k.hitch(this,
function(){this.own(h(this.editor.editNode,"mousedown",k.hitch(this,"_selectTag")))}))},_selectTag:function(a){a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(a))},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));a&&a.textInput&&(a.textInput=a.textInput.replace(/"/g,"\x26quot;"));return a},_onDblClick:function(c){if(c&&c.target&&(c=c.target,(c.tagName?c.tagName.toLowerCase():"")===this.tag&&a.get(c,
"src"))){var d=this.editor;this.editor.selection.selectElement(c);d.onDisplayChanged();d._updateTimer&&(d._updateTimer.remove(),delete d._updateTimer);d.onNormalizedDisplayChanged();var b=this.button;setTimeout(function(){b.set("disabled",!1);b.loadAndOpenDropDown().then(function(){b.dropDown.focus&&b.dropDown.focus()})},10)}}});e.registry.createLink=function(){return new r({command:"createLink"})};e.registry.insertImage=function(){return new u({command:"insertImage"})};r.ImgLinkDialog=u;return r})},
"builder/plugins/app-config-templateconfig/_build-generate_module":function(){define(["builder/plugins/app-config-templateconfig/Plugin","dojo/text!builder/plugins/app-config-templateconfig/Plugin.html","dojo/text!builder/plugins/app-config-templateconfig/css/style.css","dojo/i18n!builder/plugins/app-config-templateconfig/nls/strings"],function(){})},"builder/plugins/app-config-templateconfig/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic builder/BasePlugin builder/dijit/template-config/Template builder/dijit/template-config/utils builder/dijit/TemplateAttributes".split(" "),
function(p,f,a,l,k,h,q,m){return p([k],{baseClass:"plugin-config-template",postCreate:function(){this.inherited(arguments);this.own(l.subscribe("app/appConfigLoaded",f.hitch(this,this._onAppConfigLoaded)));this.own(l.subscribe("app/appConfigChanged",f.hitch(this,this._onAppConfigChanged)));this.pluginManager.getPluginByName("app-config").addRepublishEvent("templateConfigChanged")},_init:function(){this.visible&&this.appConfig&&q.loadAllWidgetConfigs(f.clone(this.appConfig)).then(f.hitch(this,function(a){this._initConfigPanel(a);
this._initPriviewPanel(this.configTemplate.getTemplateConfig())}))},_initConfigPanel:function(g){this.configTemplate&&this.configTemplate.destroy();this.configTemplate=new h({appConfig:g,appInfo:window.appInfo,templateConfig:g.templateConfig});this.configTemplate.on("hasChanged",f.hitch(this,this._onConfigTempalteChanged));a.place(this.configTemplate.domNode,this.configPanel);this.configTemplate.startup()},_initPriviewPanel:function(f){this.previewTemplate&&this.previewTemplate.destroy();this.previewTemplate=
new m({templateConfig:f});a.place(this.previewTemplate.domNode,this.previewPanel);this.previewTemplate.startup()},_onAppConfigLoaded:function(a){this.appConfig=a;this._init()},_onAppConfigChanged:function(a){this.appConfig=a},_onToAppClick:function(){this.pluginManager.getPluginByName("app-config").switchToConfigApp()},_onConfigTempalteChanged:function(){this._initPriviewPanel(this.configTemplate.getTemplateConfig());l.publish("templateConfigChanged",this.configTemplate.getFullTemplateConfig())},
refresh:function(){this._init()}})})},"builder/dijit/template-config/Template":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Template.html dojo/on dojo/dom dojo/_base/lang dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-attr dojo/json dojo/query dojo/Deferred dojo/Evented dijit/form/Select ./ConfigNode ./CategoryManager ./Export builder/serviceUtils jimu/utils jimu/WidgetManager jimu/dijit/Message jimu/portalUrlUtils builder/portalUtils jimu/dijit/LoadingShelter ./ExportMessage".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A,B,F,E,H,I){return p([l,k,b],{templateString:h,baseClass:"agol-template",configTree:null,nls:null,lastTemplateJson:null,constructor:function(){this.loading=new H({hidden:!0})},postMixInProperties:function(){this.nls=window.builderNls;this.imageFolder="builder/css/images/agoltemplate/";this.arrowImgSrc=isRTL?this.imageFolder+"v_left.png":this.imageFolder+"v_right.png"},postCreate:function(){this.inherited(arguments)},startup:function(){this._beforeInitWork();
m.setSelectable(this.contentPart,!1);this.configTree=new n(this.cleanAppConfig,null,"app","",0);this.categoryManager=new w(this.configTree,this.cleanAppConfig,this.templateConfig);this.drawTree(this.configTree,this.treePart);this.drawCategoryPart();this._afterInitWork()},_beforeInitWork:function(){this.cleanAppConfig=this.appConfig.getCleanConfig();this.cleanAppConfig.visitElement=this.appConfig.visitElement;this.cleanAppConfig.visitElement(function(a){!a.widgets&&(a.uri&&void 0===a.visible)&&(a.visible=
!0);!a.widgets&&(a.uri&&0===a.uri.indexOf("themes/"))&&delete a.visible});delete this.cleanAppConfig.visitElement;delete this.cleanAppConfig._buildInfo;delete this.cleanAppConfig.agolTemplateJson},_afterInitWork:function(){this.lastTemplateJson=this.categoryManager.getTemplateJson()},drawTree:function(a,b){var c,d;c=this.drawDomNode(a,b);if(0!==a.childs.length)for(d=0;d<a.childs.length;d++)this.drawTree(a.childs[d],c)},drawDomNode:function(b,d){var f,h,k,l,n,m,s;s=this.categoryManager.getCategoryByField(b.absolutePath);
f=e.create("div",{"class":"tree-node-div",idAttr:b.id},d);b.traversal(g.hitch(this,function(a){if(this.categoryManager.getCategoryByField(a.absolutePath))return!0}))||c.set(f,"display","none");"leaf"===b.nodeType&&!s&&c.set(f,"color","#cccccc");h=e.create("div",{"class":"line-label-div "},f);m=b.label?b.label:b.keyString;m.indexOf("]")===m.length-1&&(m+="\x26lrm;");m=e.create("div",{"class":"line-label-text ",innerHTML:m,title:m},h);"leaf"!==b.nodeType&&(k=e.create("div",{"class":"show-subnode-div jimu-float-leading"},
m),l=e.create("img",{"class":"show-subnode-img",src:this.arrowImgSrc,alt:"img"},k));s&&"leaf"===b.nodeType&&(n=e.create("div",{"class":"to-right-div "},f),e.create("img",{"class":"to-right-img",src:this.imageFolder+"add_field.png",alt:"img"},n),this.own(q(n,"click",g.hitch(this,function(a){c.set(n,"display","none");this._onToRightDiv(b,"add",f);a.stopPropagation();this._checkTemplateStatus()}))),-1!==s.findFieldFromDisplay(b.absolutePath)&&c.set(n,"display","none"));m=12*b.level;"leaf"===b.nodeType?
isRTL?c.set(h,"paddingRight",m+17+"px"):c.set(h,"paddingLeft",m+17+"px"):isRTL?c.set(h,"paddingRight",m+"px"):c.set(h,"paddingLeft",m+"px");h=e.create("div",{"class":"tree-node-subdiv"},d);c.set(h,"display","none");"leaf"!==b.nodeType?(c.set(f,"cursor","pointer"),this.own(q(f,"click",g.hitch(this,function(a,b,d){"none"===c.get(b,"display")?(c.set(b,"display","block"),r.set(d,"src",this.imageFolder+"v.png")):(c.set(b,"display","none"),r.set(d,"src",this.arrowImgSrc));-1!==a.absolutePath.search(/widgets\[[0-9]+\]_config$/)&&
!a.jsonObject&&this.addWidgetConfigToConfigTree(a.absolutePath)},b,h,l)))):s&&(c.set(f,"cursor","pointer"),this.own(q(f,"click",g.hitch(this,function(a,b){this._onToRightDiv(a,"notAdd",f);b.stopPropagation()},b))));b.lineDomNode=f;b.subLineDomNode=h;b.showSubDivDomNode=k;b.toRightDiv=n;0===b.level&&(a.setStyle(f,"display","none"),a.setStyle(h,"display","block"));return h},drawCategoryPart:function(){f.forEach(this.categoryManager.displayCategorys,function(a){this.drawCategory(a)},this)},drawCategory:function(a){var b,
d,h,k,l,n,m;b=e.create("div",{"class":"category-div",categoryDiv:a.name},this.categoryPart);k=e.create("div",{"class":"category-head-div",categoryHeadDiv:a.name},b);l=e.create("div",{"class":"category-fold-div jimu-float-leading"},k);m=e.create("img",{"class":"category-fold-img",src:this.arrowImgSrc,alt:"img"},l);e.create("div",{"class":"category-title-div jimu-float-leading",innerHTML:a.title},k);d=e.create("div",{"class":"category-oper-div jimu-float-trailing"},k);l=e.create("div",{"class":"category-oper-item-div category-moveup-div jimu-float-leading",
innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"moveup.png' alt\x3d'img'\x3e\x3c/img\x3e"},d);n=e.create("div",{"class":"category-oper-item-div category-movedown-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"movedown.png' alt\x3d'img'\x3e\x3c/img\x3e"},d);d=e.create("div",{"class":"category-oper-item-div category-remove-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"delete01.png' alt\x3d'img'\x3e\x3c/img\x3e"},d);h=e.create("div",{"class":"fields-div",
fieldsDiv:a.name},b);this.own(q(l,"click",g.hitch(this,function(b){this.categoryManager.moveup(a)&&(e.empty(this.categoryPart),this.drawCategoryPart());this._changeHeighlightCategoryHead(a.name);b.stopPropagation();this._checkTemplateStatus()})));this.own(q(n,"click",g.hitch(this,function(b){this.categoryManager.movedown(a)&&(e.empty(this.categoryPart),this.drawCategoryPart());this._changeHeighlightCategoryHead(a.name);b.stopPropagation();this._checkTemplateStatus()})));this.own(q(d,"click",g.hitch(this,
function(d){this.categoryManager.removeCategoryFromDisplay(a);e.destroy(b);f.forEach(a.displayFields,function(a){var b=this.configTree.findNode(a.fieldPath);b&&(b.setTemplateField(a.fieldJson),b.toRightDiv&&c.set(b.toRightDiv,"display","block"))},this);a.displayFields=[];d.stopPropagation();this._checkTemplateStatus()})));this.own(q(k,"click",g.hitch(this,function(){"block"===c.get(h,"display")?(c.set(h,"display","none"),r.set(m,"src",this.arrowImgSrc)):(c.set(h,"display","block"),r.set(m,"src",this.imageFolder+
"v.png"));this._changeHeighlightCategoryHead(a.name)})));this.drawFields(a,b,h);c.set(h,"display","none")},drawFields:function(a,b,c){f.forEach(a.displayFields,function(d){this.drawField(a,b,c,d)},this)},addWidgetConfigToConfigTree:function(a){var b=new t,c=a.search(/widgets\[[0-9]+\]/),d=a.slice(c,a.length).indexOf("]"),c=a.slice(0,c+d+1);a=c+"_config";var c=this.configTree.findNode(c),e=this.configTree.findNode(a);a=this.appConfig.getConfigElementById(c.jsonObject.id);A.getInstance().tryLoadWidgetConfig(a).then(g.hitch(this,
function(a){if(a){var c;e.jsonObject=a;a.geocoder&&a.geocoder.geocoders&&delete a.geocoder.geocoders;for(c in a)a.hasOwnProperty(c)&&(c=e.addChild(a[c],c,e.absolutePath,e.level),this.drawTree(c,e.subLineDomNode))}b.resolve()}));return b},drawField:function(b,d,h,k){var l,m,s,p,t,u,w,x;this.configTree.findNode(k.fieldPath);x=n.getDefaultTemplateField(k.fieldPath,k.fieldJson.type,k.fieldJson.label);for(l in k.fieldJson)k.fieldJson.hasOwnProperty(l)&&(x[l]=k.fieldJson[l]);l=e.create("div",{"class":"field-div",
fieldDiv:k.fieldPath},h);this.own(q(l,"click",g.hitch(this,function(b,d){function e(){f=this.configTree.findNode(n);h=a.position(this.treePart).y;k=a.position(f.lineDomNode).y;l=k-h;(0>l||l>c.get(this.categoryPart,"height"))&&f.lineDomNode.scrollIntoView(!1);this._changeHeighlightFieldDomNode(n);this._changeHeighlightTreeDomNode(f.lineDomNode);this._changeHeighlightCategoryHead(d.name)}var f,h,k,l,n=b.fieldPath;if(f=this.configTree.findNode(n)){for(;f;)c.set(f.subLineDomNode,"display","block"),f=
f.parentNode;g.hitch(this,e)()}else this.addWidgetConfigToConfigTree(n).then(g.hitch(this,function(){for(f=this.configTree.findNode(n);f;)c.set(f.subLineDomNode,"display","block"),f=f.parentNode;g.hitch(this,e)()}))},k,b)));b=e.create("div",{"class":"field-head-div"},l);s=e.create("div",{"class":"field-fold-div"},b);p=e.create("img",{"class":"field-fold-img",src:this.arrowImgSrc,alt:"img"},s);s=g.hitch(this,function(a){var b="",c=a.split("_"),d=g.clone(c);f.forEach(c,function(a,b){var e,f="";if(-1!==
a.search(/widgets\[[0-9]+\]$/)||-1!==a.search(/groups\[[0-9]+\]$/)){for(e=0;e<=b;e++)f+=c[e]+"_";e=this.configTree.findNode(f.slice(0,-1));d[b]=e.label}},this);for(a=1;a<d.length;a++)b+=d[a]+"_";return b.slice(0,-1)})(k.fieldPath);e.create("div",{"class":"field-head-title-div",innerHTML:s,title:s},b);t=e.create("div",{"class":"field-opers-div"},b);s=e.create("div",{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"delete01.png' alt\x3d'img'\x3e\x3c/img\x3e"},
t);u=e.create("div",{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"movedown.png' alt\x3d'img'\x3e\x3c/img\x3e"},t);t=e.create("div",{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"moveup.png' alt\x3d'img'\x3e\x3c/img\x3e"},t);var z=e.create("div",{"class":"field-fixed-content-div",style:"display:none;"},l);m=e.create("div",{"class":"field-box-div"},z);e.create("span",
{"class":"field-label-span",innerHTML:this.nls.fieldLabel},m);m=e.create("input",{"class":"jimu-input field-label-input",type:"text",value:x.label},m);this.own(q(m,"change",g.hitch(this,function(a,b){this._onFieldChange(a,{key:"label",value:y.stripHTML(b.value)})},k.fieldPath,m)));m=e.create("div",{"class":"field-box-div"},z);e.create("span",{"class":"field-type-span",innerHTML:this.nls.fieldType},m);m=(new v({name:"selectFieldType","class":"field-type-select",options:[{label:this.nls.typeSelectString,
value:"string"},{label:this.nls.typeSelectBoolean,value:"boolean"},{label:this.nls.typeSelectNumber,value:"number"},{label:this.nls.typeSelectOptions,value:"options"},{label:this.nls.typeSelectColor,value:"color"}],value:x.type})).placeAt(m);w=e.create("div",{"class":"field-content-div",style:"display:none;"},l);this.drawFieldContent(k.fieldPath,x,w,m.getValue());this.own(q(m,"change",g.hitch(this,function(a,b,d,e){this.drawFieldContent(a,b,d,e);this._onFieldChange(a,{key:"type",value:e});c.set(d,
"display","block")},k.fieldPath,x,w)));this.own(q(b,"click",g.hitch(this,function(){"block"===c.get(w,"display")?(c.set(w,"display","none"),c.set(z,"display","none"),r.set(p,"src",this.arrowImgSrc)):(c.set(w,"display","block"),c.set(z,"display","block"),r.set(p,"src",this.imageFolder+"v.png"))})));this.own(q(s,"click",g.hitch(this,function(a,b,d,f){var h=a.fieldPath,k=this.configTree.findNode(h);k?(k.setTemplateField(a.fieldJson),k.toRightDiv&&c.set(k.toRightDiv,"display","block")):this.addWidgetConfigToConfigTree(h).then(g.hitch(this,
function(){var b=this.configTree.findNode(h);a.fieldJson&&b.setTemplateField(a.fieldJson)}));k=this.categoryManager.getCategoryByField(h);k.removeFieldFromDisplay(h);e.destroy(b);k.displayIsEmpty()&&(this.categoryManager.removeCategoryFromDisplay(k),e.destroy(d));f.stopPropagation();this._checkTemplateStatus()},k,l,d)));this.own(q(t,"click",g.hitch(this,function(a,b,c){var f=this.categoryManager.getCategoryByField(a);f.moveup(a)&&(e.empty(b),this.drawFields(f,d,b),this._changeHeighlightFieldDomNode(a));
c.stopPropagation();this._checkTemplateStatus()},k.fieldPath,h)));this.own(q(u,"click",g.hitch(this,function(a,b,c){var f=this.categoryManager.getCategoryByField(a);f.movedown(a)&&(e.empty(b),this.drawFields(f,d,b),this._changeHeighlightFieldDomNode(a));c.stopPropagation();this._checkTemplateStatus()},k.fieldPath,h)))},drawFieldContent:function(a,b,c,d){var h,k,l,n;e.empty(c);"color"!==d&&(e.create("span",{"class":"field-tooltip-span",innerHTML:this.nls.tooltip},c),h=e.create("input",{"class":"jimu-input field-tooltip-input",
type:"text",value:b.tooltip},c),this.own(q(h,"change",g.hitch(this,function(a,b){this._onFieldChange(a,{key:"tooltip",value:b.value})},a,h))),e.create("br",{},c),"string"===d?(e.create("span",{"class":"field-string-ph-span",innerHTML:this.nls.placeholder},c),d=e.create("input",{"class":"jimu-input field-string-ph-input",type:"text",value:b.placeHolder},c),this.own(q(d,"change",g.hitch(this,function(a,b){this._onFieldChange(a,{key:"placeHolder",value:b.value})},a,d))),d=e.create("div",{"class":"field-text-type-div"},
c),e.create("span",{"class":"field-text-type-span",innerHTML:this.nls.textBoxType},d),b=(new v({name:"stringOptions","class":"field-string-options",options:[{label:this.nls.textBoxTypeTextbox,value:"textbox"},{label:this.nls.textBoxTypeTextarea,value:"textarea"},{label:this.nls.textBoxTypeRichtext,value:"richtext"}],value:b.stringFieldOption})).placeAt(d),this.own(q(b,"change",g.hitch(this,function(a,b){this._onFieldChange(a,{key:"stringFieldOption",value:b})},a)))):"number"===d?(e.create("span",
{"class":"field-num-min-span",innerHTML:this.nls.minvalue},c),k=e.create("input",{"class":"jimu-input field-num-input field-num-min-input",type:"text",value:b.constraints.min},c),e.create("br",{},c),e.create("span",{"class":"field-num-max-span",innerHTML:this.nls.maxvalue},c),l=e.create("input",{"class":"jimu-input field-num-input field-num-max-input",type:"text",value:b.constraints.max},c),e.create("br",{},c),e.create("span",{"class":"field-num-places-span",innerHTML:this.nls.places},c),n=e.create("input",
{"class":"jimu-input field-num-input field-num-places-input",type:"text",value:b.constraints.places},c),this.own(q(k,"change",g.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:k.value,max:l.value,places:n.value}})},a))),this.own(q(l,"change",g.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:k.value,max:l.value,places:n.value}})},a))),this.own(q(n,"change",g.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:k.value,max:l.value,
places:n.value}})},a)))):"options"===d&&(d=e.create("div",{"class":"field-options-add-div"},c),h=e.create("div",{"class":"field-options-add-content"},d),e.create("div",{"class":"field-options-add-img-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"add_link.png' alt\x3d'img'\x3e\x3c/img\x3e"},h),e.create("div",{"class":"field-options-add-text-div jimu-float-leading",innerHTML:this.nls.addNewOption},h),f.forEach(b.options,function(b){this._onFieldOptionsAdd(a,c,b.label,b.value)},
this),this.own(q(d,"click",g.hitch(this,this._onFieldOptionsAdd,a,c,"","")))))},_changeHeighlightFieldDomNode:function(a){s(".field-div",this.categoryPart).removeClass("field-heighlight-div");d.add(s('div[fieldDiv\x3d"'+a+'"]',this.categoryPart)[0],"field-heighlight-div")},_changeHeighlightTreeDomNode:function(a){this.heighlightTreeDomNode&&d.remove(this.heighlightTreeDomNode,"tree-node-heighlight-div");d.add(a,"tree-node-heighlight-div");this.heighlightTreeDomNode=a},_changeHeighlightCategoryHead:function(b){s(".category-head-div",
this.categoryPart).removeClass("category-head-div-selected");b=s("div[categoryHeadDiv\x3d'"+b+"']",this.categoryPart)[0];a.addClass(b,"category-head-div-selected")},_onToRightDiv:function(b,d,e){var f,g,h=this.categoryManager.getCategoryByField(b.absolutePath);f=this.categoryManager.findDisplayCategory(h.name);g={fieldPath:b.absolutePath,fieldJson:b.getTemplateField()};if(-1===f){if("add"!==d)return;this.categoryManager.addCategoryToDisplay(h);h.addFieldToDisplay(g);this.drawCategory(h);f=s("div[fieldsDiv\x3d'"+
h.name+"']",this.categoryPart)[0]}else if(-1===h.findFieldFromDisplay(b.absolutePath)){if("add"!==d)return;h.addFieldToDisplay(g);d=s("div[categoryDiv\x3d'"+h.name+"']",this.categoryPart)[0];f=s("div[fieldsDiv\x3d'"+h.name+"']",this.categoryPart)[0];this.drawField(h,d,f,g)}else f=s("div[fieldsDiv\x3d'"+h.name+"']",this.categoryPart)[0];c.set(f,"display","block");g=s('div[fieldDiv\x3d"'+b.absolutePath+'"]',this.categoryPart)[0];this._changeHeighlightCategoryHead(h.name);this._changeHeighlightFieldDomNode(b.absolutePath);
this._changeHeighlightTreeDomNode(e);b=a.position(this.categoryPart).y;b=a.position(g).y-b;(0>b||b>c.get(this.categoryPart,"height"))&&g.scrollIntoView(!1)},_onFieldChange:function(a,b){var c=this.configTree.findNode(a),d=this.categoryManager.getCategoryByField(a).getDisplayField(a);d.fieldJson[b.key]=b.value;c.templateField=d.fieldJson;this._checkTemplateStatus()},_onFieldOptionsAdd:function(a,b,c,d){var f=e.create("div",{"class":"field-options-div"},b),h=e.create("div",{"class":"field-box-div"},
f);e.create("div",{"class":"field-options-label-div jimu-float-leading",innerHTML:this.nls.labelStr},h);h=e.create("input",{"class":"jimu-input field-options-label-input jimu-float-leading",type:"text",value:c},h);this.own(q(h,"change",g.hitch(this,function(a){this._onFieldChange(a,{key:"options",value:this._getFieldOptions(b)})},a)));h=e.create("div",{"class":"field-box-div"},f);e.create("div",{"class":"field-options-value-div jimu-float-leading",innerHTML:this.nls.value},h);d=e.create("input",{"class":"jimu-input field-options-value-input jimu-float-leading",
type:"text",value:d},h);this.own(q(d,"change",g.hitch(this,function(a){this._onFieldChange(a,{key:"options",value:this._getFieldOptions(b)})},a)));d=e.create("div",{"class":"jimu-icon jimu-icon-delete field-options-remove-div jimu-float-leading"},h);this.own(q(d,"click",g.hitch(this,function(a){e.destroy(f);this._onFieldChange(a,{key:"options",value:this._getFieldOptions(b)})},a)))},_getFieldOptions:function(a){var b=[];s(".field-options-div",a).forEach(g.hitch(this,function(a){b.push({label:s(".field-options-label-input",
a).attr("value")[0],value:s(".field-options-value-input",a).attr("value")[0]})}));return b},_onReviewJsonDivClick:function(){var a=this.categoryManager.getTemplateJson();this.showJsonWidget.setConfig(a);r.set(this.rightPartHeadText,"innerHTML",this.nls.rightPartHead2);c.set(this.showJsonDiv,"display","block");c.set(this.reviewJsonDiv,"display","none");c.set(this.reviewJsonBackDiv,"display","block")},_onReviewJsonBackDivClick:function(){r.set(this.rightPartHeadText,"innerHTML",this.nls.rightPartHead);
c.set(this.reviewJsonDiv,"display","block");c.set(this.reviewJsonBackDiv,"display","none");c.set(this.showJsonDiv,"display","none")},_saveAgolTemplate:function(a){var b=new t,c=u.stringify(this.categoryManager.getTemplateJson("fullJson")),d={itemId:a?a:this.appInfo.agolTemplateInfo?this.appInfo.agolTemplateInfo.itemId:null,json:c};z.saveAgolTemplate(this.appInfo,d).then(g.hitch(this,function(){this.appInfo.agolTemplateInfo=d;this.lastTemplateJson=this.categoryManager.getTemplateJson();b.resolve()}),
function(a){new B({message:a});b.reject()});return b},_onDownloadNodeClick:function(){},_updateAgolTemplate:function(){var a=new t,b=this.hasChanged(),c=u.stringify(this.categoryManager.getTemplateJson());this.loading.show(this.nls.updating);b?this._saveAgolTemplate().then(g.hitch(this,function(){this._checkTemplateStatus();a.resolve()})):a.resolve();a.then(g.hitch(this,function(){E.getPortal(window.portalUrl).getUser().then(g.hitch(this,function(a){a.updateItem(this.appInfo.agolTemplateInfo.itemId,
{text:c}).then(g.hitch(this,function(){this.loading.hide();I._exportedMessage({itemId:this.appInfo.agolTemplateInfo.itemId,message:this.nls.exportSuccessfulUpdate},this.nls.exportMessageTitleUpdate,this.nls)}),g.hitch(this,function(a){this.loading.hide();console.error(a.message||a);I._exportedMessage({itemId:null,message:this.nls.exportTemplateFailed7},this.nls.exportMessageTitleUpdate,this.nls)}))}),g.hitch(this,function(a){this.loading.hide();console.error(a.message||a);I._exportedMessage({itemId:null,
message:this.nls.exportTemplateFailed6},this.nls.exportMessageTitleUpdate,this.nls)}))}))},_exportTemplate:function(a){var b="",c=u.stringify(this.categoryManager.getTemplateJson()),d=u.stringify(this.categoryManager.getTemplateJson("fullJson"));window.isXT?b=F.getProtocol(window.portalUrl)+"://"+window.location.host+path+"apps/"+this.appInfo.id:(b=F.getStandardPortalUrl(window.portalUrl),b="HTML3D"===window.appInfo.appType?b+"/apps/webappviewer3d/index.html?id\x3d"+this.appInfo.id:b+"/apps/webappviewer/index.html?id\x3d"+
this.appInfo.id);(new x({_templateUrl:b,_temlateJson:c,_fullTemplateJson:d,nls:this.nls,_afterAddItemOfExportCallback:g.hitch(this,this._afterAddItemOfExportCallback),appInfo:this.appInfo,appConfig:this.cleanAppConfig,isExportWABTemplate:a})).startup()},_afterAddItemOfExportCallback:function(a){this._saveAgolTemplate(a).then(g.hitch(this,function(){this._checkTemplateStatus();this.emit("exported",!0)}))},_checkTemplateStatus:function(){var a=this.hasChanged();this.emit("hasChanged",a)},exportOrUpdateAGOLTemplate:function(){this.appInfo.agolTemplateInfo&&
this.appInfo.agolTemplateInfo.itemId?this._updateAgolTemplate():this._exportTemplate(!1)},exportWABTemplate:function(){this._exportTemplate(!0)},saveAgolTemplate:function(){return this._saveAgolTemplate()},hasChanged:function(){return!y.isEqual(this.lastTemplateJson,this.categoryManager.getTemplateJson())},getTemplateConfig:function(){return this.categoryManager.getTemplateJson()},getFullTemplateConfig:function(){return this.categoryManager.getTemplateJson("fullJson")}})})},"builder/dijit/template-config/ConfigNode":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/_base/array"],function(p,f,a){var l={},k=p([],{id:null,parentNode:null,keyString:null,absolutePath:null,childs:null,nodeType:null,templateField:null,jsonObject:null,level:null,label:null,isVisible:!1,constructor:function(a,k,l,g,e){var c;this.parentNode=k;this.keyString=l;this.childs=[];this.absolutePath=""===g?l:g+"_"+l;this.jsonObject=a;this.level=e;this.initId();this.initLabel();this.initTemplateField(a);if("object"!==typeof a||null===a)this.nodeType="leaf";else if(f.isArrayLike(a)){this.nodeType=
"array";for(k=0;k<a.length;k++)this.addChild(a[k],this.keyString+"["+k+"]",g,e)}else for(c in this.nodeType="normal",a)a.hasOwnProperty(c)&&"function"!==typeof a[c]&&this.addChild(a[c],c,this.absolutePath,e)},initId:function(){var a,k;a=this.absolutePath.search(/_widgets\[[0-9]+\]/);k=this.absolutePath.search(/_groups\[[0-9]+\]/);-1!==a||-1!==k?-1!==this.absolutePath.search(/_widgets\[[0-9]+\]$/)||-1!==this.absolutePath.search(/_groups\[[0-9]+\]$/)?this.id=this.parentNode.id+"["+this.jsonObject.id+
"]":f.isArrayLike(this.parentNode.jsonObject)?this.id=this.parentNode.parentNode.id+"_"+this.keyString:this.id=this.parentNode.id+"_"+this.keyString:this.id=this.absolutePath},initLabel:function(){this.label=this.keyString;if(-1!==this.absolutePath.search(/widgets\[[0-9]+\]$/)||-1!==this.absolutePath.search(/groups\[[0-9]+\]$/))this.label=this.jsonObject.label},initTemplateField:function(a){this.templateField=k.getDefaultTemplateField(this.absolutePath,typeof a,this.label);k.setDefaultValue(this.absolutePath,
a,this.id)},getTemplateFieldDefaultValue:function(){return this.templateField.defaultValue},getTemplateField:function(a){a=a?a:this.templateField;var f={type:a.type,fieldName:this.id,label:a.label,tooltip:a.tooltip};"leaf"!==this.nodeType&&(f.fieldName+="--");switch(f.type){case "string":f.stringFieldOption=a.stringFieldOption;f.placeHolder=a.placeHolder;break;case "number":f.constraints=a.constraints||{min:0,max:100,places:0};break;case "options":f.options=a.options||[{label:"label1",value:"value1"}]}return f},
setTemplateField:function(a){this.templateField.type=a.type;this.templateField.label=a.label;this.templateField.tooltip=a.tooltip;"leaf"!==this.nodeType&&(this.templateField.fieldName=this.templateField.fieldName.slice(0,this.templateField.fieldName.length-2));switch(this.templateField.type){case "string":this.templateField.stringFieldOption=a.stringFieldOption;this.templateField.placeHolder=a.placeHolder;break;case "number":this.templateField.constraints=a.constraints;break;case "options":this.templateField.options=
a.options}return a},addChild:function(a,f,l,g){a=new k(a,this,f,l,g+1);this.childs.push(a);return a},isLeaf:function(){var a=!1;this.childs&&0<this.childs.length&&(a=!0);return a},findNode:function(a){var f=[],k,g,e;a.split("_").forEach(function(a){var d=a.search(/\[[0-9]+\]/);-1!==d&&f.push(a.slice(0,d));f.push(a)});g=this;if(g.keyString!==f[0])return null;for(a=1;a<f.length;a++){e=g.childs.length;for(k=0;k<e;k++)if(g.childs[k].keyString===f[a]){g=g.childs[k];break}if(k===e)return null}return g},
setVisible:function(){for(var a=this;a;)a.isVisible=!0,a=a.parentNode},findNodeById:function(a){var f=null;this.traversal(function(k){if(k.id===a)return f=k,!0});return f},traversal:function(a){if(a(this))return!0;for(var f=0;f<this.childs.length;f++)if(this.childs[f].traversal(a))return!0},deserialize:function(f){f&&a.forEach(f.configurationSettings,function(f){a.forEach(f.fields,function(a){this.findNode(a.fieldName).setTemplateField(a)},this)},this)}});k.getDefaultValue=function(a){return l[a]};
k.setDefaultValue=function(a,f,k){var g=null,g=f;"app_portalUrl"===a||"app_map_itemId"===a?g=null:"app_title"===a?g="":"app_subtitle"===a?g="":"object"===typeof f&&(g=!1);l[k]=g};k.defaultValueExisted=function(a){return void 0===l[a]?!1:!0};k.getDefaultTemplateField=function(a,f,k){a="string";switch(f){case "number":a="number";break;case "boolean":a="boolean";break;case "object":a="boolean",k="disable"}return{type:a,label:k,tooltip:"",stringFieldOption:"textbox",placeHolder:k,constraints:{min:0,max:100,
places:0},options:[{label:"label1",value:"value1"}]}};return k})},"builder/dijit/template-config/CategoryManager":function(){define(["dojo/_base/declare","dojo/_base/array","./ConfigNode","./Category"],function(p,f,a,l){return p([],{categorys:null,displayCategorys:null,constructor:function(a,f,l){this.configTree=a;this.categorys=[];this.displayCategorys=[];this.initCategorys(f,a);this.deserialize(l,a)},initCategorys:function(a,h){var q=new l(h,"Attribute","Attribute",["app_title","app_subtitle","app_logo",
"app_links"],[],["app_title","app_subtitle"]);this.categorys.push(q);f.forEach(a.widgetOnScreen.widgets,function(a,f){var e="ScreenWidget_"+a.id,c="app_widgetOnScreen_widgets["+f+"]",c=[c+"_label",c+"_visible",c+"_config"],d=[];a.uri&&this.categorys.push(new l(h,e,a.label+" widget",c,d))},this);f.forEach(a.widgetOnScreen.groups,function(a,g){var e="ScreenWidgetGroup_"+a.id,c="app_widgetOnScreen_groups["+g+"]",d=[c+"_label",c+"_visible"];f.forEach(a.widgets,function(a,e){d.push(c+"_widgets["+e+"]_label");
d.push(c+"_widgets["+e+"]_visible");d.push(c+"_widgets["+e+"]_config")});this.categorys.push(new l(h,e,a.label,d,[]))},this);f.forEach(a.widgetPool.widgets,function(a,f){var e="widgetPoolWidget_"+a.id,c="app_widgetPool_widgets["+f+"]",c=[c+"_label",c+"_visible",c+"_config"],d=[];a.uri&&this.categorys.push(new l(h,e,a.label+" widget",c,d))},this);f.forEach(a.widgetPool.groups,function(a,g){var e="widgetPoolGroup_"+a.id,c="app_widgetPool_groups["+g+"]",d=[c+"_label",c+"_visible"];f.forEach(a.widgets,
function(a,e){d.push(c+"_widgets["+e+"]_label");d.push(c+"_widgets["+e+"]_visible");d.push(c+"_widgets["+e+"]_config")});this.categorys.push(new l(h,e,a.label,d,[]))},this);this.displayCategorys.push(q)},getCategoryByName:function(a){return this.categorys[this.findCategory(a)]},getCategoryByField:function(a){var f;for(f=0;f<this.categorys.length;f++)if(this.categorys[f].hasField(a))return this.categorys[f];return null},findCategory:function(a){return this._find(a,this.categorys)},findDisplayCategory:function(a){return this._find(a,
this.displayCategorys)},_find:function(a,f){var l;for(l=0;l<f.length&&f[l].name!==a;l++);return l===f.length?-1:l},addCategoryToDisplay:function(a){-1===this.findDisplayCategory(a.name)&&this.displayCategorys.push(a)},removeCategoryFromDisplay:function(a){a=this.findDisplayCategory(a.name);0<=a&&this.displayCategorys.splice(a,1)},moveup:function(a){var f;a=this.findDisplayCategory(a.name);return 0<a?(f=this.displayCategorys[a],this.displayCategorys[a]=this.displayCategorys[a-1],this.displayCategorys[a-
1]=f,!0):!1},movedown:function(a){var f;a=this.findDisplayCategory(a.name);return 0<=a&&a<this.displayCategorys.length-1?(f=this.displayCategorys[a],this.displayCategorys[a]=this.displayCategorys[a+1],this.displayCategorys[a+1]=f,!0):!1},getTemplateJson:function(k){var h={configurationSettings:[],values:{}};f.forEach(this.displayCategorys,function(l,m){var g={category:l.title,fields:[]};"fullJson"===k&&(g.categoryName=l.name);f.forEach(l.displayFields,function(e,c){var d=this.configTree.findNode(e.fieldPath).getTemplateField(e.fieldJson);
g.fields[c]=d;h.values[d.fieldName]=a.getDefaultValue(e.fieldJson.fieldName)},this);h.configurationSettings[m]=g},this);return h},deserialize:function(k,h){if(k){f.forEach(this.displayCategorys,function(a){a.displayFields=[]});this.displayCategorys=[];f.forEach(k.configurationSettings,function(a){var e=this.getCategoryByName(a.categoryName),c=0;e&&(c=e.deserialize(a.fields,h),0<c&&this.displayCategorys.push(e))},this);var l,m=k.values;for(l in m)m.hasOwnProperty(l)&&("function"!==typeof m[l]&&!a.defaultValueExisted(l))&&
a.setDefaultValue(null,m[l],l)}}})})},"builder/dijit/template-config/Category":function(){define(["dojo/_base/declare","dojo/_base/array"],function(p,f){return p([],{name:null,title:null,includeFields:null,excludeFields:null,displayFields:null,constructor:function(a,l,k,h,q,m){this.name=l;this.title=k;this.includeFields=h;this.excludeFields=q;this.displayFields=[];f.forEach(m,function(f){var e=a.findNode(f);e&&this.displayFields.push({fieldPath:f,fieldJson:e.getTemplateField()})},this)},hasField:function(a){var f=
!1,k;for(k=0;k<this.includeFields.length;k++)if(0===a.indexOf(this.includeFields[k])){f=!0;break}for(k=0;k<this.excludeFields.length;k++)if(0===a.indexOf(this.excludeFields[k])){f=!1;break}return f},getDisplayField:function(a){a=this.findFieldFromDisplay(a);return-1!==a?this.displayFields[a]:null},findFieldFromDisplay:function(a){var f;for(f=0;f<this.displayFields.length;f++)if(this.displayFields[f].fieldPath===a)return f;return-1},addFieldToDisplay:function(a){var f;f=this.findFieldFromDisplay(a.fieldPath);
-1===f?this.displayFields.push({fieldPath:a.fieldPath,fieldJson:a.fieldJson}):this.displayFields[f].fieldJson=a.fieldJson},removeFieldFromDisplay:function(a){var f;f=this.findFieldFromDisplay(a);0<=f&&this.displayFields.splice(f,1);return a},moveup:function(a){var f;a=this.findFieldFromDisplay(a);return 0<a?(f=this.displayFields[a],this.displayFields[a]=this.displayFields[a-1],this.displayFields[a-1]=f,!0):!1},movedown:function(a){var f;a=this.findFieldFromDisplay(a);return 0<=a&&a<this.displayFields.length-
1?(f=this.displayFields[a],this.displayFields[a]=this.displayFields[a+1],this.displayFields[a+1]=f,!0):!1},displayIsEmpty:function(){return 0===this.displayFields.length},deserialize:function(a,l){this.displayFields=[];f.forEach(a,function(a){var f;f=a.fieldName.replace(/\//g,"_");(f=l.findNodeById(f))&&this.displayFields.push({fieldPath:f.absolutePath,fieldJson:a})},this);return this.displayFields.length}})})},"builder/dijit/template-config/Export":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/dijit dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Export.html dojo/Deferred dojo/promise/all dojo/dom-style dojo/dom-attr dojo/json jimu/dijit/Message jimu/dijit/LoadingShelter builder/portalUtils ./ExportMessage jimu/dijit/Popup builder/dijit/ItemInfo builder/serviceUtils builder/PluginManager".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w){return p([k,h],{templateString:q,baseClass:"export-agoltemplate",_templateUrl:null,_temlateJson:null,_fullTemplateJson:null,pluginManager:null,_afterAddItemOfExportCallback:null,isExportWABTemplate:null,appInfo:null,constructor:function(){this.pluginManager=w.getInstance()},startup:function(){this.isExportWABTemplate?this.popupWABTemplateDlg():this.popupAGOLTemplateDlg()},popupAGOLTemplateDlg:function(a){this.isExportWABTemplate=!1;this._initToAGOLTemplateDlgPage();
this.popup=new b({content:this,container:"main-page",titleLabel:this.nls.title2,width:669,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:f.hitch(this,this._onNextClick)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:f.hitch(this,this._onCancelClick)}]});this.loading=new u({hidden:!0});this.loading.placeAt(this.popup.domNode)},popupWABTemplateDlg:function(){this.isExportWABTemplate=!0;this._initToWABTemplateDlgPage();this.popup=new b({content:this,container:"main-page",titleLabel:this.nls.exportPopupTitleForWab,
width:669,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:f.hitch(this,this._onNextClick)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:f.hitch(this,this._onCancelClick)}]});this.loading=new u({hidden:!0});this.loading.placeAt(this.popup.domNode)},_initToAGOLTemplateDlgPage:function(){window.isXT&&(c.set(this.explain1,"innerHTML",this.nls.explain1),e.set(this.explain1,"display","block"));this.itemInfoDijit=new v({itemInfo:this.getDefaultAppInfo()});this.itemInfoDijit.placeAt(this.itemInfoBox)},
_initToWABTemplateDlgPage:function(){var a=this.getDefaultAppInfo();window.isXT&&(c.set(this.templateTitle,"innerHTML",this.nls.templateTitleForWAB),a.tags=void 0,a.folderId=void 0,a.sharing=void 0,a.thumbnail="/webappbuilder/builder/images/templatethumbnail.jpg");this.itemInfoDijit=new v({itemInfo:a});this.itemInfoDijit.placeAt(this.itemInfoBox)},getDefaultAppInfo:function(){return{name:"",description:this.nls.templateDefaultSnippet,tags:["template"],folderId:"",sharing:void 0,thumbnail:void 0}},
_onNextClick:function(){this.isExportWABTemplate?this._exportWABTemplate():this._exportAGOLTemplate()},_onCancelClick:function(){this.close()},close:function(){this.popup.close()},_exportAGOLTemplate:function(){var a=this.itemInfoDijit.getProperties();a.name&&a.tags?(this.loading.show(),this.exportAGOLTemplate(a,this._templateUrl,this._fullTemplateJson,this._afterAddItemOfExportCallback).then(f.hitch(this,function(a){this.close();this.loading.hide();t._exportedMessage(a,this.nls.exportMessageTitle,
this.nls)}),f.hitch(this,function(a){this.close();this.loading.hide();t._exportedMessage(a,this.nls.exportMessageTitle,this.nls)}))):new r({message:this.nls.noTitleMessage})},_exportWABTemplate:function(){var a=this.itemInfoDijit.getProperties();if(a.name){this.loading.show();var c=this.pluginManager.getPluginByName("app-list");this.exportWABTemplate(a,d.parse(this._fullTemplateJson),this._afterAddItemOfExportCallback).then(f.hitch(this,function(){this.close();this.loading.hide();c&&(c._onSwitchToTemplateContent(),
c.refreshTemplatePage());new b({content:this.nls.exportSuccessfulForWab,titleLabel:this.nls.exportPopupTitleForWab,width:"600",autoHeight:!0,buttons:[{label:this.nls.ok}]})}),f.hitch(this,function(){this.close();this.loading.hide()}))}else new r({message:this.nls.noTitleMessage})},exportAGOLTemplate:function(a,b,c,d){var e=new m,h=new m,k=new m,l=new m,n="http://"+window.location.host+window.location.pathname,r=n.indexOf("index.html");-1!==r&&(n=n.slice(0,r));var n=n+"builder/css/images/agoltemplate/templateThumbnail.jpg",
q=s.getPortal(window.portalUrl);q.getUser().then(f.hitch(this,function(b){var c={q:"owner:"+b.username+" title:"+a.name+' type:"Web Mapping Application"'},d=builderNls.titleExist.replace("${TITLE}",a.name);q.queryItems(c).then(f.hitch(this,function(a){0<a.total?(h.reject(),e.reject({itemId:null,message:d})):h.resolve(b)}),f.hitch(this,function(a){h.reject(a);console.error(a.message||a);e.reject({itemId:null,message:this.nls.exportTemplateFailed5})}))}),f.hitch(this,function(a){h.reject(a);console.error(a.message||
a);e.reject({itemId:null,message:this.nls.exportTemplateFailed5})}));h.then(f.hitch(this,function(f){var g={title:a.name,snippet:a.description,tags:a.tags,url:b,thumbnailurl:n,type:"Web Mapping Application",typeKeywords:"Configurable, JavaScript, selfConfigured",text:c},h,l="";"HTML"===window.appInfo.appType?l="WAB2D":"HTML3D"===window.appInfo.appType&&(l="WAB3D");h=window.isXT?"Configurable, JavaScript, WABTemplate, WABTemplateFromXT, ":"Configurable, JavaScript, selfConfigured, WABTemplate, WABTemplateFromAGOL, ";
g.typeKeywords=h+l;a.folderId===f.username&&(a.folderId="");f.addItem(g,a.folderId).then(function(a){a.success?(k.resolve(a),d(a.id)):(console.error(a.message||""),k.reject(this.nls.exportTemplateFailed1))},function(a){k.reject(a);console.error(a.message||a);e.reject({itemId:null,message:this.nls.exportTemplateFailed1})})}));s.getTemplatesGroup(window.portalUrl).then(f.hitch(this,function(a){l.resolve(a)}),function(a){l.reject(a);console.error(a.message||a);e.reject({itemId:null,message:this.nls.exportTemplateFailed2})});
g({user:h,itemRes:k,templateGroup:l}).then(f.hitch(this,function(b){b.user.shareItem({groups:b.templateGroup.id},b.itemRes.id,a.folderId).then(f.hitch(this,function(a){-1===a.notSharedWith.indexOf(b.templateGroup.id)?e.resolve({itemId:b.itemRes.id,message:this.nls.exportSuccessful}):e.reject({itemId:b.itemRes.id,message:this.nls.exportTemplateFailed3,type:"no_permission_to_share"})}),function(a){console.error(a.message||a);e.reject({itemId:b.itemRes.id,message:this.nls.exportTemplateFailed4})})}));
return e},exportWABTemplate:function(a,b,c){var d=new m;a={name:a.name,description:a.description,fromAppId:this.appInfo.id,saveAsTemplate:!0,thumbnail:a.thumbnail};var e=f.clone(window.appConfig);e.templateConfig=b;delete e.isTemplateApp;n.saveAs(a,e.getCleanConfig()).then(f.hitch(this,function(a){a.success?(d.resolve(),c()):(console.error("exportWABTemplate failed: duplicateApp response's success is false"),new r({message:"Exported as web app template failed."}),d.reject())}),f.hitch(this,function(a){console.error("exportWABTemplate failed: duplicateApp error: "+
a);new r({message:"Exported as web app template failed"});d.reject()}));return d}})})},"dijit/dijit":function(){define("./main ./_base dojo/parser ./_Widget ./_TemplatedMixin ./_Container ./layout/_LayoutWidget ./form/_FormWidget ./form/_FormValueWidget".split(" "),function(p){return p})},"dijit/_base":function(){define("./main ./a11y ./WidgetSet ./_base/focus ./_base/manager ./_base/place ./_base/popup ./_base/scroll ./_base/sniff ./_base/typematic ./_base/wai ./_base/window".split(" "),function(p){return p._base})},
"dijit/WidgetSet":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","./registry"],function(p,f,a,l){var k=f("dijit.WidgetSet",null,{constructor:function(){this._hash={};this.length=0},add:function(a){if(this._hash[a.id])throw Error("Tried to register widget with id\x3d\x3d"+a.id+" but that id is already registered");this._hash[a.id]=a;this.length++},remove:function(a){this._hash[a]&&(delete this._hash[a],this.length--)},forEach:function(f,k){k=k||a.global;var l=0,g;for(g in this._hash)f.call(k,
this._hash[g],l++,this._hash);return this},filter:function(f,l){l=l||a.global;var m=new k,g=0,e;for(e in this._hash){var c=this._hash[e];f.call(l,c,g++,this._hash)&&m.add(c)}return m},byId:function(a){return this._hash[a]},byClass:function(a){var f=new k,l,g;for(l in this._hash)g=this._hash[l],g.declaredClass==a&&f.add(g);return f},toArray:function(){var a=[],f;for(f in this._hash)a.push(this._hash[f]);return a},map:function(a,f){return p.map(this.toArray(),a,f)},every:function(f,k){k=k||a.global;
var l=0,g;for(g in this._hash)if(!f.call(k,this._hash[g],l++,this._hash))return!1;return!0},some:function(f,k){k=k||a.global;var l=0,g;for(g in this._hash)if(f.call(k,this._hash[g],l++,this._hash))return!0;return!1}});p.forEach("forEach filter byClass map every some".split(" "),function(a){l[a]=k.prototype[a]});return k})},"dijit/_base/focus":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/topic dojo/_base/window ../focus ../selection ../main".split(" "),function(p,f,a,l,k,h,q,m){h.focus=
function(a){if(a){var e="node"in a?a.node:a,c=a.bookmark;a=a.openedForWindow;var d=c?c.isCollapsed:!1;if(e){var f="iframe"==e.tagName.toLowerCase()?e.contentWindow:e;if(f&&f.focus)try{f.focus()}catch(l){}h._onFocusNode(e)}if(c&&k.withGlobal(a||k.global,m.isCollapsed)&&!d){a&&a.focus();try{k.withGlobal(a||k.global,m.moveToBookmark,null,[c])}catch(q){}}}};h.watch("curNode",function(a,e,c){m._curFocus=c;m._prevFocus=e;c&&l.publish("focusNode",c)});h.watch("activeStack",function(a,e,c){m._activeStack=
c});h.on("widget-blur",function(a,e){l.publish("widgetBlur",a,e)});h.on("widget-focus",function(a,e){l.publish("widgetFocus",a,e)});a.mixin(m,{_curFocus:null,_prevFocus:null,isCollapsed:function(){return m.getBookmark().isCollapsed},getBookmark:function(){return(k.global==window?q:new q.SelectionManager(k.global)).getBookmark()},moveToBookmark:function(a){return(k.global==window?q:new q.SelectionManager(k.global)).moveToBookmark(a)},getFocus:function(a,e){var c=!h.curNode||a&&f.isDescendant(h.curNode,
a.domNode)?m._prevFocus:h.curNode;return{node:c,bookmark:c&&c==h.curNode&&k.withGlobal(e||k.global,m.getBookmark),openedForWindow:e}},_activeStack:[],registerIframe:function(a){return h.registerIframe(a)},unregisterIframe:function(a){a&&a.remove()},registerWin:function(a,e){return h.registerWin(a,e)},unregisterWin:function(a){a&&a.remove()}});return m})},"dijit/_base/place":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/window","../place","../main"],function(p,f,a,l,k){var h={getViewport:function(){return a.getBox()}};
h.placeOnScreen=l.at;h.placeOnScreenAroundElement=function(a,h,g,e){var c;if(f.isArray(g))c=g;else{c=[];for(var d in g)c.push({aroundCorner:d,corner:g[d]})}return l.around(a,h,c,!0,e)};h.placeOnScreenAroundNode=h.placeOnScreenAroundElement;h.placeOnScreenAroundRectangle=h.placeOnScreenAroundElement;h.getPopupAroundAlignment=function(a,f){var g={};p.forEach(a,function(a){var c=f;switch(a){case "after":g[f?"BR":"BL"]=f?"BL":"BR";break;case "before":g[f?"BL":"BR"]=f?"BR":"BL";break;case "below-alt":c=
!c;case "below":g[c?"BL":"BR"]=c?"TL":"TR";g[c?"BR":"BL"]=c?"TR":"TL";break;case "above-alt":c=!c;default:g[c?"TL":"TR"]=c?"BL":"BR",g[c?"TR":"TL"]=c?"BR":"BL"}});return g};f.mixin(k,h);return k})},"dijit/_base/popup":function(){define(["dojo/dom-class","dojo/_base/window","../popup","../BackgroundIframe"],function(p,f,a){var l=a._createWrapper;a._createWrapper=function(a){a.declaredClass||(a={_popupWrapper:a.parentNode&&p.contains(a.parentNode,"dijitPopup")?a.parentNode:null,domNode:a,destroy:function(){},
ownerDocument:a.ownerDocument,ownerDocumentBody:f.body(a.ownerDocument)});return l.call(this,a)};var k=a.open;a.open=function(a){if(a.orient&&"string"!=typeof a.orient&&!("length"in a.orient)){var f=[],l;for(l in a.orient)f.push({aroundCorner:l,corner:a.orient[l]});a.orient=f}return k.call(this,a)};return a})},"dijit/_base/scroll":function(){define(["dojo/window","../main"],function(p,f){f.scrollIntoView=function(a,f){p.scrollIntoView(a,f)}})},"dijit/_base/sniff":function(){define(["dojo/uacss"],
function(){})},"dijit/_base/typematic":function(){define(["../typematic"],function(){})},"dijit/_base/wai":function(){define(["dojo/dom-attr","dojo/_base/lang","../main","../hccss"],function(p,f,a){f.mixin(a,{hasWaiRole:function(a,f){var h=this.getWaiRole(a);return f?-1<h.indexOf(f):0<h.length},getWaiRole:function(a){return f.trim((p.get(a,"role")||"").replace("wairole:",""))},setWaiRole:function(a,f){p.set(a,"role",f)},removeWaiRole:function(a,k){var h=p.get(a,"role");h&&(k?(h=f.trim((" "+h+" ").replace(" "+
k+" "," ")),p.set(a,"role",h)):a.removeAttribute("role"))},hasWaiState:function(a,f){return a.hasAttribute?a.hasAttribute("aria-"+f):!!a.getAttribute("aria-"+f)},getWaiState:function(a,f){return a.getAttribute("aria-"+f)||""},setWaiState:function(a,f,h){a.setAttribute("aria-"+f,h)},removeWaiState:function(a,f){a.removeAttribute("aria-"+f)}});return a})},"dijit/_base/window":function(){define(["dojo/window","../main"],function(p,f){f.getDocumentWindow=function(a){return p.get(a)}})},"builder/dijit/template-config/ExportMessage":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/ExportMessage.html jimu/portalUrlUtils jimu/dijit/Popup".split(" "),
function(p,f,a,l,k,h,q){var m=p([a,l],{baseClass:"agol-template-export-message",templateString:k,constructor:function(){},postCreate:function(){this.inherited(arguments);"no_permission_to_share"===this.exportedInfo.type?(f.setAttr(this.word1,"innerHTML",this.nls.exportTemplateFailed31),this.exportedInfo.itemUrl&&(f.setAttr(this.itemLink,"innerHTML",this.nls.descriptionTemplateUrl21),f.setAttr(this.itemLink,"href",this.exportedInfo.itemUrl)),f.setAttr(this.word2,"innerHTML",this.nls.exportTemplateFailed32)):
(this.exportedInfo.message&&f.setAttr(this.resMessage,"innerHTML",this.exportedInfo.message),this.exportedInfo.itemUrl&&(f.setAttr(this.word1,"innerHTML",this.nls.descriptionTemplateUrl1),f.setAttr(this.itemLink,"innerHTML",this.nls.descriptionTemplateUrl2),f.setAttr(this.itemLink,"href",this.exportedInfo.itemUrl),f.setAttr(this.word2,"innerHTML",this.nls.descriptionTemplateUrl3)))}});m._exportedMessage=function(a,e,c){a.itemId&&(a.itemUrl=h.getItemDetailsPageUrl(window.portalUrl,a.itemId));a=new m({exportedInfo:a,
nls:c});new q({content:a,titleLabel:e,width:"600",autoHeight:!0,buttons:[{label:c.ok}]})};return m})},"builder/dijit/ItemInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/dijit dojo/text!./templates/ItemInfo.html dojo/dom-style dojo/_base/lang dojo/promise/all builder/portalUtils jimu/portalUrlUtils jimu/utils ./Tags dijit/form/SimpleTextarea jimu/dijit/ImageChooser dijit/form/TextBox dijit/form/Select dijit/form/CheckBox".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v){return p([k,h,q],{templateString:g,baseClass:"dijit-item-info",postMixInProperties:function(){this.inherited(arguments);this.nls=c.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this.tags.nls=this.nls;this._init(this.itemInfo)},_init:function(b){this.appName.focus();void 0===b.tags&&e.set(this.tagsTr,"display","none");void 0===b.folderId&&e.set(this.folderTr,"display","none");void 0===b.sharing&&e.set(this.sharingTr,"display",
"none");void 0===b.thumbnail&&e.set(this.thumbnailTr,"display","none");void 0!==b.tags||void 0!==b.folder?r.getPortal(u.getStandardPortalUrl(window.portalUrl)).getUser().then(c.hitch(this,function(a){var e=[];this.user=a;if(void 0!==b.folderId)e.push(this._initFolder(a));else{var f=new l;f.resolve();e.push(f)}void 0!==b.tags?e.push(m.byId("publish-webmap-tags").loadTags(a)):(a=new l,a.resolve(),e.push(a));d(e).then(c.hitch(this,function(){this.setProperties(b)}),c.hitch(this,function(a){this.setProperties(b);
console.error(a.message||a)}))}),c.hitch(this,function(a){this.setProperties(b);console.error(a.message||a)})):(void 0!==b.thumbnail&&(this.imageChooser=new v({cropImage:!0,showSelfImg:!0,format:[v.GIF,v.JPEG,v.PNG],goldenWidth:300,goldenHeight:200}),a.place(this.imageChooser.domNode,this.imageChooserBase)),this.setProperties(b))},_initFolder:function(a){var b=new l;a.getContent().then(c.hitch(this,function(d){var e=[{label:a.username,value:""}],e=e.concat(f.map(d.folders,c.hitch(this,function(a){return{label:a.title,
value:a.id}})));m.byId("publish-webmap-folder").set("options",e);m.byId("publish-webmap-folder").set("value","");b.resolve()}),function(a){console.error("get userContent error!",a.message);b.reject()});return b},setProperties:function(a){m.byId("publish-webmap-name").set("value",a.name);m.byId("publish-webmap-tags").set("tags",a.tags||[]);m.byId("publish-webmap-summary").set("value",a.description);m.byId("publish-webmap-folder").set("value",a.folderId);m.byId("publish-webmap-sharing").set("checked",
a.sharing);this.imageChooser&&this.imageChooser.setDefaultSelfSrc(a.thumbnail)},getProperties:function(){return{name:s.stripHTML(m.byId("publish-webmap-name").get("value")),tags:m.byId("publish-webmap-tags").get("tags"),description:s.stripHTML(m.byId("publish-webmap-summary").get("value")),folderId:m.byId("publish-webmap-folder").get("value"),sharing:m.byId("publish-webmap-sharing").get("checked"),thumbnail:this.imageChooser&&this.imageChooser.imageData}}})})},"builder/dijit/Tags":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/declare dojo/dom-construct dojo/store/Memory dojo/Deferred dojo/sniff dijit/_TemplatedMixin dijit/_WidgetBase dijit/form/TextBox ./AutoComplete dojo/text!./templates/Tags.html dojo/domReady!".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d){return a([g,m],{templateString:d,baseClass:"esriAGOTags",_minWidth:"100%",_maxWidth:"100%",postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._isIE8=q("ie")},startup:function(){this.inherited(arguments)},loadTags:function(a){var c=new h;this._isIE8?(this._textTags||(this.tagsId="userTags-"+(new Date).getTime(),l.create("div",{id:this.tagsId},this.domNode),this._textTags=new e({placeHolder:this.nls.addTags,
trim:!0,style:{minWidth:this._minWidth,maxWidth:this._maxWidth}},this.tagsId)),c.resolve()):a?a.getTags().then(f.hitch(this,function(a){this._handleTags(a);c.resolve()}),f.hitch(this,function(a){console.error("get user tags error: "+a);this._handleTags({tags:[]});c.resolve()})):(this._handleTags({tags:[]}),c.resolve());return c},_handleTags:function(a){if(a){this._autoComplete&&this._autoComplete.clearTags();var d=[];a.tags&&p.forEach(a.tags,f.hitch(this,function(a){d.push(a)}));this._tagStore?(this._tagStore.query({}).forEach(f.hitch(this,
function(a){this._tagStore.remove(a.tag)})),p.forEach(d,f.hitch(this,function(a){this._tagStore.add(a)}))):this._tagStore=new k({idProperty:"tag",data:d});this._autoComplete||(a=(new Date).getTime(),this.tagsId="userTags-"+a,this.gridId="grid-"+a,this.filterId="filter-"+a,l.create("div",{id:this.tagsId,className:"grid_1"},this.domNode),this._autoComplete=new c({placeholder:this.nls.addTags,noDataMsg:this.nls.noTagsFound,idProperty:"tag",gridId:this.gridId,filterId:this.filterId,minWidth:this._minWidth,
maxWidth:this._maxWidth,matchParam:"first",store:this._tagStore,style:{width:this._minWidth}},this.tagsId))}},_getUniqueTags:function(a){return p.filter(a,f.hitch(this,function(c,d){return p.indexOf(a,c)===d}))},_setValueAttr:function(a){this._setTagsAttr(a)},_getValueAttr:function(){return this._getTagsAttr()},_setTagsAttr:function(a){a&&!(a instanceof Array)&&(a=a.split(","));this._isIE8?this._textTags&&this._textTags.set("value",this._getUniqueTags(a).join(",")):this._autoComplete&&(this._autoComplete.clearTags(),
this._autoComplete.prepopulate(a?this._getUniqueTags(a):[]))},_getTagsAttr:function(){return this._isIE8?this._textTags?this._textTags.get("value"):"":this._autoComplete&&this._autoComplete.values?this._autoComplete.values.join(","):""},_setMinWidthAttr:function(a){this._minWidth=a},_setMaxWidthAttr:function(a){this._maxWidth=a}})})},"dojo/store/Memory":function(){define(["../_base/declare","./util/QueryResults","./util/SimpleQueryEngine"],function(p,f,a){return p("dojo.store.Memory",null,{constructor:function(a){for(var f in a)this[f]=
a[f];this.setData(this.data||[])},data:null,idProperty:"id",index:null,queryEngine:a,get:function(a){return this.data[this.index[a]]},getIdentity:function(a){return a[this.idProperty]},put:function(a,f){var h=this.data,q=this.index,m=this.idProperty,m=a[m]=f&&"id"in f?f.id:m in a?a[m]:Math.random();if(m in q){if(f&&!1===f.overwrite)throw Error("Object already exists");h[q[m]]=a}else q[m]=h.push(a)-1;return m},add:function(a,f){(f=f||{}).overwrite=!1;return this.put(a,f)},remove:function(a){var f=
this.index,h=this.data;if(a in f)return h.splice(f[a],1),this.setData(h),!0},query:function(a,k){return f(this.queryEngine(a,k)(this.data))},setData:function(a){a.items?(this.idProperty=a.identifier||this.idProperty,a=this.data=a.items):this.data=a;this.index={};for(var f=0,h=a.length;f<h;f++)this.index[a[f][this.idProperty]]=f}})})},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],function(p){return function(f,a){function l(h){h=p.filter(h,f);var k=a&&a.sort;k&&h.sort("function"==
typeof k?k:function(a,e){for(var c,d=0;c=k[d];d++){var f=a[c.attribute],h=e[c.attribute],f=null!=f?f.valueOf():f,h=null!=h?h.valueOf():h;if(f!=h)return!!c.descending==(null==f||f>h)?-1:1}return 0});if(a&&(a.start||a.count)){var l=h.length;h=h.slice(a.start||0,(a.start||0)+(a.count||Infinity));h.total=l}return h}switch(typeof f){default:throw Error("Can not query with a "+typeof f);case "object":case "undefined":var k=f;f=function(a){for(var f in k){var l=k[f];if(l&&l.test){if(!l.test(a[f],a))return!1}else if(l!=
a[f])return!1}return!0};break;case "string":if(!this[f])throw Error("No filter function "+f+" was found in store");f=this[f];case "function":}l.matches=f;return l}})},"builder/dijit/AutoComplete":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/window dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojo/html dojo/json dojo/keys dojo/on dojo/query dojo/request dojo/string dijit/focus dijit/form/TextBox dijit/registry dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetBase dgrid/OnDemandGrid dgrid/Selection dgrid/Keyboard dojo/NodeList-traverse dojo/NodeList-manipulate".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A,B){return f([z,w,x],{_attachmentNode:"",_autocompleteList:"",_grid:"",_store:"",_matchParam:"",_idProperty:"",_gridId:"",_filterId:"",_placeHolder:"",_noDataMsg:"",_maxWidth:"",_minWidth:"",_inputTextBox:"",_gridHasFocus:!1,_metaKeyPressed:!1,_shiftKeyPressed:!1,_CSS_STYLES:{CLASS_SELECTOR:".",ALL_SELECTOR:"\x3e",MULTI:"select2-container select2-container-multi",CHOICES:"select2-choices",CHOICE:"select2-search-choice",SEARCH_CHOICE_FOCUS:"select2-search-choice-focus",
SEARCH_FIELD:"select2-search-field",CLOSE_ICON:"select2-search-choice-close"},values:[],_selRows:[],_CHOICE_SELECTOR:"",_CHOICE_FOCUS:"",_CHOICE_FOCUS_ALL:"",constructor:function(a,b){this._attachmentNode=b;this._idProperty=a.idProperty;this._gridId=a.gridId;this._filterId=a.filterId;this._store=a.store;this._placeHolder=a.placeholder;this._noDataMsg=a.noDataMsg;this._maxWidth=a.maxWidth;this._minWidth=a.minWidth;this._matchParam=a.matchParam;this.values=[];this._selRows=[];this._CHOICE_ALL_SELECTOR=
this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE+this._CSS_STYLES.ALL_SELECTOR;this._CHOICE_FOCUS=this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.SEARCH_CHOICE_FOCUS;this._CHOICE_FOCUS_ALL=this._CHOICE_FOCUS+this._CSS_STYLES.ALL_SELECTOR},buildRendering:function(){this._createContainerNode();this._createTagList();this._createDropDownList();this._createInput();var b=a.hitch(this,function(a,b,c){b=this._inputTextBox?this._inputTextBox.get("value")+"":"";if(1>b.length)return!0;if(!a.tag)return!1;
a=(a.tag+"").toLowerCase().match(RegExp("^"+b.toLowerCase()));return null!==a&&0<a.length?!0:!1}),c=a.hitch(this,function(a,b,c){b=this._inputTextBox?this._inputTextBox.get("value")+"":"";return 1>b.length?!0:!a.tag?!1:~(a.tag+"").toLowerCase().indexOf(b.toLowerCase())?!0:!1}),d=[{field:this._idProperty}],e=[{attribute:this._idProperty,ascending:!0}];this._grid=new (f([y,A,B]))({store:this._store,showHeader:!1,noDataMessage:this._noDataMsg,selectionMode:"extended",allowSelectAll:!0,cellNavigation:!1,
columns:d,sort:e,renderRow:this._renderItem},this._gridId);q.add(this._gridId,"gridHeightLimiter");this._grid.query="first"===this._matchParam?b:c},postCreate:function(){var b;this._inputTextBox.watch("value",a.hitch(this,function(a,c,d){b&&(clearTimeout(b),b=null);this._grid.refresh()}));this._grid.on(".dgrid-row:click",a.hitch(this,function(a){var b="";!this._shiftKeyPressed&&!this._metaKeyPressed?(b=this._grid.row(a).data.tag,this._createTags(b),this._store.remove(b),this._grid.refresh(),this._resetInputTextBox()):
!a.shiftKey&&(!a.metaKey&&!a.ctrlKey)&&(b=this._selRows[0],this._createTags(b),this._store.remove(b),this._grid.refresh(),this._resetInputTextBox())}));this._grid.on("dgrid-deselect",a.hitch(this,function(a){this._selRows=[];for(var b in this._grid.selection)this._selRows.push(b)}));this._grid.on("dgrid-select",a.hitch(this,function(a){this._selRows=[];for(var b in this._grid.selection)this._selRows.push(b)}));this.connect(this.domNode,"keydown","_keydownHandler");window.onkeydown=a.hitch(this,function(a){if(a.shiftKey||
a.ctrlKey||224===a.keyCode)this._metaKeyPressed=!0});this.connect(document,"onkeydown",a.hitch(this,function(a){this._metaKeyPressed=this._shiftKeyPressed=!0}))},_keydownHandler:function(c){var e;void 0!==b.curNode.value&&(e=b.curNode.value.length);var f=u(this._CHOICE_FOCUS,k.byId(this.id)),h=u(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,k.byId(this.id)).last();switch(c.keyCode){case d.RIGHT_ARROW:this._navigate(f,e,h,"right");this._hideGrid();break;case d.LEFT_ARROW:this._navigate(f,
e,h,"left");this._hideGrid();break;case d.DOWN_ARROW:c.preventDefault();this._unhighlightTag(f);"none"===g.get(this._gridId,"display")&&this._showGrid();this._gridHasFocus||(this._grid.focus(this._setFocusOnFirstRow(this._grid,0)),this._gridHasFocus=!0);break;case d.UP_ARROW:break;case d.BACKSPACE:var l;if(0===e&&0===u(this._CHOICE_FOCUS_ALL).length&&void 0!==u(this._CHOICE_ALL_SELECTOR)[u(this._CHOICE_ALL_SELECTOR).length-1]&&(l=u(this._CHOICE_ALL_SELECTOR)[u(this._CHOICE_ALL_SELECTOR).length-1].title,
0<u("li",this._attachmentNode).length&&(m.destroy(h[0]),void 0!==l)))try{this._store.add({tag:l})}catch(n){}if(0<u(this._CHOICE_FOCUS_ALL).length&&(l=u(this._CHOICE_FOCUS_ALL).text(),m.destroy(f[0]),void 0!==l))try{this._store.add({tag:l})}catch(r){}this._grid.refresh();0===e&&this._hideGrid();this._removeTag(l);break;case d.CTRL:this._metaKeyPressed=!0;break;case d.META:this._metaKeyPressed=!0;break;case d.SHIFT:this._shiftKeyPressed=!0;break;case d.ENTER:if(0<e){e=b.curNode.value;e=e.split(",");
var q=[];p.forEach(e,function(a,b){-1===p.indexOf(q,a)&&q.push(t.trim(a))});p.forEach(q,a.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}))}else{for(e=0;e<this._selRows.length;e++)this._createTags(this._selRows[e]),this._store.remove(this._selRows[e]);this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();c.preventDefault();b.focus(k.byId(this._filterId));break;case d.TAB:if(!(b.curNode.id===this._filterId&&0===e)){if(0<e)e=b.curNode.value,
e=e.split(","),q=[],p.forEach(e,function(a,b){-1===p.indexOf(q,a)&&q.push(t.trim(a))}),p.forEach(q,a.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));else{for(e=0;e<this._selRows.length;e++)this._createTags(this._selRows[e]),this._store.remove(this._selRows[e]);this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();c.preventDefault();b.focus(k.byId(this._filterId))}break;case d.ESCAPE:this._hideGrid();break;default:-1<e&&("none"===g.get(k.byId(this._gridId),
"display")&&this._showGrid(),this._unhighlightTag(f)),this._metaKeyPressed=!1}},_blurHandler:function(b,c,d){if(!this.focused){if(0<this._inputTextBox.value.length){var e=[];b=this._inputTextBox.value.split(",");p.forEach(b,function(a,b){-1===p.indexOf(e,a)&&e.push(t.trim(a))});p.forEach(e,a.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));this._resetInputTextBox()}this._hideGrid()}},_resetInputTextBox:function(){n.byId(this._filterId).set("value","")},
_isEmpty:function(a){a=a.replace(/^\s+|\s+$/,"");return 0===a.length?!0:!1},_navigate:function(a,b,c,d){0<a.length&&1>b?("right"===d?this._hightlightTag(a.next()):this._hightlightTag(a.prev()),this._unhighlightTag(a)):1>b&&this._hightlightTag(c)},_contains:function(a,b){return 0<=p.indexOf(a,b)},_hightlightTag:function(a){a.addClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_unhighlightTag:function(a){a.removeClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_removeTag:function(a){a&&-1!==p.indexOf(this.values,
a)&&this.values.splice(p.indexOf(this.values,a),1)},_hideGrid:function(){k.byId(this._gridId)&&g.set(k.byId(this._gridId),"display","none");this._gridHasFocus=!1},_showGrid:function(){g.set(k.byId(this._gridId),"display","block");var a=g.get(k.byId(this._attachmentNode),"width");g.set(k.byId(this._gridId),"width",a+"px")},_setFocusOnFirstRow:function(a,b){return u(".dgrid-content .dgrid-cell",this._grid.domNode)[b]||u(".dgrid-content .dgrid-row",this._grid.domNode)[b]},_createTags:function(b){u(this._CHOICE_FOCUS,
k.byId(this.id)).removeClass("select2-search-choice-focus");var c=m.create("li",null,this._autocompleteList);q.add(c,this._CSS_STYLES.CHOICE);c=m.create("div",{title:b},c);e.set(c,this.htmlEncode(b));c=m.create("a",{href:"#"},c);q.add(c,this._CSS_STYLES.CLOSE_ICON);r(c,"click",a.hitch(this,function(a){var b=a.target.parentElement.innerText||a.target.parentElement.textContent;try{this._store.add({tag:b})}catch(c){}this._grid.refresh();this._removeTag(b);m.destroy(a.target.parentNode.parentNode);a.preventDefault()}));
c=n.byId(this._filterId);m.place(c.domNode,this._autocompleteList,"last");this._hideGrid();this.values.push(b)},_renderItem:function(a){return m.create("div",{innerHTML:a.tag})},_createContainerNode:function(){this.domNode=m.create("div",null,this._attachmentNode);q.add(this.domNode,this._CSS_STYLES.MULTI);g.set(this.domNode,"maxWidth",this._maxWidth);g.set(this.domNode,"minWidth",this._minWidth)},_createTagList:function(){this._autocompleteList=m.create("ul",null,this.domNode);q.add(this._autocompleteList,
this._CSS_STYLES.CHOICES)},_createInput:function(){var c=m.create("li",null,this._autocompleteList,"last");q.add(c,this._CSS_STYLES.SEARCH_FIELD);this._inputTextBox=new v({id:this._filterId,placeHolder:this._placeHolder,intermediateChanges:!0,trim:!0,style:{border:"none"}},c);q.add(this._inputTextBox,"inputTextBox");g.set(this._inputTextBox,"width",this._minWidth);b.watch("curNode",a.hitch(this,this._blurHandler))},_createDropDownList:function(){var a=m.create("div",{id:this._gridId},this.domNode);
q.add(a,"dropDownList");g.set(a,"width",this._minWidth)},prepopulate:function(b){p.forEach(b,a.hitch(this,function(a,b){this._createTags(a);this._store.remove(a)}))},clearTags:function(){var b=u(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,k.byId(this.id));0<b.length&&(p.forEach(b,a.hitch(this,function(a,b){try{this._store.add({tag:u(this._CHOICE_ALL_SELECTOR,k.byId(this.id))[0].title})}catch(c){}m.destroy(a)})),this.values=[])},addStyledTags:function(a,b){q.add(k.byId(b),this._CSS_STYLES.MULTI);
var c=m.create("ul",null,k.byId(b));q.add(c,this._CSS_STYLES.CHOICES);g.set(c,"border","none");p.forEach(a,function(a,b){var d=m.create("li",null,c);g.set(d,"padding","3px 5px 3px 5px");q.add(d,"select2-search-resultSet");d=m.create("div",{title:a},d);e.set(d,a)})},htmlEncode:function(a){return!a?a:a.replace(/&/g,"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;")}})})},"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(p,
f,a){return p("dgrid.OnDemandGrid",[f,a],{})})},"dgrid/Grid":function(){define("dojo/_base/kernel dojo/_base/declare dojo/on dojo/has put-selector/put ./List ./util/misc dojo/_base/sniff".split(" "),function(p,f,a,l,k,h,q){function m(a,d){d&&d.nodeType&&a.appendChild(d)}function g(a,d,e,f){if(this.formatter){f=this.formatter;var g=this.grid.formatterScope;e.innerHTML="string"===typeof f&&g?g[f](d,a):this.formatter(d,a)}else null!=d&&e.appendChild(document.createTextNode(d))}var e=8>l("ie")&&!l("quirks");
f=f("dgrid.Grid",h,{columns:null,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(a){return"object"!=typeof a?this.columns[a]:this.cell(a).column},listType:"grid",cell:function(a,d){if(a.column&&a.element)return a;a.target&&a.target.nodeType&&(a=a.target);var e;if(a.nodeType){do{if(this._rowIdToObject[a.id])break;var f=a.columnId;if(f){d=f;e=a;break}a=a.parentNode}while(a&&a!=this.domNode)}if(!e&&"undefined"!=typeof d){var g=this.row(a);if(f=g&&g.element)for(var f=f.getElementsByTagName("td"),
h=0;h<f.length;h++)if(f[h].columnId==d){e=f[h];break}}if(null!=a)return{row:g||this.row(a),column:d&&this.column(d),element:e}},createRowCells:function(a,d,f,g){var h=k("table.dgrid-row-table[role\x3dpresentation]"),m=9>l("ie")||l("quirks")?k(h,"tbody"):h,b,p,n,w,x,z,y,A,B,F;f=f||this.subRows;p=0;for(n=f.length;p<n;p++){z=f[p];b=k(m,"tr");z.className&&k(b,"."+z.className);w=0;for(x=z.length;w<x;w++){y=z[w];A=y.id;B=y.field?".field-"+q.escapeCssIdentifier(y.field,"-"):"";(F="function"===typeof y.className?
y.className(g):y.className)&&(B+="."+F);B=k(a+(".dgrid-cell.dgrid-cell-padding"+(A?".dgrid-column-"+q.escapeCssIdentifier(A,"-"):"")+B.replace(/ +/g,"."))+"[role\x3d"+("th"===a?"columnheader":"gridcell")+"]");B.columnId=A;e?(A=k(B,"!dgrid-cell-padding div.dgrid-cell-padding"),B.contents=A):A=B;if(F=y.colSpan)B.colSpan=F;if(F=y.rowSpan)B.rowSpan=F;d(A,y);b.appendChild(B)}}return h},left:function(a,d){a.element||(a=this.cell(a));return this.cell(this._move(a,-(d||1),"dgrid-cell"))},right:function(a,
d){a.element||(a=this.cell(a));return this.cell(this._move(a,d||1,"dgrid-cell"))},renderRow:function(a,d){var e=this.createRowCells("td",function(e,f){var h=a;f.get?h=f.get(a):"field"in f&&"_item"!=f.field&&(h=h[f.field]);f.renderCell?m(e,f.renderCell(a,h,e,d)):g.call(f,a,h,e,d)},d&&d.subRows,a);return k("div[role\x3drow]\x3e",e)},renderHeader:function(){var c=this,d=this.headerNode,f=d.childNodes.length;for(d.setAttribute("role","row");f--;)k(d.childNodes[f],"!");f=this.createRowCells("th",function(a,
c){var d=c.headerNode=a;e&&(a=a.parentNode);var b=c.field;b&&(a.field=b);if(c.renderHeaderCell)m(d,c.renderHeaderCell(d));else if("label"in c||c.field)d.appendChild(document.createTextNode("label"in c?c.label:c.field));!1!==c.sortable&&(b&&"_item"!=b)&&(a.sortable=!0,a.className+=" dgrid-sortable")},this.subRows&&this.subRows.headerRows);this._rowIdToObject[f.id=this.id+"-header"]=this.columns;d.appendChild(f);this._sortListener&&this._sortListener.remove();this._sortListener=a(f,"click,keydown",
function(e){if("click"==e.type||32==e.keyCode||!l("opera")&&13==e.keyCode){var f=e.target,g,b,h;do if(f.sortable){h=[{attribute:g=f.field||f.columnId,descending:(b=c._sort[0])&&b.attribute==g&&!b.descending}];g={bubbles:!0,cancelable:!0,grid:c,parentType:e.type,sort:h};a.emit(e.target,"dgrid-sort",g)&&(c._sortNode=f,c.set("sort",h));break}while((f=f.parentNode)&&f!=d)}})},resize:function(){var a=this.headerNode.firstChild,d=this.contentNode,e;this.inherited(arguments);if(!l("ie")||7<l("ie")&&!l("quirks"))if(d.style.width=
"",d&&a&&(e=a.offsetWidth)!=d.offsetWidth)d.style.width=e+"px"},destroy:function(){this._destroyColumns();this._sortListener&&this._sortListener.remove();this.inherited(arguments)},_setSort:function(a,d){this.inherited(arguments);this.updateSortArrow(this._sort)},_findSortArrowParent:function(a){var d=this.columns,e;for(e in d){var f=d[e];if(f.field==a)return f.headerNode}},updateSortArrow:function(a,d){this._lastSortedArrow&&(k(this._lastSortedArrow,"\x3c!dgrid-sort-up!dgrid-sort-down"),k(this._lastSortedArrow,
"!"),delete this._lastSortedArrow);d&&(this._sort=a);if(a[0]){var e=a[0].attribute,f=a[0].descending,e=this._sortNode||this._findSortArrowParent(e),g;delete this._sortNode;e&&(e=e.contents||e,g=this._lastSortedArrow=k("div.dgrid-sort-arrow.ui-icon[role\x3dpresentation]"),g.innerHTML="\x26nbsp;",e.insertBefore(g,e.firstChild),k(e,f?".dgrid-sort-down":".dgrid-sort-up"),this.resize())}},styleColumn:function(a,d){return this.addCssRule("#"+q.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+q.escapeCssIdentifier(a,
"-"),d)},_configColumns:function(a,d){var e=[],f=d instanceof Array;q.each(d,function(g,h){"string"==typeof g&&(d[h]=g={label:g});!f&&!g.field&&(g.field=h);h=g.id=g.id||(isNaN(h)?h:a+h);this._configColumn&&(this._configColumn(g,h,d,a),h=g.id);f&&(this.columns[h]=g);g.grid=this;"function"===typeof g.init&&g.init();e.push(g)},this);return f?d:e},_destroyColumns:function(){var a=this.subRows,d=a&&a.length,e,f,g,h;this.cleanup();for(e=0;e<d;e++){f=0;for(h=a[e].length;f<h;f++)g=a[e][f],"function"===typeof g.destroy&&
g.destroy()}},configStructure:function(){var a=this.subRows,d=this._columns=this.columns;this.columns=!d||d instanceof Array?{}:d;if(a)for(d=0;d<a.length;d++)a[d]=this._configColumns(d+"-",a[d]);else this.subRows=[this._configColumns("",d)]},_getColumns:function(){return this._columns||this.columns},_setColumns:function(a){this._destroyColumns();this.subRows=null;this.columns=a;this._updateColumns()},_setSubRows:function(a){this._destroyColumns();this.subRows=a;this._updateColumns()},setColumns:function(a){p.deprecated("setColumns(...)",
'use set("columns", ...) instead',"dgrid 0.4");this.set("columns",a)},setSubRows:function(a){p.deprecated("setSubRows(...)",'use set("subRows", ...) instead',"dgrid 0.4");this.set("subRows",a)},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this._sort&&this._sort.length?this.updateSortArrow(this._sort):this.resize())}});f.appendIfNode=m;f.defaultRenderCell=g;return f})},"put-selector/put":function(){(function(p){var f,
a=/[-+,> ]/;p([],f=function(l,k){function h(c){function d(){b&&(t&&b!=t)&&(t==c&&(f||(f=a.test(x)&&l.createDocumentFragment()))?f:t).insertBefore(b,p||null)}for(var f,k,p,t,b,v=arguments,n=v[0],w=0;w<v.length;w++){var x=v[w];if("object"==typeof x){k=!1;if(x instanceof Array){b=l.createDocumentFragment();for(var z=0;z<x.length;z++)b.appendChild(h(x[z]));x=b}if(x.nodeType)b=x,d(),t=x,p=0;else for(z in x)b[z]=x[z]}else if(k)k=!1,b.appendChild(l.createTextNode(x));else{1>w&&(c=null);k=!0;if(n=x.replace(q,
function(a,f,k,n,r,q){f&&(d(),"-"==f||"+"==f?(t=(p=b||t).parentNode,b=null,"+"==f&&(p=p.nextSibling)):("\x3c"==f?t=b=(b||t).parentNode:(","==f?t=c:b&&(t=b),b=null),p=0),b&&(t=b));if((a=!k&&n)||!b&&(k||r))"$"==a?(a=v[++w],t.appendChild(l.createTextNode(a))):(a=a||h.defaultTag,(f=e&&v[w+1]&&v[w+1].name)&&(a="\x3c"+a+' name\x3d"'+f+'"\x3e'),b=g&&~(m=a.indexOf("|"))?l.createElementNS(g[a.slice(0,m)],a.slice(m+1)):l.createElement(a));if(k)if("$"==n&&(n=v[++w]),"#"==k)b.id=n;else if(f=(a=b.className)&&
(" "+a+" ").replace(" "+n+" "," "),"."==k)b.className=a?(f+n).substring(1):n;else if("!"==x){var u;e?h("div",b,"\x3c").innerHTML="":(u=b.parentNode)&&u.removeChild(b)}else f=f.substring(1,f.length-1),f!=a&&(b.className=f);r&&("$"==q&&(q=v[++w]),"style"==r?b.style.cssText=q:(k="!"==r.charAt(0)?(r=r.substring(1))&&"removeAttribute":"setAttribute",q=""===q?r:q,g&&~(m=r.indexOf("|"))?b[k+"NS"](g[r.slice(0,m)],r.slice(m+1),q):b[k](r,q)));return""}))throw new SyntaxError("Unexpected char "+n+" in "+x);
d();t=n=b||t}}c&&f&&c.appendChild(f);return n}a=k||a;var q=/(?:\s*([-+ ,<>]))?\s*(\.|!\.?|#)?([-\w\u00A0-\uFFFF%$|]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,m,g=!1;l=l||document;var e="object"==typeof l.createElement;h.addNamespace=function(a,d){l.createElementNS?(g||(g={}))[a]=d:l.namespaces.add(a,d)};h.defaultTag="div";h.forDocument=f;return h})})(function(p,f,a){a=a||f;"function"===typeof define?define([],function(){return a()}):"undefined"==typeof window?require("./node-html")(module,a):put=
a()})},"dgrid/List":function(){define("dojo/_base/kernel dojo/_base/declare dojo/dom dojo/on dojo/has ./util/misc dojo/has!touch?./TouchScroll xstyle/has-class put-selector/put dojo/_base/sniff xstyle/css!./css/dgrid.css".split(" "),function(p,f,a,l,k,h,q,m,g){function e(a,b){g(document.body,a,".dgrid-scrollbar-measure");var c=a["offset"+b]-a["client"+b];a.className="";document.body.removeChild(a);return c}function c(a){var b=a?"."+a.replace(v,"."):"";this._class&&(b="!"+this._class.replace(v,"!")+
b);g(this.domNode,b);this._class=a}function d(){return this._class}function r(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}}function u(a){"undefined"!==typeof a.x&&(this.bodyNode.scrollLeft=a.x);"undefined"!==typeof a.y&&(this.bodyNode.scrollTop=a.y)}m("mozilla","opera","webkit","ie","ie-6","ie-6-7","quirks","no-quirks","touch");var s,t;k.add("dom-scrollbar-width",function(a,b,c){return e(c,"Width")});k.add("dom-scrollbar-height",function(a,b,c){return e(c,"Height")});k.add("dom-rtl-scrollbar-left",
function(a,b,c){a=g("div");g(document.body,c,".dgrid-scrollbar-measure[dir\x3drtl]");g(c,a);b=!!k("ie")||!!k("trident")||a.offsetLeft>=k("dom-scrollbar-width");c.className="";document.body.removeChild(c);g(a,"!");c.removeAttribute("dir");return b});var b=0,v=/ +/g,n=7>k("ie")&&!k("quirks")?function(){var a,b,c;if(this._started&&(a=document.documentElement,b=a.clientWidth,a=a.clientHeight,c=this._prevWinDims||[],c[0]!==b||c[1]!==a))this.resize(),this._prevWinDims=[b,a]}:function(){this._started&&this.resize()};
return f("dgrid.List",k("touch")?q:null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,useTouchScroll:null,addUiClasses:!0,shouldObserveStore:!0,cleanEmptyObservers:!0,highlightDuration:250,postscript:function(a,b){var c=this;(this._Row=function(a,b,c){this.id=a;this.data=b;this.element=c}).prototype.remove=function(){c.removeRow(this.element)};b&&(this.srcNodeRef=b=b.nodeType?b:document.getElementById(b));this.create(a,b)},listType:"list",create:function(a,d){var e=
this.domNode=d||g("div"),h;a?(this.params=a,f.safeMixin(this,a),h=a["class"]||a.className||e.className,this._sort=a.sort||[],delete this.sort):this._sort=[];this.observers=[];this._numObservers=0;this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=e.id=e.id||this.id||"dgrid_"+b++;null===this.useTouchScroll&&(this.useTouchScroll=!k("dom-scrollbar-width"));this.buildRendering();h&&c.call(this,h);this.postCreate();delete this.srcNodeRef;this.domNode.offsetHeight&&
this.startup()},buildRendering:function(){var a=this.domNode,b=this.addUiClasses,c=this,d,e,f,m;m=this.isRTL="rtl"==(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();a.className="";g(a,"[role\x3dgrid].dgrid.dgrid-"+this.listType+(b?".ui-widget":""));d=this.headerNode=g(a,"div.dgrid-header.dgrid-header-row"+(b?".ui-widget-header":"")+(this.showHeader?"":".dgrid-header-hidden"));(k("quirks")||8>k("ie"))&&g(a,"div.dgrid-spacer");e=this.bodyNode=g(a,"div.dgrid-scroller");
k("ff")&&(e.tabIndex=-1);this.headerScrollNode=g(a,"div.dgrid-header.dgrid-header-scroll.dgrid-scrollbar-width"+(b?".ui-widget-header":""));f=this.footerNode=g("div.dgrid-footer"+(this.showFooter?"":".dgrid-footer-hidden"));g(a,f);m&&(a.className+=" dgrid-rtl"+(k("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));l(e,"scroll",function(b){c.showHeader&&(d.scrollLeft=b.scrollLeft||e.scrollLeft);b.stopPropagation();l.emit(a,"scroll",{scrollTarget:e})});this.configStructure();this.renderHeader();this.contentNode=
this.touchNode=g(this.bodyNode,"div.dgrid-content"+(b?".ui-widget-content":""));this._listeners.push(this._resizeHandle=l(window,"resize",h.throttleDelayed(n,this)))},postCreate:k("touch")?function(){this.useTouchScroll&&this.inherited(arguments)}:function(){},startup:function(){this._started||(this.inherited(arguments),this._started=!0,this.resize(),this.set("sort",this._sort))},configStructure:function(){},resize:function(){var a=this.bodyNode,b=this.headerNode,c=this.footerNode,d=b.offsetHeight,
e=this.showFooter?c.offsetHeight:0,f=k("quirks")||7>k("ie");this.headerScrollNode.style.height=a.style.marginTop=d+"px";a.style.marginBottom=e+"px";f&&(a.style.height="",a.style.height=Math.max(this.domNode.offsetHeight-d-e,0)+"px",e&&(c.style.bottom="1px",setTimeout(function(){c.style.bottom=""},0)));s||(s=k("dom-scrollbar-width"),t=k("dom-scrollbar-height"),k("ie")&&(s++,t++),h.addCssRule(".dgrid-scrollbar-width","width: "+s+"px"),h.addCssRule(".dgrid-scrollbar-height","height: "+t+"px"),17!=s&&
!f&&(h.addCssRule(".dgrid-header-row","right: "+s+"px"),h.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+s+"px")));f&&(b.style.width=a.clientWidth+"px",setTimeout(function(){b.scrollLeft=a.scrollLeft},0))},addCssRule:function(a,b){var c=h.addCssRule(a,b);this.cleanAddedRules&&this._listeners.push(c);return c},on:function(a,b){var c=l(this.domNode,a,b);k("dom-addeventlistener")||this._listeners.push(c);return c},cleanup:function(){var a=this.observers,b;for(b in this._rowIdToObject)if(this._rowIdToObject[b]!=
this.columns){var c=document.getElementById(b);c&&this.removeRow(c,!0)}for(b=0;b<a.length;b++)(c=a[b])&&c.cancel();this.observers=[];this._numObservers=0;this.preload=null},destroy:function(){if(this._listeners){for(var a=this._listeners.length;a--;)this._listeners[a].remove();delete this._listeners}this._started=!1;this.cleanup();g(this.domNode,"!");this.useTouchScroll&&this.inherited(arguments)},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoId=0;this.contentNode.innerHTML="";
this.scrollTo({x:0,y:0})},newRow:function(a,b,c,d,e){if(b){var f=this.insertRow(a,b,c,d,e);g(f,".dgrid-highlight"+(this.addUiClasses?".ui-state-highlight":""));setTimeout(function(){g(f,"!dgrid-highlight!ui-state-highlight")},this.highlightDuration);return f}},adjustRowIndices:function(a){var b=a.rowIndex;if(-1<b){do-1<a.rowIndex&&(this.maintainOddEven&&-1<(a.className+" ").indexOf("dgrid-row ")&&g(a,"."+(1==b%2?"dgrid-row-odd":"dgrid-row-even")+"!"+(0==b%2?"dgrid-row-odd":"dgrid-row-even")),a.rowIndex=
b++);while((a=a.nextSibling)&&a.rowIndex!=b)}},renderArray:function(b,c,d){function e(){var a=arguments;if(-1<q)for(var c=0;c<a.length;c++){var g=a[c],h=m[g?0:m.length-1];if(h=h&&f(h)){var l=h[g?"previousSibling":"nextSibling"];l&&(l=k.row(l));l&&l.element!=h&&(g=g?"unshift":"push",b[g](l.data),m[g](l.element),d.count++)}}}function f(b){return!a.isDescendant(b,k.domNode)&&document.getElementById(b.id)?k.row(b.id.slice(k.id.length+5)).element:b}function g(a){t=k.insertRow(a,s,null,l++,d);t.observerIndex=
q;return t}function h(a){u=a.slice(0);(r=c?c.parentNode:k.contentNode)&&r.parentNode&&(r!==k.contentNode||a.length)?(r.insertBefore(s,c||null),(t=a[a.length-1])&&k.adjustRowIndices(t)):n[q]&&k.cleanEmptyObservers&&"undefined"!==typeof q&&(n[q].cancel(),n[q]=0,k._numObservers--);m=a;p&&(p.rows=m)}d=d||{};var k=this,l=d.start||0,n=this.observers,m,r,q;c||(this._lastCollection=b);if(b.observe&&this.shouldObserveStore){k._numObservers++;var p=b.observe(function(a,g,h){var l,n,p;-1<g&&m[g]&&(l=m.splice(g,
1)[0],l.parentNode==r&&((n=l.nextSibling)&&g!=h&&n.rowIndex--,k.removeRow(l)),d.count--,k._processScroll&&k._processScroll());if(-1<h){if(m.length)if(0===h)p=(p=m[h])&&f(p);else{if(p=m[h-1])p=f(p),p=(p.connected||p).nextSibling}else p=k._getFirstRowSibling&&k._getFirstRowSibling(r);l&&(p&&l.id===p.id)&&(p=(p.connected||p).nextSibling);p&&!p.parentNode&&(p=document.getElementById(p.id));l=c&&c.parentNode||p&&p.parentNode||k.contentNode;if(l=k.newRow(a,l,p,d.start+h,d))if(l.observerIndex=q,m.splice(h,
0,l),!n||h<g)n=l.previousSibling,n=!n||n.rowIndex+1==l.rowIndex||0==l.rowIndex?l:n;d.count++}0===g?e(1,1):g===b.length-(-1===h?0:1)&&e(0,0);g!=h&&n&&k.adjustRowIndices(n);k._onNotification(m,a,g,h)},!0);q=n.push(p)-1}var s=document.createDocumentFragment(),t,u;if(b.map){if(m=b.map(g,console.error),m.then)return b.then(function(a){b=a;return m.then(function(a){h(a);e(1,1,0,0);return u})})}else{m=[];for(var v=0,V=b.length;v<V;v++)m[v]=g(b[v])}h(m);e(1,1,0,0);return u},_onNotification:function(a,b,c,
d){},renderHeader:function(){},_autoId:0,insertRow:function(a,b,c,d,e){var f=e.parentId,f=this.id+"-row-"+(f?f+"-":"")+(this.store&&this.store.getIdentity?this.store.getIdentity(a):this._autoId++),g=document.getElementById(f),h=g&&g.previousSibling;g&&(g===c&&(c=(c.connected||c).nextSibling),this.removeRow(g));g=this.renderRow(a,e);g.className=(g.className||"")+" dgrid-row "+(1==d%2?"dgrid-row-odd":"dgrid-row-even")+(this.addUiClasses?" ui-state-default":"");this._rowIdToObject[g.id=f]=a;b.insertBefore(g,
c||null);h&&this.adjustRowIndices(h);g.rowIndex=d;return g},renderRow:function(a,b){return g("div",""+a)},removeRow:function(a,b){a=a.element||a;delete this._rowIdToObject[a.id];b||g(a,"!")},row:function(a){var b;if(a instanceof this._Row)return a;a.target&&a.target.nodeType&&(a=a.target);if(a.nodeType){do{var c=a.id;if(b=this._rowIdToObject[c])return new this._Row(c.substring(this.id.length+5),b,a);a=a.parentNode}while(a&&a!=this.domNode)}else return"object"==typeof a?b=this.store.getIdentity(a):
(b=a,a=this._rowIdToObject[this.id+"-row-"+b]),new this._Row(b,a,document.getElementById(this.id+"-row-"+b))},cell:function(a){return{row:this.row(a)}},_move:function(a,b,c,d){var e,f;f=e=a.element;b=b||1;do if(a=e[0>b?"previousSibling":"nextSibling"]){do if((e=a)&&-1<(e.className+" ").indexOf(c+" ")){f=e;b+=0>b?1:-1;break}while(a=(!d||!e.hidden)&&e[0>b?"lastChild":"firstChild"])}else if(e=e.parentNode,!e||e===this.bodyNode||e===this.headerNode)break;while(b);return f},up:function(a,b,c){a.element||
(a=this.row(a));return this.row(this._move(a,-(b||1),"dgrid-row",c))},down:function(a,b,c){a.element||(a=this.row(a));return this.row(this._move(a,b||1,"dgrid-row",c))},scrollTo:k("touch")?function(a){return this.useTouchScroll?this.inherited(arguments):u.call(this,a)}:u,getScrollPosition:k("touch")?function(){return this.useTouchScroll?this.inherited(arguments):r.call(this)}:r,get:function(a){var b="_get"+a.charAt(0).toUpperCase()+a.slice(1);return"function"===typeof this[b]?this[b].apply(this,[].slice.call(arguments,
1)):this[a]},set:function(a,b){if("object"===typeof a)for(var c in a)this.set(c,a[c]);else c="_set"+a.charAt(0).toUpperCase()+a.slice(1),"function"===typeof this[c]?this[c].apply(this,[].slice.call(arguments,1)):this[a]=b;return this},_getClass:d,_setClass:c,_getClassName:d,_setClassName:c,_setSort:function(a,b){this._sort="string"!=typeof a?a:[{attribute:a,descending:b}];this.refresh();this._lastCollection&&(a.length&&("string"!=typeof a&&(b=a[0].descending,a=a[0].attribute),this._lastCollection.sort(function(c,
d){var e=c[a],f=d[a];void 0===e&&(e="");void 0===f&&(f="");return e==f?0:e>f==!b?1:-1})),this.renderArray(this._lastCollection))},sort:function(a,b){p.deprecated("sort(...)",'use set("sort", ...) instead',"dgrid 0.4");this.set("sort",a,b)},_getSort:function(){return this._sort},_setShowHeader:function(a){var b=this.headerNode;this.showHeader=a;g(b,(a?"!":".")+"dgrid-header-hidden");this.renderHeader();this.resize();a&&(b.scrollLeft=this.getScrollPosition().x)},setShowHeader:function(a){p.deprecated("setShowHeader(...)",
'use set("showHeader", ...) instead',"dgrid 0.4");this.set("showHeader",a)},_setShowFooter:function(a){this.showFooter=a;g(this.footerNode,(a?"!":".")+"dgrid-footer-hidden");this.resize()}})})},"dgrid/util/misc":function(){define(["dojo/has","put-selector/put"],function(p,f){p.add("dom-contains",function(a,e,c){return!!c.contains});var a=[],l,k,h,q=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,m={defaultDelay:15,throttle:function(a,e,c){var d=!1;c=c||m.defaultDelay;return function(){d||(d=!0,a.apply(e,arguments),
setTimeout(function(){d=!1},c))}},throttleDelayed:function(a,e,c){var d=!1;c=c||m.defaultDelay;return function(){if(!d){d=!0;var f=arguments;setTimeout(function(){d=!1;a.apply(e,f)},c)}}},debounce:function(a,e,c){var d;c=c||m.defaultDelay;return function(){d&&(clearTimeout(d),d=null);var f=arguments;d=setTimeout(function(){a.apply(e,f)},c)}},each:function(a,e,c){var d,f;if(a)if("number"===typeof a.length){d=0;for(f=a.length;d<f;d++)e.call(c,a[d],d,a)}else for(d in a)e.call(c,a[d],d,a)},contains:function(a,
e){return p("dom-contains")?a.contains(e):a.compareDocumentPosition(e)&8},addCssRule:function(g,e){l||(l=f(document.getElementsByTagName("head")[0],"style"),l=l.sheet||l.styleSheet,k=l.deleteRule?"deleteRule":"removeRule",h=l.cssRules?"cssRules":"rules");var c=a.length;a[c]=(l.cssRules||l.rules).length;l.addRule?l.addRule(g,e):l.insertRule(g+"{"+e+"}",a[c]);return{get:function(d){return l[h][a[c]].style[d]},set:function(d,e){"undefined"!==typeof a[c]&&(l[h][a[c]].style[d]=e)},remove:function(){var d=
a[c],e,f;if(void 0!==d){l[k](d);a[c]=void 0;e=c+1;for(f=a.length;e<f;e++)a[e]>d&&a[e]--}}}},escapeCssIdentifier:function(a,e){return"string"===typeof a?a.replace(q,e||"\\$1"):a}};return m})},"xstyle/has-class":function(){define(["dojo/has"],function(p){var f={};return function(){for(var a,l=arguments,k=0;k<l.length;k++)if(a=l[k],!f[a]){f[a]=!0;var h=a.match(/^(no-)?(.+?)((-[\d\.]+)(-[\d\.]+)?)?$/),q=p(h[2]),m=-h[4];if((0<m?m<=q&&(-h[5]||m)>=q:!!q)==!h[1])document.documentElement.className+=" has-"+
a}}})},"xstyle/css":function(){define(["require"],function(p){function f(a,f,k){var h=document.documentElement;a=h.insertBefore(document.createElement(a),h.firstChild);a.id=f;f=(a.currentStyle||getComputedStyle(a,null)||{})[k];h.removeChild(a);return f}return{load:function(a,l,k,h){function q(a){var d=f("x-parse",null,"content"),e=a&&(a.sheet||a.styleSheet);d&&"none"!=d&&"normal"!=d?l([eval(d)],function(d){a?d.process(a,k):(d.processAll(),k(e))}):k(e)}var m=l.toUrl(a),g;m.match(/!$/)&&(g={wait:!1},
m=m.slice(0,-1));var e=l.cache&&l.cache["url:"+m];if(e)e.xCss&&(e=e.cssText),p(["./core/load-css"],function(a){q(a.insertCss(e))});else{if("none"==f("div",a.replace(/\//g,"-").replace(/\..*/,"")+"-loaded","display"))return q();p(["./core/load-css"],function(a){a(m,q,g)})}}}})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/dom dojo/on ./util/misc put-selector/put".split(" "),function(p,f,a,l,k,h,q,m,g){return a("dgrid.OnDemandList",
[p,f],{minRowsPerPage:25,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:m.defaultDelay,keepScrollPosition:!1,rowHeight:22,postCreate:function(){this.inherited(arguments);var a=this;q(this.bodyNode,"scroll",m[this.pagingMethod](function(c){a._processScroll(c)},null,this.pagingDelay))},destroy:function(){this.inherited(arguments);this._refreshTimeout&&clearTimeout(this._refreshTimeout)},renderQuery:function(a,c){function d(a){g(w,
"!");if(a)throw f._refreshDeferred&&(f._refreshDeferred.reject(a),delete f._refreshDeferred),a;}var f=this,h=c&&c.container||this.contentNode,m={query:a,count:0,options:c},q,b=this.preload,p,n={node:g(h,"div.dgrid-preload",{rowIndex:0}),count:0,query:a,next:m,options:c};n.node.style.height="0";m.node=q=g(h,"div.dgrid-preload");m.previous=n;q.rowIndex=this.minRowsPerPage;b?((m.next=b.next)&&q.offsetTop>=b.node.offsetTop?m.previous=b:(m.next=b,m.previous=b.previous),m.previous.next=m,m.next.previous=
m):this.preload=m;var w=g(q,"-div.dgrid-loading");g(w,"div.dgrid-below").innerHTML=this.loadingMessage;c=l.mixin(this.get("queryOptions"),c,{start:0,count:this.minRowsPerPage},"level"in a?{queryLevel:a.level}:null);this._trackError(function(){return p=a(c)});if("undefined"===typeof p)d();else return k.when(f.renderArray(p,q,c),function(a){return k.when("undefined"===typeof p.total?p.length:p.total,function(b){var d=a.length,e=q.parentNode,h=f.noDataNode;g(w,"!");"queryLevel"in c||(f._total=b);0===
b&&e&&(h&&(g(h,"!"),delete f.noDataNode),f.noDataNode=h=g("div.dgrid-no-data"),e.insertBefore(h,f._getFirstRowSibling(e)),h.innerHTML=f.noDataMessage);for(h=e=0;h<d;h++)e+=f._calcRowHeight(a[h]);d&&e&&(f.rowHeight=e/d);b-=d;m.count=b;q.rowIndex=d;b?q.style.height=Math.min(b*f.rowHeight,f.maxEmptySpace)+"px":(q.style.display="none",c.count++);f._previousScrollPosition&&(f.scrollTo(f._previousScrollPosition),delete f._previousScrollPosition);f._processScroll();f._refreshDeferred&&(f._refreshDeferred.resolve(p),
delete f._refreshDeferred);return a},d)},d),p},refresh:function(a){var c=this,d=a&&a.keepScrollPosition,f;"undefined"===typeof d&&(d=this.keepScrollPosition);d&&(this._previousScrollPosition=this.getScrollPosition());this.inherited(arguments);if(this.store)return d=this._refreshDeferred=new k,f=c.renderQuery(function(a){return c.store.query(c.query,a)}),"undefined"===typeof f&&d.reject(),d.then(function(a){c._refreshTimeout=setTimeout(function(){q.emit(c.domNode,"dgrid-refresh-complete",{bubbles:!0,
cancelable:!1,grid:c,results:a});c._refreshTimeout=null},0);delete c._refreshDeferred;return a},function(a){delete c._refreshDeferred;throw a;})},resize:function(){this.inherited(arguments);this._processScroll()},_getFirstRowSibling:function(a){return a.lastChild},_calcRowHeight:function(a){var c=a.nextSibling;return c&&!/\bdgrid-preload\b/.test(c.className)?c.offsetTop-a.offsetTop:a.offsetHeight},lastScrollTop:0,_processScroll:function(a){function c(a,b,c,e){var f=h.farOffRemoval,k=a.node;if(b>2*
f){for(var l,n=k[c],m=0,r=0,q=[];l=n;){var p=h._calcRowHeight(l);if(m+p+f>b||0>n.className.indexOf("dgrid-row")&&0>n.className.indexOf("dgrid-loading"))break;n=l[c];m+=p;r+=l.count||1;h.removeRow(l,!0);q.push(l)}a.count+=r;e?(k.rowIndex-=r,d(a)):k.style.height=k.offsetHeight+m+"px";var s=g("div",q);setTimeout(function(){g(s,"!")},1)}}function d(a,b){a.node.style.height=Math.min(a.count*h.rowHeight,b?Infinity:h.maxEmptySpace)+"px"}function f(a,b){do a=b?a.next:a.previous;while(a&&!a.node.offsetWidth);
return a}var h=this,m=h.bodyNode;a=a&&a.scrollTop||this.getScrollPosition().y;var m=m.offsetHeight+a,q,b,p=h.preload,n=h.lastScrollTop,w=h.bufferRows*h.rowHeight,x=w-h.rowHeight,z,y,A,B=!0;for(h.lastScrollTop=a;p&&!p.node.offsetWidth;)p=p.previous;for(;p&&p!=q;){q=h.preload;h.preload=p;b=p.node;var F=b.offsetTop;if(m+1+x<F)p=f(p,B=!1);else if(a-1-x>F+b.offsetHeight)p=f(p,B=!0);else{var E=((b.rowIndex?a-w:m)-F)/h.rowHeight,F=(m-a+2*w)/h.rowHeight,H=Math.max(Math.min((a-n)*h.rowHeight,h.maxRowsPerPage/
2),h.maxRowsPerPage/-2),F=F+Math.min(Math.abs(H),10);0==b.rowIndex&&(E-=F);E=Math.max(E,0);10>E&&(0<E&&F+E<h.maxRowsPerPage)&&(F+=Math.max(0,E),E=0);F=Math.min(Math.max(F,h.minRowsPerPage),h.maxRowsPerPage,p.count);if(0==F)p=f(p,B);else{var F=Math.ceil(F),E=Math.min(Math.floor(E),p.count-F),I=l.mixin(h.get("queryOptions"),p.options);p.count-=F;var M=b,Q,K=h.queryRowsOverlap;if(H=(0<b.rowIndex||b.offsetTop>a)&&p){var J=p.previous;J&&(c(J,a-(J.node.offsetTop+J.node.offsetHeight),"nextSibling"),0<E&&
J.node==b.previousSibling?(E=Math.min(p.count,E),p.previous.count+=E,d(p.previous,!0),b.rowIndex+=E,K=0):F+=E,p.count-=E);I.start=b.rowIndex-K;I.count=Math.min(F+K,h.maxRowsPerPage);b.rowIndex=I.start+I.count}else p.next&&(c(p.next,p.next.node.offsetTop-m,"previousSibling",!0),M=b.nextSibling,M==p.next.node?(p.next.count+=p.count-E,p.next.node.rowIndex=E+F,d(p.next),p.count=E,K=0):Q=!0),I.start=p.count,I.count=Math.min(F+K,h.maxRowsPerPage);Q&&(M&&M.offsetWidth)&&(Q=M.offsetTop);d(p);"level"in p.query&&
(I.queryLevel=p.query.level);if("queryLevel"in I||!(I.start>h._total||0>I.count)){b=g(M,"-div.dgrid-loading[style\x3dheight:"+F*h.rowHeight+"px]");g(b,"div.dgrid-"+(H?"below":"above")).innerHTML=h.loadingMessage;b.count=F;var O=p.query(I);if(void 0===h._trackError(function(){return O})){g(b,"!");return}(function(a,b,c,e){A=k.when(h.renderArray(e,a,I),function(f){y=e;M=a.nextSibling;g(a,"!");if(c&&M&&M.offsetWidth){var l=h.getScrollPosition();h.scrollTo({x:l.x,y:l.y+M.offsetTop-c,preserveMomentum:!0})}k.when(e.total||
e.length,function(a){"queryLevel"in I||(h._total=a);b&&(b.count=a-b.node.rowIndex,0===b.count&&I.count++,d(b))});h._processScroll();return f},function(b){g(a,"!");throw b;})}).call(this,b,H,Q,O);p=p.previous}}}}if(A&&(z=this._refreshDeferred))delete this._refreshDeferred,k.when(A,function(){z.resolve(y)})},removeRow:function(a,c){if(a){var d=a.previousSibling,f=a.nextSibling,d=d&&(null!=d.observerIndex?d.observerIndex:d.previousObserverIndex),g=f&&(null!=f.observerIndex?f.observerIndex:f.nextObserverIndex),
f=a.observerIndex;a.observerIndex=void 0;c&&(a.nextObserverIndex=g,a.previousObserverIndex=d);if(this.cleanEmptyObservers&&(-1<f&&f!==d&&f!==g)&&(d=this.observers,g=d[f])){if(!c)for(var k=g.rows,l=0;l<k.length;l++)if(k[l]!=a&&h.isDescendant(k[l],this.domNode))return this.inherited(arguments);g.cancel();this._numObservers--;d[f]=0}}this.inherited(arguments)}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/on dojo/aspect put-selector/put".split(" "),
function(p,f,a,l,k,h,q){function m(a){return a}function g(a){if("object"!==typeof a)a=Error(a);else if("cancel"===a.dojoType)return;a.grid=this;k.emit(this.domNode,"dgrid-error",{grid:this,error:a,cancelable:!0,bubbles:!0})&&console.error(a)}return f("dgrid._StoreMixin",null,{store:null,query:null,queryOptions:null,getBeforePut:!0,noDataMessage:"",loadingMessage:"",constructor:function(){this.query={};this.queryOptions={};this.dirty={};this._updating={};this._columnsWithSet={};h.before(this,"configStructure",
a.hitch(this,function(){this._columnsWithSet={}}))},postCreate:function(){this.inherited(arguments);this.store&&this._updateNotifyHandle(this.store)},destroy:function(){this.inherited(arguments);this._notifyHandle&&this._notifyHandle.remove()},_configColumn:function(a){a.set&&(this._columnsWithSet[a.field]=a);this.inherited(arguments)},_updateNotifyHandle:function(e){this._notifyHandle&&(this._notifyHandle.remove(),delete this._notifyHandle);e&&("function"===typeof e.notify&&this.shouldObserveStore)&&
(this._notifyHandle=h.after(e,"notify",a.hitch(this,"_onNotify"),!0),e=this.get("sort"),(!e||!e.length)&&console.warn("Observable store detected, but no sort order specified. You may experience quirks when adding/updating items.  These can be resolved by setting a sort order on the list or grid."))},_setStore:function(a,c,d){this._updateNotifyHandle(a);this.store=a;this.dirty={};this.set("query",c,d)},_setQuery:function(a,c){var d=c&&c.sort;this.query=void 0!==a?a:this.query;this.queryOptions=c||
this.queryOptions;this._started&&(d?this.set("sort",d):this.refresh())},setStore:function(a,c,d){p.deprecated("setStore(...)",'use set("store", ...) instead',"dgrid 0.4");this.set("store",a,c,d)},setQuery:function(a,c){p.deprecated("setQuery(...)",'use set("query", ...) instead',"dgrid 0.4");this.set("query",a,c)},_getQueryOptions:function(){var e=a.delegate(this.queryOptions,{});if("function"===typeof this._sort||this._sort.length)e.sort=this._sort;return e},_getQuery:function(){var e=this.query;
return"object"==typeof e&&null!=e?a.delegate(e,{}):e},_setSort:function(a,c){this.store&&(this._lastCollection=null);this.inherited(arguments)},_onNotify:function(a,c){this.inherited(arguments);a&&1>this._numObservers&&this.refresh({keepScrollPosition:!0})},refresh:function(){var a=this.inherited(arguments);this.store||(this.noDataNode=q(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return a},renderArray:function(){var a=this,c=this.inherited(arguments);this.store||
l.when(c,function(c){c.length&&a.noDataNode&&q(a.noDataNode,"!")});return c},insertRow:function(e,c,d,f,g){var h=this.store,k=this.dirty,h=h&&h.getIdentity(e),b;h in k&&!(h in this._updating)&&(b=k[h]);b&&(e=a.delegate(e,b));return this.inherited(arguments)},updateDirty:function(a,c,d){var f=this.dirty,g=f[a];g||(g=f[a]={});g[c]=d},setDirty:function(a,c,d){p.deprecated("setDirty(...)","use updateDirty() instead","dgrid 0.4");this.updateDirty(a,c,d)},save:function(){function a(b,e){return function(a){var g=
c._columnsWithSet,h=c._updating,k,m;if("function"===typeof a.set)a.set(e);else for(k in e)a[k]=e[k];for(k in g)m=g[k].set(a),void 0!==m&&(a[k]=m);h[b]=!0;return l.when(d.put(a),function(){delete f[b];delete h[b]})}}var c=this,d=this.store,f=this.dirty,g=new l,h=g.promise,k=function(a){var b;return c.getBeforePut||!(b=c.row(a).data)?function(){return d.get(a)}:function(){return b}},b;for(b in f)var m=a(b,f[b]),h=h.then(k(b)).then(m);g.resolve();return h},revert:function(){this.dirty={};this.refresh()},
_trackError:function(e){var c;"string"==typeof e&&(e=a.hitch(this,e));try{c=e()}catch(d){g.call(this,d)}return l.when(c,m,a.hitch(this,g))},newRow:function(){var a=this.inherited(arguments);this.noDataNode&&(q(this.noDataNode,"!"),delete this.noDataNode);return a},removeRow:function(a,c){var d={element:a};!c&&(this.noDataMessage&&this.up(d).element===a&&this.down(d).element===a)&&(this.noDataNode=q(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return this.inherited(arguments)}})})},
"dgrid/Selection":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/Deferred dojo/on dojo/has dojo/aspect ./List dojo/has!touch?./util/touch put-selector/put dojo/query dojo/_base/sniff".split(" "),function(p,f,a,l,k,h,q,m,g){function e(a,c){for(var d=a.unselectable=c?"on":"",e=a.getElementsByTagName("*"),f=e.length;--f;)"INPUT"===e[f].tagName||"TEXTAREA"===e[f].tagName||(e[f].unselectable=d)}function c(a,c){var d=a.bodyNode,f=c?"text":21>k("ff")?"-moz-none":"none";r&&"msUserSelect"!==
r?d.style[r]=f:k("dom-selectstart")?!c&&!a._selectstartHandle?a._selectstartHandle=l(d,"selectstart",function(a){var b=a.target&&a.target.tagName;"INPUT"!==b&&"TEXTAREA"!==b&&a.preventDefault()}):c&&a._selectstartHandle&&(a._selectstartHandle.remove(),delete a._selectstartHandle):(e(d,!c),!c&&!a._unselectableHandle?a._unselectableHandle=h.after(a,"renderRow",function(a){e(a,!0);return a}):c&&a._unselectableHandle&&(a._unselectableHandle.remove(),delete a._unselectableHandle))}k.add("dom-comparedocumentposition",
function(a,c,d){return!!d.compareDocumentPosition});k.add("pointer",function(a){return"PointerEvent"in a?"pointer":"MSPointerEvent"in a?"MSPointer":!1});k.add("css-user-select",function(a,c,d){a=d.style;c=["Khtml","O","ms","Moz","Webkit"];d=c.length;var e="userSelect";do if("undefined"!==typeof a[e])return e;while(d--&&(e=c[d]+"UserSelect"));return!1});k.add("dom-selectstart","undefined"!==typeof document.onselectstart);var d=k("mac")?"metaKey":"ctrlKey",r=k("css-user-select"),u=(q=k("pointer"))&&
"MS"===q.slice(0,2),s=q?q+(u?"Down":"down"):"mousedown",t=q?q+(u?"Up":"up"):"mouseup";"WebkitUserSelect"===r&&"undefined"!==typeof document.documentElement.style.msUserSelect&&(r=!1);return f("dgrid.Selection",null,{selectionDelegate:".dgrid-row",selectionEvents:s+","+t+",dgrid-cellfocusin",selectionTouchEvents:k("touch")?m.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};
return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var a=this.selectionMode;this.selectionMode="";this._setSelectionMode(a)},destroy:function(){this.inherited(arguments);this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&this._removeDeselectSignals()},_setSelectionMode:function(a){a!=this.selectionMode&&(this.clearSelection(),this.selectionMode=
a,this._selectionHandlerName="_"+a+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},setSelectionMode:function(a){p.deprecated("setSelectionMode(...)",'use set("selectionMode", ...) instead',"dgrid 0.4");this.set("selectionMode",a)},_setAllowTextSelection:function(a){"undefined"!==typeof a?c(this,a):c(this,"none"===this.selectionMode);this.allowTextSelection=a},_handleSelect:function(a,c){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(c))&&!("dgrid-cellfocusin"===
a.type&&"mousedown"===a.parentType||a.type===t&&c!=this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=a;if(!a.keyCode||!a.ctrlKey||32==a.keyCode)if(!a.shiftKey&&a.type===s&&this.isSelected(c))this._waitForMouseUp=c;else this[this._selectionHandlerName](a,c);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(a,c){var e=a.keyCode?a.ctrlKey:a[d];this._lastSelected===c?this.select(c,null,!e||!this.isSelected(c)):(this.clearSelection(),this.select(c),this._lastSelected=
c)},_multipleSelectionHandler:function(a,c){var e=this._lastSelected,f=a.keyCode?a.ctrlKey:a[d],g;a.shiftKey||(g=f?null:!0,e=null);this.select(c,e,g);e||(this._lastSelected=c)},_extendedSelectionHandler:function(a,c){(2===a.button?!this.isSelected(c):!(a.keyCode?a.ctrlKey:a[d]))&&this.clearSelection(null,!0);this._multipleSelectionHandler(a,c)},_toggleSelectionHandler:function(a,c){this.select(c,null,null)},_initSelectionEvents:function(){var a=this,c=this.contentNode,e=this.selectionDelegate;this._selectionEventQueues=
{deselect:[],select:[]};k("touch")&&!k("pointer")&&this.selectionTouchEvents?(l(c,m.selector(e,this.selectionTouchEvents),function(c){a._handleSelect(c,this);a._ignoreMouseSelect=this}),l(c,l.selector(e,this.selectionEvents),function(c){a._ignoreMouseSelect!==this?a._handleSelect(c,this):c.type===t&&(a._ignoreMouseSelect=null)})):l(c,l.selector(e,this.selectionEvents),function(c){a._handleSelect(c,this)});this.addKeyHandler&&this.addKeyHandler(32,function(c){a._handleSelect(c,c.target)});if(this.allowSelectAll)this.on("keydown",
function(c){c[d]&&(65==c.keyCode&&!/\bdgrid-input\b/.test(c.target.className))&&(c.preventDefault(),a[a.allSelected?"clearSelection":"selectAll"]())});this._setStore&&h.after(this,"_setStore",function(){a._updateDeselectionAspect()});this._updateDeselectionAspect()},_updateDeselectionAspect:function(){function a(b,d,e){b=d||b&&b[c.idProperty||"id"];if(null!=b&&(d=(b=c.row(b))&&c.selection[b.id]))c[e](b,null,d)}var c=this,d=this.store,e,f;this._removeDeselectSignals&&this._removeDeselectSignals();
d&&d.notify?(e=h.before(d,"notify",function(c,d){c||a(c,d,"deselect")}),f=h.after(d,"notify",function(c,d){a(c,d,"select")},!0),this._removeDeselectSignals=function(){e.remove();f.remove()}):(e=h.before(this,"removeRow",function(a,b){var c;b||(c=this.row(a))&&c.id in this.selection&&this.deselect(c)}),this._removeDeselectSignals=function(){e.remove()})},allowSelect:function(a){return!0},_fireSelectionEvent:function(a){var c=this._selectionEventQueues[a],d=this._selectionTriggerEvent,e;e={bubbles:!0,
grid:this};d&&(e.parentType=d.type);e[this._selectionTargetType]=c;this._selectionEventQueues[a]=[];l.emit(this.contentNode,"dgrid-"+a,e)},_fireSelectionEvents:function(){var a=this._selectionEventQueues,c;for(c in a)a[c].length&&this._fireSelectionEvent(c)},_select:function(a,c,d){var e,f,h;"undefined"===typeof d&&(d=!0);a.element||(a=this.row(a));if(!1===d||this.allowSelect(a))if(e=this.selection,f=!!e[a.id],null===d&&(d=!f),h=a.element,!d&&!this.allSelected?delete this.selection[a.id]:e[a.id]=
d,h&&(d?g(h,".dgrid-selected"+(this.addUiClasses?".ui-state-active":"")):g(h,"!dgrid-selected!ui-state-active")),d!==f&&h&&this._selectionEventQueues[(d?"":"de")+"select"].push(a),c)if(c.element||(c=this.row(c)),c){if(c=c.element){e=this._determineSelectionDirection(h,c);e||(c=document.getElementById(c.id),e=this._determineSelectionDirection(h,c));for(;a.element!=c&&(a=this[e](a));)this._select(a,null,d)}}else this._lastSelected=h,console.warn("The selection range has been reset because the beginning of the selection is no longer in the DOM. If you are using OnDemandList, you may wish to increase farOffRemoval to avoid this, but note that keeping more nodes in the DOM may impact performance.")},
_determineSelectionDirection:k("dom-comparedocumentposition")?function(a,c){var d=c.compareDocumentPosition(a);return d&1?!1:2===d?"down":"up"}:function(a,c){return 1>c.sourceIndex?!1:c.sourceIndex>a.sourceIndex?"down":"up"},select:function(a,c,d){this._select(a,c,d);this._fireSelectionEvents()},deselect:function(a,c){this.select(a,c,!1)},clearSelection:function(a,c){this.allSelected=!1;for(var d in this.selection)a!==d&&this._select(d,null,!1);c||(this._lastSelected=null);this._fireSelectionEvents()},
selectAll:function(){this.allSelected=!0;this.selection={};for(var a in this._rowIdToObject){var c=this.row(this._rowIdToObject[a]);this._select(c.id,null,!0)}this._fireSelectionEvents()},isSelected:function(a){if("undefined"===typeof a||null===a)return!1;a.element||(a=this.row(a));return a.id in this.selection?!!this.selection[a.id]:this.allSelected&&(!a.data||this.allowSelect(a))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},
renderArray:function(){var b=this,c=this.inherited(arguments);a.when(c,function(a){var c=b.selection,d,e,f;for(d=0;d<a.length;d++)e=b.row(a[d]),(f=e.id in c?c[e.id]:b.allSelected)&&b._select(e,null,f);b._fireSelectionEvents()});return c}})})},"dgrid/Keyboard":function(){define("dojo/_base/declare dojo/aspect dojo/on dojo/_base/lang dojo/has put-selector/put ./util/misc dojo/_base/Deferred dojo/_base/sniff".split(" "),function(p,f,a,l,k,h,q,m){function g(a){a.preventDefault()}var e={checkbox:1,radio:1,
button:1},c=/\bdgrid-cell\b/,d=/\bdgrid-row\b/,r=p("dgrid.Keyboard",null,{pageSkip:10,tabIndex:0,keyMap:null,headerKeyMap:null,postMixInProperties:function(){this.inherited(arguments);this.keyMap||(this.keyMap=l.mixin({},r.defaultKeyMap));this.headerKeyMap||(this.headerKeyMap=l.mixin({},r.defaultHeaderKeyMap))},postCreate:function(){function b(a){var c=a.target;return c.type&&(!e[c.type]||32==a.keyCode)}function g(e){function k(){h._focusedHeaderNode&&(h._focusedHeaderNode.tabIndex=-1);if(h.showHeader){if(l)for(var a=
0,b,c=h.headerNode.getElementsByTagName("th");b=c[a];++a){if(n.test(b.className)){h._focusedHeaderNode=p=b;break}}else h._focusedHeaderNode=p=h.headerNode;p&&(p.tabIndex=h.tabIndex)}}var l=h.cellNavigation,n=l?c:d,r=e===h.headerNode,p=e;r?(k(),f.after(h,"renderHeader",k,!0)):f.after(h,"renderArray",function(a){return m.when(a,function(a){var b=h._focusedNode||p;if(n.test(b.className)&&q.contains(e,b))return a;for(var c=0,d=e.getElementsByTagName("*"),f;f=d[c];++c)if(n.test(f.className)){b=h._focusedNode=
f;break}b.tabIndex=h.tabIndex;return a})});h._listeners.push(a(e,"mousedown",function(a){b(a)||h._focusOnNode(a.target,r,a)}));h._listeners.push(a(e,"keydown",function(a){if(!a.metaKey&&!a.altKey){var c=h[r?"headerKeyMap":"keyMap"][a.keyCode];c&&!b(a)&&c.call(h,a)}}))}this.inherited(arguments);var h=this;this.tabableHeader&&(g(this.headerNode),a(this.headerNode,"dgrid-cellfocusin",function(){h.scrollTo({x:this.scrollLeft})}));g(this.contentNode);this._debouncedEnsureRowScroll=q.debounce(this._ensureRowScroll,
this)},removeRow:function(a){if(!this._focusedNode)return this.inherited(arguments);var b=this,c=document.activeElement===this._focusedNode,d=this[this.cellNavigation?"cell":"row"](this._focusedNode),e=d.row||d,f;a=a.element||a;if(a===e.element){f=this.down(e,!0);if(!f||f.element===a)f=this.up(e,!0);this._removedFocus={active:c,rowId:e.id,columnId:d.column&&d.column.id,siblingId:!f||f.element===a?void 0:f.id};setTimeout(function(){b._removedFocus&&b._restoreFocus(e.id)},0);this._focusedNode=null}this.inherited(arguments)},
insertRow:function(a){var b=this.inherited(arguments);this._removedFocus&&!this._removedFocus.wait&&this._restoreFocus(b);return b},_restoreFocus:function(a){var b=this._removedFocus,c;if((a=(a=a&&this.row(a))&&a.element&&a.id===b.rowId?a:"undefined"!==typeof b.siblingId&&this.row(b.siblingId))&&a.element){if(!a.element.parentNode.parentNode){b.wait=!0;return}"undefined"!==typeof b.columnId&&(c=this.cell(a,b.columnId))&&c.element&&(a=c);b.active&&0!==a.element.offsetHeight?this._focusOnNode(a,!1,
null):(h(a.element,".dgrid-focus"),a.element.tabIndex=this.tabIndex,this._focusedNode=a.element)}delete this._removedFocus},addKeyHandler:function(a,b,c){return f.after(this[c?"headerKeyMap":"keyMap"],a,b,!0)},_ensureRowScroll:function(a){var b=this.getScrollPosition().y;b>a.offsetTop?this.scrollTo({y:a.offsetTop}):b+this.contentNode.offsetHeight<a.offsetTop+a.offsetHeight&&this.scrollTo({y:a.offsetTop-this.contentNode.offsetHeight+a.offsetHeight})},_focusOnNode:function(b,e,f){var g="_focused"+(e?
"Header":"")+"Node",n=this[g],m=this.cellNavigation?"cell":"row",r=this[m](b),q,p,s,t,u;if(b=r&&r.element){if(this.cellNavigation){q=b.getElementsByTagName("input");u=0;for(s=q.length;u<s;u++)if(p=q[u],(-1!=p.tabIndex||"_dgridLastValue"in p)&&!p.disabled){8>k("ie")&&(p.style.position="relative");p.focus();8>k("ie")&&(p.style.position="");t=!0;break}}null!==f&&(f=l.mixin({grid:this},f),f.type&&(f.parentType=f.type),f.bubbles||(f.bubbles=!0));n&&(h(n,"!dgrid-focus[!tabIndex]"),8>k("ie")&&(n.style.position=
""),f&&(f[m]=this[m](n),a.emit(n,"dgrid-cellfocusout",f)));n=this[g]=b;f&&(f[m]=r);g=this.cellNavigation?c:d;!t&&g.test(b.className)&&(8>k("ie")&&(b.style.position="relative"),b.tabIndex=this.tabIndex,b.focus());h(b,".dgrid-focus");f&&a.emit(n,"dgrid-cellfocusin",f);this.cellNavigation&&((this.columnSets||1<this.subRows.length)&&!e)&&this._debouncedEnsureRowScroll(r.row.element)}},focusHeader:function(a){this._focusOnNode(a||this._focusedHeaderNode,!0)},focus:function(a){(a=a||this._focusedNode)?
this._focusOnNode(a,!1):this.contentNode.focus()}}),u=r.moveFocusVertical=function(a,b){var c=this.cellNavigation,d=this[c?"cell":"row"](a),d=c&&d.column.id,e=this.down(this._focusedNode,b,!0);c&&(e=this.cell(e,d));this._focusOnNode(e,!1,a);a.preventDefault()};p=r.moveFocusUp=function(a){u.call(this,a,-1)};var s=r.moveFocusDown=function(a){u.call(this,a,1)},t=r.moveFocusPageUp=function(a){u.call(this,a,-this.pageSkip)},b=r.moveFocusPageDown=function(a){u.call(this,a,this.pageSkip)},v=r.moveFocusHorizontal=
function(a,b){if(this.cellNavigation){var c=!this.row(a);this._focusOnNode(this.right(this["_focused"+(c?"Header":"")+"Node"],b),c,a);a.preventDefault()}},n=r.moveFocusLeft=function(a){v.call(this,a,-1)},w=r.moveFocusRight=function(a){v.call(this,a,1)},x=r.moveHeaderFocusEnd=function(a,b){var c;this.cellNavigation&&(c=this.headerNode.getElementsByTagName("th"),this._focusOnNode(c[b?0:c.length-1],!0,a));a.preventDefault()},z=r.moveHeaderFocusHome=function(a){x.call(this,a,!0)},y=r.moveFocusEnd=function(a,
b){var c=this,d=this.cellNavigation,e=this.contentNode,g=e.scrollTop+(b?0:e.scrollHeight),e=e[b?"firstChild":"lastChild"],h=-1<e.className.indexOf("dgrid-preload"),n=h?e[(b?"next":"previous")+"Sibling"]:e,r=n.offsetTop+(b?0:n.offsetHeight),q;if(h){for(;n&&0>n.className.indexOf("dgrid-row");)n=n[(b?"next":"previous")+"Sibling"];if(!n)return}!h||1>e.offsetHeight?(d&&(n=this.cell(n,this.cell(a).column.id)),this._focusOnNode(n,!1,a)):(k("dom-addeventlistener")||(a=l.mixin({},a)),q=f.after(this,"renderArray",
function(e){q.remove();return m.when(e,function(e){e=e[b?0:e.length-1];d&&(e=c.cell(e,c.cell(a).column.id));c._focusOnNode(e,!1,a)})}));g===r&&a.preventDefault()},A=r.moveFocusHome=function(a){y.call(this,a,!0)};r.defaultKeyMap={32:g,33:t,34:b,35:y,36:A,37:n,38:p,39:w,40:s};r.defaultHeaderKeyMap={32:g,35:x,36:z,37:n,39:w};return r})},"dojo/NodeList-manipulate":function(){define("./query ./_base/lang ./_base/array ./dom-construct ./dom-attr ./NodeList-dom".split(" "),function(p,f,a,l,k){function h(a){for(;a.childNodes[0]&&
1==a.childNodes[0].nodeType;)a=a.childNodes[0];return a}function q(a,e){"string"==typeof a?(a=l.toDom(a,e&&e.ownerDocument),11==a.nodeType&&(a=a.childNodes[0])):1==a.nodeType&&a.parentNode&&(a=a.cloneNode(!1));return a}var m=p.NodeList;f.extend(m,{_placeMultiple:function(a,e){for(var c="string"==typeof a||a.nodeType?p(a):a,d=[],f=0;f<c.length;f++)for(var h=c[f],k=this.length,m=k-1,b;b=this[m];m--)0<f&&(b=this._cloneNode(b),d.unshift(b)),m==k-1?l.place(b,h,e):h.parentNode.insertBefore(b,h),h=b;d.length&&
(d.unshift(0),d.unshift(this.length-1),Array.prototype.splice.apply(this,d));return this},innerHTML:function(a){return arguments.length?this.addContent(a,"only"):this[0].innerHTML},text:function(a){if(arguments.length){for(var e=0,c;c=this[e];e++)1==c.nodeType&&k.set(c,"textContent",a);return this}for(var d="",e=0;c=this[e];e++)d+=k.get(c,"textContent");return d},val:function(g){if(arguments.length){for(var e=f.isArray(g),c=0,d;d=this[c];c++){var h=d.nodeName.toUpperCase(),k=d.type,l=e?g[c]:g;if("SELECT"==
h){h=d.options;for(k=0;k<h.length;k++){var m=h[k];m.selected=d.multiple?-1!=a.indexOf(g,m.value):m.value==l}}else"checkbox"==k||"radio"==k?d.checked=d.value==l:d.value=l}return this}if((d=this[0])&&1==d.nodeType){g=d.value||"";if("SELECT"==d.nodeName.toUpperCase()&&d.multiple){g=[];h=d.options;for(k=0;k<h.length;k++)m=h[k],m.selected&&g.push(m.value);g.length||(g=null)}return g}},append:function(a){return this.addContent(a,"last")},appendTo:function(a){return this._placeMultiple(a,"last")},prepend:function(a){return this.addContent(a,
"first")},prependTo:function(a){return this._placeMultiple(a,"first")},after:function(a){return this.addContent(a,"after")},insertAfter:function(a){return this._placeMultiple(a,"after")},before:function(a){return this.addContent(a,"before")},insertBefore:function(a){return this._placeMultiple(a,"before")},remove:m.prototype.orphan,wrap:function(a){if(this[0]){a=q(a,this[0]);for(var e=0,c;c=this[e];e++){var d=this._cloneNode(a);c.parentNode&&c.parentNode.replaceChild(d,c);h(d).appendChild(c)}}return this},
wrapAll:function(a){if(this[0]){a=q(a,this[0]);this[0].parentNode.replaceChild(a,this[0]);a=h(a);for(var e=0,c;c=this[e];e++)a.appendChild(c)}return this},wrapInner:function(a){if(this[0]){a=q(a,this[0]);for(var e=0;e<this.length;e++){var c=this._cloneNode(a);this._wrap(f._toArray(this[e].childNodes),null,this._NodeListCtor).wrapAll(c)}}return this},replaceWith:function(a){a=this._normalize(a,this[0]);for(var e=0,c;c=this[e];e++)this._place(a,c,"before",0<e),c.parentNode.removeChild(c);return this},
replaceAll:function(a){a=p(a);for(var e=this._normalize(this,this[0]),c=0,d;d=a[c];c++)this._place(e,d,"before",0<c),d.parentNode.removeChild(d);return this},clone:function(){for(var a=[],e=0;e<this.length;e++)a.push(this._cloneNode(this[e]));return this._wrap(a,this,this._NodeListCtor)}});m.prototype.html||(m.prototype.html=m.prototype.innerHTML);return m})},"jimu/dijit/ImageChooser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/text!./templates/ImageChooser.html dojo/sniff dojo/request esri/lang ../utils ./_CropImage jimu/dijit/Popup jimu/dijit/Message jimu/dijit/LoadingShelter".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s){var t=0;p=p([f,a],{templateString:q,declaredClass:"jimu.dijit.ImageChooser",cropImage:!0,displayImg:null,defaultSelfSrc:null,showSelfImg:!1,label:null,showTip:!0,goldenWidth:400,goldenHeight:400,maxSize:1024,format:null,imageData:null,postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.imageChooser;this.nls.common=window.jimuNls.common;this.nls.readError=this.nls.readError||"Failed to read the file."},postCreate:function(){this._initial();
!c.file.supportHTML5()&&(!m("safari")&&c.file.isEnabledFlash())&&c.file.loadFileAPI().then(l.hitch(this,function(){k.setStyle(this.mask,"zIndex",1)}))},setImageSize:function(a){this.goldenWidth=a.width;this.goldenHeight=a.height},disableChooseImage:function(){k.setStyle(this.fileForm,"display","none");this.label&&"string"===typeof this.label&&k.addClass(this.displayText,"disable-label");k.removeAttr(this.domNode,"title")},enableChooseImage:function(){k.setStyle(this.fileForm,"display","block");this.label&&
"string"===typeof this.label&&k.removeClass(this.displayText,"disable-label");this._addTip()},setDefaultSelfSrc:function(a){this.defaultSelfSrc=a;this.imageData=this.selfImg.src=a},getImageData:function(){return this.imageData},_initial:function(){this._processProperties();this._porcessMaskClick();this._setupFileInput();this._addTip()},_processProperties:function(){this.label&&"string"===typeof this.label&&(this.displayText.innerHTML=this.label,k.setStyle(this.hintText,"display","block"));this.showSelfImg&&
k.setStyle(this.hintImage,"display","block");this.defaultSelfSrc&&(this.imageData=this.selfImg.src=this.defaultSelfSrc);if(this.format){var a="image/*";"string"===typeof this.format&&/^image\/./.test(this.format)?a=this.format:"[object Array]"===Object.prototype.toString.call(this.format)&&0<this.format.length&&(a=this.format.join(","));k.setAttr(this.fileInput,"accept",a)}!c.file.supportHTML5()&&(!m("safari")&&c.file.isEnabledFlash())&&k.setStyle(this.fileInput,{width:"100%",height:"100%",position:"absolute",
left:0,top:0,opacity:0,zIndex:9})},_porcessMaskClick:function(){k.setAttr(this.fileInput,"id","imageChooser_"+t);k.setAttr(this.mask,"for","imageChooser_"+t);t++;this.maskHandle=h(this.mask,"click",l.hitch(this,function(a){a.stopPropagation();if(m("safari")&&7>m("safari"))new u({message:this.nls.unsupportReaderAPI}),a.preventDefault();else{if(!c.file.supportHTML5()){if(!c.file.isEnabledFlash()){var d=k.create("a",{href:"http://helpx.adobe.com/flash-player.html",innerHTML:this.nls.enableFlash,target:"_blank"});
new u({message:d});a.preventDefault();return}if(!c.file.supportFileAPI()){new u({message:this.nls.unsupportReaderAPI});a.preventDefault();return}}k.setStyle(this.fileInput,"display","none");setTimeout(l.hitch(this,function(){k.setStyle(this.fileInput,"display","block")}),200)}}))},_addTip:function(){if(this.showTip){var a=e.substitute({width:this.goldenWidth||40,height:this.goldenHeight||40},this.nls.toolTip);k.setAttr(this.domNode,"title",a)}else k.setAttr(this.domNode,"title","")},_setupFileInput:function(){if(9>=
m("ie"))this.own(h(this.fileInput,"change",l.hitch(this,this._onFileInputChange)));else h.once(this.fileInput,"change",l.hitch(this,this._onFileInputChange))},_onFileInputChange:function(a){var d=a.target.files&&a.target.files[0]||a.files&&a.files[0];if(this.format&&-1===this.format.indexOf(d.type))new u({message:this.nls.invalidType}),(!m("ie")||9<m("ie"))&&this._recreateFileForm();else{var e=9>m("ie")?23552:1024*this.maxSize;c.file.readFile(a,"image/*",e,l.hitch(this,function(a,b,c){a?(b=this.nls[a.errCode],
"exceed"===a.errCode&&(b=b.replace("1024",e/1024)),new u({message:b})):window.isXT&&this.cropImage&&"image/gif"!==d.type?this._cropImageByUser(c):this._readFileData(c);(!m("ie")||9<m("ie"))&&this._recreateFileForm()}))}},_recreateFileForm:function(){var a=l.clone(this.mask),c=l.clone(this.fileInput);k.destroy(this.mask);k.destroy(this.fileInput);var d=l.clone(this.fileForm);k.place(a,d);k.place(c,d);k.place(d,this.fileForm,"replace");this.maskHandle.remove();this.mask=a;this.fileInput=c;k.destroy(this.fileForm);
this.fileForm=d;this._porcessMaskClick();this._setupFileInput()},_readFileData:function(a){this.onImageChange(a);this.displayImg&&k.setAttr(this.displayImg,"src",a);this.showSelfImg&&(this.selfImg?k.setAttr(this.selfImg,"src",a):this.selfImg.src=a)},_cropImageByUser:function(a){var c=new d({imageSrc:a,nls:l.clone(this.nls),realWidth:this.goldenWidth,realHeight:this.goldenHeight}),e=new s({hidden:!0}),f=new r({titleLabel:this.nls.cropImage,content:c,width:500,height:480,buttons:[{label:this.nls.common.ok,
onClick:l.hitch(this,function(){var d=c.getImageSize(),h=c.getCropSize();e.show();g("/webappbuilder/rest/cropimage",{data:{imageData:a,imageDisplaySize:d.w+","+d.h,cropRectangle:h.w+","+h.h+","+h.t+","+h.l},method:"POST",handleAs:"json",headers:{"X-Requested-With":null}}).then(l.hitch(this,function(a){a.success?(this._readFileData(a.imageData),f.close()):(new u({message:this.nls.unknowError}),e.hide())}),l.hitch(this,function(a){console.error(a);new u({message:this.nls.unknowError});e.hide()}))})}]});
e.placeAt(f.domNode);c.startup();k.addClass(f.domNode,"image-chooser-crop-popup")},onImageChange:function(a){this.imageData=a}});p.GIF="image/gif";p.JPEG="image/jpeg";p.PNG="image/png";return p})},"jimu/dijit/_CropImage":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_CropImage.html jimu/dijit/Message esri/lang dojo/NodeList-dom".split(" "),function(p,f,a,l,k,h,q,m,g,e){return p([h,q],{templateString:m,
inDrag:!1,inSlider:!1,realWidth:30,realHeight:30,ratio:null,imageSrc:null,_currentX:null,_currentY:null,_currentTop:0,_currentLeft:0,postCreate:function(){this._dragingHandlers=[];this.setImageSrc(this.imageSrc);this.own(l(this.ownerDocument,"mousemove",a.hitch(this,"_onMouseMove")));this.own(l(this.ownerDocument,"mouseup",a.hitch(this,"_onMouseUp")));this.loadingImg.src=require.toUrl("jimu")+"/images/loading.gif";this.own(l(this.baseImage,"load",a.hitch(this,function(){this._init();f.setStyle(this.loadingImg,
"display","none")})))},setImageSrc:function(a){f.setAttr(this.viewerImage,"src",a);f.setAttr(this.baseImage,"src",a)},getImageSize:function(){return{w:this._currentImageWidth,h:this._currentImageHeight}},getCropSize:function(){return{l:-this._currentLeft,t:-this._currentTop,w:this.idealWidth,h:this.idealHeight}},_init:function(){var c=this._getComputedStyle(this.cropSection),d=f.getContentBox(this.cropSection),h=this._getComputedStyle(this.baseImage),l=parseFloat(h.width)||this.baseImage.offsetWidth,
h=parseFloat(h.height)||this.baseImage.offsetHeight,m=l/h;this._maxImageWidth=l;this._maxImageHeight=h;if(h<this.realHeight&&l<this.realWidth)c=e.substitute({width:this.realWidth,height:this.realHeight},this.nls.cropWaining),setTimeout(a.hitch(this,function(){this.popup.close()}),50),new g({message:c});else{this.idealWidth=this.realWidth;this.idealHeight=this.realHeight;var q=this.ratio=this.ratio?this.ratio:this.realWidth/this.realHeight;1<=this.ratio?d.h*this.ratio<=d.w?(this.idealHeight=d.h,this.idealWidth=
d.h*this.ratio):(this.idealHeight=this._findProperlyValue(0,d.h,d.w-5,function(a){return a*q}),this.idealWidth=this.idealHeight*this.ratio):d.w/this.ratio<=d.h?(this.idealWidth=d.w,this.idealHeight=d.w/this.ratio):(this.idealWidth=this._findProperlyValue(0,d.w,d.h-5,function(a){return a/q}),this.idealHeight=this.idealWidth/this.ratio);f.setStyle(this.viewerBox,{width:this.idealWidth+"px",height:this.idealHeight+"px"});c=Math.abs((parseFloat(c.height)-this.idealHeight)/2);f.setStyle(this.cropSection,
{paddingTop:c+"px",paddingBottom:c+"px"});1<=m?this.idealHeight*m>=this.idealWidth?(f.setStyle(this.viewerImage,"height",this.idealHeight+"px"),f.setStyle(this.baseImage,"height",this.idealHeight+"px")):(c=this._findProperlyValue(0,this.idealWidth,this.idealWidth,function(a){return a*m}),f.setStyle(this.viewerImage,"height",c+"px"),f.setStyle(this.baseImage,"height",c+"px")):this.idealWidth/m>=this.idealHeight?(f.setStyle(this.viewerImage,"width",this.idealWidth+"px"),f.setStyle(this.baseImage,"width",
this.idealWidth+"px")):(c=this._findProperlyValue(0,this.idealHeight,this.idealHeight,function(a){return a/m}),f.setStyle(this.viewerImage,"width",c+"px"),f.setStyle(this.baseImage,"width",c+"px"));k(".hide-status",this.domNode).removeClass("hide-status");h=this._getComputedStyle(this.baseImage);l=parseFloat(h.width)||this.baseImage.offsetWidth;h=parseFloat(h.height)||this.baseImage.offsetHeight;this._minImageWidth=l;this._minImageHeight=h;this._currentImageWidth=l;this._currentImageHeight=h;this._currentTop=
-(h-this.idealHeight)/2;this._currentLeft=-(l-this.idealWidth)/2;f.setStyle(this.baseImage,{top:this._currentTop+"px",left:this._currentLeft+"px"});f.setStyle(this.viewerImage,{top:this._currentTop+"px",left:this._currentLeft+"px"});this._zoomRatio=this._maxImageWidth/this._minImageWidth;1>=this._zoomRatio&&f.addClass(this.zoomInBtn,"disable-zoom");f.addClass(this.zoomOutBtn,"disable-zoom");this._latestPercentage=window.isRTL?100:0}},_findProperlyValue:function(a,d,e,f,g){g=isFinite(g)?parseFloat(g):
1;e=0>e-g||0>e+g?g:e;var h=(a+d)/2,b=f(h);if(b<=e+g&&b>=e-g)return h;if(b>e)return this._findProperlyValue(a,h,e,f);if(b<e)return this._findProperlyValue(h,d,e,f)},_getComputedStyle:function(a){a=f.getMarginBox(a);return{width:a.w,height:a.h,left:a.l,top:a.t}},_onViewerMouseDown:function(a){var d=this._getComputedStyle(this.baseImage),e=this._getComputedStyle(this.viewerContent);this._maxOffsetLeft=parseFloat(e.width)-parseFloat(d.width);this._maxOffsetTop=parseFloat(e.height)-parseFloat(d.height);
this._maxOffsetLeft=0<this._maxOffsetLeft?0:this._maxOffsetLeft;this._maxOffsetTop=0<this._maxOffsetTop?0:this._maxOffsetTop;this.inDrag=!0;this._currentX=a.clientX;this._currentY=a.clientY;this._stopSelect()},_stopSelect:function(){this._dragingHandlers=this._dragingHandlers.concat([l(this.ownerDocument,"dragstart",function(a){a.stopPropagation();a.preventDefault()}),l(this.ownerDocumentBody,"selectstart",function(a){a.stopPropagation();a.preventDefault()})])},_removeStopSelect:function(){for(var a=
this._dragingHandlers.pop();a;)a.remove(),a=this._dragingHandlers.pop()},_onViewerMouseUp:function(a){this.inDrag&&(this.inDrag=!1,this._resetImagePosition(a.clientX,a.clientY),this._removeStopSelect(),a.stopPropagation())},_onSliderMouseDown:function(a){if(!(1>=this._zoomRatio)){this.inSlider=!0;this._currentX=a.clientX;this._currentY=a.clientY;var d=f.position(this.sliderNode);this._startSliderLeft=d.x;this._sliderWidth=d.w;this._stopSelect();a.stopPropagation()}},_onSliderMouseUp:function(a){if(!(1>=
this._zoomRatio)&&this.inSlider){this.inSlider=!1;this._resetSliderButtonPosition(a.clientX);var d=this._getComputedStyle(this.baseImage);this._currentLeft=parseFloat(d.left);this._currentTop=parseFloat(d.top);this._latestPercentage=100*((a.clientX-this._startSliderLeft)/this._sliderWidth);this._latestPercentage=this._normalizePercentage(this._latestPercentage);this._removeStopSelect();a.stopPropagation()}},_onMouseMove:function(a){this.inDrag&&this._resetImagePosition(a.clientX,a.clientY);this.inSlider&&
!(1>=this._zoomRatio)&&this._resetSliderButtonPosition(a.clientX,a.clientY)},_onMouseUp:function(a){this.inDrag&&this._onViewerMouseUp(a);this.inSlider&&this._onSliderMouseUp(a)},_onZoomOutClick:function(){1>=this._zoomRatio||this._zoomImage("out")},_onZoomInClick:function(){1>=this._zoomRatio||this._zoomImage("in")},_zoomImage:function(a){var d=0;this._latestPercentage=this._normalizePercentage(this._latestPercentage);"in"===a?d=window.isRTL?this._latestPercentage-20:this._latestPercentage+20:"out"===
a&&(d=window.isRTL?this._latestPercentage+20:this._latestPercentage-20);a=this._normalizePercentage(d);this._moveSliderButton(a,this._latestPercentage);this._latestPercentage=a;a=this._getComputedStyle(this.baseImage);this._currentLeft=parseFloat(a.left);this._currentTop=parseFloat(a.top)},_resetImagePosition:function(a,d){var e=a-this._currentX,g=d-this._currentY;0<=this._currentTop+g?(f.setStyle(this.baseImage,"top",0),f.setStyle(this.viewerImage,"top",0),this._currentY=d,this._currentTop=0):this._currentTop+
g<=this._maxOffsetTop?(f.setStyle(this.baseImage,"top",this._maxOffsetTop+"px"),f.setStyle(this.viewerImage,"top",this._maxOffsetTop+"px"),this._currentY=d,this._currentTop=this._maxOffsetTop):(f.setStyle(this.baseImage,"top",this._currentTop+g+"px"),f.setStyle(this.viewerImage,"top",this._currentTop+g+"px"),this._currentY=d,this._currentTop+=g);0<=this._currentLeft+e?(f.setStyle(this.baseImage,"left",0),f.setStyle(this.viewerImage,"left",0),this._currentX=a,this._currentLeft=0):this._currentLeft+
e<=this._maxOffsetLeft?(f.setStyle(this.baseImage,"left",this._maxOffsetLeft+"px"),f.setStyle(this.viewerImage,"left",this._maxOffsetLeft+"px"),this._currentX=a,this._currentLeft=this._maxOffsetLeft):(f.setStyle(this.baseImage,"left",this._currentLeft+e+"px"),f.setStyle(this.viewerImage,"left",this._currentLeft+e+"px"),this._currentX=a,this._currentLeft+=e)},_normalizePercentage:function(a){a=0>a?0:a;return 100<a?100:a},_resetSliderButtonPosition:function(a){a=100*((a-this._startSliderLeft)/this._sliderWidth);
a=this._normalizePercentage(a);this._moveSliderButton(a,this._latestPercentage)},_moveSliderButton:function(a,d){0>=a?f.addClass(this.zoomOutBtn,"disable-zoom"):f.removeClass(this.zoomOutBtn,"disable-zoom");100<=a?f.addClass(this.zoomInBtn,"disable-zoom"):f.removeClass(this.zoomInBtn,"disable-zoom");f.setStyle(this.sliderButton,"left",a+"%");window.isRTL&&(a=100-a,d=100-d);var e=this._minImageWidth*(this._zoomRatio-1)*a/100,g=this._minImageHeight*(this._zoomRatio-1)*a/100,h=this._getComputedStyle(this.baseImage);
this._currentLeft=parseFloat(h.left);this._currentTop=parseFloat(h.top);var h=(Math.abs(this._currentLeft)+this.idealWidth/2)*((this._minImageWidth+e)/this._currentImageWidth-1),k=(Math.abs(this._currentTop)+this.idealHeight/2)*((this._minImageWidth+e)/this._currentImageWidth-1);f.setStyle(this.baseImage,{width:this._minImageWidth+e+"px",height:this._minImageHeight+g+"px"});f.setStyle(this.viewerImage,{width:this._minImageWidth+e+"px",height:this._minImageHeight+g+"px"});this._currentImageWidth=this._minImageWidth+
e;this._currentImageHeight=this._minImageHeight+g;if(0<=a-d)f.setStyle(this.baseImage,{top:this._currentTop-k+"px",left:this._currentLeft-h+"px"}),f.setStyle(this.viewerImage,{top:this._currentTop-k+"px",left:this._currentLeft-h+"px"});else{var b=0,l=0,b=0<=this._currentTop-k?0:this._currentTop-k+this._minImageHeight+g<=this.idealHeight?this.idealHeight-this._minImageHeight-g:this._currentTop-k,l=0<=this._currentLeft-h?0:this._currentLeft-h+this._minImageWidth+e<=this.idealWidth?this.idealWidth-this._minImageWidth-
e:this._currentLeft-h;f.setStyle(this.baseImage,{top:b+"px",left:l+"px"});f.setStyle(this.viewerImage,{top:b+"px",left:l+"px"})}this._latestPercentage=a}})})},"builder/dijit/template-config/utils":function(){define("dojo/_base/lang dojo/Deferred jimu/utils jimu/dijit/Message jimu/WidgetManager dojo/promise/all dojo/json builder/serviceUtils".split(" "),function(p,f,a,l,k,h,q,m){return{loadAllWidgetConfigs:function(g){var e=new f,c=[];g.visitElement(function(d){if(d.uri){var e=k.getInstance().tryLoadWidgetConfig(d).then(function(c){c&&
(d.config=c,g._originConfig&&(a.getConfigElementById(g._originConfig,d.id).config=c))});c.push(e)}});h(c).then(function(){e.resolve(g)},function(a){e.reject(a)});return e},saveAgolTemplate:function(a,e,c){var d=new f,h={itemId:c?c:this.app.agolTemplateInfo?this.app.agolTemplateInfo.itemId:null,json:e};m.saveAgolTemplate(this.app,h).then(p.hitch(this,function(){this.app.agolTemplateInfo=h;this.lastTemplateJson=this.categoryManager.getTemplateJson();d.resolve()}),function(a){new l({message:a});d.reject()});
return d}}})},"builder/plugins/app-list/_build-generate_module":function(){define(["builder/plugins/app-list/Plugin","dojo/text!builder/plugins/app-list/Plugin.html","dojo/text!builder/plugins/app-list/css/style.css","dojo/i18n!builder/plugins/app-list/nls/strings"],function(){})},"builder/plugins/app-list/Plugin":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/array dojo/_base/Deferred dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html dojo/on dojo/_base/lang dojo/query dojo/topic ./Import ./AppCatalogPage ./CardPageWithBigThumbnail ./CardPageWithSmallThumbnail builder/serviceUtils jimu/dijit/LoadingShelter jimu/utils builder/BasePlugin esri/lang dojox/form/Uploader dojo/NodeList-dom".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n){var w=p([v,k],{baseClass:"plugin-app-list",templateString:h,label:"applist",apps:null,templates:null,_appPages:null,_tempaltePage:null,_appPageState:null,_tempaltePageState:null,_currentPageState:null,_refreshImageFlag:null,postMixInProperties:function(){this.inherited(arguments);this.nls=m.mixin(this.nls,builderNls)},constructor:function(){this.apps=[];this.templates=[];this._appPages=[];this._appPageState={name:w.APP_PAGE,shownType:w.APP_TYPE_ALL,
sortBy:w.SORT_BY_MODIFIED_TIME,searchKey:""};this._tempaltePageState={name:w.TEMPLATE_PAGE,shownType:w.APP_TYPE_ALL,sortBy:w.SORT_BY_MODIFIED_TIME,searchKey:""};this._currentPageState=this._appPageState;this._refreshImageFlag=new Date},startup:function(){this.inherited(arguments);this.loading=new t({hidden:!0});this.loading.placeAt(this.domNode);this.importDijit=(new c({appListWidget:this})).placeAt(this.importBtn);var a=new r({appListWidget:this});this._addAppPage(a,"card-page2",this.nls.gridView);
a=new d({appListWidget:this});this._addAppPage(a,"catalog-page",this.nls.listView);this.refreshAppPage();this._tempaltePage=new u({appListWidget:this});this._tempaltePage.placeAt(this.templateContent);this.refreshTemplatePage();this._bindEvent()},_addAppPage:function(a,b,c){var d=f.create("div",{"class":"app-page-box"},this.appContent);a.placeAt(d);var e=f.create("div",{"class":"switch-app-page-btn jimu-float-leading "+b,title:c},this.switchAppPapgeBox);this.own(q(e,"click",m.hitch(this,function(){g(".app-page-box",
this.contentBox).removeClass("selected");f.addClass(d,"selected");g(".switch-app-page-btn",this.switchAppPapgeBox).removeClass("selected");f.addClass(e,"selected")})));0===this._appPages.length&&(f.addClass(d,"selected"),f.addClass(e,"selected"));this._appPages.push(a)},refreshAppPage:function(b){var c=new l;b?c.resolve():this.getAppList().then(m.hitch(this,function(a){this._currentPageState.sortBy!==w.SORT_BY_MODIFIED_TIME&&(a=this._sort(a));this.initApps(a);c.resolve()}));c.then(m.hitch(this,function(){var b=
this.filter(this.apps),c=this.filter(this.templates);a.forEach(this._appPages,function(a){a.refresh(b,c)},this)}))},refreshTemplatePage:function(a){var b=new l;a?b.resolve():this.getTemplateList().then(m.hitch(this,function(a){this._currentPageState.sortBy!==w.SORT_BY_MODIFIED_TIME&&(a=this._sort(a));this.initTemplates(a);b.resolve()}));b.then(m.hitch(this,function(){var a=this.filter(this.templates);this._tempaltePage.refresh(a)}))},refreshCurrentPage:function(a,b){this._currentPageState.name===
w.APP_PAGE?this.refreshAppPage(a):this._currentPageState.name===w.TEMPLATE_PAGE&&this.refreshTemplatePage(b)},getRefreshImageFlag:function(){return this._refreshImageFlag.getTime()},resetRefreshImageFlag:function(){this._refreshImageFlag=new Date},initApps:function(a){this.apps=this._filterItemByCondition(a);this.apps=this._mixinExtraProperties(this.apps)},initTemplates:function(a){this.templates=this._filterItemByCondition(a);this.templates=this._mixinExtraProperties(this.templates)},setApps:function(a){this.apps=
a},setTemplates:function(a){this.templates=a},_filterItemByCondition:function(b){var c=[];return c=a.filter(b,function(a){return!window.isPortalSupport3D&&a.appType===w.APP_TYPE_3D?!1:!0},this)},_mixinExtraProperties:function(b){a.forEach(b,function(a){!a.isTemplate&&!a.icon&&(a.icon=a.themeName?"/webappbuilder/apps/"+a.id+"/themes/"+a.themeName+"/images/icon.png":"/webappbuilder/builder/images/logo.png",a._defaultIconClass="default-icon");a.downloadUrl="/webappbuilder/rest/apps/"+a.id+"/download";
var b="stemapp/index.html?id\x3d"+a.id;a.isPredefined&&(b+="\x26ispredefined\x3dtrue");a.appUrl=b;a.styleColor||(a.styleColor=w.DEFAULT_APP_STYLE_COLOR);a.id===w.ID_OF_BASIC_VIEWER_TEMPLATE?a.description=this.nls.basicViewerTemplateDesc:a.id===w.ID_OF_EDITOR_TEMPLATE?a.description=this.nls.editorTemplateDesc:a.id===w.ID_OF_SIMPLE_MAP_VIEWER_TEMPLATE&&(a.description=this.nls.simpleMapViewerTemplateDesc)},this);return b},getAppList:function(){return s.getAppList()},getTemplateList:function(){return s.getTemplateList().then(function(b){return a.filter(b,
function(a){return a.isTemplate})})},updateApp:function(a){return s.updateApp(a)},_getLocaleDateTime:function(a){return b.localizeDate(new Date(a),{fullYear:!0,selector:"date",formatLength:"medium"})},filter:function(a){a=this._filterByType(a);return a=this._filterBySearch(a)},_filterByType:function(b){var c=[];return c=this._currentPageState.shownType===w.APP_TYPE_ALL?b:a.filter(b,function(a){return a.appType===this._currentPageState.shownType},this)},_filterBySearch:function(b){var c=[],d=this._currentPageState.searchKey.toLowerCase();
return d?(a.forEach(b,function(a){0<=(a.name+" "+a.description+""+this._getLocaleDateTime(a.lastUpdated)+" "+a.creator+" "+a.modified).toLowerCase().indexOf(d)&&c.push(a)},this),c):b},_sort:function(a){var b=this._currentPageState.sortBy;a.sort(function(a,c){return a[b]&&c[b]?b===w.SORT_BY_MODIFIED_TIME?a[b]>c[b]?-1:1:a[b]<c[b]?-1:1:a[b]?-1:1});return a},_resetAppStateUI:function(){g(".filter",this.filterBox).removeClass("selected");var a=g("#"+this._currentPageState.shownType,this.filterBox)[0];
a&&f.addClass(a,"selected");g(".sort",this.sortBox).removeClass("selected");(a=g("#"+this._currentPageState.sortBy,this.sortBox)[0])&&f.addClass(a,"selected");this.searchBox.setValue(this._currentPageState.searchKey)},_addEmptyDescription:function(a,b){var c=f.create("div",{"class":"empty-description-box "+(b?b:"")},a),d=this.nls.appCreate,e=n.substitute({action:"\x3cspan\x3e"+d+"\x3c/span\x3e"},this.nls.emptyDescForCreate),d=this.nls.appImport,d=n.substitute({action:"\x3cspan\x3e"+d+"\x3c/span\x3e"},
this.nls.emptyDescForImport);f.create("div",{"class":"empty-description",innerHTML:e+"\x3cbr\x3e"+d},c)},_bindEvent:function(){this.own(e.subscribe("switchToAppListApps",m.hitch(this,this._onSwitchToAppContent)));this.own(e.subscribe("switchToAppListTemplates",m.hitch(this,this._onSwitchToTemplateContent)))},_onSwitchToAppContent:function(){f.removeClass(this.templateContent,"selected");f.addClass(this.appContent,"selected");this._currentPageState=this._appPageState;this._resetAppStateUI();f.removeClass(this.switchAppPapgeBox,
"hidden");f.setStyle(this.importDijit.itemImportBtn,"display","block");f.setStyle(this.createNewBtn,"display","block");f.setStyle(this.sortByAuthorBtn,"display","none")},_onSwitchToTemplateContent:function(){f.removeClass(this.appContent,"selected");f.addClass(this.templateContent,"selected");this._currentPageState=this._tempaltePageState;this._resetAppStateUI();f.addClass(this.switchAppPapgeBox,"hidden");f.setStyle(this.importDijit.itemImportBtn,"display","none");f.setStyle(this.createNewBtn,"display",
"none");f.setStyle(this.sortByAuthorBtn,"display","block")},_onSearchBoxChange:function(){this._currentPageState.searchKey=this.searchBox.getValue();this.refreshCurrentPage(!0,!0)},_filterAllBtnClick:function(){this._filterAppTypeBtnClick(this.filterAllBtn,w.APP_TYPE_ALL)},_filter2dBtnClick:function(){this._filterAppTypeBtnClick(this.filter2dBtn,w.APP_TYPE_2D)},_filter3dBtnClick:function(){this._filterAppTypeBtnClick(this.filter3dBtn,w.APP_TYPE_3D)},_filterAppTypeBtnClick:function(a,b){this._currentPageState.shownType!==
b&&(g(".filter",this.filterBox).removeClass("selected"),f.addClass(a,"selected"),this._currentPageState.shownType=b,this.refreshCurrentPage(!0,!0))},_sortByModifiedTimeBtnClick:function(){this._sortBtnClick(this.sortByModifiedTimeBtn,w.SORT_BY_MODIFIED_TIME)},_sortByNameBtnClick:function(){this._sortBtnClick(this.sortByNameBtn,w.SORT_BY_NAME)},_sortByAuthorBtnClick:function(){this._sortBtnClick(this.sortByAuthorBtn,w.SORT_BY_AUTHOR)},_sortBtnClick:function(a,b){this._currentPageState.sortBy!==b&&
(this._currentPageState.sortBy=b,g(".sort",this.sortBox).removeClass("selected"),f.addClass(a,"selected"),this._currentPageState.name===w.APP_PAGE?this.setApps(this._sort(this.apps)):this._currentPageState.name===w.TEMPLATE_PAGE&&this.setTemplates(this._sort(this.templates)),this.refreshCurrentPage(!0,!0))},_onCreateClick:function(){var a=this.pluginManager.getExtensions("startup.creation-entry")[0],a=this.pluginsMeta[a.pluginName];this.loading.show("");this.pluginManager.loadPlugin(a).then(m.hitch(this,
function(a){a.popupNewCreateDlg();this.loading.hide()}),m.hitch(this,function(){this.loading.hide()}))}});m.mixin(w,{APP_TYPE_ALL:"ALL",APP_TYPE_2D:"HTML",APP_TYPE_3D:"HTML3D",SORT_BY_MODIFIED_TIME:"lastUpdated",SORT_BY_NAME:"name",SORT_BY_AUTHOR:"creator",APP_PAGE:"appPage",TEMPLATE_PAGE:"templatePage",DEFAULT_APP_STYLE_COLOR:"#596679",ID_OF_BASIC_VIEWER_TEMPLATE:"HTML_basic_viewer",ID_OF_EDITOR_TEMPLATE:"HTML_editor",ID_OF_SIMPLE_MAP_VIEWER_TEMPLATE:"HTML_simple_map_viewer"});return w})},"builder/plugins/app-list/Import":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./Import.html dojo/on dojo/_base/lang dojo/sniff builder/serviceUtils dojo/query jimu/dijit/Message jimu/dijit/ItemSelector jimu/dijit/Popup builder/portalUtils esri/lang builder/dijit/FullScreenPopup dojox/form/Uploader dojo/NodeList-dom".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b){return p([a,l,k],{baseClass:"import-app",templateString:h,_itemSelector:null,_importPopup:null,nls:null,postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading},startup:function(){this.inherited(arguments);this.own(q(window.document,"click",m.hitch(this,function(a){a.clickFromSelf||setTimeout(m.hitch(this,function(){f.setStyle(this.actionsMenu,"display","none");window.isRTL?f.setStyle(this.actionsMenu,
{left:"auto",right:0}):f.setStyle(this.actionsMenu,{right:"auto",left:0});f.removeClass(this.actionsNode,"actions-drop-down")}),50)})));this._applyZipToFileInput();this.appPortalUrlInputNode&&(this.appPortalUrlInputNode.value=window.portalUrl);this._keepFileChooserOverItem()},_applyZipToFileInput:function(){c('input[type\x3d"file"]',this.appFileInputNode.domNode).forEach(m.hitch(this,function(a){f.setAttr(a,"accept",".zip")}))},_keepFileChooserOverItem:function(){9>=g("ie")&&c("span.dijitUploader input:first-child",
this.domNode).forEach(m.hitch(this,function(a){window.isRTL?f.setStyle(a,{left:"33px",right:"auto"}):f.setStyle(a,"right","33px")}))},_onActionsLabelClick:function(a){var b=f.getMarginBox(window.jimuConfig.layoutId),c=null;"none"===f.getStyle(this.actionsMenu,"display")?(f.setStyle(this.actionsMenu,"display","block"),c=f.position(this.actionsMenu),window.isRTL?0>c.x&&f.setStyle(this.actionsMenu,{right:"auto",left:0}):c.x+c.w>b.w&&f.setStyle(this.actionsMenu,{left:"auto",right:0})):(f.setStyle(this.actionsMenu,
"display","none"),f.position(this.actionsMenu),window.isRTL?f.setStyle(this.actionsMenu,{left:"auto",right:0}):f.setStyle(this.actionsMenu,{right:"auto",left:0}));a.clickFromSelf=!0},_onMenuItemClick:function(a){setTimeout(m.hitch(this,function(){f.setStyle(this.actionsMenu,"display","none");f.removeClass(this.actionsNode,"actions-drop-down");a.stopPropagation()}),50)},_onAppFileUploadError:function(a){console.error(a);new d({message:a.message||a});this._keepFileChooserOverItem();this._applyZipToFileInput();
this.loading.hide()},_onAppFileUploadComplete:function(a){a.success?(this._refreshAppOrTemplatePage(),this._keepFileChooserOverItem(),this._applyZipToFileInput(),this.loading.hide()):this._onAppFileUploadError(a)},_onAppFileChange:function(){var a=this.appFileInputNode.getFileList();a&&0<a.length&&(/.+(\.zip)$/.test(a[0].name)?(this.loading.show(this.nls.uploading),s.getPortal(window.portalUrl).getUser().then(m.hitch(this,function(a){f.setAttr(this.appFileCreatorInputNode,"value",a.username);f.setAttr(this.fromListNode,
"value",this._currentShownList);this.appFileInputNode.submit(this.uploadAppFileFormNode)}),function(a){console.error(a);new d({message:a.message||a});this.loading.hide()})):new d({message:this.nls.fileTypeError}))},_onImportClick:function(){this._itemSelector=new r({portalUrl:window.portalUrl,itemTypes:["Web Mapping Application"],onlyShowOnlineFeaturedItems:!1,typeKeywords:["Web AppBuilder"],showOnlineItems:!1});this.own(q(this._itemSelector,"item-selected",m.hitch(this,function(){this._importPopup.enableButton(0)})));
this.own(q(this._itemSelector,"none-item-selected",m.hitch(this,function(){this._importPopup.disableButton(0)})));var a=c("#main-page")[0];this._importPopup=new b({zIndex:101,titleStr:this.nls.importApp,blurContainer:a.firstElementChild,content:this._itemSelector.domNode,buttons:[{label:this.nls.ok,isHighLight:!0,onClick:m.hitch(this,this._onImportOkClick)},{label:this.nls.cancel,isHighLight:!1,onClick:m.hitch(this,this._onImportCancelClick)}],contentAutoHeight:!0});this._importPopup.placeAt(a);this._importPopup.show();
this._importPopup.disableButton(0);this._itemSelector.startup();this.own(q(this._itemSelector.tab,"tabChanged",m.hitch(this,function(){window.setTimeout(m.hitch(this,function(){this._importPopup.resize()},100))})));this.own(q(this._itemSelector,"update",m.hitch(this,function(){this._importPopup.resize()})))},_onImportOkClick:function(){var a=this._itemSelector.getSelectedItem();this.loading.show();s.getPortal(window.portalUrl).getUser().then(m.hitch(this,function(b){a.getItemData().then(m.hitch(this,
function(c){this.loading.hide();this._importPopup.close();c=m.clone(c);this._checkAppVersion(c,{creator:b.username,name:a.title,description:a.description||"",appType:a.typeKeywords&&0<=a.typeKeywords.indexOf("WAB3D")?"HTML3D":"HTML",stemappPath:this.appListWidget.pluginManager.getStemappInfo("HTML").appPath,portalUrl:window.portalUrl,isTemplate:!1,isTemplateApp:!1,isPredefined:!1})}),m.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))}),m.hitch(this,function(b){this.loading.hide();
this._checkAppInfoError(a.title,b)}))},_checkAppVersion:function(a,b){this.loading.show(this.nls.importing);e.checkAppVersion(a,b).then(m.hitch(this,function(c){this.loading.hide();c=c.versionInfo;"old"===c.wabVersionStatus?this._doAction("upgrade",a,b):"new"===c.wabVersionStatus?this._showNewer(b.appName,c.appVersion):"same"===c.wabVersionStatus&&this._doAction("import",a,b)}),m.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))},_checkAppInfoError:function(a,b){new d({message:t.substitute({APP_NAME:a},
this.nls.checkVersionError)});console.error(b)},_showUpgrade:function(a,b,c){c="\x3cdiv style\x3d'font-size:14px;'\x3e"+t.substitute({OLD_VERSION:c.appVersion,LATEST_VERSION:c.latestVersion},this.nls.upgradeContent)+"\x3cdiv style\x3d'height:24px;'\x3e\x3c/div\x3e"+this.nls.upgradeContentFooter+"\x3c/div\x3e";var d=new u({titleLabel:this.nls.upgradeApp,content:f.toDom(c),width:640,autoHeight:!0,buttons:[{label:this.nls.upgradeBtn,onClick:m.hitch(this,function(){d.close();this._doAction("upgrade",
a,b)})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:m.hitch(this,function(){d.close()})}]})},_showNewer:function(a,b){var c="\x3cdiv style\x3d'font-size:14px;'\x3e"+t.substitute({APP_NAME:a,VERSION_NUMBER:b},this.nls.importUpperVertion)+"\x3c/div\x3e";new u({titleLabel:this.nls.importApp,content:f.toDom(c),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]})},_doAction:function(a,b,c){"import"===a?this.loading.show(this.nls.importing):"upgrade"===a&&this.loading.show(this.nls.upgrading);
e.importPortalApp(b,c).then(m.hitch(this,function(){this._importSuccess(c.appName)}),m.hitch(this,function(a){this.loading.hide();this._importError(c.appName,a)}))},_importSuccess:function(a){this.appListWidget.getAppList().then(m.hitch(this,function(){this._refreshAppOrTemplatePage();var b="\x3cdiv style\x3d'font-size:14px;'\x3e"+t.substitute({APP_NAME:a},this.nls.importSuccess)+"\x3c/div\x3e";new u({titleLabel:this.nls.importApp,content:f.toDom(b),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]})}),
m.hitch(this,function(a){console.error(a)})).always(m.hitch(this,function(){this.loading.hide()}))},_importError:function(a,b){var c="\x3cdiv style\x3d'font-size:14px;'\x3e"+t.substitute({APP_NAME:a},this.nls.upgradeFailure)+"\x3c/div\x3e";new u({titleLabel:this.nls.importApp,content:f.toDom(c),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]});console.error(b)},_onImportCancelClick:function(){this._importPopup.close()},_refreshAppOrTemplatePage:function(){this.appListWidget.refreshTemplatePage();
this.appListWidget.refreshAppPage()}})})},"jimu/dijit/ItemSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemSelector.html dojo/Evented dojo/_base/lang dojo/_base/config dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/promise/all dojo/query dojo/on jimu/utils jimu/portalUtils jimu/tokenUtils jimu/portalUrlUtils jimu/dijit/ViewStack jimu/dijit/Search jimu/dijit/TabContainer3 jimu/dijit/_ItemTable".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y){return p([a,l,k,q],{templateString:h,declaredClass:"jimu.dijit.ItemSelector",baseClass:"jimu-item-selector",tab:null,_user:null,_group:null,_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_isPublicTabShow:!1,_signIn:!1,_itemTypeQueryString:"",
_typeKeywordQueryString:"",portalUrl:null,itemTypes:"",typeKeywords:"",showOnlineItems:!0,onlyShowOnlineFeaturedItems:!1,postMixInProperties:function(){this.portalUrl=n.getStandardPortalUrl(this.portalUrl);this.showOnlineItems=!1===this.showOnlineItems?!1:!0;this.itemTypes&&0<this.itemTypes.length||(this.itemTypes=[]);this._itemTypes="";e.forEach(this.itemTypes,m.hitch(this,function(a,b){this._itemTypes+='"'+a+'"';b!==this.itemTypes.length-1&&(this._itemTypes+=",")}));this._itemTypes="["+this._itemTypes+
"]";this.typeKeywords&&0<this.typeKeywords.length||(this.typeKeywords=[]);this._typeKeywords="";e.forEach(this.typeKeywords,m.hitch(this,function(a,b){this._typeKeywords+='"'+a+'"';b!==this.typeKeywords.length-1&&(this._typeKeywords+=",")}));this._typeKeywords="["+this._typeKeywords+"]";this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);var a=this._getPortalUrl();this.portal=b.getPortal(a);this._initOptions();this._initSearchQuery();this._initTabs();this._initPortalRadio();
this._initItemTables();this._initPublic();this._initPrivate();this._updateUIbySignIn()},_initOptions:function(){this._itemTypeQueryString=t.getItemQueryStringByTypes(this.itemTypes);this._typeKeywordQueryString=t.getItemQueryStringByTypeKeywords(this.typeKeywords)},_initTabs:function(){this.tab=new z({tabs:[{title:this.nls.myContent,content:this.mycontentTabNode},{title:this.nls.myOrganization,content:this.organizationTabNode},{title:this.nls.myGroup,content:this.groupTabNode},{title:this.nls.publicMap,
content:this.publicTabNode}]},this.tabNode);this.own(s(this.tab,"tabChanged",m.hitch(this,function(a){c.setStyle(this.signinSection,"display","none");a!==this.nls.publicMap?(this._isPublicTabShow=!1,this._updateUIbySignIn()):this._isPublicTabShow=!0})))},_updateUIbySignIn:function(){c.setStyle(this.signinSection,"display","none");var a=u(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",this.domNode);v.userHaveSignInPortal(this._getPortalUrl())?a.style("display",
"block"):(a.style("display","none"),this._isPublicTabShow||c.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){t.combineRadioCheckBoxWithLabel(this.portalPublicRaido,this.portalPublicLabel);t.combineRadioCheckBoxWithLabel(this.onlinePublicRaido,this.onlinePublicLabel);var a=this._getPortalUrl(),a=n.getServerByUrl(a);this.portalPublicRaido.disabled=!1;this.onlinePublicRaido.disabled=!1;this.portalPublicRaido.checked=!0;var b=!1;n.isArcGIScom(a)?(b=!0,this.portalPublicLabel.innerHTML=
"ArcGIS.com"):(this.portalPublicLabel.innerHTML=a,b=this.showOnlineItems?!1:!0);b&&(this.onlinePublicRaido.disabled=!0,c.setStyle(this.onlinePublicRaido,"display","none"),c.setStyle(this.onlinePublicLabel,"display","none"))},_initSearchQuery:function(){var a="esri_"+(g.locale&&g.locale.slice(0,2)||"en").toLowerCase(),b=e.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),
m.hitch(this,function(b){return b!==a})),c="";e.forEach(b,m.hitch(this,function(a){c+=" -owner:"+a+" "}));b=" ";this.portal&&(this.portal.user&&this.portal.user.orgId)&&(b=" orgid:"+this.portal.user.orgId+" ");b=b+this._itemTypeQueryString+" AND access:public "+c+" "+this._typeKeywordQueryString;this._allPublicPortalQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:b});this._filterPublicPortalQuery=this._getQuery({q:b,basicQ:b});this._allPublicOnlineQuery=this._getQuery({sortField:"numViews",
sortOrder:"desc",q:(this.onlyShowOnlineFeaturedItems?' (group:"c755678be14e4a0984af36a15f5b643e"  OR group:"b8787a74b4d74f7fb9b8fac918735153") ':" ")+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._filterPublicOnlineQuery=this._getQuery({q:this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=
this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return m.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return n.getStandardPortalUrl(this.portalUrl)},_initItemTables:function(){"function"===typeof this.onCreateItemContent&&(this.mycontentItemTable.onCreateItemContent=this.onCreateItemContent,this.organizationItemTable.onCreateItemContent=this.onCreateItemContent,this.groupItemTable.onCreateItemContent=this.onCreateItemContent,
this.publicPortalItemTable.onCreateItemContent=this.onCreateItemContent,this.publicOnlineItemTable.onCreateItemContent=this.onCreateItemContent);this.own(s(this.publicPortalItemTable,"item-dom-clicked",m.hitch(this,this._onItemDomClicked)));this.own(s(this.publicOnlineItemTable,"item-dom-clicked",m.hitch(this,this._onItemDomClicked)));this.own(s(this.organizationItemTable,"item-dom-clicked",m.hitch(this,this._onItemDomClicked)));this.own(s(this.groupItemTable,"item-dom-clicked",m.hitch(this,this._onItemDomClicked)));
this.own(s(this.mycontentItemTable,"item-dom-clicked",m.hitch(this,this._onItemDomClicked)));this.own(s(this.publicPortalItemTable,"update",m.hitch(this,this._onItemTableUpdate)));this.own(s(this.publicOnlineItemTable,"update",m.hitch(this,this._onItemTableUpdate)));this.own(s(this.organizationItemTable,"update",m.hitch(this,this._onItemTableUpdate)));this.own(s(this.groupItemTable,"update",m.hitch(this,this._onItemTableUpdate)));this.own(s(this.mycontentItemTable,"update",m.hitch(this,this._onItemTableUpdate)));
var a=this._getPortalUrl();this.portalPublicRaido.disabled||(this.publicPortalItemTable.set("portalUrl",a),this.publicPortalItemTable.searchAllItems(this._allPublicPortalQuery),this.publicPortalItemTable.set("filteredQuery",this._filterPublicPortalQuery));this.onlinePublicRaido.disabled||(this.publicOnlineItemTable.set("portalUrl",window.location.protocol+"//www.arcgis.com"),this.publicOnlineItemTable.searchAllItems(this._allPublicOnlineQuery),this.publicOnlineItemTable.set("filteredQuery",this._filterPublicOnlineQuery))},
_initPublic:function(){this.own(s(this.portalPublicRaido,"click",m.hitch(this,this._onPublicRaidoClicked)));this.own(s(this.onlinePublicRaido,"click",m.hitch(this,this._onPublicRaidoClicked)));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.checked?(this.publicPortalItemTable.show(),this.publicOnlineItemTable.hide()):this.onlinePublicRaido.checked&&(this.publicPortalItemTable.hide(),this.publicOnlineItemTable.show())},_onPublicSearch:function(a){(a=a&&m.trim(a))?
(this.publicPortalItemTable.showFilterItemsSection(),this.publicOnlineItemTable.showFilterItemsSection(),this.portalPublicRaido.checked?(this._filterPublicPortalQuery.q=a+" "+this._filterPublicPortalQuery.basicQ,this._filterPublicPortalQuery.start=1,this.publicPortalItemTable.searchFilteredItems(this._filterPublicPortalQuery)):this.onlinePublicRaido.checked&&(this._filterPublicOnlineQuery.q=a+" "+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString,this._filterPublicOnlineQuery.start=
1,this.publicOnlineItemTable.searchFilteredItems(this._filterPublicOnlineQuery))):(this.publicPortalItemTable.showAllItemsSection(),this.publicOnlineItemTable.showAllItemsSection())},_initPrivate:function(){this._resetPortalMaps();this.own(s(this.groupsSelect,"change",m.hitch(this,this._onGroupsSelectChange)));var a=n.getServerByUrl(this._getPortalUrl());n.isArcGIScom(a);v.userHaveSignInPortal(this._getPortalUrl())&&this._onSignIn()},_onOrganizationSearch:function(a){if(a=a&&m.trim(a)){if(this._allOrganizationQuery){var b=
this._allOrganizationQuery.q;b&&(this._filterOrganizationQuery.q=a+" "+b,this._filterOrganizationQuery.start=1,this.organizationItemTable.searchFilteredItems(this._filterOrganizationQuery))}}else this.organizationItemTable.showAllItemsSection()},_onMyContentSearch:function(a){if(a=a&&m.trim(a)){if(this._allMyContentQuery){var b=this._allMyContentQuery.q;b&&(this._filterMyContentQuery.q=a+" "+b,this._filterMyContentQuery.start=1,this.mycontentItemTable.searchFilteredItems(this._filterMyContentQuery))}}else this.mycontentItemTable.showAllItemsSection()},
_onGroupSearch:function(a){if(a=a&&m.trim(a)){if(this._allGroupQuery){var b=this._allGroupQuery.q;b&&(this._filterGroupQuery.q=a+" "+b,this._filterGroupQuery.start=1,this.groupItemTable.searchFilteredItems(this._filterGroupQuery))}}else this.groupItemTable.showAllItemsSection()},_onSignIn:function(){this._updateUIbySignIn();if(!this._signIn){this._signIn=!0;var a=this._getPortalUrl();b.getPortal(a).getUser().then(m.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),
this._searchMyContent(a),this._searchGroups(a))}))}},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationItemTable.clear();this.mycontentItemTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){this.organizationItemTable.clear();a=" orgid:"+a.orgId+" AND "+this._itemTypeQueryString+" AND (access:org OR access:public) "+this._typeKeywordQueryString;var b=this._getPortalUrl();this._allOrganizationQuery=
this._getQuery({q:a});this._filterOrganizationQuery=this._getQuery({q:a});this.organizationItemTable.set("portalUrl",b);this.organizationItemTable.searchAllItems(this._allOrganizationQuery)},_searchMyContent:function(a){this.mycontentItemTable.clear();var b=this._getPortalUrl();a="owner:"+a.username+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentItemTable.set("portalUrl",
b);this.mycontentItemTable.searchAllItems(this._allMyContentQuery)},_searchGroups:function(a){this._resetGroupsSection();c.setStyle(this.groupsSection,"display","block");a=a.getGroups();if(0<a.length){c.setStyle(this.groupSearch.domNode,"display","block");this.groupItemTable.show();c.empty(this.groupsSelect);for(var b=0;b<a.length;b++){var d=a[b];c.create("option",{value:d.id,innerHTML:d.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length)},_resetGroupsSection:function(){c.setStyle(this.groupsSection,
"display","none");c.empty(this.groupsSelect);c.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupItemTable.clear();c.setStyle(this.groupSearch.domNode,"display","none");this.groupItemTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?c.setStyle(this.groupsSection,"top","15px"):c.setStyle(this.groupsSection,"top","50px")},_onGroupsSelectChange:function(){var a=this.groupsSelect.value;this.groupItemTable.clear();if("nodata"===a)c.setStyle(this.groupSearch,
"display","none"),this.groupItemTable.hide();else{c.setStyle(this.groupSearch,"display","block");this.groupItemTable.show();var b=this._getPortalUrl(),a="group:"+a+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});this.groupItemTable.set("portalUrl",b);this.groupItemTable.searchAllItems(this._allGroupQuery)}},_onItemTableUpdate:function(){this.emit("update")},_onItemDomClicked:function(a){var b=
c.hasClass(a,"jimu-state-active");u(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active");b&&c.addClass(a,"jimu-state-active");(a=this.getSelectedItem())?this.emit("item-selected",a):this.emit("none-item-selected")},getSelectedItem:function(){var a=null,b=u(".item.jimu-state-active",this.domNode);0<b.length&&(a=m.mixin({},b[0].item));return a}})})},"jimu/dijit/Search":function(){define(["dojo/_base/declare","dojo/_base/html","dojo/string","dijit/_WidgetBase","dijit/_TemplatedMixin"],
function(p,f,a,l,k){return p([l,k],{baseClass:"jimu-search",declaredClass:"jimu.dijit.Search",templateString:'\x3cdiv\x3e\x3cspan class\x3d"jimu-input-wrapper" style\x3d"left:0;right:0;"\x3e\x3cinput class\x3d"jimu-input" style\x3d"background:#fafafc;" data-dojo-attach-point\x3d"inputSearch" data-dojo-attach-event\x3d"onKeydown: _onKeyDown, onKeyUp: _onKeyUp"/\x3e\x3c/span\x3e\x3cdiv class\x3d"search-btn jimu-icon jimu-icon-search" data-dojo-attach-point\x3d"searchBtn" data-dojo-attach-event\x3d"onClick: _onBtnClick"\x3e\x3c/div\x3e\x3c/div\x3e',
placeholder:"",onSearch:null,searchWhenInput:!1,postCreate:function(){this.inherited(arguments);this.placeholder&&f.setAttr(this.inputSearch,"placeholder",this.placeholder)},getValue:function(){return a.trim(this.inputSearch.value)},doSearch:function(){if(this.onSearch)this.onSearch(this.getValue())},_onKeyDown:function(a){13===(void 0!==a.keyCode?a.keyCode:a.which)&&this.doSearch();a.stopPropagation()},_onKeyUp:function(){this.searchWhenInput&&this.doSearch()},_onBtnClick:function(){this.doSearch()}})})},
"jimu/dijit/TabContainer3":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/TabContainer3.html jimu/dijit/ViewStack".split(" "),function(p,f,a,l,k,h,q,m,g,e,c){return p([m,g,h],{templateString:e,selected:"",tabs:null,average:!1,baseClass:"jimu-tab3",declaredClass:"jimu.dijit.TabContainer3",_currentIndex:-1,postCreate:function(){this.inherited(arguments);this._initSelf();
this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title)},selectTab:function(c){var e=q("td",this.tabTr);a.forEach(e,f.hitch(this,function(a,e){l.removeClass(a,"jimu-state-active");a.label===c&&(l.addClass(a,"jimu-state-active"),this._currentIndex=e)}));this.controlNode.removeChild(this.controlTable);l.place(this.controlTable,this.controlNode);this.viewStack.switchView(c);this.emit("tabChanged",c)},addTab:function(c){if(!this.average){var e=q("td:last-child",
this.tabTr);0<e.length&&l.destroy(e[0])}0<a.filter(this.tabs,function(a){return a.title===c.title}).length?console.error("tab title conflict: "+c.title):(this.tabs.push(c),this._createTab(c),this.average||(e=l.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e'),l.place(e,this.tabTr)))},removeTab:function(c){var e=-1;if(a.some(this.tabs,function(a,f){if(a.title===c)return e=f,!0})){var f=this.tabs.splice(e,
1)[0],g=q("td",this.tabTr),h;a.some(g,function(a){if(a.label===c)return h=a,!0})&&l.destroy(h);this.viewStack.removeView(f.content)}},showShelter:function(){l.setStyle(this.shelter,"display","block")},hideShelter:function(){l.setStyle(this.shelter,"display","none")},getSelectedIndex:function(){return this._currentIndex},getSelectedTitle:function(){return this.viewStack.getSelectedLabel()},_initSelf:function(){this.viewStack=new c(null,this.containerNode);a.forEach(this.tabs,function(a){this._createTab(a)},
this);if(this.average)this.controlTable.style.tableLayout="fixed";else{var d=l.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');l.place(d,this.tabTr)}},startup:function(){this.inherited(arguments);this._started=!0},_createTab:function(a){var c=l.toDom('\x3ctd nowrap class\x3d"tab-item-td"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');c.label=a.title||"";l.place(c,this.tabTr);var e=
q(".tab-item-div",c)[0];e.innerHTML=c.label;e.label=c.label;a.content.label=c.label;this.viewStack.addView(a.content);this.own(k(c,"click",f.hitch(this,this._onSelect,a.title)))},_onSelect:function(a){this.selectTab(a)}})})},"jimu/dijit/_ItemTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_ItemTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t){return p([f,a,l,h],{templateString:k,declaredClass:"jimu.dijit.ItemTable",baseClass:"jimu-item-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,types:"",typeKeywords:"",_defaultThumbnail:{"Web Mapping Application":"webapp.png","Mobile Application":"mobileapp.png"},postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.types&&0<this.types.length||
(this.types=[]);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=s.getStandardPortalUrl(this.portalUrl));this.showAllItemsSection();this.searchAllItems()},show:function(){g.setStyle(this.domNode,"display","block")},hide:function(){g.setStyle(this.domNode,"display","none")},searchAllItems:function(a){this.showAllItemsSection();a&&(this.query=q.mixin({},a),this.query.start=1,this.clearAllItemsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allItemsShelter.show(),
u.getPortal(this.portalUrl).queryItems(this.query).then(q.hitch(this,function(a){this.domNode&&(this.allItemsShelter.hide(),this.query.start=a.nextStart,this._createItems(a,this.allItemTbody))}),q.hitch(this,function(a){console.error(a);this.domNode&&this.allItemsShelter.hide()})))},searchFilteredItems:function(a){this.showFilterItemsSection();a&&(this.filteredQuery=q.clone(a),this.filteredQuery.start=1,this.clearFilteredItemsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&
(this.filteredItemShelter.show(),u.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(q.hitch(this,function(c){this.domNode&&(this.showFilterItemsSection(),a&&this.clearFilteredItemsSection(),this.filteredQuery.start=c.nextStart,this._createItems(c,this.filteredItemsTbody),this._filterItemCallback())}),q.hitch(this,function(a){console.error(a);this.domNode&&this._filterItemCallback()})))},_filterItemCallback:function(){this.filteredItemShelter.hide();0<this._getItemCount(this.filteredItemsTbody)?
(g.setStyle(this.filteredItemsTableDiv,"display","block"),g.setStyle(this.searchNoneTipSection,"display","none")):(g.setStyle(this.filteredItemsTableDiv,"display","none"),g.setStyle(this.searchNoneTipSection,"display","block"))},clear:function(){this.clearAllItemsSection();this.clearFilteredItemsSection()},clearAllItemsSection:function(){g.empty(this.allItemTbody)},clearFilteredItemsSection:function(){g.empty(this.filteredItemsTbody)},showAllItemsSection:function(){g.setStyle(this.allItemsSection,
"display","block");g.setStyle(this.filteredItemsSection,"display","none")},showFilterItemsSection:function(){g.setStyle(this.allItemsSection,"display","none");g.setStyle(this.filteredItemsSection,"display","block");g.setStyle(this.filteredItemsTableDiv,"display","block");g.setStyle(this.searchNoneTipSection,"display","none")},_onAllItemsSectionScroll:function(){this._isScrollToBottom(this.allItemsTableDiv)&&this.searchAllItems()},_onFilteredItemsSectionScroll:function(){this._isScrollToBottom(this.filteredItemsTableDiv)&&
this.searchFilteredItems()},_isScrollToBottom:function(a){return r.isScrollToBottom(a)},_createItems:function(a,d){var e=a.results,f=m.map(this.types,q.hitch(this,function(a){return a.toLowerCase()})),e=m.filter(e,q.hitch(this,function(a){a=a.type&&a.type.toLowerCase()||"";return 0<=m.indexOf(f,a)}));if(0!==e.length){var h,k=c("td.empty",d),l;if(0<k.length){var r=Math.min(e.length,k.length),p=e.splice(0,r);for(l=0;l<r;l++){var s=k[l];h=this._createItem(p[l]);g.place(h,s);g.removeClass(s,"empty")}}if(0!==
e.length){k=Math.ceil(e.length/2);for(l=0;l<k;l++){h=g.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");g.place(h,d);r=c("td",h);for(p=0;p<r.length;p++)s=r[p],(h=e[2*l+p])?(h=this._createItem(h),g.place(h,s)):g.addClass(s,"empty")}this.emit("update")}}},_getItemCount:function(a){return c(".item",a).length},_createItem:function(a){var d=g.toDom('\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"item-border"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-thumbnail jimu-auto-vertical"\x3e\x3cdiv class\x3d"none-thumbnail-tip jimu-auto-vertical-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"item-info"\x3e\x3cdiv class\x3d"item-name"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-type-owner"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-date"\x3e\x3c/div\x3e\x3ca class\x3d"item-details" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');
d.item=a;var e=c(".item-thumbnail",d)[0],f=c(".item-name",d)[0],h=c(".item-type-owner",d)[0],k=c(".item-date",d)[0],l=c(".item-details",d)[0],m=c(".none-thumbnail-tip",d)[0];if(!a.thumbnailUrl){var r=this._defaultThumbnail[a.type];r&&(a.thumbnailUrl=require.toUrl("jimu")+"/images/"+r)}a.thumbnailUrl?g.setStyle(e,"backgroundImage","url("+a.thumbnailUrl+")"):m.innerHTML=this.nls.noneThumbnail;"function"===typeof this.onCreateItemContent?(k=c(".item-info",d)[0],this.onCreateItemContent(a,k)):(f.innerHTML=
a.title,f.title=f.innerHTML,h.innerHTML=a.type+" by "+a.owner,h.title=h.innerHTML,e=new Date,e.setTime(a.modified),k.innerHTML=e.toLocaleString(),k.title=k.innerHTML,l.innerHTML=this.nls.moreDetails,l.href=a.detailsPageUrl||"#");return d},_onItemsTableClicked:function(a){var d=a.target||a.srcElement;a=null;g.hasClass(d,"item-thumbnail")?a=d.parentNode:g.hasClass(d,"none-thumbnail-tip")&&(a=d.parentNode.parentNode);a&&(d=g.hasClass(a,"jimu-state-active"),c(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active"),
d?g.removeClass(a,"jimu-state-active"):g.addClass(a,"jimu-state-active"),this.emit("item-dom-clicked",a))},getSelectedItem:function(){var a=null,d=c(".item.jimu-state-active",this.domNode);0<d.length&&(a=q.mixin({},d[0].item));return a}})})},"jimu/dijit/LoadingIndicator":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/dom-style","dojo/dom-construct"],function(p,f,a,l){return p(f,{baseClass:"jimu-loading-indicator",declaredClass:"jimu.dijit.LoadingIndicator",hidden:!1,postCreate:function(){this.inherited(arguments);
(this.hidden=!0===this.hidden)&&a.set(this.domNode,{display:"none"});a.set(this.domNode,{width:"100%",height:"100%"});var f='\x3cdiv class\x3d"loading-section"\x3e\x3cimg class\x3d"jimu-loading" src\x3d"'+require.toUrl("jimu")+'/images/loading2.gif"\x3e\x3c/div\x3e';l.place(f,this.domNode)},show:function(){this.domNode&&a.set(this.domNode,"display","block")},hide:function(){this.domNode&&a.set(this.domNode,"display","none")}})})},"builder/dijit/FullScreenPopup":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/html dojo/dom-class dojo/dom-construct dojo/dom-style dojo/dom-attr dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/FullScreenPopup.html dojo/on dojo/throttle".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r){return f([m,g,e],{templateString:c,baseClass:"fullscreen-popup-container",isShow:!1,position:{},_zIndexIncrease:0,_btns:[],postCreate:function(){this.inherited(arguments);this._btns=[];this.outerMainPage=this.blurContainer?this.blurContainer:null;this._zIndexIncrease=this.zIndex?this.zIndex:1;h.set(this.domNode,"z-index",this._zIndexIncrease++);h.set(this.background,"display","block");h.set(this.background,"z-index",this._zIndexIncrease++);h.set(this.main,"z-index",
this._zIndexIncrease++);h.set(this.fullscreenPopupBtns,"z-index",this._zIndexIncrease++);if(this.buttons)for(var c=0,e=this.buttons.length;c<e;c++){var f=this.buttons[c],b=a.create("input",{"class":"btn",type:"button",value:f.label},this.fullscreenPopupBtns);f.isHighLight&&l.add(b,"light");f.onClick&&this.own(d(b,"click",f.onClick));this._btns.push(b)}this.contentAutoHeight&&l.add(this.main,"autoHeight");this.own(d(window,"resize",r(p.hitch(this,this.resize)),50));this.own(d(this.fullscreenPopupContent,
"DOMNodeInserted,DOMNodeRemoved",r(p.hitch(this,this.resize)),100))},startup:function(){this.hide();this.refresh()},destroy:function(){this.subDijit&&(this.subDijit.destroy(),this.subDijit=null);this._btns=[];a.destroy(this.domNode);this.inherited(arguments)},refresh:function(){this.fullscreenPopupTitle.innerHTML=this.titleStr;k.place(this.content,this.fullscreenPopupContent);this.resize()},show:function(){a.setStyle(this.domNode,"display","block");this.isShow=!0;this.refresh()},hide:function(){a.setStyle(this.domNode,
"display","none");l.remove(this.outerMainPage,"glass-blur");this.isShow=!1;this.destroy()},enableButton:function(a){a=this._btns[a];q.remove(a,"disabled");return a},disableButton:function(a){a=this._btns[a];q.set(a,{disabled:"disabled"});return a},close:function(){this._onCloseClick()},setTitle:function(a){a&&(this.fullscreenPopupTitle.innerHTML=a)},setSubTitle:function(a){},resize:function(){this.btnsAtuoBottom&&this._setBtnsAutoBottom();this.contentAutoHeight&&this._setContentAutoHeight()},_onContainerClick:function(a){a.stopPropagation();
return!1},_onCloseClick:function(){this.hide()},_ieBlurPolyfill:function(){},_setBtnsAutoBottom:function(){var a=this.head;this._footerMarginTop||(this._footerMarginTop=h.get(this.fullscreenPopupBtns,"margin-top"));this._footerPaddingTopHeight||(this._footerPaddingTopHeight=h.get(this.fullscreenPopupBtnsContainer,"padding-top"));this._footerPaddingBottomHeight||(this._footerPaddingBottomHeight=h.get(this.fullscreenPopupBtnsContainer,"padding-bottom"));this._footerHeight||(this._footerHeight=h.get(this.fullscreenPopupBtns,
"height"));document.body.clientHeight-a.clientHeight-(this._footerMarginTop+this._footerHeight+this._footerPaddingTopHeight+this._footerPaddingBottomHeight)<this.fullscreenPopupContent.scrollHeight?(h.set(this.contentScroller,"height",document.body.clientHeight-a.clientHeight-this._footerMarginTop-this._footerPaddingTopHeight-this._footerPaddingBottomHeight+"px"),h.set(this.fullscreenPopupBtns,"margin-top","0")):(h.set(this.contentScroller,"height",this.fullscreenPopupContent.scrollHeight+"px"),h.set(this.fullscreenPopupBtns,
"margin-top",this._footerMarginTop+"px"))},_setContentAutoHeight:function(){l.add(this.main,"autoHeight");var a=this.head.scrollHeight,c=this.fullscreenPopupBtnsContainer.scrollHeight,d=h.get(this.fullscreenPopupBtns,"margin-top");h.set(this.contentScroller,"height",document.body.clientHeight-a-c-d+"px")}})})},"dojo/throttle":function(){define([],function(){return function(p,f){var a=!0;return function(){a&&(a=!1,p.apply(this,arguments),setTimeout(function(){a=!0},f))}}})},"dojox/form/Uploader":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/window dojo/dom-style dojo/dom-class dojo/dom-geometry dojo/dom-attr dojo/dom-construct dojo/dom-form dijit dijit/form/Button ./uploader/_Base ./uploader/_HTML5 ./uploader/_IFrame ./uploader/_Flash dojo/i18n!./nls/Uploader dojo/text!./resources/Uploader.html".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w){return f("dojox.form.Uploader",[s,u,t,b,v],{uploadOnSelect:!1,tabIndex:0,multiple:!1,label:n.label,url:"",name:"uploadedfile",flashFieldName:"",force:"",uploadType:"",showInput:"",focusedClass:"dijitButtonHover",_nameIndex:0,templateString:w,baseClass:"dijitUploader "+u.prototype.baseClass,postMixInProperties:function(){this._inputs=[];this._cons=[];this.force=this.force.toLowerCase();this.supports("multiple")?this.uploadType="form"===this.force?"form":
"html5":this.uploadType="flash"===this.force?"flash":"iframe";this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);q.set(this.domNode,{overflow:"hidden",position:"relative"});this._buildDisplay();e.set(this.titleNode,"tabIndex",-1)},_buildDisplay:function(){this.showInput&&(this.displayInput=c.create("input",{"class":"dijitUploadDisplayInput",tabIndex:-1,autocomplete:"off",role:"presentation"},this.containerNode,this.showInput),this._attachPoints.push("displayInput"),this.connect(this,
"onChange",function(a){for(var b=0,c,d=[];c=a[b++];)c&&c.name&&d.push(c.name);this.displayInput.value=d.join(", ")}),this.connect(this,"reset",function(){this.displayInput.value=""}))},startup:function(){this._buildInitialized||(this._buildInitialized=!0,this._getButtonStyle(this.domNode),this._setButtonStyle(),this.inherited(arguments))},onChange:function(a){},onBegin:function(a){},onProgress:function(a){},onComplete:function(a){this.reset()},onCancel:function(){},onAbort:function(){},onError:function(a){},
upload:function(a){a=a||{};a.uploadType=this.uploadType;this.inherited(arguments)},submit:function(a){a=a?a.tagName?a:this.getForm():this.getForm();a=d.toObject(a);a.uploadType=this.uploadType;this.upload(a)},reset:function(){delete this._files;this._disconnectButton();l.forEach(this._inputs,c.destroy);this._inputs=[];this._nameIndex=0;this._createInput()},getFileList:function(){var a=[];this.supports("multiple")?l.forEach(this._files,function(b,c){a.push({index:c,name:b.name,size:b.size,type:b.type})},
this):l.forEach(this._inputs,function(b,c){b.value&&a.push({index:c,name:b.value.substring(b.value.lastIndexOf("\\")+1),size:0,type:b.value.substring(b.value.lastIndexOf(".")+1)})},this);return a},_getValueAttr:function(){return this.getFileList()},_setValueAttr:function(a){console.error("Uploader value is read only")},_setDisabledAttr:function(a){this.disabled!=a&&this.inputNode&&(this.inherited(arguments),q.set(this.inputNode,"display",a?"none":""))},_getButtonStyle:function(a){this.btnSize={w:q.get(a,
"width"),h:q.get(a,"height")}},_setButtonStyle:function(){this.inputNodeFontSize=Math.max(2,Math.max(Math.ceil(this.btnSize.w/60),Math.ceil(this.btnSize.h/15)));this._createInput()},_getFileFieldName:function(){return this.supports("multiple")&&this.multiple?this.name+"s[]":this.name+(this.multiple?this._nameIndex:"")},_createInput:function(){this._inputs.length&&(q.set(this.inputNode,{top:"500px"}),this._disconnectButton(),this._nameIndex++);var a=this._getFileFieldName();this.focusNode=this.inputNode=
c.create("input",{type:"file",name:a,"aria-labelledby":this.id+"_label"},this.domNode,"first");this.supports("multiple")&&this.multiple&&e.set(this.inputNode,"multiple",!0);this._inputs.push(this.inputNode);q.set(this.inputNode,{position:"absolute",fontSize:this.inputNodeFontSize+"em",top:"-3px",right:"-3px",opacity:0});this._connectButton()},_connectButton:function(){this._cons.push(k.connect(this.inputNode,"change",this,function(a){this._files=this.inputNode.files;this.onChange(this.getFileList(a));
!this.supports("multiple")&&this.multiple&&this._createInput()}));-1<this.tabIndex&&(this.inputNode.tabIndex=this.tabIndex,this._cons.push(k.connect(this.inputNode,"focus",this,function(){m.add(this.domNode,this.focusedClass)})),this._cons.push(k.connect(this.inputNode,"blur",this,function(){m.remove(this.domNode,this.focusedClass)})))},_disconnectButton:function(){l.forEach(this._cons,k.disconnect);this._cons.splice(0,this._cons.length)}})})},"dojox/form/uploader/_Base":function(){define("dojo/dom-form dojo/dom-style dojo/dom-construct dojo/dom-attr dojo/has dojo/_base/declare dojo/_base/event dijit/_Widget dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin".split(" "),
function(p,f,a,l,k,h,q,m,g,e){k.add("FormData",function(){return!!window.FormData});k.add("xhr-sendAsBinary",function(){var a=window.XMLHttpRequest&&new window.XMLHttpRequest;return a&&!!a.sendAsBinary});k.add("file-multiple",function(){return!!{"true":1,"false":1}[l.get(document.createElement("input",{type:"file"}),"multiple")]});return h("dojox.form.uploader._Base",[m,g,e],{getForm:function(){if(!this.form)for(var a=this.domNode;a&&a.tagName&&a!==document.body;){if("form"==a.tagName.toLowerCase()){this.form=
a;break}a=a.parentNode}return this.form},getUrl:function(){this.uploadUrl&&(this.url=this.uploadUrl);if(this.url)return this.url;this.getForm()&&(this.url=this.form.action);return this.url},connectForm:function(){this.url=this.getUrl();!this._fcon&&this.getForm()&&(this._fcon=!0,this.connect(this.form,"onsubmit",function(a){console.log("SUBMIT");q.stop(a);this.submit(this.form)}))},supports:function(a){switch(a){case "multiple":if("flash"==this.force||"iframe"==this.force)break;return k("file-multiple");
case "FormData":return k(a);case "sendAsBinary":return k("xhr-sendAsBinary")}return!1},getMimeType:function(){return"application/octet-stream"},getFileType:function(a){return a.substring(a.lastIndexOf(".")+1).toUpperCase()},convertBytes:function(a){var d=Math.round(1E5*(a/1024))/1E5,e=Math.round(1E5*(a/1048576))/1E5,f=Math.round(1E5*(a/1073741824))/1E5,g=a;1<d&&(g=d.toFixed(1)+" kb");1<e&&(g=e.toFixed(1)+" mb");1<f&&(g=f.toFixed(1)+" gb");return{kb:d,mb:e,gb:f,bytes:a,value:g}}})})},"dojox/form/uploader/_HTML5":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/_base/array","dojo"],function(p,f,a,l){return p("dojox.form.uploader._HTML5",[],{errMsg:"Error uploading files. Try checking permissions",uploadType:"html5",postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.connectForm();this.inherited(arguments);this.uploadOnSelect&&this.connect(this,"onChange",function(a){this.upload(a[0])})},_drop:function(a){l.stopEvent(a);this._files=a.dataTransfer.files;this.onChange(this.getFileList())},upload:function(a){this.onBegin(this.getFileList());
this.uploadWithFormData(a)},addDropTarget:function(a,f){f||(this.connect(a,"dragenter",l.stopEvent),this.connect(a,"dragover",l.stopEvent),this.connect(a,"dragleave",l.stopEvent));this.connect(a,"drop","_drop")},uploadWithFormData:function(f){if(this.getUrl()){var h=new FormData,l=this._getFileFieldName();a.forEach(this._files,function(a,e){h.append(l,a)},this);if(f){f.uploadType=this.uploadType;for(var m in f)h.append(m,f[m])}this.createXhr().send(h)}else console.error("No upload url found.",this)},
_xhrProgress:function(a){if(a.lengthComputable){var f={bytesLoaded:a.loaded,bytesTotal:a.total,type:a.type,timeStamp:a.timeStamp};"load"==a.type?(f.percent="100%",f.decimal=1):(f.decimal=a.loaded/a.total,f.percent=Math.ceil(100*(a.loaded/a.total))+"%");this.onProgress(f)}},createXhr:function(){var a=new XMLHttpRequest,h;a.upload.addEventListener("progress",f.hitch(this,"_xhrProgress"),!1);a.addEventListener("load",f.hitch(this,"_xhrProgress"),!1);a.addEventListener("error",f.hitch(this,function(a){this.onError(a);
clearInterval(h)}),!1);a.addEventListener("abort",f.hitch(this,function(a){this.onAbort(a);clearInterval(h)}),!1);a.onreadystatechange=f.hitch(this,function(){if(4===a.readyState){clearInterval(h);try{this.onComplete(JSON.parse(a.responseText.replace(/^\{\}&&/,"")))}catch(f){console.error("Error parsing server result:",f),console.error(a.responseText),this.onError("Error parsing server result:",f)}}});a.open("POST",this.getUrl());a.setRequestHeader("Accept","application/json");h=setInterval(f.hitch(this,
function(){}),250);return a}})})},"dojox/form/uploader/_IFrame":function(){define("dojo/query dojo/dom-construct dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-form dojo/request/iframe".split(" "),function(p,f,a,l,k,h,q){return a("dojox.form.uploader._IFrame",[],{postMixInProperties:function(){this.inherited(arguments);"iframe"===this.uploadType&&(this.uploadType="iframe",this.upload=this.uploadIFrame)},uploadIFrame:function(a){var g={},e;this.getForm();var c=this.getUrl(),d=this;a=
a||{};a.uploadType=this.uploadType;e=f.place('\x3cform enctype\x3d"multipart/form-data" method\x3d"post"\x3e\x3c/form\x3e',this.domNode);k.forEach(this._inputs,function(a,c){""!==a.value&&(e.appendChild(a),g[a.name]=a.value)},this);if(a)for(nm in a)void 0===g[nm]&&f.create("input",{name:nm,value:a[nm],type:"hidden"},e);q.post(c,{form:e,handleAs:"json",content:a}).then(function(a){f.destroy(e);if(a.ERROR||a.error)d.onError(a);else d.onComplete(a)},function(a){console.error("error parsing server result",
a);f.destroy(e);d.onError(a)})}})})},"dojox/form/uploader/_Flash":function(){define("dojo/dom-form dojo/dom-style dojo/dom-construct dojo/dom-attr dojo/_base/declare dojo/_base/config dojo/_base/connect dojo/_base/lang dojo/_base/array dojox/embed/Flash".split(" "),function(p,f,a,l,k,h,q,m,g,e){return k("dojox.form.uploader._Flash",[],{swfPath:h.uploaderPath||require.toUrl("dojox/form/resources/uploader.swf"),preventCache:!0,skipServerCheck:!0,serverTimeout:2E3,isDebug:!1,devMode:!1,deferredUploading:0,
postMixInProperties:function(){"flash"===this.uploadType&&(this._files=[],this._fileMap={},this._createInput=this._createFlashUploader,this.getFileList=this.getFlashFileList,this.reset=this.flashReset,this.upload=this.uploadFlash,this.fieldname="flashUploadFiles");this.inherited(arguments)},onReady:function(a){},onLoad:function(a){},onFileChange:function(a){},onFileProgress:function(a){},getFlashFileList:function(){return this._files},flashReset:function(){this.flashMovie.reset();this._files=[];this._fileMap=
{}},uploadFlash:function(a){this.onBegin(this.getFileList());a=a||{};a.returnType="F";a.uploadType=this.uploadType;console.log("flas upload",a);this.flashMovie.doUpload(a)},_change:function(a){this._files=this._files.concat(a);g.forEach(a,function(a){a.bytesLoaded=0;a.bytesTotal=a.size;this._fileMap[a.name+"_"+a.size]=a},this);this.onChange(this._files);this.onFileChange(a)},_complete:function(a){this._getCustomEvent().type="load";this.onComplete(a)},_progress:function(a){this._fileMap[a.name+"_"+
a.bytesTotal].bytesLoaded=a.bytesLoaded;var d=this._getCustomEvent();this.onFileProgress(a);this.onProgress(d)},_error:function(a){this.onError(a)},_onFlashBlur:function(a){},_getCustomEvent:function(){var a={bytesLoaded:0,bytesTotal:0,type:"progress",timeStamp:(new Date).getTime()},d;for(d in this._fileMap)a.bytesTotal+=this._fileMap[d].bytesTotal,a.bytesLoaded+=this._fileMap[d].bytesLoaded;a.decimal=a.bytesLoaded/a.bytesTotal;a.percent=Math.ceil(100*(a.bytesLoaded/a.bytesTotal))+"%";return a},_connectFlash:function(){this._subs=
[];this._cons=[];var a=m.hitch(this,function(a,c){this._subs.push(q.subscribe(this.id+a,this,c))});a("/filesSelected","_change");a("/filesUploaded","_complete");a("/filesProgress","_progress");a("/filesError","_error");a("/filesCanceled","onCancel");a("/stageBlur","_onFlashBlur");this.connect(this.domNode,"focus",function(){this.flashMovie.focus();this.flashMovie.doFocus()});0<=this.tabIndex&&l.set(this.domNode,"tabIndex",this.tabIndex)},_createFlashUploader:function(){var c=this.btnSize.w,d=this.btnSize.h;
if(c){var g=this.getUrl();if(g){if(0>g.toLowerCase().indexOf("http")&&0!=g.indexOf("/")){var h=window.location.href.split("/");h.pop();h=h.join("/")+"/";g=h+g}}else console.warn("Warning: no uploadUrl provided.");this.inputNode=a.create("div",{className:"dojoxFlashNode"},this.domNode,"first");f.set(this.inputNode,{position:"absolute",top:"-2px",width:c+"px",height:d+"px",opacity:0});c={expressInstall:!0,path:(this.swfPath.uri||this.swfPath)+(this.preventCache?"?cb_"+(new Date).getTime():""),width:c,
height:d,allowScriptAccess:"always",allowNetworking:"all",vars:{uploadDataFieldName:this.flashFieldName||this.name+"Flash",uploadUrl:g,uploadOnSelect:this.uploadOnSelect,deferredUploading:this.deferredUploading||0,selectMultipleFiles:this.multiple,id:this.id,isDebug:this.isDebug,noReturnCheck:this.skipServerCheck,serverTimeout:this.serverTimeout},params:{scale:"noscale",wmode:"opaque",allowScriptAccess:"always",allowNetworking:"all"}};this.flashObject=new e(c,this.inputNode);this.flashObject.onError=
m.hitch(function(a){console.error("Flash Error: "+a)});this.flashObject.onReady=m.hitch(this,function(){this.onReady(this)});this.flashObject.onLoad=m.hitch(this,function(a){this.flashMovie=a;this.flashReady=!0;this.onLoad(this)});this._connectFlash()}else setTimeout(dojo.hitch(this,function(){this._getButtonStyle(this.domNode);this._createFlashUploader()}),200)}})})},"dojox/embed/Flash":function(){define("dojo/_base/lang dojo/_base/unload dojo/_base/array dojo/query dojo/has dojo/dom dojo/on dojo/window dojo/string".split(" "),
function(p,f,a,l,k,h,q,m,g){function e(a){a=p.delegate(s,a);if(!("path"in a))return console.error("dojox.embed.Flash(ctor):: no path reference to a Flash movie was provided."),null;"id"in a||(a.id=r+u++);return a}var c,d,r="dojox-embed-flash-",u=0,s={expressInstall:!1,width:320,height:240,swLiveConnect:"true",allowScriptAccess:"sameDomain",allowNetworking:"all",style:null,redirect:null};k("ie")?(c=function(a){a=e(a);if(!a)return null;var c,d=a.path;if(a.vars){var f=[];for(c in a.vars)f.push(encodeURIComponent(c)+
"\x3d"+encodeURIComponent(a.vars[c]));a.params.FlashVars=f.join("\x26");delete a.vars}d='\x3cobject id\x3d"'+g.escape(String(a.id))+'" classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width\x3d"'+g.escape(String(a.width))+'" height\x3d"'+g.escape(String(a.height))+'"'+(a.style?' style\x3d"'+g.escape(String(a.style))+'"':"")+'\x3e\x3cparam name\x3d"movie" value\x3d"'+g.escape(String(d))+'" /\x3e';if(a.params)for(c in a.params)d+='\x3cparam name\x3d"'+g.escape(c)+'" value\x3d"'+g.escape(String(a.params[c]))+
'" /\x3e';return{id:a.id,markup:d+"\x3c/object\x3e"}},d=function(){for(var a=10,c=null;!c&&7<a;)try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+a--)}catch(d){}return c?(a=c.GetVariable("$version").split(" ")[1].split(","),{major:null!=a[0]?parseInt(a[0]):0,minor:null!=a[1]?parseInt(a[1]):0,rev:null!=a[2]?parseInt(a[2]):0}):{major:0,minor:0,rev:0}}(),f.addOnWindowUnload(function(){console.warn("***************UNLOAD");var a=function(){};l("object").reverse().style("display","none").forEach(function(c){for(var d in c)if("FlashVars"!=
d&&"function"==typeof c[d])try{c[d]=a}catch(e){}})})):(c=function(a){a=e(a);if(!a)return null;var c,d=a.path;if(a.vars){var f=[];for(c in a.vars)f.push(encodeURIComponent(c)+"\x3d"+encodeURIComponent(a.vars[c]));a.params.flashVars=f.join("\x26");delete a.vars}d='\x3cembed type\x3d"application/x-shockwave-flash" src\x3d"'+g.escape(String(d))+'" id\x3d"'+g.escape(String(a.id))+'" width\x3d"'+g.escape(String(a.width))+'" height\x3d"'+g.escape(String(a.height))+'"'+(a.style?' style\x3d"'+g.escape(String(a.style))+
'" ':"")+'pluginspage\x3d"'+window.location.protocol+'//www.adobe.com/go/getflashplayer" ';if(a.params)for(c in a.params)d+=" "+g.escape(c)+'\x3d"'+g.escape(String(a.params[c]))+'"';return{id:a.id,markup:d+" /\x3e"}},d=function(){var a=navigator.plugins["Shockwave Flash"];return a&&a.description?(a=a.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."),{major:null!=a[0]?parseInt(a[0]):0,minor:null!=a[1]?parseInt(a[1]):0,rev:null!=a[2]?parseInt(a[2]):0}):{major:0,minor:0,
rev:0}}());var t=function(a,c){if(-1<location.href.toLowerCase().indexOf("file://"))throw Error("dojox.embed.Flash can't be run directly from a file. To instatiate the required SWF correctly it must be run from a server, like localHost.");this.available=d.major;this.minimumVersion=a.minimumVersion||9;this.domNode=this.movie=this.id=null;c&&(c=h.byId(c));setTimeout(p.hitch(this,function(){if(a.expressInstall||this.available&&this.available>=this.minimumVersion)if(a&&c)this.init(a,c);else this.onError("embed.Flash was not provided with the proper arguments.");
else if(this.available)this.onError("Flash version detected: "+this.available+" is out of date. Minimum required: "+this.minimumVersion);else this.onError("Flash is not installed.")}),100)};p.extend(t,{onReady:function(a){},onLoad:function(a){},onError:function(a){},_onload:function(){clearInterval(this._poller);delete this._poller;delete this._pollCount;delete this._pollMax;this.onLoad(this.movie)},init:function(a,c){this.destroy();c=h.byId(c||this.domNode);if(!c)throw Error("dojox.embed.Flash: no domNode reference has been passed.");
var d=0;this._poller=null;this._pollCount=0;this._pollMax=15;this.pollTime=100;t.initialized&&(this.id=t.place(a,c),this.domNode=c,setTimeout(p.hitch(this,function(){this.movie=this.byId(this.id,a.doc);this.onReady(this.movie);this._poller=setInterval(p.hitch(this,function(){try{d=this.movie.PercentLoaded()}catch(a){console.warn("this.movie.PercentLoaded() failed",a,this.movie)}if(100==d)this._onload();else if(0==d&&this._pollCount++>this._pollMax)throw clearInterval(this._poller),Error("Building SWF failed.");
}),this.pollTime)}),1))},_destroy:function(){try{this.domNode.removeChild(this.movie)}catch(a){}this.id=this.movie=this.domNode=null},destroy:function(){if(this.movie){var a=p.delegate({id:!0,movie:!0,domNode:!0,onReady:!0,onLoad:!0}),c;for(c in this)a[c]||delete this[c];this._poller?q(this,"Load",this,"_destroy"):this._destroy()}},byId:function(a,c){c=c||document;return c.embeds[a]?c.embeds[a]:c[a]?c[a]:window[a]?window[a]:document[a]?document[a]:null}});p.mixin(t,{minSupported:8,available:d.major,
supported:d.major>=d.required,minimumRequired:d.required,version:d,initialized:!1,onInitialize:function(){t.initialized=!0},__ie_markup__:function(a){return c(a)},proxy:function(b,c){a.forEach(c instanceof Array?c:[c],function(b){this[b]=p.hitch(this,function(){return function(){return eval(this.movie.CallFunction('\x3cinvoke name\x3d"'+b+'" returntype\x3d"javascript"\x3e\x3carguments\x3e'+a.map(arguments,function(a){return __flash__toXML(a)}).join("")+"\x3c/arguments\x3e\x3c/invoke\x3e"))}.apply(this,
arguments||[])})},b)}});t.place=function(a,d){var e=c(a);d=h.byId(d);d||(d=m.doc.createElement("div"),d.id=e.id+"-container",m.body().appendChild(d));return e?(d.innerHTML=e.markup,e.id):null};t.onInitialize();p.setObject("dojox.embed.Flash",t);return t})},"builder/plugins/app-list/AppCatalogPage":function(){define("dojo/_base/declare dojo/_base/html dojo/dom-style dojo/dom dojo/_base/array dojo/on dojo/_base/lang dojo/query dojo/dom-attr dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./AppCatalogPage.html ./AppOperMenu".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s){return p([c,d,r],{baseClass:"app-catalog-page",templateString:u,_defaultStyleColor:"#31aacd",loading:null,folderUrl:null,appListWidget:null,_eventHandles:null,_appOperMenus:null,postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading;this.folderUrl=this.appListWidget.folderUrl},constructor:function(){this._appOperMenus=[];this._eventHandles=[]},startup:function(){this.inherited(arguments)},
refresh:function(a,b){this.createAppList(a,b);f.setSelectable(this.appContent,!1)},createAppList:function(a){var b;this.cleanAppList();f.setStyle(this.listSectionBodyContent,"display","block");if(0<a.length)for(b=0;b<a.length;b++)this.createAppNode(a[b],b);else this.appListWidget._addEmptyDescription(this.listTableBody)},cleanAppList:function(){f.empty(this.listTableBody);k.forEach(this._appOperMenus,function(a){a.destroy()});this._appOperMenus=[];k.forEach(this._eventHandles,function(a){a.remove()});
this._eventHandles=[]},createAppNode:function(a,b){return this._createItem(a,b)},_createItem:function(c,b){var d=f.create("tr",{"class":"app-catalogs list-table-item"+(b%2?" list-table-item-add ":" "),"data-app-id":c.id,"data-app-name":c.name},this.listTableBody),g=f.create("td",{"class":"item-td"},d),g=f.create("div",{"class":"catalog"},g),k=f.create("div",{"class":"content-theme jimu-float-leading"},g),m=f.create("div",{"class":"content-theme-icon "+(c._defaultIconClass?c._defaultIconClass:""),
title:this.nls.launch},k);c.thumbnail&&a.set(m,"backgroundImage","url("+c.thumbnail+"?date\x3d"+this.appListWidget.getRefreshImageFlag()+")");f.create("div",{"class":"content-theme-flagImg content-theme-flagImg-"+this._getType(c.appType)},m);var m=f.create("div",{"class":"content-opers jimu-float-trailing"},g),r=f.create("div",{"class":"content-opers-btns"},m),m=f.create("div",{"class":"content-opers-btn content-opers-btns-edit",title:this.nls.configApp},r),p=f.create("div",{"class":"content-opers-btn content-opers-btns-launch",
title:this.nls.launch},r),u=f.create("div",{"class":"content-opers-btn content-opers-btns-download",title:this.nls.download},r),r=f.create("div",{"class":"content-opers-btn content-opers-btns-more","data-appid":c.id},r),B=(new s({app:c,posNode:r,appListWidget:this.appListWidget,nls:this.nls,isTemplate:!1,appContentNode:this.appContent,height:122,offset:{top:42,left:-16,right:-16}})).placeAt(r);this._appOperMenus.push(B);this._eventHandles.push(h(k,"click",q.hitch(this,this._onAppLaunchClick,c)));
this._eventHandles.push(h(u,"click",q.hitch(this,this._onAppDownloadClick,c)));this._eventHandles.push(h(m,"click",q.hitch(this,this._onAppEditClick,c)));this._eventHandles.push(h(p,"click",q.hitch(this,this._onAppLaunchClick,c)));this._eventHandles.push(h(r,"click",q.hitch(this,this._onAppMoreClick,c,B,r)));g=f.create("div",{"class":"catalog-content"},g);k=f.create("div",{"class":"catalog-content-head"},g);f.create("p",{"class":"catalog-content-appname long-text-ellipsis",innerHTML:c.name,title:c.name},
k);k=f.create("p",{"class":"catalog-content-appinfo long-text-ellipsis jimu-float-trailing"},k);f.create("span",{"class":"catalog-content-appinfo-time jimu-float-leading",innerHTML:this.appListWidget._getLocaleDateTime(c.lastUpdated)},k);f.create("span",{"class":"catalog-content-appinfo-owner jimu-float-leading",innerHTML:"\x3cp class\x3d'catalog-content-appinfo-owner-name long-text-ellipsis'title\x3d'"+c.creator+"'\x3e"+c.creator+"\x3c/p\x3e"},k);f.create("p",{"class":"catalog-content-dis "+(c.description?
"":"place-holder-class"),innerHTML:c.description?c.description:this.nls.defaultDesc,title:c.description},g);this._eventHandles.push(h(l.byId("content-box"),"click",q.hitch(this,this.resetStatus)));this._eventHandles.push(h(this.ownerDocument,"click",q.hitch(this,this.resetStatus)));this._eventHandles.push(e.subscribe("menuAll/hide",q.hitch(this,this.resetStatus)));return d},_getType:function(a){var b="";switch(a){case "HTML":b="2D";break;case "HTML3D":b="3D";break;default:console.error("AppCatalogPage Error _getType")}return b},
resetStatus:function(a){this._hideAllAppOperMenus(a);this._hideBtnsSelect(a)},_hideAllAppOperMenus:function(a){k.forEach(this._appOperMenus,function(b){b.isShow&&("undefined"===typeof a||"undefined"===typeof a.itemId||a.itemId!==b.app.id)&&b.hide()})},_hideBtnsSelect:function(a){for(var b=m(".content-opers-btns-more"),c=0,d=b.length;c<d;c++){var e=b[c];("undefined"===typeof a||"undefined"===typeof a.itemId||a.itemId!==parseInt(g.get(e,"data-appid"),10))&&f.removeClass(e,"content-opers-btns-more-selected")}},
_onAppDownloadClick:function(a){window.open(a.downloadUrl,"downloadTargetFrame")},_onAppEditClick:function(a){this.appListWidget.pluginManager.getPluginByName("startup").switchToAppConfig(a)},_onAppLaunchClick:function(a){window.open(a.appUrl,"_blank")},_onAppMoreClick:function(a,b,c,d){d&&(d.itemId=a.id);b.isShow?b.hide():(e.publish("menuAll/hide"),b.set("app",a),b.show(),f.addClass(c,"content-opers-btns-more-selected"))}})})},"builder/plugins/app-list/AppOperMenu":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./AppOperMenu.html dojo/on dojo/query dojo/keys dojo/_base/lang jimu/dijit/Popup jimu/dijit/Message builder/serviceUtils jimu/dijit/QRCode builder/dijit/FullScreenPopup builder/dijit/EditItemInfo".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s){return p([a,l],{templateString:k,baseClass:"app-oper-menu white-style",app:void 0,isShow:!1,position:{},itemDefaultColor:"#ffffff",appListWidget:void 0,loadingDiv:null,_loading:null,_downloadUrl:null,constructor:function(){this.height||(this.height=0);this.offset||(this.offset={top:0,left:0,right:0})},postCreate:function(){this.inherited(arguments);this._loading=this.appListWidget.loading;this._initMenu();this.hide();this._downloadUrl="/webappbuilder/rest/apps/"+
this.app.id+"/download";f.setAttr(this.downloadLinkNode,"href",this._downloadUrl);this.own(h(this.downloadLinkNode,"click",g.hitch(this,function(){this.hide()})));this.app.isTemplate&&f.setAttr(this.editAppInfo,"innerHTML",this.nls.editTemplateInfo)},refresh:function(){var a="",b="";if(this.appContentNode){var a=f.position(this.posNode),b=f.position(this.appContentNode),c=f.getStyle(this.appContentNode,"height");a.y+this.height+25>b.y+c?(b=this.offset.top,a="",f.setStyle(this.upTriangle,"display",
"none"),f.setStyle(this.downTriangle,"top",this.height-4+"px"),f.setStyle(this.downTriangle,"display","block")):(a=this.offset.top,b="")}f.setStyle(this.domNode,isRTL?{top:a+"px",bottom:b+"px",left:this.offset.left+"px"}:{top:a+"px",bottom:b+"px",right:this.offset.right+"px"})},_refreshAppOrTempaltePage:function(){this.appListWidget.resetRefreshImageFlag();this.app.isTemplate?this.appListWidget.refreshTemplatePage():this.appListWidget.refreshAppPage()},show:function(){this.refresh();f.setStyle(this.domNode,
"display","block");this.isShow=!0},hide:function(){f.setStyle(this.domNode,"display","none");this.isShow=!1},_initMenu:function(){this.isTemplate?(f.addClass(this.editAppInfo,"border-top-radius"),this._disableItem(this.createAppFromTemplate),this.app.isPredefined&&(this._disableItem(this.duplicate),this._disableItem(this.editAppInfo),this._disableItem(this.remove),this._disableItem(this.download),this._disableItem(this.duplicate))):(f.addClass(this.editAppInfo,"border-top-radius"),this._disableItem(this.createAppFromTemplate),
this._disableItem(this.download))},_disableItem:function(a){f.setStyle(a,"display","none")},_onMenuClick:function(a){a.stopPropagation()},_onRemoveClick:function(){var a,b;this.app.isTemplate?(a=this.nls.confirmDeleteTemplate,b=this.nls.deleteTemplateTitle):(a=this.nls.confirmDeleteApp,b=this.nls.deleteAppTitle);var c=new e({content:a,titleLabel:b,width:"425",autoHeight:!0,"class":"jimu-popup-in-home",buttons:[{label:this.nls.ok,onClick:g.hitch(this,function(){this._loading.show(this.nls.deleting);
c.close();d.removeApp(this.app.id).then(g.hitch(this,function(a){a.success?(console.log("Removed app successfully, id\x3d"+this.app.id),this._refreshAppOrTempaltePage()):console.error(this.nls.deleteFalse);this._loading.hide()}),function(){console.error(this.nls.deleteError);this._loading.hide()})})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:g.hitch(this,function(){c.close()})}]})},_onDuplicateClick:function(){this._loading.show(this.nls.duplicating);d.duplicateApp({name:this.app.name,
description:this.app.description,fromAppId:this.app.id,appType:this.app.appType,isTemplate:this.app.isTemplate,isPredefined:this.app.isPredefined}).then(g.hitch(this,function(a){this._loading.hide();a.success?(console.log("Duplicated app successfully, app id\x3d"+this.app.id),this._refreshAppOrTempaltePage()):console.error(this.nls.duplicateFalse)}),function(){console.error(this.nls.duplicateError);this._loading.hide()});this.hide()},_onEditClick:function(){this.itemInfoDijit=new s({itemInfo:this.app,
nls:this.nls});var a;a=this.app.isTemplate?this.nls.editTemplateInfo:this.nls.editAppInfo;var b=q("#main-page")[0];this._EditPopup=new u({zIndex:101,titleStr:a,blurContainer:b.firstElementChild,content:this.itemInfoDijit.domNode,subDijit:this.itemInfoDijit,buttons:[{label:this.nls.ok,isHighLight:!0,onClick:g.hitch(this,this._onEditOKClick)},{label:this.nls.cancel,isHighLight:!1,onClick:g.hitch(this,this._onEditCancelClick)}],btnsAtuoBottom:!0});this._EditPopup.placeAt(b);this._EditPopup.show();this.itemInfoDijit.focusItemByName("appName");
this.hide();this.posNode&&f.removeClass(this.posNode,"item-more-selected")},_onEditOKClick:function(){var a=g.clone(this.app),b=this.itemInfoDijit.getProperties();a.name=b.name;a.description=b.description;!0!==this.app.isTemplate&&b.icon&&(a.icon=b.icon);b.thumbnail&&(a.thumbnail=b.thumbnail);this.appListWidget.updateApp(a).then(g.hitch(this,function(a){!0===a.success?(this._refreshAppOrTempaltePage(),this._EditPopup.close()):(console.error(a.message),new c({message:this.nls.editAppFalse}))}),g.hitch(this,
function(a){console.error(a);new c({message:this.nls.editError})}))},_onEditCancelClick:function(){this._EditPopup&&this._EditPopup.close()},_onDownloadClick:function(){},_onAgolTemplateClick:function(){var a=this.appListWidget.pluginsMeta["popup-actions.popup-agoltemplate"];a&&this.appListWidget.pluginManager.loadPlugin(a).then(g.hitch(this,function(a){a.onClickBeforeConfigPage(this.app)}))},_onCreateAppFromTempalteClick:function(){var a=this.appListWidget.pluginManager.getExtensions("startup.creation-entry")[0],
a=this.appListWidget.pluginsMeta[a.pluginName];this._loading.show("");this.appListWidget.pluginManager.loadPlugin(a).then(g.hitch(this,function(a){a.popupNewCreateDlg("",this.app,700);this._loading.hide()}),g.hitch(this,function(){this._loading.hide()}))},_onQRCodeClick:function(){new e({content:new r({text:"http://"+window.location.host+path+"apps/"+this.app.id,width:128,height:128}),container:"main-page",titleLabel:"qrcode-nonls",width:300,autoHeight:!0,buttons:[{label:this.nls.cancel,key:m.ESCAPE}]})}})})},
"builder/dijit/EditItemInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/dijit dojo/text!./templates/EditItemInfo.html dojo/dom-style dojo/dom-class dojo/_base/lang dojo/on dojo/mouse dojo/query dojo/dom-attr dojo/promise/all builder/portalUtils jimu/portalUrlUtils jimu/utils ./Tags dijit/form/SimpleTextarea jimu/dijit/ImageChooser dojo/has dojo/sniff dijit/form/TextBox dijit/form/Select dijit/form/CheckBox".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A){return p([k,h,q],{templateString:g,baseClass:"dijit-item-info",_isTemplate:"",postMixInProperties:function(){this.inherited(arguments);this.nls=d.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this._init(this.itemInfo);t.set(this.publishWebmapSummary,"placeholder",this.nls.summaryLabelPlaceHolder)},_init:function(b){var e="";this._isTemplate=!1===b.isTemplate?!1:!0;e="imageChooserTemplate";this.imageChooser=new y({cropImage:!0,
showSelfImg:!0,format:[y.GIF,y.JPEG,y.PNG],goldenWidth:300,goldenHeight:180,maxSize:2048});a.place(this.imageChooser.domNode,this.imageChooserBase);c.add(this.imageChooserContainer,e);c.add(this.imageChooserMasker,e);this.own(r(this.imageChooserContainer,u.enter,d.hitch(this,this._onImageChooserBaseMouseEnter)));this.own(r(this.imageChooserContainer,u.leave,d.hitch(this,this._onImageChooserBaseMouseLeave)));this.own(r(this.imageChooserMasker,"click",d.hitch(this,this._onEmitUploadPic)));this.setProperties(b)},
_onImageChooserBaseMouseEnter:function(a){e.set(this.imageChooserMasker,"display","block");a.stopPropagation();return!1},_onImageChooserBaseMouseLeave:function(a){e.set(this.imageChooserMasker,"display","none");a.stopPropagation();return!1},_onEmitUploadPic:function(){var a=s("form",this.imageChooserBase)[0],a=s("label",a)[0];3<A("ff")?a.click():r.emit(a,"click",{bubbles:!0,cancelable:!0})},setProperties:function(a){m.byId("publish-webmap-name").set("value",a.name);m.byId("publish-webmap-summary").set("value",
a.description);if(this.imageChooser){var b="",b=a.thumbnail;"undefined"!==typeof b&&this.imageChooser.setDefaultSelfSrc(b)}},getProperties:function(){var a={name:w.stripHTML(m.byId("publish-webmap-name").get("value")),description:w.stripHTML(m.byId("publish-webmap-summary").get("value"))};!0!==this._isTemplate&&(a.icon=this.imageChooser&&this.imageChooser.imageData);a.thumbnail=this.imageChooser&&this.imageChooser.imageData;return a},focusItemByName:function(a){a&&this[a]?this[a].focus():console.log("Error name")}})})},
"builder/plugins/app-list/CardPageWithBigThumbnail":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/dom ./AppOperMenu dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CardPageWithBigThumbnail.html dojox/form/Uploader dojo/NodeList-dom".split(" "),function(p,f,a,l,k,h,q,m,g,e,c){return p([m,g,e],{baseClass:"card-page",templateString:c,loading:null,folderUrl:null,appListWidget:null,_eventHandles:null,_appOperMenus:null,
postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading;this.folderUrl=this.appListWidget.folderUrl},constructor:function(){this._eventHandles=[];this._appOperMenus=[]},startup:function(){this.inherited(arguments);f.setSelectable(this.domNode,!1)},refresh:function(a){this.createItemList(a)},cleanItemList:function(){f.empty(this.cardPageContent);a.forEach(this._appOperMenus,function(a){a.destroy()});this._appOperMenus=[];a.forEach(this._eventHandles,
function(a){a.remove()});this._eventHandles=[]},createItemList:function(c){this.cleanItemList();0<c.length?a.forEach(c,function(a){this.createItemCard(a)},this):this.appListWidget._addEmptyDescription(this.cardPageContent,"card-page")},createItemCard:function(c){var e=c.isTemplate?this.nls.preview:this.nls.launch,g=f.create("div",{"class":"item-card jimu-float-leading"},this.cardPageContent),m=f.create("a",{"class":"thumbnail-part",style:"background-image: url("+c.thumbnail+"?date\x3d"+this.appListWidget.getRefreshImageFlag()+
")",href:c.appUrl,target:"_blank",title:e},g);f.create("div",{"class":"item-type-div "+("HTML"===c.appType?"item-type-2d":"item-type-3d")},m);m=f.create("div",{"class":"appInfo-part"},g);f.create("div",{"class":"item-name-div",innerHTML:c.name,title:c.name},m);var p=f.create("div",{"class":"item-info-div"},m);f.create("div",{"class":"app-time-div jimu-float-leading",innerHTML:this.appListWidget._getLocaleDateTime(c.lastUpdated)},p);f.create("div",{"class":"app-creator-div jimu-float-trailing",innerHTML:c.creator},
p);f.create("div",{"class":"item-des-div "+(c.description?"":"place-holder-class"),innerHTML:c.description?c.description:this.nls.defaultDesc,title:c.description},m);g=f.create("div",{"class":"item-operation-part"},g);f.create("div",{innerHTML:'\x3ca href\x3d"'+c.appUrl+'" target\x3d"_blank"\x3e\x3c/a\x3e',"class":"item-operation launch-operation jimu-float-leading",title:e},g);c.isTemplate||f.create("div",{innerHTML:'\x3ca href\x3d"'+c.downloadUrl+'" target\x3d"downloadTargetFrame"\x3e\x3c/a\x3e',
"class":"item-operation download-operation jimu-float-leading",title:this.nls.download},g);var e=f.create("div",{"class":"item-operation edit-operation jimu-float-leading "+(c.isPredefined?"disable":""),title:c.isTemplate?this.nls.configTemplate:this.nls.configApp},g),b=f.create("div",{"class":"item-operation more-operation jimu-float-trailing "+(c.isPredefined?"disable":"")},g),v=(new q({app:c,posNode:b,appListWidget:this.appListWidget,nls:this.nls,isTemplate:c.isTemplate,appContentNode:this.cardPageContent,
height:c.isTemplate?c.isPredefined?45:162:122,offset:{top:44,left:-10,right:-10}})).placeAt(b);this._appOperMenus.push(v);m=k(b,"click",l.hitch(this,function(e){v.isShow?(v.hide(),f.removeClass(b,"item-more-selected")):(a.forEach(this._appOperMenus,function(a){a.hide();f.removeClass(a.posNode,"item-more-selected")}),v.show(),f.addClass(b,"item-more-selected"));e.itemId=c.id}));this._eventHandles.push(m);m=k(e,"click",l.hitch(this,function(){this.appListWidget.pluginManager.getPluginByName("startup").switchToAppConfig(c)}));
this._eventHandles.push(m);c.isTemplate&&(e=f.create("div",{"class":"item-operation create-app-from-item-operation jimu-float-leading",title:this.nls.createApp},g),m=k(e,"click",l.hitch(this,function(){v._onCreateAppFromTempalteClick()})),this._eventHandles.push(m));m=k(h.byId("content-box"),"click",l.hitch(this,function(a){a.itemId!==c.id&&(v.hide(),f.removeClass(b,"item-more-selected"))}));this._eventHandles.push(m)}})})},"builder/plugins/app-list/CardPageWithSmallThumbnail":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/dom ./AppOperMenu dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CardPageWithSmallThumbnail.html dojox/form/Uploader dojo/NodeList-dom".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c){return p([m,g,e],{baseClass:"card-page-with-small-thumbnail",templateString:c,loading:null,folderUrl:null,appListWidget:null,_eventHandles:null,_appOperMenus:null,postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading;this.folderUrl=this.appListWidget.folderUrl},constructor:function(){this._eventHandles=[];this._appOperMenus=[]},startup:function(){this.inherited(arguments);f.setSelectable(this.domNode,
!1)},refresh:function(a){this.createAppList(a)},cleanAppList:function(){f.empty(this.appCardPageContent);a.forEach(this._appOperMenus,function(a){a.destroy()});this._appOperMenus=[];a.forEach(this._eventHandles,function(a){a.remove()});this._eventHandles=[]},createAppList:function(c){this.cleanAppList();a.forEach(c,function(a){this.createAppCard(a)},this)},createAppCard:function(c){var e=c.isTemplate?this.nls.preview:this.nls.launch,g=f.create("div",{"class":"app-card-box jimu-float-leading"},this.appCardPageContent),
g=f.create("div",{"class":"card app-info-card"},g),m=f.create("div",{"class":"app-title-part"},g);f.create("div",{"class":"app-type-div "+("HTML"===c.appType?"app-type-2d":"app-type-3d")},m);var m=f.create("table",{"class":"app-title-table"},m),m=f.create("tbody",{"class":"app-title-table-body"},m),m=f.create("tr",{"class":"app-title-table-tr"},m),p=f.create("td",{"class":"app-thumbnail-td"},m);f.create("a",{"class":"app-thumbnail",style:"background-image: url("+c.thumbnail+"?date\x3d"+this.appListWidget.getRefreshImageFlag()+
")",href:c.appUrl,target:"_blank",title:e},p);m=f.create("td",{"class":"app-title-td"},m);f.create("div",{"class":"app-title-div",innerHTML:c.name},m);f.create("div",{"class":"app-time-div",innerHTML:this.appListWidget._getLocaleDateTime(c.lastUpdated)},m);f.create("div",{"class":"app-creator-div",innerHTML:c.creator},m);m=f.create("div",{"class":"app-desc-box"},g);f.create("div",{"class":"app-desc-part "+(c.description?"":"place-holder-class"),innerHTML:c.description?c.description:this.nls.defaultDesc,
title:c.description},m);g=f.create("div",{"class":"app-operation-part"},g);f.create("div",{innerHTML:'\x3ca href\x3d"'+c.appUrl+'" target\x3d"_blank"\x3e\x3c/a\x3e',"class":"app-operation launch-operation jimu-float-leading",title:e},g);c.isTemplate||f.create("div",{innerHTML:'\x3ca href\x3d"'+c.downloadUrl+'" target\x3d"downloadTargetFrame"\x3e\x3c/a\x3e',"class":"app-operation download-operation jimu-float-leading",title:this.nls.download},g);var e=f.create("div",{"class":"app-operation edit-operation jimu-float-leading "+
(c.isPredefined?"disable":""),title:c.isTemplate?this.nls.configTemplate:this.nls.configApp},g),b=f.create("div",{"class":"app-operation more-operation jimu-float-trailing "+(c.isPredefined?"disable":"")},g),v=(new q({app:c,posNode:b,appListWidget:this.appListWidget,nls:this.nls,isTemplate:c.isTemplate,appContentNode:this.appCardPageContent,height:c.isTemplate?c.isPredefined?45:162:122,offset:{top:44,left:-10,right:-10}})).placeAt(b);this._appOperMenus.push(v);m=k(b,"click",l.hitch(this,function(e){v.isShow?
(v.hide(),f.removeClass(b,"item-more-selected")):(a.forEach(this._appOperMenus,function(a){a.isShow&&(a.hide(),f.removeClass(a.posNode,"item-more-selected"))}),v.show(),f.addClass(b,"item-more-selected"));e.itemId=c.id}));this._eventHandles.push(m);m=k(e,"click",l.hitch(this,function(){this.appListWidget.pluginManager.getPluginByName("startup").switchToAppConfig(c)}));this._eventHandles.push(m);c.isTemplate&&(e=f.create("div",{"class":"app-operation create-app-from-item-operation jimu-float-leading",
title:this.nls.createApp},g),m=k(e,"click",l.hitch(this,function(){v._onCreateAppFromTempalteClick()})),this._eventHandles.push(m));m=k(h.byId("content-box"),"click",l.hitch(this,function(a){a.itemId!==c.id&&(f.removeClass(v.posNode,"item-more-selected"),v.hide())}));this._eventHandles.push(m)}})})},"builder/plugins/attribute-config/_build-generate_module":function(){define(["builder/plugins/attribute-config/Plugin","dojo/text!builder/plugins/attribute-config/Plugin.html","dojo/text!builder/plugins/attribute-config/css/style.css",
"dojo/i18n!builder/plugins/attribute-config/nls/strings"],function(){})},"builder/plugins/attribute-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/Color dojo/topic dojo/on dojo/query dojo/sniff dojo/Deferred dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html dojo/dom-style dojo/dom-construct dojo/_base/array builder/portalUtils builder/BasePlugin jimu/utils jimu/portalUrlUtils jimu/dijit/CheckBox jimu/dijit/ImageChooser jimu/dijit/Message jimu/dijit/LoadingIndicator esri/arcgis/AppProxyManager ./AppProxyUtil ./MapProxyItem ./UrlProxyItem builder/dijit/LinkEditor jimu/dijit/Popup dijit/Editor dojo/NodeList-dom dojo/NodeList-data jimu/dijit/ColorPicker dijit/form/Select dijit/_editor/plugins/FontChoice dijit/_editor/plugins/TextColor dijit/ToolbarSeparator".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A,B,F,E,H,I){return p([t,e],{templateString:c,appConfig:null,selectLinkNode:null,selectProxyRuleNode:null,initedLinks:!1,initedProxy:!1,_currentPortalUrl:null,showProxySetting:!1,showAlwaysUseProxy:!1,keepAppState:!0,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.own(k.subscribe("app/appConfigLoaded",f.hitch(this,this._onAppConfigLoaded)));this.own(k.subscribe("app/appConfigChanged",
f.hitch(this,this._onAppConfigChanged)));this.useProxySetting=new n({label:this.nls.useProxySetting,checked:!1},this.useProxySetting);this.alwaysUseProxy=new n({label:this.nls.alwaysUseProxyLabel,checked:!1},this.alwaysUseProxy);this._is3D()?d.set(this.appStateController,"display","none"):(d.set(this.appStateController,"display",""),this.appStateSetting=new n({label:this.nls.keepAppState,checked:!0,onChange:f.hitch(this,this._onAppStateSettingChange)},this.appStateSetting));window.isXT?(d.set(this.loadingPageController,
"display",""),this.bgImageCheckBox=new n({label:this.nls.backgroundImage,checked:!0,onChange:f.hitch(this,this._onBackgroundImageStatusChange)},this.bgCheckBoxDiv),this.gifImageCheckBox=new n({label:this.nls.loadingGifImage,checked:!0,onChange:f.hitch(this,this._onGifImageStatusChange)},this.gifCheckBoxDiv),this._onSelectGifMode()):d.set(this.loadingPageController,"display","none");this.linksEditor=new E({nls:this.nls,linkList:[],btnLabel:this.nls.addLink,canEdit:!0,canDelete:!0,isRest:!1,afterAdd:f.hitch(this,
this._publishLinksChange),afterUpdate:f.hitch(this,this._publishLinksChange),afterDelete:f.hitch(this,this._publishLinksChange)});this.linksEditor.placeAt(this.linksSection);this.bgImageChooser=new w({cropImage:!1,label:this.nls.selectFile,format:["image/png","image/jpeg"]},this.bgImageChooser);a.addClass(this.bgImageChooser.domNode,"jimu-trailing-margin1 loading-image-chooser");this.bgImageChooser.startup();this.gifImageChooser=new w({cropImage:!1,label:this.nls.selectFile,format:["image/gif"]},
this.gifImageChooser);a.addClass(this.gifImageChooser.domNode,"jimu-float-leading jimu-trailing-margin1 loading-image-chooser");this.gifImageChooser.startup();q(".header-section .label",this.domNode).style("display","none");this._bindEvents();this.loading=new z({hidden:!0},this.loadingNode);this.loading.startup()},startup:function(){this.inherited(arguments);this._keepOrder()},_bindEvents:function(){this.titleChangeHandle=h(this.titleNode,"change",f.hitch(this,this.onTitleChange));this.subtitleChangeHandle=
h(this.subtitleNode,"change",f.hitch(this,this.onSubtitleChange));this.own(this.titleChangeHandle);this.own(this.subtitleChangeHandle);this.own(h(this.imageChooser,"imageChange",f.hitch(this,"onLogoChange")));this.own(h(this.useProxySetting,"click",f.hitch(this,this._onUseProxySettingChange)));this.own(h(this.alwaysUseProxy,"click",f.hitch(this,this._onAlwaysUseProxyChange)));this.own(h(this.proxyUrlNode,"change",f.hitch(this,this._onProxyUrlChange)));this.own(h(this.proxyUrlNode,"blur",f.hitch(this,
this._onProxyUrlBlur)));this.own(h(this.appIdNode,"change",f.hitch(this,this._onAppIdChange)));this.own(h(this.domNode,"click",f.hitch(this,function(){q(".header-button",this.domNode).removeClass("highlight-button");this.selectLinkNode&&(a.removeClass(this.selectLinkNode,"selected-item"),this.selectLinkNode=null);this.selectProxyRuleNode&&(a.removeClass(this.selectProxyRuleNode,"selected-item"),this.selectProxyRuleNode=null)})));window.isXT&&(this.own(h(this.loadingPageController,"click",f.hitch(this,
this._switchToLoading))),this.own(h(this.backController,"click",f.hitch(this,this._switchToApp))),this.own(h(this.bgColorPicker,"change",f.hitch(this,this._onBackgroundColorChange))),this.own(h(this.gifSelect,"change",f.hitch(this,this._onGifSelectChange))),this.own(h(this.bgImageChooser,"imageChange",f.hitch(this,this._onBackgroundImageUpload))),this.own(h(this.gifImageChooser,"imageChange",f.hitch(this,this._onLoadingGifUpload))));this.own(h(this.appProxyController,"click",f.hitch(this,this._switchToAppProxy)));
this.own(h(this.backController2,"click",f.hitch(this,this._switchToApp)))},_createAppProxySection:function(){this.appProxyManager.loaded?(this._checkMapProxy(),this._checkUrlProxy()):this.own(h.once(this.appProxyManager,"load",f.hitch(this,function(){this._checkMapProxy();this._checkUrlProxy()})))},init:function(a){this.appConfig=a||{};this.initHeader(a);this.initLinks(a);this._is3D()||this.initAppStateSetting(a);this.initedProxy||(this.initProxy(a),this.initedProxy=!0);this._currentPortalUrl!==a.portalUrl&&
(this.initAppId(a),this._currentPortalUrl=a.portalUrl);window.isXT&&this.initLoadingPage(a);!this._is3D()&&this._isOnline()&&!window.isXT?(this.appProxyManager||(this.appProxyManager=new y({appid:window.appInfo.id})),d.set(this.appProxyController,"display",""),this._createAppProxySection()):d.set(this.appProxyController,"display","none")},_isOnline:function(){var a=v.getStandardPortalUrl(window.portalUrl);return v.isOnline(a)},_checkMapProxy:function(){this.appConfig&&this.appConfig.map&&(this.appConfig.map.appProxy?
this.appConfig.map.itemId===this.appConfig.map.appProxy.mapItemId?this._createMapProxyTable(this.appConfig.map.appProxy.proxyItems):this._refreshMapProxy():this._refreshMapProxy())},_refreshMapProxy:function(){A.queryForSecureServicesInMap(this.appConfig.map.portalUrl,this.appConfig.map.itemId).then(f.hitch(this,function(a){a&&0<a.length&&this._publishAppProxy(a);this._createMapProxyTable(a)}))},_createMapProxyTable:function(b){a.empty(this.mapProxyContent);!b||0===b.length?(a.setStyle(this.mapSection,
"display","none"),a.removeClass(this.urlSection,"double-margin")):(a.setStyle(this.mapSection,"display",""),a.addClass(this.urlSection,"double-margin"),u.forEach(b,f.hitch(this,function(b){!0===b.useProxy&&!this._proxyExists(b)&&(b.useProxy=!1,b.proxyUrl="",b.proxyId="",this._publishAppProxy([{sourceUrl:b.sourceUrl,useProxy:!1}]));b=new B({appProxyManager:this.appProxyManager,sourceUrl:b.sourceUrl,title:b.title,premium:!0===b.premium,consumeCredits:!0===b.consumeCredits,useProxy:!0===b.useProxy,proxyUrl:b.proxyUrl||
"",proxyId:b.proxyId||"",nls:this.nls});this.own(h(b,B.PROCESS_START,f.hitch(this,function(){this.loading.show()})));this.own(h(b,B.PROCESS_END,f.hitch(this,function(){this.loading.hide()})));this.own(h(b,B.PROXY_CREATED,f.hitch(this,function(a){this._publishAppProxy([a])})));this.own(h(b,B.PROXY_DELETED,f.hitch(this,function(a){this._publishAppProxy([a])})));this.own(h(b,B.PROCESS_ERROR,f.hitch(this,function(a){new x({message:a})})));a.place(b.domNode,this.mapProxyContent)})))},_proxyExists:function(a){if(this.appProxyManager){var b=
this.appProxyManager.get("proxies");if(b&&0<b.length)return u.some(b,function(b){return b.sourceUrl===a.sourceUrl&&b.proxyUrl===a.proxyUrl&&b.proxyId===a.proxyId})}return!1},_checkUrlProxy:function(){this.proxyLinkEditor||(this.proxyLinkEditor=new E({nls:this.nls,linkList:[],btnLabel:this.nls.addUrlProxy,canEdit:!1,canDelete:!0,isRest:!0,beforeAdd:f.hitch(this,this._createUrlAppProxy),afterDelete:f.hitch(this,this._deleteUrlAppProxy)}),this.proxyLinkEditor.placeAt(this.linkEditorNode));if(this.appConfig&&
this.appConfig.appProxies){var a=[];u.forEach(this.appConfig.appProxies,function(b){this._proxyExists(b)?a.push({label:b.title,url:b.sourceUrl}):this._deleteUrlProxy(b.sourceUrl)},this);this.proxyLinkEditor.setItems(a)}},_createUrlAppProxy:function(a){a=new F({appProxyManager:this.appProxyManager,sourceUrl:a.url,title:a.label,nls:this.nls});var b=new g;this.own(h(a,F.PROCESS_START,f.hitch(this,function(){this.loading.show()})));this.own(h(a,F.PROCESS_END,f.hitch(this,function(){this.loading.hide()})));
this.own(h(a,F.PROXY_CREATED,f.hitch(this,function(a){this._addUrlProxy(a);b.resolve(!0)})));this.own(h(a,F.PROCESS_ERROR,f.hitch(this,function(a){b.resolve(!1);new x({message:a})})));a.createProxy();return b},_deleteUrlAppProxy:function(a){var b={appProxyManager:this.appProxyManager,sourceUrl:a.url,title:a.label,nls:this.nls};u.some(this.appConfig.appProxies,function(c){if(c.sourceUrl===a.url)return f.mixin(b,{proxyId:c.proxyId,proxyUrl:c.proxyUrl,useProxy:c.useProxy}),!0});(new F(b)).deleteProxy();
this._deleteUrlProxy(b.sourceUrl)},_publishAppProxy:function(a){k.publish("appProxyForMapChanged",{mapItemId:this.appConfig.map.itemId,proxyItems:a})},_addUrlProxy:function(a){var b=[];this.appConfig.appProxies&&0<this.appConfig.appProxies.length&&(b=f.clone(this.appConfig.appProxies));b.push({sourceUrl:a.sourceUrl,title:a.title,premium:a.premium,consumeCredits:a.consumeCredits,useProxy:a.useProxy,proxyUrl:a.proxyUrl,proxyId:a.proxyId});setTimeout(function(){k.publish("appProxyForUrlChanged",b)},
100)},_deleteUrlProxy:function(a){var b=u.filter(this.appConfig.appProxies,function(b){return b.sourceUrl!==a});setTimeout(function(){k.publish("appProxyForUrlChanged",b)},100)},_onAppConfigLoaded:function(a){this._setAppConfig(a)},_onAppConfigChanged:function(a){this._setAppConfig(a)},_setAppConfig:function(a){this.init(a)},_publishLinksChange:function(){k.publish("appAttributeChanged",{links:this.getLinks()})},initHeader:function(c){var d=c.logo||"";d?(d&&(!d.startWith("/")&&!d.startWith("http")&&
!d.startWith("data"))&&(d=window.appInfo.appPath+d),this.imageChooser.setDefaultSelfSrc(d),a.addClass(this.logoContainer,"logo"),a.removeClass(this.logoContainer,"no-logo"),a.addClass(this.addLogoNode,"hide"),this._resetLogoBox(50)):(this.imageChooser.setDefaultSelfSrc(d),a.addClass(this.logoContainer,"no-logo"));d="";c.title&&(d=b.stripHTML(c.title),q(this.titleNode).data("config",c.title),/<([a-z]+)\s*.*>/ig.test(c.title)&&(this.titleNode.disabled=!0,this.titleNode.title=d),a.setAttr(this.titleNode,
"value",d));c.subtitle&&(d=b.stripHTML(c.subtitle),q(this.subtitleNode).data("config",c.subtitle),/<([a-z]+)\s*.*>/ig.test(c.subtitle)&&(this.subtitleNode.disabled=!0,this.subtitleNode.title=d),a.setAttr(this.subtitleNode,"value",d))},onLogoContainerMouseEnter:function(){10>m("ie")&&(this._hasEntered?a.setStyle(this.removeLogoNode,{display:"block"}):(a.setStyle(this.changeLogoNode,{display:"none"}),setTimeout(f.hitch(this,function(){var b=a.position(this.logoContainer);a.place(this.removeLogoNode,
this.ownerDocumentBody);a.addClass(this.removeLogoNode,"attribute-config-plugin-logo-options");a.setStyle(this.removeLogoNode,{position:"absolute",display:"block",left:(window.isRTL?b.x+5:b.x+b.w-35)+"px",top:b.y+5+"px"});this._hasEntered=!0}))))},onMouseLeaveAttributeConfig:function(){10>m("ie")&&(a.setStyle(this.removeLogoNode,{display:"none"}),this._hasEntered=!1)},onRemoveLogo:function(){this.imageChooser.imageData&&(this.imageChooser.setDefaultSelfSrc(""),a.removeClass(this.logoContainer,"logo"),
a.removeClass(this.addLogoNode,"hide"),a.addClass(this.logoContainer,"no-logo"),k.publish("appAttributeChanged",{logo:""}))},onChangeLogo:function(){var a=this.imageChooser.mask;if(m("safari")){var b=document.createEvent("MouseEvents");b.initEvent("click",!0,!0);a.dispatchEvent(b)}else a.click()},onLogoChange:function(a){this._changeLogo();k.publish("appAttributeChanged",{logo:a})},onTitleChange:function(a){k.publish("appAttributeChanged",{title:a.target.disabled?q(a.target).data("config")[0]:a.target.value})},
onSubtitleChange:function(a){k.publish("appAttributeChanged",{subtitle:a.target.disabled?q(a.target).data("config")[0]:a.target.value})},onTitleEditorClick:function(){this._editText(this.titleNode)},onSubtitleEditorClick:function(){this._editText(this.subtitleNode)},_editText:function(c){this.editor=new I({plugins:["bold","italic","underline","foreColor"],extraPlugins:["|","fontName","fontSize"]});var d=a.position(c),e=new H({titleLabel:this.nls.formatStyle,width:window.isRTL?695:680,height:250,content:this.editor.domNode,
buttons:[{label:window.jimuNls.common.reset,title:this.nls.restoreStyle,onClick:f.hitch(this,function(){var a=this.editor.get("value"),a=b.stripHTML(a);this.editor.set("value",a)})},{label:window.jimuNls.common.ok,onClick:f.hitch(this,function(){var a=this.editor.get("value");q(c).data("config",a);var d=b.stripHTML(a);/<([a-z]+)\s*.*>/ig.test(a)?(c.disabled=!0,c.title=d):""===d&&(c.disabled=!1,c.title="");c.value=d;if(c===this.titleNode)this.onTitleChange({target:c});else if(c===this.subtitleNode)this.onSubtitleChange({target:c});
this.editor.destroy();this.editor=null;e.close()})},{label:window.jimuNls.common.cancel,classNames:["jimu-btn-vacation"],onClick:f.hitch(this,function(){this.editor.destroy();this.editor=null;e.close()})}],onClose:f.hitch(this,function(){this.editor&&this.editor.destroy();return!0})});window.isRTL?a.setStyle(e.domNode,{top:d.y+d.h+5+"px",left:d.x+d.w-(window.isRTL?695:680)+"px"}):a.setStyle(e.domNode,{top:d.y+d.h+5+"px",left:d.x+"px"});a.addClass(e.domNode,"format-font-style");a.setStyle(this.editor.domNode,
{width:"100%",height:"100%"});this.editor.startup();8!==m("ie")&&this.editor.resize({w:"100%",h:"100%"});this.editor.set("value",q(c).data("config")[0])},initLinks:function(a){a.links&&this.linksEditor.setItems(a.links)},initProxy:function(b){if(b=b.httpProxy)this.useProxySetting.setValue(b.useProxy),this.showProxySetting=!!b.useProxy,this._onUseProxySettingChange(),this.alwaysUseProxy.setValue(b.alwaysUseProxy),this.showAlwaysUseProxy=!!b.alwaysUseProxy,this._onAlwaysUseProxyChange(),b.url&&a.setAttr(this.proxyUrlNode,
"value",b.url),b.rules&&(a.empty(this.proxyRulesListNode),u.forEach(b.rules,f.hitch(this,function(a){this.createProxyRuleNode(a)})))},initAppStateSetting:function(a){this.appStateSetting.setValue(Boolean(a.keepAppState))},initAppId:function(b){s.getPortal(b.portalUrl).loadSelfInfo().then(f.hitch(this,function(c){c.supportsOAuth?(a.setStyle(this.appIdSection,"display","none"),a.setAttr(this.appIdNode,"value",b.appId)):a.setStyle(this.appIdSection,"display","none")}),f.hitch(this,function(a){this.shelter.hide();
console.error(a)}))},getLinks:function(){var a=[];u.forEach(this.linksEditor.getItems(),function(b){a.push({label:b.label,url:b.url})});return a},getProxy:function(){var b=[],c=a.getAttr(this.proxyUrlNode,"value");q(".proxy-rule-list .list-item",this.domNode).forEach(f.hitch(this,function(a){var c=q(".first input",a).attr("value")[0];a=q(".second input",a).attr("value")[0];c&&b.push({urlPrefix:c,proxyUrl:a})}));return{useProxy:this.useProxySetting.getValue(),alwaysUseProxy:this.alwaysUseProxy.getValue(),
url:c,rules:b}},_changeLogo:function(){a.setStyle(this.imageChooser.selfImg,{width:"auto",height:"auto",marginLeft:"auto",marginRight:"auto",marginTop:"auto",marginBottom:"auto"});a.removeClass(this.logoContainer,"no-logo");a.addClass(this.logoContainer,"logo");a.addClass(this.addLogoNode,"hide");a.removeClass(this.imageChooser.domNode,"hide");setTimeout(f.hitch(this,this._resetLogoBox,4),4)},_resetLogoBox:function(b){if(this.domNode&&this.imageChooser){var c=a.getContentBox(this.imageChooser.selfImg);
0<c.w?(b=a.getContentBox(this.imageChooser.domNode),c=c.w/c.h,1>=c?(a.setStyle(this.imageChooser.selfImg,"height",b.h+"px"),c=(b.w-b.h*c)/2,a.setStyle(this.imageChooser.selfImg,{marginLeft:c+"px",marginRight:c+"px"})):(a.setStyle(this.imageChooser.selfImg,"width",b.w+"px"),c=(b.h-b.w/c)/2,a.setStyle(this.imageChooser.selfImg,{marginTop:c+"px",marginBottom:c+"px"}))):setTimeout(f.hitch(this,this._resetLogoBox,b),b)}},_bindNodeEvents:function(b,c,d,e,g,l){this.own(h(b,"click",f.hitch(this,function(c){q(".header-button",
this.domNode).addClass("highlight-button");"links"===l?(this.selectLinkNode&&a.removeClass(this.selectLinkNode,"selected-item"),a.addClass(b,"selected-item"),this.selectLinkNode=b):"proxyRules"===l&&(this.selectProxyRuleNode&&a.removeClass(this.selectProxyRuleNode,"selected-item"),a.addClass(b,"selected-item"),this.selectProxyRuleNode=b);c.stopPropagation()})));this.own(h(c,"dblclick",f.hitch(this,function(){a.setStyle(c,"display","none");a.setStyle(d,"display","block");d.focus();d.select()})));this.own(h(e,
"dblclick",f.hitch(this,function(){a.setStyle(e,"display","none");a.setStyle(g,"display","block");g.focus();g.select()})));this.own(h(g,"focus",function(a){a.target.value||(a.target.value="http://")}));this.own(h(d,"blur",f.hitch(this,function(b){a.setAttr(c,{innerHTML:b.target.value||c.innerHTML,style:{display:"block"}});a.setStyle(d,"display","none");"links"===l?k.publish("appAttributeChanged",{links:this.getLinks()}):"proxyRules"===l&&this._publishProxy()})));this.own(h(g,"blur",f.hitch(this,function(b){a.setAttr(e,
{innerHTML:b.target.value||e.innerHTML,style:{display:"block"}});a.setStyle(g,"display","none");"links"===l?(b=this._formatLinkValue(b.target.value),a.setAttr(e,"innerHTML",b),a.setAttr(g,"value",b),k.publish("appAttributeChanged",{links:this.getLinks()})):"proxyRules"===l&&this._publishProxy()})))},_formatLinkValue:function(a){var b="";return b=/^http(s?):\/\//.test(a)?a:/^\/\//.test(a)?"http:"+a:"http://"+a},_createListItem:function(b,c,d,e,f){var g=a.create("div",{"class":"list-item"}),h=a.create("div",
{"class":"first jimu-float-leading"},g);d=a.create("div",{"class":"mask",innerHTML:c||d,title:d},h);var h=a.create("input",{style:{display:"none"}},h),k=a.create("div",{"class":"second jimu-float-leading"},g);f=a.create("div",{"class":"mask",innerHTML:e||f,title:f},k);k=a.create("input",{style:{display:"none"}},k);a.setAttr(h,"value",c);a.setAttr(k,"value",e);this._bindNodeEvents(g,d,h,f,k,b);c||this.focusNewItem(g,d,h,b);return g},focusNewItem:function(b,c,d,e){"links"===e?(this.selectLinkNode&&
a.removeClass(this.selectLinkNode,"selected-item"),a.addClass(b,"selected-item"),this.selectLinkNode=b):"proxyRules"===e&&(this.selectProxyRuleNode&&a.removeClass(this.selectProxyRuleNode,"selected-item"),a.addClass(b,"selected-item"),this.selectProxyRuleNode=b);a.setStyle(c,"display","none");a.setStyle(d,"display","block");d.value=c.innerHTML;setTimeout(function(){d.focus();d.select()},0)},createProxyRuleNode:function(b){b=this._createListItem("proxyRules",b.urlPrefix,this.nls.prefixPlaceholder,
b.proxyUrl,this.nls.proxyUrlPlaceholder);a.place(b,this.proxyRulesListNode)},_keepOrder:function(){var b=a.getMarginBox(this.headerSection),c=a.getMarginBox(this.linksSection),d=a.getMarginBox(this.appIdSection),e=a.getMarginBox(this.useProxySection),b=b.h+c.h+d.h+e.h,c=a.getMarginBox(this.domNode).h;b>c&&a.setStyle(this.domNode,"paddingRight","10px")},_onEditItemClick:function(b){var c=q(".first .mask",b)[0];b=q(".first input",b)[0];a.setStyle(c,"display","none");a.setStyle(b,"display","block");
b.focus();b.select()},onAddProxyRuleClick:function(a){this.createProxyRuleNode({urlPrefix:"",proxyUrl:""});this._keepOrder();a.stopPropagation()},onEditProxyRuleClick:function(){this.selectProxyRuleNode&&this._onEditItemClick(this.selectProxyRuleNode)},onDeleteProxyRuleClick:function(){this.selectProxyRuleNode&&(a.destroy(this.selectProxyRuleNode),k.publish("appAttributeChanged",{httpProxy:this.getProxy()}))},_onUseProxySettingChange:function(){this.useProxySetting.checked?a.setStyle(this.proxySection,
"display","block"):a.setStyle(this.proxySection,"display","none");this.showProxySetting!==this.useProxySetting.checked&&(this._publishProxy(),this.showProxySetting=this.useProxySetting.checked)},_onAlwaysUseProxyChange:function(){this.showAlwaysUseProxy!==this.alwaysUseProxy.checked&&(this._publishProxy(),this.showAlwaysUseProxy=this.alwaysUseProxy.checked)},_onProxyUrlChange:function(){this._publishProxy()},_onProxyUrlBlur:function(){this.proxyUrlNode.value?a.removeClass(this.proxyUrlNode,"error-status"):
a.addClass(this.proxyUrlNode,"error-status")},_onAppIdChange:function(){k.publish("appAttributeChanged",{appId:this.appIdNode.value})},_onAppStateSettingChange:function(){this.keepAppState!==this.appStateSetting.checked&&(this.keepAppState=this.appStateSetting.checked,k.publish("appAttributeChanged",{keepAppState:this.keepAppState}))},_publishProxy:function(){k.publish("appAttributeChanged",{httpProxy:this.getProxy()})},initLoadingPage:function(a){this.showLoadingGif=this.showBackgroundImage=!0;"object"===
typeof a.loadingPage&&(a=a.loadingPage,/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(a.backgroundColor)&&this.bgColorPicker.setColor(new l(a.backgroundColor)),this._initBackgroundImage(a),this._initLoadingGif(a))},_switchToLoading:function(){d.set(this.attributeSection,"display","none");d.set(this.loadingPageSection,"display","");k.publish("actionTriggered",{action:"showLoading"})},_switchToAppProxy:function(){d.set(this.attributeSection,"display","none");d.set(this.appProxySection,"display","")},_switchToApp:function(){d.set(this.attributeSection,
"display","");d.set(this.loadingPageSection,"display","none");d.set(this.appProxySection,"display","none");k.publish("actionTriggered",{action:"showApp"})},_initBackgroundImage:function(a){a.backgroundImage?a.backgroundImage.visible?(this.showBackgroundImage=!0,this.bgImageCheckBox.check(),d.set(this.bgUploaderDiv,"display","")):(this.showBackgroundImage=!1,this.bgImageCheckBox.uncheck(),d.set(this.bgUploaderDiv,"display","none")):(this.showBackgroundImage=!1,this.bgImageCheckBox.uncheck(),d.set(this.bgUploaderDiv,
"display","none"))},_initLoadingGif:function(a){var b=0;a.loadingGif?(a.loadingGif.visible?(this.showLoadingGif=!0,this.gifImageCheckBox.check(),d.set(this.gifModeSection,"display","")):(this.showLoadingGif=!1,this.gifImageCheckBox.uncheck(),d.set(this.gifModeSection,"display","none")),/^configs\/loading\/images/.test(a.loadingGif.uri)&&(a.loadingGif.uri=window.appInfo.appPath+a.loadingGif.uri),/^data:image\/.*;base64,/.test(a.loadingGif.uri)||/loading\.gif$/.test(a.loadingGif.uri)?(this.uploadMode.checked=
!0,this._onUploadGifMode()):(this.selectMode.checked=!0,this._onSelectGifMode(),a=a.loadingGif.uri.match(/images\/(.*)/)[1],b=a.match(/\d+/),this.gifSelect.set("value",b[0]))):(this.showLoadingGif=!1,this.gifImageCheckBox.uncheck(),d.set(this.gifModeSection,"display","none"))},_getLoadingGifSetting:function(){var a={};this.appConfig&&(this.appConfig.loadingPage&&this.appConfig.loadingPage.loadingGif)&&(a=this.appConfig.loadingPage.loadingGif);return a},_getLoadingBackgroundColor:function(){return this.appConfig&&
this.appConfig.loadingPage&&this.appConfig.loadingPage.backgroundColor?this.appConfig.loadingPage.backgroundColor:""},_onBackgroundColorChange:function(a){r.empty(this.bgColorPicker.domNode);r.create("span",{innerHTML:a.toHex(),style:{color:b.invertColor(a.toHex())}},this.bgColorPicker.domNode);a.toHex()!==this._getLoadingBackgroundColor()&&k.publish("loadingPageChanged",{backgroundColor:this.bgColorPicker.getColor().toHex()})},_onBackgroundImageStatusChange:function(a){a!==this.showBackgroundImage&&
(this.showBackgroundImage=a,k.publish("loadingPageChanged",{backgroundImage:{visible:this.showBackgroundImage}}))},_onBackgroundImageUpload:function(a){var b=new Image;b.src=a;this.own(h(b,"load",f.hitch(this,function(){k.publish("loadingPageChanged",{backgroundImage:{uri:a,width:b.width,height:b.height}})})))},_onSelectGifMode:function(){d.set(this.predefinedGif,"display","");d.set(this.customGif,"display","none")},_onUploadGifMode:function(){d.set(this.predefinedGif,"display","none");d.set(this.customGif,
"display","")},_onGifImageStatusChange:function(a){a!==this.showLoadingGif&&(this.showLoadingGif=a,k.publish("loadingPageChanged",{loadingGif:{visible:this.showLoadingGif}}))},_onGifSelectChange:function(a){if("0"!==a){var b=this._getLoadingGifSetting(),c=null;b.uri&&/images\/.*/.test(b.uri)&&(b=b.uri.match(/images\/(.*)/)[1],c=b.match(/\d+/));if(null===c||a!==c[0])b=[{width:58,height:58},{width:58,height:10},{width:32,height:32},{width:34,height:34}][a-1],k.publish("loadingPageChanged",{loadingGif:{uri:window.appInfo.appPath+
"configs/loading/images/predefined_loading_"+a+".gif",width:b?b.width:0,height:b?b.height:0}})}},_onLoadingGifUpload:function(a){var b=new Image;b.src=a;this.own(h(b,"load",f.hitch(this,function(){k.publish("loadingPageChanged",{loadingGif:{uri:a,width:b.width,height:b.height}});this.gifSelect.set("value",0)})))},_is3D:function(){return"HTML3D"===window.appInfo.appType}})})},"jimu/dijit/CheckBox":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/html dojo/dom-class dojo/on dojo/Evented".split(" "),
function(p,f,a,l,k,h,q){return p([f,q],{baseClass:"jimu-checkbox",declaredClass:"jimu.dijit.CheckBox",checked:!1,status:!0,label:"",postCreate:function(){this.checkNode=l.create("div",{"class":"checkbox jimu-float-leading"},this.domNode);this.labelNode=l.create("div",{"class":"label jimu-float-leading",innerHTML:this.label||""},this.domNode);this.checked&&l.addClass(this.checkNode,"checked");this.status||l.addClass(this.domNode,"jimu-state-disabled");this.own(h(this.checkNode,"click",a.hitch(this,
function(){this.status&&(this.checked?this.uncheck():this.check())})));this.own(h(this.labelNode,"click",a.hitch(this,function(){this.checked&&this.status?this.uncheck():this.status&&this.check()})));this._udpateLabelClass()},setLabel:function(a){this.label=a;this.labelNode.innerHTML=this.label;this._udpateLabelClass()},_udpateLabelClass:function(){this.labelNode&&(this.labelNode.innerHTML?l.removeClass(this.labelNode,"not-visible"):l.addClass(this.labelNode,"not-visible"))},setValue:function(a){this.status&&
(!0===a?this.check():this.uncheck())},getValue:function(){return this.checked},setStatus:function(a){a=!!a;var f=this.status!==a;(this.status=a)?k.remove(this.domNode,"jimu-state-disabled"):k.add(this.domNode,"jimu-state-disabled");f&&this.emit("status-change",a)},getStatus:function(){return this.status},check:function(){this.status&&(this.checked=!0,l.addClass(this.checkNode,"checked"),this.onStateChange())},uncheck:function(a){if(this.status&&(this.checked=!1,l.removeClass(this.checkNode,"checked"),
!a))this.onStateChange()},onStateChange:function(){if(this.onChange&&a.isFunction(this.onChange))this.onChange(this.checked);this.emit("change",this.checked)}})})},"esri/arcgis/AppProxyManager":function(){define("dojo/_base/declare dojo/_base/lang ../kernel dojo/uacss dojo/Deferred dojo/promise/all dojo/json dojo/Evented dojo/Stateful ../request ./utils".split(" "),function(p,f,a,l,k,h,q,m,g,e,c){return p([m,g],{constructor:function(a){this.defaults={appid:"",hitsPerInterval:100,intervalSeconds:60,
referrers:[],proxies:[]};a=f.mixin({},this.defaults,a);this.set(a);this._init()},createProxies:function(a){var c=new k;this._registerApp(this._appItem).then(f.hitch(this,function(){for(var g={referrers:this.referrers,hitsPerInterval:this.hitsPerInterval,intervalSeconds:this.intervalSeconds},h=[],k=0;k<a.length;k++)h.push({sourceUrl:a[k].sourceUrl});k=this._sharingBaseUrl+"content/users/"+this._owner+"/";this._folderId&&(k+=this._folderId+"/");k+="items/"+this.appid+"/createProxies";e({url:k,content:{proxies:q.stringify(h),
serviceProxyParams:q.stringify(g),f:"json"},callbackParamName:"callback"},{usePost:!0}).then(f.hitch(this,function(a){this.set("proxies",a.appProxies||[]);c.resolve(a.appProxies)}),c.reject)}),c.reject);return c.promise},deleteProxies:function(a){var c=new k,g={f:"json"},h=[];if(a&&a.length)for(var l=0;l<a.length;l++)h.push(a[l].proxyId);h&&h.length&&(g.proxies=h.toString());a=this._sharingBaseUrl+"content/users/"+this._owner+"/";this._folderId&&(a+=this._folderId+"/");a+="items/"+this.appid+"/deleteProxies";
e({url:a,content:g,callbackParamName:"callback"},{usePost:!0}).then(f.hitch(this,function(a){var d=this.proxies.slice();a=a.results;if(d&&d.length&&a&&a.length)for(var e=0;e<d.length;e++)for(var f=d[e],g=f.proxyId,h=0;h<a.length;h++){var k=a[h].proxyId;k&&(g&&k===g)&&(f.proxied=!1)}this.set("proxies",d);c.resolve(d)}),c.reject);return c.promise},_parseUrl:function(a){var c=document.createElement("a");c.href=a;return c},_init:function(){this.appid?c.getItem(this.appid).then(f.hitch(this,function(a){this._appItem=
a;this._folderId=a.item.ownerFolder;var c=this._parseUrl(a.item.url);this._sharingBaseUrl="//"+c.hostname+"/sharing/rest/";var e=c.pathname.substring(0,c.pathname.lastIndexOf("/")),e="/"===e.charAt(0)?e:"/"+e,c=c.hostname+e,e="https://"+c;this.referrers.push("http://"+c);this.referrers.push(e);this._owner=a.item.owner;-1!==a.item.typeKeywords.indexOf("App Proxy")&&a.item.appProxies&&this.set("proxies",a.item.appProxies);this.emit("load",{});this.set("loaded",!0)})):console.error("AppProxyManager: appid required.")},
_registerApp:function(a){var c=new k,g=a.item.id,h=this._sharingBaseUrl+"oauth2/",l=this.referrers;!this._registered||this._registered!==this.appid?-1!==a.item.typeKeywords.indexOf("Registered App")?c.resolve(a):e({url:h+"/registerApp",content:{itemId:g,appType:"browser",redirect_uris:q.stringify(l),f:"json"},callbackParamName:"callback"},{usePost:!0}).then(f.hitch(this,function(a){this._registered=this.appid;c.resolve(a)}),c.reject):c.resolve(a);return c.promise}})})},"builder/plugins/attribute-config/AppProxyUtil":function(){define(["dojo/_base/array",
"dojo/Deferred","jimu/portalUtils"],function(p,f,a){function l(a){return p.some(q,function(c){return-1<a.search(c)})}function k(a){return p.some(m,function(c){return-1<a.search(c)})}function h(a){var c=new f;if(a){var d=[];p.forEach(a.operationalLayers,function(a){var c,e;c=a.url;e=document.createElement("a");e.href=c;c=l(e.host);e=k(e.host);if(c||e)d.push({sourceUrl:a.url,title:a.title||a.name,premium:c,consumeCredits:e,useProxy:!1})});c.resolve(d)}else c.resolve([]);return c}var q=[/traffic\w*\.arcgis\.com/i,
/landsat\w*\.arcgis\.com/i,/elevation\w*\.arcgis\.com/i,/geoenrich\w*\.arcgis\.com/i,/hydro\w*\.arcgis\.com/i,/naip\w*\.arcgis\.com/i,/livefeeds\w*\.arcgis\.com/i,/demographics\w*\.arcgis\.com/i,/landscape\w*\.arcgis\.com/i,/historical\w*\.arcgis\.com/i,/earthobs\w*\.arcgis\.com/i],m=[/demographics\w*\.arcgis\.com/i,/geoenrich\w*\.arcgis\.com/i,/route\w*\.arcgis\.com/i,/logistics\w*\.arcgis\.com/i,/analysis\w*\.arcgis\.com/i,/elevation\w*\.arcgis\.com/i],g={queryForSecureServicesInMap:function(e,
c){try{return a.getPortal(e).getItemData(c).then(function(a){return h(a)},function(){return[]})}catch(d){var g=new f;g.resolve([]);return g}}};g.isPremium=l;g.consumesCredits=k;return g})},"builder/plugins/attribute-config/MapProxyItem":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/html dojo/Evented dojo/on dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin jimu/dijit/CheckBox".split(" "),function(p,f,a,l,k,h,q,m,g){p=p([q,m,g,k],{baseClass:"map-proxy-item",
templateString:'\x3cdiv class\x3d"row"\x3e\x3cdiv data-dojo-attach-point\x3d"layerTitle" class\x3d"col" title\x3d"${title}"\x3e${title}\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"consumeCreditsContent" class\x3d"col credits-value"\x3e\x3c/div\x3e\x3cdiv class\x3d"use-proxy col" data-dojo-attach-point\x3d"useProxyCheckBox" data-dojo-type\x3d"jimu/dijit/CheckBox"\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"loading" class\x3d"loading-content"\x3e\x3c/div\x3e\x3c/div\x3e',appProxyManager:null,
sourceUrl:"",title:"",useProxy:!1,proxyUrl:"",proxyId:"",premium:!0,consumeCredits:!1,postCreate:function(){this.inherited(arguments);!0===this.consumeCredits&&l.addClass(this.consumeCreditsContent,"credits");l.setStyle(this.loading,"display","none");this.useProxyCheckBox.setStatus(!0);!0===this.useProxy&&this.proxyId&&this.proxyUrl?this.useProxyCheckBox.setValue(!0):this.useProxyCheckBox.setValue(!1);this.own(h(this.useProxyCheckBox,"change",a.hitch(this,this._onUseProxyChange)))},_onUseProxyChange:function(a){a&&
!this.proxyId&&this._createProxy();!a&&this.proxyId&&this._deleteProxy()},_createProxy:function(){this._startProcess("Create Proxy");if(this.appProxyManager){var e=!1;this.appProxyManager.proxies&&0<this.appProxyManager.proxies.length&&(e=f.some(this.appProxyManager.proxies,function(a){return a.sourceUrl===this.sourceUrl&&a.proxyId&&a.proxyUrl}));if(e)this._checkCreateProxiesCallback(this.appProxyManager.proxies);else try{this.appProxyManager.createProxies([{sourceUrl:this.sourceUrl}]).then(a.hitch(this,
this._checkCreateProxiesCallback),a.hitch(this,this._createProxiesFail))}catch(c){this._createProxiesFail(c.message)}}else this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl),this._stopProcess("appProxyManager is undefined",!1)},_checkCreateProxiesCallback:function(e){f.some(e,a.hitch(this,function(a){if(a.sourceUrl===this.sourceUrl)return this.proxyUrl=a.proxyUrl,this.proxyId=a.proxyId,this.useProxy=!0}))?(this.emit("proxyCreated",{sourceUrl:this.sourceUrl,proxyUrl:this.proxyUrl,
proxyId:this.proxyId,title:this.title,useProxy:!0}),this._stopProcess("Create Proxy",!0)):(this.emit("processError",this.nls.createProxyFailed+" "+this.sourceUrl),this._stopProcess("Create Proxy",!1))},_createProxiesFail:function(a){this.proxyUrl=this.proxyId="";this.useProxy=!1;this.emit("processError",this.nls.createProxyFailed+" "+this.sourceUrl);this._stopProcess(a||"Create Proxy",!1)},_deleteProxy:function(){var a=this.proxyId;this.proxyId=this.proxyUrl="";this.useProxy=!1;this.emit("proxyDeleted",
{sourceUrl:this.sourceUrl,useProxy:!1});this.useProxyCheckBox.setValue(!1);if(this.appProxyManager)try{this.appProxyManager.deleteProxies([{proxyId:a}])}catch(c){console.error(c)}},_startProcess:function(a){l.setStyle(this.loading,"display","");this.useProxyCheckBox.setStatus(!1);this.emit("processStart",a)},_stopProcess:function(a,c){l.setStyle(this.loading,"display","none");this.useProxyCheckBox.setStatus(!0);"undefined"!==typeof c&&this.useProxyCheckBox.setValue(c);this.emit("processEnd",a)}});
p.PROXY_CREATED="proxyCreated";p.PROXY_DELETED="proxyDeleted";p.PROCESS_START="processStart";p.PROCESS_END="processEnd";p.PROCESS_ERROR="processError";return p})},"builder/plugins/attribute-config/UrlProxyItem":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/Evented","./AppProxyUtil"],function(p,f,a,l,k){p=p([l],{appProxyManager:null,title:"",sourceUrl:"",proxyUrl:"",proxyId:"",premium:!0,consumeCredits:!1,constructor:function(f){a.mixin(this,f);this.premium=k.isPremium(this.sourceUrl);
this.consumeCredits=k.consumesCredits(this.sourceUrl)},createProxy:function(){this._startProcess();if(!this.premium&&!this.consumeCredits)this.emit("processError",this.nls.notValidPremiumUrl+" "+this.sourceUrl),this._stopProcess();else if(this.appProxyManager){var h=!1;this.appProxyManager.proxies&&0<this.appProxyManager.proxies.length&&(h=f.some(this.appProxyManager.proxies,function(a){return a.sourceUrl===this.sourceUrl&&a.proxyId&&a.proxyUrl}));if(h)this._checkCreateProxiesCallback(this.appProxyManager.proxies);
else try{this.appProxyManager.createProxies([{sourceUrl:this.sourceUrl}]).then(a.hitch(this,function(a){this._checkCreateProxiesCallback(a)}),a.hitch(this,function(){this._checkCreateProxiesCallback([])}))}catch(k){this._checkCreateProxiesCallback([])}}else this._checkCreateProxiesCallback([])},_checkCreateProxiesCallback:function(h){f.some(h,a.hitch(this,function(a){if(a.sourceUrl===this.sourceUrl)return this.proxyUrl=a.proxyUrl,this.proxyId=a.proxyId,!0}))?this.emit("proxyCreated",{sourceUrl:this.sourceUrl,
proxyUrl:this.proxyUrl,proxyId:this.proxyId,title:this.title,premium:this.premium,consumeCredits:this.consumeCredits,useProxy:!0}):(this.proxyUrl=this.proxyId="",this.useProxy=!1,this.emit("processError",this.nls.createProxyFailed+" "+this.sourceUrl));this._stopProcess()},deleteProxy:function(){this._startProcess();if(this.appProxyManager&&this.proxyId)try{this.appProxyManager.deleteProxies([{proxyId:this.proxyId}]).then(a.hitch(this,function(h){var k=f.some(h,a.hitch(this,function(a){return a.sourceUrl===
this.sourceUrl&&!1===a.proxied}));k||(k=f.every(h,a.hitch(this,function(a){return a.sourceUrl!==this.sourceUrl})));k?(this.proxyId=this.proxyUrl="",this.emit("proxyDeleted",this.sourceUrl)):this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl);this._stopProcess()}),a.hitch(this,function(){this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl);this._stopProcess()}))}catch(h){this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl),this._stopProcess()}else this.emit("processError",
this.nls.deleteProxyFailed+" "+this.sourceUrl),this._stopProcess()},_startProcess:function(){this.emit("processStart")},_stopProcess:function(){this.emit("processEnd")}});p.PROXY_CREATED="proxyCreated";p.PROCESS_START="processStart";p.PROXY_DELETED="proxyDeleted";p.PROCESS_END="processEnd";p.PROCESS_ERROR="processError";return p})},"builder/dijit/LinkEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LinkEditor.html dojo/on dojo/dom-geometry dojo/Evented ./LinkItemEditor ./LinkItem".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d){return p([k,h,e],{templateString:q,baseClass:"link-editor",btnLabel:"",linkList:[],canEdit:!0,canDelete:!0,isRest:!1,beforeAdd:null,afterAdd:null,beforeUpdate:null,afterUpdate:null,beforeDelete:null,afterDelete:null,postMixInProperties:function(){this.nls=f.mixin(this.nls,window.jimuNls.common);""===this.btnLabel&&(this.btnLabel="Add Link")},postCreate:function(){this.inherited(arguments);this.labelNode.innerHTML=this.btnLabel;this.setItems(this.linkList);this.editor=
new c({nls:this.nls,isRest:this.isRest});this.editor.placeAt(this.domNode);this.editor.startup();this.editor.hide();this.own(m(this.editor,"updated",f.hitch(this,this._updateLinkItem)));this.own(m(this.addLinkBtn,"click",f.hitch(this,function(){this._showEditor(null)})))},clearItems:function(){this.linkItems=[];a.empty(this.linkListNode)},setItems:function(a){this.clearItems();this.linkList=a;l.forEach(this.linkList,f.hitch(this,function(a){this._addItem(a,!1)}))},getItems:function(){return this.linkItems},
_showEditor:function(a){var c;null!==a?c=g.position(a.domNode):(c=g.position(this.addLinkBtn),c.y+=c.h);this.editor.setLinkItem(a);this.editor.show(c.x,c.y)},_addItem:function(a,c){c&&"function"===typeof this.beforeAdd?this.beforeAdd(a).then(f.hitch(this,function(c){!0===c&&this._doAddItem(a)})):this._doAddItem(a,c)},_doAddItem:function(a,c){var e=new d({nls:this.nls,label:a.label,url:a.url,canEdit:this.canEdit,canDelete:this.canDelete});e.placeAt(this.linkListNode);e.startup();this.linkItems.push(e);
this.own(m(e,"delete",f.hitch(this,this._deleteItem)));this.own(m(e,"edit",f.hitch(this,function(a){this._showEditor(a)})));c&&"function"===typeof this.afterAdd&&this.afterAdd(e)},_updateLinkItem:function(a){null===a.linkItem?this._addItem({label:a.newValue.label,url:a.newValue.url},!0):"function"===typeof this.beforeUpdate?this.beforeUpdate(a.linkItem,a.newValue.label,a.newValue.url).then(f.hitch(this,function(c){!0===c&&this._doUpdateItem(a.linkItem,a.newValue.label,a.newValue.url)})):this._doUpdateItem(a.linkItem,
a.newValue.label,a.newValue.url)},_doUpdateItem:function(a,c,d){a.update(c,d);"function"===typeof this.afterUpdate&&this.afterUpdate(a,c,d)},_deleteItem:function(a){"function"===typeof this.beforeDelete?this.beforeDelete(a).then(f.hitch(this,function(c){!0===c&&this._doDeleteItem(a)})):this._doDeleteItem(a)},_doDeleteItem:function(c){this.linkItems=l.filter(this.linkItems,function(a){return a!==c});a.destroy(c.domNode);"function"===typeof this.afterDelete&&this.afterDelete(c)}})})},"builder/dijit/LinkItemEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dijit/form/ValidationTextBox jimu/dijit/URLInput dojo/text!./templates/LinkItemEditor.html dojo/on dojo/dom-style dojo/Evented".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c){return p([l,k,c],{templateString:m,baseClass:"link-item-editor",linkItem:null,isRest:!1,postCreate:function(){this.inherited(arguments);this.urlInput=new q({required:!0,rest:this.isRest,placeHolder:this.nls.inputURL,value:this.linkItem?this.linkItem.url:"",style:"width:100%"});this.urlInput.placeAt(this.urlNode);this.urlInput.startup();this.titleInput=new h({required:!0,trim:!0,placeHolder:this.nls.inputTitle,value:this.linkItem?this.linkItem.label:"",style:"width: 100%"});
this.titleInput.placeAt(this.titleNode);this.titleInput.startup();this.own(g(this.okBtn,"click",f.hitch(this,this._onOkClicked)));this.own(g(this.cancelBtn,"click",f.hitch(this,this.hide)));this.own(g(this.domNode,"click",f.hitch(this,this._onDomClicked)))},setLinkItem:function(a){this.linkItem=a;this.titleInput.set("value",a?a.label:"");this.urlInput.set("value",a?a.url:"")},_onDomClicked:function(c){a.isDescendant(c.target||c.srcElement,this.contentNode)||this.hide()},show:function(a,c){e.set(this.domNode,
"display","");e.set(this.contentNode,{left:a+"px",top:c+"px"})},hide:function(){e.set(this.domNode,"display","none")},_onOkClicked:function(){if(this.urlInput.isValid()&&this.titleInput.isValid()){var a=this.titleInput.get("value"),c=this.urlInput.get("value");-1===c.indexOf("//")&&(c="http://"+c);if(!this.linkItem||a!==this.linkItem.label||c!==this.linkItem.url)this.emit("updated",{linkItem:this.linkItem,newValue:{label:a,url:c}}),this.hide()}}})})},"jimu/dijit/URLInput":function(){define(["dojo/_base/declare",
"dojo/_base/html","dijit/form/ValidationTextBox","dojox/validate/regexp"],function(p,f,a,l){return p([a],{required:!0,invalidMessage:"Invalid url.",trim:!0,rest:!0,allowNamed:!0,allowLocal:!0,declaredClass:"jimu.dijit.URLInput",postMixInProperties:function(){this.inherited(arguments);this.invalidMessage=(this.nls=window.jimuNls.urlInput)?this.nls.invalidUrl:"Invalid Url"},postCreate:function(){this.inherited(arguments);f.addClass(this.domNode,"jimu-url-input")},validator:function(a){if(isFinite(a))return!1;
var f="^"+l.url({allowNamed:this.allowNamed,allowLocal:this.allowLocal}),f=RegExp(f,"g").test(a);return this.rest?(a=/\/rest\/services/gi.test(a),f&&a):f}})})},"dojox/validate/regexp":function(){define(["dojo/_base/lang","dojo/regexp","dojox/main"],function(p,f,a){var l=p.getObject("validate.regexp",!0,a);return l=a.validate.regexp={ipAddress:function(a){a="object"==typeof a?a:{};"boolean"!=typeof a.allowDottedDecimal&&(a.allowDottedDecimal=!0);"boolean"!=typeof a.allowDottedHex&&(a.allowDottedHex=
!0);"boolean"!=typeof a.allowDottedOctal&&(a.allowDottedOctal=!0);"boolean"!=typeof a.allowDecimal&&(a.allowDecimal=!0);"boolean"!=typeof a.allowHex&&(a.allowHex=!0);"boolean"!=typeof a.allowIPv6&&(a.allowIPv6=!0);"boolean"!=typeof a.allowHybrid&&(a.allowHybrid=!0);var f=[];a.allowDottedDecimal&&f.push("((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");a.allowDottedHex&&f.push("(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]");a.allowDottedOctal&&
f.push("(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]");a.allowDecimal&&f.push("(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])");a.allowHex&&f.push("0[xX]0*[\\da-fA-F]{1,8}");a.allowIPv6&&f.push("([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}");a.allowHybrid&&f.push("([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");a=
"";0<f.length&&(a="("+f.join("|")+")");return a},host:function(a){a="object"==typeof a?a:{};"boolean"!=typeof a.allowIP&&(a.allowIP=!0);"boolean"!=typeof a.allowLocal&&(a.allowLocal=!1);"boolean"!=typeof a.allowPort&&(a.allowPort=!0);"boolean"!=typeof a.allowNamed&&(a.allowNamed=!1);var f=a.allowPort?"(\\:\\d+)?":"",q="((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.?)";a.allowIP&&(q+="|"+l.ipAddress(a));a.allowLocal&&(q+="|localhost");a.allowNamed&&
(q+="|^[^-][a-zA-Z0-9_-]*");return"("+q+")"+f},url:function(a){a="object"==typeof a?a:{};"scheme"in a||(a.scheme=[!0,!1]);return f.buildGroupRE(a.scheme,function(a){return a?"(https?|ftps?)\\://":""})+l.host(a)+"(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?"},emailAddress:function(a){a="object"==typeof a?a:{};"boolean"!=typeof a.allowCruft&&(a.allowCruft=!1);a.allowPort=!1;var f="([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@"+l.host(a);a.allowCruft&&
(f="\x3c?(mailto\\:)?"+f+"\x3e?");return f},emailAddressList:function(a){a="object"==typeof a?a:{};"string"!=typeof a.listSeparator&&(a.listSeparator="\\s;,");var f=l.emailAddress(a);return"("+f+"\\s*["+a.listSeparator+"]\\s*)*"+f+"\\s*["+a.listSeparator+"]?\\s*"},numberFormat:function(a){a="object"==typeof a?a:{};"undefined"==typeof a.format&&(a.format="###-###-####");return f.buildGroupRE(a.format,function(a){return f.escapeString(a,"?").replace(/\?/g,"\\d?").replace(/#/g,"\\d")})},ca:{postalCode:function(){return"([A-Z][0-9][A-Z] [0-9][A-Z][0-9])"},
province:function(){return"(AB|BC|MB|NB|NL|NS|NT|NU|ON|PE|QC|SK|YT)"}},us:{state:function(a){a="object"==typeof a?a:{};"boolean"!=typeof a.allowTerritories&&(a.allowTerritories=!0);"boolean"!=typeof a.allowMilitary&&(a.allowMilitary=!0);var f="AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY";a.allowTerritories&&(f+="|AS|FM|GU|MH|MP|PW|PR|VI");a.allowMilitary&&(f+="|AA|AE|AP");return"("+f+")"}}}})},
"builder/dijit/LinkItem":function(){define("dojo/_base/declare dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dojo/on dojo/mouse dojo/dom-style dojo/Evented".split(" "),function(p,f,a,l,k,h,q,m){return p([a,l,m],{templateString:'\x3cdiv\x3e\x3cdiv class\x3d"label" data-dojo-attach-point\x3d"titleNode" title\x3d"${url}"\x3e${label}\x3c/div\x3e\x3cdiv class\x3d"action" data-dojo-attach-point\x3d"actionSection" style\x3d"display:none;"\x3e\x3cdiv class\x3d"btn delete-btn" data-dojo-attach-point\x3d"deleteBtn" title\x3d"${nls.deleteLink}"\x3e\x3c/div\x3e\x3cdiv class\x3d"btn edit-btn" data-dojo-attach-point\x3d"editBtn" title\x3d"${nls.editLink}"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
baseClass:"link-item",label:"",url:"",canEdit:!0,canDelete:!0,_tooltipTimeout:200,postCreate:function(){this.inherited(arguments);this.canDelete?(q.set(this.deleteBtn,"display","inline-block"),this.own(k(this.deleteBtn,"click",f.hitch(this,this._deleteLink)))):q.set(this.deleteBtn,"display","none");this.canEdit?(q.set(this.editBtn,"display","inline-block"),this.own(k(this.editBtn,"click",f.hitch(this,this._editLink)))):q.set(this.editBtn,"display","none");this.own(k(this.domNode,h.enter,f.hitch(this,
function(){q.set(this.actionSection,"display","")})));this.own(k(this.domNode,h.leave,f.hitch(this,function(){q.set(this.actionSection,"display","none")})))},update:function(a,e){this.label=a;this.url=e;this.titleNode.innerHTML=this.label;this.titleNode.title=this.url},_deleteLink:function(){this.emit("delete",this)},_editLink:function(){this.emit("edit",this)}})})},"dojo/NodeList-data":function(){define(["./_base/kernel","./query","./_base/lang","./_base/array","./dom-attr"],function(p,f,a,l,k){var h=
f.NodeList,q={},m=0,g=function(a){var c=k.get(a,"data-dojo-dataid");c||(c="pid"+m++,k.set(a,"data-dojo-dataid",c));return c},e=p._nodeData=function(c,e,f){var h=g(c),k;q[h]||(q[h]={});if(1==arguments.length)return q[h];"string"==typeof e?2<arguments.length?q[h][e]=f:k=q[h][e]:k=a.mixin(q[h],e);return k},c=p._removeNodeData=function(a,c){var e=g(a);q[e]&&(c?delete q[e][c]:delete q[e])};h._gcNodeData=p._gcNodeData=function(){var a=f("[data-dojo-dataid]").map(g),c;for(c in q)0>l.indexOf(a,c)&&delete q[c]};
a.extend(h,{data:h._adaptWithCondition(e,function(a){return 0===a.length||1==a.length&&"string"==typeof a[0]}),removeData:h._adaptAsForEach(c)});return h})},"jimu/dijit/ColorPicker":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dijit/TooltipDialog dijit/popup dojox/widget/ColorPicker jimu/utils".split(" "),function(p,f,a,l,k,h,q,m,g,e,c){return p([f,a],{baseClass:"jimu-color-picker",declaredClass:"jimu.dijit.ColorPicker",
templateString:"\x3cdiv\x3e\x3c/div\x3e",_isTooltipDialogOpened:!1,color:null,showHex:!0,showHsv:!0,showRgb:!0,ensureMode:!1,showLabel:!1,postMixInProperties:function(){this.nls=window.jimuNls.common},postCreate:function(){this.inherited(arguments);this.color?this.color instanceof q||(this.color=new q(this.color)):this.color=new q("#ccc");k.setStyle(this.domNode,"backgroundColor",this.color.toHex());this.showLabel&&this._changeLabel(this.color);this._createTooltipDialog(this.domNode);this._hideTooltipDialog()},
destroy:function(){g.close(this.tooltipDialog);this.picker.destroy();this.tooltipDialog.destroy();this.inherited(arguments)},isPartOfPopup:function(a){var c=this.tooltipDialog.domNode;return a===c||k.isDescendant(a,c)},hideTooltipDialog:function(){this._hideTooltipDialog()},_showTooltipDialog:function(){g.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.domNode});this._isTooltipDialogOpened=!0},_hideTooltipDialog:function(){g.close(this.tooltipDialog);this._isTooltipDialogOpened=
!1},_createTooltipDialog:function(){var a=k.create("div");this.tooltipDialog=new m({content:a});k.addClass(this.tooltipDialog.domNode,"jimu-color-picker-dialog");var c=new e({showHex:this.showHex,showRgb:this.showRgb,showHsv:this.showHsv,value:this.color.toHex(),onChange:l.hitch(this,function(a){this.ensureMode||(a=new q(a),this.setColor(a))})});c.placeAt(a);c.startup();if(this.ensureMode){var f=k.create("div",{"class":"jimu-btn jimu-btn-vacation jimu-float-trailing",title:this.nls.cancel,innerHTML:this.nls.cancel},
a);this.own(h(f,"click",l.hitch(this,function(){this._hideTooltipDialog()})));f=k.create("div",{"class":"jimu-btn jimu-float-trailing",title:this.nls.ok,innerHTML:this.nls.ok},a);this.own(h(f,"click",l.hitch(this,function(){var a=this.picker.get("value");this.setColor(new q(a));this._hideTooltipDialog()})));a=k.create("div",{"class":"jimu-btn jimu-float-trailing",title:this.nls.apply,innerHTML:this.nls.apply},a);this.own(h(a,"click",l.hitch(this,function(){var a=this.picker.get("value");this.setColor(new q(a))})))}this.own(h(this.domNode,
"click",l.hitch(this,function(a){a.stopPropagation();a.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()})));this.own(h(document.body,"click",l.hitch(this,function(a){this.isPartOfPopup(a.target||a.srcElement)||this._hideTooltipDialog()})));this.picker=c},setColor:function(a){if(a instanceof q){var c=this.color,e="";c&&(e=c.toHex());c=a.toHex();this.color=a;k.setStyle(this.domNode,"backgroundColor",c);e!==c&&(this.picker.set("value",c),this.onChange(new q(c)))}},
getColor:function(){return this.color},_changeLabel:function(a){k.empty(this.domNode);k.create("span",{innerHTML:a.toHex(),className:"color-label",style:{color:c.invertColor(a.toHex())}},this.domNode)},onChange:function(a){this.showLabel&&this._changeLabel(a)}})})},"dijit/TooltipDialog":function(){define("dojo/_base/declare dojo/dom-class dojo/has dojo/keys dojo/_base/lang dojo/on ./focus ./layout/ContentPane ./_DialogMixin ./form/_FormMixin ./_TemplatedMixin dojo/text!./templates/TooltipDialog.html ./main".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r){p=p("dijit.TooltipDialog",[m,c,e,g],{title:"",doLayout:!1,autofocus:!0,baseClass:"dijitTooltipDialog",_firstFocusItem:null,_lastFocusItem:null,templateString:d,_setTitleAttr:"containerNode",postCreate:function(){this.inherited(arguments);this.own(h(this.domNode,"keydown",k.hitch(this,"_onKey")))},orient:function(a,c,d){a={"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft",
"TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft","BR-TL":"dijitTooltipBelow dijitTooltipABLeft","BL-TR":"dijitTooltipBelow dijitTooltipABRight","TL-BR":"dijitTooltipAbove dijitTooltipABRight","TR-BL":"dijitTooltipAbove dijitTooltipABLeft"}[c+"-"+d];f.replace(this.domNode,a,this._currentOrientClass||"");this._currentOrientClass=a},focus:function(){this._getFocusItems();
q.focus(this._firstFocusItem)},onOpen:function(a){this.orient(this.domNode,a.aroundCorner,a.corner);var c=a.aroundNodePos;"M"==a.corner.charAt(0)&&"M"==a.aroundCorner.charAt(0)?(this.connectorNode.style.top=c.y+(c.h-this.connectorNode.offsetHeight>>1)-a.y+"px",this.connectorNode.style.left=""):"M"==a.corner.charAt(1)&&"M"==a.aroundCorner.charAt(1)&&(this.connectorNode.style.left=c.x+(c.w-this.connectorNode.offsetWidth>>1)-a.x+"px");this._onShow()},onClose:function(){this.onHide()},_onKey:function(a){if(a.keyCode==
l.ESCAPE)this.defer("onCancel"),a.stopPropagation(),a.preventDefault();else if(a.keyCode==l.TAB){var c=a.target;this._getFocusItems();this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):c==this._firstFocusItem&&a.shiftKey?(q.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):c==this._lastFocusItem&&!a.shiftKey?(q.focus(this._firstFocusItem),a.stopPropagation(),a.preventDefault()):a.stopPropagation()}}});a("dojo-bidi")&&p.extend({_setTitleAttr:function(a){this.containerNode.title=
this.textDir&&this.enforceTextDirWithUcc?this.enforceTextDirWithUcc(null,a):a;this._set("title",a)},_setTextDirAttr:function(a){if(!this._created||this.textDir!=a)this._set("textDir",a),this.textDir&&this.title&&(this.containerNode.title=this.enforceTextDirWithUcc(null,this.title))}});return p})},"dojox/widget/ColorPicker":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/connect dojo/_base/sniff dojo/_base/window dojo/_base/event dojo/dom dojo/dom-class dojo/keys dojo/fx dojo/dnd/move dijit/registry dijit/_base/focus dijit/form/_FormWidget dijit/typematic dojox/color dojo/i18n dojo/i18n!./nls/ColorPicker dojo/i18n!dojo/cldr/nls/number dojo/text!./ColorPicker/ColorPicker.html".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y){p.experimental("dojox.widget.ColorPicker");return f("dojox.widget.ColorPicker",b,{showRgb:!0,showHsv:!0,showHex:!0,webSafe:!0,animatePoint:!0,slideDuration:250,liveUpdate:!1,PICKER_HUE_H:150,PICKER_SAT_VAL_H:150,PICKER_SAT_VAL_W:150,PICKER_HUE_SELECTOR_H:8,PICKER_SAT_SELECTOR_H:10,PICKER_SAT_SELECTOR_W:10,value:"#ffffff",_underlay:require.toUrl("dojox/widget/ColorPicker/images/underlay.png"),_hueUnderlay:require.toUrl("dojox/widget/ColorPicker/images/hue.png"),
_pickerPointer:require.toUrl("dojox/widget/ColorPicker/images/pickerPointer.png"),_huePickerPointer:require.toUrl("dojox/widget/ColorPicker/images/hueHandle.png"),_huePickerPointerAlly:require.toUrl("dojox/widget/ColorPicker/images/hueHandleA11y.png"),templateString:y,postMixInProperties:function(){c.contains(m.body(),"dijit_a11y")&&(this._huePickerPointer=this._huePickerPointerAlly);this._uId=s.getUniqueId(this.id);a.mixin(this,w.getLocalization("dojox.widget","ColorPicker"));a.mixin(this,w.getLocalization("dojo.cldr",
"number"));this.inherited(arguments)},postCreate:function(){this.inherited(arguments);7>q("ie")&&(this.colorUnderlay.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+this._underlay+"', sizingMethod\x3d'scale')",this.colorUnderlay.src=this._blankGif.toString());this.showRgb||(this.rgbNode.style.visibility="hidden");this.showHsv||(this.hsvNode.style.visibility="hidden");this.showHex||(this.hexNode.style.visibility="hidden");this.webSafe||(this.safePreviewNode.style.visibility=
"hidden")},startup:function(){this._started||(this._started=!0,this.set("value",this.value),this._mover=new u.boxConstrainedMoveable(this.cursorNode,{box:{t:-(this.PICKER_SAT_SELECTOR_H/2),l:-(this.PICKER_SAT_SELECTOR_W/2),w:this.PICKER_SAT_VAL_W,h:this.PICKER_SAT_VAL_H}}),this._hueMover=new u.boxConstrainedMoveable(this.hueCursorNode,{box:{t:-(this.PICKER_HUE_SELECTOR_H/2),l:0,w:0,h:this.PICKER_HUE_H}}),this._subs=[],this._subs.push(h.subscribe("/dnd/move/stop",a.hitch(this,"_clearTimer"))),this._subs.push(h.subscribe("/dnd/move/start",
a.hitch(this,"_setTimer"))),this._keyListeners=[],this._connects.push(v.addKeyListener(this.hueCursorNode,{charOrCode:d.UP_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,a.hitch(this,this._updateHueCursorNode),25,25)),this._connects.push(v.addKeyListener(this.hueCursorNode,{charOrCode:d.DOWN_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,a.hitch(this,this._updateHueCursorNode),25,25)),this._connects.push(v.addKeyListener(this.cursorNode,{charOrCode:d.UP_ARROW,shiftKey:!1,metaKey:!1,
ctrlKey:!1,altKey:!1},this,a.hitch(this,this._updateCursorNode),25,25)),this._connects.push(v.addKeyListener(this.cursorNode,{charOrCode:d.DOWN_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,a.hitch(this,this._updateCursorNode),25,25)),this._connects.push(v.addKeyListener(this.cursorNode,{charOrCode:d.LEFT_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,a.hitch(this,this._updateCursorNode),25,25)),this._connects.push(v.addKeyListener(this.cursorNode,{charOrCode:d.RIGHT_ARROW,shiftKey:!1,
metaKey:!1,ctrlKey:!1,altKey:!1},this,a.hitch(this,this._updateCursorNode),25,25)))},_setValueAttr:function(a,b){this._started&&this.setColor(a,b)},setColor:function(a,b){a=n.fromString(a);this._updatePickerLocations(a);this._updateColorInputs(a);this._updateValue(a,b)},_setTimer:function(b){b.node!=this.cursorNode&&b.node!=this.hueCursorNode||(t.focus(b.node),e.setSelectable(this.domNode,!1),this._timer=setInterval(a.hitch(this,"_updateColor"),45))},_clearTimer:function(a){this._timer&&(clearInterval(this._timer),
this._timer=null,this.onChange(this.value),e.setSelectable(this.domNode,!0))},_setHue:function(a){k.style(this.colorUnderlay,"backgroundColor",n.fromHsv(a,100,100).toHex())},_updateHueCursorNode:function(a,b,c){if(-1!==a){a=k.style(this.hueCursorNode,"top");b=this.PICKER_HUE_SELECTOR_H/2;a+=b;var e=!1;c.charOrCode==d.UP_ARROW?0<a&&(a-=1,e=!0):c.charOrCode==d.DOWN_ARROW&&a<this.PICKER_HUE_H&&(a+=1,e=!0);e&&k.style(this.hueCursorNode,"top",a-b+"px")}else this._updateColor(!0)},_updateCursorNode:function(a,
b,c){b=this.PICKER_SAT_SELECTOR_H/2;var e=this.PICKER_SAT_SELECTOR_W/2;if(-1!==a){a=k.style(this.cursorNode,"top");var f=k.style(this.cursorNode,"left");a+=b;var f=f+e,g=!1;c.charOrCode==d.UP_ARROW?0<a&&(a-=1,g=!0):c.charOrCode==d.DOWN_ARROW?a<this.PICKER_SAT_VAL_H&&(a+=1,g=!0):c.charOrCode==d.LEFT_ARROW?0<f&&(f-=1,g=!0):c.charOrCode==d.RIGHT_ARROW&&f<this.PICKER_SAT_VAL_W&&(f+=1,g=!0);g&&(f-=e,k.style(this.cursorNode,"top",a-b+"px"),k.style(this.cursorNode,"left",f+"px"))}else this._updateColor(!0)},
_updateColor:function(a){var b=this.PICKER_HUE_SELECTOR_H/2,c=this.PICKER_SAT_SELECTOR_H/2,d=this.PICKER_SAT_SELECTOR_W/2,b=k.style(this.hueCursorNode,"top")+b,c=k.style(this.cursorNode,"top")+c,d=k.style(this.cursorNode,"left")+d,b=Math.round(360-360*(b/this.PICKER_HUE_H)),d=n.fromHsv(b,100*(d/this.PICKER_SAT_VAL_W),100-100*(c/this.PICKER_SAT_VAL_H));this._updateColorInputs(d);this._updateValue(d,a);b!=this._hue&&this._setHue(b)},_colorInputChange:function(a){var b,c=!1;switch(a.target){case this.hexCode:b=
n.fromString(a.target.value);c=!0;break;case this.Rval:case this.Gval:case this.Bval:b=n.fromArray([this.Rval.value,this.Gval.value,this.Bval.value]);c=!0;break;case this.Hval:case this.Sval:case this.Vval:b=n.fromHsv(this.Hval.value,this.Sval.value,this.Vval.value),c=!0}c&&(this._updatePickerLocations(b),this._updateColorInputs(b),this._updateValue(b,!0))},_updateValue:function(a,b){var c=a.toHex();this.value=this.valueNode.value=c;if(b&&(!this._timer||this.liveUpdate))this.onChange(c)},_updatePickerLocations:function(a){var b=
this.PICKER_HUE_SELECTOR_H/2,c=this.PICKER_SAT_SELECTOR_H/2,d=this.PICKER_SAT_SELECTOR_W/2;a=a.toHsv();b=Math.round(this.PICKER_HUE_H-a.h/360*this.PICKER_HUE_H)-b;d=Math.round(a.s/100*this.PICKER_SAT_VAL_W)-d;c=Math.round(this.PICKER_SAT_VAL_H-a.v/100*this.PICKER_SAT_VAL_H)-c;this.animatePoint?(r.slideTo({node:this.hueCursorNode,duration:this.slideDuration,top:b,left:0}).play(),r.slideTo({node:this.cursorNode,duration:this.slideDuration,top:c,left:d}).play()):(k.style(this.hueCursorNode,"top",b+"px"),
k.style(this.cursorNode,{left:d+"px",top:c+"px"}));a.h!=this._hue&&this._setHue(a.h)},_updateColorInputs:function(a){var b=a.toHex();this.showRgb&&(this.Rval.value=a.r,this.Gval.value=a.g,this.Bval.value=a.b);this.showHsv&&(a=a.toHsv(),this.Hval.value=Math.round(a.h),this.Sval.value=Math.round(a.s),this.Vval.value=Math.round(a.v));this.showHex&&(this.hexCode.value=b);this.previewNode.style.backgroundColor=b;this.webSafe&&(this.safePreviewNode.style.backgroundColor=b)},_setHuePoint:function(b){b=b.layerY-
this.PICKER_HUE_SELECTOR_H/2;this.animatePoint?r.slideTo({node:this.hueCursorNode,duration:this.slideDuration,top:b,left:0,onEnd:a.hitch(this,function(){this._updateColor(!1);t.focus(this.hueCursorNode)})}).play():(k.style(this.hueCursorNode,"top",b+"px"),this._updateColor(!1))},_setPoint:function(b){var c=b.layerY-this.PICKER_SAT_SELECTOR_H/2,d=b.layerX-this.PICKER_SAT_SELECTOR_W/2;b&&t.focus(b.target);this.animatePoint?r.slideTo({node:this.cursorNode,duration:this.slideDuration,top:c,left:d,onEnd:a.hitch(this,
function(){this._updateColor(!0);t.focus(this.cursorNode)})}).play():(k.style(this.cursorNode,{left:d+"px",top:c+"px"}),this._updateColor(!1))},_handleKey:function(a){},focus:function(){this.focused||t.focus(this.focusNode)},_stopDrag:function(a){g.stop(a)},destroy:function(){this.inherited(arguments);l.forEach(this._subs,function(a){h.unsubscribe(a)});delete this._subs}})})},"dojox/color":function(){define(["./color/_base"],function(p){return p})},"dojox/color/_base":function(){define(["../main",
"dojo/_base/lang","dojo/_base/Color","dojo/colors"],function(p,f,a,l){p=f.getObject("color",!0,p);p.Color=a;p.blend=a.blendColors;p.fromRgb=a.fromRgb;p.fromHex=a.fromHex;p.fromArray=a.fromArray;p.fromString=a.fromString;p.greyscale=l.makeGrey;f.mixin(p,{fromCmy:function(k,h,l){f.isArray(k)?(h=k[1],l=k[2],k=k[0]):f.isObject(k)&&(h=k.m,l=k.y,k=k.c);h=1-h/100;l=1-l/100;return new a({r:Math.round(255*(1-k/100)),g:Math.round(255*h),b:Math.round(255*l)})},fromCmyk:function(k,h,l,m){f.isArray(k)?(h=k[1],
l=k[2],m=k[3],k=k[0]):f.isObject(k)&&(h=k.m,l=k.y,m=k.b,k=k.c);h/=100;l/=100;m/=100;k=1-Math.min(1,k/100*(1-m)+m);h=1-Math.min(1,h*(1-m)+m);l=1-Math.min(1,l*(1-m)+m);return new a({r:Math.round(255*k),g:Math.round(255*h),b:Math.round(255*l)})},fromHsl:function(k,h,l){f.isArray(k)?(h=k[1],l=k[2],k=k[0]):f.isObject(k)&&(h=k.s,l=k.l,k=k.h);h/=100;for(l/=100;0>k;)k+=360;for(;360<=k;)k-=360;var m,g;120>k?(m=(120-k)/60,g=k/60,k=0):240>k?(m=0,g=(240-k)/60,k=(k-120)/60):(m=(k-240)/60,g=0,k=(360-k)/60);m=2*
h*Math.min(m,1)+(1-h);g=2*h*Math.min(g,1)+(1-h);k=2*h*Math.min(k,1)+(1-h);0.5>l?(m*=l,g*=l,k*=l):(m=(1-l)*m+2*l-1,g=(1-l)*g+2*l-1,k=(1-l)*k+2*l-1);return new a({r:Math.round(255*m),g:Math.round(255*g),b:Math.round(255*k)})}});p.fromHsv=function(k,h,l){f.isArray(k)?(h=k[1],l=k[2],k=k[0]):f.isObject(k)&&(h=k.s,l=k.v,k=k.h);360==k&&(k=0);h/=100;l/=100;var m,g,e;if(0==h)g=e=m=l;else{var c=k/60;k=Math.floor(c);var d=c-k,c=l*(1-h),p=l*(1-h*d);h=l*(1-h*(1-d));switch(k){case 0:m=l;g=h;e=c;break;case 1:m=
p;g=l;e=c;break;case 2:m=c;g=l;e=h;break;case 3:m=c;g=p;e=l;break;case 4:m=h;g=c;e=l;break;case 5:m=l,g=c,e=p}}return new a({r:Math.round(255*m),g:Math.round(255*g),b:Math.round(255*e)})};f.extend(a,{toCmy:function(){var a=1-this.g/255,f=1-this.b/255;return{c:Math.round(100*(1-this.r/255)),m:Math.round(100*a),y:Math.round(100*f)}},toCmyk:function(){var a,f,l,m=this.r/255;a=this.g/255;f=this.b/255;l=Math.min(1-m,1-a,1-f);a=(1-a-l)/(1-l);f=(1-f-l)/(1-l);return{c:Math.round(100*((1-m-l)/(1-l))),m:Math.round(100*
a),y:Math.round(100*f),b:Math.round(100*l)}},toHsl:function(){var a=this.r/255,f=this.g/255,l=this.b/255,m=Math.min(a,l,f),g=Math.max(a,f,l),e=g-m,c=0,d=0,m=(m+g)/2;0<m&&1>m&&(d=e/(0.5>m?2*m:2-2*m));0<e&&(g==a&&g!=f&&(c+=(f-l)/e),g==f&&g!=l&&(c+=2+(l-a)/e),g==l&&g!=a&&(c+=4+(a-f)/e),c*=60);return{h:c,s:Math.round(100*d),l:Math.round(100*m)}},toHsv:function(){var a=this.r/255,f=this.g/255,l=this.b/255,m=Math.min(a,l,f),g=Math.max(a,f,l),m=g-m,e=null,c=0==g?0:m/g;0==c?e=0:(e=a==g?60*(f-l)/m:f==g?120+
60*(l-a)/m:240+60*(a-f)/m,0>e&&(e+=360));return{h:e,s:Math.round(100*c),v:Math.round(100*g)}}});return p})},"dijit/_editor/plugins/FontChoice":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-construct dojo/i18n dojo/_base/lang dojo/store/Memory ../../registry ../../_Widget ../../_TemplatedMixin ../../_WidgetsInTemplateMixin ../../form/FilteringSelect ../_Plugin ../range dojo/i18n!../nls/FontChoice".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r,u){p=a("dijit._editor.plugins._FontDropDown",
[g,e,c],{label:"",plainText:!1,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${selectId}'\x3e${label}\x3c/label\x3e\x3cinput data-dojo-type\x3d'../../form/FilteringSelect' required\x3d'false' data-dojo-props\x3d'labelType:\"html\", labelAttr:\"label\", searchAttr:\"name\"' class\x3d'${comboClass}' tabIndex\x3d'-1' id\x3d'${selectId}' data-dojo-attach-point\x3d'select' value\x3d''/\x3e\x3c/span\x3e",
contextRequire:p,postMixInProperties:function(){this.inherited(arguments);this.strings=k.getLocalization("dijit._editor","FontChoice");this.label=this.strings[this.command];this.id=m.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.selectId=this.id+"_select";this.inherited(arguments)},postCreate:function(){this.select.set("store",new q({idProperty:"value",data:f.map(this.values,function(a){var b=this.strings[a]||a;return{label:this.getLabel(a,b),name:b,value:a}},this)}));this.select.set("value",
"",!1);this.disabled=this.select.get("disabled")},_setValueAttr:function(a,b){b=!1!==b;this.select.set("value",0>f.indexOf(this.values,a)?"":a,b);b||(this.select._lastValueReported=null)},_getValueAttr:function(){return this.select.get("value")},focus:function(){this.select.focus()},_setDisabledAttr:function(a){this._set("disabled",a);this.select.set("disabled",a)}});var s=a("dijit._editor.plugins._FontNameDropDown",p,{generic:!1,command:"fontName",comboClass:"dijitFontNameCombo",postMixInProperties:function(){this.values||
(this.values=this.generic?["serif","sans-serif","monospace","cursive","fantasy"]:["Arial","Times New Roman","Comic Sans MS","Courier New"]);this.inherited(arguments)},getLabel:function(a,b){return this.plainText?b:"\x3cdiv style\x3d'font-family: "+a+"'\x3e"+b+"\x3c/div\x3e"},_setValueAttr:function(a,b){this.generic&&(a={Arial:"sans-serif",Helvetica:"sans-serif",Myriad:"sans-serif",Times:"serif","Times New Roman":"serif","Comic Sans MS":"cursive","Apple Chancery":"cursive",Courier:"monospace","Courier New":"monospace",
Papyrus:"fantasy","Estrangelo Edessa":"cursive",Gabriola:"fantasy"}[a]||a);this.inherited(arguments,[a,!1!==b])}}),t=a("dijit._editor.plugins._FontSizeDropDown",p,{command:"fontSize",comboClass:"dijitFontSizeCombo",values:[1,2,3,4,5,6,7],getLabel:function(a,b){return this.plainText?b:"\x3cfont size\x3d"+a+"'\x3e"+b+"\x3c/font\x3e"},_setValueAttr:function(a,b){b=!1!==b;a.indexOf&&-1!=a.indexOf("px")&&(a={10:1,13:2,16:3,18:4,24:5,32:6,48:7}[parseInt(a,10)]||a);this.inherited(arguments,[a,b])}}),b=a("dijit._editor.plugins._FormatBlockDropDown",
p,{command:"formatBlock",comboClass:"dijitFormatBlockCombo",values:"noFormat p h1 h2 h3 pre".split(" "),postCreate:function(){this.inherited(arguments);this.set("value","noFormat",!1)},getLabel:function(a,b){return this.plainText||"noFormat"==a?b:"\x3c"+a+"\x3e"+b+"\x3c/"+a+"\x3e"},_execCommand:function(a,b,c){if("noFormat"===c){var d;if((b=u.getSelection(a.window))&&0<b.rangeCount){c=b.getRangeAt(0);var e;if(c){b=c.startContainer;for(d=c.endContainer;b&&b!==a.editNode&&b!==a.document.body&&1!==b.nodeType;)b=
b.parentNode;for(;d&&d!==a.editNode&&d!==a.document.body&&1!==d.nodeType;)d=d.parentNode;var g=h.hitch(this,function(b,c){if(b.childNodes&&b.childNodes.length){var d;for(d=0;d<b.childNodes.length;d++){var e=b.childNodes[d];if(1==e.nodeType&&a.selection.inSelection(e)){var h=e.tagName?e.tagName.toLowerCase():"";-1!==f.indexOf(this.values,h)&&c.push(e);g(e,c)}}}});c=h.hitch(this,function(b){if(b&&b.length){for(a.beginEditing();b.length;)this._removeFormat(a,b.pop());a.endEditing()}});var k=[];if(b==
d){var l;for(d=b;d&&d!==a.editNode&&d!==a.document.body;){if(1==d.nodeType&&(e=d.tagName?d.tagName.toLowerCase():"",-1!==f.indexOf(this.values,e))){l=d;break}d=d.parentNode}g(b,k);l&&(k=[l].concat(k))}else for(d=b;a.selection.inSelection(d);)1==d.nodeType&&(e=d.tagName?d.tagName.toLowerCase():"",-1!==f.indexOf(this.values,e)&&k.push(d),g(d,k)),d=d.nextSibling;c(k);a.onDisplayChanged()}}}else a.execCommand(b,c)},_removeFormat:function(a,b){if(a.customUndo){for(;b.firstChild;)l.place(b.firstChild,b,
"before");b.parentNode.removeChild(b)}else{a.selection.selectElementChildren(b);var c=a.selection.getSelectedHtml();a.selection.selectElement(b);a.execCommand("inserthtml",c||"")}}}),v=a("dijit._editor.plugins.FontChoice",r,{useDefaultCommand:!1,_initButton:function(){var a={fontName:s,fontSize:t,formatBlock:b}[this.command],c=this.params;this.params.custom&&(c.values=this.params.custom);var d=this.editor;this.button=new a(h.delegate({dir:d.dir,lang:d.lang},c));this.own(this.button.select.on("change",
h.hitch(this,function(a){this.editor.focused&&this.editor.focus();"fontName"==this.command&&-1!=a.indexOf(" ")&&(a="'"+a+"'");this.button._execCommand?this.button._execCommand(this.editor,this.command,a):this.editor.execCommand(this.command,a)})))},updateState:function(){var a=this.editor,b=this.command;if(a&&(a.isLoaded&&b.length)&&this.button){var c=this.get("disabled");this.button.set("disabled",c);if(!c){var d;try{d=a.queryCommandValue(b)||""}catch(e){d=""}(c=h.isString(d)&&(d.match(/'([^']*)'/)||
d.match(/"([^"]*)"/)))&&(d=c[1]);if("formatBlock"===b)if(!d||"p"==d){d=null;var g;if((b=u.getSelection(this.editor.window))&&0<b.rangeCount)if(b=b.getRangeAt(0))g=b.endContainer;for(;g&&g!==a.editNode&&g!==a.document;){if((b=g.tagName?g.tagName.toLowerCase():"")&&-1<f.indexOf(this.button.values,b)){d=b;break}g=g.parentNode}d||(d="noFormat")}else 0>f.indexOf(this.button.values,d)&&(d="noFormat");d!==this.button.get("value")&&this.button.set("value",d,!1)}}}});f.forEach(["fontName","fontSize","formatBlock"],
function(a){r.registry[a]=function(b){return new v({command:a,plainText:b.plainText})}});v._FontDropDown=p;v._FontNameDropDown=s;v._FontSizeDropDown=t;v._FormatBlockDropDown=b;return v})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(p,f,a,l,k){return p("dijit.form.FilteringSelect",[l,k],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||
!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(a,f,k,g){f&&f[this.searchAttr]!==this._lastQuery||!f&&a.length&&this.store.getIdentity(a[0])!=this._lastQuery||(a.length?this.set("item",a[0],g):this.set("value","",g||void 0===g&&!this.focused,this.textbox.value,null))},_openResultList:function(a,f,k){f[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},
_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(h,k,l,g){this._onChangeActive||(k=null);if(void 0===g){if(null===h||""===h)if(h="",!f.isString(l)){this._setDisplayedValueAttr(l||"",k);return}var e=this;this._lastQuery=h;a(this.store.get(h),function(a){e._callbackSetLabel(a?[a]:[],void 0,void 0,k)})}else this.valueNode.value=h,this.inherited(arguments,[h,k,l,g])},_setItemAttr:function(a,f,k){this.inherited(arguments);this._lastDisplayedValue=
this.textbox.value},_getDisplayQueryString:function(a){return a.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(h,k){null==h&&(h="");if(!this._created){if(!("displayedValue"in this.params))return;k=!1}if(this.store){this.closeDropDown();var l=f.clone(this.query),g=this._getDisplayQueryString(h),e;this.store._oldAPI?e=g:(e=this._patternToRegExp(g),e.toString=function(){return g});this._lastQuery=l[this.searchAttr]=e;this._lastDisplayedValue=this.textbox.value=h;this._set("displayedValue",
h);var c=this,d={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};f.mixin(d,this.fetchProperties);this._fetchHandle=this.store.query(l,d);a(this._fetchHandle,function(a){c._fetchHandle=null;c._callbackSetLabel(a||[],l,d,k)},function(a){c._fetchHandle=null;c._cancelingQuery||console.error("dijit.form.FilteringSelect: "+a.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/ComboBoxMixin":function(){define("dojo/_base/declare dojo/Deferred dojo/_base/kernel dojo/_base/lang dojo/store/util/QueryResults ./_AutoCompleterMixin ./_ComboBoxMenu ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
function(p,f,a,l,k,h,q,m,g){return p("dijit.form.ComboBoxMixin",[m,h],{dropDownClass:q,hasDownArrow:!0,templateString:g,baseClass:"dijitTextBox dijitComboBox",cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_setHasDownArrowAttr:function(a){this._set("hasDownArrow",a);this._buttonNode.style.display=a?"":"none"},_showResultList:function(){this.displayMessage("");this.inherited(arguments)},_setStoreAttr:function(a){a.get||l.mixin(a,{_oldAPI:!0,get:function(a){var d=new f;this.fetchItemByIdentity({identity:a,
onItem:function(a){d.resolve(a)},onError:function(a){d.reject(a)}});return d.promise},query:function(a,d){var e=new f(function(){g.abort&&g.abort()});e.total=new f;var g=this.fetch(l.mixin({query:a,onBegin:function(a){e.total.resolve(a)},onComplete:function(a){e.resolve(a)},onError:function(a){e.reject(a)}},d));return k(e)}});this._set("store",a)},postMixInProperties:function(){var e=this.params.store||this.store;e&&this._setStoreAttr(e);this.inherited(arguments);if(!this.params.store&&this.store&&
!this.store._oldAPI){var c=this.declaredClass;l.mixin(this.store,{getValue:function(d,e){a.deprecated(c+".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly","","2.0");return d[e]},getLabel:function(d){a.deprecated(c+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return d.name},fetch:function(d){a.deprecated(c+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");require(["dojo/data/ObjectStore"],
l.hitch(this,function(a){(new a({objectStore:this})).fetch(d)}))}})}},buildRendering:function(){this.inherited(arguments);this.focusNode.setAttribute("aria-autocomplete",this.autoComplete?"both":"list")}})})},"dijit/form/_AutoCompleterMixin":function(){define("dojo/aspect dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/query dojo/regexp dojo/sniff ./DataList ./_TextBoxMixin ./_SearchMixin".split(" "),function(p,f,a,l,k,h,q,m,g,e,c){f=f("dijit.form._AutoCompleterMixin",c,{item:null,
autoComplete:!0,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:!1,_getCaretPos:function(a){var c=0;if("number"==typeof a.selectionStart)c=a.selectionStart;else if(m("ie")){var e=a.ownerDocument.selection.createRange().duplicate();a=a.createTextRange();e.move("character",0);a.move("character",0);try{a.setEndPoint("EndToEnd",e),c=String(a.text).replace(/\r/g,"").length}catch(f){}}return c},_setCaretPos:function(a,c){c=parseInt(c);e.selectInputText(a,c,c)},_setDisabledAttr:function(a){this.inherited(arguments);
this.domNode.setAttribute("aria-disabled",a?"true":"false")},_onKey:function(a){if(!(32<=a.charCode)){var c=a.charCode||a.keyCode;if(!(c==l.ALT||c==l.CTRL||c==l.META||c==l.SHIFT)){var e=this.dropDown,f=null;this._abortQuery();this.inherited(arguments);if(!a.altKey&&!a.ctrlKey&&!a.metaKey)switch(this._opened&&(f=e.getHighlightedOption()),c){case l.PAGE_DOWN:case l.DOWN_ARROW:case l.PAGE_UP:case l.UP_ARROW:this._opened&&this._announceOption(f);a.stopPropagation();a.preventDefault();break;case l.ENTER:if(f){if(f==
e.nextButton){this._nextSearch(1);a.stopPropagation();a.preventDefault();break}else if(f==e.previousButton){this._nextSearch(-1);a.stopPropagation();a.preventDefault();break}a.stopPropagation();a.preventDefault()}else this._setBlurValue(),this._setCaretPos(this.focusNode,this.focusNode.value.length);case l.TAB:c=this.get("displayedValue");if(e&&(c==e._messages.previousMessage||c==e._messages.nextMessage))break;f&&this._selectOption(f);case l.ESCAPE:this._opened&&(this._lastQuery=null,this.closeDropDown())}}}},
_autoCompleteText:function(a){var c=this.focusNode;e.selectInputText(c,c.value.length);var f=this.ignoreCase?"toLowerCase":"substr";0==a[f](0).indexOf(this.focusNode.value[f](0))?(f=this.autoComplete?this._getCaretPos(c):c.value.length,f+1>c.value.length&&(c.value=a,e.selectInputText(c,f))):(c.value=a,e.selectInputText(c))},_openResultList:function(a,c,e){var f=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();!a.length&&0==e.start?this.closeDropDown():(this._nextSearch=this.dropDown.onPage=
k.hitch(this,function(c){a.nextPage(-1!==c);this.focus()}),this.dropDown.createOptions(a,e,k.hitch(this,"_getMenuLabelFromItem")),this._showResultList(),"direction"in e?(e.direction?this.dropDown.highlightFirstOption():e.direction||this.dropDown.highlightLastOption(),f&&this._announceOption(this.dropDown.getHighlightedOption())):this.autoComplete&&(!this._prev_key_backspace&&!/^[*]+$/.test(c[this.searchAttr].toString()))&&this._announceOption(this.dropDown.containerNode.firstChild.nextSibling))},
_showResultList:function(){this.closeDropDown(!0);this.openDropDown();this.domNode.setAttribute("aria-expanded","true")},loadDropDown:function(){this._startSearchAll()},isLoaded:function(){return!1},closeDropDown:function(){this._abortQuery();this._opened&&(this.inherited(arguments),this.domNode.setAttribute("aria-expanded","false"))},_setBlurValue:function(){var a=this.get("displayedValue"),c=this.dropDown;c&&(a==c._messages.previousMessage||a==c._messages.nextMessage)?this._setValueAttr(this._lastValueReported,
!0):"undefined"==typeof this.item?(this.item=null,this.set("displayedValue",a)):(this.value!=this._lastValueReported&&this._handleOnChange(this.value,!0),this._refreshState());this.focusNode.removeAttribute("aria-activedescendant")},_setItemAttr:function(a,c,e){var f="";a&&(e||(e=this.store._oldAPI?this.store.getValue(a,this.searchAttr):a[this.searchAttr]),f=this._getValueField()!=this.searchAttr?this.store.getIdentity(a):e);this.set("value",f,c,e,a)},_announceOption:function(c){if(c){var e;if(c==
this.dropDown.nextButton||c==this.dropDown.previousButton)e=c.innerHTML,this.item=void 0,this.value="";else{var f=this.dropDown.items[c.getAttribute("item")];e=(this.store._oldAPI?this.store.getValue(f,this.searchAttr):f[this.searchAttr]).toString();this.set("item",f,!1,e)}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",a.get(c,"id"));this._autoCompleteText(e)}},_selectOption:function(a){this.closeDropDown();a&&this._announceOption(a);
this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,!0);this.focusNode.removeAttribute("aria-activedescendant")},_startSearchAll:function(){this._startSearch("")},_startSearchFromInput:function(){this.item=void 0;this.inherited(arguments)},_startSearch:function(a){if(!this.dropDown){var c=this.id+"_popup";this.dropDown=new (k.isString(this.dropDownClass)?k.getObject(this.dropDownClass,!1):this.dropDownClass)({onChange:k.hitch(this,this._selectOption),id:c,
dir:this.dir,textDir:this.textDir})}this._lastInput=a;this.inherited(arguments)},_getValueField:function(){return this.searchAttr},postMixInProperties:function(){this.inherited(arguments);if(!this.store&&this.srcNodeRef&&(this.store=new g({},this.srcNodeRef),!("value"in this.params))){var a=this.item=this.store.fetchSelectedItem();if(a){var c=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(a,c):a[c]}}},postCreate:function(){var a=h('label[for\x3d"'+this.id+'"]');a.length&&
(a[0].id||(a[0].id=this.id+"_label"),this.domNode.setAttribute("aria-labelledby",a[0].id));this.inherited(arguments);p.after(this,"onSearch",k.hitch(this,"_openResultList"),!0)},_getMenuLabelFromItem:function(a){a=this.labelFunc(a,this.store);var c=this.labelType;"none"!=this.highlightMatch&&("text"==this.labelType&&this._lastInput)&&(a=this.doHighlight(a,this._lastInput),c="html");return{html:"html"==c,label:a}},doHighlight:function(a,c){var e=(this.ignoreCase?"i":"")+("all"==this.highlightMatch?
"g":""),f=this.queryExpr.indexOf("${0}");c=q.escapeString(c);return this._escapeHtml(a.replace(RegExp((0==f?"^":"")+"("+c+")"+(f==this.queryExpr.length-4?"$":""),e),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,'\x3cspan class\x3d"dijitComboBoxHighlightMatch"\x3e$1\x3c/span\x3e')},_escapeHtml:function(a){return a=String(a).replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;")},reset:function(){this.item=null;this.inherited(arguments)},labelFunc:function(a,
c){return(c._oldAPI?c.getValue(a,this.labelAttr||this.searchAttr):a[this.labelAttr||this.searchAttr]).toString()},_setValueAttr:function(a,c,e,f){this._set("item",f||null);null==a&&(a="");this.inherited(arguments)}});m("dojo-bidi")&&f.extend({_setTextDirAttr:function(a){this.inherited(arguments);this.dropDown&&this.dropDown._set("textDir",a)}});return f})},"dijit/form/DataList":function(){define("dojo/_base/declare dojo/dom dojo/_base/lang dojo/query dojo/store/Memory ../registry".split(" "),function(p,
f,a,l,k,h){function q(f){return{id:f.value,value:f.value,name:a.trim(f.innerText||f.textContent||"")}}return p("dijit.form.DataList",k,{constructor:function(k,g){this.domNode=f.byId(g);a.mixin(this,k);this.id&&h.add(this);this.domNode.style.display="none";this.inherited(arguments,[{data:l("option",this.domNode).map(q)}])},destroy:function(){h.remove(this.id)},fetchSelectedItem:function(){var a=l("\x3e option[selected]",this.domNode)[0]||l("\x3e option",this.domNode)[0];return a&&q(a)}})})},"dijit/form/_SearchMixin":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/query dojo/string dojo/when ../registry".split(" "),
function(p,f,a,l,k,h,q){return p("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},list:"",_setListAttr:function(a){this._set("list",a)},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:!0,_patternToRegExp:function(a){return RegExp("^"+a.replace(/(\\.)|(\*)|(\?)|\W/g,function(a,e,c,d){return c?".*":d?".":e?e:"\\"+a})+"$",this.ignoreCase?"mi":"m")},_abortQuery:function(){this.searchTimer&&(this.searchTimer=this.searchTimer.remove());this._queryDeferHandle&&
(this._queryDeferHandle=this._queryDeferHandle.remove());this._fetchHandle&&(this._fetchHandle.abort&&(this._cancelingQuery=!0,this._fetchHandle.abort(),this._cancelingQuery=!1),this._fetchHandle.cancel&&(this._cancelingQuery=!0,this._fetchHandle.cancel(),this._cancelingQuery=!1),this._fetchHandle=null)},_processInput:function(a){if(!this.disabled&&!this.readOnly){a=a.charOrCode;var g=!1;this._prev_key_backspace=!1;switch(a){case f.DELETE:case f.BACKSPACE:g=this._maskValidSubsetError=this._prev_key_backspace=
!0;break;default:g="string"==typeof a||229==a}if(g)if(this.store)this.searchTimer=this.defer("_startSearchFromInput",1);else this.onSearch()}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value)},_startSearch:function(f){this._abortQuery();var g=this,e=a.clone(this.query),c={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:!0}},d=k.substitute(this.queryExpr,[f.replace(/([\\\*\?])/g,"\\$1")]),l,p=function(){var a=g._fetchHandle=g.store.query(e,
c);!g.disabled&&!(g.readOnly||l!==g._lastQuery)&&h(a,function(d){g._fetchHandle=null;!g.disabled&&(!g.readOnly&&l===g._lastQuery)&&h(a.total,function(a){d.total=a;var f=g.pageSize;if(isNaN(f)||f>d.total)f=d.total;d.nextPage=function(a){c.direction=a=!1!==a;c.count=f;a?(c.start+=d.length,c.start>=d.total&&(c.count=0)):(c.start-=f,0>c.start&&(c.count=Math.max(f+c.start,0),c.start=0));0>=c.count?(d.length=0,g.onSearch(d,e,c)):p()};g.onSearch(d,e,c)})},function(a){g._fetchHandle=null;g._cancelingQuery||
console.error(g.declaredClass+" "+a.toString())})};a.mixin(c,this.fetchProperties);this.store._oldAPI?l=d:(l=this._patternToRegExp(d),l.toString=function(){return d});this._lastQuery=e[this.searchAttr]=l;this._queryDeferHandle=this.defer(p,this.searchDelay)},constructor:function(){this.query={};this.fetchProperties={}},postMixInProperties:function(){if(!this.store){var a=this.list;a&&(this.store=q.byId(a))}this.inherited(arguments)}})})},"dijit/form/_ComboBoxMenu":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-style dojo/keys ../_WidgetBase ../_TemplatedMixin ./_ComboBoxMenuMixin ./_ListMouseMixin".split(" "),
function(p,f,a,l,k,h,q,m){return p("dijit.form._ComboBoxMenu",[k,h,m,q],{templateString:"\x3cdiv class\x3d'dijitReset dijitMenu' data-dojo-attach-point\x3d'containerNode' style\x3d'overflow: auto; overflow-x: hidden;' role\x3d'listbox'\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point\x3d'previousButton' role\x3d'option'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuNextButton' data-dojo-attach-point\x3d'nextButton' role\x3d'option'\x3e\x3c/div\x3e\x3c/div\x3e",
baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);this.isLeftToRight()||(f.add(this.previousButton,"dijitMenuItemRtl"),f.add(this.nextButton,"dijitMenuItemRtl"));this.containerNode.setAttribute("role","listbox")},_createMenuItem:function(){var a=this.ownerDocument.createElement("div");a.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");a.setAttribute("role","option");return a},onHover:function(a){f.add(a,"dijitMenuItemHover")},onUnhover:function(a){f.remove(a,
"dijitMenuItemHover")},onSelect:function(a){f.add(a,"dijitMenuItemSelected")},onDeselect:function(a){f.remove(a,"dijitMenuItemSelected")},_page:function(f){var e=0,c=this.domNode.scrollTop,d=a.get(this.domNode,"height");for(this.getHighlightedOption()||this.selectNextNode();e<d;){var h=this.getHighlightedOption();if(f){if(!h.previousSibling||"none"==h.previousSibling.style.display)break;this.selectPreviousNode()}else{if(!h.nextSibling||"none"==h.nextSibling.style.display)break;this.selectNextNode()}h=
this.domNode.scrollTop;e+=(h-c)*(f?-1:1);c=h}},handleKey:function(a){switch(a.keyCode){case l.DOWN_ARROW:return this.selectNextNode(),!1;case l.PAGE_DOWN:return this._page(!1),!1;case l.UP_ARROW:return this.selectPreviousNode(),!1;case l.PAGE_UP:return this._page(!0),!1;default:return!0}}})})},"dijit/form/_ComboBoxMenuMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/has dojo/i18n dojo/i18n!./nls/ComboBox".split(" "),function(p,f,a,l,k){var h=f("dijit.form._ComboBoxMenuMixin"+
(l("dojo-bidi")?"_NoBidi":""),null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=k.getLocalization("dijit.form","ComboBox",this.lang)},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages.previousMessage;this.nextButton.innerHTML=this._messages.nextMessage},_setValueAttr:function(a){this._set("value",a);this.onChange(a)},onClick:function(a){if(a==this.previousButton)this._setSelectedAttr(null),this.onPage(-1);else if(a==
this.nextButton)this._setSelectedAttr(null),this.onPage(1);else this.onChange(a)},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null)},_createOption:function(a,f){var g=this._createMenuItem(),e=f(a);e.html?g.innerHTML=e.label:g.appendChild(g.ownerDocument.createTextNode(e.label));""==g.innerHTML&&(g.innerHTML="\x26#160;");return g},createOptions:function(f,h,g){this.items=f;this.previousButton.style.display=0==h.start?"none":"";a.set(this.previousButton,"id",this.id+
"_prev");p.forEach(f,function(c,d){var e=this._createOption(c,g);e.setAttribute("item",d);a.set(e,"id",this.id+d);this.nextButton.parentNode.insertBefore(e,this.nextButton)},this);var e=!1;f.total&&!f.total.then&&-1!=f.total?h.start+h.count<f.total?e=!0:h.start+h.count>f.total&&h.count==f.length&&(e=!0):h.count==f.length&&(e=!0);this.nextButton.style.display=e?"":"none";a.set(this.nextButton,"id",this.id+"_next")},clearResultList:function(){for(var a=this.containerNode;2<a.childNodes.length;)a.removeChild(a.childNodes[a.childNodes.length-
2]);this._setSelectedAttr(null)},highlightFirstOption:function(){this.selectFirstNode()},highlightLastOption:function(){this.selectLastNode()},selectFirstNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.previousButton&&this.selectNextNode()},selectLastNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.nextButton&&this.selectPreviousNode()},getHighlightedOption:function(){return this.selected}});l("dojo-bidi")&&(h=f("dijit.form._ComboBoxMenuMixin",
h,{_createOption:function(){var a=this.inherited(arguments);this.applyTextDir(a);return a}}));return h})},"dijit/form/_ListMouseMixin":function(){define(["dojo/_base/declare","dojo/on","dojo/touch","./_ListBase"],function(p,f,a,l){return p("dijit.form._ListMouseMixin",l,{postCreate:function(){this.inherited(arguments);this.domNode.dojoClick=!0;this._listConnect("click","_onClick");this._listConnect("mousedown","_onMouseDown");this._listConnect("mouseup","_onMouseUp");this._listConnect("mouseover",
"_onMouseOver");this._listConnect("mouseout","_onMouseOut")},_onClick:function(a,f){this._setSelectedAttr(f,!1);this._deferredClick&&this._deferredClick.remove();this._deferredClick=this.defer(function(){this._deferredClick=null;this.onClick(f)})},_onMouseDown:function(a,f){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging=!0;this._setSelectedAttr(f,!1)},_onMouseUp:function(a,f){this._isDragging=!1;var l=this.selected,m=this._hoveredNode;l&&f==l?this.defer(function(){this._onClick(a,
l)}):m&&this.defer(function(){this._onClick(a,m)})},_onMouseOut:function(a,f){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging&&(this._cancelDrag=(new Date).getTime()+1E3)},_onMouseOver:function(a,f){this._cancelDrag&&((new Date).getTime()>this._cancelDrag&&(this._isDragging=!1),this._cancelDrag=null);this._hoveredNode=f;this.onHover(f);this._isDragging&&this._setSelectedAttr(f,!1)}})})},"dijit/form/_ListBase":function(){define(["dojo/_base/declare","dojo/on",
"dojo/window"],function(p,f,a){return p("dijit.form._ListBase",null,{selected:null,_listConnect:function(a,k){var h=this;return h.own(f(h.containerNode,f.selector(function(a,f,g){return a.parentNode==g},a),function(a){h[k](a,this)}))},selectFirstNode:function(){for(var a=this.containerNode.firstChild;a&&"none"==a.style.display;)a=a.nextSibling;this._setSelectedAttr(a,!0)},selectLastNode:function(){for(var a=this.containerNode.lastChild;a&&"none"==a.style.display;)a=a.previousSibling;this._setSelectedAttr(a,
!0)},selectNextNode:function(){var a=this.selected;if(a){for(a=a.nextSibling;a&&"none"==a.style.display;)a=a.nextSibling;a?this._setSelectedAttr(a,!0):this.selectFirstNode()}else this.selectFirstNode()},selectPreviousNode:function(){var a=this.selected;if(a){for(a=a.previousSibling;a&&"none"==a.style.display;)a=a.previousSibling;a?this._setSelectedAttr(a,!0):this.selectLastNode()}else this.selectLastNode()},_setSelectedAttr:function(f,k){if(this.selected!=f){var h=this.selected;if(h)this.onDeselect(h);
f&&(k&&a.scrollIntoView(f),this.onSelect(f));this._set("selected",f)}else if(f)this.onSelect(f)}})})},"builder/plugins/creation-entry/_build-generate_module":function(){define(["builder/plugins/creation-entry/Plugin","dojo/text!builder/plugins/creation-entry/Plugin.html","dojo/text!builder/plugins/creation-entry/css/style.css","dojo/i18n!builder/plugins/creation-entry/nls/strings"],function(){})},"builder/plugins/creation-entry/Plugin":function(){define("dojo/_base/declare dojo/_base/html dojo/Deferred dojo/keys builder/BasePlugin dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html dojo/_base/lang dojo/query dojo/promise/all jimu/dijit/Message jimu/dijit/Popup builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingShelter builder/serviceUtils ./SaveAsPage ./CreateNewAppPage builder/dijit/FullScreenPopup".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n){return p([k,h],{templateString:q,baseClass:"plugin-creation-app",fromAppId:null,postMixInProperties:function(){this.inherited(arguments);this.nls=m.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments)},popupNewCreateDlg:function(a,b){this._getInitAppInfo().then(m.hitch(this,function(c){this.createAppPage=new v({appInfo:c,pluginManager:this.pluginManager,createFromAppInfo:b,nls:this.nls,isPortalSupport3D:window.isPortalSupport3D});
c=g("#main-page")[0];this.createAppPopup=new n({zIndex:101,subDijit:this.createAppPage,titleStr:a||this.nls.appCreateNewAppTitle,content:this.createAppPage.domNode,blurContainer:c.firstElementChild,buttons:[{label:this.nls.next,key:l.ENTER,isHighLight:!0,onClick:m.hitch(this.createAppPage,this.createAppPage._onNextClick)},{label:this.nls.back,key:l.ENTER,isHighLight:!0,onClick:m.hitch(this.createAppPage,this.createAppPage._onBackClick)},{label:this.nls.ok,key:l.ENTER,isHighLight:!0,onClick:m.hitch(this,
this._onCreateNewClick)},{label:this.nls.cancel,key:l.ESCAPE,isHighLight:!1,onClick:m.hitch(this,this._onCreateNewCancelClick)}],btnsAtuoBottom:!0});this.createAppPopup.placeAt(c);this.createAppPopup.show();this.createAppPage.setPopup(this.createAppPopup);this.createAppPage.startup()}))},createNewApp:function(b){var e=new a;t.createApp(b).then(m.hitch(this,function(a){if(a.success){var c=m.clone(b);c.id=a.newAppId;this.pluginManager.getPluginByName("startup").switchToAppConfig(c);e.resolve();b.sharing&&
(b.webmap?this._shareAppWithWebmapOrWebscene(a.newAppId,b.folderId,b.webmap):b.webscene&&this._shareAppWithWebmapOrWebscene(a.newAppId,b.folderId,b.webscene))}else var g=new d({content:a.message,container:"main-page",titleLabel:builderNls.createError||"",width:400,autoHeight:!0,buttons:[{label:this.nls.ok,key:l.ENTER,onClick:m.hitch(this,function(){a.href&&(f.setStyle(g.domNode,"display","none"),window.location.href=a.href);g.close()})}]});e.reject()}),m.hitch(this,function(a){new c({message:a.message});
e.reject(a)}));return e},popupSaveAsDlg:function(a,c,e){this._getInitAppInfo(c).then(m.hitch(this,function(f){this.saveAsPage=new b({fromAppId:c,appInfo:f,nls:this.nls});this.saveAsPage.startup();this.saveAsPopup=new d({content:this.saveAsPage,container:"main-page",titleLabel:a||"",width:669,autoHeight:!0,buttons:[{label:this.nls.ok,key:l.ENTER,onClick:m.hitch(this,this._onSaveAsPopupNextClick,e)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],key:l.ESCAPE,onClick:m.hitch(this,this._onSaveAsPopupCancelClick)}]})}))},
_onSaveAsPopupCancelClick:function(){this._close()},_onSaveAsPopupNextClick:function(a){var b=this.saveAsPage._getAppInfoFromDlg(),d=this.pluginManager.getPluginByName("app-list");if(b.name){var e=new s;e.placeAt(this.saveAsPopup.domNode);e.startup();this._saveAs(b,a).then(m.hitch(this,function(){d&&window.isXT&&(b.isTemplate?d.refreshTemplatePage():d.refreshAppPage());e.destroy()}),function(){e.destroy()})}else new c({message:this.nls.noAppName})},_close:function(){this.saveAsPopup?(this.saveAsPopup.close(),
this.saveAsPopup=null):this.saveAsPage&&this.saveAsPage.destroy();this.createAppPopup&&(this.createAppPopup.close(),this.createAppPopup=null,this.createAppPage.destroy())},_saveAs:function(b,d){var e=new a;t.saveAs(b,d).then(m.hitch(this,function(a){if(a.success){var d=m.clone(b);d.id=a.newAppId;d.name=b.name;this._close();this.pluginManager.getPluginByName("startup").switchToAppConfig(d);e.resolve()}else new c({message:a.message}),e.reject()}),m.hitch(this,function(a){new c({message:a.message});
e.reject()}));return e},_onCreateNewClick:function(){var a=this.createAppPage._getAppInfoFromDlg(),b=this.pluginManager.getPluginByName("app-list");if(a.name){var d=new s;d.placeAt(this.createAppPopup.domNode);d.startup();this.createNewApp(a).then(m.hitch(this,function(){b&&window.isXT&&b.refreshAppPage();setTimeout(m.hitch(this,m.hitch(this,function(){this._close();d.destroy()})),200)}),function(){d.destroy()})}else new c({message:this.nls.noAppName})},_onCreateNewCancelClick:function(){this._close()},
_getInitAppInfo:function(b){var c=new a,d=this._getEmptyAppInfo();window.isXT?b?t.getAppInfo(b).then(m.hitch(this,function(a){d.name=a.name+this.nls._copy;d.description=a.description;d.appType=a.appType;d.isTemplate=a.isTemplate;d.thumbnail=a.thumbnail;c.resolve(d)}),m.hitch(this,function(a){console.error(this.nls.saveAsFaied,a);c.reject()})):c.resolve(d):b?r.getPortal(u.getPortalUrlFromLocation()).getItemById(b).then(m.hitch(this,function(a){d.name=a.title+this.nls._copy;d.tags=a.tags;d.description=
a.snippet;c.resolve(d)}),m.hitch(this,function(a){console.error(this.nls.saveAsFaied,a);c.reject()})):c.resolve(d);return c},_getEmptyAppInfo:function(){return{name:"",description:"",tags:["AppBuilder App"],folderId:"",sharing:!1,appType:window.appInfo.appType,webmap:null,fromAppId:null,creator:null,isPredefined:!0,isTemplate:!1,thumbnail:"/webappbuilder/builder/images/appthumbnail_2d.jpg",icon:"/webappbuilder/builder/images/logo.png"}},_shareAppWithWebmapOrWebscene:function(b,d,f){var g=r.getPortal(u.getPortalUrlFromLocation()),
h=new a,k=new a,l=new a,n=new a;g.getUser().then(m.hitch(this,function(a){h.resolve(a)}),m.hitch(this,function(a){new c({message:this.nls.createAppUrlError});console.error(a.message);h.reject()}));g.getItemById(f).then(m.hitch(this,function(a){k.resolve(a)}),m.hitch(this,function(a){new c({message:this.nls.createAppUrlError});console.error(a.message);k.reject(a)}));e({user:h,userItem:l}).then(m.hitch(this,function(a){var e={};switch(a.userItem.sharing.access){case "public":e.everyone=!0;e.groups=
a.userItem.sharing.groups.toString();break;case "account":case "org":e.org=!0;e.groups=a.userItem.sharing.groups.toString();break;case "shared":e.groups=a.userItem.sharing.groups.toString()}a.user.shareItem(e,b,d).then(m.hitch(this,function(a){n.resolve(a)}),m.hitch(this,function(a){new c({message:this.nls.createAppUrlError});console.error(a.message);n.reject()}))}));e({user:h,webmapItem:k}).then(m.hitch(this,function(a){if(a.webmapItem.owner===a.user.username)a.user.getItemById(f,a.webmapItem.ownerFolder).then(m.hitch(this,
function(a){l.resolve(a)}),m.hitch(this,function(a){new c({message:this.nls.createAppUrlError});console.error(a.message);l.reject(a)}));else{var e={};switch(a.webmapItem.access){case "public":e.everyone=!0;break;case "account":case "org":e.org=!0}a.user.shareItem(e,b,d).then(m.hitch(this,function(a){n.resolve(a)}),m.hitch(this,function(a){new c({message:this.nls.createAppUrlError});console.error(a.message);n.reject()}))}}))}})})},"builder/plugins/creation-entry/SaveAsPage":function(){define(["dojo/_base/declare",
"builder/BasePlugin","dijit/_WidgetsInTemplateMixin","dojo/text!./SaveAsPage.html","builder/dijit/ItemInfo"],function(p,f,a,l,k){return p([f,a],{templateString:l,baseClass:"saveas-app-page",fromAppId:null,appInfo:null,appType:null,_stemappExtensions:null,webmap:null,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments)},startup:function(){window.isXT?(this.appInfo.tags=void 0,this.appInfo.folderId=void 0,this.appInfo.sharing=void 0):this.fromAppId&&
(this.appInfo.sharing=void 0,this.appInfo.thumbnail=void 0);this.itemInfoDijit=new k({itemInfo:this.appInfo});this.itemInfoDijit.placeAt(this.itemInfoBox)},_getAppInfoFromDlg:function(){var a=this.itemInfoDijit.getProperties();a.appType=this.appInfo.appType;a.webmap=this.webmap;a.fromAppId=this.fromAppId;a.isPredefined="default"===this.fromAppId||!this.fromAppId?!0:!1;a.isTemplate=this.appInfo.isTemplate?!0:!1;a.saveAsTemplate=!1;return a}})})},"builder/plugins/creation-entry/CreateNewAppPage":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html builder/BasePlugin dojo/dom-style dijit/_WidgetsInTemplateMixin dojo/text!./CreateNewAppPage.html dojo/query dojo/on dojo/dom-class dojo/_base/lang dojo/Evented builder/dijit/EditItemInfo builder/serviceUtils jimu/portalUrlUtils builder/portalUtils jimu/utils".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b){return p([l,h,d],{templateString:q,baseClass:"create-app-page",appInfo:null,pluginManager:null,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments)},startup:function(){"undefined"===typeof this.isPortalSupport3D&&(this.isPortalSupport3D=!1);this.isPortalSupport3D=!!this.isPortalSupport3D;this.initAppInfoPage();this.createFromAppInfo?(this.selectedApp=this.createFromAppInfo,this._displaySecondPage(),this._hideButton(1)):
(this.initAppSelectPage(),this._displayFirstPage())},destroy:function(){this.itemInfoDijit&&(this.itemInfoDijit.destroy(),this.itemInfoDijit=null);this.popup&&(this.popup=null);a.destroy(this.domNode);this.inherited(arguments)},initAppSelectPage:function(){this._stemappExtensions=this.pluginManager.getExtensions("startup.stemapps");this._stemappExtensions.sort(function(a,b){return a.parameters.index-b.parameters.index});u.getTemplateList(!0).then(c.hitch(this,function(a){var b=this._filterInfosByIsPortalSupport3D(a);
f.forEach(b,function(a){a.id&&("HTML_default"===a.id||"HTML3D_default"===a.id)?("HTML_default"===a.id?a.name=this.nls.Default2D:"HTML3D_default"===a.id&&(a.name=this.nls.Default3D),this._createAppNodeAndBindEvent(a,this.defaultApps)):this._createAppNodeAndBindEvent(a,this.othersApps)},this);this._selecteApp(m(".app-image-border-div",this.allAppContent)[0]);b=s.getStandardPortalUrl(window.portalUrl);t.getPortal(b).getUser().then(c.hitch(this,function(b){var c=f.filter(a,function(a){return a.isTemplate&&
a.creator===b.username}),c=this._filterInfosByIsPortalSupport3D(c);f.forEach(c,function(a){this._createAppNodeAndBindEvent(a,this.ownAppContent)},this)}))}))},_filterInfosByIsPortalSupport3D:function(a){var b=this.isPortalSupport3D;return f.filter(a,function(a){return!1===b?"HTML3D"!==a.appType:!0})},initAppInfoPage:function(){this.itemInfoDijit=new r({itemInfo:this.appInfo,nls:this.nls});this.itemInfoDijit.placeAt(this.appInfoTable)},_createAppNode:function(c,d,e){this.zIndex=10;d=a.create("div",
{"class":"app-node jimu-float-leading",style:e},d);e=a.create("div",{"class":"app-image-border-div"},d);a.create("div",{"class":"app-image-div",style:{backgroundImage:"url("+c.thumbnail+")"}},e);var f;"HTML"===c.appType?f="2D":"HTML3D"===c.appType&&(f="3D");f=a.create("div",{"class":"flag-image flag-image-"+f},e);k.set(f,"z-index",this.zIndex++);a.create("div",{"class":"app-name",innerHTML:b.stripHTML(c.name),title:b.stripHTML(c.name)},d);return e},_createAppNodeAndBindEvent:function(a,b){var d=this._createAppNode(a,
b);this.own(g(d,"click",c.hitch(this,this._onAppNodeClick,d)));d.appInfo=a;return d},_onAppNodeClick:function(a){var b=m(".app-image-border-div",this.appSelectPage);f.forEach(b,function(a){this._unselecteApp(a)},this);this._selecteApp(a)},_selecteApp:function(a){this.selectedApp=a.appInfo;e.add(a,"jimu-state-active")},_unselecteApp:function(a){e.remove(a,"jimu-state-active")},_onAllAppBtnClick:function(){var b=m(".app-image-border-div",this.allAppContent)[0];b&&this._onAppNodeClick(b);a.setStyle(this.allAppContent,
"display","block");a.setStyle(this.ownAppContent,"display","none");a.addClass(this.allAppBtn,"selected");a.removeClass(this.ownAppBtn,"selected")},_onOwnAppBtnClick:function(){var b=m(".app-image-border-div",this.ownAppContent)[0];b&&this._onAppNodeClick(b);a.setStyle(this.allAppContent,"display","none");a.setStyle(this.ownAppContent,"display","block");a.addClass(this.ownAppBtn,"selected");a.removeClass(this.allAppBtn,"selected")},_onNextClick:function(){this._displaySecondPage();"HTML"===this.selectedApp.appType?
this.itemInfoDijit.imageChooser.setDefaultSelfSrc("/webappbuilder/builder/images/appthumbnail_2d.jpg"):this.itemInfoDijit.imageChooser.setDefaultSelfSrc("/webappbuilder/builder/images/appthumbnail_3d.jpg")},_onBackClick:function(){this._displayFirstPage()},_displayFirstPage:function(){a.setStyle(this.appInfoPage,"display","none");a.setStyle(this.appSelectPage,"display","block");this._displayButtion(0);this._hideButton(1);this._hideButton(2);this.popup&&this.popup.resize()},_displaySecondPage:function(){a.setStyle(this.appSelectPage,
"display","none");a.setStyle(this.appInfoPage,"display","block");this._hideButton(0);this._displayButtion(1);this._displayButtion(2);this.popup&&this.popup.resize();this.itemInfoDijit&&this.itemInfoDijit.focusItemByName("appName")},setPopup:function(a){this.popup=a},_hideButton:function(b){a.setStyle(this.popup.enableButton(b),"display","none")},_displayButtion:function(b){a.setStyle(this.popup.enableButton(b),"display","inline-block")},_getAppInfoFromDlg:function(){var a=this.itemInfoDijit.getProperties();
a.appType=this.selectedApp.appType;a.webmap=this.webmap;a.fromAppId=this.selectedApp.id;a.isPredefined=!1;a.isTemplateApp=this.selectedApp.isTemplate;0===a.icon.indexOf("/webappbuilder/builder/images/")&&(a.icon=null);0===a.thumbnail.indexOf("/webappbuilder/builder/images/")&&(a.thumbnail=null);return a}})})},"builder/plugins/header/_build-generate_module":function(){define(["builder/plugins/header/Plugin","dojo/text!builder/plugins/header/Plugin.html","dojo/text!builder/plugins/header/css/style.css",
"dojo/i18n!builder/plugins/header/nls/strings"],function(){})},"builder/plugins/header/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/topic dojo/Deferred dojo/request dojo/request/script builder/portalUtils jimu/portalUrlUtils builder/tokenUtils jimu/utils builder/BasePlugin dojo/_base/config".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r,u){return p([r],{baseClass:"plugin-header",_trainingUrls:{administrator:"//www.esri.com/training/main/arcgis-online-administrators",
publisher:"//www.esri.com/training/main/arcgis-online-publishers",user:"//www.esri.com/training/main/arcgis-online-users","public":"//www.esri.com/training/main/arcgis-online-training",custom:"//www.esri.com/training/main/arcgis-online-training"},_esriCommunityLink:"https://community.esri.com",_myEsriLink:"https://my.esri.com",postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this._isWebTier(window.portalUrl).then(f.hitch(this,function(c){c&&a.setStyle(this.signOutItem,
"display","none")}));window.isXT?(a.addClass(this.domNode,"xt"),a.destroy(this.homeSection),this._bindXtEvents()):(a.addClass(this.homeLabel,"js-home-dropdown"),a.destroy(this.switchSection),this._bindIntegratedEvents(window.portalUrl));var c=g.getPortal(window.portalUrl);c.haveSignIn()&&c.getUser().then(f.hitch(this,function(c){if(c){var b=c.firstName||c.username;b&&(this.userNameNode.innerHTML=b);if(c.thumbnail&&(b=e.getUserThumbnailUrl(window.portalUrl,c.username,c.thumbnail))){var d=c.credential&&
c.credential.token;d&&(b+="?token\x3d"+d);this.userIcon.src=b;this.profileImg.src=b}this.profileNameNode.innerHTML=c.username;e.isOnline(window.portalUrl)?(b="",b=c.isAdminRole()?this._trainingUrls.administrator:c.isPublisherRole()?this._trainingUrls.publisher:c.isUserRole()?this._trainingUrls.user:this._trainingUrls.custom,this.trainingNode.href=b,a.removeClass(this.trainingNode,"hidden"),"both"===c.userType&&(this.communityNode.href=this._esriCommunityLink,this.myesriNode.href=this._myEsriLink,
a.removeClass(this.communityNode,"hidden"),a.removeClass(this.myesriNode,"hidden"))):c.isAdminRole()&&(this.adminHelpNode.href=e.getPortalAdminHelpUrl(window.portalUrl,u.locale),a.removeClass(this.adminHelpNode,"hidden"))}}),f.hitch(this,function(a){console.error(a)}))},_isWebTier:function(a){var d=new h,b=esri.id.findServerInfo(a);b&&b.webTierAuth?d.resolve(!0):d=c.isWebTierPortal(a);return d},_isUserMenuShow:function(){return a.hasClass(this.userSection,"is-active")},_showUserMenu:function(){a.addClass(this.userSection,
"is-active")},_hideUserMenu:function(){a.removeClass(this.userSection,"is-active")},_bindXtEvents:function(){this.own(l(document.body,"click",f.hitch(this,function(c){c=c.target||c.srcElement;c!==this.userSection&&!a.isDescendant(c,this.userSection)&&this._hideUserMenu()})));this.own(k.subscribe("iframeClick",f.hitch(this,function(){this._hideUserMenu()})));this.own(k.subscribe("userSignOut",f.hitch(this,function(){this.userNameNode.innerHTML=""})));this.own(k.subscribe("userSignIn",f.hitch(this,
function(a){this.userNameNode.innerHTML=a.userId||""})));this.logoTitle.title=this.nls.backToHomePage||"";this.own(l(this.logoTitle,"click",f.hitch(this,function(c){c.preventDefault();a.hasClass(this.domNode,"app-opened")&&this.pluginManager.getPluginByName("startup").switchToAppList()})));this.own(l(this.profileItem,"click",f.hitch(this,function(){var a=f.hitch(this,function(){window.location.href=e.getHomeUserUrl(window.portalUrl)});this._isInConfig()?k.publish("closeAppConfigPage",a):a()})));this.helpNode.href=
"help";this.signOutItem&&this.own(l(this.signOutItem,"click",f.hitch(this,function(){var a=f.hitch(this,function(){this.userNameNode.innerHTML="";c.signOutAll();var a=e.getOAuth2SignOutUrl(window.portalUrl),a=e.setHttpsProtocol(a),b=function(){var a=d.getLocationUrlWithoutHashAndQueryParams(),a=d.url.addQueryParamToUrl(a,"action","setportalurl");window.location.href=a};this._getSigninInfo(window.portalUrl).then(function(c){if(c.success&&c.info&&c.info.portalUrl&&c.info.supportsOAuth)try{m.get(a).always(function(){b()})}catch(d){console.error(d),
b()}else b()},function(){b()})});this._isInConfig()?k.publish("closeAppConfigPage",a):a()})));this.own(l(window,"resize",f.hitch(this,function(){this._calculateWidth()})));this.own(l(this.appSwitch,"click",f.hitch(this,this._onAppsClicked)));this.own(l(this.templateSwitch,"click",f.hitch(this,this._onTemplatesClicked)));this._calculateWidth()},_calculateWidth:function(){1816>=window.innerWidth?a.addClass(this.domNode,"width-less1816"):a.removeClass(this.domNode,"width-less1816")},_getSigninInfo:function(a){return q("/webappbuilder/rest/signininfo/getsignininfo",
{handleAs:"json",query:"portalUrl\x3d"+a,method:"GET"})},_bindIntegratedEvents:function(d){this.own(l(document.body,"click",f.hitch(this,function(c){c=c.target||c.srcElement;c!==this.homeLabel&&a.removeClass(this.homeSection,"is-active");c!==this.userSection&&!a.isDescendant(c,this.userSection)&&this._hideUserMenu()})));this.own(k.subscribe("iframeClick",f.hitch(this,function(){a.removeClass(this.homeSection,"is-active");this._hideUserMenu()})));this.own(l(this.homeLabel,"click",f.hitch(this,function(c){c.preventDefault();
a.hasClass(this.homeSection,"is-active")?a.removeClass(this.homeSection,"is-active"):a.addClass(this.homeSection,"is-active")})));this.own(l(this.homeItem,"click",f.hitch(this,function(){k.publish("closeAppConfigPage",function(){window.location.href=e.getHomeIndexUrl(d)})})));this.own(l(this.galleryItem,"click",f.hitch(this,function(){k.publish("closeAppConfigPage",function(){window.location.href=e.getHomeGalleryUrl(d)})})));this.own(l(this.mapItem,"click",f.hitch(this,function(){window.appConfig&&
window.appConfig.map&&k.publish("closeAppConfigPage",function(){window.location.href=e.getHomeMapViewerUrl(window.appConfig.map.portalUrl||window.appConfig.portalUrl,window.appConfig.map.itemId)})})));this.own(l(this.sceneItem,"click",f.hitch(this,function(){window.appConfig&&window.appConfig.map&&k.publish("closeAppConfigPage",function(){window.location.href=e.getHomeSceneViewerUrl(window.appConfig.map.portalUrl||window.appConfig.portalUrl)})})));this.own(l(this.groupsItem,"click",f.hitch(this,function(){k.publish("closeAppConfigPage",
function(){window.location.href=e.getHomeGroupsUrl(d)})})));this.own(l(this.contentItem,"click",f.hitch(this,function(){k.publish("closeAppConfigPage",function(){window.location.href=e.getHomeMyContentUrl(d)})})));this.own(l(this.organizationItem,"click",f.hitch(this,function(){k.publish("closeAppConfigPage",function(){window.location.href=e.getHomeMyOrganizationUrl(d)})})));this.own(l(this.profileItem,"click",f.hitch(this,function(){k.publish("closeAppConfigPage",function(){window.location.href=
e.getHomeUserUrl(d)})})));0<=d.toLowerCase().indexOf(".arcgis.com")?this.helpNode.href="http://doc.arcgis.com/en/web-appbuilder/":this.helpNode.href=e.getPortalHelpUrl(d,u.locale);this.signOutItem&&this.own(l(this.signOutItem,"click",f.hitch(this,function(){k.publish("closeAppConfigPage",function(){c.signOutAll();window.location.href=e.getPortalSignInUrlFromLocation()})})))},setAppName:function(c){c=c||"";(this.appName.innerHTML=c)?(this.logoTitle.title=this.nls.backToHomePage||"",a.addClass(this.domNode,
"app-opened"),a.removeClass(this.domNode,"app-not-opened")):(this.logoTitle.title="",a.removeClass(this.domNode,"app-opened"),a.addClass(this.domNode,"app-not-opened"))},getAppName:function(){return this.appName.innerHTML||""},_isInConfig:function(){return"appconfig"===this.pluginManager.getPluginByName("startup").getCurrentView().label},_onUserSectionClicked:function(c){c=c.target||c.srcElement;var d=!0;if(a.isDescendant(c,this.userInfoDom)||c===this.userInfoDom)this._isUserMenuShow()||(d=!1);d?
this._hideUserMenu():this._showUserMenu()},_onAppsClicked:function(){a.removeClass(this.templateSwitch,"selected");a.addClass(this.appSwitch,"selected");k.publish("switchToAppListApps")},_onTemplatesClicked:function(){a.removeClass(this.appSwitch,"selected");a.addClass(this.templateSwitch,"selected");k.publish("switchToAppListTemplates")}})})},"builder/plugins/map-config/_build-generate_module":function(){define(["builder/plugins/map-config/Plugin","dojo/text!builder/plugins/map-config/Plugin.html",
"dojo/text!builder/plugins/map-config/css/style.css","dojo/i18n!builder/plugins/map-config/nls/strings"],function(){})},"builder/plugins/map-config/Plugin":function(){define("dojo/_base/declare dojo/topic dojo/on dojo/text!./Plugin.html dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/_base/event dojo/keys dojo/json dojo/dom-construct builder/BasePlugin builder/portalUtils jimu/portalUrlUtils jimu/dijit/Message jimu/utils jimu/dijit/Popup ./MapSelector ./CustomizeScale require".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x){return p([r],{templateString:l,baseClass:"map-config",appConfig:null,map:null,sceneView:null,item:null,widgetsConfigCache:null,postMixInProperties:function(){var a=k.clone(window.builderNls);this.nls=k.mixin(a,this.nls);this.nls.scaleDisabledTip2=this.nls.scaleDisabledTip.replace("${scaleTitle}",'"'+this.nls.scaleTitle+'"');this._is3D()?(this.nls.clickChooseWebMapOrWebScene=this.nls.clickChooseWebScene,this.nls.chooseWebMapOrWebScene=this.nls.chooseWebScene):
(this.nls.clickChooseWebMapOrWebScene=this.nls.clickChooseWebMap,this.nls.chooseWebMapOrWebScene=this.nls.selectWebMap)},postCreate:function(){this.inherited(arguments);this._init()},destroy:function(){this.appConfigPlugin=null;this.inherited(arguments)},_is3D:function(){return"HTML3D"===window.appInfo.appType},_init:function(){this.widgetsConfigCache={};this.own(f.subscribe("app/appConfigChanged",k.hitch(this,this.setAppConfig)));this.own(f.subscribe("app/appConfigLoaded",k.hitch(this,this.setAppConfig)));
this.own(f.subscribe("app/mapLoaded",k.hitch(this,function(a){this._setMap(a)})));this.own(f.subscribe("app/mapChanged",k.hitch(this,function(a){this._setMap(a)})));this.own(f.subscribe("app/sceneViewLoaded",k.hitch(this,function(a){this.sceneView=a})));this.own(f.subscribe("app/sceneViewChanged",k.hitch(this,function(a){this.sceneView=a})));this.appConfigPlugin=this.pluginManager.getPluginByName("app-config");this.embeddedMapViewerHelper={portalUrl:void 0,container:void 0,popup:void 0,webmapId:void 0,
frameName:"embeddedMapViewer",hideItems:"hide\x3dshare,lnk,analysis,directions",params:"embedded\x3d1\x26locale\x3d"+dojoConfig.locale,loadingShelter:void 0,loaded:void 0,hasUnsavedChanged:void 0,readyToClose:void 0,loadInterval:void 0,unsavedInterval:void 0,webmapIdInterval:void 0,isClosing:!1};this.own(a(window,"message",k.hitch(this,this.receiveViewerMessage)));this._is3D()?q.addClass(this.mapOptions3D,"enabled"):q.addClass(this.mapOptions2D,"enabled")},_setInitialExtent:function(){try{f.publish("mapOptionsChanged",
{extent:this.map.extent.toJson()})}catch(a){console.error(a)}},_blinkMapContainer:function(){var a=null;if(a=this._is3D()?this.sceneView.container:this.map.container){var b=q.create("div");q.addClass(b,"blink-map-border");q.place(b,a);var c=0,d=setInterval(k.hitch(this,function(){q.toggleClass(b,"blink-map-border-show");c++;6===c&&(b.parentNode.removeChild(b),clearInterval(d))}),200)}},_useCurrentMapExtent:function(){this.map&&(this._setInitialExtent(),this._blinkMapContainer())},_useDefaultMapExtent:function(a){b.restoreToDefaultWebMapExtent(this.map,
this.map.webMapResponse,this.appConfig&&this.appConfig.geometryService).then(k.hitch(this,function(){this._setInitialExtent();a&&this._blinkMapContainer()}),k.hitch(this,function(a){"string"===typeof a&&new t({message:a});console.error(a)}))},showMapSelector:function(){this.hideMapOptions();var a=new n({nls:this.nls,type:"HTML3D"===window.appInfo.appType?"Web Scene":"Web Map"}),b=new v({width:1024,titleLabel:this.nls.chooseWebMapOrWebScene,content:a,container:"main-page",onClose:k.hitch(this,function(){try{a&&
a.domNode&&a.destroy()}catch(b){console.error(b)}a=null;return!0}),buttons:[{label:this.nls.ok,key:e.ENTER,classNames:["map-selector-btn-ok"],onClick:k.hitch(this,function(){var c=a.getSelectedMapItem();this._selectItem(c,b)})},{label:this.nls.cancel,key:e.ESCAPE,classNames:["map-selector-btn-cancel","jimu-btn-vacation"],onClick:k.hitch(this,function(){b.close()})}]})},embedWebMap:function(a,b){var c,e;this.embeddedMapViewerHelper.portalUrl=s.getStandardPortalUrl(this.appConfig.portalUrl);c=this.embeddedMapViewerHelper.portalUrl+
"/home/webmap/viewer.html?"+(b?"webmap\x3d"+b+"\x26":"")+this.embeddedMapViewerHelper.params+"\x26"+this.embeddedMapViewerHelper.hideItems;e=u.getPortal(this.embeddedMapViewerHelper.portalUrl);c+="#"+e.credential.token;this.embeddedMapViewerHelper.container=d.create("div",{"class":"embed-mapviewer-content"});d.create("iframe",{src:c,name:this.embeddedMapViewerHelper.frameName,style:"width:100%;height:99%"},this.embeddedMapViewerHelper.container);this.embeddedMapViewerHelper.loadingShelter=d.create("div",
{"class":"load-container"},this.embeddedMapViewerHelper.container);c=d.create("div",{"class":"loader"},this.embeddedMapViewerHelper.loadingShelter);q.setStyle(c,"background","url("+x.toUrl("jimu/css/images/loadingmap.gif")+")");q.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","");c=new v({titleLabel:a,content:this.embeddedMapViewerHelper.container,container:"main-page",onClose:k.hitch(this,function(){if(!0===this.embeddedMapViewerHelper.readyToClose)return!0;this._closeEmbeddedMapViewer();
return!1})});q.setStyle(c.domNode,{top:"5%",left:"5%",width:"90%",height:"90%"});c.startup();this.embeddedMapViewerHelper.popup=c;this.embeddedMapViewerHelper.loaded=!1;this.embeddedMapViewerHelper.readyToClose=!1;this.embeddedMapViewerHelper.isClosing=!1;this.embeddedMapViewerHelper.loadInterval=setInterval(k.hitch(this,function(){this.embeddedMapViewerHelper.loaded?(q.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","none"),clearInterval(this.embeddedMapViewerHelper.loadInterval),
this.embeddedMapViewerHelper.loadInterval=null):this.sendPostMessage({type:"isLoaded"})}),500)},showMapOptions:function(a){g.stop(a);q.setStyle(this.webMapEditOptions,"display","");q.setStyle(this.webMapOptionsMask,"display","")},hideMapOptions:function(){q.setStyle(this.webMapEditOptions,"display","none");q.setStyle(this.webMapOptionsMask,"display","none")},editWebMap:function(){this.hideMapOptions();this.embedWebMap(this.nls.editMap,this.appConfig.map.itemId)},createWebMap:function(){this.hideMapOptions();
this.embedWebMap(this.nls.createMap)},_closeEmbeddedMapViewer:function(){this.embeddedMapViewerHelper.isClosing||(this.embeddedMapViewerHelper.isClosing=!0,q.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display",""),this.embeddedMapViewerHelper.loaded?(this.embeddedMapViewerHelper.hasUnsavedChanged=void 0,this.embeddedMapViewerHelper.unsavedInterval=setInterval(k.hitch(this,function(){if("undefined"===typeof this.embeddedMapViewerHelper.hasUnsavedChanged)this.sendPostMessage({type:"hasUnsavedChanges"});
else if(clearInterval(this.embeddedMapViewerHelper.unsavedInterval),this.embeddedMapViewerHelper.unsavedInterval=null,this.embeddedMapViewerHelper.hasUnsavedChanged)var a=new v({content:this.nls.hasUnsavedChanges,titleLabel:this.nls.customMap,autoHeight:!0,width:600,buttons:[{label:this.nls.ok,onClick:k.hitch(this,function(){a.close();this._doCloseEmbeddedMapViewer()})},{label:this.nls.cancel,onClick:k.hitch(this,function(){q.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","none");
this.embeddedMapViewerHelper.isClosing=!1;a.close()})}]});else this._doCloseEmbeddedMapViewer()}),500)):this._doCloseEmbeddedMapViewer())},_doCloseEmbeddedMapViewer:function(){q.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","none");this.embeddedMapViewerHelper.loadInterval&&(clearInterval(this.embeddedMapViewerHelper.loadInterval),this.embeddedMapViewerHelper.loadInterval=null);this.embeddedMapViewerHelper.unsavedInterval&&(clearInterval(this.embeddedMapViewerHelper.unsavedInterval),
this.embeddedMapViewerHelper.unsavedInterval=null);this.embeddedMapViewerHelper.loaded?(this.embeddedMapViewerHelper.webmapId=void 0,this.sendPostMessage({type:"getWebmapId"}),this.embeddedMapViewerHelper.webmapIdInterval=setInterval(k.hitch(this,function(){"undefined"!==typeof this.embeddedMapViewerHelper.webmapId&&(clearInterval(this.embeddedMapViewerHelper.webmapIdInterval),this.embeddedMapViewerHelper.webmapIdInterval=null,d.destroy(this.embeddedMapViewerHelper.container),this.embeddedMapViewerHelper.container=
null,this.embeddedMapViewerHelper.readyToClose=!0,this.embeddedMapViewerHelper.popup.close(),this.embeddedMapViewerHelper.webmapId&&u.getPortal(this.embeddedMapViewerHelper.portalUrl).getItemById(this.embeddedMapViewerHelper.webmapId).then(k.hitch(this,function(a){this._updateWebMap(a)})))}),500)):(d.destroy(this.embeddedMapViewerHelper.container),this.embeddedMapViewerHelper.container=null,this.embeddedMapViewerHelper.readyToClose=!0,this.embeddedMapViewerHelper.popup.close())},sendPostMessage:function(a){this.embeddedMapViewerHelper.portalUrl&&
window.frames[this.embeddedMapViewerHelper.frameName]&&window.frames[this.embeddedMapViewerHelper.frameName].postMessage(c.stringify(a),this.embeddedMapViewerHelper.portalUrl)},receiveViewerMessage:function(a){console.log("received",a.origin,a.data);if(!(0>this.embeddedMapViewerHelper.portalUrl.indexOf(a.origin)))switch(a=c.parse(a.data),a.type){case "webmapId":this.embeddedMapViewerHelper.webmapId=a.webmapId;break;case "loaded":this.embeddedMapViewerHelper.loaded=a.value;break;case "unsavedChanges":this.embeddedMapViewerHelper.hasUnsavedChanged=
a.value;break;case "message":console.log(a.message)}},_selectItem:function(a,b){a&&(this._hasSameWebMap(this.appConfig,{map:{portalUrl:a.portalUrl,itemId:a.id}})?b.close():this._updateWebMap(a,b))},_updateWebMap:function(a,b){var c=this.appConfig,c=this._getHttpWebMapItemUrl(c.map.portalUrl||c.portalUrl,c.map.itemId);this.widgetsConfigCache[c]||(this.widgetsConfigCache[c]={});var d=this.widgetsConfigCache[c],e=k.clone(this.appConfig);e.map.portalUrl=a.portalUrl;e.map.itemId=a.id;var g=this._tryResetWidgetsConfigWhenMapSwitched(e);
if(0<g.length){var c=h.map(g,k.hitch(this,function(a){return a.label})),l=q.toDom("\x3cdiv style\x3d'font-size:14px;line-height:22px;'\x3e\x3cdiv\x3e"+this.nls.mapSwitchConfimationTip+"\x3c/div\x3e\x3cdiv style\x3d'margin-top:25px;margin-bottom:20px;color:#596679;'\x3e"+this.nls.theseWidgetsAre+":\x3c/div\x3e\x3cul class\x3d'reset-widget-list' style\x3d'color:#596679;'\x3e\x3c/ul\x3e\x3cdiv style\x3d'margin-top:25px;'\x3e"+this.nls.sureToSwitch+"\x3c/div\x3e\x3c/div\x3e"),n=m(".reset-widget-list",
l)[0];h.forEach(c,k.hitch(this,function(a,b){var c=q.create("li",{innerHTML:a},n);0!==b&&(c.style.marginTop="8px")}));var p=new v({content:l,titleLabel:this.nls.mapSwitchConfimation,autoHeight:!0,width:640,buttons:[{label:this.nls.ok,onClick:k.hitch(this,function(){b&&b.close();p.close();this.appConfigPlugin.showLoadingCover();f.publish("new-webmap-item-selected",a);f.publish("setAppConfig",e);h.forEach(g,k.hitch(this,function(a){d[a.id]=a.config}))})},{label:this.nls.cancel,onClick:k.hitch(this,
function(){p.close()})}]})}else b&&b.close(),this.appConfigPlugin.showLoadingCover(),this._publishMapChange(a)},_publishMapChange:function(a){f.publish("new-webmap-item-selected",a);this._is3D()?f.publish("sceneViewChanged",{portalUrl:a.portalUrl,itemId:a.id}):f.publish("mapChanged",{portalUrl:a.portalUrl,itemId:a.id})},_hasSameWebMap:function(a,b){var c=a&&a.map,d=c&&c.itemId,e=b&&b.map,f=e&&e.itemId;return(c=s.isSamePortalUrl(c&&c.portalUrl,e&&e.portalUrl))&&d===f},_setMap:function(a){this.map=
a;this._checkCustomScaleAvailablity()},setAppConfig:function(a){if(this.appConfig){var b=this._hasSameWebMap(this.appConfig,a);this.appConfig=a;b||this._requestCurrentItem()}else this.appConfig=a,this._requestCurrentItem();this._is3D()||!s.isSameDomain(this.appConfig.map.portalUrl,window.location.hostname)?(q.setStyle(this.mapOptions,"display","none"),q.setStyle(this.chooseMapButton,"width","100%"),q.setStyle(this.chooseMapButton,"max-width","100%")):(q.setStyle(this.mapOptions,"display",""),q.setStyle(this.chooseMapButton,
"width","140px"),q.setStyle(this.chooseMapButton,"max-width","140px"))},_getHttpWebMapItemUrl:function(a,b){var c=s.getItemUrl(a,b);return c=s.setHttpProtocol(c)},_tryResetWidgetsConfigWhenMapSwitched:function(a){var b=[],c=this._getHttpWebMapItemUrl(a.map.portalUrl||a.portalUrl,a.map.itemId);this.widgetsConfigCache[c]||(this.widgetsConfigCache[c]={});var d=this.widgetsConfigCache[c];a.visitElement(k.hitch(this,function(a){if(!a.widgets&&a.uri&&!1===a.keepConfigAfterMapSwitched){var c=a.config,e=
d&&d[a.id];e?a.config=e:delete a.config;if(!a.isDefaultConfig||e)a=k.clone(a),a.config=c,b.push(a)}}));return b},_requestCurrentItem:function(){var a=this.appConfig&&this.appConfig.map&&this.appConfig.map.itemId;if(a){var a={q:"id:"+a,num:1,f:"json"},b=u.getPortal(this.appConfig.map&&this.appConfig.map.portalUrl);b&&b.queryItems(a).then(k.hitch(this,function(a){this.domNode&&(a=a.results,0<a.length&&this._showSelectedItem(a[0]))}),k.hitch(this,function(a){console.debug("query item from portal failed",
a)}))}},_tryLocaleDate:function(a){var c=b.localizeDate(a,{selector:"date"});c||(c=a.toLocaleDateString());return c},_showSelectedItem:function(a){this.item=a;var b=a.type.toLowerCase();q.empty(this.thumbnailContainer);q.removeClass(this.webItemIcon,"webmap");q.removeClass(this.webItemIcon,"webscene");this.webItemType.innerHTML=a.type;var c=q.create("div",{"class":"thumbnail"},this.thumbnailContainer);a.thumbnailUrl?q.setStyle(c,"backgroundImage","url("+a.thumbnailUrl+")"):"web map"===b?q.addClass(c,
"default-webmap"):"web scene"===b&&q.addClass(c,"default-webscene");"web map"===b?q.addClass(this.webItemIcon,"webmap"):"web scene"===b&&q.addClass(this.webItemIcon,"webscene");this.snippet.innerHTML=a.snippet||"";this.lastModified.innerHTML=this._tryLocaleDate(new Date(a.modified));this.lastModified.title=this.lastModified.innerHTML;this.webMapDetails.href=a.detailsPageUrl;b=a.owner||"";this.ownerName.innerHTML=b;this.ownerName.title=b;this.ownerName.href=a.ownerPageUrl||"";this.mapTitle.innerHTML=
a.title;this.mapTitle.title=a.title},_checkCustomScaleAvailablity:function(){this._isBasemapLayerSupportLods()?(q.removeClass(this.btnScale,"jimu-state-disabled"),this.btnScale.title=""):(q.addClass(this.btnScale,"jimu-state-disabled"),this.btnScale.title=this.nls.scaleDisabledTip2)},_isBasemapLayerSupportLods:function(){var a=!1;if(this.map){var b=this.map.layerIds;b&&0<b.length&&(a=(a=this.map.getLayer(b[0]))&&a.tileInfo&&a.tileInfo.lods)}return a},_onBtnScaleClicked:function(){if(this._isBasemapLayerSupportLods())var a=
new w({nls:this.nls,map:this.map}),b=new v({width:640,height:590,titleLabel:this.nls.scaleTitle,content:a,container:"main-page",onClose:k.hitch(this,function(){try{a&&a.domNode&&a.destroy()}catch(b){console.error(b)}a=null;return!0}),buttons:[{label:this.nls.ok,onClick:k.hitch(this,function(){var c=a.getLodsFromListNode(),d=a.getLodsFromMap();b.close();var e=!1,e=c.length===d.length?h.every(c,k.hitch(this,function(a,b){var c=d[b],e=a.scale===c.scale,f=a.resolution===c.resolution;return a.level===
c.level&&e&&f})):!1;e||(this.appConfigPlugin.showLoadingCover(),f.publish("mapOptionsChanged",{lods:c}))})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:k.hitch(this,function(){b.close()})}]})},_setInitialViewpoint:function(a){try{f.publish("mapOptionsChanged",{initialState:{viewpoint:a}})}catch(b){console.error(b)}},_useCurrentViewpoint:function(){if(this.sceneView){var a=this.sceneView.viewpoint.toJSON();this._setInitialViewpoint(a);this._blinkMapContainer()}},_useDefaultViewpoint:function(){var a=
this.sceneView.map.itemInfo.itemData.initialState.viewpoint,a=k.clone(a);this._setInitialViewpoint(a);this._blinkMapContainer()}})})},"dojo/_base/query":function(){define(["../query","./NodeList"],function(p){return p})},"builder/plugins/map-config/MapSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapSelector.html dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/html dojo/query dojo/on jimu/utils jimu/dijit/TabContainer3 jimu/portalUrlUtils jimu/dijit/Search builder/portalUtils ./MapTable dijit/form/Select".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v){return p([a,l,k],{templateString:h,baseClass:"map-selector",tab:null,isPublicTabShow:!1,nls:null,type:"",_user:null,_group:null,_webMapQueryString:"",_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_signIn:!1,portal:null,postCreate:function(){this.inherited(arguments);
this._webMapQueryString=" "+r.getItemQueryStringByTypes([this.type])+" ";this.portal=b.getPortal(this._getPortalUrl());this._initSearchQuery();this._initTabs();this._initPortalRadio();this._initMapTables();this._initPrivate();this._initPublic();this._bindMapTableEvents();this._updateUIbySignIn()},startup:function(){this.tab._started||(this.tab.startup(),this.tab._started=!0)},_initTabs:function(){var a={title:this.nls.myContent,content:this.mycontentTabNode},b={title:this.nls.myOrganization,content:this.organizationTabNode},
c={title:this.nls.myGroup,content:this.groupTabNode},f={title:this.nls.publicMap,content:this.publicTabNode};this.isPublicTabShow=!1;this.tab=new u({tabs:[a,b,c,f]},this.tabNode);this.own(d(this.tab,"tabChanged",m.hitch(this,function(a){e.setStyle(this.signinSection,"display","none");a!==this.nls.publicMap?(this.isPublicTabShow=!1,this._updateUIbySignIn(),this.portal.getUser().then(m.hitch(this,function(b){a===this.nls.myContent?this._searchMyContent(b):a===this.nls.myOrganization?this._searchOrganization(b):
a===this.nls.myGroup&&this._searchGroups(b)}))):(this.isPublicTabShow=!0,this._searchPublic())})))},_bindMapTableEvents:function(){this.own(d(this.mycontentMapTable,"select",m.hitch(this,this._onMapSelected)));this.own(d(this.organizationMapTable,"select",m.hitch(this,this._onMapSelected)));this.own(d(this.groupMapTable,"select",m.hitch(this,this._onMapSelected)));this.own(d(this.publicPortalMapTable,"select",m.hitch(this,this._onMapSelected)));this.own(d(this.publicOnlineMapTable,"select",m.hitch(this,
this._onMapSelected)))},_onMapSelected:function(a){if(a=a&&a.selectedNode)this.mycontentMapTable.unselect(),this.organizationMapTable.unselect(),this.groupMapTable.unselect(),this.publicPortalMapTable.unselect(),this.publicOnlineMapTable.unselect(),e.addClass(a,"selected")},_updateUIbySignIn:function(){e.setStyle(this.signinSection,"display","none");var a=c(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",this.domNode);this.portal.haveSignIn()?a.style("display",
"block"):(a.style("display","none"),this.isPublicTabShow||e.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){r.combineRadioCheckBoxWithLabel(this.portalPublicRaido,this.portalNameLabel);r.combineRadioCheckBoxWithLabel(this.onlinePublicRaido,this.onlineNameLabel);var a=this._getPortalUrl(),a=s.getServerByUrl(a);s.isArcGIScom(a)?(this.portalPublicRaido.disabled=!0,this.onlinePublicRaido.checked=!0,e.setStyle(this.portalPublicRaido,"display","none"),e.setStyle(this.portalNameLabel,
"display","none")):(this.portalPublicRaido.disabled=!1,this.portalPublicRaido.checked=!0,this.portalNameLabel.innerHTML=a)},_initSearchQuery:function(){var a="esri_"+(q.locale&&q.locale.slice(0,2)||"en").toLowerCase(),b=g.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),m.hitch(this,function(b){return b!==a})),c=
"";g.forEach(b,m.hitch(this,function(a){c+=" -owner:"+a+" "}));b=" ";this.portal.user&&this.portal.user.orgId&&(b=" orgid:"+this.portal.user.orgId+" ");b=b+this._webMapQueryString+" AND access:public "+c;this._allPublicPortalQuery=this._getQuery({q:b});this._filterPublicPortalQuery=this._getQuery({q:b});this._allPublicOnlineQuery=this._getQuery({q:'(group:"c755678be14e4a0984af36a15f5b643e" OR  group:"b8787a74b4d74f7fb9b8fac918735153") '+this._webMapQueryString+" AND access:public"});this._filterPublicOnlineQuery=
this._getQuery({q:this._webMapQueryString+" AND access:public"});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return m.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return s.getStandardPortalUrl(window.portalUrl)},_initMapTables:function(){var a=this._getPortalUrl();
this.portalPublicRaido.disabled||(this.publicPortalMapTable.set("portalUrl",a),this.publicPortalMapTable.set("filteredQuery",this._filterPublicPortalQuery));this.publicOnlineMapTable.set("portalUrl",window.location.protocol+"//www.arcgis.com");this.publicOnlineMapTable.set("filteredQuery",this._filterPublicOnlineQuery)},_initPublic:function(){this.own(d(this.portalPublicRaido,"click",m.hitch(this,function(){this._onPublicRaidoClicked();this._searchPublicByRadio()})));this.own(d(this.onlinePublicRaido,
"click",m.hitch(this,function(){this._onPublicRaidoClicked();this._searchPublicByRadio()})));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.checked?(this.publicPortalMapTable.show(),this.publicOnlineMapTable.hide()):this.onlinePublicRaido.checked&&(this.publicPortalMapTable.hide(),this.publicOnlineMapTable.show())},_onPublicSearch:function(){var a=this._getSortFieldAndSortOrder(this.publicSelect),b=this.publicSearch.getValue();(b=b&&m.trim(b))?(this.publicPortalMapTable.showFilterMapsSection(),
this.publicOnlineMapTable.showFilterMapsSection(),this._filterPublicPortalQuery.q=b+this._allPublicPortalQuery.q,this._filterPublicPortalQuery.start=1,m.mixin(this._filterPublicPortalQuery,a),this.publicPortalMapTable.searchFilteredMaps(this._filterPublicPortalQuery),this._filterPublicOnlineQuery.q=b+this._webMapQueryString+" AND access:public",this._filterPublicOnlineQuery.start=1,m.mixin(this._filterPublicOnlineQuery,a),this.publicOnlineMapTable.searchFilteredMaps(this._filterPublicOnlineQuery)):
(this.publicPortalMapTable.showAllMapsSection(),this.publicOnlineMapTable.showAllMapsSection(),this._allPublicPortalQuery.start=1,m.mixin(this._allPublicPortalQuery,a),this.publicPortalMapTable.showAllMapsSection(this._allPublicPortalQuery),this._allPublicOnlineQuery.start=1,m.mixin(this._allPublicOnlineQuery,a),this.publicOnlineMapTable.showAllMapsSection(this._allPublicOnlineQuery))},_searchPublic:function(){this.tab.getSelectedTitle()===this.nls.publicMap&&(this.publicTabNode.isSearched||this._searchPublicByRadio())},
_searchPublicByRadio:function(){this.portalPublicRaido.checked?this.publicPortalMapTable.isSearched||(this._onPublicSearch(),this.publicPortalMapTable.isSearched=!0):this.publicOnlineMapTable.isSearched||(this._onPublicSearch(),this.publicOnlineMapTable.isSearched=!0)},_initPrivate:function(){this._resetPortalMaps();this.own(f.subscribe("userSignIn",m.hitch(this,this._onSignIn)));this.own(f.subscribe("userSignOut",m.hitch(this,this._onSignOut)));this.own(d(this.groupsSelect,"change",m.hitch(this,
this._onGroupsSelectChange)));var a=s.getServerByUrl(this._getPortalUrl());s.isArcGIScom(a);this.portal.haveSignIn()&&this._onSignIn()},_getSortFieldAndSortOrder:function(a){var b={};a=a.get("value");b.sortField=a;"modified"===a?b.sortOrder="desc":"numviews"===a?b.sortOrder="desc":"avgrating"===a?b.sortOrder="desc":"title"===a?b.sortOrder="asc":"owner"===a&&(b.sortOrder="asc");return b},_onOrganizationSearch:function(){var a=this._getSortFieldAndSortOrder(this.organizationSelect),b=this.organizationSearch.getValue();
(b=b&&m.trim(b))?(this._filterOrganizationQuery.q=b+" "+this._allOrganizationQuery.q,this._filterOrganizationQuery.start=1,m.mixin(this._filterOrganizationQuery,a),this.organizationMapTable.searchFilteredMaps(this._filterOrganizationQuery)):(this._allOrganizationQuery.start=1,m.mixin(this._allOrganizationQuery,a),this.organizationMapTable.showAllMapsSection(this._allOrganizationQuery))},_onMyContentSearch:function(){var a=this._getSortFieldAndSortOrder(this.mycontentSelect),b=this.mycontentSearch.getValue();
(b=b&&m.trim(b))?(this._filterMyContentQuery.q=b+" "+this._allMyContentQuery.q,this._filterMyContentQuery.start=1,m.mixin(this._filterMyContentQuery,a),this.mycontentMapTable.searchFilteredMaps(this._filterMyContentQuery)):(this._allMyContentQuery.start=1,m.mixin(this._allMyContentQuery,a),this.mycontentMapTable.showAllMapsSection(this._allMyContentQuery))},_onGroupSearch:function(){var a=this._getSortFieldAndSortOrder(this.groupSelect),b=this.groupSearch.getValue();(b=b&&m.trim(b))?(this._filterGroupQuery.q=
b+" "+this._allGroupQuery.q,this._filterGroupQuery.start=1,m.mixin(this._filterGroupQuery,a),this.groupMapTable.searchFilteredMaps(this._filterGroupQuery)):(this._allGroupQuery.start=1,m.mixin(this._allGroupQuery,a),this.groupMapTable.showAllMapsSection(this._allGroupQuery))},_onSignIn:function(){this._updateUIbySignIn();this._signIn||(this._signIn=!0,this.portal.getUser().then(m.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),this._searchMyContent(a),this._searchGroups(a))})))},
_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationMapTable.clear();this.mycontentMapTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){if(this.tab.getSelectedTitle()===this.nls.myOrganization&&!this.organizationTabNode.isSearched){this.organizationMapTable.clear();a=" orgid:"+a.orgId+" AND "+this._webMapQueryString+" AND (access:org OR access:public) ";var b=this._getPortalUrl();this._allOrganizationQuery=
this._getQuery({q:a});this._filterOrganizationQuery=this._getQuery({q:a});this.organizationMapTable.set("portalUrl",b);this._onOrganizationSearch();this.organizationTabNode.isSearched=!0}},_searchMyContent:function(a){if(this.tab.getSelectedTitle()===this.nls.myContent&&!this.mycontentTabNode.isSearched){this.mycontentMapTable.clear();var b=this._getPortalUrl();a="owner:"+a.username+" AND "+this._webMapQueryString;this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});
this.mycontentMapTable.set("portalUrl",b);this._onMyContentSearch();this.mycontentTabNode.isSearched=!0}},_searchGroups:function(a){if(this.tab.getSelectedTitle()===this.nls.myGroup&&!this.groupTabNode.isSearched){this._resetGroupsSection();e.setStyle(this.groupsSection,"display","block");a=a.getGroups();if(0<a.length){e.setStyle(this.groupSearchSection,"display","block");this.groupMapTable.show();e.empty(this.groupsSelect);for(var b=0;b<a.length;b++){var c=a[b];e.create("option",{value:c.id,innerHTML:c.title},
this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length);this.groupTabNode.isSearched=!0}},_resetGroupsSection:function(){e.setStyle(this.groupsSection,"display","none");e.empty(this.groupsSelect);e.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupMapTable.clear();e.setStyle(this.groupSearchSection,"display","none");this.groupMapTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?e.setStyle(this.groupsSection,
"top","15px"):e.setStyle(this.groupsSection,"top","70px")},_onGroupsSelectChange:function(){var a=this.groupsSelect.value;this.groupMapTable.clear();if("nodata"===a)e.setStyle(this.groupSearch,"display","none"),this.groupMapTable.hide();else{e.setStyle(this.groupSearch,"display","block");this.groupMapTable.show();var b=this._getPortalUrl(),a="group:"+a+" AND "+this._webMapQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});this.groupMapTable.set("portalUrl",
b);this._onGroupSearch()}},getSelectedMapItem:function(){var a=null,b=c(".map-item-bg.selected",this.domNode);0<b.length&&(a=b[0].parentNode.item);return a}})})},"builder/plugins/map-config/MapTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator dojo/i18n!./nls/strings".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b){return p([f,a,l,h],{templateString:k,baseClass:"map-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,originalSelectedId:null,type:"",postMixInProperties:function(){this.nls=b},postCreate:function(){this.inherited(arguments);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=s.getStandardPortalUrl(this.portalUrl));this.own(d(this.allMapsTableDiv,"scroll",q.hitch(this,this._onAllMapsSectionScroll)));this.own(d(this.filteredMapsTableDiv,
"scroll",q.hitch(this,this._onFilteredMapsSectionScroll)));this._showAllMapsSection();this.searchAllMaps()},show:function(){g.setStyle(this.domNode,"display","block")},hide:function(){g.setStyle(this.domNode,"display","none")},searchAllMaps:function(a){this._showAllMapsSection();a&&(this.query=q.clone(a),this.query.start=1,this.clearAllMapsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allMapsShelter.show(),u.getPortal(this.portalUrl).queryItems(this.query).then(q.hitch(this,function(a){this.domNode&&
(this.allMapsShelter.hide(),this.query.start=a.nextStart,this._createMapItems(a,this.allMapsTbody))}),q.hitch(this,function(a){console.error(a);this.domNode&&this.allMapsShelter.hide()})))},searchFilteredMaps:function(a){this._showFilterMapsSection();a&&(this.filteredQuery=q.clone(a),this.filteredQuery.start=1,this.clearFilteredMapsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredMapsShelter.show(),u.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(q.hitch(this,
function(b){this.domNode&&(this._showFilterMapsSection(),a&&this.clearFilteredMapsSection(),this.filteredQuery.start=b.nextStart,this._createMapItems(b,this.filteredMapsTbody),this._filterMapCallback())}),q.hitch(this,function(a){console.error(a);this.domNode&&this._filterMapCallback()})))},_filterMapCallback:function(){this.filteredMapsShelter.hide();0<this._getWebMapCount(this.filteredMapsTbody)?(g.setStyle(this.filteredMapsTableDiv,"display","block"),g.setStyle(this.searchNoneTipSection,"display",
"none")):(g.setStyle(this.filteredMapsTableDiv,"display","none"),g.setStyle(this.searchNoneTipSection,"display","block"))},clear:function(){this.clearAllMapsSection();this.clearFilteredMapsSection()},clearAllMapsSection:function(){g.empty(this.allMapsTbody)},clearFilteredMapsSection:function(){g.empty(this.filteredMapsTbody)},showAllMapsSection:function(a){this._showAllMapsSection();a&&this.searchAllMaps(a)},_showAllMapsSection:function(){g.setStyle(this.allMapsSection,"display","block");g.setStyle(this.filteredMapsSection,
"display","none")},showFilterMapsSection:function(a){this._showFilterMapsSection();a&&this.searchFilteredMaps(a)},_showFilterMapsSection:function(){g.setStyle(this.allMapsSection,"display","none");g.setStyle(this.filteredMapsSection,"display","block");g.setStyle(this.filteredMapsTableDiv,"display","block");g.setStyle(this.searchNoneTipSection,"display","none")},_onAllMapsSectionScroll:function(){this._isScrollToBottom(this.allMapsTableDiv)&&this.searchAllMaps()},_onFilteredMapsSectionScroll:function(){this._isScrollToBottom(this.filteredMapsTableDiv)&&
this.searchFilteredMaps()},_isScrollToBottom:function(a){return r.isScrollToBottom(a)},_createMapItems:function(a,b){var d=m.filter(a.results,q.hitch(this,function(a){return a.type.toLowerCase()===this.type.toLowerCase()}));if(0!==d.length){var e={},f,h=c("td.empty",b),k;if(0<h.length){var l=Math.min(d.length,h.length),p=d.splice(0,l);for(k=0;k<l;k++){var r=h[k];f=this._createMapItem(p[k]);e[f.item.id]=f;g.place(f,r);g.removeClass(r,"empty")}}if(0!==d.length){h=Math.ceil(d.length/5);for(k=0;k<h;k++){f=
g.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");g.place(f,b);l=c("td",f);for(p=0;p<l.length;p++)r=l[p],(f=d[5*k+p])?(f=this._createMapItem(f),e[f.item.id]=f,g.place(f,r)):g.addClass(r,"empty")}if(!this.getSelectedMapItem()&&(this.appConfig&&this.appConfig.map.itemId)&&(f=e[this.appConfig.itemId]))d=c(".map-item-bg",f),g.addClass(d,"selected")}}},_getWebMapCount:function(a){return c(".map-item-div",a).length},
_createMapItem:function(a){var b=g.toDom("\x3cdiv class\x3d'map-item-div'\x3e\x3cdiv class\x3d'map-item-bg'\x3e\x3cdiv class\x3d'map-item-thumbnail jimu-auto-vertical'\x3e\x3cdiv class\x3d'none-thumbnail-tip jimu-auto-vertical-content'\x3e\x3c/div\x3e\x3c/div\x3e\x3ca target\x3d'_blank' class\x3d'map-item-detail-icon'\x3e\x3c/a\x3e\x3c/div\x3e\x3cspan class\x3d'map-item-title'\x3e\x3c/span\x3e\x3c/div\x3e"),e=c(".map-item-bg",b)[0],f=c(".map-item-thumbnail",b)[0],h=c(".map-item-title",b)[0],k=c(".map-item-detail-icon",
b)[0];c(".none-thumbnail-tip",b);k.href=a.detailsPageUrl;k.title=this.nls.viewItemDetails||"";b.item=a;k=a.thumbnailUrl||r.getDefaultWebMapThumbnail();g.setStyle(f,"backgroundImage","url("+k+")");this.own(d(e,"click",q.hitch(this,this._onMapItemBgClick)));h.innerHTML=a.title;h.title=a.title;return b},unselect:function(){c(".map-item-bg",this.domNode).removeClass("selected")},_onMapItemBgClick:function(a){a=a.target||a.srcElement;var b=null;g.hasClass(a,"map-item-thumbnail")?b=a.parentNode:g.hasClass(a,
"none-thumbnail-tip")&&(b=a.parentNode.parentNode);b&&g.hasClass(b,"map-item-bg")&&(this.unselect(),g.addClass(b,"selected"),this.emit("select",{mapTable:this,selectedNode:b}))},getSelectedMapItem:function(){var a=null,b=c(".map-item-bg.selected",this.domNode);0<b.length&&(a=b[0].parentNode.item);return a}})})},"builder/plugins/map-config/CustomizeScale":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CustomizeScale.html dojo/query dojo/_base/lang dojo/_base/array dojo/_base/html jimu/utils jimu/dijit/Message dijit/form/NumberTextBox".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d){return p([f,a,l],{templateString:k,baseClass:"mapconfig-customize-scale",map:null,postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.scaleNumberBox=new d({placeholder:this.nls.scale,intermediateChanges:!0,trim:!0,constraints:{min:1,pattern:"###############0.################"},style:"width:550px;height:100%;"});g.addClass(this.scaleNumberBox.domNode,"jimu-float-leading");this.scaleNumberBox.placeAt(this.scaleInputDiv,"first");
var a=this.getLodsFromMap();this._resetLodListByLods(a)},getLodsFromMap:function(){var a=[];this.map._params&&this.map._params.lods&&(a=m.map(this.map._params.lods,q.hitch(this,function(a){return a.toJson()})));return a},_getLodsFromBasemapLayer:function(){var a=[],c=this.map.getLayer(this.map.layerIds[0]);c&&(c.tileInfo&&c.tileInfo.lods)&&(a=m.map(c.tileInfo.lods,q.hitch(this,function(a){return{level:a.level,resolution:a.resolution,scale:a.scale}})));return a},getLodsFromListNode:function(){for(var a=
this._getLodItems(),c=[],d=null,e=0;e<a.length;e++)d=a[e].lod,c.push({level:d.level,scale:d.scale,resolution:d.resolution});return c},_resetLodListByLods:function(a){g.empty(this.listNode);m.forEach(a,q.hitch(this,function(a){a=this._createLodItem(a);g.place(a,this.listNode)}))},_createLodItem:function(a){var c=g.create("div",{innerHTML:e.localizeNumber(a.scale),"class":"lod-item"});c.lod=a;return c},_getLodItems:function(){return h(".lod-item",this.listNode)},_getSelectedLodItem:function(){var a=
null,c=h(".selected",this.listNode);0<c.length&&(a=c[0]);return a},_selectLodItem:function(a){this._removeSelectedClass();g.addClass(a,"selected");g.addClass(this.btnDelete,"enabled-operation");a.previousSibling||g.setStyle(a,"borderTop","0")},_removeSelectedClass:function(){h(".lod-item",this.listNode).removeClass("selected");g.removeClass(this.btnDelete,"enabled-operation")},_onLodListClicked:function(a){a=a.target||a.srcElement;g.hasClass(a,"lod-item")&&this._selectLodItem(a)},_onBtnAddClicked:function(){if(this.scaleNumberBox.validate()){var a=
this.scaleNumberBox.get("value");this.scaleNumberBox.set("displayedValue","");var c=this._getLodItems();if(0!==c.length&&!m.some(c,q.hitch(this,function(b){return b.lod.scale===a}))){var d=c.length-1,e=c[0].lod,b=c[d].lod,f=null,f={level:null,resolution:e.resolution/e.scale*a,scale:a};if(f.scale>e.scale)f.level=e.level-1,f=this._createLodItem(f),g.place(f,this.listNode,"first");else if(f.scale<b.scale)f.level=b.level+1,f=this._createLodItem(f),g.place(f,this.listNode);else for(var h=null,e=null,b=
d;1<=b;b--)if(h=c[b],e=c[b-1],f.scale>h.lod.scale&&f.scale<e.lod.scale){f.level=h.lod.level;f=this._createLodItem(f);g.place(f,e,"after");for(f=b;f<=d;f++)c[f].lod.level+=1;break}}}},_onBtnDeleteClicked:function(){var a=this._getSelectedLodItem();if(a)if(1===this.getLodsFromListNode().length)new c({message:this.nls.atLeastOneScale});else{var d=a;if(!a.previousSibling)for(;a.nextSibling;)a=a.nextSibling,a.lod.level-=1;g.destroy(d);this._removeSelectedClass()}},_onBtnResetClicked:function(){this._removeSelectedClass();
var a=this._getLodsFromBasemapLayer();this._resetLodListByLods(a)}})})},"builder/plugins/popup-actions/configmode-switch/_build-generate_module":function(){define(["builder/plugins/popup-actions/configmode-switch/Plugin","dojo/i18n!builder/plugins/popup-actions/configmode-switch/nls/strings"],function(){})},"builder/plugins/popup-actions/configmode-switch/Plugin":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/topic","builder/BasePlugin"],function(p,f,a,l){return p([l],{baseClass:"plugin-app-actions-popup-saveas",
disabled:null,postCreate:function(){this.inherited(arguments);this._bindEvent();this.label=this.nls.advanceConfigLabel;this.isAdvance=!1},onClick:function(){var a=this.pluginManager.getPluginByName("app-config");this.isAdvance?(this.isAdvance=!1,this.label=this.nls.advanceConfigLabel,a.switchToTemplateConfigPart()):(this.isAdvance=!0,this.label=this.nls.templateConfigLabel,a.switchToPreviewConfig())},_bindEvent:function(){this.own(a.subscribe("app/appConfigLoaded",f.hitch(this,this._setAppConfig)))},
_setAppConfig:function(a){this.appConfig=a;a.templateConfig&&a.isTemplateApp||a.templateConfig&&a._appData?(this.visible=!0,this.isAdvance=!1):(this.visible=!1,this.isAdvance=!0)}})})},"builder/plugins/popup-actions/popup-agoltemplate/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-agoltemplate/Plugin","dojo/text!builder/plugins/popup-actions/popup-agoltemplate/css/style.css","dojo/i18n!builder/plugins/popup-actions/popup-agoltemplate/nls/strings"],function(){})},"builder/plugins/popup-actions/popup-agoltemplate/Plugin":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/promise/all dojo/Deferred dojo/on dojo/topic dojo/_base/html dojo/json builder/BasePlugin builder/serviceUtils builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingShelter jimu/dijit/Popup builder/dijit/template-config/Template builder/dijit/template-config/utils builder/dijit/TemplateAttributes".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v){return p([e],{baseClass:"plugin-app-actions-popup-template",disabled:null,postMixInProperties:function(){this.inherited(arguments);this.nls=a.mixin(this.nls,builderNls)},constructor:function(){d.getPortal(window.portalUrl).getUser().then(a.hitch(this,function(a){this.user=a;if("HTML"===window.appInfo.id||this.user.username!==window.appInfo.appOwner)this.disabled=!0}))},postCreate:function(){this.inherited(arguments);this.label=this.nls.exportTitle;var a=
this.pluginManager.getPluginByName("startup");this.shelter=(new u({hidden:!0})).placeAt(a.domNode);this._bindEvent()},onClick:function(){if(!this.disabled){var e=new k,f=window.appInfo.id;this.shelter.show();window.isXT?c.getAppInfo(f).then(a.hitch(this,function(a){e.resolve(a)}),function(){e.reject()}):d.getPortal(r.getPortalUrlFromLocation()).getItemData(f).then(a.hitch(this,function(a){a=a.agolTemplateInfo;!a&&this.appConfig.agolTemplateJson&&(a={itemId:null,json:this.appConfig.agolTemplateJson});
a={id:f,name:this.pluginManager.getPluginByName("header").getAppName(),agolTemplateInfo:a};e.resolve(a)}),function(){e.reject()});var g=b.loadAllWidgetConfigs(a.clone(this.appConfig)),h=this.pluginManager.getPluginByName("app-actions.save-app").saveApp();l({app:e,appConfig:g,saveApp:h}).then(a.hitch(this,function(a){var b=a.app;this._createAGOLTemplate(b,a.appConfig);this._createAGOLTemplatePrview();this.popupDlg(b);this.shelter.hide()}),a.hitch(this,function(a){console.error(a.message);this.shelter.hide()}))}},
popupDlg:function(b){var c=m.create("div",{"class":"template-popup-content"}),d=m.getMarginBox(window.document.body).w,d=0.9*d;1024>d&&(d=1024);this.popup=new s({content:c,"class":"plugin-app-actions-template-popup",container:"main-page",titleLabel:this.nls.title,width:d,height:668,buttons:[{label:this.nls.exportStr,onClick:a.hitch(this,this._onExportClick)},{label:this.nls.saved,onClick:a.hitch(this,this._onSaveClick)},{label:this.nls.close,classNames:["jimu-btn-vacation"],onClick:a.hitch(this,this._onCancelClick)}]});
this._initPopup(b);this.agoltemplateDijit.loading.placeAt(this.popup.domNode);this.popup.configPart=m.create("div",{"class":"config-part jimu-float-leading"},c);b=m.create("div",{"class":"privew-part-box jimu-float-leading"},c);b=m.create("div",{"class":"privew-part-inset-box"},b);this.popup.previewPart=m.create("div",{"class":"privew-part"},b);m.place(this.agoltemplateDijit.domNode,this.popup.configPart);m.place(this.agoltemplatePrivew.domNode,this.popup.previewPart)},_onExportClick:function(a){window.isXT?
m.hasClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden")?m.removeClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden"):m.addClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden"):this.agoltemplateDijit.exportOrUpdateAGOLTemplate();a.stopPropagation()},_onExportAGOLTemplateClick:function(a){this._hasCreateItemPrivilege()?this.agoltemplateDijit.exportOrUpdateAGOLTemplate():a.stopPropagation()},_onExportWABTemplateClick:function(){this.agoltemplateDijit.exportWABTemplate()},
_onSaveClick:function(){m.setAttr(this.popup.enabledButtons[1],"innerHTML",this.nls.saving);this.agoltemplateDijit.saveAgolTemplate().then(a.hitch(this,function(){this._disablePopupButton(1,this.nls.saved)}))},_onCancelClick:function(){if(this.agoltemplateDijit.hasChanged())var b=new s({content:"\x3cdiv\x3e\x3cimg class\x3d'alert-image jimu-float-leading'src\x3d'"+this.folderUrl+"/css/images/alert.png' style\x3d'margin-left:20px;margin-right:20px;'\x3e\x3c/img\x3e\x3cspan style\x3d'display:inline-block;width:285px'\x3e"+
this.nls.unSaveMeg+"\x3c/span\x3e\x3c/div\x3e",titleLabel:this.nls.cancelPopupTitle,width:"425",autoHeight:!0,buttons:[{label:this.nls.save,onClick:a.hitch(this,function(){this.agoltemplateDijit.saveAgolTemplate().then(a.hitch(this,function(){b.close();this._closePopup();this.agoltemplateDijit.destroyRecursive()}))})},{label:this.nls.doNotSave,onClick:a.hitch(this,function(){b.close();this._closePopup();this.agoltemplateDijit.destroyRecursive()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],
onClick:a.hitch(this,function(){b.close()})}]});else this._closePopup(),this.agoltemplateDijit.destroyRecursive()},_closePopup:function(){this.popup&&(this.popup.closeTemplate=!0,this.popup.close())},_initPopup:function(b){this.popup.disableButton(1);this.popup.onClose=a.hitch(this,function(){if(this.popup.closeTemplate)return!0;this._onCancelClick();return!1});if(window.isXT){this.popup.exportDrawBoxDomNode=m.create("div",{"class":"export-draw-box export-draw-box-hiden"});var c;c=this._hasCreateItemPrivilege()?
"export-draw-box-btn":"export-draw-box-btn export-draw-box-btn-disable";this.popup.exportAGOLTemplateDomNode=m.create("div",{"class":c,innerHTML:this.nls.exportAGOLTemplate},this.popup.exportDrawBoxDomNode);this.popup.exportWABTemplateDomNode=m.create("div",{"class":"export-draw-box-btn",innerHTML:this.nls.exportWABTemplate},this.popup.exportDrawBoxDomNode);m.addClass(this.popup.domNode,"plugin-app-actions-template-popup-for-xt");m.addClass(this.popup.enabledButtons[0],"export-btn");m.place(this.popup.exportDrawBoxDomNode,
this.popup.enabledButtons[0]);this.popup.own(h(this.popup,"click",a.hitch(this,function(){m.addClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden")})));this.popup.own(h(this.popup.exportAGOLTemplateDomNode,"click",a.hitch(this,this._onExportAGOLTemplateClick)));this.popup.own(h(this.popup.exportWABTemplateDomNode,"click",a.hitch(this,this._onExportWABTemplateClick)))}else this._hasCreateItemPrivilege()||this.popup.disableButton(0);b.agolTemplateInfo&&b.agolTemplateInfo.itemId&&d.getPortal(window.portalUrl).getItemById(b.agolTemplateInfo.itemId).then(a.hitch(this,
function(){window.isXT?m.setAttr(this.popup.exportAGOLTemplateDomNode,"innerHTML",this.nls.updateAGOLTemplate):m.setAttr(this.popup.enabledButtons[0],"innerHTML",this.nls.update)}),a.hitch(this,function(){b.agolTemplateInfo.itemId=null;window.isXT?m.setAttr(this.popup.exportAGOLTemplateDomNode,"innerHTML",this.nls.exportAGOLTemplate):m.setAttr(this.popup.enabledButtons[0],"innerHTML",this.nls.exportStr)}))},_disablePopupButton:function(a,b){this.popup.disableButton(a);m.setAttr(this.popup.disabledButtons[a],
"innerHTML",b)},_enablePopupButton:function(a,b){this.popup.enableButton(a);m.setAttr(this.popup.enabledButtons[a],"innerHTML",b)},_createAGOLTemplate:function(b,c){var d;d=b.agolTemplateInfo&&b.agolTemplateInfo.json?g.parse(b.agolTemplateInfo.json):c.templateConfig?c.templateConfig:null;this.agoltemplateDijit=new t({appConfig:c,appInfo:b,templateConfig:d});this.own(this.agoltemplateDijit.on("hasChanged",a.hitch(this,function(a){a?this._enablePopupButton(1,this.nls.save):this._disablePopupButton(1,
this.nls.saved);this._refreshAGOLTempaltePrview()})));this.own(this.agoltemplateDijit.on("exported",a.hitch(this,function(a){a&&(window.isXT&&this.popup.exportAGOLTemplateDomNode?m.setAttr(this.popup.exportAGOLTemplateDomNode,"innerHTML",this.nls.updateAGOLTemplate):this._enablePopupButton(0,this.nls.update))})));this.agoltemplateDijit.startup()},_createAGOLTemplatePrview:function(){var a;this.agoltemplateDijit&&(a=this.agoltemplateDijit.getTemplateConfig());this.agoltemplatePrivew=new v({templateConfig:a});
this.agoltemplatePrivew.startup()},_refreshAGOLTempaltePrview:function(){this.agoltemplatePrivew&&this.agoltemplatePrivew.destroy();this._createAGOLTemplatePrview();m.place(this.agoltemplatePrivew.domNode,this.popup.previewPart)},_bindEvent:function(){this.own(q.subscribe("app/appConfigLoaded",a.hitch(this,this._setAppConfig)));this.own(q.subscribe("app/appConfigChanged",a.hitch(this,this._setAppConfig)))},_setAppConfig:function(a){this.appConfig=a;this.visible=a.templateConfig&&a.isTemplateApp||
!a.templateConfig?!0:!1},_hasCreateItemPrivilege:function(){var a=!1;this.user?f.forEach(this.user.privileges,function(b){0<=b.indexOf("createItem")&&(a=!0)},this):a=!0;return a}})})},"builder/plugins/popup-actions/popup-saveas/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-saveas/Plugin","dojo/i18n!builder/plugins/popup-actions/popup-saveas/nls/strings"],function(){})},"builder/plugins/popup-actions/popup-saveas/Plugin":function(){define(["dojo/_base/declare","dojo/_base/lang",
"builder/BasePlugin"],function(p,f,a){return p([a],{baseClass:"plugin-app-actions-popup-saveas",disabled:null,constructor:function(){if("HTML"===window.appInfo.id||"HTML3D"===window.appInfo.id)this.disabled=!0},postCreate:function(){this.inherited(arguments);this.label=this.nls.label},onClick:function(){if(!this.disabled){var a=this.pluginManager.getExtensions("startup.creation-entry")[0];this.pluginManager.loadPlugin(this.pluginsMeta[a.pluginName]).then(f.hitch(this,function(a){a.popupSaveAsDlg(this.nls.saveAsTitle,
window.appInfo.id,window.appConfig)}))}}})})},"builder/plugins/popup-actions/popup-share/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-share/Plugin"],function(){})},"builder/plugins/popup-actions/popup-share/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/keys jimu/dijit/Popup builder/BasePlugin jimu/portalUrlUtils jimu/dijit/ShareOptions jimu/dijit/ShareLink dojo/topic dojo/query jimu/utils".split(" "),function(p,f,a,l,
k,h,q,m,g,e,c,d){return p([q],{baseClass:"plugin-app-actions-popup-share",disabled:null,_isShowFindLocation:!0,postCreate:function(){this.inherited(arguments);this.label=window.jimuNls.common.share;this.own(c.subscribe("app/appConfigChanged",f.hitch(this,this._onAppConfigLoadedOrChanged)));this.own(c.subscribe("app/appConfigLoaded",f.hitch(this,this._onAppConfigLoadedOrChanged)));this.own(c.subscribe("ShareOptions/onClickEveryone",f.hitch(this,function(a){if(this.shareLink&&this.shareLink.onShareToPublicChanged)this.shareLink.onShareToPublicChanged(a)})));
this.own(c.subscribe("ShareLink/onHideContainer",f.hitch(this,function(){this.hide()})));this.own(c.subscribe("ShareLink/onShowContainer",f.hitch(this,function(){this.show()})));this.own(c.subscribe("ShareLink/onHideLinkOptions",f.hitch(this,function(){this._changeBtnsByShareLink("hide")})));this.own(c.subscribe("ShareLink/onShowLinkOptions",f.hitch(this,function(){this._changeBtnsByShareLink("show")})))},onClick:function(){this.disabled||this.popupDlg()},_onAppConfigLoadedOrChanged:function(a){this._isShowFindLocation=
this._findSearchWidget(a);this.shareLink&&this.shareLink.updateShareLinkOptionsUI({isShowFindLocation:this._isShowFindLocation})},_findSearchWidget:function(a){a=a.getConfigElementsByName("Search");return 0<a.length&&a[0].visible},popupDlg:function(){var a=this._initContent(),c=this._initPupupBtns(),d=this._initPopupHeight();this.sharePopup=new h({content:a,"class":"share-container",container:"main-page",titleLabel:window.jimuNls.common.share,width:640,height:d,buttons:c});this.shareLink.startup();
this.shareOptions&&this.shareOptions.startup()},_onOkClick:function(){this.shareOptions&&this.shareOptions.share();this.sharePopup.close()},_onCancelClick:function(){this.sharePopup.close()},_initContent:function(){var c=a.create("div",{"class":"template-popup-content"});a.create("div",{"class":"app-name"},c);window.isXT||(this.shareOptions=new g(window.appConfig.portalUrl),this.shareOptions.placeAt(c));this.shareLink=new e({portalUrl:window.appConfig.portalUrl,appTitle:window.appInfo.name,isOnline:m.isOnline(window.top.location.href),
isShowSocialMediaLinks:!0,isSharedToPublic:!1,isShowBackBtn:!1,isShowFindLocation:this._isShowFindLocation});this.shareLink.placeAt(c);return c},_initPupupBtns:function(){var a=[];this.shareOptions&&a.push({label:window.jimuNls.common.ok,key:k.ENTER,isHighLight:!0,onClick:f.hitch(this,this._onOkClick)});a.push({label:window.jimuNls.common.cancel,classNames:["jimu-btn-vacation"],key:k.ESCAPE,onClick:f.hitch(this,this._onCancelClick)});return a},_initPopupHeight:function(){var a=560;this.shareOptions&&
(a=600);return a},_changeBtnsByShareLink:function(a){var c=this.shareOptions?1:0;"hide"===a?(this.sharePopup.setTitleLabel(window.jimuNls.common.share),this.sharePopup.setButtonProps(c,{title:window.jimuNls.common.cancel}),this.sharePopup.setButtonProps(c,{label:window.jimuNls.common.cancel})):"show"===a&&(this.sharePopup.setTitleLabel(window.jimuNls.shareLink.linkOptions),this.sharePopup.setButtonProps(c,{label:window.jimuNls.common.back}),this.sharePopup.setButtonProps(c,{title:window.jimuNls.common.back}),
this._disableShareBtn(),this.own(l.once(this.sharePopup,"Close",f.hitch(this,function(){this.sharePopup.setTitleLabel(window.jimuNls.common.share);this.sharePopup.setButtonProps(c,{title:window.jimuNls.common.cancel});this.sharePopup.setButtonProps(c,{label:window.jimuNls.common.cancel});this._enableShareBtn();this.shareLink._toggleLinkOptions();return!1}))))},_disableShareBtn:function(){this.shareOptions&&this.sharePopup.hideButton(0)},_enableShareBtn:function(){this.shareOptions&&this.sharePopup.showButton(0)},
hide:function(){d("#main-page \x3e .jimu-overlay").style("display","none");d("#main-page \x3e .jimu-popup").style("display","none")},show:function(){d("#main-page \x3e .jimu-overlay").style("display","block");d("#main-page \x3e .jimu-popup").style("display","block")}})})},"jimu/dijit/ShareOptions":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang esri/lang dojo/_base/array dojo/dom-style dojo/on dojo/dom dojo/query dojo/topic dojo/text!./templates/ShareOptions.html jimu/shareUtils dijit/form/Textarea dijit/form/CheckBox dijit/layout/BorderContainer".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u){return p([f,a,l],{templateString:r,declaredClass:"jimu.dijit.ShareOptions",postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.shareOptions},constructor:function(a){this.portalUrl=a},startup:function(){u.getShareInfo(this.portalUrl).then(k.hitch(this,function(a){this._initShow(a);this.own(g(e.byId("share-everyone-check"),"change",k.hitch(this,this.clickEveryone)))}))},_initShow:function(a){this.shareInfo=a;this.shareInfo.items=[this.shareInfo.item];
this.shareInfo.sortField="title";(this.shareInfo.userRole.isAdmin()||this.shareInfo._roleCanUpdateItems&&this.shareInfo._roleCanShare||this.shareInfo._roleCanShareOthersItems)&&this.shareInfo.itemUser?this.showAdmin(this.shareInfo.user.groups,this.shareInfo.itemUser,this.shareInfo.adminGroups):this.shareInfo.user&&u._isUserOwnTheApp(this.shareInfo.user)?this.show(this.shareInfo.user.groups):this.shareInfo.user&&("public"===this.shareInfo.item.access||"shared"===this.shareInfo.item.access||"org"===
this.shareInfo.item.access&&this.shareInfo.currentUser.orgId)?this.showGroups(this.shareInfo.user.groups):this.show(this.shareInfo.user.groups)},clear:function(){e.byId("share-groups-list").innerHTML="";e.byId("share-everyone-check").setAttribute("value",!1);e.byId("share-account-check").setAttribute("value",!1);e.byId("share-groups-check").setAttribute("value",!1);m.set(e.byId("share-everyone-check_div"),"display","none");m.set(e.byId("share-account-check_div"),"display","none");this.shareInfo.shareType=
"item"},showAdmin:function(a,c,b){this.shareInfo.itemUser=c;this.shareInfo.userGroups=q.filter(a||[],k.hitch(this,function(){return!this.shareInfo.item.capabilities||!this.shareInfo.item.capabilities.length}));this.shareInfo.userGroups.sort(k.hitch(this,this._sortFunc));this.shareInfo.adminGroups=this.filterAdminGroups(b);this.checkForAccount("admin")},filterAdminGroups:function(a){if(a){for(var c=[],b=0;b<this.shareInfo.user.groups.length;b++)c.push(this.shareInfo.user.groups[b].id);for(var d=[],
b=0;b<a.length;b++)-1===q.indexOf(c,a[b].id)&&(!a[b].capabilities||!a[b].capabilities.length)&&d.push(a[b]);return d}return null},showGroups:function(a){this.shareInfo.userGroups=this.filterOwnedGroups(a);this.shareInfo.userGroups&&this.shareInfo.userGroups.sort(k.hitch(this,this._sortFunc));this.clear();this.shareInfo.shareType="group";this.checkForAccount("group")},filterOwnedGroups:function(a){if(a){for(var c=[],b,d=0;d<a.length;d++)b=a[d],b.userMembership&&("owner"===b.userMembership.memberType||
"admin"===b.userMembership.memberType)&&(!b.capabilities||!b.capabilities.length)&&c.push(b);return c}return null},show:function(a){this.shareInfo.userGroups=this.filterViewOnlyGroups(a);this.shareInfo.userGroups.sort(k.hitch(this,this._sortFunc));this.checkForAccount("item")},filterViewOnlyGroups:function(a){if(a){for(var c=[],b,d=0;d<a.length;d++)b=a[d],(!b.capabilities||!b.capabilities.length)&&(b.userMembership&&("owner"===b.userMembership.memberType||"admin"===b.userMembership.memberType)||!h.isDefined(b.isViewOnly)||
!b.isViewOnly)&&c.push(b);return c}return null},checkForAccount:function(a){e.byId("share-account-check-label").innerHTML=this.shareInfo.organization.name;this.shareInfo._isCustomRole&&(!this.shareInfo._roleCanShareToOrg&&!this.shareInfo._roleCanShareOthersItemsToOrg)&&m.set(e.byId("share-account-check_div"),"display","none");this.clear();this.shareInfo.shareType=a;var c=this.shareInfo.items[0];this.shareInfo.lowestAccess=this.findLowestAccessLevel(this.shareInfo.items);u.getItemById(c,this.portalUrl).then(k.hitch(this,
function(a){c.sharing=a.sharing;"admin"===this.shareInfo.shareType?u.getItemByUserAndItemId(c,this.shareInfo.itemUser,this.shareInfo.user,this.portalUrl).then(k.hitch(this,function(a){c.sharing=a.sharing;this.buildAdminList()})):"group"===this.shareInfo.shareType?u.getItemsGroups(c,this.portalUrl).then(k.hitch(this,function(a){var b=[];if(a.admin)for(var d=0;d<a.admin.length;d++)b.push(a.admin[d].id);c.sharing={groups:b};this.buildGroupList()})):"item"===this.shareInfo.shareType&&u.getItemByUserAndItemId(c,
this.shareInfo.itemUser,this.shareInfo.user,this.portalUrl).then(k.hitch(this,function(a){c.sharing=a.sharing;this.buildList()}))}))},buildAdminList:function(){var a,c,b;if(this.shareInfo.user.groups&&0<this.shareInfo.user.groups.length||this.shareInfo.adminGroups&&0<this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess)!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToGroup||this.shareInfo._roleCanShareOthersItemsToGroup?m.set(e.byId("share-groups-div"),"display","block"):m.set(e.byId("share-groups-div"),
"display","none");this.shareInfo.itemsAreSharedToGroups=",";var d=[],f=null,h=null;c=[];for(a=0;a<this.shareInfo.items.length;a++)if(f=this.shareInfo.items[a],f.sharing)for(b=0;b<f.sharing.groups.length;b++)if(h=f.sharing.groups[b],-1===this.shareInfo.itemsAreSharedToGroups.indexOf(","+h+","))this.shareInfo.itemsAreSharedToGroups+=h+",",c=[],c[0]=h,c[1]=1,d[d.length]=c;else for(c=0;c<d.length;c++)if(d[c][0]===h){d[c][1]+=1;break}f="";b=!1;var l,p;for(a=0;a<this.shareInfo.user.groups.length;a++){h=
this.shareInfo.user.groups[a];l="";p=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+h.id+",")){l="checked";b=!0;for(c=0;c<d.length;c++)if(d[c][0]===h.id){p=d[c][1];break}}f=p<this.shareInfo.items.length?f+('\x3cdiv id\x3d"img_group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+a+'" src\x3d"'+this._checkboxImgUrl+
'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+h.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+l+' value\x3d"'+h.id+'" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"' class\x3d'labels'\x3e"+h.title+"\x3c/label\x3e"):f+('\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+l+' value\x3d"'+h.id+'" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+a+"' class\x3d'labels'\x3e"+h.title+"\x3c/label\x3e");
f=this._addOpenDataStr(h,f);f+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}if(this.shareInfo.adminGroups&&this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess){f+='\x3cdiv style\x3d"display:block;"\x3e\x3chr/\x3e\x3c/div\x3e';for(c=0;c<this.shareInfo.adminGroups.length;c++){h=this.shareInfo.adminGroups[c];l="";p=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+h.id+",")){l="checked";b=!0;for(var q=0;q<d.length;q++)if(d[q][0]===h.id){p=d[q][1];
break}}f=p<this.shareInfo.items.length?f+('\x3cdiv id\x3d"img_group_'+(c+a)+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+(c+a)+'" src\x3d"'+this._checkboxImgUrl+'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+h.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+(c+a)+"_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+
(c+a)+'" '+l+' value\x3d"'+h.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+a+"'\x3e"+h.title+"\x3c/label\x3e"):f+('\x3cdiv id\x3d"group_'+(c+a)+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+(c+a)+'" '+l+' value\x3d"'+h.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"'\x3e"+h.title+"\x3c/label\x3e");f=this._addOpenDataStr(h,f);f+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}}this.own(g(e.byId("share-groups-list"),"click",k.hitch(this,this.checkGroup)));e.byId("share-groups-list").innerHTML=f;if(this.shareInfo.organization){for(a=d=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"org"===this.shareInfo.items[a].sharing.access&&d++;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg?
(0===d?(dijit.byId("share-account-check").set("checked",!1),dijit.byId("share-account-check").set("disabled",!1)):d===this.shareInfo.items.length?(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",!1)):(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",!0)),m.set(e.byId("share-account-check_div"),"display","block")):(dijit.byId("share-account-check").set("disabled",!0),m.set(e.byId("share-account-check_div"),
"display","none"))}if(!this.shareInfo.organization||this.shareInfo._orgUserCanSharePublicOrOverride){for(a=d=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"public"===this.shareInfo.items[a].sharing.access&&d++;if(0===d)dijit.byId("share-everyone-check").set("checked",!1),m.set(e.byId("share-everyone-check_div"),"display","block");else if(d===this.shareInfo.items.length?(dijit.byId("share-everyone-check").set("checked",!0),m.set(e.byId("share-everyone-check_div"),"display","block")):
dijit.byId("share-everyone-check").set("checked",!0),this.shareInfo.organization&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg))dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",dijit.byId("share-everyone-check").get("checked"));this.clickEveryone()}else dijit.byId("share-everyone-check").set("checked",!1),m.set(e.byId("share-everyone-check_div"),"display","none");b?dijit.byId("share-groups-check").set("checked",
!0):dijit.byId("share-groups-check").set("checked",!1);this.own(g(e.byId("share-groups-check"),"click",k.hitch(this,this.checkGroups)));this.shareInfo.organization&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&this.own(g(e.byId("share-account-check"),"click",k.hitch(this,this.clickAccount)))},buildList:function(){var a,c;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToGroup||this.shareInfo._roleCanShareOthersItemsToGroup?
this.shareInfo.userGroups&&0<this.shareInfo.userGroups.length&&m.set(e.byId("share-groups-div"),"display","block"):m.set(e.byId("share-groups-div"),"display","none");this.shareInfo.itemsAreSharedToGroups=",";var b=[];for(a=0;a<this.shareInfo.items.length;a++){var d=this.shareInfo.items[a];if(d.sharing)for(var f=0;f<d.sharing.groups.length;f++){var h=d.sharing.groups[f];if(-1===this.shareInfo.itemsAreSharedToGroups.indexOf(","+h+","))this.shareInfo.itemsAreSharedToGroups+=h+",",c=[],c[0]=h,c[1]=1,
b[b.length]=c;else for(c=0;c<b.length;c++)if(b[c][0]===h){b[c][1]+=1;break}}}f="";d=!1;for(a=0;a<this.shareInfo.userGroups.length;a++){var h=this.shareInfo.userGroups[a],l="",p=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+h.id+",")){l="checked";d=!0;for(c=0;c<b.length;c++)if(b[c][0]===h.id){p=b[c][1];break}}f=p<this.shareInfo.items.length?f+('\x3cdiv id\x3d"img_group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+
a+'" src\x3d"'+this._checkboxImgUrl+'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+h.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+l+' value\x3d"'+h.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"'\x3e"+h.title+"\x3c/label\x3e"):f+('\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+l+' value\x3d"'+h.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+a+"'\x3e"+h.title+"\x3c/label\x3e");f=this._addOpenDataStr(h,
f);f+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}this.own(g(e.byId("share-groups-list"),"click",k.hitch(this,this.checkGroup)));e.byId("share-groups-list").innerHTML=f;if(this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)){for(a=b=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"org"===this.shareInfo.items[a].sharing.access&&b++;0===b?dijit.byId("share-account-check").set("checked",
!1):dijit.byId("share-account-check").set("checked",!0);m.set(e.byId("share-account-check_div"),"display","block")}if(!this.shareInfo.organization||this.shareInfo._orgUserCanSharePublicOrOverride){for(a=b=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"public"===this.shareInfo.items[a].sharing.access&&b++;if(0===b)dijit.byId("share-everyone-check").set("checked",!1),m.set(e.byId("share-everyone-check_div"),"display","block");else if(b===this.shareInfo.items.length?(dijit.byId("share-everyone-check").set("checked",
!0),m.set(e.byId("share-everyone-check_div"),"display","block")):dijit.byId("share-everyone-check").set("checked",!0),this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg))dijit.byId("share-account-check").set("checked",!0),m.set(e.byId("share-everyone-check_div"),"display","block");this.clickEveryone()}else if(this.shareInfo.organization&&!this.shareInfo.organization.canSharePublic){for(a=
b=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"public"===this.shareInfo.items[a].sharing.access&&b++;if(b){if(dijit.byId("share-everyone-check").set("checked",!0),this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg))dijit.byId("share-account-check").set("checked",!0),m.set(e.byId("share-account-check_div"),"display","block")}else dijit.byId("share-everyone-check").set("checked",
!1),m.set(e.byId("share-everyone-check_div"),"display","none")}else dijit.byId("share-everyone-check").set("checked",!1),m.set(e.byId("share-everyone-check_div"),"display","none");d?dijit.byId("share-groups-check").set("checked",!0):dijit.byId("share-groups-check").set("checked",!1);this.own(g(e.byId("share-groups-check"),"click",k.hitch(this,this.checkGroups)));this.shareInfo.organization&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&
this.own(g(e.byId("share-account-check"),"click",k.hitch(this,this.clickAccount)))},buildGroupList:function(){var a,c;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToGroup||this.shareInfo._roleCanShareOthersItemsToGroup?0<this.shareInfo.userGroups.length&&m.set(e.byId("share-groups-div"),"display","block"):m.set(e.byId("share-groups-div"),"display","none");this.shareInfo.itemsAreSharedToGroups=",";var b=[];for(a=0;a<this.shareInfo.items.length;a++){var d=this.shareInfo.items[a];if(d.sharing)for(var f=
0;f<d.sharing.groups.length;f++){var h=d.sharing.groups[f];if(-1===this.shareInfo.itemsAreSharedToGroups.indexOf(","+h+","))this.shareInfo.itemsAreSharedToGroups+=h+",",c=[],c[0]=h,c[1]=1,b[b.length]=c;else for(c=0;c<b.length;c++)if(b[c][0]===h){b[c][1]+=1;break}}}var d="",f=!1,l,p;for(a=0;a<this.shareInfo.userGroups.length;a++){h=this.shareInfo.userGroups[a];l="";p=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+h.id+",")){l="checked";f=!0;for(c=0;c<b.length;c++)if(b[c][0]===
h.id){p=b[c][1];break}}d=p<this.shareInfo.items.length?d+('\x3cdiv id\x3d"img_group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+a+'" src\x3d"'+this._checkboxImgUrl+'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+h.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+a+"_div\"style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+
a+'" '+l+' value\x3d"'+h.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\''+h.id+"'\x3e"+h.title+"\x3c/label\x3e"):d+('\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+l+' value\x3d"'+h.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"'\x3e"+h.title+"\x3c/label\x3e");d=this._addOpenDataStr(h,d);d+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}this.own(g(e.byId("share-groups-list"),"click",k.hitch(this,this.checkGroup)));e.byId("share-groups-list").innerHTML=d;f?dijit.byId("share-groups-check").set("checked",!0):dijit.byId("share-groups-check").set("checked",!1);this.own(g(e.byId("share-groups-check"),"click",k.hitch(this,this.checkGroups)))},share:function(a){"group"===this.shareInfo.shareType?this.shareItemToGroups():
"admin"===this.shareInfo.shareType?this.shareItemAsAdmin(a):this.shareItem(a)},checkGroup:function(a){-1<a.target.id.indexOf("img_group_")&&(m.set(e.byId(a.target.id+"_div"),"display","none"),m.set(e.byId(a.target.id.substring(4,a.target.id.length)+"_div"),"display","block"));!0===a.target.checked&&-1<a.target.id.indexOf("group_")&&dijit.byId("share-groups-check").set("checked",!0)},checkGroups:function(){},clickEveryone:function(){var a=dijit.byId("share-everyone-check").get("checked");if(!0===a){var c=
e.byId("share-account-check_div");this.shareInfo.organization&&(c&&"block"===m.get(c,"display"))&&(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",!0))}else this.shareInfo.organization&&(this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg))&&m.set(e.byId("share-account-check_div"),"display","block"),dijit.byId("share-account-check").set("disabled",!1);d.publish("ShareOptions/onClickEveryone",
a)},clickAccount:function(){!0===dijit.byId("share-account-check").get("checked")?(this.shareInfo._orgUserCanSharePublicOrOverride&&("none"===m.get(e.byId("share-everyone-check_div"),"display")&&m.set(e.byId("share-everyone-check_div"),"display","block"),dijit.byId("share-everyone-check").set("checked",!1)),dijit.byId("share-account-check").set("checked",!0)):dijit.byId("share-account-check").set("checked",!1)},shareItemAsAdmin:function(){var a="",c="";q.forEach(this.shareInfo.items,function(b){a+=
c+b.id;c=","});var b=!1,d=!1;e.byId("share-everyone-check_div")&&"block"===m.get(e.byId("share-everyone-check_div"),"display")&&(b=dijit.byId("share-everyone-check").get("checked"));e.byId("share-account-check_div")&&"block"===m.get(e.byId("share-account-check_div"),"display")&&(d=dijit.byId("share-account-check").get("checked"));var f="",g="",h="",l="",p=0;if(dijit.byId("share-groups-check").get("checked")){var r;if(this.shareInfo.user.groups&&this.shareInfo.user.groups.length)for(p=0;p<this.shareInfo.user.groups.length;p++)r=
this.shareInfo.user.groups[p].id,"block"===m.get(e.byId("group_"+p+"_div"),"display")&&(e.byId("group_"+p).checked?(f+=h+r,h=","):(g+=l+r,l=","));if(this.shareInfo.adminGroups&&this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess)for(var B=0;B<this.shareInfo.adminGroups.length;B++)r=this.shareInfo.adminGroups[B].id,"block"===m.get(e.byId("group_"+(B+p)+"_div"),"display")&&(e.byId("group_"+(B+p)).checked?(f+=h+r,h=","):(g+=l+r,l=","))}else l="",this.shareInfo.user.groups&&this.shareInfo.user.groups.length&&
q.forEach(this.shareInfo.user.groups,function(a){g+=l+a.id;l=","}),this.shareInfo.adminGroups&&(this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess)&&q.forEach(this.shareInfo.adminGroups,function(a){g+=l+a.id;l=","});if(0<g.length){h={items:a,groups:g};for(p=0;p<this.shareInfo.items.length;p++)u._unshareItemById(h,this.shareInfo.items[p].id,this.portalUrl).then(k.hitch(this,this.unShareHandler_admin,this.shareInfo.items,a,f,b,d))}else this.unShareHandler_admin(this.shareInfo.items,a,
f,b,d)},unShareHandler_admin:function(a,c,b,d,e){var f=a.length,g=function(){f--};c={items:c,groups:b,everyone:d,account:e};for(b=0;b<a.length;b++)d=a[b],this.shareInfo.user.shareItem(c,d.id,d.folderId).then(k.hitch(this,g))},shareItem:function(){var a="",c="";q.forEach(this.shareInfo.items,function(b){a+=c+b.id;c=","});var b=!1,d=!1;e.byId("share-everyone-check_div")&&"block"===m.get(e.byId("share-everyone-check_div"),"display")&&(b=dijit.byId("share-everyone-check").get("checked"));e.byId("share-account-check_div")&&
"block"===m.get(e.byId("share-account-check_div"),"display")&&(d=dijit.byId("share-account-check").get("checked"));var f=dijit.byId("share-groups-check").get("checked"),g="",h="",l="",p="";this.shareInfo.userGroups=this.shareInfo.user.group;f?this.shareInfo.userGroups&&this.shareInfo.userGroups.length&&q.forEach(this.shareInfo.userGroups,function(a,b){var c=a.id;"block"===m.get(e.byId("group_"+b+"_div"),"display")&&(e.byId("group_"+b).checked?(g+=l+c,l=","):(h+=p+c,p=","))}):(p="",this.shareInfo.userGroups&&
this.shareInfo.userGroups.length&&q.forEach(this.shareInfo.userGroups,function(a){h+=p+a.id;p=","}));0<h.length?(f={items:a,groups:h},this.shareInfo.itemUser&&null!==this.shareInfo.itemUser?u.unshareItemsByUser(this.shareInfo.itemUser.username?this.shareInfo.itemUser.username:this.shareInfo.itemUser.email,f,this.portalUrl).then(k.hitch(this,this.unShareHandler_item,this.shareInfo.itemUser,a,g,b,d)):u.unshareItems(this.shareInfo.itemUser,f,this.portalUrl).then(k.hitch(this,this.unShareHandler_item,
this.shareInfo.itemUser,a,g,b,d))):this.unShareHandler_item(this.shareInfo.itemUser,a,g,b,d)},unShareHandler_item:function(a,c,b,d,e){c={items:c,groups:b,everyone:d,account:e};a&&null!==a?u.shareItemsByUser(a.username?a.username:a.email,c,this.portalUrl).then(k.hitch()):u.shareItems(a,c,this.portalUrl).then()},findLowestAccessLevel:function(a){for(var c=3,b,d,e=0;e<a.length;e++)(d=a[e].access)||(d="private"),1===d.length&&(d=d[0]),"public"===d?b=3:"org"===d?b=2:"shared"===d?b=1:"private"===d&&(b=
0),b<c&&(c=b);return c},_sortFunc:function(a,c){var b=a[this.shareInfo.sortField].toLowerCase(),d=c[this.shareInfo.sortField].toLowerCase();return null===b||null===d||b===d?0:b<d?-1:1},_addOpenDataStr:function(a,c){a.isOpenData&&!u.portal.isPortal&&(c+=" "+this.i18n.openData);return c},_clearGroupCheckboxes:function(){if(!1===dijit.byId("share-groups-check").get("checked"))for(var a=c(".share-groups-input-checkbox"),d=0,b=a.length;d<b;d++)a[d].setAttribute("value",!1)}})})},"jimu/shareUtils":function(){define("dojo/_base/lang esri/request dojo/promise/all jimu/shared/basePortalUrlUtils dojo/Deferred esri/lang jimu/portalUtils jimu/Role jimu/utils".split(" "),
function(p,f,a,l,k,h,q,m,g){var e={_isUserOwnTheApp:function(a){return a&&a.username&&a.username===window.appInfo.appOwner?!0:!1},getItemByUserAndItemId:function(a,d,e,g){var m=new k;g=l.getStandardPortalUrl(g);g=g+"/sharing/rest/content/users/"+(d?d.username?d.username:d.email:e.email);if(h.isDefined(a.folderId)&&"/"!==a.folderId||h.isDefined(a.ownerFolder)&&"/"!==a.ownerFolder)g+="/"+(a.folderId||a.ownerFolder);g+="/items/"+a.id;f({url:g,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(p.hitch(this,
function(a){m.resolve(a)}),p.hitch(this,function(a){console.error(a);m.reject(a)}));return m},_getProfile:function(a,d){var e=new k,g=l.getUserUrl(d,a.owner);f({url:g,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(p.hitch(this,function(a){e.resolve(a)}),p.hitch(this,function(a){console.error(a);e.reject(a)}));return e},_unshareItemById:function(a,d,e){var g=new k;e=l.getStandardPortalUrl(e);e+="/sharing/rest/content/items/"+d+"/unshare";d={f:"json"};d=p.mixin(d,a);f({url:e,
handleAs:"json",content:d,callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,function(a){g.resolve(a)}),p.hitch(this,function(a){console.error(a);g.reject(a)}));return g},canSharePublic:function(a){return a.selfUrl&&(!0===a.canSharePublic||!1===a.canSharePublic)?a.canSharePublic:!0},unshareItemsByUser:function(a,d,e){var g=new k;e=l.getStandardPortalUrl(e);e+="/sharing/rest/content/users/"+a+"/unshareItems";a={f:"json"};a=p.mixin(a,d);f({url:e,handleAs:"json",content:a,callbackParamName:"callback"},
{usePost:!0}).then(p.hitch(this,function(a){g.resolve(a)}),p.hitch(this,function(a){console.error(a);g.reject(a)}));return g},unshareItems:function(a,d,e){var g=new k;e=l.getStandardPortalUrl(e);e+="/sharing/rest/content/users/"+(d.owner||a.email)+"/unshareItems";a={f:"json"};a=p.mixin(a,d);f({url:e,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,function(a){g.resolve(a)}),p.hitch(this,function(a){console.error(a);g.reject(a)}));return g},shareItemsByUser:function(a,
d,e){var g=new k;e=l.getStandardPortalUrl(e);e+="/sharing/rest/content/users/"+a+"/shareItems";a={f:"json"};a=p.mixin(a,d);f({url:e,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,function(a){g.resolve(a)}),p.hitch(this,function(a){console.error(a);g.reject(a)}));return g},shareItems:function(a,d,e){var g=new k;e=l.getStandardPortalUrl(e);e+="/sharing/rest/content/users/"+(d.owner||a.email)+"/shareItems";a={f:"json"};a=p.mixin(a,d);f({url:e,handleAs:"json",
content:a,callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,function(a){g.resolve(a)}),p.hitch(this,function(a){console.error(a);g.reject(a)}));return g},getItemsGroups:function(a,d){var e=new k,g=l.getStandardPortalUrl(d),g=g+("/sharing/rest/content/items/"+a.id+"/groups");f({url:g,handleAs:"json",content:{f:"json"},callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,function(a){e.resolve(a)}),p.hitch(this,function(a){console.error(a);e.reject(a)}));return e},isSharedToPublic:function(a){return window.isXT?
!1:null===a?!0:"undefined"!==typeof a&&"undefined"!==typeof a.item&&"undefined"!==typeof a.item.access&&"public"===a.item.access?!0:!1},isShowSocialMediaLinks:function(a){return window.isXT?!0:null===a?!0:"undefined"!==typeof a&&"undefined"!==typeof a.item&&"undefined"!==typeof a.item.access&&"private"===a.item.access?!1:!0},getItemShareInfo:function(a){var d=new k,e="";if(window.isXT)return d.resolve(null);e=g.urlToObject(window.top.location.href).query||{};e=e.id||e.appid;if("undefined"===typeof e||
""===e)return d.resolve(null);q.getPortal(a).getItemById(e).then(p.hitch(this,function(a){var c={};c.item=a;c.item&&("undefined"===typeof c.item.sharing&&c.item.access)&&(c.item.sharing={access:c.item.access});d.resolve(c)}),p.hitch(this,function(a){console.log(a);d.resolve(null)}));return d},getShareInfo:function(c){var d=q.getPortal(c),f=new k,h="";if(window.isXT)return f.resolve(null);h=g.urlToObject(window.top.location.href).query||{};h=h.id||h.appid;if("undefined"===typeof h||""===h)return f.resolve(null);
a({getUser:d.getUser(),loadSelfInfo:d.loadSelfInfo(),getItem:d.getItemById(h)}).then(p.hitch(this,function(a){var d={};d.item=a.getItem;d.item&&(d.item.ownerFolder&&d.item.ownerFolder.length&&"/"!==d.item.ownerFolder)&&(d.item.folderId=d.item.ownerFolder);"undefined"===typeof d.item.sharing&&d.item.access&&(d.item.sharing={access:d.item.access});d.user=a.getUser;e._setUserRole(a.loadSelfInfo,d);d.currentUser=d.user;d.isAdmin=!1;d.userRole&&(d.userRole.isAdmin()||d.userRole.isCustom()&&d.userRole.canUpdateOrgItems())?
(d.isAdmin=!0,d.item.owner!==d.currentUser.name?e._getProfile(d.item,c).then(p.hitch(this,function(a){d.itemUser=a;d.itemUser.orgId!==d.currentUser.orgId&&(d.isAdmin=!1);f.resolve(d)})):(d.itemUser=d.currentUser,f.resolve(d))):(d.currentUser&&(d.itemUser=d.currentUser),f.resolve(d))}),p.hitch(this,function(a){console.log(a);f.resolve(null)}));return f},_setUserRole:function(a,d){d.userPortalUrl=a.urlKey?a.urlKey+"."+a.customBaseUrl:this.portalUrl;a&&(!a.code&&!a.message)&&(d.organization=a);if(a&&
a.user)d.userRole=new m({id:a.user.roleId?a.user.roleId:a.user.role,role:a.user.role}),d._isCustomRole=d.userRole.isCustom(),d._roleCanShareToGroup=d._isCustomRole&&d.userRole.canShareItemToGroup(),d._roleCanShareToOrg=d._isCustomRole&&d.userRole.canShareItemToOrg(),d._roleCanSharePublic=d._isCustomRole&&d.userRole.canShareItemToPublic(),d._roleCanShare=d._roleCanShareToGroup||d._roleCanShareToOrg||d._roleCanShareToPublic,d._roleCanUpdateItems=d._isCustomRole&&d.userRole.canUpdateOrgItems(),d._roleCanShareOthersItemsToGroup=
d._isCustomRole&&d.userRole.canShareOthersItemsToGroup(),d._roleCanShareOthersItemsToOrg=d._isCustomRole&&d.userRole.canShareOthersItemsToOrg(),d._roleCanShareOthersItemsToPublic=d._isCustomRole&&d.userRole.canShareOthersItemsToPublic(),d._roleCanShareOthersItems=d._isCustomRole&&(d.userRole.canShareOthersItemsToGroup()||d.userRole.canShareOthersItemsToOrg()||d._roleCanShareOthersItemsToPublic),d._orgUserCanSharePublicOrOverride=d.organization&&(!0===d.organization.canSharePublic&&(!d._isCustomRole||
d._roleCanSharePublic||d._roleCanShareOthersItemsToPublic)||d.userRole.isAdmin());else return!1},getItemById:function(a,d){var e=new k,g=l.getStandardPortalUrl(d),g=g+("/sharing/rest/content/items/"+a.id);f({url:g,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(p.hitch(this,function(a){e.resolve(a)}),p.hitch(this,function(a){console.error(a);e.reject(a)}));return e}};return e})},"jimu/Role":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/json",
"esri/lang"],function(p,f,a,l,k){return p(null,{id:null,baseRole:null,name:null,description:null,privileges:[],privilegeObj:null,constructor:function(a){a=a||{};this.id=a.id;this.baseRole=a.role;this.name=a.name;this.description=a.description},_initPrivilegesObject:function(){this.privilegeObj={portal:{admin:{inviteUsers:!1,disableUsers:!1,viewUsers:!1,updateUsers:!1,deleteUsers:!1,changeUserRoles:!1,viewGroups:!1,updateGroups:!1,deleteGroups:!1,reassignGroups:!1,assignToGroups:!1,manageEnterpriseGroups:!1,
viewItems:!1,updateItems:!1,deleteItems:!1,reassignItems:!1,manageLicenses:!1},publisher:{publishFeatures:!1,publishTiles:!1,publishScenes:!1},user:{createGroup:!1,joinGroup:!1,joinNonOrgGroup:!1,createItem:!1,shareToGroup:!1,shareToOrg:!1,shareToPublic:!1,shareGroupToOrg:!1,shareGroupToPublic:!1}},features:{user:{edit:!1,fullEdit:!1}},opendata:{user:{openDataAdmin:!1,designateGroup:!1}},premium:{user:{geocode:!1,networkanalysis:!1,spatialanalysis:!1,geoenrichment:!1,demographics:!1,elevation:!1}},
marketplace:{admin:{manage:!1,purchase:!1,startTrial:!1}}}},_readPrivileges:function(h){k.isDefined(h)&&h instanceof Array&&a.forEach(h,f.hitch(this,function(a){this._readPrivilege(a)}))},_readPrivilege:function(a){this._applyEffectToAction(!0,a)},_applyEffectToAction:function(a,f){switch(f){case "portal:admin:inviteUsers":this.privilegeObj.portal.admin.inviteUsers=a;break;case "portal:admin:disableUsers":this.privilegeObj.portal.admin.disableUsers=a;break;case "portal:admin:viewUsers":this.privilegeObj.portal.admin.viewUsers=
a;break;case "portal:admin:updateUsers":this.privilegeObj.portal.admin.updateUsers=a;break;case "portal:admin:deleteUsers":this.privilegeObj.portal.admin.deleteUsers=a;break;case "portal:admin:changeUserRoles":this.privilegeObj.portal.admin.changeUserRoles=a;break;case "portal:admin:viewGroups":this.privilegeObj.portal.admin.viewGroups=a;break;case "portal:admin:updateGroups":this.privilegeObj.portal.admin.updateGroups=a;break;case "portal:admin:deleteGroups":this.privilegeObj.portal.admin.deleteGroups=
a;break;case "portal:admin:reassignGroups":this.privilegeObj.portal.admin.reassignGroups=a;break;case "portal:admin:assignToGroups":this.privilegeObj.portal.admin.assignToGroups=a;break;case "portal:admin:manageEnterpriseGroups":this.privilegeObj.portal.admin.manageEnterpriseGroups=a;break;case "portal:admin:viewItems":this.privilegeObj.portal.admin.viewItems=a;break;case "portal:admin:updateItems":this.privilegeObj.portal.admin.updateItems=a;break;case "portal:admin:deleteItems":this.privilegeObj.portal.admin.deleteItems=
a;break;case "portal:admin:reassignItems":this.privilegeObj.portal.admin.reassignItems=a;break;case "portal:admin:manageLicenses":this.privilegeObj.portal.admin.manageLicenses=a;break;case "portal:publisher:publishFeatures":this.privilegeObj.portal.publisher.publishFeatures=a;break;case "portal:publisher:publishTiles":this.privilegeObj.portal.publisher.publishTiles=a;break;case "portal:publisher:publishScenes":this.privilegeObj.portal.publisher.publishScenes=a;break;case "portal:user:createGroup":this.privilegeObj.portal.user.createGroup=
a;break;case "portal:user:joinGroup":this.privilegeObj.portal.user.joinGroup=a;break;case "portal:user:joinNonOrgGroup":this.privilegeObj.portal.user.joinNonOrgGroup=a;break;case "portal:user:createItem":this.privilegeObj.portal.user.createItem=a;break;case "portal:user:shareToGroup":this.privilegeObj.portal.user.shareToGroup=a;break;case "portal:user:shareToOrg":this.privilegeObj.portal.user.shareToOrg=a;break;case "portal:user:shareToPublic":this.privilegeObj.portal.user.shareToPublic=a;break;case "portal:user:shareGroupToOrg":this.privilegeObj.portal.user.shareGroupToOrg=
a;break;case "portal:user:shareGroupToPublic":this.privilegeObj.portal.user.shareGroupToPublic=a;break;case "features:user:edit":this.privilegeObj.features.user.edit=a;break;case "features:user:fullEdit":this.privilegeObj.features.user.fullEdit=a;break;case "opendata:user:openDataAdmin":this.privilegeObj.opendata.user.openDataAdmin=a;break;case "opendata:user:designateGroup":this.privilegeObj.opendata.user.designateGroup=a;break;case "premium:user:geocode":this.privilegeObj.premium.user.geocode=a;
break;case "premium:user:networkanalysis":this.privilegeObj.premium.user.networkanalysis=a;break;case "premium:user:spatialanalysis":this.privilegeObj.premium.user.spatialanalysis=a;break;case "premium:user:geoenrichment":this.privilegeObj.premium.user.geoenrichment=a;break;case "premium:user:demographics":this.privilegeObj.premium.user.demographics=a;break;case "premium:user:elevation":this.privilegeObj.premium.user.elevation=a;break;case "marketplace:admin:purchase":this.privilegeObj.marketplace.admin.purchase=
a;break;case "marketplace:admin:manage":this.privilegeObj.marketplace.admin.manage=a;break;case "marketplace:admin:startTrial":this.privilegeObj.marketplace.admin.startTrial=a}},_applyToAll:function(a){this.privilegeObj.portal.admin.inviteUsers=a;this.privilegeObj.portal.admin.disableUsers=a;this.privilegeObj.portal.admin.viewUsers=a;this.privilegeObj.portal.admin.updateUsers=a;this.privilegeObj.portal.admin.deleteUsers=a;this.privilegeObj.portal.admin.changeUserRoles=a;this.privilegeObj.portal.admin.viewGroups=
a;this.privilegeObj.portal.admin.updateGroups=a;this.privilegeObj.portal.admin.deleteGroups=a;this.privilegeObj.portal.admin.reassignGroups=a;this.privilegeObj.portal.admin.assignToGroups=a;this.privilegeObj.portal.admin.manageEnterpriseGroups=a;this.privilegeObj.portal.admin.viewItems=a;this.privilegeObj.portal.admin.updateItems=a;this.privilegeObj.portal.admin.deleteItems=a;this.privilegeObj.portal.admin.reassignItems=a;this.privilegeObj.portal.admin.manageLicenses=a;this.privilegeObj.portal.publisher.publishFeatures=
a;this.privilegeObj.portal.publisher.publishTiles=a;this.privilegeObj.portal.publisher.publishScenes=a;this.privilegeObj.portal.user.createGroup=a;this.privilegeObj.portal.user.joinGroup=a;this.privilegeObj.portal.user.joinNonOrgGroup=a;this.privilegeObj.portal.user.createItem=a;this.privilegeObj.portal.user.shareToGroup=a;this.privilegeObj.portal.user.shareToOrg=a;this.privilegeObj.portal.user.shareToPublic=a;this.privilegeObj.portal.user.shareGroupToOrg=a;this.privilegeObj.portal.user.shareGroupToPublic=
a;this.privilegeObj.features.user.edit=a;this.privilegeObj.opendata.user.openDataAdmin=a;this.privilegeObj.opendata.user.designateGroup=a;this.privilegeObj.premium.user.geocode=a;this.privilegeObj.premium.user.networkanalysis=a;this.privilegeObj.premium.user.spatialanalysis=a;this.privilegeObj.premium.user.geoenrichment=a;this.privilegeObj.premium.user.demographics=a;this.privilegeObj.premium.user.elevation=a;this.privilegeObj.marketplace.admin.purchase=a;this.privilegeObj.marketplace.admin.manage=
a;this.privilegeObj.marketplace.admin.startTrial=a},_buildPrivilegesArray:function(){var a=[];!0===this.privilegeObj.portal.admin.inviteUsers&&a.push("portal:admin:inviteUsers");!0===this.privilegeObj.portal.admin.disableUsers&&a.push("portal:admin:disableUsers");!0===this.privilegeObj.portal.admin.viewUsers&&a.push("portal:admin:viewUsers");!0===this.privilegeObj.portal.admin.updateUsers&&a.push("portal:admin:updateUsers");!0===this.privilegeObj.portal.admin.deleteUsers&&a.push("portal:admin:deleteUsers");
!0===this.privilegeObj.portal.admin.changeUserRoles&&a.push("portal:admin:changeUserRoles");!0===this.privilegeObj.portal.admin.viewGroups&&a.push("portal:admin:viewGroups");!0===this.privilegeObj.portal.admin.updateGroups&&a.push("portal:admin:updateGroups");!0===this.privilegeObj.portal.admin.deleteGroups&&a.push("portal:admin:deleteGroups");!0===this.privilegeObj.portal.admin.reassignGroups&&a.push("portal:admin:reassignGroups");!0===this.privilegeObj.portal.admin.assignToGroups&&a.push("portal:admin:assignToGroups");
!0===this.privilegeObj.portal.admin.manageEnterpriseGroups&&a.push("portal:admin:manageEnterpriseGroups");!0===this.privilegeObj.portal.admin.viewItems&&a.push("portal:admin:viewItems");!0===this.privilegeObj.portal.admin.updateItems&&a.push("portal:admin:updateItems");!0===this.privilegeObj.portal.admin.deleteItems&&a.push("portal:admin:deleteItems");!0===this.privilegeObj.portal.admin.reassignItems&&a.push("portal:admin:reassignItems");!0===this.privilegeObj.portal.admin.manageLicenses&&a.push("portal:admin:manageLicenses");
!0===this.privilegeObj.portal.publisher.publishFeatures&&a.push("portal:publisher:publishFeatures");!0===this.privilegeObj.portal.publisher.publishTiles&&a.push("portal:publisher:publishTiles");!0===this.privilegeObj.portal.publisher.publishScenes&&a.push("portal:publisher:publishScenes");!0===this.privilegeObj.portal.user.createGroup&&a.push("portal:user:createGroup");!0===this.privilegeObj.portal.user.joinGroup&&a.push("portal:user:joinGroup");!0===this.privilegeObj.portal.user.joinNonOrgGroup&&
a.push("portal:user:joinNonOrgGroup");!0===this.privilegeObj.portal.user.createItem&&a.push("portal:user:createItem");!0===this.privilegeObj.portal.user.shareToGroup&&a.push("portal:user:shareToGroup");!0===this.privilegeObj.portal.user.shareToOrg&&a.push("portal:user:shareToOrg");!0===this.privilegeObj.portal.user.shareToPublic&&a.push("portal:user:shareToPublic");!0===this.privilegeObj.portal.user.shareGroupToOrg&&a.push("portal:user:shareGroupToOrg");!0===this.privilegeObj.portal.user.shareGroupToPublic&&
a.push("portal:user:shareGroupToPublic");!0===this.privilegeObj.features.user.edit&&a.push("features:user:edit");!0===this.privilegeObj.features.user.fullEdit&&a.push("features:user:fullEdit");!0===this.privilegeObj.opendata.user.openDataAdmin&&a.push("opendata:user:openDataAdmin");!0===this.privilegeObj.opendata.user.designateGroup&&a.push("opendata:user:designateGroup");!0===this.privilegeObj.premium.user.geocode&&a.push("premium:user:geocode");!0===this.privilegeObj.premium.user.networkanalysis&&
a.push("premium:user:networkanalysis");!0===this.privilegeObj.premium.user.spatialanalysis&&a.push("premium:user:spatialanalysis");!0===this.privilegeObj.premium.user.geoenrichment&&a.push("premium:user:geoenrichment");!0===this.privilegeObj.premium.user.demographics&&a.push("premium:user:demographics");!0===this.privilegeObj.premium.user.elevation&&a.push("premium:user:elevation");!0===this.privilegeObj.marketplace.admin.purchase&&a.push("marketplace:admin:purchase");!0===this.privilegeObj.marketplace.admin.manage&&
a.push("marketplace:admin:manage");!0===this.privilegeObj.marketplace.admin.startTrial&&a.push("marketplace:admin:startTrial");return a},isUser:function(){return k.isDefined(this.id)&&("org_user"===this.id||"account_user"===this.id)},isPublisher:function(){return k.isDefined(this.id)&&("org_publisher"===this.id||"account_publisher"===this.id)},isAdmin:function(){return k.isDefined(this.id)&&("org_admin"===this.id||"account_admin"===this.id)},isBasedOnUser:function(){return this.isUser()||k.isDefined(this.baseRole)&&
("org_user"===this.baseRole||"account_user"===this.baseRole)},isBasedOnPublisher:function(){return this.isPublisher()||k.isDefined(this.baseRole)&&("org_publisher"===this.baseRole||"account_publisher"===this.baseRole)},isBasedOnAdmin:function(){return this.isAdmin()||k.isDefined(this.baseRole)&&("org_admin"===this.baseRole||"account_admin"===this.baseRole)},isCustom:function(){return!this.isUser()&&!this.isPublisher()&&!this.isAdmin()&&k.isDefined(this.id)&&0<this.id.length},canInviteUsers:function(){return this.privilegeObj&&
this.privilegeObj.portal.admin.inviteUsers},canDisableUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.disableUsers},canViewUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewUsers},canUpdateUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateUsers},canDeleteUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteUsers},canChangeUserRoles:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.changeUserRoles},
canViewOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewGroups},canUpdateOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateGroups},canDeleteOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteGroups},canReassignOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignGroups},canAssignUsersToOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.assignToGroups},
canManageEnterpriseGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageEnterpriseGroups},canViewOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewItems},canUpdateOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateItems},canDeleteOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteItems},canReassignOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignItems},
canManageLicenses:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageLicenses},canCreateGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.createGroup},canJoinOrgGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinGroup},canJoinNonOrgGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinNonOrgGroup},canPublishFeatures:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishFeatures},
canPublishTiles:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishTiles},canPublishScenes:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishScenes},canCreateItem:function(){return this.privilegeObj&&this.privilegeObj.portal.user.createItem},canShareItemToGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToGroup},canShareItemToOrg:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToOrg},canShareItemToPublic:function(){return this.privilegeObj&&
this.privilegeObj.portal.user.shareToPublic},canShareGroupToOrg:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToOrg},canShareGroupToPublic:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToPublic},canEditFeatures:function(){return this.privilegeObj&&this.privilegeObj.features.user.edit},canEditFeaturesFullControl:function(){return this.privilegeObj&&this.privilegeObj.features.user.fullEdit},canManageOpenData:function(){return this.privilegeObj&&
this.privilegeObj.opendata.user.openDataAdmin},canDesignateOpenDataGroups:function(){return this.privilegeObj&&this.privilegeObj.opendata.user.designateGroup},canUseGeocode:function(){return this.privilegeObj&&this.privilegeObj.premium.user.geocode},canUseNetworkAnalysis:function(){return this.privilegeObj&&this.privilegeObj.premium.user.networkanalysis},canUseSpatialAnalysis:function(){return this.privilegeObj&&this.privilegeObj.premium.user.spatialanalysis},canUseGeoenrichment:function(){return this.privilegeObj&&
this.privilegeObj.premium.user.geoenrichment},canUseDemographics:function(){return this.privilegeObj&&this.privilegeObj.premium.user.demographics},canUseElevation:function(){return this.privilegeObj&&this.privilegeObj.premium.user.elevation},canPurchaseMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.purchase},canManageMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.manage},canTrialMarketplace:function(){return this.privilegeObj&&
this.privilegeObj.marketplace.admin.startTrial},setPrivileges:function(a){this.privileges=a;this._initPrivilegesObject();k.isDefined(a)&&this._readPrivileges(a)},stringify:function(){return l.stringify({id:this.id,name:this.name,description:this.description,privileges:this._buildPrivilegesArray()})},stringifyRole:function(){return l.stringify({id:this.id,name:this.name,description:this.description})},stringifyPrivileges:function(){return l.stringify({privileges:this._buildPrivilegesArray()})},stringifyPretty:function(){return l.stringify({id:this.id,
name:this.name,description:this.description,privileges:this._buildPrivilegesArray()},null,"  ")}})})},"dijit/form/Textarea":function(){define(["dojo/_base/declare","dojo/dom-style","./_ExpandingTextAreaMixin","./SimpleTextarea"],function(p,f,a,l){return p("dijit.form.Textarea",[l,a],{baseClass:"dijitTextBox dijitTextArea dijitExpandingTextArea",cols:"",buildRendering:function(){this.inherited(arguments);f.set(this.textbox,{overflowY:"hidden",overflowX:"auto",boxSizing:"border-box",MsBoxSizing:"border-box",
WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"})}})})},"dijit/form/_ExpandingTextAreaMixin":function(){define("dojo/_base/declare dojo/dom-construct dojo/has dojo/_base/lang dojo/on dojo/_base/window ../Viewport".split(" "),function(p,f,a,l,k,h,q){a.add("textarea-needs-help-shrinking",function(){var a=h.body(),g=f.create("textarea",{rows:"5",cols:"20",value:" ",style:{zoom:1,fontSize:"12px",height:"96px",overflow:"hidden",visibility:"hidden",position:"absolute",border:"5px solid white",margin:"0",
padding:"0",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"}},a,"last"),e=g.scrollHeight>=g.clientHeight;a.removeChild(g);return e});return p("dijit.form._ExpandingTextAreaMixin",null,{_setValueAttr:function(){this.inherited(arguments);this.resize()},postCreate:function(){this.inherited(arguments);var a=this.textbox;a.style.overflowY="hidden";this.own(k(a,"focus, resize",l.hitch(this,"_resizeLater")))},startup:function(){this.inherited(arguments);
this.own(q.on("resize",l.hitch(this,"_resizeLater")));this._resizeLater()},_onInput:function(a){this.inherited(arguments);this.resize()},_estimateHeight:function(){var a=this.textbox;a.rows=(a.value.match(/\n/g)||[]).length+1},_resizeLater:function(){this.defer("resize")},resize:function(){function f(){var a=!1;""===g.value&&(g.value=" ",a=!0);var b=g.scrollHeight;a&&(g.value="");return b}var g=this.textbox;"hidden"==g.style.overflowY&&(g.scrollTop=0);if(!this.busyResizing){this.busyResizing=!0;if(f()||
g.offsetHeight){var e=f()+Math.max(g.offsetHeight-g.clientHeight,0),c=e+"px";c!=g.style.height&&(g.style.height=c,g.rows=1);if(a("textarea-needs-help-shrinking")){var d=f(),h=g.style.minHeight,k=4,l=g.scrollTop;g.style.minHeight=c;for(g.style.height="auto";0<e;){g.style.minHeight=Math.max(e-k,4)+"px";c=f();d-=c;e-=d;if(d<k)break;d=c;k<<=1}g.style.height=e+"px";g.style.minHeight=h;g.scrollTop=l}g.style.overflowY=f()>g.clientHeight?"auto":"hidden";"hidden"==g.style.overflowY&&(g.scrollTop=0)}else this._estimateHeight();
this.busyResizing=!1}}})})},"dijit/layout/BorderContainer":function(){define("dojo/_base/array dojo/cookie dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/touch ../_WidgetBase ../_Widget ../_TemplatedMixin ./LayoutContainer ./utils".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t){var b=a("dijit.layout._Splitter",[r,u],{live:!0,templateString:'\x3cdiv class\x3d"dijitSplitter" data-dojo-attach-event\x3d"onkeydown:_onKeyDown,press:_startDrag,onmouseenter:_onMouse,onmouseleave:_onMouse" tabIndex\x3d"0" role\x3d"separator"\x3e\x3cdiv class\x3d"dijitSplitterThumb"\x3e\x3c/div\x3e\x3c/div\x3e',
constructor:function(){this._handlers=[]},postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region);this._factor=/top|left/.test(this.region)?1:-1;this._cookieName=this.container.id+"_"+this.region},buildRendering:function(){this.inherited(arguments);l.add(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V"));if(this.container.persist){var a=f(this._cookieName);a&&(this.child.domNode.style[this.horizontal?"height":"width"]=a)}},_computeMaxSize:function(){var a=
this.horizontal?"h":"w",b=h.getMarginBox(this.child.domNode)[a],c=p.filter(this.container.getChildren(),function(a){return"center"==a.region})[0],a=h.getContentBox(c.domNode)[a]-10;return Math.min(this.child.maxSize,b+a)},_startDrag:function(a){this.cover||(this.cover=k.place("\x3cdiv class\x3ddijitSplitterCover\x3e\x3c/div\x3e",this.child.domNode,"after"));l.add(this.cover,"dijitSplitterCoverActive");this.fake&&k.destroy(this.fake);if(!(this._resize=this.live))(this.fake=this.domNode.cloneNode(!0)).removeAttribute("id"),
l.add(this.domNode,"dijitSplitterShadow"),k.place(this.fake,this.domNode,"after");l.add(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active");this.fake&&l.remove(this.fake,"dijitSplitterHover dijitSplitter"+(this.horizontal?"H":"V")+"Hover");var b=this._factor,d=this.horizontal,f=d?"pageY":"pageX",m=a[f],p=this.domNode.style,d=d?"h":"w",r=q.getComputedStyle(this.child.domNode),s=h.getMarginBox(this.child.domNode,r)[d],t=this._computeMaxSize(),u=Math.max(this.child.minSize,
h.getPadBorderExtents(this.child.domNode,r)[d]+10),d=this.region,v="top"==d||"bottom"==d?"top":"left",M=parseInt(p[v],10),Q=this._resize,K=g.hitch(this.container,"_layoutChildren",this.child.id),d=this.ownerDocument;this._handlers=this._handlers.concat([e(d,c.move,this._drag=function(a,c){var d=a[f]-m,e=b*d+s,g=Math.max(Math.min(e,t),u);(Q||c)&&K(g);p[v]=d+M+b*(g-e)+"px"}),e(d,"dragstart",function(a){a.stopPropagation();a.preventDefault()}),e(this.ownerDocumentBody,"selectstart",function(a){a.stopPropagation();
a.preventDefault()}),e(d,c.release,g.hitch(this,"_stopDrag"))]);a.stopPropagation();a.preventDefault()},_onMouse:function(a){a="mouseover"==a.type||"mouseenter"==a.type;l.toggle(this.domNode,"dijitSplitterHover",a);l.toggle(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V")+"Hover",a)},_stopDrag:function(a){try{this.cover&&l.remove(this.cover,"dijitSplitterCoverActive"),this.fake&&k.destroy(this.fake),l.remove(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active dijitSplitterShadow"),
this._drag(a),this._drag(a,!0)}finally{this._cleanupHandlers(),delete this._drag}this.container.persist&&f(this._cookieName,this.child.domNode.style[this.horizontal?"height":"width"],{expires:365})},_cleanupHandlers:function(){for(var a;a=this._handlers.pop();)a.remove()},_onKeyDown:function(a){this._resize=!0;var b=this.horizontal,c=1;switch(a.keyCode){case b?m.UP_ARROW:m.LEFT_ARROW:c*=-1;case b?m.DOWN_ARROW:m.RIGHT_ARROW:break;default:return}b=h.getMarginSize(this.child.domNode)[b?"h":"w"]+this._factor*
c;this.container._layoutChildren(this.child.id,Math.max(Math.min(b,this._computeMaxSize()),this.child.minSize));a.stopPropagation();a.preventDefault()},destroy:function(){this._cleanupHandlers();delete this.child;delete this.container;delete this.cover;delete this.fake;this.inherited(arguments)}}),v=a("dijit.layout._Gutter",[r,u],{templateString:'\x3cdiv class\x3d"dijitGutter" role\x3d"presentation"\x3e\x3c/div\x3e',postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region)},
buildRendering:function(){this.inherited(arguments);l.add(this.domNode,"dijitGutter"+(this.horizontal?"H":"V"))}});a=a("dijit.layout.BorderContainer",s,{gutters:!0,liveSplitters:!0,persist:!1,baseClass:"dijitBorderContainer",_splitterClass:b,postMixInProperties:function(){this.gutters||(this.baseClass+="NoGutter");this.inherited(arguments)},_setupChild:function(a){this.inherited(arguments);var b=a.region,c=a.isLeftToRight();"leading"==b&&(b=c?"left":"right");"trailing"==b&&(b=c?"right":"left");if(b&&
"center"!=b&&(a.splitter||this.gutters)&&!a._splitterWidget)c=a.splitter?this._splitterClass:v,g.isString(c)&&(c=g.getObject(c)),c=new c({id:a.id+"_splitter",container:this,child:a,region:b,live:this.liveSplitters}),c.isSplitter=!0,a._splitterWidget=c,b="bottom"==b||b==(this.isLeftToRight()?"right":"left"),k.place(c.domNode,a.domNode,b?"before":"after"),c.startup()},layout:function(){this._layoutChildren()},removeChild:function(a){var b=a._splitterWidget;b&&(b.destroy(),delete a._splitterWidget);
this.inherited(arguments)},getChildren:function(){return p.filter(this.inherited(arguments),function(a){return!a.isSplitter})},getSplitter:function(a){return p.filter(this.getChildren(),function(b){return b.region==a})[0]._splitterWidget},resize:function(a,b){if(!this.cs||!this.pe){var c=this.domNode;this.cs=q.getComputedStyle(c);this.pe=h.getPadExtents(c,this.cs);this.pe.r=q.toPixelValue(c,this.cs.paddingRight);this.pe.b=q.toPixelValue(c,this.cs.paddingBottom);q.set(c,"padding","0px")}this.inherited(arguments)},
_layoutChildren:function(a,b){if(this._borderBox&&this._borderBox.h){var c=[];p.forEach(this._getOrderedChildren(),function(a){c.push(a);a._splitterWidget&&c.push(a._splitterWidget)});t.layoutChildren(this.domNode,{l:this.pe.l,t:this.pe.t,w:this._borderBox.w-this.pe.w,h:this._borderBox.h-this.pe.h},c,a,b)}},destroyRecursive:function(){p.forEach(this.getChildren(),function(a){var b=a._splitterWidget;b&&b.destroy();delete a._splitterWidget});this.inherited(arguments)}});a.ChildWidgetProperties={splitter:!1,
minSize:0,maxSize:Infinity};g.mixin(a.ChildWidgetProperties,s.ChildWidgetProperties);g.extend(d,a.ChildWidgetProperties);a._Splitter=b;a._Gutter=v;return a})},"dijit/layout/LayoutContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-style dojo/_base/lang ../_WidgetBase ./_LayoutWidget ./utils".split(" "),function(p,f,a,l,k,h,q,m){f=f("dijit.layout.LayoutContainer",q,{design:"headline",baseClass:"dijitLayoutContainer",startup:function(){this._started||(p.forEach(this.getChildren(),
this._setupChild,this),this.inherited(arguments))},_setupChild:function(f){this.inherited(arguments);f.region&&a.add(f.domNode,this.baseClass+"Pane")},_getOrderedChildren:function(){var a=p.map(this.getChildren(),function(a,c){return{pane:a,weight:["center"==a.region?Infinity:0,a.layoutPriority,("sidebar"==this.design?1:-1)*(/top|bottom/.test(a.region)?1:-1),c]}},this);a.sort(function(a,c){for(var d=a.weight,f=c.weight,g=0;g<d.length;g++)if(d[g]!=f[g])return d[g]-f[g];return 0});return p.map(a,function(a){return a.pane})},
layout:function(){m.layoutChildren(this.domNode,this._contentBox,this._getOrderedChildren())},addChild:function(a,e){this.inherited(arguments);this._started&&this.layout()},removeChild:function(f){this.inherited(arguments);this._started&&this.layout();a.remove(f.domNode,this.baseClass+"Pane");l.set(f.domNode,{top:"auto",bottom:"auto",left:"auto",right:"auto",position:"static"});l.set(f.domNode,/top|bottom/.test(f.region)?"width":"height","auto")}});f.ChildWidgetProperties={region:"",layoutAlign:"",
layoutPriority:0};k.extend(h,f.ChildWidgetProperties);return f})},"jimu/dijit/ShareLink":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/array dojo/dom-class dojo/on dojo/topic dojo/query jimu/utils dojo/_base/config dojo/cookie esri/urlUtils dojo/text!./templates/ShareLink.html dojo/string dijit/form/Select dijit/form/NumberTextBox dojo/dom-attr dojo/Deferred esri/request esri/tasks/query esri/tasks/QueryTask esri/symbols/PictureMarkerSymbol esri/graphic esri/layers/GraphicsLayer jimu/dijit/FeaturelayerChooserFromMap jimu/dijit/LayerChooserFromMapWithDropbox dijit/form/TextBox dijit/form/Textarea dijit/form/RadioButton dijit/form/Select dijit/form/CheckBox dijit/form/NumberTextBox dijit/form/SimpleTextarea dijit/form/ValidationTextBox".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A,B,F,E,H){return p([f,a,l],{templateString:s,declaredClass:"jimu.dijit.ShareLink",bitlyUrl:"http://api.bit.ly/v3/shorten?login\x3darcgisdev\x26apiKey\x3dR_18b3867d45854ba98d9e0e7c20dbf6d3",bitlyUrlSSL:"https://api-ssl.bitly.com/v3/shorten?login\x3darcgisdev\x26apiKey\x3dR_18b3867d45854ba98d9e0e7c20dbf6d3",share:{shareEmailSubject:"",shareTwitterTxt:"",languages:"ar cs da de en el es et fi fr he hr it ja ko lt lv nb nl pl pt-br pt-pt ro ru sr sv th tr zh-cn vi zh-hk zh-tw".split(" "),
DEFAULT_MOBILE_LAYOUT:600},_hasZoomLevelMarkerAdded:!1,_hasMapScaleMarkerAdded:!1,_hasAddMarkerMarkerAdded:!1,postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.shareLink;this.nls.symbol=window.jimuNls.common.symbol;this.nls.label=window.jimuNls.common.label;this.nls.WKID=window.jimuNls.common.wkid||"wkid";this.nls.popupTitle=window.jimuNls.shareLink.popupTitle||"Pop-up title";this.nls.zoomLevel=window.jimuNls.shareLink.zoomLevel||"Zoom level";this.share.shareEmailSubject=
this.nls.shareEmailSubject+" ${appTitle} ";this.share.shareTwitterTxt=this.nls.shareEmailSubject+"${appTitle}\n"},postCreate:function(){this.inherited(arguments);this._initUI();this._initMap();this._showSocialMediaLinksByConfig()},constructor:function(a){a&&(this._portalUrl=a.portalUrl,this._isOnline=a.isOnline,this._appTitle=a.appTitle,this._isShowBackBtn=a.isShowBackBtn,this._isShowSocialMediaLinks=a.isShowSocialMediaLinks,this._isSharedToPublic=a.isSharedToPublic,this._isShowFindLocation=a.isShowFindLocation,
this._config=a.config)},startup:function(){this.baseHrefUrl=this.getBaseHrefUrl(this._portalUrl);"undefined"===typeof this.optionSrc&&(this.optionSrc="currentMapExtent");this.updateUrl(null);this._initOptions();this._initOptionsEvent()},destroy:function(){this._cleanMarkerStatus();this._mapClickHandler&&(this._mapClickHandler=null);this.inherited(arguments)},onShareToPublicChanged:function(a){this._isSharedToPublic=a;this._isOnline&&this.updateUrl(null);this._isSharedToPublic?q.add(this.shareTips,
"displaynone"):q.remove(this.shareTips,"displaynone")},onCloseContainer:function(){this._cleanMarkerStatus()},updateShareLinkOptionsUI:function(a){a&&"undefined"!==typeof a.isShowFindLocation&&this.findLocationRow&&(!1===a.isShowFindLocation?q.add(this.findLocationRow,"displaynone"):!0===a.isShowFindLocation&&q.remove(this.findLocationRow,"displaynone"))},_initMap:function(){window.isBuilder?(this.own(g.subscribe("app/mapLoaded",k.hitch(this,this._onMapLoaded))),this.own(g.subscribe("app/mapChanged",
k.hitch(this,this._onMapLoaded)))):(this.own(g.subscribe("mapLoaded",k.hitch(this,this._onMapLoaded))),this.own(g.subscribe("mapChanged",k.hitch(this,this._onMapLoaded))));window._widgetManager.map&&(this.map=window._widgetManager.map,this._mapEventUpdateUrls(),this._addGraphicsLayer())},_onMapLoaded:function(a){this.map=a;this._mapEventUpdateUrls();this._addGraphicsLayer()},_mapEventUpdateUrls:function(){this.map&&(this.own(m(this.map,"pan-end",k.hitch(this,function(){this._mapEventHandler("pan-end")}))),
this.own(m(this.map,"resize",k.hitch(this,function(){this._mapEventHandler("resize")}))),this.own(m(this.map,"zoom-end",k.hitch(this,function(){this._mapEventHandler("zoom-end")}))))},_mapEventHandler:function(){this._isShareLinkOptionsShow()&&this.updateUrl()},_showSocialMediaLinksByConfig:function(){this._config&&this._config.socialMedias&&("undefined"!==typeof this._config.socialMedias.email&&!1===this._config.socialMedias.email&&q.add(this.emailShare,"displaynone"),"undefined"!==typeof this._config.socialMedias.facebook&&
!1===this._config.socialMedias.facebook&&q.add(this.FacebookShare,"displaynone"),"undefined"!==typeof this._config.socialMedias.twitter&&!1===this._config.socialMedias.twitter&&q.add(this.TwitterShare,"displaynone"),"undefined"!==typeof this._config.socialMedias.googlePlus&&!1===this._config.socialMedias.googlePlus&&q.add(this.googlePlusShare,"displaynone"))},_initUI:function(){this._isShowBackBtn?(n.set(this.backBtn,"title",window.jimuNls.common.back),this.own(m(this.backBtn,"click",k.hitch(this,
this._toggleLinkOptions)))):q.add(this.backBtn,"displaynone");!1===this._isShowSocialMediaLinks&&q.toggle(this.socialNetworkLinks,"displaynone");!0===this._isSharedToPublic&&q.toggle(this.shareTips,"displaynone");this.own(m(this.linkOptions,"click",k.hitch(this,this._toggleLinkOptions)));this._setInputsClicktoSelect(this._linkUrlTextBox);this.own(m(this.googlePlusShare,"click",k.hitch(this,this._toGooglePlus)));this._setInputsClicktoSelect(this._embedCodeTextArea);this._sizeOptions=new b({options:[{label:this.nls.smallSize,
value:"small",selected:!0},{label:this.nls.mediumSize,value:"medium",selected:!1},{label:this.nls.largeSize,value:"large",selected:!1},{label:this.nls.customSize,value:"custom",selected:!1}],"class":"sizeOptionsSelect"});this._sizeOptions.placeAt(this.SizeSelect);this.own(m(this._sizeOptions,"change",function(a){switch(a){case "small":this._widthTextBox.set("value",300);this._heightTextBox.set("value",200);q.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();break;case "medium":this._widthTextBox.set("value",
800);this._heightTextBox.set("value",600);q.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();break;case "large":this._widthTextBox.set("value",1080);this._heightTextBox.set("value",720);q.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();break;case "custom":q.remove(this.CustomSizeContainer,"disable")}}.bind(this)));this._widthTextBox=new v({"class":"sizeTextBox inputsText",value:300,constraints:{pattern:"#",places:0}});this._widthTextBox.placeAt(this.CustomSizeContainer,
1);this.own(m(this._widthTextBox,"change",function(a){200>a?this._widthTextBox.set("value",200>a?200:a):this._updateEmbedCodeFrameSize()}.bind(this)));this._heightTextBox=new v({"class":"sizeTextBox inputsText",value:200,constraints:{pattern:"#",places:0}});this._heightTextBox.placeAt(this.CustomSizeContainer,3);this.own(m(this._heightTextBox,"change",function(a){200>a?this._heightTextBox.set("value",200>a?200:a):this._updateEmbedCodeFrameSize()}.bind(this)));this.mobileLayout.set("value",this.share.DEFAULT_MOBILE_LAYOUT);
this.updateShareLinkOptionsUI({isShowFindLocation:this._isShowFindLocation});this._setInputsClicktoSelect(this.preview)},_setLinkUrl:function(a){this._linkUrlTextBox.set("value",a);n.set(this._linkUrlTextBox.domNode,"data-old",a)},_setEmbedCode:function(a){var b='\x3ciframe width\x3d"'+this._widthTextBox.value+'" height\x3d"'+this._heightTextBox.value+'" frameborder\x3d"0" scrolling\x3d"no" allowfullscreen src\x3d"';this._embedCodeTextArea.set("value",b+a+'"\x3e\x3c/iframe\x3e');n.set(this._embedCodeTextArea.domNode,
"data-old-shortened",a)},_updateEmbedCodeFrameSize:function(a){a=this._embedCodeTextArea.get("value");a=a.replace(/width=\"[0-9]*\"/i,'width\x3d"'+this._widthTextBox.value+'"');a=a.replace(/height=\"[0-9]*\"/i,'height\x3d"'+this._heightTextBox.value+'"');this._embedCodeTextArea.set("value",a)},_initOptions:function(){var a=[],b=this.map.getLevel();"number"===typeof b&&-1!==b?q.remove(this.chooseCenterWithLevelRow,"displaynone"):q.add(this.chooseCenterWithLevelRow,"displaynone");a=[];this.setlanguage_languages.removeOption(this.setlanguage_languages.getOptions());
h.forEach(this.share.languages,function(b){var c={label:b,value:b};c.selected=b===d.locale?!0:!1;a.push(c)});this.setlanguage_languages.addOption(a);b="";try{b=JSON.parse(r("esri_auth")).token}catch(c){console.log("ShareLink can't parse Auth:"+c)}b&&this.authtoken.set("value",b);b=new E({createMapResponse:this.map.webMapResponse,showLayerFromFeatureSet:!1,onlyShowVisible:!1,updateWhenLayerInfosIsShowInMapChanged:!1});q.add(b.domNode,"share-layerChooser-dropbox");this.layerChooserFromMapWithDropbox=
new H({layerChooser:b});this.layerChooserFromMapWithDropbox.placeAt(this.queryFeature_layer);this.own(m(this.layerChooserFromMapWithDropbox,"selection-change",k.hitch(this,this._updateQueryFeature_Layer)));"undefined"!==typeof this.map.spatialReference&&"undefined"!==typeof this.map.spatialReference.wkid&&this.addMarker_spatialReference.set("value",this.map.spatialReference.wkid)},_initOptionsEvent:function(){var a=c.has("ie")||c.has("edge")?"change":"KeyUp",b=e(".shareRadios",this.domNode);this.own(m(b,
"change",k.hitch(this,function(a){this.optionSrc=n.get(a.srcElement||a.target,"data-id");this.updateUrl()})));b=e(".shareCheckBoxes",this.domNode);this.own(m(b,"click",k.hitch(this,function(){this.updateUrl()})));this.own(m(this.chooseCenterWithLevel_levels,"change",k.hitch(this,function(){this.updateUrl()})));this.own(m(this.chooseCenterWithScale_scales,"change",k.hitch(this,function(){this.updateUrl()})));this.own(m(this.setlanguage_languages,"change",k.hitch(this,function(){this.updateUrl()})));
this.own(m(this.findLocation_input,a,k.hitch(this,this.updateUrl)));this.own(m(this.queryFeature_field,"change",k.hitch(this,this._updateQueryFeature_Value)));this.own(m(this.queryFeature_value,"change",k.hitch(this,this.updateUrl)));this.own(m(this.mobileLayout,a,k.hitch(this,this.updateUrl)));this.own(m(this.authtoken,a,k.hitch(this,this.updateUrl)));this.own(m(this.addMarker_marker,"click",k.hitch(this,function(a){this._onMarkersClick(a)})));this.own(m(this.addMarker_spatialReference,"change",
k.hitch(this,this.updateUrl)));this.own(m(this.addMarker_title,a,k.hitch(this,this.updateUrl)));this.own(m(this.addMarker_symbolURL,a,k.hitch(this,this.updateUrl)));this.own(m(this.addMarker_label,a,k.hitch(this,this.updateUrl)));this.own(m(this.addMarker_level,"change",k.hitch(this,this.updateUrl)));this.own(m(this.chooseCenterWithLevel_marker,"click",k.hitch(this,function(a){this._onMarkersClick(a)})));this.own(m(this.chooseCenterWithScale_marker,"click",k.hitch(this,function(a){this._onMarkersClick(a)})))},
_onMarkersClick:function(a){this._unselectMarkerBtn();this._selectMarkerBtn(a);this._hidePopup();this._removeGraphicsLayer();this._mapClickHandler=m.once(this.map,"click",k.hitch(this,this._onMapClick))},_onMapClick:function(a){var b=a.mapPoint;this._addGraphicsLayerMarker(a);"chooseCenterWithLevel"===this.optionSrc?this._hasZoomLevelMarkerAdded=!1:"chooseCenterWithScale"===this.optionSrc?this._hasMapScaleMarkerAdded=!1:"addMarker"===this.optionSrc&&(this._hasAddMarkerMarkerAdded=!1);this._unselectMarkerBtn();
this.updateUrl(b);this._showPopup()},_hidePopup:function(){g.publish("ShareLink/onHideContainer")},_showPopup:function(){g.publish("ShareLink/onShowContainer")},_updateResUrls:function(a){"currentMapExtent"===this.optionSrc?(a=this.getMapExtent(this.map),this.resultUrl=this._addQueryParamToUrl(this.baseHrefUrl,"extent",a,!0)):"chooseCenterWithLevel"===this.optionSrc?(!1===this._hasZoomLevelMarkerAdded&&(this.resultUrl=this._addQueryParamToUrl(this.baseHrefUrl,"center",this.getMapCenter(this.map,a),
!0),a&&(a.x&&a.y)&&(this._hasZoomLevelMarkerAdded=!0)),this.resultUrl=this._addQueryParamToUrl(this.resultUrl,"level",this._getMapLevel(),!0)):"chooseCenterWithScale"===this.optionSrc?(!1===this._hasMapScaleMarkerAdded&&(this.resultUrl=this._addQueryParamToUrl(this.baseHrefUrl,"center",this.getMapCenter(this.map,a),!0),a&&(a.x&&a.y)&&(this._hasMapScaleMarkerAdded=!0)),this.resultUrl=this._addQueryParamToUrl(this.resultUrl,"scale",this._getMapScale(),!0)):"findLocation"===this.optionSrc?(a=this.findLocation_input.get("value"),
this.resultUrl=this._addQueryParamToUrl(this.baseHrefUrl,"find",a,!0)):"queryFeature"===this.optionSrc?this._updateUrlByQueryFeatures():"addMarker"===this.optionSrc&&(!1===this._hasAddMarkerMarkerAdded?(this.resultUrl=this._addQueryParamToUrl(this.baseHrefUrl,"marker",this.getMapCenter(this.map,a,null,this._getWkid()),!0),this.resultUrl+=",",a&&(a.x&&a.y)&&(this._hasAddMarkerMarkerAdded=!0,this._lastAddMarkerParamObj=a)):(this.resultUrl=this._addQueryParamToUrl(this.baseHrefUrl,"marker",this.getMapCenter(this.map,
this._lastAddMarkerParamObj,null,this._getWkid()),!0),this.resultUrl+=","),this.resultUrl+=encodeURIComponent(this.addMarker_title.get("value")||""),this.resultUrl+=",",this.resultUrl+=encodeURIComponent(this.addMarker_symbolURL.get("value")||""),this.resultUrl+=",",this.resultUrl+=encodeURIComponent(this.addMarker_label.get("value")||""),a=this._getMapLevel(),this.resultUrl="number"===typeof a&&-1!==a?this._addQueryParamToUrl(this.resultUrl,"level",this._getMapLevel(),!0):this._addQueryParamToUrl(this.resultUrl,
"scale",this._getMapScale(),!0));this.resultUrl=this._removeQueryParamFromUrl(this.resultUrl,"mobileBreakPoint",!0);this.resultUrl=this._removeQueryParamFromUrl(this.resultUrl,"locale",!0);this.resultUrl=this._removeQueryParamFromUrl(this.resultUrl,"token",!0);this.overwirteMobileLayout.checked&&(this.resultUrl=this._addQueryParamToUrl(this.resultUrl,"mobileBreakPoint",this.mobileLayout.getValue(),!0));this.setlanguage.checked&&(this.resultUrl=this._addQueryParamToUrl(this.resultUrl,"locale",this.setlanguage_languages.getValue(),
!0));this.auth.checked&&(this.resultUrl=this._addQueryParamToUrl(this.resultUrl,"token",this.authtoken.getValue(),!0))},_updateUrlByQueryFeatures:function(){var a=this._getIdFromLayerChoose()||"",b=this.queryFeature_field.get("value"),c=this.queryFeature_value.get("value");this.resultUrl=this._addQueryParamToUrl(this.baseHrefUrl,"query",a,!0);b&&(this.resultUrl+=",",this.resultUrl+=b,c&&(this.resultUrl+=",",this.resultUrl+=c))},_updateQueryFeature_Layer:function(){this._updateUrlByQueryFeatures();
this._updateQueryFeature_Field();this._updateQueryFeature_Value();this.updateUrl()},_updateQueryFeature_Field:function(){var a=this._getFieldsFromLayerChoose(),b=[];this.queryFeature_field.removeOption(this.queryFeature_field.getOptions());h.forEach(a,k.hitch(this,function(a){-1<["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(a.type)&&b.push({label:a.name,value:a.name})}));this.queryFeature_field.addOption(b);this._updateUrlByQueryFeatures();
this._updateQueryFeature_Value();this.updateUrl()},_updateQueryFeature_Value:function(){var a=[],b=this.queryFeature_field.get("value");a.push(b);this._query(a,this._getUrlFromLayerChoose(),this.map).then(k.hitch(this,function(a){var c=[],c=this._getQueryedValues(b,a);this.queryFeature_value.removeOption(this.queryFeature_value.getOptions());this.queryFeature_value.addOption(c);this._updateUrlByQueryFeatures();this.updateUrl()}))},_getIdFromLayerChoose:function(){var a=null,b=this.layerChooserFromMapWithDropbox.getSelectedItem();
b&&(b.layerInfo&&b.layerInfo.id)&&(a=b.layerInfo.id);return a},_getFieldsFromLayerChoose:function(){var a=[],b=this.layerChooserFromMapWithDropbox.getSelectedItem();b&&(b.layerInfo&&b.layerInfo.layerObject&&b.layerInfo.layerObject.fields)&&(a=b.layerInfo.layerObject.fields);return a},_getUrlFromLayerChoose:function(){var a="",b=this.layerChooserFromMapWithDropbox.getSelectedItem();b&&b.url&&(a=b.url);return a},_updateLinkOptionsUI:function(){e(".optionsMore",this.domNode).style("display","none");
e("."+this.optionSrc+"_optionsMore",this.domNode).style("display","block");this.overwirteMobileLayout.checked&&e(".share-options-overwirteMobileLayout_optionsMore",this.domNode).style("display","block");this.setlanguage.checked&&e(".share-options-language_optionsMore",this.domNode).style("display","block");this.auth.checked&&e(".share-options-auth_optionsMore",this.domNode).style("display","block")},_fixUrlIfIsOnline:function(a){if(this._isOnline&&this._isSharedToPublic){var b=window.top.location.protocol,
c=this._getUrlQueryString(a);a=this._getOnlinePublicUrl(a);a=b+"//"+a+"/apps/webappviewer/index.html"+c}return a},updateUrl:function(a){this._updateResUrls(a);this._updateLinkOptionsUI();this.preview.set("value",this._fixUrlIfIsOnline(this.resultUrl));null===a&&this._generateShortenUrl()},_generateShortenUrl:function(){var a=this.preview.get("value");try{this.isUseShortenUrl()?this.shortenUrl(a,this.bitlyUrl,this.bitlyUrlSSL).then(k.hitch(this,function(a){this._useShortenUrl(a)}),k.hitch(this,function(b){this._useLengthenUrl(a,
b)})):this._useLengthenUrl(a)}catch(b){console.error(b)}},_useShortenUrl:function(a){this.shortenedUrl=a;this._setLinkUrl(a);this._setEmbedCode(a)},_useLengthenUrl:function(a){a=a||"";this._setLinkUrl(a);this._setEmbedCode(a)},_toFacebook:function(){var a="http://www.facebook.com/sharer/sharer.php?s\x3d100\x26u\x3d"+encodeURIComponent(this._linkUrlTextBox.get("value"))+"\x26t\x3d"+encodeURIComponent(c.stripHTML(this.socialNetworkTitle(this._appTitle)));window.open(a,"_blank")},_toTwitter:function(){var a=
t.substitute(this.share.shareTwitterTxt,{appTitle:c.stripHTML(this._appTitle)}),b=this._linkUrlTextBox.get("value");window.open("http://twitter.com/home?status\x3d"+encodeURIComponent(a+b+"\n@ArcGISOnline"),"_blank")},_toEmail:function(){var a="mailto:?subject\x3d"+t.substitute(this.share.shareEmailSubject,{appTitle:c.stripHTML(this._appTitle)}),b=this.preview.get("value"),a=a+("\x26body\x3d"+encodeURIComponent(this.nls.shareEmailTxt1)+"%0D%0A%0D%0A"+c.stripHTML(this._appTitle)),a=a+("%0D%0A"+encodeURIComponent(b)),
a=a+("%0D%0A%0D%0A"+encodeURIComponent(this.nls.shareEmailTxt2)),a=a+("%0D%0A%0D%0A"+encodeURIComponent(this.nls.shareEmailTxt3));window.top.location.href=a},_toGooglePlus:function(){var a=this._linkUrlTextBox.get("value"),a="http://plus.google.com/share?url\x3d"+encodeURIComponent(a);window.open(a,"_blank")},_toggleLinkOptions:function(){var a=e(".shareOptionsWrapper",this.domNode.parentNode||this.domNode.parentElement),b=e(".shareUrlsWrapper",this.domNode),c=e(".shareLinkOptionsWrapper",this.domNode);
this._isShareLinkOptionsShow()?(g.publish("ShareLink/onHideLinkOptions"),this._cleanMarkerStatus(),this._generateShortenUrl()):g.publish("ShareLink/onShowLinkOptions");a&&a[0]&&q.toggle(a[0],"displaynone");q.toggle(b[0],"displaynone");q.toggle(c[0],"displaynone")},_moreOptionsExpandCollapse:function(){q.toggle(this.MoreOptionsContainer,"displaynone");q.toggle(this.MoreOptionsIcon,"rotate")},_setInputsClicktoSelect:function(a){n.set(a,"onclick","this.select()");n.set(a,"onmouseup","return false;")},
isUseShortenUrl:function(){return location.hostname.endWith("esri.com")||location.hostname.endWith("arcgis.com")?!0:!1},shortenUrl:function(a,b,c){var d=new w;"https:"===location.protocol&&(b=c);b+="\x26longUrl\x3d"+escape(a)+"\x26format\x3djson";x({url:b,handleAs:"json",callbackParamName:"callback"}).then(k.hitch(this,function(a){a&&200===a.status_code&&a.data&&a.data.url&&0<a.data.url.length?d.resolve(a.data.url):d.reject(a)}),k.hitch(this,function(a){console.log("can't fetch shortenUrl "+a);d.reject(a)}));
return d},socialNetworkTitle:function(a){100<a.length&&(a=a.substring(0,97)+"...");return a},getMapExtent:function(a){a=a.extent;return null!==a?this._roundValue(a.xmin,1E4)+","+this._roundValue(a.ymin,1E4)+","+this._roundValue(a.xmax,1E4)+","+this._roundValue(a.ymax,1E4)+","+a.spatialReference.wkid:""},_roundValue:function(a,b){return Math.round(a*b)/b},getMapCenter:function(a,b,c,d){c=c?c:",";var e=null;b&&b.x&&b.y?e=b:a.extent.getCenter()&&(e=a.extent.getCenter());a=d||e.spatialReference.wkid;
return null!==e?this._roundValue(e.x,1E4)+c+this._roundValue(e.y,1E4)+c+a:""},_getMapLevel:function(){return this.map.getLevel()},_getMapScale:function(){return this.map.getScale()},_getWkid:function(){return this.addMarker_spatialReference.get("value")||""},_query:function(a,b,c){var d=new z;d.where="1\x3d1";d.outSpatialReference=c.spatialReference;d.outFields=a;return(new y(b)).execute(d)},_getQueryedValues:function(a,b){var c=[];h.forEach(b.features,k.hitch(this,function(b){b=b.attributes[a]+"";
c.push({label:b,value:b})}));return c},getBaseHrefUrl:function(a){var b="HTML3D"===window.appInfo.appType?"webappviewer3d":"webappviewer",d="";window.isXT?d=window.location.protocol+"//"+window.location.host+window.appInfo.appPath:(d=c.urlToObject(window.location.href).query||{},d=d.appid?a+"apps/"+b+"/index.html?appid\x3d"+d.appid:d.id?a+"apps/"+b+"/index.html?id\x3d"+d.id:window.top.location.href);return d},_addGraphicsLayer:function(){!window.isBuilder&&"undefined"===typeof this._graphicsLayer&&
(this._graphicsLayer=new F,this.map.addLayer(this._graphicsLayer))},_removeGraphicsLayer:function(){!window.isBuilder&&"undefined"!==typeof this._graphicsLayer&&(this._graphicsLayer.remove(this._markerGraphic),this._markerGraphic=null)},_addGraphicsLayerMarker:function(a){!window.isBuilder&&"undefined"!==typeof this._graphicsLayer&&(this._markerGraphic=this._getMarkerGraphic(a.mapPoint),this._graphicsLayer.add(this._markerGraphic))},_getMarkerGraphic:function(a){var b=new A(require.toUrl("jimu")+
"/images/EsriBluePinCircle26.png",26,26);b.setOffset(0,12);return new B(a,b)},_unselectMarkerBtn:function(){for(var a=e(".markers",this.domNode),b=0,c=a.length;b<c;b++)q.remove(a[b],"selected")},_selectMarkerBtn:function(a){q.add(a.srcElement||a.target,"selected")},_cleanMarkerStatus:function(){this._mapClickHandler&&this._mapClickHandler.remove&&this._mapClickHandler.remove();this._unselectMarkerBtn();this._removeGraphicsLayer()},_isShareLinkOptionsShow:function(){var a=e(".shareLinkOptionsWrapper",
this.domNode);return!q.contains(a[0],"displaynone")},_getUrlQueryString:function(a){var b="";-1!==a.indexOf("?")&&(b=a.substring(a.indexOf("?")));return b},_getOnlinePublicUrl:function(){var a="www.arcgis.com",b=this._portalUrl;b&&"string"===typeof b&&(-1<b.indexOf("devext.arcgis.com")?a="devext.arcgis.com":-1<b.indexOf("qaext.arcgis.com")&&(a="qaext.arcgis.com"));return a},_addQueryParamToUrl:function(a,b,c,d){a=u.urlToObject(a);a.query||(a.query={});a.query[b]=c;b=a.path;for(var e in a.query)c=
a.query[e],!0===d&&(c=encodeURIComponent(c)),b=b===a.path?b+"?"+e+"\x3d"+c:b+"\x26"+e+"\x3d"+c;return b},_removeQueryParamFromUrl:function(a,b,c){a=u.urlToObject(a);a.query&&delete a.query[b];b=a.path;for(var d in a.query){var e=a.query[d];!0===c&&(e=encodeURIComponent(e));b=b===a.path?b+"?"+d+"\x3d"+e:b+"\x26"+d+"\x3d"+e}return b}})})},"jimu/dijit/FeaturelayerChooserFromMap":function(){define(["dojo/_base/declare","dojo/Deferred","dojo/_base/html","dojo/_base/lang","./LayerChooserFromMap"],function(p,
f,a,l,k){return p([k],{baseClass:"jimu-featurelayer-chooser-from-map",declaredClass:"jimu.dijit.FeaturelayerChooserFromMap",types:null,showLayerFromFeatureSet:!1,showTable:!1,onlyShowVisible:!1,postMixInProperties:function(){this.inherited(arguments);this.basicFilter=l.hitch(this,this.basicFilter);this.filter=k.createFeaturelayerFilter(this.types,this.showLayerFromFeatureSet,this.showTable)},postCreate:function(){this.inherited(arguments);a.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},
basicFilter:function(a){var k=new f;this.onlyShowVisible&&"Table"!==a.getLayerType()?k.resolve(a.isShowInMap()):k.resolve(!0);return k},getHandledItem:function(a){var f=this.inherited(arguments),k=a&&a.layerInfo,k=k&&k.layerObject;f.url=k&&k.url||"";return f}})})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/on dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v){var n=p([f,a,l,k],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,
updateWhenLayerInfosIsShowInMapChanged:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);r.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new v({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=d.hitch(this,this.basicFilter);this.filter=n.andCombineFilters([this.basicFilter,this.filter]);this.createMapResponse&&
this.setCreateMapResponse(this.createMapResponse)},basicFilter:function(a){var b=new m;this.onlyShowVisible?b.resolve(a.isShowInMap()):b.resolve(!0);return b},filter:function(a){a=new m;a.resolve(!0);return a},getSelectedItems:function(){var a=this.tree.getSelectedItems();return u.map(a,d.hitch(this,function(a){return this.getHandledItem(a)}))},getAllItems:function(){var a=this.tree.getAllItems(),b=[];u.forEach(a,d.hitch(this,function(a){"root"!==a.id&&(a=this.getHandledItem(a),b.push(a))}));return b},
getHandledItem:function(a){return{name:a.name,layerInfo:a.layerInfo}},_isLeafItem:function(a){return a.isLeaf},setCreateMapResponse:function(a){this.createMapResponse=a;b.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(d.hitch(this,function(a){this.layerInfosObj=a;this.own(h(this.layerInfosObj,"layerInfosChanged",d.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&this.own(h(this.layerInfosObj,"layerInfosIsShowInMapChanged",d.hitch(this,
this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(a,b){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(a){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(a){this._clear();r.setStyle(this.errorTipSection,"display","block");var b=a.getLayerInfoArray(),b=b.concat(a.getTableInfoArray());0!==b.length&&(r.setStyle(this.errorTipSection,"display","none"),u.forEach(b,d.hitch(this,
function(a){this._addDirectLayerInfo(a)})))},_addDirectLayerInfo:function(a){a&&a.getLayerObject().then(d.hitch(this,function(){this._addItem("root",a)}),d.hitch(this,function(a){console.error(a)}))},_clear:function(){var a=this._store.query({parent:"root"});u.forEach(a,d.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_addItem:function(a,b){var e=null,f=b.getLayerType(),g=this.filter(b);c({layerType:f,valid:g}).then(d.hitch(this,function(f){if(f.valid){var g=d.hitch(this,function(c,
d){this._id++;e={name:b.title||"",parent:a,layerInfo:b,type:f.layerType,layerClass:b.layerObject.declaredClass,id:this._id.toString(),isLeaf:c,hasChildren:d};this._store.add(e)}),h=b.getSubLayers(),k=0===h.length;k?g(k,!1):(h=u.map(h,d.hitch(this,function(a){return this.filter(a)})),c(h).then(d.hitch(this,function(a){(a=u.some(a,function(a){return a}))&&g(k,a)})))}}))},_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var a=this._getRootItem(),
a=new q({data:[a],getChildren:function(a){return this.query({parent:a.id})}});this._store=new g(a);a=new e({store:this._store,query:{id:"root"},mayHaveChildren:d.hitch(this,this._mayHaveChildren)});this.tree=new t({multiple:this.multiple,model:a,showRoot:!1,isLeafItem:d.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:d.hitch(this,function(a,b){"root"!==a.id&&this._onTreeOpen(a,b)}),onClick:d.hitch(this,function(a,b,c){this._onTreeClick(a,b,c);this.emit("tree-click",a,b,c)}),getIconStyle:d.hitch(this,
function(a,b){var c=null;if(!a||"root"===a.id)return null;var d={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},e=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),f=this._getIconImageName(a,b);f&&(d.backgroundImage="url("+e+"/css/images/"+f+")",c=d);return c})});r.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(a){return a.hasChildren},_getIconImageName:function(a,
b){var c="";if("ArcGISDynamicMapServiceLayer"===a.type||"ArcGISTiledMapServiceLayer"===a.type)c=b?"mapserver_open.png":"mapserver_close.png";else if("GroupLayer"===a.type)c=b?"group_layer2.png":"group_layer1.png";else if("FeatureLayer"===a.type){var d=s.getTypeByGeometryType(a.layerInfo.layerObject.geometryType);"point"===d?c="point_layer1.png":"polyline"===d?c="line_layer1.png":"polygon"===d&&(c="polygon_layer1.png")}else c="Table"===a.type?"table.png":"ArcGISImageServiceLayer"===a.type||"ArcGISImageServiceVectorLayer"===
a.type?"image_layer.png":b?"mapserver_open.png":"mapserver_close.png";return c},_onTreeOpen:function(a,b){if("root"!==a.id){var e=[],f=[],e=a.layerInfo.getSubLayers();a.checked||(this.shelter.show(),f=u.map(e,d.hitch(this,function(a){return a.getLayerObject()})),c(f).then(d.hitch(this,function(){this.domNode&&(u.forEach(e,d.hitch(this,function(b){this._addItem(a.id,b)})),a.checked=!0,this.shelter.hide())}),d.hitch(this,function(a){console.error(a);this.shelter.hide()})))}},_onTreeClick:function(a,
b,c){},destroy:function(){this.shelter&&this.shelter.destroy();this.tree&&this.tree.destroy();this.shelter=null;this.tree.destroy();this.inherited(arguments)}});n.createFilterByLayerType=function(a){d.isArrayLike(a)||(a=[]);return function(b){var d=new m;if(0===a.length)d.resolve(!0);else{var e=[];b.traversal(function(a){e.push(a.getLayerType())});c(e).then(function(b){for(var c=0;c<b.length;c++)for(var e=0;e<a.length;e++)if(b[c]===a[e]){d.resolve(!0);return}d.resolve(!1)},function(a){console.error(a);
d.reject(a)})}return d}};n.createFeaturelayerFilter=function(a,b,d){var e=["point","polyline","polygon"];a&&0<a.length?(a=u.filter(a,function(a){return 0<=e.indexOf(a)}),0===a.length&&(a=e)):a=e;return function(e){var f=new m,g=e.getLayerType();e=e.getLayerObject();c({layerType:g,layerObject:e}).then(function(c){var e=c.layerType;c=c.layerObject;"ArcGISDynamicMapServiceLayer"===e?f.resolve(!0):"ArcGISTiledMapServiceLayer"===e?f.resolve(!0):"GroupLayer"===e?f.resolve(!0):"FeatureCollection"===e?f.resolve(!0):
"FeatureLayer"===e?(e=s.getTypeByGeometryType(c.geometryType),e=0<=u.indexOf(a,e),c.url?(c=s.isFeaturelayerUrlSupportQuery(c.url,c.capabilities),f.resolve(e&&c)):f.resolve(b&&e)):"Table"===e?(c=s.isFeaturelayerUrlSupportQuery(c.url,c.capabilities),f.resolve(d&&c)):f.resolve(!1)},function(a){console.log(a);f.reject(a)});return f}};n.createImageServiceLayerFilter=function(a){return function(b){var d=new m,e=b.getLayerType();b=b.getLayerObject();c({layerType:e,layerObject:b}).then(function(b){var c=
b.layerType;"ArcGISImageServiceLayer"===c||"ArcGISImageServiceVectorLayer"===c?a?s.isImageServiceSupportQuery(b.layerObject.capabilities)?d.resolve(!0):d.resolve(!1):d.resolve(!0):d.resolve(!1)},function(a){console.log(a);d.reject(a)});return d}};n.createQueryableLayerFilter=function(){var a=n.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0),b=n.createImageServiceLayerFilter(!0);return n.orCombineFilters([a,b])};n.andCombineFilters=function(a){return n._combineFilters(a,!0)};n.orCombineFilters=
function(a){return n._combineFilters(a,!1)};n._combineFilters=function(a,b){return function(d){var e=new m,f=u.map(a,function(a){return a(d)});c(f).then(function(a){var c=!1,c=b?u.every(a,function(a){return a}):u.some(a,function(a){return a});e.resolve(c)},function(a){console.error(a);e.reject(a)});return e}};return n})},"dojo/store/Observable":function(){define(["../_base/kernel","../_base/lang","../when","../_base/array"],function(p,f,a,l){p=function(k){function h(c,d){var f=k[c];f&&(k[c]=function(g){var h;
"put"===c&&(h=k.getIdentity(g));if(e)return f.apply(this,arguments);e=!0;try{var l=f.apply(this,arguments);a(l,function(a){d("object"==typeof a&&a||g,h)});return l}finally{e=!1}})}var p=[],m=0;k=f.delegate(k);k.notify=function(a,d){m++;for(var e=p.slice(),f=0,g=e.length;f<g;f++)e[f](a,d)};var g=k.query;k.query=function(c,d){d=d||{};var e=g.apply(this,arguments);if(e&&e.forEach){var h=f.mixin({},d);delete h.start;delete h.count;var s=k.queryEngine&&k.queryEngine(c,h),t=m,b=[],v;e.observe=function(c,
f){1==b.push(c)&&p.push(v=function(c,g){a(e,function(a){var e=a.length!=d.count,h,n;if(++t!=m)throw Error("Query is out of date, you must observe() the query prior to any data modifications");var p,q=-1,r=-1;if(void 0!==g){var u=[].concat(a);s&&!c&&(u=s(a));h=0;for(n=a.length;h<n;h++){var v=a[h];if(k.getIdentity(v)==g&&!(0>u.indexOf(v))){p=v;q=h;(s||!c)&&a.splice(h,1);break}}}if(s){if(c&&(s.matches?s.matches(c):s([c]).length))h=-1<q?q:a.length,a.splice(h,0,c),r=l.indexOf(s(a),c),a.splice(h,1),d.start&&
0==r||!e&&r==a.length?r=-1:a.splice(r,0,c)}else c&&(void 0!==g?r=q:d.start||(r=k.defaultIndex||0,a.splice(r,0,c)));if((-1<q||-1<r)&&(f||!s||q!=r)){e=b.slice();for(h=0;a=e[h];h++)a(c||p,q,r)}})});var g={};g.remove=g.cancel=function(){var a=l.indexOf(b,c);-1<a&&(b.splice(a,1),b.length||p.splice(l.indexOf(p,v),1))};return g}}return e};var e;h("put",function(a,d){k.notify(a,d)});h("add",function(a){k.notify(a)});h("remove",function(a){k.notify(void 0,a)});return k};f.setObject("dojo.store.Observable",
p);return p})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(p,f,a,l,k,h,q){return a("dijit.tree.ObjectStoreModel",q,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(a){k.mixin(this,a);this.childrenCache={}},getRoot:function(a,f){if(this.root)a(this.root);else{var e=this.store.query(this.query);e.then&&this.own(e);h(e,k.hitch(this,function(c){if(1!=
c.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+c.length+" items, but must return exactly one");this.root=c[0];a(this.root);e.observe&&e.observe(k.hitch(this,function(a){this.onChange(a)}),!0)}),f)}},mayHaveChildren:function(){return!0},getChildren:function(a,f,e){var c=this.store.getIdentity(a);if(this.childrenCache[c])h(this.childrenCache[c],f,e);else{var d=this.childrenCache[c]=this.store.getChildren(a);d.then&&this.own(d);d.observe&&this.own(d.observe(k.hitch(this,function(c,
e,f){this.onChange(c);e!=f&&h(d,k.hitch(this,"onChildrenChange",a))}),!0));h(d,f,e)}},isItem:function(){return!0},getIdentity:function(a){return this.store.getIdentity(a)},getLabel:function(a){return a[this.labelAttr]},newItem:function(a,f,e,c){return this.store.put(a,{parent:f,before:c})},pasteItem:function(a,f,e,c,d,h){var q=new l;if(f===e&&!c&&!h)return q.resolve(!0),q;f&&!c?this.getChildren(f,k.hitch(this,function(c){c=[].concat(c);var d=p.indexOf(c,a);c.splice(d,1);this.onChildrenChange(f,c);
q.resolve(this.store.put(a,{overwrite:!0,parent:e,oldParent:f,before:h}))})):q.resolve(this.store.put(a,{overwrite:!0,parent:e,oldParent:f,before:h}));return q},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s){var t=p([u._TreeNode,d],{templateString:l,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);h.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=h.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=h.toDom('\x3cinput type\x3d"checkbox" /\x3e');h.addClass(this.checkNode,"jimu-tree-check-node");h.place(this.checkNode,this.contentNode,
"first");this.own(c(this.checkNode,"click",k.hitch(this,this._onClick)));this.isLeaf?this.groupId?h.setStyle(this.checkNode,"display","none"):h.setStyle(this.checkNode,"display","inline"):h.setStyle(this.checkNode,"display","none");this.isLeaf?h.addClass(this.domNode,"jimu-tree-leaf-node"):h.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&(this.checkNode.checked=!0,h.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=
!1,h.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(a){(a.target||a.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,a):this.tree._onClick(this,a)},_onChange:function(){this.isLeaf&&setTimeout(k.hitch(this,function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;
this.inherited(arguments)}});return p([u,d],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+s.getRandomString()},postCreate:function(){this.inherited(arguments);h.addClass(this.domNode,"jimu-tree");this.own(e.before(this,"onClick",k.hitch(this,this._jimuBeforeClick)));this.rootLoadingIndicator&&h.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0},removeItem:function(a){this.model.store.remove(a)},
getAllItems:function(){var a=this.getAllTreeNodeWidgets();return q.map(a,k.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}))},getSelectedItems:function(){var a=this.getAllTreeNodeWidgets(),a=q.filter(a,k.hitch(this,function(a){return a.checkNode.checked}));return q.map(a,k.hitch(this,function(a){return a.item}))},getFilteredItems:function(a){var c=this.getAllTreeNodeWidgets(),c=q.map(c,k.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}));return q.filter(c,
k.hitch(this,function(c){return a(c)}))},getTreeNodeByItemId:function(a){for(var c=this._getAllTreeNodeDoms(),d=0;d<c.length;d++){var e=r.byNode(c[d]);if(e.item.id.toString()===a.toString())return e}return null},selectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&this.selectNodeWidget(a)},unselectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&a.unselect()},getAllLeafTreeNodeWidgets:function(){var a=this.getAllTreeNodeWidgets();return q.filter(a,k.hitch(this,function(a){return a.isLeaf}))},
getAllTreeNodeWidgets:function(){var a=this._getAllTreeNodeDoms();return q.map(a,k.hitch(this,function(a){return r.byNode(a)}))},isLeafItem:function(a){return a&&a.isLeaf},_getAllTreeNodeDoms:function(){return g(".dijitTreeNode",this.domNode)},_createTreeNode:function(a){a.isLeaf=this.isLeafItem(a.item);this.multiple||(a.groupId=this.uniqueId);return new t(a)},_onTreeNodeSelect:function(a){this.emit("item-select",{item:a.item,treeNode:a})},_onTreeNodeUnselect:function(a){this.emit("item-unselect",
{item:a.item,treeNode:a})},selectNodeWidget:function(a){this.multiple||this.unselectAllLeafNodeWidgets();a.select()},_jimuBeforeClick:function(a,c,d){c.isLeaf&&(h.hasClass(d.target||d.srcElement,"jimu-tree-check-node")||(this.multiple?c.toggleSelect():this.selectNodeWidget(c)));return arguments},_onCheckNodeClick:function(a,c,d){!this.multiple&&c&&this.unselectAllLeafNodeWidgets();m.stop(d);this.focusNode(a);setTimeout(k.hitch(this,function(){c?this.selectNodeWidget(a):a.unselect();this.onClick(a.item,
a,d)}),0)},unselectAllLeafNodeWidgets:function(){var a=this.getAllLeafTreeNodeWidgets();q.forEach(a,k.hitch(this,function(a){a.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A,B,F,E,H,I,M,Q,K,J,O,G){function T(a){return t.delegate(a.promise||a,{addCallback:function(a){this.then(a)},addErrback:function(a){this.otherwise(a)}})}var P=l("dijit._TreeNode",[B,F,E,H,I],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a);r("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:Q,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var b=Math.max(a,0)*this.tree._nodePixelIndent+"px";e.set(this.domNode,
"backgroundPosition",b+" 0px");e.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",b);p.forEach(this.getChildren(),function(b){b.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var b=this.tree,c=b.model;b._v10Compat&&a===c.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(a,b,c){var d="_"+b+"Class";b+="Node";var f=this[d];this[d]=this.tree["get"+c+"Class"](a,this.isExpanded);m.replace(this[b],this[d]||"",f||"");e.set(this[b],this.tree["get"+c+"Style"](a,this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent(),a=!a||!a.rowNode||"none"==a.rowNode.style.display;m.toggle(this.domNode,"dijitTreeIsRoot",a);m.toggle(this.domNode,"dijitTreeIsLast",!a&&!this.getNextSibling())},_setExpando:function(a){var b=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];a=a?0:this.isExpandable?this.isExpanded?1:2:3;m.replace(this.expandoNode,b[a],b);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return T(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");m.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var a=d.wipeIn({node:this.containerNode,duration:A.defaultDuration}),b=this._expandDeferred=new k(function(){a.stop()});f.after(a,"onEnd",function(){b.resolve(!0)},!0);a.play();return T(b)},collapse:function(){if(this._collapseDeferred)return T(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");m.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var a=d.wipeOut({node:this.containerNode,duration:A.defaultDuration}),b=this._collapseDeferred=new k(function(){a.stop()});f.after(a,"onEnd",
function(){b.resolve(!0)},!0);a.play();return T(b)},indent:0,setChildItems:function(a){var b=this.tree,c=b.model,d=[],e=b.focusedChild,f=this.getChildren();p.forEach(f,function(a){E.prototype.removeChild.call(this,a)},this);this.defer(function(){p.forEach(f,function(a){if(!a._destroyed&&!a.getParent()){b.dndController.removeTreeNode(a);var d=function(a){var e=c.getIdentity(a.item),f=b._itemNodesMap[e];1==f.length?delete b._itemNodesMap[e]:(e=p.indexOf(f,a),-1!=e&&f.splice(e,1));p.forEach(a.getChildren(),
d)};d(a);if(b.persist){var f=p.map(a.getTreePath(),function(a){return b.model.getIdentity(a)}).join("/"),g;for(g in b._openedNodes)g.substr(0,f.length)==f&&delete b._openedNodes[g];b._saveExpandedNodes()}b.lastFocusedChild&&!q.isDescendant(b.lastFocusedChild,b.domNode)&&delete b.lastFocusedChild;e&&!q.isDescendant(e,b.domNode)&&b.focus();a.destroyRecursive()}})});this.state="Loaded";a&&0<a.length?(this.isExpandable=!0,p.forEach(a,function(a){var e=c.getIdentity(a),f=b._itemNodesMap[e],g;if(f)for(var h=
0;h<f.length;h++)if(f[h]&&!f[h].getParent()){g=f[h];g.set("indent",this.indent+1);break}g||(g=this.tree._createTreeNode({item:a,tree:b,isExpandable:c.mayHaveChildren(a),label:b.getLabel(a),labelType:b.model&&b.model.labelType||"text",tooltip:b.getTooltip(a),ownerDocument:b.ownerDocument,dir:b.dir,lang:b.lang,textDir:b.textDir,indent:this.indent+1}),f?f.push(g):b._itemNodesMap[e]=[g]);this.addChild(g);(this.tree.autoExpand||this.tree._state(g))&&d.push(b._expandNode(g))},this),p.forEach(this.getChildren(),
function(a){a._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);a=h(d);this.tree._startPaint(a);return T(a)},getTreePath:function(){for(var a=this,b=[];a&&a!==this.tree.rootNode;)b.unshift(a.item),a=a.getParent();b.unshift(this.tree.rootNode.item);return b},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var b=this.getChildren();0==b.length&&(this.isExpandable=!1,
this.collapse());p.forEach(b,function(a){a._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");m.toggle(this.rowNode,"dijitTreeRowSelected",a)},focus:function(){z.focus(this.focusNode)}});r("dojo-bidi")&&P.extend({_setTextDirAttr:function(a){if(a&&(this.textDir!=a||!this._created))this._set("textDir",a),this.applyTextDir(this.labelNode),p.forEach(this.getChildren(),function(b){b.set("textDir",
a)},this)}});var V=l("dijit.Tree",[B,M,F,I],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:K,persist:!1,autoExpand:!1,dndController:G,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,
dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,b){v.publish(this.id,t.mixin({tree:this,event:a},b||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new k;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(b(this.containerNode,
b.selector(".dijitTreeNode",n.enter),function(b){a._onNodeMouseEnter(y.byNode(this),b)}),b(this.containerNode,b.selector(".dijitTreeNode",n.leave),function(b){a._onNodeMouseLeave(y.byNode(this),b)}),b(this.containerNode,b.selector(".dijitTreeRow",x.press),function(b){a._onNodePress(y.getEnclosingWidget(this),b)}),b(this.containerNode,b.selector(".dijitTreeRow",x),function(b){a._onClick(y.getEnclosingWidget(this),b)}),b(this.containerNode,b.selector(".dijitTreeRow","dblclick"),function(b){a._onDblClick(y.getEnclosingWidget(this),
b)}));this.model||this._store2model();this.own(f.after(this.model,"onChange",t.hitch(this,"_onItemChange"),!0),f.after(this.model,"onChildrenChange",t.hitch(this,"_onItemChildrenChange"),!0),f.after(this.model,"onDelete",t.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){t.isString(this.dndController)&&(this.dndController=t.getObject(this.dndController));for(var c={},d=0;d<this.dndParams.length;d++)this[this.dndParams[d]]&&(c[this.dndParams[d]]=this[this.dndParams[d]]);
this.dndController=new this.dndController(this,c)}this._load();this.onLoadDeferred=T(this.pendingCommandsPromise);this.onLoadDeferred.then(t.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;u.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(a.mayHaveChildren=t.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&
(a.getChildren=t.hitch(this,function(a,b,c){this.getItemChildren(this._v10Compat&&a===this.model.root?null:a,b,c)}));this.model=new O(a);this.showRoot=Boolean(this.label)},onLoad:function(){},_load:function(){this.model.getRoot(t.hitch(this,function(a){var b=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",
!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(b.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(b.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(b.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),
b.labelNode.setAttribute("role","presentation"),b.labelNode.removeAttribute("aria-selected"),b.containerNode.setAttribute("role","tree"),b.containerNode.setAttribute("aria-expanded","true"),b.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(b.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(b):this._itemNodesMap[a]=[b];b._updateLayout();this._expandNode(b).then(t.hitch(this,function(){this._destroyed||
(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),t.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){if(!a)return[];a=t.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var b=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(t.hitch(this,function(){var c=
p.map(a,function(a){return!a||t.isString(a)?a:b.model.getIdentity(a)}),d=[];p.forEach(c,function(a){d=d.concat(b._itemNodesMap[a]||[])});this.set("selectedNodes",d)}))},_setPathAttr:function(a){return a.length?T(this.set("paths",[a]).then(function(a){return a[0]})):T(this.set("paths",[]).then(function(a){return a[0]}))},_setPathsAttr:function(a){function b(a,d){var e=a.shift(),f=p.filter(d,function(a){return a.getIdentity()==e})[0];if(f)return a.length?c._expandNode(f).then(function(){return b(a,
f.getChildren())}):f;throw new V.PathError("Could not expand path at "+e);}var c=this;return T(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return h(p.map(a,function(a){a=p.map(a,function(a){return a&&t.isObject(a)?c.model.getIdentity(a):a});if(a.length)return b(a,[c.rootNode]);throw new V.PathError("Empty path");}))}).then(function(a){c.set("selectedNodes",a);return c.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},
expandAll:function(){function a(c){return b._expandNode(c).then(function(){var b=p.filter(c.getChildren()||[],function(a){return a.isExpandable});return h(p.map(b,a))})}var b=this;return T(a(this.rootNode))},collapseAll:function(){function a(c){var d=p.filter(c.getChildren()||[],function(a){return a.isExpandable}),d=h(p.map(d,a));return!c.isExpanded||c==b.rootNode&&!b.showRoot?d:d.then(function(){return b._collapseNode(c)})}var b=this;return T(a(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},
getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,b){return!a||this.model.mayHaveChildren(a)?b?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,b){var c=this._getNext(b);c&&c.isTreeNode&&this.focusNode(c)},_onUpArrow:function(a,b){var c=b.getPreviousSibling();if(c)for(b=c;b.isExpandable&&
b.isExpanded&&b.hasChildren();)c=b.getChildren(),b=c[c.length-1];else if(c=b.getParent(),this.showRoot||c!==this.rootNode)b=c;b&&b.isTreeNode&&this.focusNode(b)},_onRightArrow:function(a,b){b.isExpandable&&!b.isExpanded?this._expandNode(b):b.hasChildren()&&(b=b.getChildren()[0])&&b.isTreeNode&&this.focusNode(b)},_onLeftArrow:function(a,b){if(b.isExpandable&&b.isExpanded)this._collapseNode(b);else{var c=b.getParent();c&&(c.isTreeNode&&(this.showRoot||c!==this.rootNode))&&this.focusNode(c)}},focusLastChild:function(){var a=
this._getLast();a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var b=a.getChildren();if(!b.length)break;a=b[b.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var b=a.getNextSibling();if(b)return b;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(a,
b){return q.isDescendant(a,b.expandoNode)||q.isDescendant(a,b.expandoNodeText)},_onNodePress:function(a,b){this.focusNode(a)},__click:function(a,b,c,d){var e=this.isExpandoNode(b.target,a);a.isExpandable&&(c||e)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this[d](a.item,a,b),this.focusNode(a));b.stopPropagation();b.preventDefault()},_onClick:function(a,b){this.__click(a,b,this.openOnClick,"onClick")},_onDblClick:function(a,b){this.__click(a,b,this.openOnDblClick,
"onDblClick")},_onExpandoClick:function(a){a=a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(a){u.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(a)},_getRootOrFirstNode:function(){u.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","",
"2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&delete a._expandNodeDeferred;if("Loading"!=a.state&&a.isExpanded){var b=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(b);return b}},_expandNode:function(a){if(a._expandNodeDeferred)return a._expandNodeDeferred;var b=this.model,c=a.item,d=this;a._loadDeferred||(a.markProcessing(),a._loadDeferred=new k,b.getChildren(c,function(b){a.unmarkProcessing();a.setChildItems(b).then(function(){a._loadDeferred.resolve(b)})},
function(b){console.error(d,": error loading "+a.label+" children: ",b);a._loadDeferred.reject(b)}));b=a._loadDeferred.then(t.hitch(this,function(){var b=a.expand();this.onOpen(a.item,a);this._state(a,!0);return b}));this._startPaint(b);return b},focusNode:function(a){var b=this.domNode.scrollLeft;this.focusChild(a);this.domNode.scrollLeft=b},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var b=this.model.getIdentity(a);if(b=this._itemNodesMap[b]){var c=this.getLabel(a),
d=this.getTooltip(a);p.forEach(b,function(b){b.set({item:a,label:c,tooltip:d});b._updateItemClasses(a)})}},_onItemChildrenChange:function(a,b){var c=this.model.getIdentity(a);(c=this._itemNodesMap[c])&&p.forEach(c,function(a){a.setChildItems(b)})},_onItemDelete:function(a){a=this.model.getIdentity(a);var b=this._itemNodesMap[a];b&&(p.forEach(b,function(a){this.dndController.removeTreeNode(a);var b=a.getParent();b&&b.removeChild(a);this.lastFocusedChild&&!q.isDescendant(this.lastFocusedChild,this.domNode)&&
delete this.lastFocusedChild;this.focusedChild&&!q.isDescendant(this.focusedChild,this.domNode)&&this.focus();a.destroyRecursive()},this),delete this._itemNodesMap[a])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var b=a(this.cookieName);b&&p.forEach(b.split(","),function(a){this._openedNodes[a]=!0},this)}},_state:function(a,b){if(!this.persist)return!1;var c=p.map(a.getTreePath(),function(a){return this.model.getIdentity(a)},this).join("/");if(1===arguments.length)return this._openedNodes[c];
b?this._openedNodes[c]=!0:delete this._openedNodes[c];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var b=[],c;for(c in this._openedNodes)b.push(c);a(this.cookieName,b.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!t.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},
destroyRecursive:function(){this.destroy()},resize:function(a){a&&g.setMarginBox(this.domNode,a);this._nodePixelIndent=g.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(t.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var b=t.hitch(this,
function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&(!this._adjustWidthsTimer&&this._started)&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});w(a,b,b)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new P(a)},focus:function(){this.lastFocusedChild?
this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});r("dojo-bidi")&&V.extend({_setTextDirAttr:function(a){a&&this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",a))}});V.PathError=c("TreePathError");V._TreeNode=P;return V})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(p,f,a,l){return a("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",
root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(a){l.mixin(this,a);this.connects=[];a=this.store;if(!a.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");a.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([f.after(a,"onNew",l.hitch(this,"onNewItem"),!0),f.after(a,"onDelete",l.hitch(this,"onDeleteItem"),!0),f.after(a,"onSet",l.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var a;a=
this.connects.pop();)a.remove()},getRoot:function(a,f){this.root?a(this.root):this.store.fetch({query:this.query,onComplete:l.hitch(this,function(f){if(1!=f.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+f.length+" items, but must return exactly one");this.root=f[0];a(this.root)}),onError:f})},mayHaveChildren:function(a){return p.some(this.childrenAttrs,function(f){return this.store.hasAttribute(a,f)},this)},getChildren:function(a,f,q){var m=this.store;if(m.isItemLoaded(a)){for(var g=
[],e=0;e<this.childrenAttrs.length;e++)var c=m.getValues(a,this.childrenAttrs[e]),g=g.concat(c);var d=0;this.deferItemLoadingUntilExpand||p.forEach(g,function(a){m.isItemLoaded(a)||d++});0==d?f(g):p.forEach(g,function(a,c){m.isItemLoaded(a)||m.loadItem({item:a,onItem:function(a){g[c]=a;0==--d&&f(g)},onError:q})})}else{var r=l.hitch(this,arguments.callee);m.loadItem({item:a,onItem:function(a){r(a,f,q)},onError:q})}},isItem:function(a){return this.store.isItem(a)},fetchItemByIdentity:function(a){this.store.fetchItemByIdentity(a)},
getIdentity:function(a){return this.store.getIdentity(a)},getLabel:function(a){return this.labelAttr?this.store.getValue(a,this.labelAttr):this.store.getLabel(a)},newItem:function(a,f,l){var m={parent:f,attribute:this.childrenAttrs[0]},g;this.newItemIdAttr&&a[this.newItemIdAttr]?this.fetchItemByIdentity({identity:a[this.newItemIdAttr],scope:this,onItem:function(e){e?this.pasteItem(e,null,f,!0,l):(g=this.store.newItem(a,m))&&void 0!=l&&this.pasteItem(g,f,f,!1,l)}}):(g=this.store.newItem(a,m))&&void 0!=
l&&this.pasteItem(g,f,f,!1,l)},pasteItem:function(a,f,l,m,g){var e=this.store,c=this.childrenAttrs[0];f&&p.forEach(this.childrenAttrs,function(d){if(e.containsValue(f,d,a)){if(!m){var g=p.filter(e.getValues(f,d),function(c){return c!=a});e.setValues(f,d,g)}c=d}});if(l)if("number"==typeof g){var d=e.getValues(l,c).slice();d.splice(g,0,a);e.setValues(l,c,d)}else e.setValues(l,c,e.getValues(l,c).concat(a))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(a,
f){f&&this.getChildren(f.item,l.hitch(this,function(a){this.onChildrenChange(f.item,a)}))},onDeleteItem:function(a){this.onDelete(a)},onSetItem:function(a,f){if(-1!=p.indexOf(this.childrenAttrs,f))this.getChildren(a,l.hitch(this,function(f){this.onChildrenChange(a,f)}));else this.onChange(a)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(p,f,a,l,k){return f("dijit.tree.ForestStoreModel",
k,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(a){this.root={store:this,root:!0,id:a.rootId,label:a.rootLabel,children:a.rootChildren}},mayHaveChildren:function(a){return a===this.root||this.inherited(arguments)},getChildren:function(a,f,k){a===this.root?this.root.children?f(this.root.children):this.store.fetch({query:this.query,onComplete:l.hitch(this,function(a){this.root.children=a;f(a)}),onError:k}):this.inherited(arguments)},isItem:function(a){return a===this.root?!0:this.inherited(arguments)},
fetchItemByIdentity:function(f){if(f.identity==this.root.id){var k=f.scope||a.global;f.onItem&&f.onItem.call(k,this.root)}else this.inherited(arguments)},getIdentity:function(a){return a===this.root?this.root.id:this.inherited(arguments)},getLabel:function(a){return a===this.root?this.root.label:this.inherited(arguments)},newItem:function(a,f,k){return f===this.root?(this.onNewRootItem(a),this.store.newItem(a)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(a,f,k,g,e){if(f===
this.root&&!g)this.onLeaveRoot(a);this.inherited(arguments,[a,f===this.root?null:f,k===this.root?null:k,g,e]);if(k===this.root)this.onAddToRoot(a)},onAddToRoot:function(a){console.log(this,": item ",a," added to root")},onLeaveRoot:function(a){console.log(this,": item ",a," removed from root")},_requeryTop:function(){var a=this.root.children||[];this.store.fetch({query:this.query,onComplete:l.hitch(this,function(f){this.root.children=f;if(a.length!=f.length||p.some(a,function(a,g){return f[g]!=a}))this.onChildrenChange(this.root,
f)})})},onNewItem:function(a,f){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(a){-1!=p.indexOf(this.root.children,a)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(a,f,k,g){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),function(p,f,a,l,k,h,q,m,
g,e,c){return f("dijit.tree._dndSelector",c,{constructor:function(){this.selection={};this.anchor=null;this.events.push(m(this.tree.domNode,g.press,l.hitch(this,"onMouseDown")),m(this.tree.domNode,g.release,l.hitch(this,"onMouseUp")),m(this.tree.domNode,g.move,l.hitch(this,"onMouseMove")),m(this.tree.domNode,e.press,l.hitch(this,"onClickPress")),m(this.tree.domNode,e.release,l.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var a=[],c=this.selection,e;for(e in c)a.push(c[e]);
return a},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(a,c){this.setSelection(this.getSelectedTreeNodes().concat([a]));c&&(this.anchor=a);return a},removeTreeNode:function(a){var c=p.filter(this.getSelectedTreeNodes(),function(c){return!h.isDescendant(c.domNode,a.domNode)});this.setSelection(c);return a},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},setSelection:function(a){var c=
this.getSelectedTreeNodes();p.forEach(this._setDifference(c,a),l.hitch(this,function(a){a.setSelected(!1);this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));p.forEach(this._setDifference(a,c),l.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(a,c){p.forEach(c,function(a){a.__exclude__=!0});var e=p.filter(a,function(a){return!a.__exclude__});p.forEach(c,function(a){delete a.__exclude__});return e},_updateSelectionProperties:function(){var a=
this.getSelectedTreeNodes(),c=[],e=[];p.forEach(a,function(a){var d=a.getTreePath();e.push(a);c.push(d)},this);a=p.map(e,function(a){return a.item});this.tree._set("paths",c);this.tree._set("path",c[0]||[]);this.tree._set("selectedNodes",e);this.tree._set("selectedNode",e[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null)},onClickPress:function(a){if(!this.current||!this.current.isExpandable||!this.tree.isExpandoNode(a.target,this.current)){"mousedown"==a.type&&
q.isLeft(a)&&a.preventDefault();var c="keydown"==a.type?this.tree.focusedChild:this.current;if(c){var e=k.getCopyKeyState(a),f=c.id;!this.singular&&!a.shiftKey&&this.selection[f]?this._doDeselect=!0:(this._doDeselect=!1,this.userSelect(c,e,a.shiftKey))}}},onClickRelease:function(a){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==a.type?this.tree.focusedChild:this.current,k.getCopyKeyState(a),a.shiftKey))},onMouseMove:function(){this._doDeselect=!1},onMouseDown:function(){},onMouseUp:function(){},
_compareNodes:function(a,c){if(a===c)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-c.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(c)&2?1:-1;if(document.createRange){var e=doc.createRange();e.setStartBefore(a);var f=doc.createRange();f.setStartBefore(c);return e.compareBoundaryPoints(e.END_TO_END,f)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");},userSelect:function(a,
c,e){if(this.singular)this.anchor==a&&c?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(e&&this.anchor){c=this._compareNodes(this.anchor.rowNode,a.rowNode);e=this.anchor;0>c?c=e:(c=a,a=e);for(e=[];c!=a;)e.push(c),c=this.tree._getNext(c);e.push(a);this.setSelection(e)}else this.selection[a.id]&&c?this.removeTreeNode(a):c?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(c,
e){e=e||a.global;for(var f in this.selection)c.call(e,this.getItem(f),f,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(p,f,a,l,k,h){return f("dijit.tree._dndContainer",null,{constructor:function(f,m){this.tree=f;this.node=f.domNode;l.mixin(this,m);this.containerState="";a.add(this.node,"dojoDndContainer");this.events=[k(this.node,h.enter,l.hitch(this,"onOverEvent")),k(this.node,h.leave,
l.hitch(this,"onOutEvent")),p.after(this.tree,"_onNodeMouseEnter",l.hitch(this,"onMouseOver"),!0),p.after(this.tree,"_onNodeMouseLeave",l.hitch(this,"onMouseOut"),!0),k(this.node,"dragstart, selectstart",function(a){a.preventDefault()})]},destroy:function(){for(var a;a=this.events.pop();)a.remove();this.node=this.parent=null},onMouseOver:function(a){this.current=a},onMouseOut:function(){this.current=null},_changeState:function(f,h){var g="dojoDnd"+f,e=f.toLowerCase()+"State";a.replace(this.node,g+
h,g+this[e]);this[e]=h},_addItemClass:function(f,h){a.add(f,"dojoDndItem"+h)},_removeItemClass:function(f,h){a.remove(f,"dojoDndItem"+h)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"jimu/dijit/LayerChooserFromMapWithDropbox":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/Evented dojo/Deferred dijit/popup dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LayerChooserFromMapWithDropbox.html jimu/LayerInfos/LayerInfos".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c){return p([m,g,k],{templateString:e,baseClass:"jimu-layer-chooser-from-map-withdropbox",declaredClass:"jimu.dijit.LayerChooserFromMapWithDropbox",_selectedItem:null,_isLayerChooserShow:!1,layerInfosObj:null,layerChooser:null,postCreate:function(){this.inherited(arguments);this.layerInfosObj=c.getInstanceSync();a.addClass(this.layerChooser.domNode,"jimu-layer-chooser-from-map-withdropbox-popup");this.layerChooser.domNode.style.zIndex=1;this.layerChooser.tree.domNode.style.borderTop=
"0";this.own(l(this.layerChooser,"tree-click",f.hitch(this,this._onTreeClick)));this.own(l(this.layerChooser,"update",f.hitch(this,this._onLayerChooserUpdate)));this.own(l(document.body,"click",f.hitch(this,this._onBodyClicked)))},destroy:function(){this.hideLayerChooser();this.layerChooser&&this.layerChooser.destroy();this.layerChooser=null;this.inherited(arguments)},getLayerChooser:function(){return this.layerChooser},setSelectedLayer:function(a){var c=new h;if(a){var e=this.layerInfosObj.getLayerInfoById(a.id);
e?this.layerChooser.filter(e).then(f.hitch(this,function(f){f?(this._onSelectNewItem({layerInfo:e,name:e.title,url:a.url}),c.resolve(!0)):c.resolve(!1)}),f.hitch(this,function(){c.resolve(!1)})):c.resolve(!1)}else this._onSelectNewItem(null),c.resolve(!0);return c},getSelectedItem:function(){return this._selectedItem},getSelectedItems:function(){return[this._selectedItem]},_onBodyClicked:function(c){c=c.target||c.srcElement;c===this.domNode||a.isDescendant(c,this.domNode)||c===this.layerChooser.domNode||
a.isDescendant(c,this.layerChooser.domNode)||this.hideLayerChooser()},_onDropDownClick:function(a){a.stopPropagation();a.preventDefault();this._isLayerChooserShow?this.hideLayerChooser():this.showLayerChooser()},_getSelectedItems:function(){return this.layerChooser.getSelectedItems()},showLayerChooser:function(){var c=this.domNode.clientWidth;200>c&&(c=200);this.layerChooser.domNode.style.width=c+2+"px";q.open({parent:this,popup:this.layerChooser,around:this.domNode});(c=this.layerChooser.domNode.parentNode)&&
a.addClass(c,"jimu-layer-chooser-from-map-withdropbox-popup");this._isLayerChooserShow=!0},hideLayerChooser:function(){q.close(this.layerChooser);this._isLayerChooserShow=!1},_onLayerChooserUpdate:function(){this._selectedItem&&this.layerChooser.onlyShowVisible&&!this._selectedItem.layerInfo.isShowInMap()&&(this._selectedItem=null,this.emit("selection-change",[]))},_onSelectNewItem:function(a){var c=f.getObject("layerInfo.id",!1,this._selectedItem)||-1,e=f.getObject("layerInfo.id",!1,a)||-1,c=c!==
e;this._selectedItem=a;this.hideLayerChooser();a=f.getObject("layerInfo.title",!1,this._selectedItem)||"";this.layerNameNode.innerHTML=a;a=f.getObject("layerInfo.layerObject",!1,this._selectedItem);c&&this.emit("selection-change",[a])},_onTreeClick:function(){var a=this._getSelectedItems();this._onSelectNewItem(0<a.length?a[0]:null)}})})},"builder/plugins/startup/_build-generate_module":function(){define(["builder/plugins/startup/Plugin","dojo/text!builder/plugins/startup/Plugin.html","dojo/text!builder/plugins/startup/css/style.css"],
function(){})},"builder/plugins/startup/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic builder/BasePlugin builder/serviceUtils jimu/dijit/ViewStack jimu/utils".split(" "),function(p,f,a,l,k,h,q,m){return p([k],{baseClass:"plugin-startup",constructor:function(){this.appTypes=["HTML","HTML3D"]},postCreate:function(){this.main=new q({viewType:"dijit",views:[]},this.viewStackNode)},startup:function(){this.main.startup();this._loadHeaderPlugin().then(f.hitch(this,
function(){this._afterHeaderLoaded()}))},getCurrentView:function(){return this.main.getSelectedView()},switchToAppList:function(){var g=f.hitch(this,function(){if(window.history&&window.history.pushState){this._switchToAppList();var a=m.url.removeQueryParamFromUrl(window.location.href,"id");window.history.pushState({path:a},"",a)}else window.location.href="index.html"});document.title="Web AppBuilder for ArcGIS";"appconfig"===this.main.getSelectedLabel()?l.publish("closeAppConfigPage",g):""===this.main.getSelectedLabel()&&
(a.empty(this.viewStackNode),g())},switchToAppConfig:function(a){var e=window.location.href;window.queryObject.id?(e=m.url.removeQueryParamFromUrl(e,"id"),e=m.url.addQueryParamToUrl(e,"id",a.id)):window.queryObject.appid?(e=m.url.removeQueryParamFromUrl(e,"appid"),e=m.url.addQueryParamToUrl(e,"appid",a.id)):(e=m.url.removeQueryParamFromUrl(e,"title"),e=m.url.removeQueryParamFromUrl(e,"tags"),e=m.url.removeQueryParamFromUrl(e,"summary"),e=m.url.removeQueryParamFromUrl(e,"folder"),e=m.url.removeQueryParamFromUrl(e,
"sharewithwebmap"),e=m.url.removeQueryParamFromUrl(e,"webmap"),e=m.url.removeQueryParamFromUrl(e,"sharewithwebscene"),e=m.url.removeQueryParamFromUrl(e,"webscene"),e=m.url.removeQueryParamFromUrl(e,"appType"),e=m.url.addQueryParamToUrl(e,"id",a.id));if(window.location.href!==e)if(window.history&&window.history.pushState)window.history.pushState({path:e},"",e);else{window.location.href=e;return}this._switchToApp(a)},_afterHeaderLoaded:function(){var a;if(window.isXT)queryObject.id?(a={id:queryObject.id.replace("#",
"")},this._switchToApp(a)):this._switchToAppList();else if(queryObject.id)a={id:queryObject.id.replace("#","")},this._switchToApp(a);else if(queryObject.appid)a={appid:queryObject.appid.replace("#","")},this._switchToApp(a);else if(queryObject.title){a={name:queryObject.title};queryObject.tags&&(a.tags=queryObject.tags);queryObject.summary&&(a.description=queryObject.summary);queryObject.folder&&(a.folderId=queryObject.folder);if(queryObject.sharewithwebmap||queryObject.sharewithwebscene)a.sharing=
"true"===queryObject.sharewithwebmap||"true"===queryObject.sharewithwebscene;queryObject.appType?(a.appType=queryObject.appType,queryObject.webmap&&(a.webmap=queryObject.webmap),queryObject.webscene&&(a.webscene=queryObject.webscene)):queryObject.webmap?(a.webmap=queryObject.webmap,a.appType="HTML"):queryObject.webscene?(a.webscene=queryObject.webscene,a.appType="HTML3D"):a.appType="HTML";this._createApp(a)}else window.location.href=window.portalUrl},_switchToApp:function(a){var e=this.main.getViewByLabel("appconfig");
e&&this.main.removeView(e);"stemapp"===a.id&&(a.id="HTML");"stemapp3d"===a.id&&(a.id="HTML3D");h.getAppInfo(a.id||a.appid).then(f.hitch(this,function(c){if("undefined"===typeof c.id)this.viewStackNode.innerHTML='\x3cimg class\x3d"image-404" src\x3d"'+this.folderUrl+'images/404.png"\x3e';else{var d=this.pluginManager.getStemappInfo(c.appType);d.name="HTML3D"===d.appType?"stemapp3d":"stemapp";var e;e=-1<this.appTypes.indexOf(a.id)?d.appPath:window.isXT?window.path+"apps/"+c.id+"/":"HTML3D"===c.appType?
window.path+"stemapp3d/":window.path+"stemapp/";window.stemappInfo=d;window.appInfo={appType:c.appType,appPath:e,appOwner:c.creator||c.owner,id:c.id,name:c.name,isPredefined:c.isPredefined,isTemplate:c.isTemplate,isTemplateApp:c.isTemplateApp};d=this.filterExtensionsByAppType("app-config",c.appType);0===d.length?console.error("Do not find app-config extension."):1<d.length?console.error("Find more than one app-config extension."):(d=this.pluginsMeta[d[0].pluginName],d.options={appInfo:c},this.pluginManager.loadPlugin(d).then(f.hitch(this,
function(a){a.label="appconfig";this.main.addView(a);this.main.switchView("appconfig")})),this._showAppName(c))}}))},_showAppName:function(a){"stemapp"===a.id?this.header.setAppName("stemapp"):a.isTemplate?this.header.setAppName(builderNls.templateLabel+" "+a.name):this.header.setAppName(a.name);document.title=a.name+" - Web AppBuilder for ArcGIS"},_hideAppName:function(){this.header.setAppName("")},_createApp:function(a){var e=this.pluginManager.getStemappInfo(a.appType);e.name="HTML3D"===e.appType?
"stemapp3d":"stemapp";window.stemappInfo=e;e=this.pluginManager.getExtensions("startup.creation-entry")[0];this.pluginManager.loadPlugin(this.pluginsMeta[e.pluginName]).then(f.hitch(this,function(c){c.createNewApp(a)}))},_switchToAppList:function(){if(this.main.getViewByLabel("applist"))this.main.switchView("applist");else{var a=this.getPluginsMetaByExtensionPoint("app-list")[0];this.pluginManager.loadPlugin(a).then(f.hitch(this,function(a){a.label="applist";this.main.addView(a);this.main.switchView("applist")}))}this._hideAppName()},
_loadHeaderPlugin:function(){var g=this.getPluginsMetaByExtensionPoint("header")[0];return this.pluginManager.loadPlugin(g).then(f.hitch(this,function(e){a.place(e.domNode,this.headerNode);e.startup();return this.header=e}))}})})},"builder/plugins/stemapps/web2d/_build-generate_module":function(){define([],function(){})},"builder/plugins/stemapps/web3d/_build-generate_module":function(){define([],function(){})},"builder/plugins/theme-config/_build-generate_module":function(){define(["builder/plugins/theme-config/Plugin",
"dojo/text!builder/plugins/theme-config/Plugin.html","dojo/text!builder/plugins/theme-config/css/style.css","dojo/i18n!builder/plugins/theme-config/nls/strings"],function(){})},"builder/plugins/theme-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/Color dojo/topic dojo/on dojo/dom dojo/cookie dojo/text!./Plugin.html dojo/dom-construct dojo/dom-style dojo/_base/array dojo/Deferred jimu/dijit/Message jimu/dijit/CheckBox jimu/dijit/ColorPicker ./ThemeManager builder/serviceUtils builder/BasePlugin jimu/utils".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w){return p([n],{baseClass:"plugin-theme-config",templateString:g,themeLoadDef:void 0,_themePageDef:void 0,_disableShowThemeSwitchMessage:null,constructor:function(){this._themePageDef=new r;this._disableShowThemeSwitchMessage=!0},postMixInProperties:function(){this.inherited(arguments);this.nls=f.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this.own(k.subscribe("app/appConfigLoaded",f.hitch(this,this._onAppConfigLoaded)));
this.own(k.subscribe("app/appConfigChanged",f.hitch(this,this._onAppConfigChanged)))},startup:function(){this.inherited(arguments);this.themeManager=new b;this.themeLoadDef=this.themeManager.loadThemes();this.themeLoadDef.then(f.hitch(this,function(a){this.initThemePage(a);this._themePageDef.resolve()}))},initThemePage:function(b){var c,g,k,l,n,m;d.forEach(b,function(b){l=a.create("div",{"class":"catalog-theme-content-div jimu-float-leading"},this.themeList);c=a.create("div",{"class":"catalog-theme-div",
"data-themeName":b.getName()},l);a.create("div",{"class":"catalog-theme-name-div",innerHTML:b.getLabel(),title:b.getLabel()},l);n=a.create("div",{"class":"catalog-theme-img-box-div"},c);m=a.create("div",{"class":"catalog-theme-img-div"},n);e.create("img",{src:b.getIcon(),"class":"catalog-theme-img"},m);h(c,"click",f.hitch(this,this._onStartChangeTheme,b.getName()));g=e.create("div",{"class":""},this.styleList);this.initStyle(b,g);k=e.create("div",{"class":""},this.layoutList);this.initLayout(b,k);
b.domNodes.theme=c;b.domNodes.themeImgBox=n;b.domNodes.themeSL=void 0;b.domNodes.styleList=g;b.domNodes.layoutList=k},this)},initStyle:function(b,g){var k,n,m;k=e.create("div",{"class":"style-section"},g);e.create("div",{innerHTML:this.nls.styleTitle,"class":"style-text"},k);m=e.create("div",{"class":"style-color-content"},k);k=b.getStyles().slice();var p=k.pop();d.forEach(k,function(a){n=e.create("div",{"class":"style-div jimu-float-leading"},m);c.set(n,"backgroundColor",a.styleColor);a.domNode=
n;h(n,"click",f.hitch(this,this._onStyleChanged,a.name))},this);n=e.create("div",{"class":"style-div jimu-float-leading"},m);var q=new t({showLabel:!0,ensureMode:!0},n);p.domNode=q.domNode;p.isCustom=!0;q.domNode.className+=" style-div jimu-float-leading";c.set(q.domNode,"backgroundColor",p.styleColor);a.empty(q.domNode);a.create("span",{innerHTML:p.styleColor,className:"color-label",style:{color:w.invertColor(p.styleColor)}},q.domNode);q.domNode.title=this.nls.setCustomColor;this.own(h(q.domNode,
"click",f.hitch(this,function(a){var c=b.getCurrentStyle().name,d=new l(a.styleColor);a=c===a.name;c=q.getColor().toHex()===d.toHex();!a&&c?(q.picker.set("value",d.toHex()),q.onChange(d)):!a&&!c&&q.setColor(d)},p)));this.own(h(q,"change",f.hitch(this,function(a,c){c.toHex()!==(b.appConfig.theme.customStyles&&b.appConfig.theme.customStyles.mainBackgroundColor)&&(a.styleColor=c.toHex(),a.isCustom=!0,this._onStyleChanged(a.name))},p)));b._cp=q;a.setStyle(g,"display","none")},initLayout:function(b,c){var f;
f=e.create("div",{"class":"layout-section",id:b.getName()+"-layout-section"},c);e.create("div",{innerHTML:this.nls.layoutTitle,"class":"layout-text"},f);d.forEach(b.getLayouts(),function(a){this._drawLayout(b,a,f)},this);a.setStyle(c,"display","none")},_drawLayout:function(a,b,c){var d;b.domClass||(b.domClass=" ");c=e.create("div",{"class":"layout-out-div jimu-float-leading "},c);d=e.create("div",{"class":"layout-box-div "},c);c=e.create("div",{"class":"layout-div "+b.domClass},d);a=isRTL?b.RTLIcon?
a.getUrl()+b.RTLIcon:this.folderUrl+"css/images/current_layout.png":b.icon?a.getUrl()+b.icon:this.folderUrl+"css/images/current_layout.png";e.create("img",{"class":"layout-image",src:a},c);b.domNode=c;b.boxDomNode=d;h(c,"click",f.hitch(this,this._onLayoutChanged,b.name));a=e.create("div",{"class":"layout-selected-div"},c);e.create("img",{"class":"layout-selected-img",src:this.folderUrl+"css/images/check.png"},a);b.selectedNode=a},_onStyleChanged:function(a){this.changeStyle(a,null,!0)},_onLayoutChanged:function(a){this.changeLayout(a,
null,!0)},_onStartChangeTheme:function(a){if(this.themeManager.currentThemeName!==a)if(this._disableShowThemeSwitchMessage)this.changeTheme(a,!0);else if(m("disable_theme_switch_Message"))this.changeTheme(a,!0);else{var b=new u({message:"\x3cdiv\x3e"+this.nls.themeChangeMessage+"\x3c/div\x3e",width:500,buttons:[{label:this.nls.ok,onClick:f.hitch(this,function(){c.checked&&m("disable_theme_switch_Message",!0);b.close();this.changeTheme(a,!0)})},{label:this.nls.cancel}]}),c=new s({label:this.nls.disableThemeSwitchMessage,
"class":"jimu-float-leading",style:{marginTop:"10px"}});c.placeAt(b.contentContainerNode)}},changeStyle:function(b,c,d){c||(c=this.themeManager.getCurrentTheme());var e=c.getCurrentStyle();if(c.currentStyleName!==b||e&&e.name===b&&e.isCustom)c.currentStyleName&&a.removeClass(c.getCurrentStyle().domNode,"style-selected"),c.changeCurrentStyle(b),a.addClass(c.getCurrentStyle().domNode,"style-selected"),d&&k.publish("styleChanged",f.clone(c.getCurrentStyle()))},changeLayout:function(b,c,d){c||(c=this.themeManager.getCurrentTheme());
c.currentLayoutName!==b&&(c.currentLayoutName&&(a.removeClass(c.getCurrentLayout().domNode,"layout-selected"),a.removeClass(c.getCurrentLayout().boxDomNode,"layout-box-selected")),c.changeCurrentLayout(b),a.addClass(c.getCurrentLayout().domNode,"layout-selected"),a.addClass(c.getCurrentLayout().boxDomNode,"layout-box-selected"),d&&k.publish("layoutChanged",f.clone(c.getCurrentLayout())))},_copyThemeFromRepo:function(a){var b=new r,c=this.themeManager.getThemeByName(a);c.loadLayouts().then(f.hitch(this,
function(){var d=c.getLayoutByName("default");v.copyThemeToApp(window.appInfo.id,a,c.appConfig?c.appConfig.getCleanConfig():d.layoutConfig).then(f.hitch(this,function(a){a.success?b.resolve():(b.reject(),console.error("change theme error, response of 'copytheme' unsuccess"))}),function(a){b.reject(a);console.error("change theme error"+a)})}));return b},changeTheme:function(b,c){var d=new r;this.themeManager.currentThemeName!==b?(c&&this.pluginManager.getPluginByName("app-config").showLoadingCover(),
this._copyThemeFromRepo(b).then(f.hitch(this,function(){this.themeManager.currentThemeName&&(a.removeClass(this.themeManager.getCurrentTheme().domNodes.theme,"catalog-theme-selected"),a.removeClass(this.themeManager.getCurrentTheme().domNodes.themeImgBox,"selected"),a.setStyle(this.themeManager.getCurrentTheme().domNodes.styleList,"display","none"),a.setStyle(this.themeManager.getCurrentTheme().domNodes.layoutList,"display","none"));this.themeManager.changeCurrentTheme(b);if(c){var e=this.themeManager.getCurrentTheme(),
g=e._cp;delete e._cp;k.publish("themeChanged",f.clone(e));e._cp=g}a.addClass(this.themeManager.getCurrentTheme().domNodes.theme,"catalog-theme-selected");a.addClass(this.themeManager.getCurrentTheme().domNodes.themeImgBox,"selected");a.setStyle(this.themeManager.getCurrentTheme().domNodes.styleList,"display","block");a.setStyle(this.themeManager.getCurrentTheme().domNodes.layoutList,"display","block");d.resolve()}))):d.resolve();return d},_onAppConfigLoaded:function(a){this._setAppConfig(a,!0)},_onAppConfigChanged:function(a){this._setAppConfig(a,
!1)},_setAppConfig:function(b,c){var e,g;this._themePageDef.then(f.hitch(this,function(){c?(d.forEach(this.themeManager.themes,function(a){this.changeStyle("default",a,!1);this.changeLayout("default",a,!1);a.clear()},this),this.changeTheme(b.theme.name,!1).then(f.hitch(this,function(){b.theme.styles&&b.theme.styles[0]&&this.changeStyle(b.theme.styles[0],this.themeManager.getCurrentTheme(),!1);e=q.byId(this.themeManager.getCurrentTheme().getName()+"-layout-section");g=this.themeManager.getCurrentTheme().getLayoutByAppConfig(b.getCleanConfig());
g||(g=this.themeManager.getCurrentTheme().addLayout("appLayout",b.getCleanConfig(),"app-layout",this.nls.appLayout),this._drawLayout(this.themeManager.getCurrentTheme(),g,e));this.changeLayout(g.name,this.themeManager.getCurrentTheme(),!1);var c=this.themeManager.getCurrentTheme();c.setAppConfig(b);var d=f.getObject("theme.customStyles.mainBackgroundColor",!1,b);d&&c._cp.setColor(new l(d));a.setStyle(this.themeList,"display","block")}))):this.themeManager.getCurrentTheme()&&this.themeManager.getCurrentTheme().setAppConfig(b)}))}})})},
"builder/plugins/theme-config/ThemeManager":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred ./Theme builder/serviceUtils".split(" "),function(p,f,a,l,k,h){return p(null,{themes:void 0,constructor:function(){this.currentThemeName=null;this.themes=[]},loadThemes:function(){var p=new l;h.getAllThemes().then(a.hitch(this,function(a){a.success?(a.themes=a.themes.sort(function(a,e){return a.label.localeCompare(e.label)}),f.forEach(a.themes,function(a){this.themes.push(new k(a))},
this),p.resolve(this.themes)):(console.error("Gets themes failed! The response of getThemes is 'unsuccess'!"),p.reject(this.themes))}),function(a){console.error("Gets themes failed!"+a);p.reject(this.themes)});return p},changeCurrentTheme:function(a){this.currentThemeName=a},getCurrentTheme:function(){return this.getThemeByName(this.currentThemeName)},getThemeByName:function(a){for(var f=0;f<this.themes.length;f++)if(a===this.themes[f].getName())return this.themes[f]}})})},"builder/plugins/theme-config/Theme":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/request jimu/utils".split(" "),
function(p,f,a,l,k,h,q,m){return p(null,{appConfig:void 0,currentStyleName:void 0,currentLayoutName:void 0,_manifest:void 0,constructor:function(a){this._manifest=a;this.domNodes={}},clear:function(){var f;this.appConfig=null;for(f=0;f<this._manifest.layouts.length;f++)if("appLayout"===this._manifest.layouts[f].name){this._manifest.layouts[f].domNode&&a.destroy(this._manifest.layouts[f].domNode);this._manifest.layouts.splice(f,1);break}},loadLayouts:function(){var a=new k,e=[],c=l.filter(this._manifest.layouts,
function(a){return"appLayout"!==a.name});l.forEach(c,function(a){e.push(q(this._manifest.url+a.uri,{handleAs:"json"}))},this);h(e).then(f.hitch(this,function(d){var e;l.forEach(c,function(a,c){a.layoutConfig=d[c];"default"===a.name?e=a.layoutConfig:a.layoutConfig=m.mixinAppConfigPosition(e,a.layoutConfig);a.layoutConfig.mobileLayout&&(a.layoutConfig.mobileLayout=m.mixinAppConfigPosition(a.layoutConfig,a.layoutConfig.mobileLayout),delete a.layoutConfig.mobileLayout.mobileLayout)},this);a.resolve()}),
function(){a.reject()});return a},_processLayoutConfig:function(a,e){return m.mixinAppConfigPosition(a,e)},setAppConfig:function(a){this.appConfig=a},getName:function(){return this._manifest.name},getVersion:function(){return this._manifest.version},getLabel:function(){return this._manifest.label},getIcon:function(){return this._manifest.icon},getLayouts:function(){return this._manifest.layouts},getStyles:function(){return this._manifest.styles},getUrl:function(){return this._manifest.url},getCurrentStyle:function(){return this.getStyleByName(this.currentStyleName)},
getCurrentLayout:function(){return this.getLayoutByName(this.currentLayoutName)},changeCurrentStyle:function(a){this.currentStyleName=a},changeCurrentLayout:function(a){this.currentLayoutName=a},addLayout:function(a,e,c,d){var f,h=this.getLayouts();for(f=0;f<h.length;f++)if(h[f].name===a)return null;a={description:"this is current app layout",name:a,label:d,layoutConfig:e,domClass:c};this._manifest.layouts.push(a);return a},getStyleByName:function(a){var e,c=null;for(e=0;e<this._manifest.styles.length;e++)if(this._manifest.styles[e].name===
a){c=this._manifest.styles[e];break}return c},getLayoutByName:function(a){var e,c=null;for(e=0;e<this._manifest.layouts.length;e++)if(this._manifest.layouts[e].name===a){c=this._manifest.layouts[e];break}return c},getLayoutByAppConfig:function(a){var e,c=null;for(e=0;e<this._manifest.layouts.length;e++)if(this.isAppUseLayout(a,this._manifest.layouts[e].layoutConfig)){c=this._manifest.layouts[e];break}return c},isAppUseLayout:function(a,e){var c=f.clone(a),d=f.clone(e);c.map||(c.map={});d.map||(d.map=
c.map);c.map.position||(c.map.position={left:0,top:0});d.map.position||(d.map.position=c.map.position);if(!m.isEqual(c.map.position,d.map.position))return!1;c.widgetOnScreen||(c.widgetOnScreen={});d.widgetOnScreen||(d.widgetOnScreen={});c.widgetOnScreen.widgets||(c.widgetOnScreen.widgets=[]);d.widgetOnScreen.widgets||(d.widgetOnScreen.widgets=[]);c.widgetOnScreen.groups||(c.widgetOnScreen.groups=[]);d.widgetOnScreen.groups||(d.widgetOnScreen.groups=[]);var h,k;h=c.widgetOnScreen.widgets.length<d.widgetOnScreen.widgets.length?
c.widgetOnScreen.widgets.length:d.widgetOnScreen.widgets.length;for(k=0;k<h;k++)if(c.widgetOnScreen.widgets[k].position||(c.widgetOnScreen.widgets[k].position={}),d.widgetOnScreen.widgets[k].position||(d.widgetOnScreen.widgets[k].position=c.widgetOnScreen.widgets[k].position),d.widgetOnScreen.widgets[k].position.relativeTo||(d.widgetOnScreen.widgets[k].position.relativeTo=c.widgetOnScreen.widgets[k].position.relativeTo),!m.isEqual(c.widgetOnScreen.widgets[k].position,d.widgetOnScreen.widgets[k].position))return!1;
h=c.widgetOnScreen.groups.length<d.widgetOnScreen.groups.length?c.widgetOnScreen.groups.length:d.widgetOnScreen.groups.length;for(k=0;k<h;k++)if(c.widgetOnScreen.groups[k].panel||(c.widgetOnScreen.groups[k].panel={}),d.widgetOnScreen.groups[k].panel||(d.widgetOnScreen.groups[k].panel=c.widgetOnScreen.groups[k].panel),c.widgetOnScreen.groups[k].panel.position||(c.widgetOnScreen.groups[k].panel.position={}),d.widgetOnScreen.groups[k].panel.position||(d.widgetOnScreen.groups[k].panel.position=c.widgetOnScreen.groups[k].panel.position),
d.widgetOnScreen.groups[k].panel.position.relativeTo||(d.widgetOnScreen.groups[k].panel.position.relativeTo=c.widgetOnScreen.groups[k].panel.position.relativeTo),!m.isEqual(c.widgetOnScreen.groups[k].panel.position,d.widgetOnScreen.groups[k].panel.position))return!1;return!0},getLayoutFromConfig:function(a){var e={};a=f.clone(a);a.widgetOnScreen&&(e.widgetOnScreen={},a.widgetOnScreen.widgets&&(e.widgetOnScreen.widgets=[],l.forEach(a.widgetOnScreen.widgets,function(a,d){e.widgetOnScreen.widgets[d]=
{position:a.position?a.position:{left:0,top:0}}})),a.widgetOnScreen.groups&&(e.widgetOnScreen.groups=[],l.forEach(a.widgetOnScreen.groups,function(a,d){e.widgetOnScreen.groups[d]={position:a.position?a.position:{left:0,top:0}}})));a.map&&(e.map={position:a.map.position});return e}})})},"builder/plugins/widget-config/_build-generate_module":function(){define(["builder/plugins/widget-config/Plugin","dojo/text!builder/plugins/widget-config/Plugin.html","dojo/text!builder/plugins/widget-config/css/style.css",
"dojo/i18n!builder/plugins/widget-config/nls/strings"],function(){})},"builder/plugins/widget-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/fx dojo/topic dojo/on dijit/_WidgetBase ./WidgetsList ./MoveableNode ./WidgetSettingPage ./GroupSettingPage ./WidgetChoosePage jimu/utils jimu/PoolControllerMixin jimu/dijit/ViewStack jimu/dijit/Popup builder/BasePlugin".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v){return p([v],{baseClass:"plugin-widget-config app-widgets",
postMixInProperties:function(){this.nls=f.mixin(this.nls,window.builderNls)},postCreate:function(){this.inherited(arguments);this.notRemoveableWidgetOnScreen=new g({name:"notRemoveableWidgetOnScreen",nls:this.nls,folderUrl:this.folderUrl},this.notRemoveableOnScreenWidgetsListNode);this.removeableWidgetOnScreen=new g({name:"removeableWidgetOnScreen",nls:this.nls,folderUrl:this.folderUrl},this.removeableOnScreenWidgetsListNode);this.poolWidgets=new g({name:"poolWidgets",nls:this.nls,folderUrl:this.folderUrl},
this.poolWidgetsListNode);this.viewStack=new t({viewType:"dom",views:[this.preloadWidgetsNode,this.poolWidgetsNode]});this.viewStack.placeAt(this.domNode);this.poolControllerClass=p([m,s]);this.own(h.subscribe("editWidget",f.hitch(this,this._onEditWidget)));this.own(h.subscribe("chooseWidget",f.hitch(this,this._onChooseWidget)));this.own(h.subscribe("editGroup",f.hitch(this,this._onEditGroup)));this.own(h.subscribe("app/appConfigChanged",f.hitch(this,this._onAppConfigChanged)));this.own(h.subscribe("app/appConfigLoaded",
f.hitch(this,this._onAppConfigChanged)));this.own(h.subscribe("widgetSettingPageOk",f.hitch(this,this._onWidgetSettingPageOk)));this.own(q(this.poolWidgets,"offpanel-group-error",f.hitch(this,this._onOffPanelGroupError)))},startup:function(){this.inherited(arguments);this.viewStack.startup();this.poolWidgets.opened=!1;this._init(this.appConfig)},destroy:function(){l.forEach(this.controllers,function(a){a.destroy()});this.controllers=[];this.inherited(arguments)},_onAppConfigChanged:function(a){this._started?
this.appConfig&&u.isEqual(this.appConfig.widgetOnScreen,a.widgetOnScreen)&&u.isEqual(this.appConfig.widgetPool,a.widgetPool)?this.appConfig=a:this._init(a):this.appConfig=a},_init:function(a){this.appConfig=a;this._createControllerWidgetNodes();this.poolWidgets.opened?0<this.controllers.length?l.some(this.controllers,function(a){if(this.poolWidgets.controller.id===a.id)return this._initWidgetPool(a),!0},this)||this._initWidgetPool(this.controllers[0]):(this._initWidgetPool(null),this._onBackWidgetsClick()):
this._initOnScreenWidget(a);this.widgetChoosePage&&this.widgetChoosePage.setAppConfig(a);this.widgetSettingPage&&this.widgetSettingPage.setAppConfig(a)},_setHeight:function(){a.setStyle(this.notRemoveableOnScreenWidgetsListNode,{height:this.notRemoveableWidgetOnScreen.getListHeight()+"px"});a.setStyle(this.removeableOnScreenWidgetsListNode,{height:this.removeableWidgetOnScreen.getListHeight()+"px"})},_onOffPanelGroupError:function(){a.setStyle(this.offPanelToGroupErrorNode,"opacity",1);k.fadeOut({node:this.offPanelToGroupErrorNode,
duration:5E3}).play()},_getNonControllerAndNotRemoveableOnScreenWidgets:function(a){var b=[];if(!a.widgetOnScreen)return[];l.forEach(a.widgetOnScreen.widgets,function(a){!a.isController&&(!1===a.inPanel&&!0!==a.closeable)&&b.push(a)},this);return b},_getNonControllerAndRemoveableOnScreenWidgets:function(a){var b=[];if(!a.widgetOnScreen)return[];l.forEach(a.widgetOnScreen.widgets,function(a){!a.isController&&(!1===a.inPanel&&!0===a.closeable||!0===a.inPanel||!a.uri)&&b.push(a)},this);l.forEach(a.widgetOnScreen.groups,
function(a){b.push(a)},this);return b},_createControllerWidgetNodes:function(){l.forEach(this.controllers,function(b){a.destroy(b.node);b.destroy()},this);this.controllers=[];l.forEach(this.appConfig.widgetOnScreen.widgets,function(a){a.isController&&this._createControllerWidgetNode(a)},this);this.controllerWidgetsHeight=118*this.controllers.length;a.setStyle(this.controllerWidgetsNode,{height:this.controllerWidgetsHeight+"px"})},_createControllerWidgetNode:function(b){var c=a.create("div",{"class":"controller-widget"},
this.controllerWidgetsNode),d={};window.isRTL?d.right="30px":d.left="30px";d=new e({type:"widget",w:74,h:118,setting:b,listName:"controllerWidgets",style:d,nls:this.nls});a.place(d.domNode,c);d.startup();d=a.create("div",{"class":"action-node"},c);a.create("div",{"class":"action-text jimu-float-leading jimu-leading-margin1",title:this.nls.setControlledWidgets,innerHTML:this.nls.setControlledWidgets},d);a.create("div",{"class":"action-arrow jimu-float-trailing jimu-trailing-margin2"},d);b=new this.poolControllerClass(b);
b.appConfig=this.appConfig;b.node=c;this.controllers.push(b);this.own(q(d,"click",f.hitch(this,this._openWidgetPool,b)))},_openWidgetPool:function(a){!1!==a.visible&&(this.currentController=a,this.viewStack.switchView(this.poolWidgetsNode),this.poolWidgets.opened=!0,this.removeableWidgetOnScreen.opened=!1,this.notRemoveableWidgetOnScreen.opened=!1,this.controllerLabelNode.innerHTML=u.stripHTML(a.label),this._initWidgetPool(a),this.poolWidgets._started||this.poolWidgets.startup())},_initWidgetPool:function(a){this.poolWidgets.controller=
a;this.poolWidgets.setSettings(a?a.getAllConfigs():[]);this.poolWidgets.setAppConfig(this.appConfig)},_initOnScreenWidget:function(b){this.notRemoveableWidgetOnScreen._started||this.notRemoveableWidgetOnScreen.startup();this.notRemoveableWidgetOnScreen.setSettings(this._getNonControllerAndNotRemoveableOnScreenWidgets(b));this.notRemoveableWidgetOnScreen.setAppConfig(b);0<this.controllers.length&&0<this.notRemoveableWidgetOnScreen.settings.length?a.setStyle(this.notRemoveableOnScreenWidgetsHline,"display",
""):a.setStyle(this.notRemoveableOnScreenWidgetsHline,"display","none");this.removeableWidgetOnScreen._started||this.removeableWidgetOnScreen.startup();this.removeableWidgetOnScreen.setSettings(this._getNonControllerAndRemoveableOnScreenWidgets(b));this.removeableWidgetOnScreen.setAppConfig(b);0<this.removeableWidgetOnScreen.settings.length&&(0<this.controllers.length||0<this.notRemoveableWidgetOnScreen.settings.length)?a.setStyle(this.removeableOnScreenWidgetsHline,"display",""):a.setStyle(this.removeableOnScreenWidgetsHline,
"display","none");this._setHeight()},_onBackWidgetsClick:function(){this._createControllerWidgetNodes();this.viewStack.switchView(this.preloadWidgetsNode);this.poolWidgets.opened=!1;this.removeableWidgetOnScreen.opened=!0;this.notRemoveableWidgetOnScreen.opened=!0;this._initOnScreenWidget(this.appConfig)},_onEditWidget:function(d,e){this.widgetSettingPage=new c({appConfig:this.appConfig,nls:this.nls},this.widgetSettingPageNode);this.widgetSettingPage.setting=f.clone(d);this.widgetSettingPage.fromNode=
e;var g=new b({titleLabel:this.nls.configLabel+" "+d.label,content:this.widgetSettingPage,container:"main-page",buttons:[{label:this.nls.ok,onClick:f.hitch(this.widgetSettingPage,this.widgetSettingPage.onOk)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:f.hitch(this.widgetSettingPage,this.widgetSettingPage.onCancel)}],onClose:f.hitch(this.widgetSettingPage,this.widgetSettingPage.onClose)});a.addClass(g.domNode,"widget-setting-popup");this.widgetSettingPage.startup()},_onChooseWidget:function(a,
c){this.widgetChoosePage=new r({appConfig:this.appConfig,nls:this.nls,options:{includeOffPanel:"group"===a.type?!1:!0}},this.widgetChoosePageNode);this.widgetChoosePage.fromNode=a;this.widgetChoosePage.fromList=c;new b({titleLabel:this.nls.chooseWidget,content:this.widgetChoosePage,container:"main-page",buttons:[{label:this.nls.ok,onClick:f.hitch(this.widgetChoosePage,this.widgetChoosePage.onOk)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"]}]});this.widgetChoosePage.startup()},_onEditGroup:function(a,
c){this.groupSettingPage=new d({setting:f.clone(c),nls:this.nls});new b({titleLabel:c.label,content:this.groupSettingPage,container:"main-page",buttons:[{label:this.nls.ok,onClick:f.hitch(this.groupSettingPage,this.groupSettingPage.onOk)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"]}]});this.groupSettingPage.startup()},_onWidgetSettingPageOk:function(a){a.isController&&h.publish("widgetChanged",a)},_getPopupSize:function(){var b=a.getContentBox("main-page"),c={};1024>=b.w?(c.width=b.w-
20,c.height=b.h-20):(c.width=1024,c.height=768);return c}})})},"builder/plugins/widget-config/WidgetsList":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/topic dojo/aspect dojo/Evented dojo/query dojo/NodeList-dom dijit/_WidgetBase ./MoveableNode ./LinkList".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d){function r(a){var c={};isFinite(a.l)&&(c.left=a.l+"px");isFinite(a.t)&&(c.top=a.t+"px");isFinite(a.w)&&(c.width=a.w+"px");isFinite(a.h)&&(c.height=a.h+"px");
return c}var u,s,t=p([e],{postCreate:function(){this.inherited(arguments);this.domNode=a.create("div",{"class":"node-margin"});this.type="addBtn"===this.node.type?"addMargin":"margin"}});return p([e,q],{postCreate:function(){this.nodeList=new d({name:this.name});this.own(k.subscribe("widgetChoosePageOk",f.hitch(this,this._onWidgetChoosePageOk)));this.own(k.subscribe("widgetSettingPageOk",f.hitch(this,this._onWidgetSettingPageOk)))},startup:function(){this.inherited(arguments);s=a.getContentBox(this.domNode);
this.position=a.position(this.domNode);u=Math.floor(s.w/89);this.settings&&this.initNodes()},setSettings:function(a){this.settings=a;this.initNodes()},setAppConfig:function(a){this.appConfig=a},addWidget:function(a){a=this.createMoveableNode("widget",a);this.nodeList.insertNode(a);this.placeNodes()},createMoveableNode:function(b,d){var e=f.clone(s);e.h=Infinity;var g=new c({type:b,w:74,h:118,setting:d,listName:this.name,parentBox:e,nls:this.nls,folderUrl:this.folderUrl});a.place(g.domNode,this.domNode);
g.startup();this.bindMoveEvent(g);"group"===b&&(h.after(g,"openGroup",f.hitch(this,this.openGroup,g)),h.after(g,"closeGroup",f.hitch(this,this.closeGroup,g)));g.on("removeNode",f.hitch(this,function(){"poolWidgets"===this.name&&(g.gnode?(this.nodeList.removeNode(g),this._reopenGroup()):this.nodeList.removeNode(g),this.placeNodes(),this.publishPoolChangeEvent())}));g.on("clickOpenAtStart",f.hitch(this,function(){var a={id:g.setting.id,openAtStart:!g.setting.openAtStart};a.isOnScreen="poolWidgets"===
this.name?!1:!0;k.publish("openAtStartChange",a)}));this.createMarginNode(g);return g},openGroup:function(a){var c,d,e,g,h,k,l;this.openedGNode&&this.openedGNode!==a&&this.openedGNode.closeGroup(this.openedGNode);c=a.setting.widgets;h=this.getNodePosition(this.nodeList.getNodeIndex(a)).r;k=Math.ceil(c.length/u);d=h*u+1;e=this.nodeList.getNodeByIndex(d);for(g=this.nodeList.getCount()+1;g<d;g++)l=this.createMoveableNode("empty"),l.gnode=a,this.nodeList.insertNode(l,e);this.openedGNode=a;this.openedGNode.panelRow=
h+1;this.createGroupPanel(h+1,k);c.forEach(f.hitch(this,function(c){c=this.createMoveableNode("widget",c);c.gnode=a;this.nodeList.insertNode(c,e)}));c=u*k-c.length;for(g=0;g<c;g++)l=this.createMoveableNode("empty"),l.gnode=a,this.nodeList.insertNode(l,e);this.placeNodes()},createGroupPanel:function(b,c){this.groupPanel=a.create("div",{"class":"widget-group-panel",style:r({l:5,t:118*(b-1)-10,h:118*c+0*(c-1),w:89*u-15+20})},this.domNode);var d=89*((this.openedGNode.pos.c-1)%u)+37;window.isRTL&&(d=1===
this.openedGNode.pos.c?89*u-37:89*((u-this.openedGNode.pos.c+1)%u)-37);a.create("div",{"class":"group-triangle",style:{left:d+"px"}},this.groupPanel);this.groupPanel.type="panel"},closeGroup:function(b){var c=[];b.setting.widgets=[];this.nodeList.visitNodes(f.hitch(this,function(a){a.gnode===b&&("empty"!==a.type&&b.setting.widgets.push(a.setting),c.push(a))}));c.forEach(f.hitch(this,function(a){this.nodeList.removeNode(a)}));0===b.setting.widgets.length?this.nodeList.removeNode(b):b.updateSmallWidgets();
this.placeNodes();a.destroy(this.groupPanel);this.openedGNode=null},initNodes:function(){this.destroyShadowNode();var a=this.settings;if("notRemoveableWidgetOnScreen"===this.name)a=a.sort(function(a,b){return a.label.localeCompare(b.label)});else if("removeableWidgetOnScreen"===this.name)var c=l.filter(a,function(a){return a.widgets}),c=c.sort(function(a,b){return a.label.localeCompare(b.label)}),d=l.filter(a,function(a){return a.uri}),d=d.sort(function(a,b){return a.label.localeCompare(b.label)}),
a=l.filter(a,function(a){return!a.widgets&&!a.uri}),a=a.sort(function(a,b){return a.placeholderIndex-b.placeholderIndex}),a=[].concat(c,d,a);else a=a.sort(function(a,b){return a.index-b.index});var e;this.openedGNode&&(e=this.openedGNode.label,this.closeGroup(this.openedGNode));this.nodeList.destroyAllNodes();"poolWidgets"===this.name&&(this.addBtn=this.createMoveableNode("addBtn"),this.nodeList.insertNode(this.addBtn));a.forEach(f.hitch(this,function(a){if(a.widgets){if("poolWidgets"!==this.name&&
1!==a.maxWidgets)return;a=this.createMoveableNode("group",a)}else a=a.uri?this.createMoveableNode("widget",a):this.createMoveableNode("placeholder",a);a&&this.nodeList.insertNode(a)}));"poolWidgets"===this.name&&this.nodeList.insertNode(this.createMoveableNode("empty"));this.placeNodes();if(e&&(c=this.nodeList.getNodeByLabel(e)))this.openGroup(c),c.status="open"},getListHeight:function(){var a=0;this.nodeList.visitNodes(function(c){a=Math.max(c.pos.r,a)});return 118*a},_removeActive:function(){m(".node-margin-active",
this.domNode).removeClass("node-margin-active");m(".empty-node-active",this.domNode).removeClass("empty-node-active");m(".node-active",this.domNode).removeClass("node-active")},bindMoveEvent:function(b){"addBtn"!==b.type&&b.dnd&&(h.after(b.dnd,"onMove",f.hitch(this,function(c,d,e){c=this.getMousePosition(e);this.mouseNode=this.getNodeByMousePosition(b,c);this._removeActive();this.mouseNode&&"margin"===this.mouseNode.type?a.addClass(this.mouseNode.domNode,"node-margin-active"):this.mouseNode&&"empty"===
this.mouseNode.type?a.addClass(this.mouseNode.domNode,"empty-node-active"):this.mouseNode&&("group"===this.mouseNode.type||"widget"===this.mouseNode.type)&&a.addClass(this.mouseNode.domNode,"node-active")}),!0),h.after(b.dnd,"onMoveStart",f.hitch(this,function(){this.destroyShadowNode();this.createShadowNode(b);a.setStyle(b.boxNode,"cursor","move")}),!0),h.after(b.dnd,"onMoveStop",f.hitch(this,this._onMoveStop,b),!0))},_onMoveStop:function(b){var c=!1;a.setStyle(b.boxNode,"cursor","pointer");this.mouseNode&&
(b===this.mouseNode?console.log("move to the same node"):"margin"===this.mouseNode.type?(this.moveNodeToMargin(b,this.mouseNode),c=!0):"empty"===this.mouseNode.type?this.mouseNode.gnode&&"group"===b.type?console.log("not allow move group to opened group, revert"):(this.moveNodeToEmpty(b,this.mouseNode),c=!0):"group"===this.mouseNode.type?"group"===b.type?console.log("not allow move group to closed group, revert"):"open"===this.mouseNode.status?console.log("please put widget into the opened group panel"):
!1===b.setting.inPanel?this._showOffPanelToGroupError():b.gnode&&b.gnode===this.mouseNode?console.log("the moving widget is already in the group"):(this.moveWidgetToGroup(b,this.mouseNode),c=!0):"widget"===this.mouseNode.type&&("group"===b.type?console.log("not allow move group to widget, revert"):!1===b.setting.inPanel||!1===this.mouseNode.setting.inPanel?this._showOffPanelToGroupError():b.gnode||this.mouseNode.gnode?console.log("can not nest group"):(this.moveWidgetToWidget(b,this.mouseNode),c=
!0)),this._reopenGroup());this.destroyShadowNode();c&&this.publishPoolChangeEvent();this.placeNodes()},_reopenGroup:function(){if(this.openedGNode){var a=this.openedGNode;this.closeGroup(a);this.nodeList.isExist(a)&&this.openGroup(a)}},getNodePosition:function(a){var c={},d;d=Math.ceil(a/u);a%=u;0===a&&(a=u);c.t=118*(d-1);var e=89*(a-1)+15;c.l=window.isRTL?s.w-e-74:e;c.w=74;c.h=118;c.r=d;c.c=a;return c},getMarginNodePosition:function(a){var c={};a=a.pos;c.l=window.isRTL?a.l+74+7.5:a.l-7.5-2.5;c.t=
a.t;c.w=5;c.h=118;return c},createMarginNode:function(b){var c=new t({label:b.label,node:b});a.place(c.domNode,this.domNode);return b.margin=c},getMousePosition:function(a){return{x:a.pageX-this.position.x,y:a.pageY-this.position.y+this.domNode.scrollTop}},moveNodeToMargin:function(a,c){var d=this.getNodeByMarginNode(c);console.log("moveNodeToMargin");m(".node-margin-active",this.domNode).removeClass("node-margin-active");d.gnode&&!a.gnode?a.gnode=d.gnode:!d.gnode&&a.gnode&&(a.gnode=null);this.nodeList.moveNode(a,
d)},moveNodeToEmpty:function(a,c){m(".empty-node-active",this.domNode).removeClass("empty-node-active");c.gnode&&!a.gnode?a.gnode=c.gnode:!c.gnode&&a.gnode&&(a.gnode=null);this.nodeList.moveNode(a,c)},getNodeByMarginNode:function(a){var c;this.nodeList.visitNodes(function(d){d.margin===a&&(c=d)});return c},placeNodes:function(){var b,c;this.nodeList.visitNodes(f.hitch(this,function(d,e){b=this.getNodePosition(e);d.pos=b;a.setStyle(d.domNode,r(b));c=this.getMarginNodePosition(d);d.margin.pos=c;a.setStyle(d.margin.domNode,
r(c))}));this.nodeList.printNodeList()},moveWidgetToGroup:function(a,c){a&&a.setting&&delete a.setting.openAtStart;c.addWidget(a);this.nodeList.removeNode(a)},moveWidgetToWidget:function(a,c){var d;a&&a.setting&&delete a.setting.openAtStart;d=this.createMoveableNode("group",{label:this._getGroupLabel(),widgets:[a.setting,c.setting]});this.nodeList.insertNode(d,c);this.nodeList.removeNode(a);this.nodeList.removeNode(c)},createShadowNode:function(b){this.shadowNode=a.create("div",{"class":"node-shadow",
style:r(a.getMarginBox(b.domNode))},this.domNode)},destroyShadowNode:function(){this.shadowNode&&a.destroy(this.shadowNode)},getNodeByMousePosition:function(a,c){var d;this.nodeList.visitNodes(function(e){if("addBtn"!==e.type){if(c.x>e.pos.l+10&&(c.x<e.pos.l+e.pos.w-10&&c.y>e.pos.t+10&&c.y<e.pos.t+e.pos.h-10)&&e!==a)return d=e,!0;if(c.x>e.margin.pos.l&&(c.x<e.margin.pos.l+e.margin.pos.w&&c.y>e.margin.pos.t&&c.y<e.margin.pos.t+e.margin.pos.h)&&e.margin!==a)return d=e.margin,!0}});return d},_getGroupLabel:function(){var a=
-1;this.appConfig.visitElement(f.hitch(this,function(c){if(c.widgets)if(c.label===this.nls.newGroup)a=0;else if(c.label.startWith(this.nls.newGroup)){var d=c.label.lastIndexOf("_");-1<d&&(c=parseInt(c.label.substr(d+1,c.label.length),10),a=Math.max(a,c))}}));return-1===a?this.nls.newGroup:this.nls.newGroup+"_"+(a+1)},_showOffPanelToGroupError:function(){console.log("Off panel widget is not allowed in group.");this.emit("offpanel-group-error")},_onWidgetChoosePageOk:function(a,c){if(c.listName===this.name)if(1===
a.length){var d;"addBtn"===c.type?d=a[0]:"group"===c.type?d=a[0]:(d=f.clone(c.setting),f.mixin(d,a[0]));k.publish("editWidget",d,c)}else"addBtn"===c.type&&(l.forEach(a,function(a){this.addWidget(a)},this),this.publishPoolChangeEvent())},_onWidgetSettingPageOk:function(a,c){if(c.listName===this.name)if(a.id)k.publish("widgetChanged",a);else if("poolWidgets"===this.name)this.addWidget(a),this.publishPoolChangeEvent();else if("group"===c.type){var d=f.clone(this.appConfig.getConfigElementById(c.setting.id));
d.widgets=[a];k.publish("groupChanged",d)}},publishPoolChangeEvent:function(){var a=[],c=[];this.nodeList.visitNodes(function(d,e){"widget"===d.type&&!d.gnode?(d.setting.index=e,c.push(d.setting)):"group"===d.type&&(d.setting.index=e,a.push(d.setting))});k.publish("widgetPoolChanged",{widgets:c,groups:a,controllerId:this.controller.id})}})})},"builder/plugins/widget-config/MoveableNode":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dojo/Evented dojo/aspect dojo/mouse dojo/touch dojo/topic dojo/query ./Mover dojo/dnd/move dijit/_WidgetBase jimu/dijit/Message jimu/utils dojo/NodeList-dom dojo/NodeList-manipulate".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s){var t="click",b=q.enter,v=q.leave;"ontouchstart"in document&&(t=m.press,b=m.enter,v=m.leave);return p([r,k],{type:"",label:"",isMoving:!1,isMouseDown:!1,postCreate:function(){this.inherited(arguments);"addBtn"===this.type?(this.label="addBtn",this.createAddBtn()):"empty"===this.type?(this.label="empty",this.createEmptyNode()):"widget"===this.type?(this.createWidgetNode(),"poolWidgets"===this.listName&&(this.dnd=new d.boxConstrainedMoveable(this.domNode,{handle:this.boxNode,
box:this.parentBox,within:!0,delay:5,mover:c}),this.bindMoveEvent())):"placeholder"===this.type?this.createPlaceholderNode():(this.createGroupNode(),"poolWidgets"===this.listName&&(this.dnd=new d.boxConstrainedMoveable(this.domNode,{handle:this.boxNode,box:this.parentBox,within:!0,delay:5,mover:c}),this.bindMoveEvent()));f.addClass(this.domNode,"moveable");f.setStyle(this.domNode,{width:this.w+"px",height:this.h+"px"})},bindMoveEvent:function(){h.after(this.dnd,"onMoveStart",a.hitch(this,function(){this.isMoving=
!0}),!0);h.after(this.dnd,"onMoveStop",a.hitch(this,function(){this.isMoving=!1}),!0)},_createWidgetIconNode:function(){var a=s.processUrlInAppConfig(this.setting.icon);this.iconNode=f.create("img",{"class":"icon",src:a,style:{width:"32px",height:"32px",margin:(this.w-32)/2+"px"}},this.boxNode)},_createPlaceholderNode:function(){this.placeholderNode=f.create("div",{"class":"placeholder",style:{width:"32px",height:"32px",margin:(this.w-32)/2+"px"}},this.boxNode);f.create("div",{"class":"placeholder-inner",
innerHTML:this.setting.placeholderIndex,style:{width:"16px",height:"16px",lineHeight:"16px",borderRadius:"8px",margin:"7px"}},this.placeholderNode)},createWidgetNode:function(){f.addClass(this.domNode,"widget-node");f.setAttr(this.domNode,"data-widget-name",this.setting.name);this.boxNode=f.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);this._createWidgetIconNode();this.label=this.setting.label?this.setting.label:this.nls.defaultWidgetLabel;this.name=this.setting.name?
this.setting.name:this.nls.defaultWidgetLabel;this.labelNode=f.create("div",{"class":"label",innerHTML:s.stripHTML(this.label),title:this.label},this.domNode);!1===this.setting.visible&&f.addClass(this.domNode,"hide");this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(l(this.openAtStartNode,t,a.hitch(this,function(a){a.stopPropagation();this.emit("clickOpenAtStart")}))));this.own(l(this.boxNode,b,a.hitch(this,function(){g.publish("actionTriggered",{elementId:this.setting.id,
action:"highLight"});this.editNode=this._createEditNode();this.own(l(this.editNode,t,a.hitch(this,function(a){a.stopPropagation();g.publish("editWidget",this.setting,this)})));this.supportOpenAtStart()&&!this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(l(this.openAtStartNode,t,a.hitch(this,function(a){a.stopPropagation();this.emit("clickOpenAtStart")}))));this.setting.isThemeWidget||(!1===this.setting.inPanel&&this.setting.isOnScreen&&"undefined"===typeof this.setting.closeable?
(this.switchNode=this._createSwitchNode(),this.own(l(this.switchNode,t,a.hitch(this,function(b){b.stopPropagation();b=a.clone(this.setting);!1===b.visible?(b.visible=!0,f.removeClass(this.domNode,"hide")):(b.visible=!1,f.addClass(this.domNode,"hide"));g.publish("widgetChanged",b)})))):(this.dropNode=this._createDropNode(),this.own(l(this.dropNode,t,a.hitch(this,function(b){b.stopPropagation();var c=new u({message:this.nls.dropWidgetMessage,buttons:[{label:this.nls.ok,onClick:a.hitch(this,function(){"poolWidgets"===
this.listName?this.emit("removeNode"):(this.setting.uri="",this.setting.label=this.nls.defaultWidgetLabel,this.setting.name=void 0,this.setting.placeholderIndex="?",this.setting.config=void 0,this.label=this.nls.defaultWidgetLabel,this.labelNode.innerHTML=s.stripHTML(this.label),s.widgetJson.removeManifestFromWidgetJson(this.setting),g.publish("widgetChanged",this.setting));c.close()})},{label:this.nls.cancel}]})})))))})));this.own(l(this.boxNode,v,a.hitch(this,function(){g.publish("actionTriggered",
{elementId:this.setting.id,action:"removeHighLight"});this.editNode&&f.destroy(this.editNode);this.openAtStartNode&&!this.setting.openAtStart&&f.destroy(this.openAtStartNode);this.dropNode&&f.destroy(this.dropNode);this.switchNode&&f.destroy(this.switchNode)})))},createPlaceholderNode:function(){f.addClass(this.domNode,"widget-node");f.addClass(this.domNode,"placeholder");f.setAttr(this.domNode,"data-placeholder-index",this.setting.placeholderIndex);this.boxNode=f.create("div",{"class":"box",style:{width:this.w+
"px",height:this.w+"px"}},this.domNode);this._createPlaceholderNode();this.label=this.setting.label?this.setting.label:this.nls.defaultWidgetLabel;this.name=this.setting.name?this.setting.name:this.nls.defaultWidgetLabel;this.labelNode=f.create("div",{"class":"label",innerHTML:s.stripHTML(this.label),title:this.label},this.domNode);this.own(l(this.boxNode,b,a.hitch(this,function(){g.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"})})));this.own(l(this.boxNode,v,a.hitch(this,
function(){g.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"})})));this.own(l(this.domNode,t,a.hitch(this,function(){g.publish("chooseWidget",this,this.listName)})))},createGroupNode:function(){"poolWidgets"===this.listName?this._createPoolGroupNode():this._createOnScreenGroupNode()},_createOnScreenGroupNode:function(){if(1===this.setting.maxWidgets){f.addClass(this.domNode,"group-node");this.boxNode=f.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+
"px"}},this.domNode);if(0===this.setting.widgets.length)this.iconNode=f.create("img",{src:this.folderUrl+"css/images/add_onscreen_widget.png","class":"add-button",title:this.nls.addWidget},this.boxNode),this.name=this.label=this.nls.defaultWidgetLabel;else{var c=s.processUrlInAppConfig(this.setting.widgets[0].icon);this.iconNode=f.create("img",{"class":"icon",src:c,style:{width:"32px",height:"32px",margin:(this.w-32)/2+"px"}},this.boxNode);c=this.setting.widgets[0];this.label=c.label;this.name=c.name}this.labelNode=
f.create("div",{"class":"label",innerHTML:s.stripHTML(this.label),title:this.label},this.domNode);this.own(l(this.boxNode,b,a.hitch(this,function(){g.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"});0!==this.setting.widgets.length&&(this.editNode=this._createEditNode(),this.own(l(this.editNode,t,a.hitch(this,function(a){a.stopPropagation();g.publish("editWidget",this.setting.widgets[0],this)}))),this.own(l(this.editNode,"mousedown",function(a){a.stopPropagation()})),this.own(l(this.editNode,
"mouseup",function(a){a.stopPropagation()})),this.dropNode=this._createDropNode(),this.own(l(this.dropNode,t,a.hitch(this,function(b){var c=new u({message:this.nls.dropWidgetMessage,buttons:[{label:this.nls.ok,onClick:a.hitch(this,function(){var b=a.clone(this.setting);b.widgets=[];g.publish("groupChanged",b);c.close()})},{label:this.nls.cancel}]});b.stopPropagation()}))),this.own(l(this.dropNode,"mousedown",function(a){a.stopPropagation()})),this.own(l(this.dropNode,"mouseup",function(a){a.stopPropagation()})))})));
this.own(l(this.boxNode,v,a.hitch(this,function(){g.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"});this.editNode&&f.destroy(this.editNode);this.dropNode&&f.destroy(this.dropNode)})));this.own(l(this.boxNode,t,a.hitch(this,function(){g.publish("chooseWidget",this,this.listName)})))}},_createPoolGroupNode:function(){f.addClass(this.domNode,"group-node");this.boxNode=f.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);this.label=
this.setting.label?this.setting.label:"Group";this.name=this.setting.name?this.setting.name:"Group";this.labelNode=f.create("div",{"class":"label",innerHTML:s.stripHTML(this.setting.label),title:this.setting.label},this.domNode);this._createSmallWidgets();this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(l(this.openAtStartNode,t,a.hitch(this,function(a){a.stopPropagation();this.emit("clickOpenAtStart")}))));this.own(l(this.boxNode,b,a.hitch(this,function(){g.publish("actionTriggered",
{elementId:this.setting.id,action:"highLight"});this.editNode=this._createEditNode();this.own(l(this.editNode,t,a.hitch(this,function(a){a.stopPropagation();g.publish("editGroup",this,this.setting)})));this.own(l(this.editNode,"mousedown",function(a){a.stopPropagation()}));this.own(l(this.editNode,"mouseup",function(a){a.stopPropagation()}));this.supportOpenAtStart()&&!this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(l(this.openAtStartNode,t,a.hitch(this,function(a){a.stopPropagation();
this.emit("clickOpenAtStart")}))));this.dropNode=this._createDropNode();this.own(l(this.dropNode,t,a.hitch(this,function(b){var c=new u({message:this.nls.dropGroupMessage,buttons:[{label:this.nls.ok,onClick:a.hitch(this,function(){this.emit("removeNode");c.close()})},{label:this.nls.cancel}]});b.stopPropagation()})));this.own(l(this.dropNode,"mousedown",function(a){a.stopPropagation()}));this.own(l(this.dropNode,"mouseup",function(a){a.stopPropagation()}))})));this.own(l(this.boxNode,v,a.hitch(this,
function(){g.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"});this.editNode&&f.destroy(this.editNode);this.openAtStartNode&&!this.setting.openAtStart&&f.destroy(this.openAtStartNode);this.dropNode&&f.destroy(this.dropNode)})));this.own(l(this.boxNode,t,a.hitch(this,function(a){a.preventDefault();a.stopPropagation();"open"===this.status?this.closeGroup():this.openGroup()})))},closeGroup:function(){this.status="close"},openGroup:function(){this.status="open"},createAddBtn:function(){f.addClass(this.domNode,
"add-widget-node");var b=f.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"},title:this.nls.addWidget},this.domNode);f.create("img",{src:this.folderUrl+"css/images/add_widget.png"},b);this.own(l(this.domNode,t,a.hitch(this,function(){g.publish("chooseWidget",this,this.listName)})))},createEmptyNode:function(){f.addClass(this.domNode,"empty-node");f.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode)},_createEditNode:function(){var a={bottom:"0",
width:"20px",height:"20px"};a[window.isRTL?"left":"right"]="0";return f.create("div",{"class":"edit-btn",style:a,title:this.nls.configureWidget},this.boxNode)},supportOpenAtStart:function(){var a=this.setting;return!a.isController&&(!a.isThemeWidget&&a.visible)&&(a.isOnScreen&&a.closeable||a.inPanel&&a.isOnScreen||!a.isOnScreen&&!this.gnode||"group"===this.type)},_createOpenAtStartNode:function(){var a={bottom:"4px",width:"12px",height:"12px"};a[window.isRTL?"right":"left"]="4px";return f.create("div",
{"class":this.setting.openAtStart?"open-at-start-btn active":"open-at-start-btn deactive",style:a,title:this.setting.openAtStart?this.nls.activeOpenAtStart:this.nls.deactiveOpenAtStart},this.boxNode)},_createDropNode:function(){var a={top:"0",width:"20px",height:"20px"};a[window.isRTL?"left":"right"]="0";return f.create("div",{"class":"drop-btn",style:a,title:this.nls.removeWidget},this.boxNode)},_createSwitchNode:function(){var a=f.hasClass(this.domNode,"hide")?this.nls.showWidget:this.nls.hideWidget,
b={top:"3px",width:"15px",height:"10px"};b[window.isRTL?"left":"right"]="3px";return f.create("div",{"class":"switch-btn",style:b,title:a},this.boxNode)},_createSmallWidgets:function(){e(".small",this.boxNode).remove();var b=[],c=!1;4<this.setting.widgets.length?(b=this.setting.widgets.slice(0,3),c=!0):(b=this.setting.widgets,c=!1);b.forEach(a.hitch(this,function(a){this._createSmallWidget(a)}));c&&this._createSmallMore()},_createSmallWidget:function(a){var b;b=f.create("div",{"class":"small small-widget",
"data-wid":a.id,style:{width:"20px",height:"20px",marginLeft:(this.w-40)/3+"px",marginTop:(this.w-40)/3+"px"}},this.boxNode);var c=a.icon;if(a.icon.startWith("widgets")||a.icon.startWith("configs")||a.icon.startWith("themes"))c=require(s.getRequireConfig()).toUrl(a.icon);f.create("img",{src:c,style:{width:"20px",height:"20px"}},b);return b},_createSmallMore:function(){var a;a=f.create("div",{"class":"small small-more",style:{width:"20px",height:"20px",marginLeft:(this.w-40)/3+"px",marginTop:(this.w-
40)/3+"px"}},this.boxNode);f.create("img",{src:"builder/images/more_widget.png",style:{width:"20px"}},a);return a},addWidget:function(a){"group"!==this.type?console.log("can not add widget to widget"):(this.setting.widgets.push(a.setting),this._createSmallWidgets())},updateSmallWidgets:function(){this._createSmallWidgets()},destroy:function(){this.margin&&this.margin.destroy();this.inherited(arguments)}})})},"builder/plugins/widget-config/Mover":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/sniff dojo/_base/window dojo/dom dojo/dom-geometry dojo/dom-style dojo/Evented dojo/on dojo/touch dojo/dnd/common dojo/dnd/autoscroll".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r){l.add("ie11",function(){var a=-1,c="",d=null;"Microsoft Internet Explorer"===navigator.appName?(c=navigator.userAgent,d=/MSIE ([0-9]{1,}[.0-9]{0,})/,null!==d.exec(c)&&(a=parseFloat(RegExp.$1))):"Netscape"===navigator.appName&&(c=navigator.userAgent,d=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/,null!==d.exec(c)&&(a=parseFloat(RegExp.$1)));return a});return f("dojo.dnd.Mover",[g],{constructor:function(d,f,g){function b(a){a.preventDefault();a.stopPropagation()}this.node=
h.byId(d);this.marginBox={l:f.pageX,t:f.pageY};this.mouseButton=f.button;f=this.host=g;d=d.ownerDocument;this.events=[e(d,c.move,a.hitch(this,"onFirstMove")),e(d,c.move,a.hitch(this,"onMouseMove")),e(d,c.release,a.hitch(this,"onMouseUp")),e(d,"dragstart",b),e(d.body,"selectstart",b)];r.autoScrollStart(d);if(f&&f.onMoveStart)f.onMoveStart(this)},onMouseMove:function(a){r.autoScroll(a);var c=this.marginBox;this.host.onMove(this,{l:c.l+a.pageX,t:c.t+a.pageY},a);a.preventDefault();a.stopPropagation()},
onMouseUp:function(a){var c=l("webkit")&&l("mac")&&2===this.mouseButton,d=(l("ie")||l("ie11"))&&-1===this.mouseButton;(c||d?0===a.button:this.mouseButton===a.button)&&this.destroy();a.preventDefault();a.stopPropagation()},onFirstMove:function(a){var c=this.node.style,d,b=this.host;switch(c.position){case "relative":case "absolute":d=Math.round(parseFloat(c.left))||0;c=Math.round(parseFloat(c.top))||0;break;default:c.position="absolute";c=q.getMarginBox(this.node);d=k.doc.body;var e=m.getComputedStyle(d),
f=q.getMarginBox(d,e),e=q.getContentBox(d,e);d=c.l-(e.l-f.l);c=c.t-(e.t-f.t)}this.marginBox.l=d-this.marginBox.l;this.marginBox.t=c-this.marginBox.t;if(b&&b.onFirstMove)b.onFirstMove(this,a);this.events.shift().remove()},destroy:function(){p.forEach(this.events,function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"builder/plugins/widget-config/LinkList":function(){define(["dojo/_base/declare","dojo/_base/html","dojo/_base/array"],
function(p){return p(null,{headNode:null,currentNode:null,constructor:function(f){this.name=f.name},visitNodes:function(f){for(var a=this.headNode,l=1;a;)f(a,l),l++,a=a.next},destroyAllNodes:function(){for(var f=this.headNode,a;f;)a=f.next,f.destroy(),f=a;this.headNode=null},getCount:function(){var f=0;this.visitNodes(function(a,l){f=l});return f},isExist:function(f){var a=!1;this.visitNodes(function(l){l===f&&(a=!0)});return a},printNodeList:function(){this.visitNodes(function(f){})},getPreNode:function(f){var a;
this.visitNodes(function(l){l.next===f&&(a=l)});return a},getNodeByIndex:function(f){var a;this.visitNodes(function(l,k){k===f&&(a=l)});return a},getNodeByLabel:function(f){var a;this.visitNodes(function(l){l.label===f&&(a=l)});return a},getNodeIndex:function(f){var a;this.visitNodes(function(l,k){l===f&&(a=k)});return a},removeNode:function(f){var a;(a=this.getPreNode(f))?a.next=f.next:this.headNode=f.next;f.destroy()},removeNodeByIndex:function(f){this.removeNode(this.getNodeByIndex(f))},insertNode:function(f,
a){var l,k;l="number"===typeof a?this.getNodeByIndex(a):a;(k=this.getPreNode(l))?k.next=f:this.headNode=f;f.next=l},moveNode:function(f,a){var l=this.getPreNode(f),k=this.getPreNode(a);f!==a&&f!==k&&(l?l.next=f.next:this.headNode=f.next,f.next=a,k?k.next=f:this.headNode=f)}})})},"builder/plugins/widget-config/WidgetSettingPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/config dojo/Deferred dojo/request dojo/topic dojo/aspect dojo/on dojo/mouse dojo/query dojo/string dojo/NodeList-dom dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./WidgetSettingPage.html ./WidgetDefaultSettingPage jimu/utils jimu/WidgetManager jimu/portalUrlUtils jimu/portalUtils jimu/dijit/ViewStack jimu/dijit/ImageChooser jimu/dijit/LoadingIndicator jimu/dijit/Message dijit/form/CheckBox esri/request".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x,z,y,A,B,F,E,H,I){var M="en de es fr ja ru zh-cn zh-tw zh-hk ar it ko pl pt-br pt-pt ro".split(" "),Q="nearme districtlookup relatedtablecharts infosummary situationawareness reviewerdashboard reportfeature imagemeasurement batchattributeeditor".split(" "),K=null;return p([s,t,b],{templateString:v,startup:function(){this.inherited(arguments);this.own(q("builder/widgethelp.json",{handleAs:"json"}).then(function(a){K=a},function(a){console.error(a)}).always(f.hitch(this,
function(){this.domNode&&(this.own(e(window,"resize",f.hitch(this,this.resize))),this.init())})))},init:function(){this.loading=new F;a.addClass(this.loading.domNode,"load-widget-setting");this.loading.placeAt(this.widgetSettingNode);this.initCommonAttr();this.initWidgetAttr();this.resize()},resize:function(){var b=a.getContentBox(this.domNode);a.setStyle(this.widgetSettingNode,{height:b.h-90+"px"})},onCancel:function(){this.onClose();this.popup.close()},onOk:function(){var a=this._checkLabelExist();
if(a)return new E({message:a}),!1;this.imageChooser.imageData&&(this.setting.icon=this.imageChooser.imageData);this.setting.label=w.stripHTML(this.labelNode.get("value"));if(this.settingDijit){a=this.settingDijit.getConfig(!0);if(!1===a)return!1;this.setting.config=a}delete this.setting.isDefaultConfig;m.publish("widgetSettingPageOk",this.setting,this.fromNode);this.onClose();this.popup.close()},_checkLabelExist:function(){var a=0,b=this.labelNode.get("value");if(""===r.trim(b))return this.nls.labelRequired;
var c=w.getControllerWidgets(this.appConfig);this.appConfig.visitElement(f.hitch(this,function(d){this.setting.id!==d.id&&d.label===b&&(0<c.length?a++:d.isOnScreen&&a++)}));return 0<a?this.nls.labelExists:""},onClose:function(){this.settingViewStack?(this.settingDijitUI.destroy(),this.settingDijitJSON.destroy(),this.settingViewStack.destroy()):this.settingDijit&&this.settingDijit.destroy()},_getHelpLink:function(a,b){var c=new h,d=null;a=a.toLowerCase();b="html"===(b||"html").toLowerCase()?"widgets2d":
"widgets3d";if(window.isXT)q("/webappbuilder/help/exists",{handleAs:"json"}).then(f.hitch(this,function(e){!e||!e.exists?c.resolve("#"):q("/webappbuilder/help/cxhelp.js",{handleAs:"json"}).then(f.hitch(this,function(e){var g="#";d=f.getObject("dev."+b+"."+a,!1,K);e&&e.m&&d&&e.m[d]?g="/webappbuilder/help/"+e.m[d]:d&&(g="/webappbuilder/help/"+d);c.resolve(g)}),f.hitch(this,function(a){console.warn(a);c.resolve("#")}))}),function(a){console.error(a);c.resolve("#")});else{var e=z.getPortalUrlFromLocation();
if(-1<e.indexOf("arcgis.com")){var g="#",d=f.getObject("online."+b+"."+a,!1,K);"widgets3d"===b||k.locale.toLowerCase().startWith("en")||-1<Q.indexOf(a)||-1===M.indexOf(k.locale.toLowerCase())?(d&&(g="http://"+(-1<e.indexOf("maps.arcgis.com")?"doc":"docdev")+".arcgis.com/en/web-appbuilder/create-apps/"+d),c.resolve(g)):(g={url:z.getPortalSelfInfoUrl(e),content:{f:"json",culture:k.locale},handleAs:"json",callbackParamName:"callback",preventCache:!0},I(g).then(f.hitch(this,function(a){var b="#";if(a&&
a.helpBase&&d)try{b=a.helpBase.split("/").slice(0,4).join("/")+"/web-appbuilder/create-apps/"+d}catch(e){b="http://doc.arcgis.com/en/web-appbuilder/create-apps/"+d}c.resolve(b)}),f.hitch(this,function(a){console.warn(a);c.resolve("#")})))}else{var l=k.locale||"en",d=f.getObject("portal."+b+"."+a,!1,K);q(e+"portalhelp/en/website/help/cxhelp.js",{handleAs:"json"}).then(f.hitch(this,function(a){var b="#";a&&(a.m&&d&&a.m[d])&&(b=e+"portalhelp/"+l+"/website/help/"+a.m[d]);c.resolve(b)}),f.hitch(this,function(a){console.warn(a);
c.resolve("#")}))}}return c},initCommonAttr:function(){var b=w.processUrlInAppConfig(this.setting.icon);a.setAttr(this.iconNode,"src",b);this.labelNode.set("value",this.setting.label);this._getHelpLink(this.setting.name,f.getObject("manifest.platform",!1,this.setting)).then(f.hitch(this,function(b){"#"!==b&&(a.setStyle(this.helpNode,"display","inline-block"),a.setAttr(this.helpNode,"href",b))}));this.imageChooser=new B({goldenWidth:24,goldenHeight:24,format:[B.GIF,B.JPEG,B.PNG],label:this.nls.changeIcon},
this.imageChooserPlaceholder);a.addClass(this.imageChooser.domNode,"jimu-float-leading");!1===this.setting.inPanel&&!0===this.setting.isOnScreen&&!0!==this.setting.closeable?(this.imageChooser.disableChooseImage(),a.setAttr(this.imageChooser.domNode,"title",this.nls.unableChangeIcon)):(this.imageChooser.enableChooseImage(),this.own(e(this.imageChooser,"imageChange",f.hitch(this,function(a){this.iconNode.src=a;this.setting.icon=a}))))},initWidgetAttr:function(){!1===this.setting.hasConfig?this.widgetSettingNode.innerHTML=
'\x3cdiv class\x3d"noconfig-info"\x3e'+this.nls.noConfig+"\x3c/div\x3e":x.getInstance().tryLoadWidgetConfig(this.setting).then(f.hitch(this,function(b){this.setting.hasSettingPage?x.getInstance().loadWidgetSettingPage(this.setting).then(f.hitch(this,function(b){this.widgetSettingNode?(this.settingDijit=b,a.place(this.settingDijit.domNode,this.widgetSettingNode),this.settingDijit.startup(),this.loading.destroy()):b.destroy()})):this.widgetSettingNode&&(this.settingDijit=new n({config:this.setting.config}),
a.place(this.settingDijit.domNode,this.widgetSettingNode),this.settingDijit.startup(),this.loading.destroy())}))},setAppConfig:function(a){this.appConfig=a}})})},"builder/plugins/widget-config/WidgetDefaultSettingPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/keys dijit/_WidgetBase ./JSONEditor".split(" "),function(p,f,a,l,k,h){return p([k],{baseClass:"widget-default-setting",postCreate:function(){this.inherited(arguments);this.jsonEditor=new h({json:this.config});this.jsonEditor.placeAt(this.domNode);
this.own(a(this.domNode,"keydown",f.hitch(this,"_onEnterPress")))},_onEnterPress:function(a){(void 0!==a.keyCode?a.keyCode:a.which)===l.ENTER&&a.stopPropagation()},setConfig:function(a){return this.jsonEditor.setJSON(a)},getConfig:function(){return this.jsonEditor.getJSON()}})})},"builder/plugins/widget-config/JSONEditor":function(){define(["dojo/_base/declare","dijit/_WidgetBase"],function(p,f){return p([f],{baseClass:"json-editor",postCreate:function(){this.inherited(arguments);this.editor=ace.edit(this.domNode);
this.editor.setTheme("ace/theme/textmate");this.editor.setHighlightActiveLine(!0);this.editor.setValue(JSON.stringify(this.json,null,2));this.editor.getSession().setMode("ace/mode/json")},setJSON:function(a){this.json=a;this.editor.setValue(JSON.stringify(this.json,null,2))},getJSON:function(){return JSON.parse(this.editor.getValue())}})})},"builder/plugins/widget-config/GroupSettingPage":function(){define("dojo/_base/declare dojo/dom-attr dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./GroupSettingPage.html".split(" "),
function(p,f,a,l,k,h){return p([l,k],{templateString:h,baseClass:"group-setting-page",startup:function(){this.labelNode.value=this.setting.label},onOk:function(){this.setting.label=f.get(this.labelNode,"value");a.publish("groupChanged",this.setting);this.popup.close()},onCancel:function(){}})})},"builder/plugins/widget-config/WidgetChoosePage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/topic dojo/on dojo/Deferred dojo/promise/all dojo/query dojo/NodeList-dom dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./WidgetChoosePage.html jimu/dijit/Search jimu/WidgetManager jimu/dijit/LoadingShelter jimu/dijit/Message jimu/utils builder/serviceUtils".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n){return p([c,d],{templateString:r,postMixInProperties:function(){this.widgetManager=s.getInstance()},startup:function(){this.inherited(arguments);this.searchDijit=new u({placeholder:this.nls.widgetSearchHint,onSearch:f.hitch(this,this.searchWidget),searchWhenInput:!0},this.searchInputNode);this._getWidgets();this.own(h(window,"resize",f.hitch(this,this.resize)));setTimeout(f.hitch(this,function(){this.resize()}),100);this.loading=new t({hidden:!0});this.loading.placeAt(this.domNode);
this.loading.startup()},searchWidget:function(a){var b;b=""===a?this.allWidgets:l.filter(this.allWidgets,function(b){if(-1<b.label.toUpperCase().indexOf(a.toUpperCase()))return!0});this._createWidgetNodes(b)},resize:function(){var b=a.getContentBox(this.domNode).h,c=b-60;a.setStyle(this.searchSectionNode,{height:b+"px"});a.setStyle(this.widgetListNode,{height:c+"px"})},setAppConfig:function(a){this.appConfig=a},_getWidgets:function(){var a={};this.appConfig.map["2D"]&&(a.support2D=!0);this.appConfig.map["3D"]&&
(a.support3D=!0);this.appConfig.map["2D"]&&this.appConfig.map["3D"]&&(a.support2D=!0,a.support3D=!0);a.platform=window.stemappInfo.appType;this.options.includeOffPanel||(a["properties.inPanel"]=!0);n.searchWidgets(a).then(f.hitch(this,function(a){a.success?(this.allWidgets=this._filterSingletonWidgets(a.widgets),this._createWidgetNodes(this.allWidgets)):console.log(a.message)}))},_filterSingletonWidgets:function(a){return l.filter(a,function(a){return!1===a.properties.supportMultiInstance&&this._checkWidgetIsInAppConfig(this.appConfig,
a.name)?!1:!0},this)},_checkWidgetIsInAppConfig:function(a,b){var c=[];0===v.getControllerWidgets(a).length?a.visitElement(f.hitch(this,function(a){a.isOnScreen&&a.name===b&&c.push(a)})):c=a.getConfigElementsByName(b);return 0<c.length},_createWidgetNodes:function(b){a.empty(this.widgetListNode);l.forEach(b,function(a){v.manifest.processManifestLabel(a,dojoConfig.locale);this._createWidgetNode(a)},this)},_createWidgetNode:function(b){var c,d;c=a.create("div",{"class":"widget-node","data-widget-name":b.name},
this.widgetListNode);d=a.create("div",{"class":"box"},c);a.create("div",{"class":"box-selected"},c);a.create("img",{"class":"icon",src:b.icon},d);a.create("div",{"class":"label",innerHTML:v.stripHTML(b.label),title:b.label},c);c.setting={name:b.name,label:b.label,version:b.version};v.manifest.addManifestProperies(b);v.widgetJson.addManifest2WidgetJson(c.setting,b);c.setting.icon="widgets/"+b.name+"/images/icon.png";c.setting.uri="widgets/"+b.name+"/Widget";v.widgetJson.processWidgetJson(c.setting);
c.box=d;this.own(h(c,"click",f.hitch(this,this._onWidgetClick,c)));return c},_onWidgetClick:function(b){"addBtn"===this.fromNode.type?a.hasClass(b,"jimu-state-selected")?a.removeClass(b,"jimu-state-selected"):a.addClass(b,"jimu-state-selected"):(g(".jimu-state-selected",this.domNode).removeClass("jimu-state-selected"),a.addClass(b,"jimu-state-selected"))},onOk:function(){var a=g(".jimu-state-selected",this.domNode);if(0===a.length)new b({message:this.nls.emptyMessage});else{this.loading.show();var c=
l.map(a,function(a){return f.clone(a.setting)}),d=[];l.forEach(c,function(a){d.push(this._copyWidget(a))},this);m(d).then(f.hitch(this,function(a){var d;for(d=0;d<a.length;d++)if(!a[d].success){new b({message:a[d].message});this.loading.hide();return}this.loading.hide();k.publish("widgetChoosePageOk",c,this.fromNode);this.popup.close()}))}},_copyWidget:function(a){var b=0,c,d=[],e=v.getControllerWidgets(this.appConfig);this.appConfig.visitElement(f.hitch(this,function(c){if(0!==e.length||c.isOnScreen)c.name===
a.name&&b++,d.push(c.label)}));if(0===b)a.label=a.label,c=n.copyWidgetToApp(window.appInfo.id,a.name);else if(0<b){c=new q;for(var g=a.label+"_"+(b+1);-1<d.indexOf(g);)b++,g=a.label+"_"+(b+1);a.label=g;c.resolve({success:!0})}return c}})})},"jimu/PoolControllerMixin":function(){define(["dojo/_base/declare","dojo/_base/array","jimu/PanelManager"],function(p,f,a){return p(null,{constructor:function(){this.panelManager=a.getInstance()},postCreate:function(){this.controlledWidgets||(this.controlledWidgets=
"all");this.controlledGroups||(this.controlledGroups="all")},getOpenedIds:function(){},setOpenedIds:function(a){},getConfigById:function(a){for(var f=this.getAllConfigs(),h=0;h<f.length;h++)if(f[h].id===a)return f[h]},getAllConfigs:function(){var a=[],a=a.concat(this.getWidgetConfigs(),this.getGroupConfigs()),a=f.filter(a,function(a){return a.visible});return a.sort(function(a,f){return a.index-f.index})},getAllConfigsIncludeInvisible:function(){var a=[],a=a.concat(this.getWidgetConfigs(),this.getGroupConfigs());
return a.sort(function(a,f){return a.index-f.index})},isControlled:function(a){return f.some(this.getAllConfigsIncludeInvisible(),function(f){return f.id===a})},widgetIsControlled:function(a){return f.some(this.getAllConfigsIncludeInvisible(),function(k){return k.id===a?!0:f.some(k.widgets,function(f){return f.id===a})})},getGroupConfigs:function(){var a=[];if(!this.appConfig.widgetPool)return a;this.appConfig.widgetPool.groups&&f.forEach(this.appConfig.widgetPool.groups,function(f){this.controlledGroups&&
(Array.isArray(this.controlledGroups)?-1<this.controlledGroups.indexOf(f.id)&&a.push(f):"all"===this.controlledGroups&&a.push(f))},this);return a},getWidgetConfigs:function(){var a=[];if(!this.appConfig.widgetPool)return a;this.appConfig.widgetPool.widgets&&f.forEach(this.appConfig.widgetPool.widgets,function(f){this.controlledWidgets&&(Array.isArray(this.controlledWidgets)?-1<this.controlledWidgets.indexOf(f.id)&&a.push(f):"all"===this.controlledWidgets&&a.push(f))},this);return a}})})},"jimu/PanelManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/Deferred dojo/promise/all dojo/on dojo/topic dojo/when require ./utils ./WidgetManager".split(" "),
function(p,f,a,l,k,h,q,m,g,e,c,d,r){var u,s=null;u=p(null,{constructor:function(){this.panels=[];this.widgetManager=r.getInstance();m(window,"resize",f.hitch(this,this.onWindowResize));this.activePanel=null;g.subscribe("/dnd/move/start",f.hitch(this,this._onMoveStart));g.subscribe("widgetActived",f.hitch(this,this._onWidgetActived))},showPanel:function(a){var b=new h,c=this.getPanelById(a.id+"_panel");c?("closed"===c.state&&this.openPanel(c),b.resolve(c)):q({Panel:this._loadPanelClass(a.panel.uri),
nls:this._loadThemeI18N(a.panel.uri)}).then(f.hitch(this,function(c){var e=a.id+"_panel",g=this.getPanelById(e),h={label:a.label,config:a,uri:a.panel.uri,position:a.panel.position,map:this.map,widgetManager:this.widgetManager,panelManager:this,id:e,gid:a.gid,nls:c.nls};f.mixin(h,a.panel.options);try{g=new c.Panel(h),console.log("panel ["+e+"] created.")}catch(k){console.log("create panel error: "+k+", panelId: "+e);b.reject(k);return}g.setPosition(a.panel.position);d.setVerticalCenter(g.domNode);
this.openPanel(g);this.panels.push(g);m(g.domNode,"click",f.hitch(this,this._onPanelClick,g));b.resolve(g)}));return b},setMap:function(a){this.map=a;m(this.map,"resize",f.hitch(this,this.onMapResize))},closeOtherPanelsInTheSameGroup:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;for(var b=0;b<this.panels.length;b++)this.panels[b].gid===a.gid&&this.panels[b].id!==a.id&&this.closePanel(this.panels[b])},closeAllPanelsInGroup:function(a){for(var b=0;b<this.panels.length;b++)this.panels[b].gid===
a&&this.closePanel(this.panels[b])},openPanel:function(a){var b=new h;if("string"===typeof a&&(a=this.getPanelById(a),!a))return b.reject(),b;if(!a.started)try{a.started=!0,a.startup()}catch(c){console.error("fail to startup panel "+a.id+". "+c.stack)}if("opened"===a.state)return b.resolve(a),b;a.setState("opened");return this.playOpenPanelAnimation(a).then(f.hitch(this,function(){l.setStyle(a.domNode,"display","");a.onOpen();this._activePanel(a);return a}))},closePanel:function(a){var b=new h;return"string"===
typeof a&&(a=this.getPanelById(a),!a)||"closed"===a.state?(b.resolve(),b):this.playClosePanelAnimation(a).then(function(){this.activePanel&&this.activePanel.id===a.id&&(this.activePanel.onDeActive(),this.activePanel=null);a.setState("closed");a.onClose();a.domNode&&l.setStyle(a.domNode,"display","none")})},minimizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("minimized");try{a.onMinimize()}catch(b){console.log(console.error("fail to minimize panel "+
a.id+". "+b.stack))}},maximizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("maximized");try{a.onMaximize()}catch(b){console.log(console.error("fail to maximize panel "+a.id+". "+b.stack))}},normalizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("normal");try{a.onNormalize()}catch(b){console.log(console.error("fail to noralize panel "+
a.id+". "+b.stack))}},changeWindowStateTo:function(a,b){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"normal"===b?this.normalizePanel(a):"minimized"===b?this.minimizePanel(a):"maximized"===b?this.maximizePanel(a):console.log("error state: "+b)},getPanelById:function(a){for(var b=0;b<this.panels.length;b++)if(this.panels[b].id===a)return this.panels[b]},onWindowResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==this.panels[a].state&&"map"!==this.panels[a].position.relativeTo&&
this.panels[a].resize()},onMapResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==this.panels[a].state&&"map"===this.panels[a].position.relativeTo&&this.panels[a].resize()},destroyPanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;if(a.domNode){"closed"!==a.state&&this.closePanel(a);this._removePanel(a);try{a.destroy()}catch(b){console.log(console.error("fail to destroy panel "+a.id+". "+b.stack))}}},destroyAllPanels:function(){var c=a.map(this.panels,function(a){return a.id});
a.forEach(c,function(a){this.destroyPanel(a)},this);this.panels=[]},playOpenPanelAnimation:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a)||!a.openAnimation||0===a.animationDuration)return e();var b=new h;"string"===typeof a.openAnimation?"fadeIn"===a.openAnimation?(l.setStyle(a.domNode,{opacity:0,display:""}),k.fadeIn({node:a.domNode,duration:a.animationDuration,onEnd:function(){b.resolve()}}).play()):b.resolve():b.resolve();return b},playClosePanelAnimation:function(a){if("string"===
typeof a&&(a=this.getPanelById(a),!a)||!a.closeAnimation||0===a.animationDuration)return e();var b=new h;"string"===typeof a.closeAnimation&&("fadeOut"===a.closeAnimation?k.fadeOut({node:a.domNode,duration:a.animationDuration,onEnd:function(){b.resolve()}}).play():b.resolve());return b},getPositionOnMobile:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return{};var b=l.getMarginBox(window.jimuConfig.layoutId),c=b.h/2;a.titleHeight||(a.titleHeight=35);return"maximized"===a.windowState?
{left:0,right:0,top:0,bottom:0,width:"auto",height:"auto",contentHeight:b.h-a.titleHeight,borderRadiusStyle:{borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomLeftRadius:0,borderBottomRightRadius:0}}:"minimized"===a.windowState?b.h>b.w?{left:0,right:0,top:"auto",bottom:0,width:"auto",height:a.titleHeight,contentHeight:0,borderRadiusStyle:{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:0}}:{left:b.w-b.w/2,right:0,top:"auto",bottom:0,width:b.w/
2,height:a.titleHeight,contentHeight:b.h,borderRadiusStyle:window.isRTL?{borderTopLeftRadius:0,borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:"4px"}:{borderTopLeftRadius:"4px",borderTopRightRadius:0,borderBottomLeftRadius:"4px",borderBottomRightRadius:0}}:b.h>b.w?{left:0,right:0,top:c,bottom:0,width:"auto",height:"auto",contentHeight:b.h-c-a.titleHeight,borderRadiusStyle:{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:0}}:
{left:b.w-b.w/2,right:0,top:0,bottom:0,width:b.w/2,height:"auto",contentHeight:b.h-c-a.titleHeight,borderRadiusStyle:window.isRTL?{borderTopLeftRadius:0,borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:"4px"}:{borderTopLeftRadius:"4px",borderTopRightRadius:0,borderBottomLeftRadius:"4px",borderBottomRightRadius:0}}},_onPanelClick:function(a){this._activePanel(a)},_activePanel:function(a){if(this.activePanel){if(this.activePanel.id===a.id){this.activePanel.moveTopOnActive&&
l.setStyle(this.activePanel.domNode,"zIndex",101);return}"active"===this.activePanel.state&&(this.activePanel.setState("opened"),l.setStyle(this.activePanel.domNode,"zIndex","undefined"!==typeof this.activePanel.position.zIndex?this.activePanel.position.zIndex:"auto"),this.activePanel.onDeActive())}var b=this.widgetManager.activeWidget;b&&("active"===b.state&&b.getPanel()!==a)&&(b.setState("opened"),!1===b.inPanel&&l.setStyle(b.domNode,"zIndex","undefined"!==typeof b.position.zIndex?b.position.zIndex:
"auto"),b.onDeActive(),this.widgetManager.activeWidget=null);this.activePanel=a;"active"!==this.activePanel.state&&(this.activePanel.setState("active"),this.activePanel.moveTopOnActive&&l.setStyle(this.activePanel.domNode,"zIndex",101),this.activePanel.onActive())},_removePanel:function(a){var b=this.panels.indexOf(a);-1<b&&this.panels.splice(b,1);this.activePanel&&this.activePanel.id===a.id&&(this.activePanel=null)},_onMoveStart:function(c){a.forEach(this.panels,function(a){a.domNode===c.node&&this._activePanel(a)},
this)},_onWidgetActived:function(a){this.activePanel&&("active"===this.activePanel.state&&a.getPanel()!==this.activePanel)&&(this.activePanel.setState("opened"),l.setStyle(this.activePanel.domNode,"zIndex","undefined"!==typeof this.activePanel.position.zIndex?this.activePanel.position.zIndex:"auto"),this.activePanel.onDeActive(),this.activePanel=null)},_loadPanelClass:function(a){var b=new h;c([a],function(a){b.resolve(a)});return b},_loadThemeI18N:function(a){var b=new h;a.startWith("themes")?(a=
a.split("/"),c(["dojo/i18n!"+(a[0]+"/"+a[1]+"/nls/strings")],function(a){b.resolve(a)})):b.resolve({});return b}});u.getInstance=function(){null===s&&(s=new u,window._panelManager=s);return s};return u})},"url:dijit/templates/Dialog.html":'\x3cdiv class\x3d"dijitDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title"\r\n\t\t\t\trole\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"-1"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\x3c/div\x3e\r\n\t${!actionBarTemplate}\r\n\x3c/div\x3e\r\n\r\n',
"url:dijit/form/templates/Button.html":'\x3cspan class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" role\x3d"presentation"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen"\r\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick"\r\n\t\ttabIndex\x3d"-1" aria-hidden\x3d"true" data-dojo-attach-point\x3d"valueNode"\r\n/\x3e\x3c/span\x3e\r\n',
"url:dijit/form/templates/TextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft" id\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',"url:dijit/templates/Tooltip.html":'\x3cdiv class\x3d"dijitTooltip dijitTooltipLeft" id\x3d"dojoTooltip" data-dojo-attach-event\x3d"mouseenter:onMouseEnter,mouseleave:onMouseLeave"\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipConnector" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipContainer dijitTooltipContents" data-dojo-attach-point\x3d"containerNode" role\x3d\'alert\'\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:dijit/form/templates/ValidationTextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:builder/plugins/plugins.json":'{\n  "app-actions.launch-app": {\n    "name": "app-actions.launch-app",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 1\n        },\n        "pluginName": "app-actions.launch-app"\n      }\n    ],\n    "properties": {\n      "hasUIFile": false,\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true\n    }\n  },\n  "app-actions.preview-app": {\n    "name": "app-actions.preview-app",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "HTML",\n          "index": 2\n        },\n        "pluginName": "app-actions.preview-app"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-actions.save-app": {\n    "name": "app-actions.save-app",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 3\n        },\n        "pluginName": "app-actions.save-app"\n      },\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "_onClick",\n          "index": 1\n        },\n        "pluginName": "app-actions.save-app"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-actions.to-template-config": {\n    "name": "app-actions.to-template-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 1\n        },\n        "pluginName": "app-actions.to-template-config"\n      }\n    ],\n    "properties": {\n      "hasUIFile": false,\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true\n    }\n  },\n  "app-config": {\n    "name": "app-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "config-template": {\n        "description": "Config template",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.config-template",\n        "name": "config-template",\n        "extensions": [\n          {\n            "point": "app-config.config-template",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-templateconfig"\n          }\n        ]\n      },\n      "config-part": {\n        "description": "The config part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.config-part",\n        "name": "config-part",\n        "extensions": [\n          {\n            "point": "app-config.config-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-configpart"\n          }\n        ]\n      },\n      "morepreview-selction-part": {\n        "description": "The more preview selection part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.morepreview-selction-part",\n        "name": "morepreview-selction-part",\n        "extensions": [\n          {\n            "point": "app-config.morepreview-selction-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-morepreview-selectionpart"\n          }\n        ]\n      },\n      "template-config-part": {\n        "description": "The Template config part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.template-config-part",\n        "name": "template-config-part",\n        "extensions": [\n          {\n            "point": "app-config.template-config-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-template-configpart"\n          }\n        ]\n      },\n      "main-app-actions": {\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config.main-app-actions",\n        "name": "main-app-actions",\n        "extensions": [\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 1\n            },\n            "pluginName": "app-actions.launch-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "HTML",\n              "index": 2\n            },\n            "pluginName": "app-actions.preview-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 3\n            },\n            "pluginName": "app-actions.save-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 1\n            },\n            "pluginName": "app-actions.to-template-config"\n          }\n        ]\n      },\n      "popup-app-actions": {\n        "parameters": {\n          "onClickAction": {\n            "type": "function",\n            "name": "onClickAction"\n          },\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config.popup-app-actions",\n        "name": "popup-app-actions",\n        "extensions": [\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "_onClick",\n              "index": 1\n            },\n            "pluginName": "app-actions.save-app"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 4\n            },\n            "pluginName": "popup-actions.configmode-switch"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 3\n            },\n            "pluginName": "popup-actions.popup-agoltemplate"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 2\n            },\n            "pluginName": "popup-actions.popup-saveas"\n          }\n        ]\n      }\n    },\n    "extensions": [\n      {\n        "point": "startup.app-config",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config"\n      }\n    ],\n    "properties": {\n      "hasLocale": false,\n      "hasClass": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-configpart": {\n    "name": "app-config-configpart",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the config part of the config page.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "config-sections": {\n        "description": "The config page for section of full config",\n        "parameters": {\n          "label": {\n            "type": "string",\n            "required": true,\n            "name": "label"\n          },\n          "icon": {\n            "type": "url",\n            "required": true,\n            "name": "icon"\n          },\n          "selectedIcon": {\n            "type": "url",\n            "required": true,\n            "name": "selectedIcon"\n          },\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "republishEvents": {\n            "type": "string",\n            "required": true,\n            "description": "The events that change app config. These events will be pushed to preview window",\n            "name": "republishEvents"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config-configpart.config-sections",\n        "name": "config-sections",\n        "extensions": [\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "appAttributeChanged,loadingPageChanged,actionTriggered,appProxyForMapChanged,appProxyForUrlChanged",\n              "index": 4\n            },\n            "pluginName": "attribute-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "setAppConfig,mapChanged,mapOptionsChanged,sceneViewChanged",\n              "index": 2\n            },\n            "pluginName": "map-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "themeChanged,styleChanged,layoutChanged",\n              "index": 1\n            },\n            "pluginName": "theme-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "widgetChanged,widgetPoolChanged,openAtStartChange,actionTriggered,groupChanged",\n              "index": 3\n            },\n            "pluginName": "widget-config"\n          }\n        ]\n      }\n    },\n    "extensions": [\n      {\n        "point": "app-config.config-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-configpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-morepreview-selectionpart": {\n    "name": "app-config-morepreview-selectionpart",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the config part of the config page.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "app-config.morepreview-selction-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-morepreview-selectionpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-template-configpart": {\n    "name": "app-config-template-configpart",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the template config part.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "app-config.template-config-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-template-configpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-templateconfig": {\n    "name": "app-config-templateconfig",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "app-config.config-template",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-templateconfig"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-list": {\n    "name": "app-list",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "startup.app-list",\n        "description": "",\n        "pluginName": "app-list"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "attribute-config": {\n    "name": "attribute-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "appAttributeChanged,loadingPageChanged,actionTriggered,appProxyForMapChanged,appProxyForUrlChanged",\n          "index": 4\n        },\n        "pluginName": "attribute-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "creation-entry": {\n    "name": "creation-entry",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.creation-entry",\n        "description": "",\n        "pluginName": "creation-entry"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "header": {\n    "name": "header",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.header",\n        "description": "",\n        "pluginName": "header"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "map-config": {\n    "name": "map-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "setAppConfig,mapChanged,mapOptionsChanged,sceneViewChanged",\n          "index": 2\n        },\n        "pluginName": "map-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "popup-actions.configmode-switch": {\n    "name": "popup-actions.configmode-switch",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 4\n        },\n        "pluginName": "popup-actions.configmode-switch"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": false,\n      "hasUIFile": false\n    }\n  },\n  "popup-actions.popup-agoltemplate": {\n    "name": "popup-actions.popup-agoltemplate",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 3\n        },\n        "pluginName": "popup-actions.popup-agoltemplate"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": false\n    }\n  },\n  "popup-actions.popup-saveas": {\n    "name": "popup-actions.popup-saveas",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 2\n        },\n        "pluginName": "popup-actions.popup-saveas"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": false,\n      "hasUIFile": false\n    }\n  },\n  "popup-actions.popup-share": {\n    "name": "popup-actions.popup-share",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 1,\n          "republishEvents": "SharePluginOnClickEveryone"\n        },\n        "pluginName": "popup-actions.popup-share"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": false,\n      "hasStyle": false,\n      "hasUIFile": false\n    }\n  },\n  "startup": {\n    "name": "startup",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "app-list": {\n        "description": "the app list page.",\n        "id": "startup.app-list",\n        "name": "app-list",\n        "extensions": [\n          {\n            "point": "startup.app-list",\n            "description": "",\n            "pluginName": "app-list"\n          }\n        ]\n      },\n      "header": {\n        "description": "the header.",\n        "id": "startup.header",\n        "name": "header",\n        "extensions": [\n          {\n            "point": "startup.header",\n            "description": "",\n            "pluginName": "header"\n          }\n        ]\n      },\n      "app-config": {\n        "description": "the app config page.",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "startup.app-config",\n        "name": "app-config",\n        "extensions": [\n          {\n            "point": "startup.app-config",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config"\n          }\n        ]\n      },\n      "creation-entry": {\n        "description": "The create new entry point.",\n        "id": "startup.creation-entry",\n        "name": "creation-entry",\n        "extensions": [\n          {\n            "point": "startup.creation-entry",\n            "description": "",\n            "pluginName": "creation-entry"\n          }\n        ]\n      },\n      "stemapps": {\n        "description": "the stemapp.",\n        "parameters": {\n          "appType": {\n            "type": "string",\n            "required": true,\n            "name": "appType"\n          },\n          "appPath": {\n            "type": "string",\n            "description": "By default, it\'s plugin\'s folder path",\n            "name": "appPath"\n          },\n          "appVersionManager": {\n            "type": "string",\n            "description": "path relative to app path. required if app config is old.",\n            "name": "appVersionManager"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "startup.stemapps",\n        "name": "stemapps",\n        "extensions": [\n          {\n            "point": "startup.stemapps",\n            "description": "",\n            "parameters": {\n              "appType": "HTML",\n              "appPath": "../../../../stemapp/",\n              "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n              "index": 1\n            },\n            "pluginName": "stemapps.web2d"\n          },\n          {\n            "point": "startup.stemapps",\n            "description": "",\n            "parameters": {\n              "appType": "HTML3D",\n              "appPath": "../../../../stemapp3d/",\n              "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n              "index": 2\n            },\n            "pluginName": "stemapps.web3d"\n          }\n        ]\n      }\n    },\n    "extensions": [],\n    "properties": {\n      "hasLocale": false,\n      "hasClass": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "stemapps.web2d": {\n    "name": "stemapps.web2d",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.stemapps",\n        "description": "",\n        "parameters": {\n          "appType": "HTML",\n          "appPath": "../../../../stemapp/",\n          "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n          "index": 1\n        },\n        "pluginName": "stemapps.web2d"\n      }\n    ],\n    "properties": {\n      "hasClass": false,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "stemapps.web3d": {\n    "name": "stemapps.web3d",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.stemapps",\n        "description": "",\n        "parameters": {\n          "appType": "HTML3D",\n          "appPath": "../../../../stemapp3d/",\n          "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n          "index": 2\n        },\n        "pluginName": "stemapps.web3d"\n      }\n    ],\n    "properties": {\n      "hasClass": false,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "theme-config": {\n    "name": "theme-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "themeChanged,styleChanged,layoutChanged",\n          "index": 1\n        },\n        "pluginName": "theme-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "widget-config": {\n    "name": "widget-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "widgetChanged,widgetPoolChanged,openAtStartChange,actionTriggered,groupChanged",\n          "index": 3\n        },\n        "pluginName": "widget-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  }\n}\n',
"url:builder/plugins/app-actions/launch-app/css/style.css":".plugin-app-actions-launch-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: default;}.plugin-app-actions-launch-app .footer-button{background-image: url(images/icon.png); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-launch-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-launch-app a{color: inherit; display: block; text-decoration: none; height: 47px;}.plugin-app-actions-launch-app:hover .footer-button{color:#24B5CC; background-image: url(images/hover_icon.png);}",
"url:builder/plugins/app-actions/preview-app/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"footer-button  preview-button" data-dojo-attach-point\x3d"btnPreview" title\x3d${nls.previewMore}\x3e${nls.previewMore}\x3c/div\x3e\r\n  \x3cdiv class\x3d"footer-button  config-button" style\x3d"display:none" data-dojo-attach-point\x3d"btnConfig" title\x3d${nls.back2Configure}\x3e${nls.back2Configure}\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-actions/preview-app/css/style.css":".plugin-app-actions-preview-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: pointer;}.plugin-app-actions-preview-app .footer-button{background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-preview-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-preview-app:hover .footer-button {color:#24B5CC;}.plugin-app-actions-preview-app .footer-button.preview-button{background-image: url(images/icon.png);}.plugin-app-actions-preview-app:hover .footer-button.preview-button{background-image: url(images/hover_icon.png);}.plugin-app-actions-preview-app .footer-button.config-button{background-image: url(images/configure01.png);}.jimu-rtl .plugin-app-actions-preview-app .footer-button.config-button{background-image: url(images/configure03.png);}.plugin-app-actions-preview-app:hover .footer-button.config-button{background-image: url(images/configure02.png);}.jimu-rtl .plugin-app-actions-preview-app:hover .footer-button.config-button{background-image: url(images/configure04.png);}",
"url:builder/plugins/app-actions/save-app/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"footer-button" title\x3d${nls.label} data-dojo-attach-point\x3d"actionNode"\x3e${nls.label}\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-actions/save-app/css/style.css":".plugin-app-actions-save-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: default;}.plugin-app-actions-save-app .footer-button{background-image: url(images/icon.png); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-save-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-save-app:hover .footer-button{color:#24B5CC; background-image: url(images/hover_icon.png);}.plugin-app-actions-save-app .footer-button.save-enable{background-image:url(images/hover_icon.png); background-repeat: no-repeat; color: #24B5CC;}.plugin-app-actions-save-app .footer-button.save-block{color: #d2dae2; background-image: url(images/block_icon.png);}",
"url:builder/plugins/app-actions/to-template-config/css/style.css":".plugin-app-actions-to-template-config{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: pointer;}.plugin-app-actions-to-template-config .footer-button{background-image: url(images/icon.png); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-to-template-config .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-to-template-config:hover .footer-button{color:#15a4fa; background-image: url(images/hover_icon.png);}",
"url:jimu/dijit/templates/LoadingShelter.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"loading-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"imgDiv" class\x3d"img-div"\x3e\r\n        \x3cimg data-dojo-attach-point\x3d"loadingImg"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cp data-dojo-attach-point\x3d"textNode"\x3e\x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-config/Plugin.html":'\x3cdiv \x3e\r\n  \x3cdiv class\x3d"at-view-stack" data-dojo-attach-point\x3d"atViewStackNode"\x3e\r\n    \x3cdiv class\x3d"config-app-pane" data-dojo-attach-point\x3d"configAppNode"\x3e\r\n      \x3cdiv class\x3d"left-pane" data-dojo-attach-point\x3d"leftPaneNode"\x3e\r\n        \x3cdiv class\x3d"opts-viewstack" data-dojo-attach-point\x3d"optsViewStackNode"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"configOptsPaneNode"\x3e\r\n\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"morePreviewOptsPaneNode"\x3e\r\n\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv data-dojo-attach-point\x3d"templateOptsPaneNode"\x3e\r\n\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"actions-pane" data-dojo-attach-point\x3d"actionsPaneNode"\x3e\r\n          \x3cdiv class\x3d"main-action-box" data-dojo-attach-point\x3d"mainActionBoxNode"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"footer-button-arrow jimu-float-leading" data-dojo-attach-point\x3d"btnArrow" data-dojo-attach-event\x3d"onclick: _onBtnArrowClick"\x3e\r\n            \x3cdiv class\x3d"foot-menu" data-dojo-attach-point\x3d"popupActionsMenu"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"right-preview-section" data-dojo-attach-point\x3d"rightPreviewSection"\x3e\r\n        \x3cdiv class\x3d"preview-config" data-dojo-attach-point\x3d"previewConfig"\x3e\r\n          \x3ciframe name\x3d"previewConfigFrame" data-dojo-attach-point\x3d"previewConfigFrameNode" style\x3d"border:none" allowfullscreen\x3d"true"\x3e\x3c/iframe\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"preview-more" data-dojo-attach-point\x3d"previewMore"\x3e\r\n          \x3cdiv class\x3d"preview-more-iframe-section" data-dojo-attach-point\x3d"previewMoreIframeSection"\x3e\r\n            \x3cdiv class\x3d"preview-more-iframe-container" data-dojo-attach-point\x3d"previewMoreContainer"\x3e\r\n              \x3ciframe name\x3d"previewMoreFrame" data-dojo-attach-point\x3d"previewMoreFrameNode" style\x3d"border-color:#cad1d9;" allowfullscreen\x3d"true"\x3e\x3c/iframe\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"description" data-dojo-attach-point\x3d"previewMoreDes"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"screen-switch-section"\x3e\r\n            \x3cdiv class\x3d"portrait jimu-float-leading selected" data-dojo-attach-point\x3d"btnPortrait"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"landscape jimu-float-trailing" data-dojo-attach-point\x3d"btnLandscape"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-template-pane" data-dojo-attach-point\x3d"configTemplateNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/app-config/css/style.css":".plugin-config-app .at-view-stack{width: 100%; height: 100%; position: relative;}.plugin-config-app .at-view-stack \x3e .view{position: absolute; left: 0; top: 0;}.plugin-config-app .at-view-stack \x3e .view.config-app-pane{display: block !important; visibility: hidden;}.plugin-config-app .at-view-stack \x3e .view.config-template-pane{z-index: 2;}.plugin-config-app .left-pane{font-size: 20px; width: 400px; height: 100%; position: absolute; box-shadow: 0px 0px 8px rgba(0,0,0,0.4); z-index: 2;}.plugin-config-app .left-pane .opts-viewstack{position: absolute; left: 0; right: 0; top: 0; bottom: 50px;}.plugin-config-app .right-preview-section{position: absolute; left: 400px; top: 0; right: 0; height: 100%;}.plugin-config-app .right-preview-section .preview-viewstack{width:100%; height:100%;}.plugin-config-app .preview-config,.plugin-config-app .preview-more{width:100%; height:100%;}.plugin-config-app .preview-config iframe{width: 100%; height: 100%;}.plugin-config-app .preview-more{position:relative; background-color:#f3f3f3; overflow:auto;}.plugin-config-app .preview-more .preview-more-iframe-section .preview-more-iframe-container{margin-left:auto; margin-right:auto; background:#eaecee; padding:20px; border:2px solid #666; -webkit-border-radius:15px; -moz-border-radius:15px; -o-border-radius:15px; -ms-border-radius:15px; border-radius:15px; -webkit-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -moz-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -o-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -ms-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9);}.plugin-config-app .preview-more .preview-more-iframe-section .preview-more-iframe-container iframe{width:100%; height:100%;}.plugin-config-app .preview-more .description{display:none; text-align:center; font-size:15px; margin-top:20px;}.plugin-config-app .preview-more .screen-switch-section{position:absolute; right:12px; top:12px; height:38px;}.jimu-rtl .plugin-config-app .preview-more .screen-switch-section{right: auto; left: 12px;}.plugin-config-app .preview-more .screen-switch-section div{width:38px; height:100%; background-repeat:no-repeat; background-position:center center; cursor:pointer; background-color:#FFFFFF;}.plugin-config-app .preview-more .screen-switch-section div.selected{background-color:#F7F8F8;}.plugin-config-app .preview-more .screen-switch-section .portrait{border-top-left-radius:3px; border-bottom-left-radius:3px; background-image:url(images/portrait.png);}.plugin-config-app .preview-more .screen-switch-section .landscape{border-top-right-radius:3px; border-bottom-right-radius:3px; background-image:url(images/landscape.png);}.plugin-config-app .preview-more .screen-switch-section .portrait.selected{background-image:url(images/portrait_selected.png);}.plugin-config-app .preview-more .screen-switch-section .landscape.selected{background-image:url(images/landscape_selected.png);}.jimu-rtl .plugin-config-app .right-preview-section{left: 0; right: 400px;}.plugin-config-app .actions-pane{width: 100%; position: absolute; left: 0; right: 0; bottom: 0; height: 52px; background-color:#F3F3F3; font-size:14px;}.plugin-config-app .actions-pane .footer-button-box{height: 47px; font-family: Avenir Medium;}.plugin-config-app .actions-pane .seprate{width:1px; height: 35px; background-image:url(images/seprate.png); background-position: 0 20px; background-repeat:no-repeat;}.plugin-config-app .actions-pane .footer-button-arrow{width: 39px; height: 100%; background-image: url(images/arrow.png); background-position: 17px 25px; background-repeat: no-repeat; position: absolute; left: 360px; cursor: pointer; z-index: 10;}.jimu-rtl .plugin-config-app .actions-pane .footer-button-arrow{right: 360px; left: auto;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu{display: none; position: absolute; right: 1px; box-shadow: 0 0 4px #646464;}.jimu-rtl .plugin-config-app .actions-pane .footer-button-arrow .foot-menu{left: 1px; right: auto;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div{display: block; height: 30px; line-height: 30px; padding-left: 25px; padding-right: 25px; cursor: pointer; white-space: nowrap; font-size: 14px; background-color: #fafafc; text-decoration: none; color: #4d4d4d;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div:hover{background-color: #edf2f5; color: #24B5CC;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div.disable{color: #d2dae2;}",
"url:builder/plugins/app-config-configpart/TabContainer2.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable class\x3d"control-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-viewstack2" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-config-configpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"config-section" data-dojo-attach-point\x3d"configSection"\x3e\r\n    \x3cdiv class\x3d"tabs" data-dojo-attach-point\x3d"tabsNode"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-configpart/css/style.css":'.plugin-appconfig-configpart{font-size: 20px; width: 400px; height: 100%; position: relative; box-shadow: 4px 0px 8px -4px rgba(0,0,0,0.4); z-index: 2;}.plugin-appconfig-configpart .config-section{width:100%; height:100%;}.jimu-tab2 .control-table{width: 100%; table-layout: fixed; background: #5E5E5E; border-collapse: collapse; font-size: 12px; text-align: center; color: #fff;}.jimu-tab2 .tab-item-div{position: relative; width: 100%; height: 80px; cursor: pointer; font-family: "Avenir Medium";}.jimu-tab2 .tab-item-div:hover{color: #fff; background-color: #444;}.jimu-tab2 .selected-tab-item-div{background-color: #24B5CC; background-size: 100% 100%; background-origin: content-box; background-repeat: no-repeat; font-family: "Avenir Medium"; color: #fff;}.jimu-tab2 .selected-tab-item-div:hover{background-color: #24B5CC;}.jimu-tab2 .tab-item-icon{display: inline-block; margin-left: auto; margin-right: auto; margin-top: 20px; margin-bottom: 6px; width: 24px; height: 24px; background-repeat: no-repeat; background-position: center center;}.jimu-tab2 .tab-item-title{width: 99%; margin: auto; white-space: pre-line; overflow: hidden; text-overflow: ellipsis; height: 16px;}.jimu-tab2 .jimu-viewstack2{background-color:#fff; position:absolute; left:0; right:0; top:80px; bottom:0; height:auto;}',
"url:builder/plugins/app-config-morepreview-selectionpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"preview-section" data-dojo-attach-point\x3d"previewSection"\x3e\r\n    \x3cdiv class\x3d"preview-header"\x3e\r\n      \x3cdiv class\x3d"header-item size-section"\x3e\r\n        \x3ctable class\x3d"size-table"\x3e\r\n          \x3ccolgroup\x3e\r\n            \x3ccol width\x3d"25px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"86px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"20px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"86px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"25px"\x3e\x3c/col\x3e\r\n          \x3c/colgroup\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"width-tip jimu-ellipsis" title\x3d"${nls.width}"\x3e${nls.width}\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"pixel-div"\x3e\r\n                  \x3cinput class\x3d"jimu-float-leading" type\x3d"text" value\x3d"1024" data-dojo-attach-point\x3d"customWidth" /\x3e\r\n                  \x3cdiv class\x3d"jimu-float-leading pixel"\x3e Px \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"height-tip jimu-ellipsis" title\x3d"${nls.height}"\x3e${nls.height}\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"pixel-div"\x3e\r\n                  \x3cinput class\x3d"jimu-float-leading" type\x3d"text" value\x3d"768"  data-dojo-attach-point\x3d"customHeight" /\x3e\r\n                  \x3cdiv class\x3d"jimu-float-leading pixel"\x3e Px \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"preview-body"\x3e\r\n      \x3cdiv class\x3d"preview-items-section"\x3e\r\n        \x3ctable\x3e\r\n          \x3ctbody data-dojo-attach-point\x3d"previewTbody"\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"preview-qrcode-section" \x3e\r\n        \x3cdiv class\x3d"qrcode-image jimu-float-leading" data-dojo-attach-point\x3d"qrcodeImage"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"qrcode-description jimu-float-leading" data-dojo-attach-point\x3d"qrcodeDescription"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-morepreview-selectionpart/css/style.css":".left-pane .plugin-appconfig-morepreview-selectionpart .preview-section{position:relative; width:100%; height:100%;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header{position: relative; width: 100%; height: 52px; background-color: #24B5CC;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header .header-item{position:absolute; top: 0; margin: auto; bottom:0;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header .size-section{width:100%; height: 32px; color:#444444;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table{width: 100%; table-layout: fixed; border-collapse: collapse;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table td *{height: 32px; line-height: 32px; text-align: center; font-size: 14px; color: #fff;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .width-tip{width: 100%;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div{width: 110px; overflow: hidden;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div input{width: 54px; color: #444444; border-style: none;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div .pixel{width: 32px; text-align: center; margin: 0; color: white; background-color: #d2dae2;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body{position:absolute; width:100%; top: 52px; bottom:0; background-color: white;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .operation-tip{font-size:14px; margin-left:22px; margin-top:28px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section{position:absolute; left:0; right:0; top:0; bottom:120px; overflow-x:hidden; overflow-y:auto;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section{position: absolute; left: 2px; right: 2px; bottom: 0; height: 116px; border-top: 1px solid; border-color: #e3ecf2;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section .qrcode-image{margin: 20px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section .qrcode-description{width: 277px; height: 100%; padding-top: 25px; color: #596679; font-size: 14px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section{padding-top: 10px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section table{width:370px; table-layout:fixed; margin-left: auto; margin-right: auto;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td{vertical-align:top; padding-top: 10px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item{margin-left: auto; margin-right: auto; width:74px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg{position:relative; width:100%; height:74px; background-color:#fafafc; cursor:pointer; border:1px solid #d2dae2;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg.selected{border:3px solid #24B5CC;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-thumbnail{position:absolute; left:0; top:0; width:100%; height:100%; background-repeat:no-repeat; background-position:center center;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-selected-icon{display:none; position:absolute; left:41px; top:42px; width:30px; height:26px; background-color:rgba(0, 0, 0, 0.4); background-repeat:no-repeat; background-position:center center; background-image:url(images/check.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone6{background-image: url(images/preview/iPhone6.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone6-plus{background-image: url(images/preview/iPhone6_Plus.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone5{background-image:url(images/preview/iPhone5.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone4{background-image:url(images/preview/iPhone4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad-Air{background-image: url(images/preview/iPad_Air.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad4{background-image: url(images/preview/iPad4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .new-iPad{background-image:url(images/preview/iPad3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad-mini{background-image:url(images/preview/iPad-Mini.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Samsung-Galaxy-S4{background-image: url(images/preview/Samsung_Galaxy_S4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Samsung-Note-3{background-image: url(images/preview/Samsung_Note_3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-5{background-image: url(images/preview/Nexus_5.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-4{background-image: url(images/preview/Nexus_4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-7{background-image: url(images/preview/Nexus_7.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .htc-one{background-image: url(images/preview/HTC_One.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .xiaomi-3{background-image: url(images/preview/Xiaomi_3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .LG-G2{background-image: url(images/preview/LG_G2.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg.selected .preview-selected-icon{display:none; left:38px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-title{display:inline-block; width:100%; text-align:center; color:#7989a0; font-size:12px; margin-top:10px; line-height: 13px;}",
"url:dijit/form/templates/CheckBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cinput\r\n\t \t${!nameAttrSetting} type\x3d"${type}" role\x3d"${type}" aria-checked\x3d"false" ${checkedAttrSetting}\r\n\t\tclass\x3d"dijitReset dijitCheckBoxInput"\r\n\t\tdata-dojo-attach-point\x3d"focusNode"\r\n\t \tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n/\x3e\x3c/div\x3e\r\n',"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\r\n\t   cellspacing\x3d"0"\x3e\r\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\r\n\x3c/table\x3e\r\n',
"url:dijit/templates/MenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\r\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\r\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/templates/MenuSeparator.html":'\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\r\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/form/templates/Select.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tdata-dojo-attach-point\x3d"_buttonNode,tableNode,focusNode,_popupStateNode" cellspacing\x3d\'0\' cellpadding\x3d\'0\'\r\n\trole\x3d"listbox" aria-haspopup\x3d"true"\r\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonContents" role\x3d"presentation"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitButtonText"  data-dojo-attach-point\x3d"containerNode,textDirNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitValidationContainer"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\t\x3e\x3cinput type\x3d"hidden" ${!nameAttrSetting} data-dojo-attach-point\x3d"valueNode" value\x3d"${value}" aria-hidden\x3d"true"\r\n\t\t/\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode" role\x3d"presentation"\r\n\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t${_buttonInputDisabled}\r\n\t\t/\x3e\x3c/td\r\n\t\x3e\x3c/tr\x3e\x3c/tbody\r\n\x3e\x3c/table\x3e\r\n',
"url:esri/dijit/ColorPicker/templates/ColorPicker.html":'\x3cdiv class\x3d"${css.container}"\x3e\r\n  \x3cdiv class\x3d"${css.header}" data-dojo-attach-point\x3d"dap_header"\x3e\r\n    \x3cspan class\x3d"${css.swatchPreview} ${css.container}"\x3e\r\n      \x3cspan class\x3d"${css.swatch} ${css.swatchTransparencyBackground}"\x3e\x3c/span\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"dap_previewSwatch" class\x3d"${css.swatch}"\x3e\x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.middle}"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"dap_paletteContainer" class\x3d"${css.palette} ${css.container}"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_primaryPalette" class\x3d"${css.palette}"\x3e\x3c/div\x3e\x3c!--\r\n      --\x3e\x3cdiv data-dojo-attach-point\x3d"dap_secondaryPalette" class\x3d"${css.palette}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.paletteOptions}"\x3e\r\n      \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"dap_hexInput" class\x3d"${css.hexInput}"/\x3e\r\n      \x3cinput class\x3d"${css.paletteToggle}" type\x3d"button" data-dojo-type\x3d"dijit/form/ToggleButton" data-dojo-attach-point\x3d"dap_paletteToggle" label\x3d"${labels.more}"/\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.footer}" data-dojo-attach-point\x3d"dap_footer"\x3e\r\n    \x3cdiv class\x3d"${css.section}" data-dojo-attach-point\x3d"dap_suggestedColorSection"\x3e\r\n      \x3cdiv class\x3d"${css.label}"\x3e${labels.suggested}\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_suggestedColorPalette" class\x3d"${css.suggested} ${css.palette} ${css.swatchRow}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.section}" data-dojo-attach-point\x3d"dap_recentColorSection"\x3e\r\n      \x3cdiv class\x3d"${css.label}"\x3e${labels.recent}\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_recentColorPalette" class\x3d"${css.recent} ${css.palette} ${css.swatchRow}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.section}" data-dojo-attach-point\x3d"dap_transparencySection"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_transparencyLabel" class\x3d"${css.label}"\x3e${labels.transparency}\x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.transparencySlider}"\r\n           data-dojo-attach-point\x3d"dap_transparencySlider"\r\n           data-dojo-type\x3d"esri/dijit/HorizontalSlider"\r\n           data-dojo-props\x3d"minimum: 0, maximum: 1, discreteValues: 100, labels: [\'0%\', \'50%\', \'100%\']"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/form/templates/HorizontalSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" data-dojo-attach-event\x3d"onkeydown:_onKeyDown, onkeyup:_onKeyUp"\r\n\trole\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" data-dojo-attach-event\x3d"press:_onClkDecBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cinput data-dojo-attach-point\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitSliderBarContainerH" role\x3d"presentation" data-dojo-attach-point\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" data-dojo-attach-event\x3d"press:_onBarClick"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\t\x3e\x3cdiv data-dojo-attach-point\x3d"sliderHandle,focusNode" class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" data-dojo-attach-event\x3d"press:_onHandleClick" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" data-dojo-attach-event\x3d"press:_onBarClick"\x3e\x3c/div\r\n\t\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" data-dojo-attach-event\x3d"press:_onClkIncBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"url:dijit/form/templates/DropDownButton.html":'\x3cspan class\x3d"dijit dijitReset dijitInline"\r\n\t\x3e\x3cspan class\x3d\'dijitReset dijitInline dijitButtonNode\'\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" data-dojo-attach-point\x3d"_buttonNode"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"focusNode,titleNode,_arrowWrapperNode,_popupStateNode"\r\n\t\t\trole\x3d"button" aria-haspopup\x3d"true" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon"\r\n\t\t\t\tdata-dojo-attach-point\x3d"iconNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonInner"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonChar"\x3e\x26#9660;\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen" tabIndex\x3d"-1"\r\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick" data-dojo-attach-point\x3d"valueNode" aria-hidden\x3d"true"\r\n/\x3e\x3c/span\x3e\r\n',
"url:builder/plugins/app-config-template-configpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"header-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"head-part"\x3e\r\n    \x3cdiv class\x3d"decorator"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"description data-dojo-attach-point\x3d"description"" \x3e${nls.description}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"config-part-box"\x3e\r\n    \x3cdiv class\x3d"config-part" data-dojo-attach-point\x3d"configPart"\x3e\r\n      \x3cdiv class\x3d"map-category"\x3e\r\n        \x3cdiv class\x3d"map-title"\x3eMap\x3c/div\x3e\r\n        \x3cdiv class\x3d"select-part"\x3e\r\n          \x3cdiv class\x3d"jimu-btn select-map" data-dojo-attach-point\x3d"selectMapBtn" data-dojo-attach-event\x3d"click:_onSelectMapClick"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"map-name" data-dojo-attach-point\x3d"mapName"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"control-part" data-dojo-attach-point\x3d"controlPart"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/app-config-template-configpart/css/style.css":".plugin-appconfig-template-configpart {background-color: #ffffff; font-size: 12px; overflow-y: auto;}.plugin-appconfig-template-configpart .header-line {width: 100%; position: absolute; border-style: none none solid none; border-width: 1px; box-shadow: 0px 0px 6px rgba(0,0,0,0.4); border-color: rgba(0,0,0,0.0); display: none;}.plugin-appconfig-template-configpart .head-part {position: absolute; top: 0; height: 80px; background-color: #f3f3f3; width: 100%; z-index: 1;}.plugin-appconfig-template-configpart .head-part .decorator {height: 16px; background-color: #528cc9;}.plugin-appconfig-template-configpart .head-part .description {height: 58px; padding-top: 18px; color: #7889a0; font-size: 14px; width: 90%; margin: 0 auto;}.plugin-appconfig-template-configpart .config-part-box {width: 100%; overflow: auto; height: 100%;}.plugin-appconfig-template-configpart .config-part {width: 90%; height: 100%; margin: 0 auto; padding-top: 80px;}.plugin-appconfig-template-configpart .config-part .map-category .map-title{border-bottom: 1px solid #eaeaea; margin: 12px 0 10px 0; font-weight: bold; font-size: 14px; color: #565656; padding-bottom: 0.3em;}.plugin-appconfig-template-configpart .config-part .map-category {overflow: hidden;}.plugin-appconfig-template-configpart .config-part .map-category .select-map{padding: 0 15px; font-size: 14px; line-height: 33px; text-align: center; color: #ffffff; float: left; max-width: 50%;}.plugin-appconfig-template-configpart .config-part .map-category .map-name{margin-top: 10px; color: #596679; font-size: 12px; max-width: 100%; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; float: right; width: 50%;}",
"url:builder/dijit/template-config/templates/Template.html":'\x3cdiv\x3e\r\n\r\n    \x3cdiv class\x3d"content-part" data-dojo-attach-point\x3d"contentPart"\x3e\r\n      \x3cdiv class\x3d"tree-part jimu-float-leading" data-dojo-attach-point\x3d"treePart"\x3e\r\n        \x3cdiv class\x3d"left-part-title"\x3e${nls.appProperties}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"right-part jimu-float-leading" data-dojo-attach-point\x3d"leftPart"\x3e\r\n        \x3cdiv class\x3d"right-part-content"\x3e\r\n          \x3cdiv class\x3d"right-part-head" \x3e\r\n            \x3cspan data-dojo-attach-point\x3d"rightPartHeadText"\x3e${nls.rightPartHead}\x3c/span\x3e\r\n            \x3cdiv class\x3d"review-json-div" data-dojo-attach-point\x3d"reviewJsonDiv" data-dojo-attach-event\x3d"onclick:_onReviewJsonDivClick" style\x3d"display:none"\x3e${nls.viewJsonCode}\x3c/div\x3e\r\n            \x3cdiv class\x3d"review-json-back-div" style\x3d"display: none" data-dojo-attach-point\x3d"reviewJsonBackDiv" data-dojo-attach-event\x3d"onclick:_onReviewJsonBackDivClick"\x3e${nls.viewJsonBack}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv class\x3d"right-part-subhead"\x3e\r\n            ${nls.rightPartSubhead}\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"category-part" data-dojo-attach-point\x3d"categoryPart"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"show-json-div" data-dojo-attach-point\x3d"showJsonDiv"\x3e\r\n            \x3cdiv class\x3d"show-json-content-div" data-dojo-attach-point\x3d"showJsonContentDiv"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/template-config/templates/Export.html":'\x3cdiv\x3e\r\n  \x3cp style\x3d"display:block;" class\x3d"message-div" data-dojo-attach-point\x3d"templateTitle"\x3e${nls.templateTitle}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"message-div" data-dojo-attach-point\x3d"message1"\x3e\x3c/p\x3e\r\n  \x3cdiv style\x3d"display:none;" class\x3d"explain-div" data-dojo-attach-point\x3d"explain1"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"item-info-box" data-dojo-attach-point\x3d"itemInfoBox" \x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/template-config/templates/ExportMessage.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"element resMessage" data-dojo-attach-point\x3d"resMessage"\x3e\x3c/div\x3e\r\n    \x3c!--div class\x3d"element" data-dojo-attach-point\x3d"message1"\x3e\x3c/div--\x3e\r\n    \x3cdiv class\x3d"element itemLink"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"word1" \x3e\x3c/span\x3e\r\n      \x3ca class\x3d"download-a" target\x3d"_blank" data-dojo-attach-point\x3d"itemLink"\x3e\x3c/a\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"word2" \x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/templates/ItemInfo.html":'\x3cdiv\x3e\r\n        \x3cdiv\x3e\r\n          \x3ctable style\x3d"width:100%" cellspacing\x3d"6"\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd class\x3d"label-tr" width\x3d"10%"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-name"\x3e\r\n                    ${nls.nameLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd width\x3d"90%"\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-name" data-dojo-type\x3d"dijit/form/TextBox" trim\x3d"true" data-dojo-attach-point\x3d"appName" maxlength\x3d"250" required\x3d"true" style\x3d"width:95%;padding:2px;"\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr data-dojo-attach-point\x3d"tagsTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-tags"\x3e\r\n                    ${nls.tagsLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-tags" data-dojo-type\x3d"builder/dijit/Tags" data-dojo-attach-point\x3d"tags" style\x3d"width:95%;max-width:95%;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr\x3e\r\n                \x3ctd class\x3d"label-tr" valign\x3d"top"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-summary"\x3e\r\n                    ${nls.summaryLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-summary" data-dojo-type\x3d"dijit/form/SimpleTextarea" rows\x3d\'5\' trim\x3d"true" maxlength\x3d"250" required\x3d"true" style\x3d"width:95%;max-width:95%;min-width:95%;height:200px;max-height:200px;min-height:200px;padding:2px;resize:none;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr data-dojo-attach-point\x3d"thumbnailTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-thumbnail"\x3e\r\n                    ${nls.thumbnailLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv class\x3d"image-chooser-base" id\x3d"publish-webmap-thumbnail" data-dojo-attach-point\x3d"imageChooserBase"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr data-dojo-attach-point\x3d"folderTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-folder"\x3e\r\n                    ${nls.saveFolderLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-folder" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:96%;"\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr data-dojo-attach-point\x3d"sharingTr"\x3e\r\n                \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-sharing" data-dojo-type\x3d"dijit/form/CheckBox" checked\x3e\x3c/div\x3e\r\n                  \x3clabel for\x3d"publish-webmap-sharing"\x3e${nls.shareSameLevel}\x3c/label\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/Tags.html":'\x3cdiv class\x3d"${baseClass}" style\x3d"outline:none;"\x3e\x3c/div\x3e\r\n',"url:jimu/dijit/templates/ImageChooser.html":'\x3cdiv class\x3d"jimu-image-chooser js-fileapi-wrapper"\x3e\r\n  \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintText"\x3e\r\n\t\t\x3cspan class\x3d"display-text" data-dojo-attach-point\x3d"displayText"\x3e\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintImage"\x3e\r\n\t\t\x3cimg class\x3d"display-image" data-dojo-attach-point\x3d"selfImg"\x3e\r\n  \x3c/div\x3e\r\n  \x3cform data-dojo-attach-point\x3d"fileForm"\x3e\r\n    \x3clabel data-dojo-attach-point\x3d"mask"\x3e\x3c/label\x3e\r\n    \x3cinput type\x3d"file" data-dojo-attach-point\x3d"fileInput"\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_CropImage.html":'\x3cdiv class\x3d"jimu-crop-image"\x3e\r\n\t\x3cdiv class\x3d"crop-section" data-dojo-attach-point\x3d"cropSection"\x3e\r\n\t\t\x3cdiv class\x3d"viewer-box hide-status" data-dojo-attach-point\x3d"viewerBox"\x3e\r\n\t\t\t\x3cdiv class\x3d"viewer-content" data-dojo-attach-point\x3d"viewerContent"\x3e\r\n\t\t\t\t\x3cimg class\x3d"viewer-image hide-status" data-dojo-attach-point\x3d"viewerImage" src\x3d""\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cimg class\x3d"base-image hide-status" data-dojo-attach-point\x3d"baseImage" data-dojo-attach-event\x3d"mousedown:_onViewerMouseDown,mouseup:_onViewerMouseUp"\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cimg class\x3d"loading-image" data-dojo-attach-point\x3d"loadingImg" src\x3d""\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"controller hide-status" data-dojo-attach-point\x3d"zoomController"\x3e\r\n\t\t\x3cdiv class\x3d"zoom-out" data-dojo-attach-point\x3d"zoomOutBtn" data-dojo-attach-event\x3d"click:_onZoomOutClick"\x3e-\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"slider" data-dojo-attach-point\x3d"sliderNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"button" data-dojo-attach-point\x3d"sliderButton" data-dojo-attach-event\x3d"mousedown:_onSliderMouseDown,mouseup:_onSliderMouseUp"\x3e\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"horizontal"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"zoom-in" data-dojo-attach-point\x3d"zoomInBtn" data-dojo-attach-event\x3d"click:_onZoomInClick"\x3e+\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-templateconfig/Plugin.html":'\x3cdiv \x3e\r\n  \x3cdiv class\x3d"header-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"left-part jimu-float-leading"\x3e\r\n    \x3cdiv class\x3d"config-panel" data-dojo-attach-point\x3d"configPanel"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"action-panel"\x3e\r\n      \r\n      \x3cdiv class\x3d"to-app-btn jimu-float-leading" title\x3d"${nls.toConfigApp}" data-dojo-attach-event\x3d"onclick:_onToAppClick" \x3e${nls.toConfigApp}\x3c/div\x3e\r\n      \x3cdiv class\x3d"save-btn jimu-float-trailing" data-dojo-attach-point\x3d"savePluginNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"separate jimu-float-trailing"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e    \r\n  \x3c/div\x3e\r\n\r\n \x3cdiv class\x3d"preview-panel jimu-float-leading" \x3e\r\n    \x3cdiv class\x3d"preview-content" data-dojo-attach-point\x3d"previewPanel"\x3e\r\n    \x3c/div\x3e\r\n \x3c/div\x3e\r\n\r\n\x3c/div\x3e',
"url:builder/plugins/app-config-templateconfig/css/style.css":".plugin-config-template {background-color: #ffffff; position: relative;}.plugin-config-template .header-line{width: 100%; position: absolute; border-style: none none solid none; border-width: 1px; box-shadow: 0px 0px 6px rgba(0,0,0,0.4); border-color: rgba(0,0,0,0.0);}.plugin-config-template .left-part{width: 60%; height: 100%; position: relative; box-shadow: 0px 0px 8px rgba(0,0,0,0.4);}.plugin-config-template .config-panel{position: absolute; left: 0; right: 0; top: 0; bottom: 50px; box-shadow: 0px 0px 8px rgba(0,0,0,0.4); z-index: 2;}.plugin-config-template .action-panel{width: 100%; position: absolute; left: 0; right: 0; bottom: 0; height: 52px; background-color: #F3F3F3; font-size: 14px;}.plugin-config-template .action-panel .to-app-btn{background-image: url(../../../../stemapp/jimu.js/css/images/setting_disabled.png); height: 100%; line-height: 52px; padding-left: 50px; background-repeat: no-repeat; background-position: 25px center; cursor: pointer;}.jimu-rtl .plugin-config-template .action-panel .to-app-btn{padding-right: 50px; padding-left: auto; background-position: right 25px center;}.plugin-config-template .action-panel .to-app-btn:hover{background-image: url(../../../../stemapp/jimu.js/css/images/setting_hover.png); color: #15a4fa;}.plugin-config-template .action-panel .separate{border: 1px solid #a3a3a3; height: 20px; margin-top: 16px;}.plugin-config-template .action-panel .save-btn{margin-right: 40px; margin-left: 40px;}.plugin-config-template .preview-panel{width: 40%; height: 100%; overflow-y: auto; overflow-x: hidden; -ms-overflow-y: auto; -ms-overflow-x: hidden;}.plugin-config-template .preview-panel .preview-content{width: 80%; margin: 0 auto; min-width: 300px;}",
"url:builder/plugins/app-list/Plugin.html":'\x3cdiv\x3e\r\n  \x3c!--header\x3e\x3c--\x3e\r\n  \x3cdiv class\x3d"header" data-dojo-attach-point\x3d"header"\x3e\r\n    \x3cdiv class\x3d"navigator-box" data-dojo-attach-point\x3d"navigatorBox"\x3e\r\n      \x3c!--div class\x3d"switch-app" style\x3d"float: left; cursor: pointer; margin-right: 5px" data-dojo-attach-point\x3d"switchApps"  data-dojo-attach-event\x3d"onclick:_onSwitchToAppContent"\x3eapps\x3c/div\x3e\r\n      \x3cdiv class\x3d"switch-template" style\x3d"float: left; cursor: pointer;" data-dojo-attach-point\x3d"switchTemplates" data-dojo-attach-event\x3d"onclick:_onSwitchToTemplateContent"\x3etempaltes\x3c/div--\x3e    \r\n      \x3cdiv class\x3d"navigator" data-dojo-attach-point\x3d"navigator"\x3e\r\n        \x3cdiv class\x3d"filter-box jimu-float-leading" data-dojo-attach-point\x3d"filterBox"\x3e\r\n          \x3cdiv class\x3d"filter all selected jimu-float-leading" id\x3d"ALL" data-dojo-attach-point\x3d"filterAllBtn" data-dojo-attach-event\x3d"onclick:_filterAllBtnClick"\x3e${nls.all}\x3c/div\x3e\r\n          \x3cdiv class\x3d"filter 2d jimu-float-leading" id\x3d"HTML" data-dojo-attach-point\x3d"filter2dBtn" data-dojo-attach-event\x3d"onclick:_filter2dBtnClick"\x3e${nls.d2}\x3c/div\x3e\r\n          \x3cdiv class\x3d"filter 3d jimu-float-leading" id\x3d"HTML3D" data-dojo-attach-point\x3d"filter3dBtn" data-dojo-attach-event\x3d"onclick:_filter3dBtnClick"\x3e${nls.d3}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"search jimu-float-trailing" data-dojo-attach-point\x3d"search"\x3e\r\n          \x3cdiv class\x3d"search-box jimu-float-leading" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"searchBox" trim\x3d"true" maxlength\x3d"250" required\x3d"true" placeholder\x3d${nls.searchPlaceholder} data-dojo-attach-event\x3d"onKeyUp:_onSearchBoxChange"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"search-btn jimu-float-leading" data-dojo-attach-point\x3d"searchBtn"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"sort-box jimu-float-trailing" data-dojo-attach-point\x3d"sortBox"\x3e\r\n          \x3cdiv class\x3d"sort by-modified-time selected jimu-float-leading" id\x3d"lastUpdated" data-dojo-attach-point\x3d"sortByModifiedTimeBtn" data-dojo-attach-event\x3d"onclick:_sortByModifiedTimeBtnClick" title\x3d"${nls.sortByModifiedTime}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"sort by-name jimu-float-leading" id\x3d"name" data-dojo-attach-point\x3d"sortByNameBtn"  data-dojo-attach-event\x3d"onclick:_sortByNameBtnClick" title\x3d"${nls.sortByName}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"sort by-author jimu-float-leading" id\x3d"creator" data-dojo-attach-point\x3d"sortByAuthorBtn" data-dojo-attach-event\x3d"onclick:_sortByAuthorBtnClick" style\x3d"display: none" title\x3d"${nls.sortByAuthor}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"content-box" id\x3d"content-box" data-dojo-attach-point\x3d"contentBox"\x3e\r\n    \x3c!--operation\x3e\x3c--\x3e\r\n    \x3cdiv class\x3d"operation-box" data-dojo-attach-point\x3d"operationBox"\x3e\r\n      \x3cdiv class\x3d"create jimu-float-leading" data-dojo-attach-point\x3d"createNewBtn" data-dojo-attach-event\x3d"onclick:_onCreateClick" title\x3d${nls.appCreate}\x3e${nls.appCreate}\x3c/div\x3e\r\n      \x3cdiv class\x3d"import jimu-float-leading" data-dojo-attach-point\x3d"importBtn"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"switch-app-page-box" data-dojo-attach-point\x3d"switchAppPapgeBox"\x3e \x3c/div\x3e\r\n    \x3c/div\x3e  \r\n    \x3c!--content\x3e\x3c--\x3e\r\n    \x3cdiv class\x3d"content app-content selected" id\x3d"app-content" data-dojo-attach-point\x3d"appContent"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"content tempalte-content" id\x3d"template-content" data-dojo-attach-point\x3d"templateContent"\x3e\x3c/div\x3e\r\n    \x3c!--footer\x3e\x3c--\x3e\r\n    \x3cdiv class\x3d"footer" data-dojo-attach-point\x3d"footer"\x3e\r\n      \x3cdiv class\x3d"footer-text"\x3e\r\n        \x3cspan class\x3d"jimu-float-leading"\x3e\u00a9 Copyright 2016 Environmental Systems Research Institute, Inc.\x3c/span\x3e\r\n        \x3cspan class\x3d"separator jimu-float-leading"\x3e|\x3c/span\x3e\r\n        \x3ca class\x3d"jimu-float-leading" target\x3d"_blank" href\x3d"//www.esri.com/legal/privacy"\x3ePrivacy\x3c/a\x3e\r\n        \x3cspan class\x3d"separator jimu-float-leading"\x3e|\x3c/span\x3e\r\n        \x3ca class\x3d"jimu-float-leading" target\x3d"_blank" href\x3d"//www.esri.com/legal/software-license"\x3eLegal\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3ciframe style\x3d"display:none" name\x3d"downloadTargetFrame"\x3e\x3c/iframe\x3e\r\n\x3c/div\x3e\r\n\r\n',
"url:builder/plugins/app-list/Import.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"actions jimu-float-trailing" data-dojo-attach-point\x3d"actionsNode"\x3e\r\n    \x3cspan class\x3d"actions-label jimu-ellipsis" title\x3d"${nls.actionsLabel}" data-dojo-attach-event\x3d"onclick:_onActionsLabelClick"\x3e${nls.actionsLabel}\x3c/span\x3e\r\n    \x3cdiv class\x3d"actions-menu" data-dojo-attach-point\x3d"actionsMenu"\x3e\r\n      \x3cdiv class\x3d"actions-menu-item item-import" data-dojo-attach-point\x3d"itemImportBtn" data-dojo-attach-event\x3d"onclick:_onMenuItemClick"\x3e\r\n        \x3cdiv class\x3d"import-button jimu-ellipsis" title\x3d"${nls.importAction}" data-dojo-attach-event\x3d"onclick:_onImportClick"\x3e${nls.importAction}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"actions-menu-item item-upload" data-dojo-attach-event\x3d"onclick:_onMenuItemClick"\x3e\r\n        \x3cdiv class\x3d"upload-button-div"\x3e\r\n          \x3cdiv class\x3d"upload-button jimu-ellipsis" title\x3d"${nls.uploadAction}"\x3e${nls.uploadAction}\x3c/div\x3e\r\n          \x3cform enctype\x3d"multipart/form-data" encoding\x3d"multipart/form-data" title\x3d"${nls.uploadAction}" method\x3d"post" action\x3d"/webappbuilder/rest/apps/upload" data-dojo-attach-point\x3d"uploadAppFileFormNode"\x3e\r\n            \x3cinput class\x3d"file-input" title\x3d"${nls.uploadAction}" name\x3d"app" type\x3d"file" data-dojo-attach-point\x3d"appFileInputNode" data-dojo-type\x3d"dojox/form/Uploader" data-dojo-attach-event\x3d"onChange:_onAppFileChange,onError:_onAppFileUploadError,onComplete:_onAppFileUploadComplete" accept\x3d".zip" style\x3d"width:100%;height:100%;"\x3e\r\n            \x3cinput name\x3d"creator" type\x3d"text" value\x3d"1234" style\x3d"display:none;" data-dojo-attach-point\x3d"appFileCreatorInputNode"\x3e\r\n            \x3cinput name\x3d"portalUrl" type\x3d"text" style\x3d"display:none" data-dojo-attach-point\x3d"appPortalUrlInputNode"\x3e\r\n            \x3cinput name\x3d"fromList" type\x3d"text" style\x3d"display:none" data-dojo-attach-point\x3d"fromListNode"\x3e\r\n          \x3c/form\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n',
"url:jimu/dijit/templates/ItemSelector.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"setting-tab-container"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" style\x3d"position:absolute;width:100%;top:50px;" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.groups}:\x3c/span\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:85px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" type\x3d"radio" name\x3d"publicSearchRadio" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalPublicLabel" class\x3d"jimu-float-leading portal-public-label"\x3ePortal\x3c/label\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" type\x3d"radio" name\x3d"publicSearchRadio" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlinePublicLabel" class\x3d"jimu-float-leading online-public-label"\x3eArcGIS Online\x3c/label\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicItemSection" class\x3d"public-item-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/TabContainer3.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"control-node" data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"controlTable" class\x3d"control-table" cellpading\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"container-node" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"tab-shelter" data-dojo-attach-point\x3d"shelter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_ItemTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"items-section all-items-section" data-dojo-attach-point\x3d"allItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"allItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onAllItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"allItemTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allItemsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"items-section filtered-items-section" data-dojo-attach-point\x3d"filteredItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"filteredItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onFilteredItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"filteredItemsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip jimu-state-error-text"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredItemShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/templates/FullScreenPopup.html":'\x3cdiv data-dojo-attach-event\x3d"onclick:_onContainerClick"\x3e\r\n  \x3cdiv class\x3d"background" data-dojo-attach-point\x3d"background"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"main" data-dojo-attach-point\x3d"main"\x3e\r\n    \x3cdiv class\x3d"head" data-dojo-attach-point\x3d"head"\x3e\r\n      \x3cdiv class\x3d"head-underline"\x3e\r\n        \x3cspan class\x3d"title" data-dojo-attach-point\x3d"fullscreenPopupTitle"\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"close" data-dojo-attach-point\x3d"fullscreenPopupClose"\r\n             data-dojo-attach-event\x3d"onclick:_onCloseClick"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"content-scroller" data-dojo-attach-point\x3d"contentScroller"\x3e\r\n      \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"fullscreenPopupContent"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"btnsContainer" data-dojo-attach-point\x3d"fullscreenPopupBtnsContainer"\x3e\r\n      \x3cdiv class\x3d"btns" data-dojo-attach-point\x3d"fullscreenPopupBtns"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dojox/form/resources/Uploader.html":'\x3cspan class\x3d"dijit dijitReset dijitInline"\r\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e \r\n\t\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen" tabIndex\x3d"-1" data-dojo-attach-point\x3d"valueNode" /\x3e\r\n\x3c/span\x3e\r\n',
"url:builder/plugins/app-list/AppCatalogPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"app-content" data-dojo-attach-point\x3d"appContent"\x3e\r\n    \x3cdiv class\x3d"list-section" id\x3d"list-section" data-dojo-attach-point\x3d"listSection"\x3e\r\n      \x3cdiv class\x3d"list-section-body-content" id\x3d"list-section-body-content" data-dojo-attach-point\x3d"listSectionBodyContent"\x3e\r\n        \x3ctable class\x3d"list-table" data-dojo-attach-point\x3d"listTable"\x3e\r\n          \x3ctbody data-dojo-attach-point\x3d"listTableBody"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!--iframe style\x3d"display:none" name\x3d"downloadTargetFrame"\x3e\x3c/iframe--\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-list/AppOperMenu.html":'\x3cdiv data-dojo-attach-event\x3d"onclick:_onMenuClick"\x3e\r\n  \x3cdiv class\x3d"up-triangle" data-dojo-attach-point\x3d"upTriangle"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"down-triangle" data-dojo-attach-point\x3d"downTriangle"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"item item-createApp-from-template" data-dojo-attach-point\x3d"createAppFromTemplate" data-dojo-attach-event\x3d"onclick:_onCreateAppFromTempalteClick"\x3e${nls.createApp}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-editAppInfo" data-dojo-attach-point\x3d"editAppInfo" data-dojo-attach-event\x3d"onclick:_onEditClick"\x3e${nls.editAppInfo}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-download" data-dojo-attach-point\x3d"download" data-dojo-attach-event\x3d"onclick:_onDownloadClick"\x3e\r\n    \x3ca data-dojo-attach-point\x3d"downloadLinkNode" style\x3d"display:inline-block;width:100%;height:100%;" target\x3d"downloadTargetFrame"\x3e${nls.download}\x3c/a\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-duplicate" data-dojo-attach-point\x3d"duplicate" data-dojo-attach-event\x3d"onclick:_onDuplicateClick"\x3e${nls.duplicate}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-remove" style\x3d"border-bottom-left-radius:5px;border-bottom-right-radius:5px;" data-dojo-attach-point\x3d"remove" data-dojo-attach-event\x3d"onclick:_onRemoveClick"\x3e${nls.deleteMenu}\x3c/div\x3e\r\n  \x3c!--div class\x3d"item item-agol-template" style\x3d"border-bottom-left-radius:5px;border-bottom-right-radius:5px;" data-dojo-attach-point\x3d"agolTemplate" data-dojo-attach-event\x3d"onclick:_onAgolTemplateClick"\x3e${nls.agolTemp}\x3c/div\x3e \r\n  \x3cdiv class\x3d"item item-qrcode" style\x3d"" data-dojo-attach-point\x3d"qrcode" data-dojo-attach-event\x3d"onclick:_onQRCodeClick"\x3eqrcodeeeeeee-nonls\x3c/div--\x3e \r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/EditItemInfo.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"image-chooser-container" data-dojo-attach-point\x3d"imageChooserContainer"\x3e\r\n    \x3cdiv class\x3d"chooser-border"\x3e\r\n      \x3cdiv class\x3d"image-chooser-masker" data-dojo-attach-point\x3d"imageChooserMasker"\x3e${nls.change}\x3c/div\x3e\r\n      \x3cdiv class\x3d"image-chooser-base" id\x3d"publish-webmap-thumbnail" data-dojo-attach-point\x3d"imageChooserBase"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"app-info-edit" data-dojo-attach-point\x3d"appInfoEdit"\x3e\r\n    \x3cdiv\x3e\r\n      \x3clabel for\x3d"publish-webmap-name"\x3e\r\n        ${nls.nameLabel}\r\n      \x3c/label\x3e\r\n      \x3cinput id\x3d"publish-webmap-name" data-dojo-type\x3d"dijit/form/TextBox" trim\x3d"true" data-dojo-attach-point\x3d"appName"\r\n             maxlength\x3d"250" required\x3d"true" placeHolder\x3d"${nls.nameLabelPlaceHolder}"\r\n             class\x3d"app-info-edit-name"\x3e\r\n      \x3c/input\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv\x3e\r\n      \x3clabel for\x3d"publish-webmap-summary"\x3e\r\n        ${nls.summaryLabel}\r\n      \x3c/label\x3e\r\n      \x3ctextarea id\x3d"publish-webmap-summary" data-dojo-type\x3d"dijit/form/SimpleTextarea" rows\x3d\'5\' trim\x3d"true"\r\n                maxlength\x3d"250" required\x3d"true" style\x3d"resize:none;" class\x3d"app-info-edit-summary"\r\n                data-dojo-attach-point\x3d"publishWebmapSummary"\x3e\x3c/textarea\x3e\r\n    \x3c/div\x3e\r\n    \x3c!--\r\n    \x3cdiv\x3e\r\n      \x3clabel for\x3d"publish-webmap-tags"\x3e\r\n        ${nls.tagsLabel}\r\n      \x3c/label\x3e\r\n      \x3cdiv id\x3d"publish-webmap-tags" data-dojo-type\x3d"builder/dijit/Tags" data-dojo-attach-point\x3d"tags"\r\n           style\x3d"width:95%;max-width:95%;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e--\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-list/CardPageWithBigThumbnail.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"card-page-content" data-dojo-attach-point\x3d"cardPageContent"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/app-list/CardPageWithSmallThumbnail.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"app-card-page-content" id\x3d"app-card-page-content" data-dojo-attach-point\x3d"appCardPageContent"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n',"url:builder/plugins/app-list/css/style.css":'.app-oper-menu {position: absolute; background-color:#354052; min-width:160px; max-width: 300px; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; z-index: 1; border-radius: 5px;}.app-oper-menu.white-style {background-color:#ffffff; box-shadow: 0 0 8px rgba(0, 0, 0, 0.2)}.app-oper-menu .item{width: 100%; height: 40px; min-height: 30px; padding-left: 20px; padding-right: 20px; border: 0px solid; color: #a0acbf; font-size: 14px; cursor: pointer; line-height: 40px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.app-oper-menu.white-style .item{color: #333333; border-bottom: 1px solid #e4e7e7;}.app-oper-menu .item:hover{background-color: #6f7e95; color: #ffffff;}.app-oper-menu.white-style .item:hover{background-color: #f8f9fb; color: #31aacd;}.jimu-rtl .app-oper-menu .item{padding-right: 20px; padding-left: 0px;}.app-oper-menu .item.border-top-radius{border-top-left-radius:5px; border-top-right-radius:5px;}.app-oper-menu .item.border-bottom-radius{border-bottom-left-radius:5px; border-bottom-right-radius:5px;}.app-oper-menu .item a{text-decoration: none; color: inherit;}.app-oper-menu .up-triangle{position: absolute; width: 18px; height: 11px; top: -11px; right: 20px; background: url("images/up_triangle.png");}.app-oper-menu.white-style .up-triangle{background: url("images/up_triangle_white.png"); background-repeat: no-repeat; background-position: center;}.jimu-rtl .app-oper-menu .up-triangle{left: 20px; right: auto;}.app-oper-menu .down-triangle{position: absolute; width: 18px; height: 11px; right: 20px; background: url("images/down_triangle.png"); display: none; background-repeat: no-repeat;}.app-oper-menu.white-style .down-triangle{background: url("images/down_triangle_white.png"); background-repeat: no-repeat; background-position: center;}.jimu-rtl .app-oper-menu .down-triangle{left: 20px; right: auto;}.import-app .actions{margin-right:2px; position: relative; display: inline-block; background-color: #ffffff; border-radius: 2px; border: 1px solid #31aacd; height: 40px;}.import-app .actions:hover{background-color: #f4f4f4;}.jimu-rtl .import-app .actions{margin-left:2px;}.import-app .actions-label{display: inline-block; width: 120px; margin: 0 15px; padding-right: 8px; background: url("images/v_blue.png") right no-repeat; color: #31aacd; line-height: 35px; font-size: 14px; font-weight: bold; text-align: center; cursor: pointer;}.jimu-rtl .import-app .actions-label{padding-left: 8px; padding-right: 0; background-position: left center;}.import-app .actions-menu {display: none; position: absolute; top: 41px; left: 0; z-index: 9999; background: #fff; box-shadow: 0 0 4px #646464; color: #333333; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; border-radius: 5px;}.jimu-rtl .import-app .actions-menu{left: auto; right: 0;}.import-app .actions-menu-item{position: relative; width: 250px; height: 30px; overflow: hidden; cursor: pointer; white-space: nowrap; padding: 0 25px; background-color: #ffffff; border-bottom: 1px solid #e4e7e7; border-radius: 5px; font-size: 14px;}.import-app .actions-menu-item .upload-button,.import-app .actions-menu-item .import-button {line-height: 30px; padding-left: 18px; background-repeat: no-repeat; background-position: left center;}.jimu-rtl .import-app .item-import .import-button,.jimu-rtl .import-app .item-upload .upload-button{padding-right: 18px; padding-left: 0; background-position: right center;}.import-app .item-import .import-button{background-image: url("images/clouda.png");}.import-app .item-import:hover .import-button{background-image: url("images/cloudb.png");}.import-app .item-upload .upload-button{background-image: url("images/computera.png");}.import-app .item-upload:hover .upload-button{background-image: url("images/computerb.png");}.import-app .actions-menu-item:hover{background-color: #f8f9fb; color: #31aacd;}.import-app .upload-button-div form{position:absolute; top:0; bottom:0; width:100%; opacity:0; overflow: hidden; width: 200px; filter: Alpha(opacity\x3d0); -ms-filter: "Alpha(opacity\x3d0)";}.import-app .upload-button-div form span.dijitButtonNode{filter: Alpha(opacity\x3d0); -ms-filter: "Alpha(opacity\x3d0)";}.import-app .upload-button-div form span.dijitButton input{cursor: pointer;}.fullscreen-popup-container .content .control-node {line-height: 30px; height: 30px; width: 470px;}.fullscreen-popup-container .content .control-node .jimu-item-selector .jimu-tab3\x3e.container-node {top: 62px;}.fullscreen-popup-container .control-node .control-table {font-size: 14px; color: #999; line-height: 14px;}.fullscreen-popup-container .control-node .tab-item-td {width: 100px; padding: 0 10px; border: none;}.fullscreen-popup-container .control-node .tab-item-td:last-child {display: none;}.fullscreen-popup-container .jimu-item-selector .jimu-tab3\x3e.container-node{top:54px;}.fullscreen-popup-container .jimu-item-selector .jimu-tab3\x3e.container-node .jimu-item-table{top:40px; height: 100%;}.fullscreen-popup-container .control-node .jimu-state-active {color: #d84b28; border: none; border-bottom: 2px solid #d84b28;}.fullscreen-popup-container .container-node {min-height: 400px;}.fullscreen-popup-container .jimu-item-table .items-section {bottom:70px;}.fullscreen-popup-container .container-node .jimu-item-table .items-table-div {}.fullscreen-popup-container .container-node .tab-content .jimu-search {height: 40px; margin-top: 12px;}.fullscreen-popup-container .container-node .tab-content .jimu-search .jimu-icon-search {width: 16px; height: 16px; background: url("images/search.png") center no-repeat;}.fullscreen-popup-container .container-node .tab-content .jimu-search .jimu-icon-search:hover {background: url("images/search_selected.png") center no-repeat;}.fullscreen-popup-container .container-node .tab-content .public-item-section{top: 35px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table {margin-top: 20px;}.fullscreen-popup-container .container-node .tab-content .items-table .jimu-item-table .item-thumbnail {width: 180px; height: 120px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table .item-thumbnail:hover {border: 2px solid #0f95bc; border-radius: 0px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table .item-info{left: 180px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table .items-table td {padding-bottom: 20px;}.fullscreen-popup-container .container-node .jimu-item-table .item-thumbnail{border: 2px solid transparent;}.fullscreen-popup-container .container-node .jimu-item-table .items-table .item-border{left: 2px; top: 1px; width: 176px; height: 112px;}.jimu-rtl .fullscreen-popup-container .container-node .jimu-item-table .items-table .item-border{right: 2px; left: auto;}.fullscreen-popup-container .container-node .jimu-item-table .item-border {border: 2px solid #15a4fa;;}.fullscreen-popup-container .container-node .item-info{width:180px; height:100px; margin: 10px 30px 0 10px;}.fullscreen-popup-container .container-node .item-border {border: 3px solid #15a4fa; -webkit-border-radius: 0; -moz-border-radius: 0; -o-border-radius: 0; -ms-border-radius: 0; border-radius: 0;}.fullscreen-popup-container .container-node .item-info .item-name{font-size: 18px; font-family: "Avenir Medium"; color: #333; line-height: 18px;}.fullscreen-popup-container .container-node .item-info .item-type-owner,.fullscreen-popup-container .container-node .item-info .item-date {margin-top: 10px; font-size: 12px; color: #666; line-height: 18px; overflow:hidden;}.fullscreen-popup-container .container-node .item-info .item-date{margin-top: 8px;}.app-list-page{width: 100%; height: 100%; position: relative;}.app-list-page .separate-line {height: 47px; border-bottom: 1px solid #cfd7d7;}.app-list-page .switch-app-template {top: 16px; position: relative; max-width: 1180px; min-width: 1024px; margin: 0 auto; font-size: 16px; color: #a3a3a3; font-weight: bold;}.app-list-page .switch-app-template .switch-btn-box {position: relative; display: inline-block; margin-right: 1px;}.app-list-page .switch-app-template .switch-btn {margin-right: 8px; margin-left: 8px; cursor: pointer; min-width: 80px; text-align: center;}.app-list-page .switch-app-template .switch-btn-box:hover {color: #508dca;}.app-list-page .switch-app-template .switch-btn-box.selected {color: #508dca;}.app-list-page .switch-app-template .switch-btn-box .blue-block {position: absolute; width: 100%; height: 4px; bottom: -8px;}.app-list-page .switch-app-template .switch-btn-box:hover .blue-block{background-color: #508dca;}.app-list-page .switch-app-template .switch-btn-box.selected .blue-block{background-color: #508dca;}.app-list-page .app-content{position: relative; max-width: 1180px; min-width: 1024px; margin: 50px auto; height: 100%;}.app-list-page .head-section {display: inline-block; width: 100%; padding-bottom: 30px;}.app-list-page .head-section .textPart1{margin-top: 15px; color: #6f7a8b; font-size: 18px;}.app-list-page .head-section .textPart2{margin-top: 20px; margin-left: 3px; color: #002157; font-size: 14px;}.jimu-rtl .app-list-page .head-section .textPart2{margin-right: 3px;}.app-list-page .head-section .create-button-div{height: 50px; position: relative; left: -16px; display: inline-block; padding-top: 8px;}.jimu-rtl .app-list-page .head-section .create-button-div{right: -16px;}.app-list-page .head-section .create-button{width: 140px; height: 37px; background-color: #518dca; border: 1px solid #348599; color: #ffffff; font-size: 15px; font-weight: bold; border-radius: 4px; cursor: pointer; box-shadow: 0px 1px 2px #a0acbf;} .app-list-page .app-content .list-section{position: absolute; top: 78px; width: 100%;} .app-list-page .app-content .list-section-head {table-layout: fixed; border-spacing: 0px; background-color: #6f7e95; width: 100%; height: 49px; border-top-left-radius: 4px; border-top-right-radius: 4px; box-shadow: 1px 1px 2px #a0acbf;}.app-list-page .app-content .list-section .head-content {}.app-list-page .app-content .list-section .head-content .name{width: 270px; color: #ffffff; font-size: 14px; border: 0px solid; padding-left: 25px;}.jimu-rtl .app-list-page .app-content .list-section .head-content .name{padding-right: 25px;}.app-list-page .app-content .list-section .head-content .desc{width: 300px; color: #ffffff; font-size: 14px; border: 0px solid;}.app-list-page .app-content .list-section .head-content .time{color: #ffffff; font-size: 14px; border: 0px solid; width: 150px;}.app-list-page .app-content .list-section .head-content .modified{color: #ffffff; font-size: 14px; border: 0px solid; width: 100px; display: none;}.app-list-page .app-content .list-section .head-content .creator{color: #ffffff; font-size: 14px; border: 0px solid;} .app-list-page .app-content .list-section-body{position: absolute; top: 127px; bottom: 150px; width: 100%; overflow: hidden;}.app-list-page .app-content .list-section-body-content{max-height: 100%; border: 1px solid #a0acbf; box-shadow: 1px 1px 2px #a0acbf; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;}.app-list-page .app-content .list-table{table-layout: fixed; border-spacing: 0px; width: 100%;}.app-list-page .app-content .list-table-item{height: 40px; background-color: #fafafa;}.app-list-page .app-content .list-table-item-add{}.app-list-page .app-content .list-table-item-mouseover{background-color: #e3ecf2;}.app-list-page .app-content .list-table-next-item-mouseover td{border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item-dbclick{background-color: #fffce4;}.app-list-page .app-content .list-table-item .item-first-td{width: 4px; vertical-align: top;}.app-list-page .app-content .list-table-item .item-second-td{width: 16px; vertical-align: top;}.app-list-page .app-content .list-table-item .item-first-td-selected {background-color: #15a4fa;}.app-list-page .app-content .list-table-item .item-end-td{width: 4px;}.app-list-page .app-content .list-table-item .item-name-td{width: 250px; vertical-align: top; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-name{overflow: hidden; color: #596679; font-size: 14px; border: 0px solid; width: 230px; max-height: 40px; min-height: 20px; margin-top: 10px; margin-bottom: 10px; line-height: 20px; white-space: normal; word-wrap: break-word; word-break: break-word;}.app-list-page .app-content .list-table-item .item-input-name{width: 230px; height: 30px; margin-left: 10px; margin-top: 5px; border: 1px solid #999999; background-color: #ffffff}.app-list-page .app-content .list-table-item .item-desc-td{width:300px; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-desc{overflow: hidden; color: #596979; font-size: 14px; border: 0px solid; margin-right: 5px; width: 270px; max-height: 40px; min-height: 20px; margin-top: 10px; margin-bottom: 10px; line-height: 20px; white-space: normal; word-wrap: break-word; word-break: break-word;}.app-list-page .app-content .list-table-item .item-textarea-description{width: 285px; height: 82px; border: 1px solid #999999; resize: none; margin-top: 7px; margin-bottom: 7px;}.app-list-page .app-content .list-table-item .item-time-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 150px;}.app-list-page .app-content .list-table-item .item-time{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px; height: 40px;}.app-list-page .app-content .list-table-item .item-modified-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 100px; display: none;}.app-list-page .app-content .list-table-item .item-modified{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px;}.app-list-page .app-content .list-table-item .item-creator-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 83px;}.app-list-page .app-content .list-table-item .item-creator{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px;}.app-list-page .app-content .list-table-item .item-loading-td{width: 14px; max-width: 14px; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-loading-td .loading-div{display: none; width: 14px;}.app-list-page .app-content .list-table-item .item-operations-td{vertical-align: top; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-operations-div{border: 0px solid; width: 190px; margin: 0px 0px 0px auto; color: #A0acbf; font-size: 14px;}.jimu-rtl .app-list-page .app-content .list-table-item .item-operations-div{margin: 0px auto 0px 0px;}.app-list-page .app-content .list-table-item .item-edit{border: 0px solid; margin-right: 5px; cursor: pointer; height: 40px; width: 65px; background-image: url("images/edit_icon01.png"); background-repeat: no-repeat; background-position: center left; overflow: hidden;}.jimu-rtl .app-list-page .app-content .list-table-item .item-edit{margin-left: 5px; margin-right: auto; background-position: center right;}.app-list-page .app-content .list-table-item .item-edit:hover{background-image: url("images/edit_icon02.png"); color: #518dca !important;}.jimu-rtl .app-list-page .app-content .list-table-item .item-edit-image{}.app-list-page .app-content .list-table-item .item-edit-text{line-height: 40px; padding-left: 17px; width: 100%; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.jimu-rtl .app-list-page .app-content .list-table-item .item-edit-text{padding-right: 17px; padding-left: 0;}.app-list-page .app-content .list-table-item .item-preview{border: 0px solid; margin-right: 0px; cursor: pointer; width: 80px; height: 40px; line-height: 40px; background-image: url("images/launch2.png"); background-repeat: no-repeat; background-position: center left; overflow: hidden;}.jimu-rtl .app-list-page .app-content .list-table-item .item-preview{margin-left: 0px; margin-right: auto; background-position: center right;}.app-list-page .app-content .list-table-item .item-preview:hover{background-image: url("images/launch3.png"); color: #518dca !important;}.app-list-page .app-content .list-table-item .item-preview a{text-decoration: none; color: inherit; display: inline-block; padding-left: 19px; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; width: 100%;}.jimu-rtl .app-list-page .app-content .list-table-item .item-preview a{padding-right: 24px; padding-left: 0px;}.app-list-page .app-content .list-table-item .item-preview img{margin-top: 13px; margin-right: 5px;}.jimu-rtl .app-list-page .app-content .list-table-item .item-preview img{margin-left: 13px; margin-right: auto;}.app-list-page .app-content .list-table-item .item-more{height: 40px; width: 38px; text-align: center; cursor: pointer; background-image: url("images/moreaction_icon.png"); background-repeat: no-repeat; background-position: center center; overflow: hidden;}.app-list-page .app-content .list-table-item .item-more-selected{background-image: url("images/moreaction_icon1.png") !important;}.app-list-page .app-content .list-table-item .item-more:hover{background-image: url("images/moreaction_icon1.png");}.app-list-page .app-content .list-table-item .item-more-image{margin-top: 18px;}.app-list-page .app-menu {position: absolute; background-color:#354052; width:160px; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; z-index: 1; border-radius: 5px;}.app-list-page .app-menu .item{width: 100%; min-height: 30px; padding-left: 20px; border: 0px solid; color: #a0acbf; font-size: 14px; cursor: pointer; padding-top: 12px; padding-bottom: 12px;}.jimu-rtl .app-list-page .app-menu .item{padding-right: 20px; padding-left: 0px;}.app-list-page .app-menu .item.border-top-radius{border-top-left-radius:5px; border-top-right-radius:5px;}.app-list-page .app-menu .item.border-bottom-radius{border-bottom-left-radius:5px; border-bottom-right-radius:5px;}.app-list-page .app-menu .item a{text-decoration: none; color: inherit;}.app-list-page .app-menu .up-triangle{position: absolute; width: 18px; height: 11px; top: -10px; right: 20px; background: url("images/up_triangle.png");}.jimu-rtl .app-list-page .app-menu .up-triangle{left: 20px; right: auto;}.app-list-page .app-menu .down-triangle{position: absolute; width: 18px; height: 11px; right: 20px; background: url("images/down_triangle.png"); display: none; background-repeat: no-repeat;}.jimu-rtl .app-list-page .app-menu .down-triangle{left: 20px; right: auto;}.app-list-page .app-menu .item:hover{background-color: #6f7e95; color: #ffffff;}.edit-app-info-content {color: #4d4d4d; font-size: 14px; font-family: monospace;}.edit-app-info-content .app-thumbnail {width: 200px; height: 133px; margin-top:20px; margin-left: 30px; display: inline-block;}.edit-app-info-content .app-name {margin-left: 30px;}.edit-app-info-content .app-description {margin-left: 30px; margin-top: 20px;}.edit-app-info-content .dijitTextBox {}.edit-app-info-content .dijitTextBoxFocused {border-color: #406b9b !important; box-shadow: 0 0 0 #ffffff !important;}.edit-app-info-content .dijitTextBoxHover{background-color: #ffffff; background-image: none;}.edit-app-info-content .dijitInputField {line-height: 15px !important; padding: 0 0 0 !important;}.edit-app-info-content .dijitTextBox .dijitInputInner{height: 23px;}.edit-app-info-content .app-name .name-text-box{width: 95%; padding: 2px;}.edit-app-info-content .app-description .desc-text-area{width: 95%; max-width: 95%; min-width: 95%; height: 200px; max-height: 200px; min-height: 200px; padding: 2px; resize: none;}.dj_ie8 .app-list-page .app-content .list-section-head,.dj_ie8 .app-list-page .app-content .list-section-body-content{filter: progid:dXImageTransform.Microsoft.DropShadow(color\x3d#a0acbf,offX\x3d1,offY\x3d1,positives\x3dtrue); -ms-filter: "progid:dXImageTransform.Microsoft.DropShadow(color\x3d#a0acbf,offX\x3d1,offY\x3d1,positives\x3dtrue)";}.app-catalog-page {width: 100%; height: 100%; position: relative; overflow: hidden; background-color: #f8f9fb;}.app-catalog-page .app-content {position: relative; max-width: 1300px; min-width: 1024px; margin: 0 auto; height: 100%; min-height: 340px; padding-top: 20px; padding-left: 20px; padding-right: 20px;}.app-catalog-page .app-content .list-table {table-layout: fixed; border-spacing: 0; width: 100%;}.app-catalogs.list-table-item {}.item-td {}.app-catalog-page .app-catalogs .catalog {background-color: #fff; height: 120px; width: 100%; margin: 0 auto 10px; -moz-box-shadow: 0 0 12px rgba(0, 0, 0, .1); -webkit-box-shadow: 0 0 12px rgba(0, 0, 0, .1); box-shadow: 0 0 12px rgba(0, 0, 0, .1);}.app-catalog-page .app-catalogs .catalog .content-theme {height: 100%; width: 180px; position: relative;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-color {width: 4px; position: absolute; left: 0; height: 100%;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .content-theme .content-theme-color {right: 0;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-icon {position: absolute; top: 0px; left: 0px; width: 100%; height: 120px; background-size: 100% 100%; background-repeat: no-repeat; background-position: center; cursor: pointer;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-flagImg{position: absolute; width: 26px; height: 22px; bottom: 10px; left: 140px; background-position: center; background-repeat: repeat; display: block; z-index: 10;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-flagImg-2D{background-image: url("images/flag_2d.png");}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-flagImg-3D{background-image: url("images/flag_3d.png");}.jimu-rtl .app-catalog-page .app-catalogs .catalog .content-theme .content-theme-icon {left: auto; right: 0px;} .app-catalog-page .app-catalogs .catalog .content-opers {height: 100%; width: 198px; position: relative;}.app-catalog-page .app-catalogs .catalog .content-opers:before {background-color: #e5e5e5; content: ""; position: absolute; top: 20px; width: 1px; height: 80px;}.app-catalog-page .app-catalogs .catalog .content-opers-btns {margin: 44px 0 44px 20px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .content-opers-btns {margin-left: 0; margin-right: 10px;}.app-catalog-page .app-catalogs .catalog .content-opers-btn {display: inline-block; position: relative; width: 32px; height: 32px; border: 2px solid #999; -moz-border-radius: 16px; -webkit-border-radius: 16px; border-radius: 16px; margin-right: 10px;}.app-catalog-page .app-catalogs .catalog .content-opers-btn:hover {cursor: pointer; border: 2px solid #333;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-download {background: url("images/download.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-download:hover {background: url("images/download_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-edit {background: url("images/edit.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-edit:hover {background: url("images/edit_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-launch {background: url("images/view.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-launch:hover {background: url("images/view_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-more {background: url("images/more.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-more:hover {background: url("images/more_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-more.content-opers-btns-more-selected {border: 2px solid #0f95bc; background: url("images/more_selected.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content {margin: 20px 20px 20px 30px;}.catalog-content {padding: 20px 20px 20px 200px;}.jimu-rtl .catalog-content {padding-right: 180px; padding-left: 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head {}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appname {left: 0px; font-family: "Avenir Medium"; font-size: 14px; color: #333; display: inline-block; max-width: 550px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appname {padding-right: 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo {padding-right: 20px; font-size: 12px; display: inline-block;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo {padding-right: 0; padding-left: 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-time {font-family: "Avenir Light"; color: #999; padding-top: 1px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner {font-family: "Avenir Light"; color: #999; position: relative; padding: 0 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner:before {background-color: #e5e5e5; content: ""; position: absolute; top: 5px; left: 10px; width: 1px; height: 10px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner:before {content: ""; left: 0; right: 10px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner-tip {font-family: "Avenir Light"; color: #999; line-height: 18px; display: inline-block; vertical-align: top; padding-right: 6px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner-tip {padding-left: 6px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner-name{display: inline-block; max-width: 100px; padding-top: 1px; height: 18px; line-height: 18px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-type {font-family: "Avenir Medium"; color: #31a6e0;}.app-catalog-page .app-catalogs .catalog .catalog-content-dis {padding: 10px 20px 0 0; font-family: "Avenir Light"; font-size: 14px; color: #333; word-wrap: break-word; word-break: break-all; overflow: hidden; height: 70px;}.app-catalog-page .app-catalogs .catalog .catalog-content-dis.place-holder-class {color: #cccccc;}.app-catalog-page .app-menu {position: absolute; background-color: #354052; width: 160px; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; z-index: 1; border-radius: 5px;}.app-catalog-page .app-menu .item {width: 100%; min-height: 30px; padding-left: 20px; border: 0px solid; color: #a0acbf; font-size: 14px; cursor: pointer; padding-top: 12px; padding-bottom: 12px;}.jimu-rtl .app-catalog-page .app-menu .item {padding-right: 20px; padding-left: 0px;}.app-catalog-page .app-menu .item.border-top-radius {border-top-left-radius: 5px; border-top-right-radius: 5px;}.app-catalog-page .app-menu .item.border-bottom-radius {border-bottom-left-radius: 5px; border-bottom-right-radius: 5px;}.app-catalog-page .app-menu .item a {text-decoration: none; color: inherit;}.app-catalog-page .app-menu .up-triangle {position: absolute; width: 18px; height: 11px; top: -10px; right: 20px; background: url("images/up_triangle.png");}.jimu-rtl .app-catalog-page .app-menu .up-triangle {left: 20px; right: auto;}.app-catalog-page .app-menu .down-triangle {position: absolute; width: 18px; height: 11px; right: 20px; background: url("images/down_triangle.png"); display: none; background-repeat: no-repeat;}.jimu-rtl .app-catalog-page .app-menu .down-triangle {left: 20px; right: auto;}.app-catalog-page .app-menu .item:hover {background-color: #6f7e95; color: #ffffff;}.app-card-page {position: relative; overflow: hidden;}.app-card-page .app-card-page-content {max-width: 1300px; min-width: 1024px; margin: 20px auto 0; overflow: hidden; padding-left: 20px; min-height: 340px;}.app-card-page .app-card-box {position: relative; width: 300px; height: 170px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.app-card-page .app-card-box .card {height: 100%; width: 100%;}.app-card-page .app-card-box .app-info-card {}.app-card-page .app-card-box .app-info-card .app-style-part {width: 100%; height: 4px;}.app-card-page .app-card-box .app-info-card .app-title-part {position: relative; width: 100%; height: 125px;}.app-card-page .app-card-box .app-info-card .app-title-part .app-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 20px; top: 5px; right: 5px;}.jimu-rtl .app-card-page .app-card-box .app-info-card .app-title-part .app-type-div {right: auto; left: 5px;}.app-card-page .app-card-box .app-info-card .app-title-part .app-type-2d {background-image: url("images/flag_2d.png");}.app-card-page .app-card-box .app-info-card .app-title-part .app-type-3d {background-image: url("images/flag_3d.png");}.app-card-page .app-card-box .app-info-card .app-title-part .app-title-table {width: 100%; height: 100%;}.app-card-page .app-card-box .app-info-card .app-title-part .app-icon-td {width: 110px; height: 100%;}.app-card-page .app-card-box .app-info-card .app-title-part .app-icon {width: 80px; height: 80px; border: 2px solid #e5e5e5; border-radius: 10px; display: block; background-repeat: no-repeat; background-position: center; margin-left: 20px; background-size: 100% 100%;}.app-card-page .app-card-box .app-info-card .app-title-part .app-icon.default-icon {background-size: 50px 50px;}.app-card-page .app-card-box .app-info-card .app-title-part .app-title-div {line-height: 20px; max-height: 38px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-right: 10px; font-family: "Avenir Medium"; font-size: 16px; color: #333333; font-weight: bold;}.app-card-page .app-card-box .app-info-card .app-title-part .app-time-div {margin-top: 20px; color: #999999; font-size: 12px; line-height: 12px;}.app-card-page .app-card-box .app-des-card {position: absolute; width: 100%; height: 125px; top: 4px; left: 0; display: block; opacity: 0;}.app-card-page .app-card-box .app-des-card .app-des-part {width: 100%; height: 100%;}.app-card-page .app-card-box .app-des-card .app-des-part .app-name{width: 100%; height: 75px;}.app-card-page .app-card-box .app-des-card .app-des-part .app-name-div{max-height: 48px; line-height: 16px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; font-size: 14px; color: #333333; font-family: "Avenir Medium"; font-weight: bold;}.app-card-page .app-card-box .app-des-card .app-des-part .app-info-div{padding-left: 20px; padding-right: 20px; color: #999999; font-size: 12px; line-height: 13px; margin-top: 10px; overflow: hidden;}.app-card-page .app-card-box .app-des-card .app-des-part .app-des{width: 100%; height: 50px; overflow: hidden; line-height: 16px; font-size: 12px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px;}.app-card-page .app-card-box .app-operation-part {position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .app-card-page .app-card-box .app-operation-part {right: 10px; left: auto;}.app-card-page .app-card-box .app-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.app-card-page .app-card-box .download-operation {height: 40px; width: 40px; background-image: url("images/download.png");}.app-card-page .app-card-box .download-operation:hover {background-image: url("images/download_hover.png");}.app-card-page .app-card-box .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.app-card-page .app-card-box .edit-operation:hover {background-image: url("images/edit_hover.png");}.app-card-page .app-card-box .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.app-card-page .app-card-box .launch-operation:hover {background-image: url("images/view_hover.png");}.app-card-page .app-card-box .app-operation a{display: inline-block; width: 100%; height: 100%;}.app-card-page .app-card-box .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.app-card-page .app-card-box .more-operation:hover {background-image: url("images/more_hover.png");}.app-card-page .app-card-box .more-operation.item-more-selected {background-image: url("images/more_selected.png");}.template-card-page {position: relative; overflow: hidden;}.template-card-page .template-card-page-content {max-width: 1300px; min-width: 1024px; margin: 20px auto 0; overflow: hidden; padding-left: 20px; min-height: 340px;}.template-card-page .template-card {position: relative; width: 300px; height: 320px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.template-card-page .template-card .template-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 20px; top: 5px; right: 5px;}.jimu-rtl .template-card-page .template-card .template-type-div {right: auto; left: 5px;}.template-card-page .template-card .template-type-2d {background-image: url("images/flag_2d.png");}.template-card-page .template-card .template-type-3d {background-image: url("images/flag_3d.png");}.template-card-page .template-card .thumbnail-part {width: 100%; height: 180px; background-repeat: no-repeat; background-position: center;}.template-card-page .template-card .appInfo-part {width: 100%; height: 99px;}.template-card-page .template-card .appInfo-part .template-name {width: 100%; height: 40px;}.template-card-page .template-card .appInfo-part .template-name-div {max-height: 40px; line-height: 20px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; font-size: 18px; color: #333333; font-family: "Avenir Medium"; font-weight: bold;}.template-card-page .template-card .appInfo-part .template-des-div {width: 100%; height: 57px; overflow: hidden; line-height: 18px; font-size: 14px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px;}.template-card-page .template-card .template-operation-part {position: relative; position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .template-card-page .template-card .template-operation-part {right: 10px; left: auto;}.template-card-page .template-card .template-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.template-card-page .template-card .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.template-card-page .template-card .launch-operation:hover {background-image: url("images/view_hover.png");}.template-card-page .template-card .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.template-card-page .template-card .edit-operation:hover {background-image: url("images/edit_hover.png");}.template-card-page .template-card .edit-operation.disable {display: none;}.template-card-page .template-card .template-operation a{display: inline-block; width: 100%; height: 100%;}.template-card-page .template-card .create-app-from-template-operation{height: 40px; width: 40px; background-image: url("images/add.png");}.template-card-page .template-card .create-app-from-template-operation:hover {background-image: url("images/add_hover.png");}.template-card-page .template-card .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.template-card-page .template-card .more-operation:hover {background-image: url("images/more_hover.png");}.template-card-page .template-card .more-operation.item-more-selected{background-image: url("images/more_selected.png");}.template-card-page .template-card .more-operation.disable {display: none;}.card-page {position: relative; overflow: hidden;}.card-page .card-page-content {max-width: 1300px; min-width: 1024px; margin: 0px auto 0; padding-top: 20px; overflow: hidden; padding-left: 20px; min-height: 340px;}.card-page .item-card {position: relative; width: 300px; height: 350px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.card-page .item-card .item-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 22px; bottom: 10px; right: 5px;}.jimu-rtl .card-page .item-card .item-type-div {right: auto; left: 5px;}.card-page .item-card .item-type-2d {background-image: url("images/flag_2d.png");}.card-page .item-card .item-type-3d {background-image: url("images/flag_3d.png");}.card-page .item-card .thumbnail-part {position: relative; display: inline-block; width: 100%; height: 200px; background-repeat: no-repeat; background-position: center; background-size: 100% 100%;}.card-page .item-card .appInfo-part {width: 100%; height: 109px; overflow: hidden;}.card-page .item-card .appInfo-part .item-name {width: 100%; height: 60px;}.card-page .item-card .appInfo-part .item-name-div {max-height: 39px; line-height: 20px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; font-size: 14px; color: #333333; font-family: "Avenir Medium"; font-weight: bold; margin-top: 9px;}.card-page .item-card .appInfo-part .item-info-div {padding-left: 20px; padding-right: 20px; color: #999999; font-size: 12px; line-height: 13px; margin-top: 12px; margin-bottom: 9px; overflow: hidden;}.card-page .item-card .appInfo-part .item-des-div {width: 100%; overflow: hidden; line-height: 22px; font-size: 12px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px;}.card-page .item-card .appInfo-part .item-des-div.place-holder-class {color: #cccccc;}.card-page .item-card .item-operation-part {position: relative; position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .card-page .item-card .item-operation-part {right: 10px; left: auto;}.card-page .item-card .item-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.card-page .item-card .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.card-page .item-card .launch-operation:hover {background-image: url("images/view_hover.png");}.card-page .item-card .download-operation {height: 40px; width: 40px; background-image: url("images/download.png");}.card-page .item-card .download-operation:hover {background-image: url("images/download_hover.png");}.card-page .item-card .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.card-page .item-card .edit-operation:hover {background-image: url("images/edit_hover.png");}.card-page .item-card .edit-operation.disable {display: none;}.card-page .item-card .item-operation a{display: inline-block; width: 100%; height: 100%;}.card-page .item-card .create-app-from-item-operation{height: 40px; width: 40px; background-image: url("images/add.png");}.card-page .item-card .create-app-from-item-operation:hover {background-image: url("images/add_hover.png");}.card-page .item-card .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.card-page .item-card .more-operation:hover {background-image: url("images/more_hover.png");}.card-page .item-card .more-operation.item-more-selected{background-image: url("images/more_selected.png");}.card-page .item-card .more-operation.disable {display: none;}.card-page-with-small-thumbnail {position: relative; overflow: hidden;}.card-page-with-small-thumbnail .app-card-page-content {max-width: 1300px; min-width: 1024px; margin: 0 auto 0; overflow: hidden; padding-left: 20px; padding-top: 20px; min-height: 340px;}.card-page-with-small-thumbnail .app-card-box {position: relative; width: 300px; height: 220px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.card-page-with-small-thumbnail .app-card-box .card {height: 100%; width: 100%;}.card-page-with-small-thumbnail .app-card-box .app-info-card {}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part {position: relative; width: 100%; height: 120px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 20px; top: 5px; right: 5px;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-div {right: auto; left: 5px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-2d {background-image: url("images/flag_2d.png");}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-3d {background-image: url("images/flag_3d.png");}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-title-table {width: 100%; height: 100%;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-thumbnail-td {width: 155px; height: 100%;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-thumbnail {width: 120px; height: 80px; border-radius: 4px; display: block; background-repeat: no-repeat; background-position: center; margin-left: 20px; background-size: 100% 100%;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-thumbnail {margin-left: auto; margin-right: 20px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-title-td {display: inline-block;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-title-div {line-height: 16px; max-height: 32px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-right: 10px; font-family: "Avenir Medium"; font-size: 14px; color: #333333; font-weight: bold; margin-top: 25px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-time-div {color: #999999; font-size: 12px; line-height: 12px; margin-top: 14px; margin-bottom: 10px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-creator-div {color: #999999; font-size: 12px; line-height: 12px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-box {position: relative; width: 100%; height: 59px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-part {width: 100%; height: 42px; overflow: hidden; line-height: 18px; font-size: 12px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; padding-top: 5px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-part.place-holder-class {color: #cccccc;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-part {}.card-page-with-small-thumbnail .app-card-box .app-operation-part {position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-operation-part {right: 10px; left: auto;}.card-page-with-small-thumbnail .app-card-box .app-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.card-page-with-small-thumbnail .app-card-box .app-operation.disable {display: none;}.card-page-with-small-thumbnail .app-card-box .download-operation {height: 40px; width: 40px; background-image: url("images/download.png");}.card-page-with-small-thumbnail .app-card-box .download-operation:hover {background-image: url("images/download_hover.png");}.card-page-with-small-thumbnail .app-card-box .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.card-page-with-small-thumbnail .app-card-box .edit-operation:hover {background-image: url("images/edit_hover.png");}.card-page-with-small-thumbnail .app-card-box .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.card-page-with-small-thumbnail .app-card-box .launch-operation:hover {background-image: url("images/view_hover.png");}.card-page-with-small-thumbnail .app-card-box .app-operation a{display: inline-block; width: 100%; height: 100%;}.card-page-with-small-thumbnail .app-card-box .create-app-from-item-operation{height: 40px; width: 40px; background-image: url("images/add.png");}.card-page-with-small-thumbnail .app-card-box .create-app-from-item-operation:hover {background-image: url("images/add_hover.png");}.card-page-with-small-thumbnail .app-card-box .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.card-page-with-small-thumbnail .app-card-box .more-operation:hover {background-image: url("images/more_hover.png");}.card-page-with-small-thumbnail .app-card-box .more-operation.item-more-selected {background-image: url("images/more_selected.png");}body{background-color: white;}#main-view-stack{position: absolute; top: 40px; bottom: 0; left: 0; right: 0; height: auto; overflow: hidden; background-color: #E3ECF2;}.plugin-app-list {position: relative; background-color: #f8f9fb;}.plugin-app-list .header {width: 100%; background-color: #ffffff;}.plugin-app-list .header .navigator-box{width: 100%; height: 50px; border-bottom: 1px solid #e5e5e5;}.plugin-app-list .header .navigator{position: relative; min-width: 1024px; max-width: 1300px; padding-left: 20px; padding-right: 20px; height: 50px; margin: 0 auto;}.plugin-app-list .header .navigator .filter-box{}.plugin-app-list .header .navigator .filter{margin-right:10px; height: 50px; line-height: 50px; color: #999999; font-size: 14px; min-width: 40px; text-align: center;}.jimu-rtl .plugin-app-list .header .navigator .filter{margin-left: 10px; margin-right: auto;}.plugin-app-list .header .navigator .filter.selected{color: #d84b28; border-bottom: 2px solid #d84b28;}.plugin-app-list .header .navigator .filter:hover{color: #d84b28; cursor: pointer; border-bottom: 2px solid #d84b28;}.plugin-app-list .header .navigator .sort-box{padding-left: 20px; padding-right: 20px;}.plugin-app-list .header .navigator .sort {margin-right: 15px; height: 50px; width: 16px; background-repeat: no-repeat; background-position: center; cursor: pointer;}.plugin-app-list .header .navigator .sort-box .by-modified-time {background-image: url(images/most_recent.png);}.plugin-app-list .header .navigator .sort.by-modified-time.selected{background-image: url(images/most_recent_selected.png);}.plugin-app-list .header .navigator .sort.by-modified-time:hover{background-image: url(images/most_recent_hover.png);}.plugin-app-list .header .navigator .sort-box .by-name {background-image: url(images/by_name.png);}.plugin-app-list .header .navigator .sort.by-name.selected{background-image: url(images/by_name_selected.png);}.plugin-app-list .header .navigator .sort.by-name:hover{background-image: url(images/by_name_hover.png);}.plugin-app-list .header .navigator .sort-box .by-author {background-image: url(images/by_author.png);}.plugin-app-list .header .navigator .sort.by-author.selected{background-image: url(images/by_author_selected.png);}.plugin-app-list .header .navigator .sort.by-author:hover{background-image: url(images/by_author_hover.png);}.plugin-app-list .header .navigator .search{width: 300px; border: 1px solid #e5e5e5; border-radius: 15px; margin-top: 10px; padding-left: 5px;}.plugin-app-list .header .navigator .search .search-box{height: 30px; width: 250px; border: 0 solid; border-radius: 25px;}.plugin-app-list .header .navigator .search .search-box.dijitText{border-color: #ffffff !important; box-shadow: 0 0 0 #ffffff !important; background-image: none;}.plugin-app-list .header .navigator .search .search-box.dijitTextBoxFocused {border-color: #ffffff !important; box-shadow: 0 0 0 #ffffff !important; background-image: none;}.plugin-app-list .header .navigator .search .search-box.dijitTextBoxHover{background-color: #ffffff !important; border-color: #ffffff !important; background-image: none;}.plugin-app-list .header .navigator .search .search-box .dijitInputContainer {margin: 1px 5px;}.plugin-app-list .header .navigator .search .search-box .dijitInputInner{box-shadow: 0px 0px 0px #FFF !important;}.plugin-app-list .header .navigator .search .search-box .dijitPlaceHolder{font-style: normal;}.plugin-app-list .header .navigator .search .search-btn{width: 40px; height: 30px; background-image: url(images/search.png); background-repeat: no-repeat; background-position: center center;}.plugin-app-list .switch-app-page-box {position: absolute; right: 20px; bottom: 20px; z-index: 1;}.jimu-rtl .plugin-app-list .switch-app-page-box {left: 20px; right: auto;}.plugin-app-list .switch-app-page-box.hidden {display: none;}.plugin-app-list .switch-app-page-box .switch-app-page-btn {width: 21px; height: 21px; background-repeat: no-repeat; background-position: center center; cursor: pointer;}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page {background-image: url(images/card.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page.selected {background-image: url(images/card_selected.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page:hover {background-image: url(images/card_hover.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.catalog-page {background-image: url(images/catalog.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.catalog-page.selected {background-image: url(images/catalog_selected.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.catalog-page:hover {background-image: url(images/catalog_hover.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page2 {background-image: url(images/card.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page2.selected {background-image: url(images/card_selected.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page2:hover {background-image: url(images/card_hover.png);}.plugin-app-list .operation-box{position: relative; min-width: 1024px; max-width: 1300px; margin: 0 auto; height: 60px; padding-left: 20px; padding-right: 20px; padding-top: 20px;}.plugin-app-list .create{width: 150px; height: 40px; line-height: 40px; background-color: #31aacd; color: #ffffff; font-size: 14px; font-weight: bold; border-radius: 2px; cursor: pointer; text-align: center; margin-right: 20px;}.plugin-app-list .create:hover{background-color: #1b91b3;}.jimu-rtl .plugin-app-list .create{margin-left: 20px; margin-right: auto;}.plugin-app-list .content-box {position: absolute; left: 0; right: 0; top: 50px; bottom: 0; overflow: auto;}.plugin-app-list .content {display: none; min-height: 540px;}.plugin-app-list .content.selected{display: block;}.plugin-app-list .content .app-page-box {height: 100%; display: none;}.plugin-app-list .content .app-page-box.selected {display: block;}.plugin-app-list .footer {color: #999999; font-size: 12px; overflow: hidden; text-align: center;}.plugin-app-list .footer .footer-text {padding-left: 20px; padding-right: 20px; margin: 120px auto 30px; text-align: center; display: inline-block;}.plugin-app-list .footer .separator {margin-left: 5px; margin-right: 5px; font-weight: bold;}.plugin-app-list .footer a {text-decoration: none; color: #999999;}.plugin-app-list .empty-description-box {text-align: center; margin-top: 210px;}.plugin-app-list .empty-description-box.card-page{padding-right: 20px;}.plugin-app-list .empty-description {display: inline-block; text-align: left; color: #999999; font-size: 16px; font-family: "Avenir Medium"; line-height: 26px;}.plugin-app-list .empty-description span{color: #000000;}.fullscreen-popup-container .content .image-chooser-container{width: 150px; margin: 0 auto; padding: 30px 0; text-align: center; position: relative;}.fullscreen-popup-container .content .image-chooser-container.imageChooserTemplate{width: 300px;}.fullscreen-popup-container .content .image-chooser-container .image-chooser-masker{position: absolute; display: none; background-color: rgba(0,0,0,.8); text-align: center; font-size: 14px; color: #fff; z-index: 9999; cursor:pointer;}.fullscreen-popup-container .content .image-chooser-container.imageChooserApp .image-chooser-base{width: 150px; height: 150px; background-color: #31aacd; border-radius: 50%;}.fullscreen-popup-container .content .image-chooser-container.imageChooserApp .jimu-image-chooser{width: 80px; height: 80px; background-color: #f7fafa; border-radius: 10px; margin-top: 35px;}.fullscreen-popup-container .content .image-chooser-container .image-chooser-masker.imageChooserApp{width: 150px; height: 150px; border-radius: 50%; line-height: 150px;}.fullscreen-popup-container .content .image-chooser-container.imageChooserTemplate .image-chooser-base{width: 330px; height: 230px; border: 1px solid #ccc; border-radius: 4px; background-size: 100% 100%; padding: 10px; background-color: #fff;}.fullscreen-popup-container .content .image-chooser-container.imageChooserTemplate .jimu-image-chooser{width: 100%; height: 100%;}.fullscreen-popup-container .content .image-chooser-container .image-chooser-masker.imageChooserTemplate{width: 330px; height: 230px; line-height: 210px; border-radius: 5px;}.fullscreen-popup-container .content .app-info-edit label{display: block; font-size: 14px; color:#333;}.fullscreen-popup-container .content .app-info-edit .app-info-edit-name{height:40px; line-height: 40px; width: 100%; margin: 15px 0 30px 0;}.fullscreen-popup-container .content .app-info-edit .app-info-edit-summary{height:100px; width: 100%; margin: 15px 0 30px 0; padding: 5px 10px; font-size: 12px; font-family: "Avenir Light";}.jimu-popup.jimu-popup-in-home .jimu-btn{background-color: #31aacd;}.jimu-popup.jimu-popup-in-home .jimu-btn:hover{background-color: #1b91b3;}.jimu-popup.jimu-popup-in-home .jimu-btn.jimu-btn-vacation{background-color: #FFFFFF; border: 1px solid #31aacd; color: #31aacd;}.jimu-popup.jimu-popup-in-home .jimu-btn.jimu-btn-vacation:hover{background-color: #f4f4f4;}',
"url:builder/plugins/attribute-config/Plugin.html":'\x3cdiv class\x3d"attribute-config" data-dojo-attach-event\x3d"onmouseleave:onMouseLeaveAttributeConfig"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"attributeSection"\x3e\r\n    \x3cdiv class\x3d"section jimu-float-leading header-section" data-dojo-attach-point\x3d"headerSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.headerTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e${nls.headerDesc}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-float-leading jimu-trailing-margin1 logo-container no-logo" data-dojo-attach-point\x3d"logoContainer" data-dojo-attach-event\x3d"onmouseenter:onLogoContainerMouseEnter"\x3e\r\n        \x3cdiv data-dojo-type\x3d"jimu/dijit/ImageChooser" data-dojo-attach-point\x3d"imageChooser" data-dojo-props\x3d"cropImage:false,showSelfImg:true,goldenWidth:30,goldenHeight:30,format:[\'image/gif\',\'image/png\',\'image/jpeg\']"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"add-logo"  data-dojo-attach-point\x3d"addLogoNode"\x3e\r\n          \x3cdiv class\x3d"image"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"remove-logo" title\x3d"${nls.removeLogo}" data-dojo-attach-point\x3d"removeLogoNode"data-dojo-attach-event\x3d"onclick:onRemoveLogo"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"change-logo" title\x3d"${nls.changeLogo}" data-dojo-attach-point\x3d"changeLogoNode"data-dojo-attach-event\x3d"onclick:onChangeLogo"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"titles jimu-float-leading"\x3e\r\n        \x3cdiv style\x3d"background-color:#fafafc;" class\x3d"title"\x3e\r\n          \x3cinput  placeholder\x3d"${nls.title}" data-dojo-attach-point\x3d"titleNode" maxLength\x3d"100"\x3e\r\n          \x3cspan class\x3d"label-editor" title\x3d"${nls.formatStyle}" data-dojo-attach-event\x3d"click:onTitleEditorClick"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"background-color:#fafafc;" class\x3d"subtitle"\x3e\r\n          \x3cinput  placeholder\x3d"${nls.subtitle}" data-dojo-attach-point\x3d"subtitleNode" maxLength\x3d"100"\x3e\r\n          \x3cspan class\x3d"label-editor"  title\x3d"${nls.formatStyle}" data-dojo-attach-event\x3d"click:onSubtitleEditorClick"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading links-section" data-dojo-attach-point\x3d"linksSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.linksTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv class\x3d"attribute-content"\x3e\r\n        \x3cdiv class\x3d"list-header"\x3e\r\n          \x3cspan class\x3d"header-button add" data-dojo-attach-event\x3d"onclick: onAddLinkClick"\x3e${nls.addLink}\x3c/span\x3e\r\n          \x3cspan class\x3d"header-button edit" data-dojo-attach-event\x3d"onclick: onEditLinkClick"\x3e${nls.editLabel}\x3c/span\x3e\r\n          \x3cspan class\x3d"header-button delete" data-dojo-attach-event\x3d"onclick: onDeleteLinkClick"\x3e${nls.deleteLabel}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"links-list" data-dojo-attach-point\x3d"linksListNode"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      --\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading appId-section" data-dojo-attach-point\x3d"appIdSection" style\x3d"display:none"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.appIdTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3ca target\x3d"_blank" href\x3d"http://doc.arcgis.com/en/arcgis-online/share-maps/add-items.htm#ESRI_SECTION2_20AF85308FD548B5ADBAE28836F66D3F"\x3e${nls.appIdAbout}\x3c/a\x3e\r\n      \x3cdiv class\x3d"attribute-content"\x3e\r\n        \x3cinput type\x3d"text" placeholder\x3d"AppId" data-dojo-attach-point\x3d"appIdNode" /\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading" data-dojo-attach-point\x3d"useProxySection" style\x3d"display:none"\x3e\r\n      \x3cdiv class\x3d"proxy-setting" data-dojo-attach-point\x3d"useProxySetting"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"proxy-section" data-dojo-attach-point\x3d"proxySection"\x3e\r\n        \x3clabel class\x3d"rules-label"\x3e${nls.proxyRulesLabel}\x3c/label\x3e\r\n        \x3cdiv class\x3d"attribute-content"\x3e\r\n          \x3cdiv class\x3d"list-header"\x3e\r\n            \x3cspan class\x3d"header-button add" data-dojo-attach-event\x3d"onclick: onAddProxyRuleClick"\x3e${nls.addProxyRule}\x3c/span\x3e\r\n            \x3cspan class\x3d"header-button edit" data-dojo-attach-event\x3d"onclick: onEditProxyRuleClick"\x3e${nls.editLabel}\x3c/span\x3e\r\n            \x3cspan class\x3d"header-button delete" data-dojo-attach-event\x3d"onclick: onDeleteProxyRuleClick"\x3e${nls.deleteLabel}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"proxy-rule-header"\x3e\r\n            \x3cdiv class\x3d"prefix"\x3e${nls.prefixHeader}\x3c/div\x3e\r\n            \x3cdiv class\x3d"proxy-url"\x3e${nls.proxyUrlHeader}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"proxy-rule-list" data-dojo-attach-point\x3d"proxyRulesListNode"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"always-use-proxy" data-dojo-attach-point\x3d"alwaysUseProxy"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"attribute-content" data-dojo-attach-point\x3d"proxyUrlSection" \x3e\r\n          \x3cinput type\x3d"text" placeholder\x3d"${nls.proxyUrl}" data-dojo-attach-point\x3d"proxyUrlNode" /\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading section-appstate"\r\n         data-dojo-attach-point\x3d"appStateController"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.appState}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e\r\n        \x3cdiv class\x3d"appstate-check" data-dojo-attach-point\x3d"appStateSetting"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading controller-loading"\r\n         data-dojo-attach-point\x3d"loadingPageController"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.loadingPageTitle}\x3c/span\x3e\r\n        \x3cdiv class\x3d"action-arrow jimu-float-trailing"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e${nls.setLoadingPage}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading controller-appproxy"\r\n         data-dojo-attach-point\x3d"appProxyController"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.appProxy}\x3c/span\x3e\r\n        \x3cdiv class\x3d"action-arrow jimu-float-trailing"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e${nls.configureAppProxy}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"jimu-float-leading loadingpage-section"\r\n       data-dojo-attach-point\x3d"loadingPageSection" style\x3d"display:none"\x3e\r\n    \x3cdiv class\x3d"attribute-link"\x3e\r\n      \x3cdiv class\x3d"action-arrow jimu-float-leading" data-dojo-attach-point\x3d"backController"\x3e\x3c/div\x3e\r\n      \x3cspan\x3e${nls.loadingPageTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-part"\x3e\r\n      \x3cdiv\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.backgroudColor}\x3c/span\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"bgColorPicker"\r\n             data-dojo-type\x3d"jimu/dijit/ColorPicker" title\x3d"${nls.selectBackgoundColor}"\r\n             class\x3d"bgColor-control" class\x3d"jimu-float-trailing"\r\n             data-dojo-props\x3d"showLabel:true"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-part"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"bgCheckBoxDiv"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"bgUploaderDiv" class\x3d"jimu-leading-margin2"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"bgImageChooser"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-part"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"gifCheckBoxDiv"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"gifModeSection" class\x3d"jimu-leading-margin2" style\x3d"margin-top:10px;"\x3e\r\n        \x3cinput name\x3d"gifMode" type\x3d"radio" data-dojo-attach-point\x3d"selectMode"\r\n            data-dojo-attach-event\x3d"onclick: _onSelectGifMode"/\x3e\r\n        \x3clabel\x3e${nls.selectPredefinedGif}\x3c/label\x3e\x3cbr/\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"predefinedGif" class\x3d"jimu-leading-margin2" style\x3d"display:none;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"gifSelect" style\x3d"margin-top:10px;"\r\n                  data-dojo-type\x3d"dijit/form/Select"\x3e\r\n            \x3cspan value\x3d"0"\x3e${nls.selectGif}\x3c/span\x3e\r\n            \x3cspan value\x3d"1"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"58" height\x3d"29" style\x3d"margin-top:2px;" src\x3d"${folderUrl}images/loading1.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan value\x3d"2"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"58" height\x3d"10" style\x3d"margin-top:12px;" src\x3d"${folderUrl}images/loading2.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan value\x3d"3"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"32" height\x3d"32" src\x3d"${folderUrl}images/loading3.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan value\x3d"4"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"34" height\x3d"34" src\x3d"${folderUrl}images/loading4.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cinput name\x3d"gifMode" type\x3d"radio" data-dojo-attach-point\x3d"uploadMode"\r\n            data-dojo-attach-event\x3d"onclick: _onUploadGifMode"\r\n            style\x3d"margin-top:10px;"/\x3e\r\n        \x3clabel\x3e${nls.uploadCustomGif}\x3c/label\x3e\x3cbr/\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"customGif" class\x3d"jimu-leading-margin2" style\x3d"display:none;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"gifImageChooser"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"jimu-float-leading appproxy-section"\r\n       data-dojo-attach-point\x3d"appProxySection" style\x3d"display:none"\x3e\r\n    \x3cdiv class\x3d"attribute-link"\x3e\r\n      \x3cdiv class\x3d"action-arrow jimu-float-leading" data-dojo-attach-point\x3d"backController2"\x3e\x3c/div\x3e\r\n      \x3cspan\x3e${nls.appProxy}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sub-section" data-dojo-attach-point\x3d"mapSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e${nls.mapLayers}\x3c/div\x3e\r\n      \x3cdiv class\x3d"note"\x3e${nls.mapLayersNote}\x3c/div\x3e\r\n      \x3cdiv class\x3d"header"\x3e\r\n        \x3cdiv class\x3d"sepeartor"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"row"\x3e\r\n          \x3cdiv class\x3d"col col-layername"\x3e${nls.layerName}\x3c/div\x3e\r\n          \x3cdiv class\x3d"col col-credits"\x3e${nls.consumeCredits}\x3c/div\x3e\r\n          \x3cdiv class\x3d"col col-proxy"\x3e${nls.useProxy}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"sepeartor"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"mapProxyContent"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sub-section double-margin" data-dojo-attach-point\x3d"urlSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e${nls.customUrls}\x3c/div\x3e\r\n      \x3cdiv class\x3d"note"\x3e${nls.customUrlsNote}\x3c/div\x3e\r\n      \x3cdiv class\x3d"add-url-btn" data-dojo-attach-point\x3d"linkEditorNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sub-section double-margin"\x3e\r\n      \x3cdiv class\x3d"title"\x3e${nls.note}\x3c/div\x3e\r\n      \x3cdiv class\x3d"note-content"\x3e\r\n        ${nls.creditsNote}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"loadingNode" class\x3d"loading"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/LinkEditor.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"add-url-btn" data-dojo-attach-point\x3d"addLinkBtn"\x3e\r\n    \x3cdiv class\x3d"add-icon"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"text" data-dojo-attach-point\x3d"labelNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"link-list" data-dojo-attach-point\x3d"linkListNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/dijit/templates/LinkItemEditor.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"mask"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"contentNode"\x3e\r\n    \x3cdiv class\x3d"input-section"\x3e\r\n      \x3cdiv class\x3d"input" data-dojo-attach-point\x3d"titleNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"input" data-dojo-attach-point\x3d"urlNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"btn-section jimu-float-trailing"\x3e\r\n      \x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"okBtn"\x3e${nls.ok}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-btn jimu-btn-vacation" data-dojo-attach-point\x3d"cancelBtn"\x3e${nls.cancel}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TooltipDialog.html":'\x3cdiv role\x3d"alertdialog" tabIndex\x3d"-1"\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"contentsNode" class\x3d"dijitTooltipContents dijitTooltipFocusNode"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\t\t\t${!actionBarTemplate}\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipConnector" role\x3d"presentation" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dojox/widget/ColorPicker/ColorPicker.html":'\x3ctable class\x3d"dojoxColorPicker" dojoAttachEvent\x3d"onkeypress: _handleKey" cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\x3ctr\x3e\r\n\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\x3cdiv class\x3d"dojoxColorPickerBox"\x3e\r\n\t\t\t\t\x3c!-- Forcing ABS in style attr due to dojo DND issue with not picking it up form the class. --\x3e\r\n\t\t\t\t\x3cimg title\x3d"${saturationPickerTitle}" alt\x3d"${saturationPickerTitle}" class\x3d"dojoxColorPickerPoint" src\x3d"${_pickerPointer}" tabIndex\x3d"0" dojoAttachPoint\x3d"cursorNode" style\x3d"position: absolute; top: 0px; left: 0px;"\x3e\r\n\t\t\t\t\x3cimg role\x3d"presentation" alt\x3d"" dojoAttachPoint\x3d"colorUnderlay" dojoAttachEvent\x3d"onclick: _setPoint, onmousedown: _stopDrag" class\x3d"dojoxColorPickerUnderlay" src\x3d"${_underlay}" ondragstart\x3d"return false"\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/td\x3e\r\n\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\x3cdiv class\x3d"dojoxHuePicker"\x3e\r\n\t\t\t\t\x3c!-- Forcing ABS in style attr due to dojo DND issue with not picking it up form the class. --\x3e\r\n\t\t\t\t\x3cimg dojoAttachPoint\x3d"hueCursorNode" tabIndex\x3d"0" class\x3d"dojoxHuePickerPoint" title\x3d"${huePickerTitle}" alt\x3d"${huePickerTitle}" src\x3d"${_huePickerPointer}" style\x3d"position: absolute; top: 0px; left: 0px;"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"dojoxHuePickerUnderlay" dojoAttachPoint\x3d"hueNode"\x3e\r\n\t\t\t\t    \x3cimg role\x3d"presentation" alt\x3d"" dojoAttachEvent\x3d"onclick: _setHuePoint, onmousedown: _stopDrag" src\x3d"${_hueUnderlay}"\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/td\x3e\r\n\t\t\x3ctd valign\x3d"top"\x3e\r\n\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerPreviewContainer"\x3e\r\n\t\t\t\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"previewNode" class\x3d"dojoxColorPickerPreview"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd valign\x3d"top"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"safePreviewNode" class\x3d"dojoxColorPickerWebSafePreview"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd valign\x3d"bottom"\x3e\r\n\t\t\t\t\t\t\x3ctable class\x3d"dojoxColorPickerOptional" cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dijitInline dojoxColorPickerRgb" dojoAttachPoint\x3d"rgbNode"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctable cellpadding\x3d"1" cellspacing\x3d"1" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_r"\x3e${redLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_r" dojoAttachPoint\x3d"Rval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_g"\x3e${greenLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_g" dojoAttachPoint\x3d"Gval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_b"\x3e${blueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_b" dojoAttachPoint\x3d"Bval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dijitInline dojoxColorPickerHsv" dojoAttachPoint\x3d"hsvNode"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctable cellpadding\x3d"1" cellspacing\x3d"1" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_h"\x3e${hueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_h" dojoAttachPoint\x3d"Hval"size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${degLabel}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_s"\x3e${saturationLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_s" dojoAttachPoint\x3d"Sval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${percentSign}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_v"\x3e${valueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_v" dojoAttachPoint\x3d"Vval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${percentSign}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dojoxColorPickerHex" dojoAttachPoint\x3d"hexNode" aria-live\x3d"polite"\x3e\t\r\n\t\t\t\t\t\t\t\t\t\t\x3clabel for\x3d"${_uId}_hex"\x3e\x26nbsp;${hexLabel}\x26nbsp;\x3c/label\x3e\x3cinput id\x3d"${_uId}_hex" dojoAttachPoint\x3d"hexCode, focusNode, valueNode" size\x3d"6" class\x3d"dojoxColorPickerHexCode" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/td\x3e\r\n\t\x3c/tr\x3e\r\n\x3c/table\x3e\r\n\r\n',
"url:dijit/form/templates/DropDownBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}"\r\n\trole\x3d"combobox"\r\n\taria-haspopup\x3d"true"\r\n\tdata-dojo-attach-point\x3d"_popupStateNode"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\r\n\t\tdata-dojo-attach-point\x3d"_buttonNode" role\x3d"presentation"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"button presentation" aria-hidden\x3d"true"\r\n\t\t\t${_buttonInputDisabled}\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' ${!nameAttrSetting} type\x3d"${type}" autocomplete\x3d"off"\r\n\t\t\tdata-dojo-attach-point\x3d"textbox,focusNode" role\x3d"textbox"\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:builder/plugins/attribute-config/css/style.css":'.attribute-config{overflow-x: hidden; overflow-y: auto; font-size: 14px;}.attribute-config .section{padding: 15px 30px;}.header-section input,.links-section input,.appId-section input,.proxy-section input{height: 30px; border: 1px solid #d2dae2; padding: 5px; margin: 0; font-size: 12px; color: #232323; width: 100%; background-color: #fafafc; font-family: "Avenir Light";}.header-section input:focus,.links-section input:focus,.appId-section input:focus,.proxy-section input:focus{border: 1px solid #15a4fa; background-color: white; color: black;} .attribute-config .header-section{border: 0 solid;}.attribute-config .header-section .header-title,.attribute-config .title{color: #596679; line-height: 1.0; display: inline-block; width: 100%;}.attribute-config .header-section .logo-container {position: relative; font-size: 10px; width: 82px; height: 82px; margin-top: 10px; cursor: pointer; background-color: #ececec;}.attribute-config .header-section .logo-container:hover{background-color: #dcdcdc;}.attribute-config .header-section .logo-container.logo{border: 1px solid #d2dae2;}.attribute-config .header-section .logo-container.no-logo{border: 1px dashed #d2dae2;}.attribute-config .header-section .logo-container .hide{display: none;}.attribute-config .header-section .logo-container .jimu-image-chooser{width: 100%;}.attribute-config .header-section .logo-container.no-logo .jimu-image-chooser{position: absolute !important; opacity: 0; -ms-filter: "Alpha(opacity\x3d0)"; filter: Alpha(opacity\x3d0);}.attribute-config .header-section .logo-container .jimu-image-chooser .hint .display-image {width: auto; height: auto;}.attribute-config .header-section .logo-container .add-logo{text-align: center; margin-top: 31px; cursor: pointer;}.attribute-config .header-section .logo-container .add-logo .image{margin: auto; margin-top: 10px; background: url(images/add_header.png) no-repeat center; width: 20px; height: 20px;}.attribute-config .header-section .logo-container .add-logo .text{font-size: 12px; color: #aaaaaa; text-align: center;}.attribute-config .header-section .logo-container .remove-logo,.attribute-config .header-section .logo-container .change-logo{display: none; position: absolute; width: 25px; height: 25px; right: 0px; z-index: 9999; cursor: pointer; background-color: rgba(0,0,0,.4); background-repeat: no-repeat; background-position: center;}.attribute-config .header-section .logo-container .remove-logo{top: 0px; background-image: url(images/remove_logo.png);}.attribute-config .header-section .logo-container .change-logo{bottom: 0px; background-image: url(images/change_logo.png);}.attribute-config .header-section .logo-container.logo:hover .remove-logo,.attribute-config .header-section .logo-container.logo:hover .change-logo {display: block;}.attribute-config .header-section .logo-container.logo .remove-logo:hover,.attribute-config .header-section .logo-container.logo .change-logo:hover{background-color: rgba(0,0,0,.6);}.attribute-config-plugin-logo-options.remove-logo{width: 25px; height: 25px; border-radius: 4px; background-repeat: no-repeat; background-position: center; background-image: url(images/remove_logo.png); z-index: 10000000; cursor: pointer; -ms-filter: "Alpha(opacity\x3d40)"; filter: Alpha(opacity\x3d40); background-color: rgb(0,0,0);}.attribute-config-plugin-logo-options.remove-logo:hover{-ms-filter: "Alpha(opacity\x3d60)"; filter: Alpha(opacity\x3d60); background-color: rgb(0,0,0);}.attribute-config .header-section .titles{font-size: 10px; margin-top: 10px; width: calc(100% - 82px - 1em);}.attribute-config .header-section .titles input{height: 36px; background-color: white;}.attribute-config .header-section .titles .title{width: 100%; position: relative;}.attribute-config .header-section\x3e.title{width: 100%; height: 20px; position: relative;}.attribute-config .header-section .subtitle{width: 100%; height: 32px; margin-top: 10px; position: relative;}.attribute-config .header-section .label-editor{position: absolute; width: 12px; height: 12px; background: url("./images/A.png") no-repeat center; top: 12px; right: 10px; cursor: pointer; background-color: white;}.attribute-config .header-section .label-editor:hover{background: url("./images/A_hover.png") no-repeat center; background-color: #fafafc;}.jimu-rtl .attribute-config .header-section .label-editor{right: auto; left: 1px;}.format-font-style .dijitEditorIFrameContainer{position: absolute; top: 36px; left: 1px; right: 1px; bottom: 3px;}.format-font-style .dijitToolbar .dijitTextBox{width: 180px !important;}.el .format-font-style .dijitToolbar .dijitTextBox{width: 150px !important;}.pt-pt .format-font-style .dijitToolbar .dijitTextBox{width: 160px !important;}.it .format-font-style .dijitToolbar .dijitTextBox{width: 160px !important;}.format-font-style .dijitToolbar{font-size: 12px;}.appId-section .attribute-content{margin-top: 10px;}.appId-section a{color: #7EC6F8; float: right; cursor: pointer;}.proxy-section{display: none;}.attribute-config .sub-title{padding: 15px 0 10px 0;}.links-section .attribute-content{width: 340px; padding-top: 15px;}.links-section, .proxy-section{color: #a0acbf;}.attribute-config .attribute-content .links-list,.attribute-config .attribute-content .proxy-rule-list{padding-top: 10px;}.attribute-config .attribute-content .list-item.selected-item,.attribute-config .attribute-content .list-item:hover{background-color: #e3ecf2;}.attribute-config .attribute-content .list-item.selected-item .mask,.attribute-config .attribute-content .list-item:hover .mask{background-color: #e3ecf2;}.attribute-config .attribute-content .list-item{overflow: hidden; border-top-style: none; border: 1px solid #d2dae2; border-bottom-color: #eef2f5;}.attribute-config .attribute-content .list-item+.list-item{border-top-style: none;}.attribute-config .attribute-content .list-item:last-child{border-bottom-color: #dad2de;}.attribute-config .attribute-content .list-item:first-child{border-top-color: #dad2de;}.attribute-config .attribute-content .list-item .mask{width: 100%; height: 30px; color: #a0acbf; font-size: 12px; line-height: 30px; padding-left: 10px; border-width: 1px; background-color: #fafafc;}.attribute-config .attribute-content .list-item .mask:first-child{font-size: 14px;}.attribute-config .attribute-content .list-item .first,.attribute-config .attribute-content .list-item .second{height: 30px;}.proxy-rule-header{width: 100%; height: 30px; line-height: 30px; background-color: #518dca; color: white; margin: 10px 0 -10px;}.proxy-rule-header div{float: left; border-style: none; padding-left: 10px;}.attribute-content .list-item .first,.proxy-rule-header .prefix{width: 110px;}.proxy-rule-header .proxy-url{width: 228px;}.attribute-content .list-item .second{width: 228px; border-left: 1px solid #eef2f5;}.attribute-config .attribute-content .list-item .first input{border-right-style: none;}.attribute-config .attribute-content .list-header{}.attribute-config .list-header .header-button{display: inline-block; padding: 0 15px 0px 19px; color: #a0acbf; cursor: default;}.attribute-config .list-header .header-button.add{color: #518dca; cursor: pointer; background: url(images/add_icon01.png) no-repeat left;}.attribute-config .list-header .header-button.add:hover{background: url(images/add_icon02.png) no-repeat left;}.attribute-config .list-header .header-button.edit{background: url(images/edit_icon01.png) no-repeat left;}.attribute-config .list-header .header-button.delete{background: url(images/delete_icon01.png) no-repeat left;}.attribute-config .list-header .highlight-button{color: #518dca; cursor: pointer;}.attribute-config .list-header .highlight-button.add{color: #518dca; background: url(images/add_icon02.png) no-repeat left;}.attribute-config .list-header .highlight-button.edit{background: url(images/edit_icon02.png) no-repeat left;}.attribute-config .list-header .highlight-button.delete{background: url(images/delete_icon02.png) no-repeat left;}.jimu-rtl .attribute-config .list-header .header-button,.jimu-rtl .attribute-config .list-header .highlight-button {background-position: right !important;}.attribute-config .section .always-use-proxy{color: #596679; cursor: pointer; display: inline-block; margin-top: 15px; margin-bottom: 6px;}.attribute-config .section .always-use-proxy .label{display: inline; float: none;}.proxy-section .rules-label{color: #596679; font-size: 12px; margin: 10px 0 12px 0; display: block; line-height: 12px;}.proxy-section .error-status{border: 1px solid #e84b4b; background-color: #fff;}.controller-loading,.controller-appproxy {cursor: pointer;}.controller-loading:hover,.controller-appproxy:hover {background: #F3F3F3;}.controller-loading:hover .title .action-arrow,.controller-appproxy:hover .title .action-arrow {background: url(images/arrow_right_hover.svg) no-repeat center;}.jimu-rtl .controller-loading:hover .title .action-arrow,.jimu-rtl .controller-appproxy:hover .title .action-arrow {background: url(images/arrow_left_hover.svg) no-repeat center;}.controller-loading .action-content{padding-top: 15px; height: 48px;}.section-appstate .action-content{padding-top: 15px;}.section-appstate .appstate-check .label{float: none !important; font-size: 12px !important; margin-left: 30px; color: #000;}.jimu-rtl .section-appstate .appstate-check .label{margin-right: 30px; margin-left: auto;}.loadingpage-section,.appproxy-section{margin-top: 25px; width: 100%; padding: 0 30px;}.appproxy-section .attribute-link,.loadingpage-section .attribute-link{text-align: center; font-family: "Avenir Medium"; font-size: 16px; color: #232323; height: 22px; width: 100%;}.appproxy-section .attribute-link .action-arrow,.loadingpage-section .attribute-link .action-arrow{cursor: pointer; width: 8px; height: 22px; background: url(images/arrow_left_normal.svg) no-repeat center;}.jimu-rtl .appproxy-section .attribute-link .action-arrow,.jimu-rtl .loadingpage-section .attribute-link .action-arrow{background: url(images/arrow_right_normal.svg) no-repeat center;}.appproxy-section .attribute-link:hover .action-arrow,.loadingpage-section .attribute-link:hover .action-arrow{background: url(images/arrow_left_hover.svg) no-repeat center;}.jimu-rtl .appproxy-section .attribute-link .action-arrow:hover,.jimu-rtl .loadingpage-section .attribute-link .action-arrow:hover{background: url(images/arrow_right_hover.svg) no-repeat center;}.loadingpage-section .config-part{margin-top: 10px; font-size: 14px; color: #7889a0; width: 300px;}.loadingpage-section .bgColor-control{height: 30px; width: 340px; margin-top: 10px; text-align: center; line-height: 30px; color: #000000;}.loadingpage-section .bgUploaderDiv{width: 300px; height: 30px;}.loadingpage-section .loading-image-chooser{width: auto; height: 30px; line-height: 30px; margin-top: 10px;}.loadingpage-section .jimu-btn{padding-top: 1px;}.loadingpage-section .config-part .label{font-family: "Avenir Medium"; font-size: 14px; color: #000000;}.loadingpage-section .config-part .jimu-checkbox .label{font-family: "Avenir Light"; font-size: 12px; color: #000000;}.loadingpage-section .config-part label{font-family: "Avenir Light"; font-size: 12px; color: #333333;}.loadingpage-section .config-part .value{font-size: 14px; color: #000000; margin-left: 15px;}.loadingpage-section .gif_select{width: 100px; height: 32px;}.section {width: 100%;}.section .title \x3e span {line-height: 20px; font-family: "Avenir Medium"; font-size: 14px; color: #232323}.section .title .action-arrow {width: 7px; height: 12px; margin: 4px 0; background: url(images/arrow_right_normal.svg) no-repeat center; background-size: 100% 100%; cursor: pointer;}.section .title .action-arrow:hover {background: url(images/arrow_right_hover.svg) no-repeat center;}.jimu-rtl .section .title .action-arrow {background: url(images/arrow_left_normal.svg) no-repeat center;}.jimu-rtl .section .title .action-arrow:hover {background: url(images/arrow_left_hover.svg) no-repeat center;}.section .action-text,.sub-section .note {margin-top: 5px; line-height: 16px; font-size: 12px; color: #A7A7A7;}.appproxy-section {width: 100%;}.appproxy-section .sub-section {margin-top: 20px; width: 100%;}.appproxy-section .sub-section.double-margin {margin-top: 40px;}.appproxy-section .sub-section .title {line-height: 20px; font-family: "Avenir Medium"; font-size: 14px; color: #232323;}.appproxy-section .sub-section .row {height: 16px; margin-top: 13px;}.appproxy-section .sub-section .row \x3e .col:first-child {text-align: left;}.jimu-rtl .appproxy-section .sub-section .row \x3e .col:first-child {text-align: right;}.appproxy-section .sub-section .row \x3e .col:last-child {text-align: right;}.jimu-rtl .appproxy-section .sub-section .row \x3e .col:last-child {text-align: left;}.appproxy-section .sub-section .col {width: 32%; line-height: 16px; font-family: "Avenir-Book"; font-size: 12px; color: #232323; display: inline-block; text-align: center; text-overflow: ellipsis; overflow: hidden; white-space: nowrap;}.appproxy-section .sub-section .col.credits {background: url(images/PremiumContentUserCredit16.png) no-repeat center; height: 16px;}.appproxy-section .sub-section .col .checkbox {float: right !important;}.jimu-rtl .appproxy-section .sub-section .col .checkbox {float: left !important;}.appproxy-section .sub-section .header {height: 36px; margin: 10px 0;}.appproxy-section .sub-section .header .row {height: 36px; margin: 0;}.appproxy-section .sub-section .header .row .col {color: #898989; height: 36px; line-height: 36px;}.appproxy-section .sub-section .sepeartor {width: 100%; height: 1px; background: #EFEFEF;}.appproxy-section .note-content {font-family: "Avenir Medium"; font-size: 14px; color: #232323;}.loading {background: transparent;}',
"url:builder/plugins/creation-entry/Plugin.html":"\x3cdiv\x3e\r\n\r\n\x3c/div\x3e\r\n","url:builder/plugins/creation-entry/SaveAsPage.html":'\x3cdiv\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"configureApp"\x3e${nls.savePublish}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"appBuilder"\x3e${nls.appBuilderTitle}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"appBuilder"\x3e${nls.appBuilderMsg}\x3c/p\x3e\r\n\r\n\r\n  \x3cdiv class\x3d"item-info-box" data-dojo-attach-point\x3d"itemInfoBox" \x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/creation-entry/CreateNewAppPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"app-select-page" data-dojo-attach-point\x3d"appSelectPage"\x3e\r\n    \x3cdiv class\x3d"switch-btn-box-container"\x3e\r\n      \x3cdiv class\x3d"switch-btn-box"\x3e\r\n        \x3cdiv class\x3d"switch-btn all-app-btn selected" data-dojo-attach-point\x3d"allAppBtn"\r\n             data-dojo-attach-event\x3d"onclick:_onAllAppBtnClick"\x3e ${nls.all}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"separate"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"switch-btn own-app-btn" data-dojo-attach-point\x3d"ownAppBtn"\r\n             data-dojo-attach-event\x3d"onclick:_onOwnAppBtnClick"\x3e ${nls.myTemplates}\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"app-content all-app-content" data-dojo-attach-point\x3d"allAppContent"\x3e\r\n      \x3cdiv class\x3d"app-line" data-dojo-attach-point\x3d"defaultApps"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"app-line" data-dojo-attach-point\x3d"othersApps"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"app-content own-app-content" data-dojo-attach-point\x3d"ownAppContent"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"app-info-page" data-dojo-attach-point\x3d"appInfoPage"\x3e\r\n    \x3cdiv class\x3d"app-info-table" data-dojo-attach-point\x3d"appInfoTable"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/creation-entry/css/style.css":".create-app-page {border: 0px solid; position: relative; margin: 0 auto;}.create-app-page .app-select-page {min-height: 200px;}.create-app-page .app-select-page .switch-btn-box-container {height: 50px; position: relative; margin-bottom: 10px; margin-left: 10px;}.create-app-page .app-select-page .switch-btn-box {position: absolute; left: 0; top: 20px; font-size: 14px; color: #999; font-weight: bold; line-height: 20px;}.jimu-rtl .create-app-page .app-select-page .switch-btn-box {right: 0; left: auto;}.jimu-rtl .create-app-page .app-select-page .switch-btn-box {margin-right: 8px; margin-left: auto;}.create-app-page .app-select-page .switch-btn-box .switch-btn {display: inline-block; cursor: pointer; font-size: 14px; text-align: center; min-width: 40px; border-bottom: 2px solid transparent;}.create-app-page .app-select-page .switch-btn-box .switch-btn:hover {color: #d84b28;}.create-app-page .app-select-page .switch-btn-box .switch-btn.selected {color: #d84b28; border-bottom: 2px solid #d84b28; min-width: 40px; text-align: center;}.create-app-page .app-select-page .switch-btn-box .separate {display: inline-block; width: 30px;}.create-app-page .app-info-page {width: 100%; border: 0px solid; top: 70px; margin: 0 auto;}.app-select-page .app-content {overflow: hidden;}.jimu-rtl .app-select-page .app-content {margin-right: 6px; margin-left: auto;}.app-select-page .all-app-content {overflow: auto; padding: 10px;}.app-select-page .own-app-content {overflow: auto; display: none; padding: 10px;}.app-select-page .app-content .app-line {float: left; width: 100%;}.jimu-rtl .app-select-page .app-content .app-line {float: right;}.app-select-page .app-content .app-node {border: 0px solid; text-align: center; position: relative; margin-right: 14px; cursor: pointer; max-width: 182px;}.app-select-page .app-content .app-node .flag-image {position: absolute; width: 26px; height: 22px; top: 86px; right: 10px; background-position: center; background-repeat: repeat; display: block;}.app-select-page .app-content .app-node .jimu-state-active .flag-image {}.app-select-page .app-content .app-node .flag-image-2D{background-image: url(images/flag_2d.png);}.app-select-page .app-content .app-node .flag-image-3D{background-image: url(images/flag_3d.png);}.app-select-page .app-content .app-node .app-image-border-div {position: relative; width: 180px; height: 120px; border: 2px solid transparent; border-radius: 4px; -webkit-box-shadow:0 0 10px rgba(0, 0, 0, .1); -moz-box-shadow:0 0 10px rgba(0, 0, 0, .1); box-shadow: 0 0 10px rgba(0, 0, 0, .1); background-color: #fff;}.app-select-page .app-content .app-node .app-image-div {width: 120px; height: 80px; background-repeat: no-repeat; background-color: #f2f2f2; background-position: center; margin: 0 auto; margin-top: 18px; background-size: 100% 100%;}.app-select-page .app-content .app-node .jimu-state-active .app-image-selected-container {width: 180px; height: 120px; background-color: rgba(255,255,255,0.6); position: absolute;}.app-select-page .app-content .app-node .jimu-state-active .app-image-selected-icon{position: absolute; width: 24px; height: 24px; top: 10px; right: 10px; background-position: center;}.app-select-page .app-content .app-node .app-name {color: #333; max-height: 50px; min-height: 20px; padding-top: 10px; padding-bottom: 10px; height: 40px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.app-select-page .app-content .app-node .jimu-state-active {border: 2px solid #31aacd; border-radius: 4px;}",
"url:builder/plugins/header/Plugin.html":'\x3cdiv class\x3d"top-nav clearfix"\x3e\r\n  \x3cdiv class\x3d"switch-section" data-dojo-attach-point\x3d"switchSection"\x3e\r\n    \x3cdiv class\x3d"switch-container"\x3e\r\n      \x3cdiv class\x3d"jimu-float-leading applist-switch apps selected" data-dojo-attach-point\x3d"appSwitch"\x3e${nls.apps}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-float-leading applist-switch templates" data-dojo-attach-point\x3d"templateSwitch"\x3e${nls.templates}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"dropdown left dropdown-home" data-dojo-attach-point\x3d"homeSection"\x3e\r\n    \x3ca class\x3d"dropdown-btn top-nav-title site_logo" data-dojo-attach-point\x3d"homeLabel"\x3e${nls.home}\x3c/a\x3e\r\n    \x3cdiv class\x3d"dropdown-menu" data-dojo-attach-point\x3d"homeMenu"\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"homeItem"\x3e${nls.home}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"galleryItem"\x3e${nls.gallery}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"mapItem"\x3e${nls.map}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"sceneItem"\x3e${nls.scene}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"groupsItem"\x3e${nls.groups}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"contentItem"\x3e${nls.content}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"organizationItem"\x3e${nls.organization}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3ca class\x3d"top-nav-link top-nav-logo left" data-dojo-attach-point\x3d"logoTitle"\x3e\r\n    Web AppBuilder for ArcGIS\r\n  \x3c/a\x3e\r\n\r\n  \x3ch1 class\x3d"avenir-light left text-ellipsis font-size-1 leader-1 app-name" data-dojo-attach-point\x3d"appName"\x3e\x3c/h1\x3e\r\n\r\n  \x3cdiv class\x3d"dropdown right" data-dojo-attach-point\x3d"userSection" data-dojo-attach-event\x3d"onclick:_onUserSectionClicked"\x3e\r\n    \x3ca class\x3d"top-nav-link dropdown-btn top-nav-username text-ellipsis" data-dojo-attach-point\x3d"userInfoDom"\x3e\r\n      \x3cimg data-dojo-attach-point\x3d"userIcon" src\x3d"${folderUrl}/css/images/no-user-thumb.jpg" width\x3d"16" height\x3d"16"/\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"userNameNode"\x3e\x3c/span\x3e\r\n    \x3c/a\x3e\r\n    \x3cdiv class\x3d"dropdown-menu dropdown-right text-ellipsis" data-dojo-attach-point\x3d"userMenu"\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" data-dojo-attach-point\x3d"profileItem"\x3e\r\n        \x3cimg width\x3d"32" height\x3d"32" class\x3d"gutter-right-half gutter-left-0 content-box left" data-dojo-attach-point\x3d"profileImg" src\x3d"${folderUrl}/css/images/no-user-thumb.jpg" /\x3e\r\n        \x3cspan\x3e${nls.profile}\x3c/span\x3e\r\n        \x3cbr\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"profileNameNode" class\x3d"profile-name"\x3e\x3c/span\x3e\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"communityNode" class\x3d"hidden dropdown-link dropdown-link-external communityNode"\x3e\r\n        \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${nls.communityAndForums}\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"myesriNode" class\x3d"hidden dropdown-link dropdown-link-external myesriNode"\x3e\r\n        \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${nls.myesri}\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"trainingNode" class\x3d"hidden dropdown-link dropdown-link-external trainingNode"\x3e\r\n        \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${nls.training}\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"helpNode" class\x3d"dropdown-link"\x3e${nls.help}\x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"adminHelpNode" class\x3d"hidden dropdown-link admin-guide"\x3e${nls.administratorGuide}\x3c/a\x3e\r\n      \x3ca class\x3d"sign-out dropdown-link" data-dojo-attach-point\x3d"signOutItem"\x3e${nls.signOut}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/header/css/style.css":'.plugin-header .switch-section{position: absolute; left: 0; right: 0; height: 100%; z-index: -1;}.plugin-header.app-opened .switch-section{display: none;}.plugin-header .switch-section .switch-container{min-width: 1024px; max-width: 1260px; height: 100%; margin-left: auto; margin-right: auto; overflow: hidden;}.plugin-header.width-less1816 .switch-section .switch-container{margin-left: 280px; margin-right: 0;}.jimu-rtl .plugin-header.width-less1816 .switch-section .switch-container{margin-right: 280px; margin-left: 0;}.plugin-header .switch-section .switch-container .applist-switch{height: 100%; line-height: 60px; cursor: pointer; color: #999999; font-size: 14px;}.plugin-header .switch-section .switch-container .applist-switch.selected{color: #31aacd;}.plugin-header .switch-section .switch-container .applist-switch.apps{margin-right: 40px;}.jimu-rtl .plugin-header .switch-section .switch-container .applist-switch.apps{margin-right: 0; margin-left: 40px;}.plugin-header.clearfix:after {content: \'\'; display: table; clear: both;}.plugin-header .left {float: left;}.plugin-header .right {float: right;}.plugin-header .avenir-light {letter-spacing: 0em; font-weight: 300; font-style: normal;}.plugin-header .avenir-light b, .plugin-header .avenir-light strong {font-weight: 500;}.plugin-header .avenir-regular,.plugin-header.top-nav,.plugin-header .top-nav-link,.plugin-header .dropdown-link {letter-spacing: 0em; font-weight: 400; font-style: normal;}.plugin-header .avenir-regular b,.plugin-header.top-nav b,.plugin-header .top-nav-link b,.plugin-header .avenir-regular strong,.plugin-header.top-nav strong,.plugin-header .top-nav-link strong {font-weight: 500;}.plugin-header .dropdown-btn:after {font-family: \'CalciteWebCoreIcons\'; padding-right: 0.5166666667em; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; line-height: 1; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.plugin-header .dropdown-btn:after {padding-right: 0; padding-left: 0.5166666667em;}.plugin-header [class^\x3d"esri-icon-"]:before,.plugin-header [class*\x3d" esri-icon-"]:before,.plugin-header [class^\x3d"icon-ui-"]:before,.plugin-header [class*\x3d" icon-ui-"]:before {font-family: \'CalciteWebCoreIcons\'; padding-right: 0.5166666667em; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; line-height: 1; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.plugin-header .esri-icon-link-external:before,.plugin-header .icon-ui-link-external:before {content: "\\e65c";}.plugin-header .esri-icon-down-arrow:before,.plugin-header .icon-ui-down-arrow:before,.plugin-header .dropdown-btn:after {content: "\\e608";}.plugin-header .esri-icon-user:before,.plugin-header .icon-ui-user:before {content: "\\e675";}.plugin-header .esri-icon-menu:before,.plugin-header .icon-ui-menu:before {content: "\\e663";}.plugin-header .top-nav-username {max-width: 175px; margin-bottom: -4px;}@media screen and (max-width: 1080px) {.plugin-header .top-nav-username {max-width: 130px;}}.plugin-header.top-nav {font-size: 17px; background-color: white;}.plugin-header.top-nav a {text-decoration: none;}.plugin-header.top-nav .dropdown-btn:after {top: 22px;}.plugin-header.top-nav {padding: 0 .5em; overflow: visible; z-index: 100;}.plugin-header .dropdown {position: relative; display: inline-block;}.plugin-header .dropdown.is-active .dropdown-menu {pointer-events: auto; display: block;}.plugin-header .dropdown-btn:after {font-family: \'CalciteWebCoreIcons\'; padding-right: 0.5166666667em; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.plugin-header .dropdown-btn:after {padding-right: 0; padding-left: 0.5166666667em;}.plugin-header .dropdown-btn {padding-right: 2em; cursor: pointer; position: relative;}.jimu-rtl .plugin-header .dropdown-btn{padding-right: 0; padding-left: 2em;}.plugin-header .dropdown-btn:after {font-size: 0.8125em; line-height: 1.55em; position: absolute; right: .75em;}.jimu-rtl .plugin-header .dropdown-btn:after{right: auto; left: 0.75em;}.plugin-header .dropdown-menu {position: absolute; left: 0; right: auto; min-width: 200px; max-width: 300px; margin-top: -12px; top: 100%; -webkit-box-shadow: 0 0 16px 0 rgba(0, 0, 0, 0.05); -moz-box-shadow: 0 0 16px 0 rgba(0, 0, 0, 0.05); box-shadow: 0 0 16px 0 rgba(0, 0, 0, 0.05); z-index: 1000; pointer-events: none; display: none;}.jimu-rtl .plugin-header .dropdown-menu {left: auto; right: 0;}.plugin-header .dropdown-menu.dropdown-right {left: auto; right: 0;}.jimu-rtl .plugin-header .dropdown-menu.dropdown-right {left: 0; right: auto;}.plugin-header .dropdown-home .dropdown-btn {padding-top: 1em;}.plugin-header .side-nav, .plugin-header .dropdown-menu {-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0; border: 1px solid #efefef; border-top: none; background-color: white;}.plugin-header .side-nav-title {margin: 0; padding: 0.5166666667em; font-size: 0.9375em; line-height: 1.55em; background-color: #f8f8f8; border-top: 1px solid #efefef;}.plugin-header .side-nav-link, .plugin-header .dropdown-link {position: relative; display: block; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0.5166666667em 1.55em 0.5166666667em 0.5166666667em; font-size: 0.875em; line-height: 1.55em; color: #6e6e6e; background-color: white; border-top: 1px solid #efefef; -webkit-transition: all 150ms linear; transition: all 150ms linear; text-decoration: none; cursor: pointer;}.plugin-header .side-nav-link:after, .plugin-header .dropdown-link:after {content: "\\00BB"; opacity: 0; position: absolute; right: 0; top: .5em; padding: 0 0.3875em; -webkit-transition: all 150ms linear; transition: all 150ms linear;}.plugin-header .side-nav-link:hover, .plugin-header .dropdown-link:hover {text-decoration: none; color: #828282;}.plugin-header .side-nav-link:hover:after, .plugin-header .dropdown-link:hover:after {opacity: 1;}.plugin-header .side-nav-link.is-active, .plugin-header .is-active.dropdown-link {background-color: #d2e9f9; font-weight: inherit !important;}.plugin-header .dropdown-link {white-space: nowrap;}.plugin-header .dropdown-link-external {padding: 0.5166666667em 2em !important;}.plugin-header .dropdown-link-external-icon {position: absolute; left: .5em;}.plugin-header.top-nav {border-bottom: 1px solid #efefef;}.plugin-header.top-nav .esri-logo {margin-top: 1em;}.plugin-header.top-nav .sign-in {padding-top: 1.55em;}.plugin-header .top-nav-title {font-size: 1em; float: left; padding-top: 15px; padding-bottom: 15px; line-height: 1.5em; color: #4c4c4c;}.plugin-header .top-nav-title:hover {color: #3b8fc4; background: url(\'./images/top-nav-ie9.gif\') repeat-x bottom left transparent; text-decoration: none;}.plugin-header .top-nav-title.icon-ui-menu:before {vertical-align: -1px; padding-right: .5em;}.plugin-header .top-nav-list {padding: 0; float: left;}.plugin-header .top-nav-list .top-nav-link + .top-nav-link {margin-left: .75em;}.plugin-header .top-nav-link {font-size: 0.9375em; line-height: 1.55em; color: #4c4c4c !important; padding: 19px 0; line-height: 1.5em; display: inline-block;}.plugin-header .top-nav-link:hover, .plugin-header .top-nav-link:focus {color: #3b8fc4 !important; background: url(\'./images/top-nav-ie9.gif\') repeat-x bottom left transparent; text-decoration: none;}.plugin-header .top-nav-link:hover a, .plugin-header .top-nav-link:focus a {color: #3b8fc4;}.plugin-header .top-nav-link:focus {outline: none;}.plugin-header .top-nav-link.is-active {background: url(\'./images/top-nav-ie9.gif\') repeat-x bottom left transparent;}.plugin-header .top-nav-link a {color: #4c4c4c;}.plugin-header .top-nav-link a:hover {text-decoration: none;}.plugin-header .top-nav-link.dropdown-btn {padding-right: 1em;}.plugin-header .top-nav-link.dropdown-btn:after {right: 0;}.plugin-header .user-nav-name {padding: 0.3875em;}.plugin-header .user-nav-image {width: 1.55em; height: 1.55em; margin-right: 0.3875em; vertical-align: -0.3875em;}.plugin-header .link-blue a, .plugin-header a.link-blue {color: #3b8fc4;}.plugin-header .link-blue a:hover, .plugin-header a.link-blue:hover {color: #196fa6;}.plugin-header .link-darkest-gray a,.plugin-header a.link-darkest-gray {color: #595959;}.plugin-header .link-darkest-gray a:hover, .plugin-header a.link-darkest-gray:hover {color: #4c4c4c;}.plugin-header .text-ellipsis {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.plugin-header .font-size--3 {font-size: 0.8125em; line-height: 1.55em;}.plugin-header .font-size--2 {font-size: 0.875em; line-height: 1.55em;}.plugin-header .font-size--1 {font-size: 0.9375em; line-height: 1.55em;}.plugin-header .font-size-0 {font-size: 1em; line-height: 1.55em;}.plugin-header .font-size-1 {font-size: 1.1875em; line-height: 1.55em;}.plugin-header .font-size-2 {font-size: 1.25em;}.plugin-header .font-size-3 {font-size: 1.484375em; line-height: 2.325em;}.plugin-header .leader-half {margin-top: 11px;}.plugin-header .trailer-half {margin-bottom: 0.775em;}.plugin-header .padding-leader-half {padding-top: 0.775em;}.plugin-header .padding-trailer-half {padding-bottom: 0.775em;}.plugin-header .leader-0 {margin-top: 0em;}.plugin-header .trailer-0 {margin-bottom: 0em;}.plugin-header .padding-leader-0 {padding-top: 0em;}.plugin-header .padding-trailer-0 {padding-bottom: 0em;}.plugin-header .leader-1 {margin-top: 14px;}.plugin-header .padding-leader-1 {padding-top: 22px;}.plugin-header .gutter-left-half {padding-left: 0.5em;}.plugin-header .gutter-right-half {padding-right: 0.5em;}.plugin-header .gutter-left-0 {padding-left: 0em;}.plugin-header .gutter-right-0 {padding-right: 0em;}.plugin-header .gutter-left-1 {padding-left: 1em;}.plugin-header .gutter-right-1 {padding-right: 1em;}.plugin-header .gutter-right-2 {padding-right: 2em;}.jimu-rtl .plugin-header .gutter-left-half {padding-left: 0; padding-right: 0.5em;}.jimu-rtl .plugin-header .gutter-right-half {padding-right: 0; padding-left: 0.5em;}.jimu-rtl .plugin-header .gutter-left-0 {padding-left: 0; padding-right: 0;}.jimu-rtl .plugin-header .gutter-right-0 {padding-left: 0; padding-right: 0;}.jimu-rtl .plugin-header .gutter-left-1 {padding-left: 0; padding-right: 1em;}.jimu-rtl .plugin-header .gutter-right-1 {padding-right: 0; padding-left: 1em;}.jimu-rtl .plugin-header .gutter-right-2 {padding-right: 0; padding-left: 2em;}.jimu-rtl .plugin-header .left {float: right;}.jimu-rtl .plugin-header .right {float: left;}.jimu-rtl .plugin-header .top-nav-title {float: right;}.jimu-rtl .plugin-header .top-nav-link {float: right;}.jimu-rtl .plugin-header .top-nav-list {float: right;}.jimu-rtl .plugin-header .top-nav-link + .top-nav-link {margin-left: 0; margin-right: .75em;}.jimu-rtl .plugin-header .gutter-left-half {padding-right: 0.5em;}.jimu-rtl .plugin-header .gutter-right-half {padding-left: 0.5em;}.jimu-rtl .plugin-header .gutter-left-0 {padding-right: 0em;}.jimu-rtl .plugin-header .gutter-right-0 {padding-left: 0em;}.jimu-rtl .plugin-header .gutter-left-1 {padding-right: 1em;}.jimu-rtl .plugin-header .gutter-right-1 {padding-left: 1em; padding-right: 0.5em;}.jimu-rtl .plugin-header .gutter-right-2 {padding-left: 2em;}.jimu-rtl .plugin-header .top-nav-link.dropdown-btn:after {left: 0; right: auto; padding-right: 0.5166666667em; padding-left: 0;}.jimu-rtl .plugin-header .top-nav-link.dropdown-btn {padding-left: 1em; padding-right: 0;}.jimu-rtl .plugin-header .side-nav-link:after, .jimu-rtl .plugin-header .dropdown-link:after {left: 0; right: auto;}.jimu-rtl .plugin-header .side-nav-link, .jimu-rtl .plugin-header .dropdown-link {padding: 0.5166666667em 0.5166666667em 0.5166666667em 2.5em;}.jimu-rtl .plugin-header [class^\x3d"icon-ui-"]:before, .jimu-rtl .plugin-header [class*\x3d" icon-ui-"]:before {padding-right: 0; padding-left: 0.5166666667em;}.jimu-rtl .plugin-header .sub-nav-link, .jimu-rtl .plugin-header a.sub-nav-link {float: right;}.jimu-rtl .plugin-header .dropdown-link-external-icon {left: auto; right: .5em;}.plugin-header.top-nav .hidden {display: none;}.plugin-header .top-nav-logo {padding-left: 36px; padding-right: 15px; background: url(images/logo.png) no-repeat left center;}.plugin-header .top-nav-logo:hover {background: url(images/logo.png) no-repeat left center;}.plugin-header.xt.app-opened .top-nav-logo{cursor: pointer;}.jimu-rtl .plugin-header .top-nav-logo {padding-left: 15px; padding-right: 36px; background: url(images/logo.png) no-repeat right center;}.jimu-rtl .plugin-header .top-nav-logo {background: url(images/logo.png) no-repeat right center;}.plugin-header .content-box {box-sizing: content-box !important;}.plugin-header .app-name {max-width: 60%;}@media screen and (max-width: 960px) {.plugin-header .app-name {max-width: 40%;}}@media screen and (max-width: 720px) {.plugin-header .app-name {max-width: 30%;}}.plugin-header .top-nav-logo{position: relative; top: 1px;}.plugin-header .top-nav-username{font-size: 14px;}.plugin-header .top-nav-username img{position: relative; top: 3px;}.plugin-header .top-nav-username span{position: relative;}.plugin-header.app-not-opened{background-color: #333333;}.plugin-header.app-not-opened .top-nav-link.top-nav-logo{color: #ffffff !important;}.plugin-header.app-not-opened .switch-section .switch-container .applist-switch{color: #999999;}.plugin-header.app-not-opened .switch-section .switch-container .applist-switch.selected{color: #ffffff;}.plugin-header.app-not-opened .top-nav-link.top-nav-username{color: #999999 !important;}',
"url:builder/plugins/map-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"map-info-section"\x3e\r\n    \x3cdiv class\x3d"map-selected-meta-data"\x3e\r\n      \x3cdiv class\x3d"thumbnail-container" data-dojo-attach-point\x3d"thumbnailContainer" data-dojo-attach-event\x3d"click:showMapSelector" title\x3d"${nls.clickChooseWebMapOrWebScene}"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"detail-info"\x3e\r\n        \x3cdiv style\x3d"overflow:hidden;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"webItemIcon" class\x3d"web-item-icon jimu-float-leading"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"owner-div jimu-float-leading" style\x3d"width:140px;"\x3e\r\n            \x3cspan class\x3d"item-type" data-dojo-attach-point\x3d"webItemType"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"owner-link-div"\x3e\r\n          \x3cspan class\x3d"owner-tip"\x3e${nls.owner}\x3c/span\x3e\r\n          \x3ca class\x3d"owner-name" href\x3d"#" target\x3d"_blank" data-dojo-attach-point\x3d"ownerName"\x3e\x3c/a\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"margin-top:5px;color:#596679;"\x3e\r\n          \x3cspan\x3e${nls.lastModified}:\x3c/span\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"lastModified" class\x3d"last-modified"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"webmap-details-div"\x3e\r\n          \x3ca data-dojo-attach-point\x3d"webMapDetails" href\x3d"#" target\x3d"_blank" class\x3d"webmap-details" title\x3d"${nls.moreDetails}"\x3e${nls.moreDetails}...\x3c/a\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"map-chooser"\x3e\r\n          \x3cdiv nowrap class\x3d"choose-map-btn" data-dojo-attach-event\x3d"click:showMapSelector"\x3e\r\n            \x3cdiv class\x3d"label" data-dojo-attach-point\x3d"chooseMapButton" title\x3d"${nls.chooseWebMapOrWebScene}"\x3e${nls.chooseWebMapOrWebScene}\x3c/div\x3e\r\n            \x3cdiv class\x3d"options jimu-float-trailing" data-dojo-attach-point\x3d"mapOptions" data-dojo-attach-event\x3d"click:showMapOptions"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"webMapEditOptions" class\x3d"edit-options" style\x3d"display: none;"\x3e\r\n            \x3cdiv nowrap class\x3d"option-item" data-dojo-attach-event\x3d"click:editWebMap" title\x3d"${nls.editMap}"\x3e${nls.editMap}\x3c/div\x3e\r\n            \x3cdiv nowrap class\x3d"option-item" data-dojo-attach-event\x3d"click:createWebMap" title\x3d"${nls.createMap}"\x3e${nls.createMap}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"webMapOptionsMask" class\x3d"overlay-mask" data-dojo-attach-event\x3d"click:hideMapOptions" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"map-info-content"\x3e\r\n      \x3cdiv class\x3d"map-info-title option-title" data-dojo-attach-point\x3d"mapTitle"\x3e\x3c/div\x3e\r\n      \x3cp class\x3d"snippet" data-dojo-attach-point\x3d"snippet"\x3e\x3c/p\x3e\r\n      \x3cdiv class\x3d"map-options" data-dojo-attach-point\x3d"mapOptions2D"\x3e\r\n        \x3cdiv class\x3d"map-option extent-option"\x3e\r\n          \x3cdiv class\x3d"option-title"\x3e${nls.setInitialExtent}\x3c/div\x3e\r\n          \x3cp class\x3d"option-statement"\x3e${nls.statement}\x3c/p\x3e\r\n          \x3cspan class\x3d"jimu-btn init-ext-btn jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_useCurrentMapExtent"\x3e${nls.useCurrentExtent}\x3c/span\x3e\x3cbr\x3e\r\n          \x3cspan class\x3d"jimu-btn restore-ext-btn jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_useDefaultMapExtent"\x3e${nls.restoreInitialExtent}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"map-option scale-option"\x3e\r\n          \x3cdiv class\x3d"option-title"\x3e${nls.scaleTitle}\x3c/div\x3e\r\n          \x3cp class\x3d"option-statement"\x3e${nls.scaleStatement}\x3c/p\x3e\r\n          \x3cspan class\x3d"jimu-btn scale-btn jimu-btn-vacation" data-dojo-attach-point\x3d"btnScale" data-dojo-attach-event\x3d"onclick:_onBtnScaleClicked"\x3e${nls.customize}...\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"map-options" data-dojo-attach-point\x3d"mapOptions3D"\x3e\r\n        \x3cdiv class\x3d"map-option extent-option"\x3e\r\n          \x3cdiv class\x3d"option-title"\x3e${nls.setInitialSceneState}\x3c/div\x3e\r\n          \x3cp class\x3d"option-statement"\x3e${nls.sceneStateTip}\x3c/p\x3e\r\n          \x3cspan class\x3d"jimu-btn init-ext-btn jimu-btn-vacation" title\x3d"${nls.useCurrentSceneState}" data-dojo-attach-event\x3d"onclick:_useCurrentViewpoint"\x3e${nls.useCurrentSceneState}\x3c/span\x3e\x3cbr\x3e\r\n          \x3cspan class\x3d"jimu-btn restore-ext-btn jimu-btn-vacation" title\x3d"${nls.useWebSceneDefaultState}" data-dojo-attach-event\x3d"onclick:_useDefaultViewpoint"\x3e${nls.useWebSceneDefaultState}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/MapSelector.html":'\x3cdiv style\x3d"position:relative;width:100%;height:100%;"\x3e\r\n\t\x3cdiv class\x3d"map-setting-tab-container" style\x3d"width:100%;height:100%;"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"jimu-float-leading sort-icon"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"mycontentSelect" data-dojo-attach-event\x3d"change:_onMyContentSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews" selected\x3d"true"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"  style\x3d"top:65px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"jimu-float-leading sort-icon"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"organizationSelect" data-dojo-attach-event\x3d"change:_onOrganizationSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews" selected\x3d"true"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'" style\x3d"top:65px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" style\x3d"position:absolute;width:100%;top:70px;" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.groups}:\x3c/span\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section" data-dojo-attach-point\x3d"groupSearchSection"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"jimu-float-leading sort-icon"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"groupSelect" data-dojo-attach-event\x3d"change:_onGroupSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews" selected\x3d"true"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'" style\x3d"top:113px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"jimu-float-leading sort-icon"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"publicSelect" data-dojo-attach-event\x3d"change:_onPublicSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews" selected\x3d"true"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel  data-dojo-attach-point\x3d"portalNameLabel" class\x3d"jimu-float-leading portal-name"\x3ePortal\x3c/label\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlineNameLabel" class\x3d"jimu-float-leading online-name"\x3eArcGIS Online\x3c/label\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicMapSection" class\x3d"public-map-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/MapTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"maps-section" data-dojo-attach-point\x3d"allMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"allMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"allMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"maps-section" data-dojo-attach-point\x3d"filteredMapsSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"filteredMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"filteredMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/CustomizeScale.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"scale-input-div" data-dojo-attach-point\x3d"scaleInputDiv"\x3e\r\n    \x3cdiv class\x3d"add-btn jimu-float-leading" data-dojo-attach-point\x3d"btnAdd" data-dojo-attach-event\x3d"onclick:_onBtnAddClicked"\x3e+\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"operations-div"\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading operation-btn delete-btn" data-dojo-attach-point\x3d"btnDelete" data-dojo-attach-event\x3d"onclick:_onBtnDeleteClicked"\x3e\r\n      \x3cspan class\x3d"jimu-float-leading icon"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"jimu-float-leading label"\x3e${nls.deleteTip}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading operation-btn reset-btn" data-dojo-attach-event\x3d"onclick:_onBtnResetClicked"\x3e\r\n      \x3cspan class\x3d"jimu-float-leading icon"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"jimu-float-leading label"\x3e${nls.resetTip}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"list" data-dojo-attach-point\x3d"listNode" data-dojo-attach-event\x3d"onclick:_onLodListClicked"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/css/style.css":".map-config{margin: 0; padding: 0; overflow-y: hidden;}.map-config .map-info-section{position:absolute; left: 20px; right: 20px; top: 20px; bottom: 0;}.map-config .big-img{position:relative; width:100%; height:240px; -webkit-border-radius:5px; -moz-border-radius:5px; -o-border-radius:5px; -ms-border-radius:5px; border-radius:5px; background:#e5e5e5;}.map-config .add-map-tip{margin-top:13px; padding-left:6px; padding-right:6px; color:#999999; font-size:12px;}.map-config .map-selected-meta-data{position: relative; width: 100%; height: 133px;}.map-config .thumbnail-container{position:absolute; left: 0; right: auto; top: 0; width:190px; height:133px; cursor: pointer;}.jimu-rtl .map-config .thumbnail-container{left: auto; right: 0;}.map-config .thumbnail-container .thumbnail{width: 100%; height: 100%; background-color:#e5e5e5; border:1px solid #d2dae2; background-repeat:no-repeat; background-position:center center; background-size:cover;}.map-config .thumbnail-container .thumbnail.default-webmap{background-image: url(images/WebMapThumbnail.png);}.map-config .thumbnail-container .thumbnail.default-webscene{background-image: url(images/WebSceneThumbnail.jpeg);}.map-config .detail-info{position: absolute; left: 200px; top: 0; right: 0; height: 100%; color: #333333; font-size: 12px;}.has-mozilla .map-config .detail-info{font-size: 12px;}.jimu-rtl .map-config .detail-info{left: 0; right: 200px;}.map-config .web-item-icon{display: inline-block; width: 16px; height: 16px; background-position: center center; background-repeat: no-repeat;}.map-config .web-item-icon.webmap{background-image: url(images/WebMapIcon.png);}.map-config .web-item-icon.webscene{background-image: url(images/WebSceneIcon.png);}.map-config .owner-div{padding-left: 5px; color: #596679;}.jimu-rtl .map-config .owner-div{padding-left: 0; padding-right: 5px;}.map-config .owner-link-div{white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-top: 5px;}.map-config .owner-link-div .owner-name{color: #24B5CC; text-decoration: none;}.map-config .last-modified{white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.map-config .webmap-details-div{margin-top:5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.map-config .webmap-details{text-decoration: none; color: #24B5CC;}.map-config .map-info-content{position: absolute; width: 100%; left: 0; right: 0; top: 143px; bottom: 0; overflow: auto;}.map-config .snippet{max-height:115px; overflow: hidden; text-overflow: ellipsis; margin-top: 10px; font-size:12px; color: #666;}.map-config .map-options{display: none;}.map-config .map-options.enabled{display: block;}.map-config .extent-option{margin-top: 33px;}.map-config .option-title{font-size: 14px; color: #000; font-family: 'Avenir Medium';}.map-config .option-statement{font-size: 12px; color: #666; margin-top: 9px;}.map-config .init-ext-btn{margin-top:10px;}.map-config .restore-ext-btn{margin-top:10px;}.map-config .scale-option{margin-top: 38px;}.map-config .scale-btn{margin-top: 10px;}.map-config .map-chooser{position: absolute; left: 0; bottom: 0; width: 100%;}.map-config .overlay-mask{position: fixed; width: 100%; height: 100%; left: 0; top: 0; z-index: 119;}.map-config .edit-options{box-shadow: 0 0 16px rgba(160,160,160,0.4); background-color: white; z-index: 120; width: 160px; position: absolute; left: 0; top: 40px;}.jimu-rtl .map-config .edit-options{left: auto; right: 0;}.map-config .edit-options \x3e .option-item{width: 100%; height: 40px; cursor: pointer; line-height: 40px; font-size: 14px; white-space:nowrap; overflow:hidden; text-align: left; text-overflow: ellipsis; background-color: #24B5CC; color: #ffffff; border-top: 2px solid #ffffff; padding: 0 10px;}.jimu-rtl .map-config .edit-options \x3e .option-item{text-align: right;}.map-config .edit-options \x3e .option-item:hover{background-color: #0090A7;}.map-config .choose-map-btn{width: 160px; height: 40px; overflow:hidden; text-align: center; background-color: #24B5CC; cursor: pointer;}.map-config .choose-map-btn .label{display: inline-block; line-height: 40px; text-overflow: ellipsis; white-space:nowrap; font-size: 14px; color: #ffffff; max-width: 140px; padding: 0 5px; overflow: hidden;}.map-config .choose-map-btn .label:hover{background-color: #0090A7;}.map-config .choose-map-btn .options{display: inline-block; height: 40px; background: url('images/v-White.png') no-repeat center; width: 20px; border-left: 1px solid rgba(255, 255, 255, 0.3);}.map-config .choose-map-btn .options:hover{background-color: #0090A7;}.jimu-rtl .map-config .choose-map-btn .options{border-left: none; border-right: 1px solid rgba(255, 255, 255, 0.3);}.map-config .jimu-btn{padding: 0 15px; font-size: 14px; line-height: 33px; text-align: center; max-width: 100%;}.map-config .jimu-btn.jimu-state-disabled{color: #d9dde0;}.map-config .map-info-title{margin-top:10px;}.map-config .set-extent-tip{color:#999999; font-size:12px;}.map-config .description{position:absolute; top:420px; bottom:0; width:100%; overflow:auto; color:#999999; font-size:12px;}.map-table{position:absolute; width: 100%; top:0; bottom: 0; height: auto;}.map-table .maps-section{position: absolute; width: 100%; top: 0; bottom: 0;}.map-table .maps-table-div{width: 100%; height: 100%; overflow-x:hidden; overflow-y:auto;}.map-table .maps-table{width: 100%; table-layout: fixed; border-collapse: collapse;}.map-table .maps-table td{vertical-align:top;}.map-table .map-item-div{width:176px; padding:3px;}.map-table .map-item-div .map-item-bg{position:relative; width:100%; height:118px; text-align:center; color:#999999; font-size:13px;}.map-table .map-item-div .map-item-bg .map-item-thumbnail{position:absolute; left:0; top:0; width:100%; height:100%; background-repeat:no-repeat; background-position:center center; border:1px solid #d2dae2; background-size:cover;}.jimu-rtl .map-table .map-item-div .map-item-bg .map-item-thumbnail{left: auto; right: 0;}.map-table .map-item-div .map-item-bg.selected .map-item-thumbnail{border:3px solid #24B5CC; -webkit-box-sizing:content-box; -moz-box-sizing:content-box; -ms-box-sizing:content-box; -o-box-sizing:content-box; box-sizing:content-box;}.map-table .map-item-div .map-item-bg .map-item-detail-icon{display: none; position:absolute; right:7px; bottom:7px; width:15px; height:15px; background-color:rgba(0, 0, 0, 0.4); background-repeat:no-repeat; background-position:center center; background-image:url(images/info.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px; cursor:pointer;}.jimu-rtl .map-table .map-item-div .map-item-bg .map-item-detail-icon{right: auto; left: 7px;}.map-table .map-item-div .map-item-bg:hover .map-item-detail-icon{display: block;}.map-table .map-item-div .map-item-title{display:inline-block; width:100%; max-height: 31px; text-align:center; color:#596679; font-size:13px; margin-top: 10px; overflow: hidden; word-wrap: break-word;}.map-table .search-none-tip-section .search-none-icon{margin-left:5px;}.jimu-rtl .map-table .search-none-tip-section .search-none-icon{margin-left: 0; margin-right: 5px;}.map-table .search-none-tip-section .search-none-tip{font-size:13px; color:#ff0000; margin-left:10px;}.jimu-rtl .map-table .search-none-tip-section .search-none-tip{margin-left: 0; margin-right: 10px;}.map-selector .jimu-tab3{height: 100%;}.map-selector .jimu-tab3\x3e.container-node{position:absolute; width:100%; left:0; right:0; top:60px; bottom:0;}.map-selector .jimu-tab3 .tab-item-div{height: 48px; line-height: 48px;}.map-selector .tab-content{position: relative;}.map-selector .tab-content .tab-content-main{position: absolute; width: 100%; top:0; bottom:0;}.map-selector .search-section{position:absolute; width:100%; height:45px; top: 15px; font-size: 12px;}.map-selector .search-section .jimu-search{width: 81%;}.map-selector .search-section .dijitSelect{box-sizing: border-box;}.map-selector .search-section .sort-icon{display: none; width: 14px; height: 40px; background: url(images/sort.png) center center no-repeat; margin-left: 28px;}.jimu-rtl .map-selector .search-section .sort-icon{margin-left: auto; margin-right: 28px;}.map-selector .search-section .restrict-select-width{position: relative; width: 18%; top: 5px;}.map-selector .public-search-radios{position:absolute; width:100%; top:75px; height: 20px; line-height:1em; font-size: 14px;}.map-selector .public-search-radios span{display: inline-block;}.map-selector .public-search-radios .portal-public-radio{margin-right: 10px;}.jimu-rtl .map-selector .public-search-radios .portal-public-radio{margin-right: 0; margin-left: 10px;}.map-selector .public-search-radios .portal-name{margin-right: 28px;}.jimu-rtl .map-selector .public-search-radios .portal-name{margin-right: 0; margin-left: 28px;}.map-selector .public-search-radios .online-public-radio{margin-right: 10px;}.jimu-rtl .map-selector .public-search-radios .online-public-radio{margin-right: 0; margin-left: 10px;}.map-selector .public-map-section{position:absolute; width:100%; top:100px; bottom:0;}.map-selector .signin-section{position: absolute; top:75px; width:100%;}.map-selector .signin-section .signin-tip{width:100%; color:#d6d6d6; font-size:13px;}.map-selector .groups-section{font-size: 14px;}.map-selector .groups-section .groups-select{height: 30px; padding: 0 5px;}.mapconfig-customize-scale{width: 100%; height: 100%;}.mapconfig-customize-scale .scale-input-div{position:relative; height:30px;}.mapconfig-customize-scale .add-btn{width: 30px; height: 100%; line-height: 30px; color: #ffffff; font-size: 28px; text-align: center; vertical-align: center; cursor: default; background-color: #d2dae2;}.claro .mapconfig-customize-scale .scale-input-div .dijitNumberTextBox input.dijitInputInner{text-align: left;}.jimu-rtl .claro .mapconfig-customize-scale .scale-input-div .dijitNumberTextBox input.dijitInputInner{text-align: right;}.mapconfig-customize-scale .scale-input-div:hover .add-btn{background-color: #24B5CC;}.mapconfig-customize-scale .operations-div{height: 24px; margin-top: 13px; margin-bottom: 2px;}.mapconfig-customize-scale .operation-btn{display: inline-block; overflow: hidden; height: 24px; cursor: default; font-size: 13px;}.mapconfig-customize-scale .operation-btn .icon{width: 14px; height: 100%; background-repeat: no-repeat; background-position: center center;}.mapconfig-customize-scale .delete-btn{color: #a0acbf; cursor: default;}.mapconfig-customize-scale .delete-btn.enabled-operation{color: #518dca; cursor: pointer;}.mapconfig-customize-scale .delete-btn .icon{background-image: url(images/delete1.png);}.mapconfig-customize-scale .delete-btn.enabled-operation .icon{background-image: url(images/delete2.png);}.mapconfig-customize-scale .reset-btn .icon{background-image: url(images/reset2.png);}.mapconfig-customize-scale .reset-btn{margin-left: 15px; color: #24B5CC; cursor: pointer;}.jimu-rtl .mapconfig-customize-scale .reset-btn{margin-left: 0; margin-right: 15px;}.mapconfig-customize-scale .operation-btn .label{height: 100%; line-height: 24px; vertical-align: middle; margin-left: 7px;}.jimu-rtl .mapconfig-customize-scale .operation-btn .label{margin-left: 0; margin-right: 7px;}.mapconfig-customize-scale .list{width: 100%; height: 395px; border: 1px solid #dfe4ea; background-color: #fafafc; color: #7989a0; font-size: 14px; overflow: auto;}.mapconfig-customize-scale .list .lod-item{height: 30px; line-height: 30px; padding-left: 10px; cursor: default; border-bottom: 1px solid #f2f4f7;}.mapconfig-customize-scale .list .lod-item.selected{background-color: #e3ecf2; color: #596670;}.embed-mapviewer-content {width: 100%; height: 100%; position: relative;}.embed-mapviewer-content .load-container {float: left; position: absolute; overflow: hidden; bottom: 30px; right: 20px;}.embed-mapviewer-content .load-container .loader {font-size: 20px; width: 1.5em; height: 1.5em; border-radius: 50%; position: relative; text-indent: -9999em;}",
"url:builder/plugins/popup-actions/popup-agoltemplate/css/style.css":".plugin-app-actions-template-popup .template-popup-content {height: 100%;}.plugin-app-actions-template-popup .template-popup-content .config-part {width: 70%; height: 100%;}.plugin-app-actions-template-popup .template-popup-content .privew-part-box {height: 100%; width: 30%; padding: 10px 0 10px 0;}.plugin-app-actions-template-popup .template-popup-content .privew-part-inset-box {height: 100%; width: 100%; box-shadow: 0px 0px 8px rgba(0,0,0,0.4) inset; overflow-y: auto; overflow-x: hidden; -ms-overflow-y: auto; -ms-overflow-x: hidden;}.plugin-app-actions-template-popup .template-popup-content .privew-part {width: 90%; height: 100%; min-width: 275px; max-width: 500px; margin: 0 auto;}.plugin-app-actions-template-popup-for-xt .button-container {overflow: visible;}.plugin-app-actions-template-popup-for-xt .export-btn {position: relative; overflow: visible;}.plugin-app-actions-template-popup-for-xt .export-draw-box {position: absolute; height: 60px; background-color: #cccccc; top: -61px; left: 0; cursor: default; background: #fff; box-shadow: 0 0 4px #646464; color: #7989a0; text-align: left; max-width: 270px; overflow: hidden;}.jimu-rtl .plugin-app-actions-template-popup-for-xt .export-draw-box {right: 0; left: auto;}.plugin-app-actions-template-popup-for-xt .export-draw-box.export-draw-box-hiden{display: none;}.plugin-app-actions-template-popup-for-xt .export-draw-box .export-draw-box-btn{cursor: pointer; height: 30px; padding-left: 20px; padding-right: 20px;}.plugin-app-actions-template-popup-for-xt .export-draw-box .export-draw-box-btn:hover{background: #edf2f5; color: #15a4fa;}.plugin-app-actions-template-popup-for-xt .export-draw-box .export-draw-box-btn.export-draw-box-btn-disable{color: #d2dae2;}",
"url:jimu/dijit/templates/ShareOptions.html":'\x3cdiv class\x3d"shareOptions"\x3e\r\n  \x3cdiv class\x3d"shareOptionsWrapper"\x3e\r\n    \x3cdiv class\x3d"subTitle"\x3e${nls.shareMap}\x3c/div\x3e\r\n    \x3cdiv class\x3d"tips"\x3e${nls.shareMapTips}\x3c/div\x3e\r\n    \x3cdiv id\x3d"share-everyone-check_div" class\x3d"shareOptionItems" data-dojo-attach-point\x3d"share-everyone-check_div"\x3e\r\n      \x3cinput id\x3d"share-everyone-check" data-dojo-attach-point\x3d"shareEveryoneCheck" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"/\x3e\r\n      \x3clabel id\x3d"share-everyone-check-label" for\x3d"share-everyone-check" class\x3d"labels"\x3e${nls.everyone}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"share-account-check_div" class\x3d"shareOptionItems displaynone" data-dojo-attach-point\x3d"share-account-check_div"\x3e\r\n      \x3cinput id\x3d"share-account-check" data-dojo-attach-point\x3d"share-account-check" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"/\x3e\r\n      \x3clabel id\x3d"share-account-check-label" for\x3d"share-account-check" class\x3d"labels"\x3e\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"share-groups-div" class\x3d"shareOptionItems displaynone" data-dojo-attach-point\x3d"share-groups-div"\x3e\r\n      \x3cinput id\x3d"share-groups-check" data-dojo-attach-point\x3d"shareGroupsCheck" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"/\x3e\r\n      \x3clabel id\x3d"share-groups-check-label" for\x3d"share-groups-check" class\x3d"labels"\x3e${nls.theseGroups}\x3c/label\x3e\r\n      \x3cdiv class\x3d"share-groups-wrapper"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/layout/BorderContainer" gutters\x3d"false" design\x3d"headline" class\x3d"borderContainer"\x3e\r\n          \x3cdiv id\x3d"share-groups-list" class\x3d"share-groups-list" dojotype\x3d"dijit.layout.ContentPane" region\x3d"middle" splitter\x3d"false"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/ShareLink.html":'\x3cdiv class\x3d"shareLink"\x3e\r\n  \x3cdiv class\x3d"shareLinkOptionsWrapper displaynone"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"backBtn" class\x3d"backBtn"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"subTitle"\x3e${nls.linkOptionsUrlParameters}\x3c/div\x3e\r\n    \x3cform data-id\x3d"shareOptionsRadios" data-dojo-attach-point\x3d"shareOptionsRadios"\x3e\r\n      \x3cfieldset\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"currentMapExtent" class\x3d"shareRadios jimu-float-leading" type\x3d"radio" name\x3d"radios" data-id\x3d"currentMapExtent" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-props\x3d\'checked:true\' checked\x3e\r\n          \x3cdiv class\x3d"labels" data-forid\x3d"currentMapExtent"\x3e${nls.currentMapExtent}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow" data-dojo-attach-point\x3d"chooseCenterWithLevelRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"chooseCenterWithLevel" class\x3d"shareRadios jimu-float-leading" type\x3d"radio" name\x3d"radios" data-id\x3d"chooseCenterWithLevel" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels" data-forid\x3d"chooseCenterWithLevel"\x3e${nls.chooseCenterWithLevel}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore chooseCenterWithLevel_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"chooseCenterWithLevel_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"chooseCenterWithLevel_levels" class\x3d"shareSelects" style\x3d"display: none !important;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"chooseCenterWithScale" class\x3d"shareRadios jimu-float-leading" type\x3d"radio" name\x3d"radios" data-id\x3d"chooseCenterWithScale" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels"\x3e${nls.chooseCenterWithScale}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore chooseCenterWithScale_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"chooseCenterWithScale_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"chooseCenterWithScale_scales" class\x3d"shareSelects" style\x3d"display: none !important;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"optionsRow" data-dojo-attach-point\x3d"findLocationRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"findLocation" class\x3d"shareRadios jimu-float-leading" type\x3d"radio" name\x3d"radios" data-id\x3d"findLocation" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels"\x3e${nls.findLocation}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore findLocation_optionsMore"\x3e\r\n            \x3cdiv class\x3d"moreOptions"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"findLocation_input" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.findLocation_inputPlaceholder}"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"queryFeature" class\x3d"shareRadios jimu-float-leading" type\x3d"radio" name\x3d"radios" data-id\x3d"queryFeature" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels"\x3e${nls.queryFeature}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore queryFeature_optionsMore"\x3e\r\n            \x3cdiv class\x3d"moreOptions"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"queryFeature_layer" name\x3d"queryFeature_layer" class\x3d"queryFeature_layer"\x3e\x3c/div\x3e\r\n              \x3cselect data-dojo-attach-point\x3d"queryFeature_field" name\x3d"queryFeature_field" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n              \x3cselect data-dojo-attach-point\x3d"queryFeature_value" name\x3d"queryFeature_value" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"addMarker" class\x3d"shareRadios jimu-float-leading" type\x3d"radio" name\x3d"radios" data-id\x3d"addMarker" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels"\x3e${nls.addMarker}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore addMarker_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"addMarker_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"moreOptions addMarker_moreOptions"\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e${nls.WKID}\x3c/label\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"addMarker_spatialReference" name\x3d"spatialReference" data-dojo-type\x3d"dijit.form.TextBox"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e${nls.popupTitle}\x3c/label\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"addMarker_title" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_titlePlaceholder}"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e${nls.symbol}\x3c/label\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"addMarker_symbolURL" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_symbolURL}"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e${nls.label}\x3c/label\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"addMarker_label" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_label}"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow displaynone"\x3e\r\n                \x3clabel\x3e${nls.zoomLevel}\x3c/label\x3e\r\n                \x3cdiv class\x3d"table-for-select"\x3e\r\n                  \x3cselect data-dojo-attach-point\x3d"addMarker_level" name\x3d"addMarker_level" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/fieldset\x3e\r\n    \x3c/form\x3e\r\n\r\n    \x3cfieldset\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cinput data-id\x3d"share-options-overwirteMobileLayout" data-dojo-attach-point\x3d"overwirteMobileLayout" class\x3d"shareCheckBoxes jimu-float-leading" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"\x3e\r\n        \x3cdiv class\x3d"labels"\x3e${nls.overwirteMobileLayout}\x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsMore share-options-overwirteMobileLayout_optionsMore"\x3e\r\n          \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" required\x3d"true"\r\n                 data-dojo-attach-point\x3d"mobileLayout" data-dojo-props\x3d\'style:{width:"100px"}, constraints:{min:300}\'/\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cinput data-id\x3d"share-options-language" data-dojo-attach-point\x3d"setlanguage" class\x3d"shareCheckBoxes jimu-float-leading" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"\x3e\r\n        \x3cdiv class\x3d"labels"\x3e${nls.language}\x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsMore share-options-language_optionsMore"\x3e\r\n          \x3cselect data-dojo-attach-point\x3d"setlanguage_languages" class\x3d"shareSelects" style\x3d"display:inline-block;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cinput data-id\x3d"share-options-auth" data-dojo-attach-point\x3d"auth" class\x3d"shareCheckBoxes jimu-float-leading" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"\x3e\r\n        \x3cdiv class\x3d"labels"\x3e${nls.auth}\x3c/div\x3e\r\n        \x3cdiv  class\x3d"optionsMore share-options-auth_optionsMore"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"authtoken" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d\'required:true\'/\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cdiv class\x3d"subTitle"\x3e${nls.linkPreview}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"preview" class\x3d"preview inputsText" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-props\x3d\'required:true,readOnly:true\'\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"shareUrlsWrapper"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"Text"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"linkShare" data-dojo-attach-point\x3d"LinkShareContainer"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"LinkText" class\x3d"subTitle linkToApp"\x3e${nls.shareLinkText}\x3c/div\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_linkUrlTextBox" class\x3d"shareLinkUrl inputsText" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d\'required:true,readOnly:true\'/\x3e\r\n      \x3cdiv class\x3d"shareClearFix"\x3e\r\n        \x3cspan class\x3d"optionsText jimu-float-leading" data-dojo-attach-point\x3d"linkOptions"\x3e${nls.linkOptions}\x3c/span\x3e\r\n        \x3cdiv class\x3d"shareLinkIcons jimu-float-trailing" data-dojo-attach-point\x3d"socialNetworkLinks"\x3e\r\n          \x3cdiv class\x3d"socialNetworkIcons email" data-dojo-attach-event\x3d"click:_toEmail" data-dojo-attach-point\x3d"emailShare" title\x3d"${nls.email}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"socialNetworkIcons facebook" data-dojo-attach-event\x3d"click:_toFacebook" data-dojo-attach-point\x3d"FacebookShare" title\x3d"${nls.facebook}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"socialNetworkIcons twitter" data-dojo-attach-event\x3d"click:_toTwitter" data-dojo-attach-point\x3d"TwitterShare" title\x3d"${nls.twitter}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"socialNetworkIcons googlePlus" data-dojo-attach-point\x3d"googlePlusShare" title\x3d"${nls.googlePlus}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"embedShare" data-dojo-attach-point\x3d"EmbedShareContainer"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"embedText" class\x3d"subTitle"\x3e${nls.embed}\x3c/div\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_embedCodeTextArea" class\x3d"shareEmbedCode inputsText" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-props\x3d\'required:true,readOnly:true\'/\x3e\r\n      \x3cdiv class\x3d"moreOptions" data-dojo-attach-event\x3d"click:_moreOptionsExpandCollapse"\x3e\r\n        \x3cdiv class\x3d"moreOptionsIcon" data-dojo-attach-point\x3d"MoreOptionsIcon"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsText"\x3e${nls.more}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"MoreOptionsContainer" class\x3d"moreOptionsContainer inputsText displaynone"\x3e\r\n        \x3cdiv class\x3d"sizeSelect" data-dojo-attach-point\x3d"SizeSelect"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"customSize disable" data-dojo-attach-point\x3d"CustomSizeContainer"\x3e\r\n          \x3cdiv class\x3d"timesConnector"\x3eX\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"shareTips" data-dojo-attach-point\x3d"shareTips"\x3e\r\n      \x3c!--\x3cdiv class\x3d"infoIcon"\x3e\x3c/div\x3e--\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"shareTipsText" class\x3d"shareTipsText"\x3e${nls.shareToWebTips}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:jimu/dijit/templates/LayerChooserFromMapWithDropbox.html":'\x3cdiv\x3e\r\n  \x3ctable data-dojo-attach-event\x3d"onclick: _onDropDownClick"\x3e\r\n    \x3ccolgroup\x3e\r\n      \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"30px"\x3e\x3c/col\x3e\r\n    \x3c/colgroup\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"layer-name jimu-ellipsis" data-dojo-attach-point\x3d"layerNameNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"drop-select jimu-float-trailing" data-dojo-attach-point\x3d"dropArrowNode"\x3e\r\n            \x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/startup/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"header" data-dojo-attach-point\x3d"headerNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"viewStackNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/startup/css/style.css":".plugin-startup\x3e.jimu-viewstack{position: absolute; top: 61px; bottom: 0; left: 0; right: 0; height: auto; overflow: hidden; background-color: #f3f3f3;}.plugin-startup .image-404{position: absolute; top: 50%; margin-top: -80px; left: 50%; margin-left: -238px;}",
"url:builder/plugins/theme-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"theme-list" data-dojo-attach-point\x3d"themeList"\x3e\r\n    \x3cdiv class\x3d"theme-title"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"separate-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"style-list" data-dojo-attach-point\x3d"styleList"\x3e\r\n    \x3c!--div class\x3d"style-text"\x3e${nls.styleTitle}\x3c/div--\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"layout-list" data-dojo-attach-point\x3d"layoutList"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"theme-loading-cover" style\x3d"display:none" data-dojo-attach-point\x3d"themeCoverNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/theme-config/css/style.css":'.plugin-theme-config{overflow: auto; position: relative;}.plugin-theme-config .section {}.plugin-theme-config .theme-section{}.plugin-theme-config .theme-list{overflow: auto; display: none; padding-left: 30px; padding-right: 14px; border: 0px solid;}.jimu-rtl .plugin-theme-config .theme-list{padding-left: 14px; padding-right: 30px;}.plugin-theme-config .theme-title{margin-top: 20px; margin-left: 18px; font-size: 14px; color: #015574;}.plugin-theme-config .theme-catalog{border: 0px solid; display: none; overflow: hidden;}.plugin-theme-config .catalog-theme-content-div{border: 0px solid; width: 33.333%; height: 114px; overflow: hidden;}.plugin-theme-config .catalog-theme-div{position: relative; width: 106px; height: 78px; cursor: pointer; border: 2px solid #ffffff;}.plugin-theme-config .catalog-theme-div:hover{border-color: #24B5CC;}.plugin-theme-config .catalog-theme-selected {border-color: #24B5CC;}.plugin-theme-config .catalog-theme-img-box-div{width: 102px; height: 74px; border: 1px solid #ddd;}.plugin-theme-config .catalog-theme-img-box-div:hover{border: 1px solid #ffffff;}.plugin-theme-config .catalog-theme-img-box-div.selected{border: 1px solid #ffffff;}.plugin-theme-config .catalog-theme-img-div{text-align: center; width: 84px; height: 56px; display: block; margin-top: 8px; margin-left: auto; margin-right: auto;}.plugin-theme-config .catalog-theme-img{text-align: center; width: 84px; height: 56px;}.plugin-theme-config .catalog-theme-name-div{border: 0px solid; width: 106px; overflow: hidden; text-align: center; padding-top: 5px; font-size: 12px; color: #333; cursor: default; text-overflow: ellipsis; line-height: 17px;}.plugin-theme-config .theme-cl-selected-div{position: absolute; left: 21px; top: 21px; width: 40px; height: 34px; border: 0px solid; text-align: center; display: none; background-color: rgba(0, 0, 0, 0.65);}.plugin-theme-config .theme-cl-selected-img{margin-top: 10px;}.plugin-theme-config .separate-line{margin-left: 10px; margin-right: 10px; border-top: 1px solid #ddd;}.plugin-theme-config .style-list{border: 0px solid; padding-right: 30px; padding-left: 30px;}.plugin-theme-config .style-section{border: 0px solid; overflow: auto;}.plugin-theme-config .style-text{margin-top: 20px; margin-bottom: 15px; font-size: 14px; font-family: "Avenir Medium"}.plugin-theme-config .style-color-content{}.plugin-theme-config .style-div{position: relative; width: 25%; height: 30px; margin-bottom: 12px; cursor: pointer; padding: 4px; background-clip: content-box; border: 2px solid rgba(0,0,0,0);}.plugin-theme-config .style-div:hover{border: 2px solid #24B5CC;}.plugin-theme-config .style-image{}.plugin-theme-config .style-selected{border: 2px solid #24B5CC;}.plugin-theme-config .style-selected-div{position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.65); text-align: center; display: none;}.plugin-theme-config .layout-list{border: 0px solid;}.plugin-theme-config .layout-section{border: 0px solid; overflow: hidden; margin-top: 28px; padding-left: 30px;}.jimu-rtl .plugin-theme-config .layout-section{padding-right: 30px; padding-left: auto;}.plugin-theme-config .layout-text{margin-bottom: 16px; font-size: 14px; font-family: "Avenir Medium"}.plugin-theme-config .layout-out-div{position: relative; margin-bottom: 15px; width: 33%;}.plugin-theme-config .layout-box-div{width: 106px; height: 80px; border: 2px solid #ffffff;}.plugin-theme-config .layout-box-div:hover{border: 2px solid #24B5CC;}.plugin-theme-config .layout-box-selected{border: 2px solid #24B5CC;}.plugin-theme-config .layout-div{width: 102px; height: 76px; border: 1px solid #ddd; text-align: center; cursor: pointer;}.plugin-theme-config .app-layout{background-color: #6f7e95;}.plugin-theme-config .layout-div:hover{border: 1px solid #ffffff;}.plugin-theme-config .layout-selected{border: 1px solid #ffffff;}.plugin-theme-config .layout-image{width: 80px; height: 54px; margin-top: 10px;}.plugin-theme-config .layout-selected-div{position: absolute; left: 28px; top: 24px; width: 40px; height: 34px; border: 0px solid; text-align: center; padding-top: 6px; display: none; background-color: rgba(0, 0, 0, 0.65);}.plugin-theme-config .layout-selected-img{}.plugin-theme-config .theme-loading-cover{position: absolute; z-index: 999; left: 0; right: 0; top: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.3);}.plugin-theme-config .style-div .color-label{margin-top: -8px;}.plugin-theme-config .jimu-color-picker{border-radius: 0;}',
"url:builder/plugins/widget-config/WidgetSettingPage.html":'\x3cdiv class\x3d"widget-setting-page"\x3e\r\n  \x3cdiv class\x3d"section common-setting" data-dojo-attach-point\x3d"commonSettingNode"\x3e\r\n    \x3cdiv class\x3d"basic"\x3e\r\n      \x3cdiv class\x3d"icon jimu-float-leading"\x3e\r\n        \x3cimg class\x3d"real-icon"  data-dojo-attach-point\x3d"iconNode"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"right jimu-float-trailing jimu-leading-margin1"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"labelNode" placeholder\x3d"${nls.widgetLabel}" required\x3d"true" class\x3d"widget-setting-input"\x3e\r\n        \x3cdiv class\x3d"right-foot" data-dojo-attach-point\x3d"rightFooterNode"\x3e\r\n          \x3cdiv class\x3d"image-container"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"imageChooserPlaceholder"\x3e\x3c/div\x3e\r\n            \x3c!-- \x3cspan nowrap class\x3d"change-icon" data-dojo-attach-point\x3d"changeNode"\x3e${nls.changeIcon}\x3c/span\x3e --\x3e\r\n            \x3ca class\x3d"help-link jimu-float-trailing" target\x3d"_blank" data-dojo-attach-point\x3d"helpNode"\x3e${nls.more}\x3c/a\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"layout"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"section widget-setting" data-dojo-attach-point\x3d"widgetSettingNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/GroupSettingPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"label-div"\x3e\r\n    \x3cspan\x3e${nls.label}\x3c/span\x3e\r\n    \x3cinput class\x3d"jimu-input" data-dojo-attach-point\x3d"labelNode"\x3e\x3c/input\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/widget-config/WidgetChoosePage.html":'\x3cdiv class\x3d"widget-choose-page"\x3e\r\n  \r\n  \x3cdiv class\x3d"section search" data-dojo-attach-point\x3d"searchSectionNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"searchInputNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"list widget-list" data-dojo-attach-point\x3d"widgetListNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"preload-widgets-list" data-dojo-attach-point\x3d"preloadWidgetsNode"\x3e\r\n    \x3cdiv class\x3d"controller-widgets-list" data-dojo-attach-point\x3d"controllerWidgetsNode"\x3e\x3c/div\x3e\r\n    \x3chr  data-dojo-attach-point\x3d"notRemoveableOnScreenWidgetsHline"\x3e\r\n    \x3cdiv class\x3d"not-removeable-onscreen-widgets-list" data-dojo-attach-point\x3d"notRemoveableOnScreenWidgetsListNode"\x3e\x3c/div\x3e\r\n    \x3chr  data-dojo-attach-point\x3d"removeableOnScreenWidgetsHline"\x3e\r\n    \x3cdiv class\x3d"removeable-onscreen-widgets-list" data-dojo-attach-point\x3d"removeableOnScreenWidgetsListNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"pool-widgets-list" data-dojo-attach-point\x3d"poolWidgetsNode"\x3e\r\n    \x3cdiv class\x3d"widgets-link" data-dojo-attach-point\x3d"backWidgetsNode" data-dojo-attach-event\x3d"onclick: _onBackWidgetsClick"\x3e \x3cspan\x3e\x3c/span\x3e \x26nbsp;\r\n      ${nls.widgets}\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"widget-pool-title" data-dojo-attach-point\x3d"poolTitleNode"\x3e${nls.setControlledWidgetsBy}\x3cspan data-dojo-attach-point\x3d"controllerLabelNode"\x3e\x3c/span\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"widget-pool-list" data-dojo-attach-point\x3d"poolWidgetsListNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"offpanel-group-error jimu-state-error" data-dojo-attach-point\x3d"offPanelToGroupErrorNode"\x3e\r\n      \x3cspan class\x3d"jimu-icon jimu-icon-alert"\x3e\x3c/span\x3e\r\n      \x3cspan\x3e${nls.offPanelToGroupError}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/css/style.css":'.json-editor{width: 100%; height: 100%; position: relative;}.app-widgets{width: 100%; height: 100%;}.app-widgets\x3e.jimu-viewstack{width: 100%; height: 100%;}.app-widgets .preload-widgets-list, .app-widgets .pool-widgets-list{position: relative; width: 100%; height: 100%; padding: 10px 0px; -ms-overflow-x: hidden; -ms-overflow-y: auto; overflow-x: hidden; overflow-y: auto;}.app-widgets .preload-widgets-list hr{margin: 10px 15px -5px 15px; border: none; border-top: 1px solid #ddd;}.app-widgets .controller-widget{position: relative; height: 118px; padding-top: 20px;}.app-widgets .controller-widget:hover{background-color: #F3F3F3;}.app-widgets .controller-widget .action-node{position: absolute; left: 96px; top: 20px; height: 74px; right: 0; line-height: 74px; cursor: pointer; font-size: 14px;}.app-widgets .controller-widget .action-node .action-text{white-space: nowrap; text-overflow: ellipsis; overflow: hidden; width: 230px; font-family: "Avenir Medium"}.app-widgets .controller-widget .action-node .action-arrow{width: 7px; height: 100%; background-image: url(images/right_arrow1.png); background-repeat: no-repeat; background-position: center;}.app-widgets .not-removeable-onscreen-widgets-list,.app-widgets .removeable-onscreen-widgets-list{position: relative; left: 15px; right: 0; margin-top: 20px;}.app-widgets .widget-pool-list{position: absolute; top: 95px; left: 15px; right: 0; bottom: 0; overflow-x: hidden; overflow-y: auto;}.app-widgets .pool-widgets-list .offpanel-group-error{position: absolute; z-index: 1; left: 0; top: 42px; height: 30px; line-height: 30px; width: 100%; padding: 0 10px; filter:alpha(opacity\x3d0); opacity: 0;}.app-widgets .widgets-link{font-size: 14px; margin-left: 30px; cursor: pointer; font-family: "Avenir Medium"; margin-top: 20px; color: #333;}.app-widgets .widgets-link:hover{color: black;}.app-widgets .widgets-link span{width: 7px; height: 12px; display: inline-block; background-image: url(images/left_arrow1.png)}.app-widgets .widget-pool-title{margin-top: 15px; font-size: 12px; color: #666; margin-left: 30px;}.app-widgets .moveable{position: absolute; font-size: 12px; float: left; z-index: 3;}.app-widgets .moveable.dojoMoveItem{z-index: 4;}.app-widgets .moveable .box{position: relative; border: 1px solid #80C6D1; background-color: #80C6D1; width: 112px; height: 112px; overflow: hidden; cursor: pointer;}.app-widgets .moveable.placeholder .box{background-color: #bbb; border: 1px solid #bbb;}.app-widgets .moveable.placeholder .box:hover{background-color: #aaa;}.app-widgets .preload-widgets-list .moveable.group-node .box{background-color: #bbb; border: 1px solid #bbb;}.app-widgets .preload-widgets-list .moveable.group-node .box:hover{background-color: #aaa;}.app-widgets .moveable.node-active .box{border: 3px solid #15a4fa;}.app-widgets .moveable .box.jimu-state-active{border: 2px solid red;}.app-widgets .moveable .label{text-align: center; width: 100%; height: 30px; margin-top: 6px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; color: #333;}.app-widgets .moveable .edit-btn{position: absolute; background-color: #000; background-color: rgba(0, 0, 0, 0.3); background-image: url(images/edit_widget.png); background-repeat: no-repeat; background-position: center;}.app-widgets .moveable .open-at-start-btn{position: absolute; border-radius: 6px; border: 2px solid white;}.app-widgets .moveable .open-at-start-btn.active{background-color: #336666; filter:alpha(opacity\x3d100); opacity: 1;}.app-widgets .moveable .open-at-start-btn.deactive{filter:alpha(opacity\x3d50); opacity: 0.5;}.app-widgets .moveable .drop-btn{position: absolute; background-color: #000; background-color: rgba(0, 0, 0, 0.3); background-image: url(images/delete_widget.png); background-repeat: no-repeat; background-position: center;}.app-widgets .moveable .switch-btn{position: absolute; border-radius: 2px; background: url(images/eye_open.png) no-repeat center center;}.app-widgets .moveable.hide .switch-btn{background-image: url(images/eye_close.png);}.app-widgets .moveable.hide{opacity: 0.5;}.app-widgets .moveable .edit-btn:hover{background-color: rgba(0, 0, 0, 0.6);}.app-widgets .moveable .open-at-start-btn:hover{filter:alpha(opacity\x3d100); opacity: 1;}.app-widgets .moveable .drop-btn:hover{background-color: rgba(0, 0, 0, 0.6);}.app-widgets .moveable .switch-btn:hover{background-image: url(images/eye_open_hover.png);}.app-widgets .moveable.hide .switch-btn:hover{background-image: url(images/eye_close_hover.png);}.app-widgets .moveable .switch-btn:hover{background-color: rgba(0, 0, 0, 0.6);}.app-widgets .node-shadow{position: absolute; border: 1px dashed;}.app-widgets .node-margin{position: absolute; z-index: 2;}.app-widgets .node-margin-active{background: red;}.app-widgets .add-widget-node{position: absolute; font-size: 12px; float: left;}.app-widgets .add-widget-node .box{background-color: #fafafc; border: 1px dashed #d2dae2; color: #596679;}.app-widgets .add-widget-node .box:hover{background-color: #eaeaea;}.app-widgets .add-widget-node img{width: 20px; height: 20px; display: block; margin: 27px;}.app-widgets .empty-node .box{opacity: 0; cursor: normal;}.app-widgets .empty-node-active .box{opacity: 0.4;}.app-widgets .widget-node .placeholder{overflow: hidden;}.app-widgets .widget-node .placeholder-inner{text-align: center; color: white; font-size: 14px;}.app-widgets .group-node .small{float: left;}.app-widgets .group-node .add-button{width: 20px; height: 20px; margin: auto; display: block; margin-top: 25px;}.app-widgets .widget-group-panel{position: absolute; background-color: #E3ECF2;}.app-widgets .group-triangle{position: absolute; width: 0px; height: 0px; top: -8px; border-left: 8px solid transparent; border-right: 8px solid transparent; border-bottom: 8px solid #E3ECF2;}.widget-setting-popup .content{overflow-y: hidden;}.widget-setting-page{width: 100%; height: 100%;}.widget-setting-page .common-setting{height: 74px; margin-bottom: 20px;}.widget-setting-page .common-setting .basic{overflow: hidden;}.widget-setting-page .common-setting .label input{width: 224px; height: 32px;}.widget-setting-page .opts-section{padding: 5px;}.widget-setting-page .common-setting .icon{background-color: #80C6D1; border: 1px solid #80C6D1; width: 74px; height: 74px; display: inline-block;}.widget-setting-page .common-setting .icon img{width: 40px; height: 40px; margin: 17px;}.widget-setting-page .common-setting .right{font-size: 10px; width: 875px; display: inline-block;}.widget-setting-page .common-setting .right .widget-setting-input{width: 100%; color: black; display: block; background-color: #fafafc;}.widget-setting-page .image-container{overflow:hidden; min-width: 100px; width: 100%; display: inline-block; position: relative; height: 30px; margin-top: 14px;}.widget-setting-page .image-container .help-link{color: #24B5CC; display:none;}.widget-setting-page .image-container .help-link:hover{color: #0090A7;}.widget-setting-page .jimu-image-chooser{height: 30px; padding: 0;}.widget-setting-page .common-setting .right .change-icon{white-space:nowrap; color: white; cursor: pointer; display: inline-block; background-color: #518dca; text-align: center; vertical-align: middle; height: 30px; line-height: 30px; padding-left: 6px; padding-right: 6px; box-shadow: 0 0 2px gray; position: relative;}.widget-setting-page .common-setting .right .disable-change-icon{background-color: #a0acbf; cursor: default;}.widget-setting-page .common-setting .right .more{float: right; color: #15a4fa; display: inline-block; margin-top: 20px;}.widget-setting-page .common-setting .right-foot{position: relative; font-size: 14px;}.widget-setting-page .common-setting .right .state{font-size: 14px; margin-top: 10px;}.widget-setting-page .widget-setting{overflow-x: hidden; overflow-y: auto; position: relative;}.widget-setting-page .widget-default-setting{width: 100%; height: 100%;}.widget-setting-page .opts-section{height: 50px;}.widget-setting-page .opts-section .jimu-btn{width: 182px; height: 40px; margin-left: 8px;}.widget-setting-page .noconfig-info{font-size: 16px; position: absolute; left: 50%; top: 50%; margin-left: -100px;}.widget-choose-page{width: 100%; height: 100%;}.widget-choose-page .jimu-search{margin: 10px 0;}.widget-choose-page .jimu-search .jimu-input{font-size: 12px;}.widget-choose-page .widget-node{width: 78px; height: 118px; margin: 10px 10px 0 0px; float: left; font-size: 12px; cursor: pointer; position: relative;}.widget-choose-page .widget-node .box{position: relative; border: 1px solid #80C6D1; background-color: #80C6D1; width: 78px; height: 78px; overflow: hidden;}.widget-choose-page .widget-node .box-selected{position: absolute; width: 16px; height: 16px; left: 5px; top: 5px; display: none; background: url(images/checked.svg);}.widget-choose-page .widget-node.jimu-state-selected .box-selected{display: block;}.widget-choose-page .widget-node .icon{width: 32px; height: 32px; display: block; margin: auto; margin-top: 23px;}.widget-choose-page .widget-node .label{text-align: center; width: 100%; height: 30px; margin-top: 10px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.widget-choose-page .search{width: 100%; overflow-x: hidden; overflow-y: hidden;}.widget-choose-page .list{height: 100%; margin-right: -10px; padding-left: 2px;}.widget-choose-page .opts-section{overflow: hidden; margin-top: 10px;}.widget-choose-page .opts-section .jimu-btn{width: 182px; height: 40px; margin-left: 8px;} .group-setting-page {margin: 20px 10px; font-size: 16px;}.group-setting-page .label-div input{margin-left: 10px; color: #000000;}.jimu-rtl .app-widgets .controller-widget .action-node{right: 96px; left: 0;}.jimu-rtl .widget-choose-page .widget-node{margin: 10px 0 0 10px; float: right;}.jimu-rtl .widget-choose-page .list{margin-right: auto; padding-left: auto; margin-left: -10px; padding-right: 2px;}.jimu-rtl .app-widgets .controller-widget .action-node .action-arrow{background-image: url(images/left_arrow1.png);}.jimu-rtl .app-widgets .controller-widget .action-node:hover .action-arrow{background-image: url(images/left_arrow2.png);}.jimu-rtl .app-widgets .widgets-link{margin-left: auto; margin-right: 30px;}.jimu-rtl .app-widgets .widgets-link span{background-image: url(images/right_arrow1.png)}.jimu-rtl .app-widgets .widgets-link:hover span{background-image: url(images/right_arrow2.png)}.jimu-rtl .app-widgets .widget-pool-title{margin-left: auto; margin-right: 30px;}.jimu-rtl .app-widgets .not-removeable-onscreen-widgets-list,.jimu-rtl .app-widgets .removeable-onscreen-widgets-list{right: 15px; left: 0;}.dj_ie8 .app-widgets .empty-node .box {-ms-filter: "Alpha(opacity\x3d0)"; filter: Alpha(opacity\x3d0);}.dj_ie8 .app-widgets .moveable .edit-btn{-ms-filter: "Alpha(opacity\x3d30)"; filter: Alpha(opacity\x3d30);}.dj_ie8 .app-widgets .moveable .edit-btn:hover{-ms-filter: "Alpha(opacity\x3d60)"; filter: Alpha(opacity\x3d60);}.dj_ie8 .app-widgets .moveable.hide {-ms-filter: "Alpha(opacity\x3d50)"; filter: Alpha(opacity\x3d50);}',
"*now":function(p){p(['dojo/i18n!*preload*builder/nls/main*["ar","cs","da","de","en","el","es","et","fi","fr","he","hr","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/config dojo/_base/html dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred dojo/cookie dojo/topic dojo/json dojo/request/script jimu/utils jimu/portalUrlUtils jimu/portalUtils ./tokenUtils ./utils ./PluginManager require esri/request esri/IdentityManager dojo/text!./plugins/plugins.json dojo/i18n!./nls/builder".split(" "),function(p,f,a,l,k,h,q,m,g,e,c,d,r,u,s,t,b,v,n,w,x){function z(a){f.setStyle("pre-main-page","display","none");f.setStyle("main-page","display","block");
window.portalUrl=a.portalUrl;u.setPortalUrl(window.portalUrl);var b=d.getSharingUrl(window.portalUrl);n.checkSignInStatus(b).then(function(){y(a)},function(){if(window.isXT)u.xtGetCredentialFromCookie(window.portalUrl)&&y(a);else{var b=d.getPortalSignInUrlFromLocation(),c=encodeURIComponent(window.location.href);window.location.href=b+"?returnUrl\x3d"+c}})}function y(b){var e=function(){u.signOutAll();if(window.isXT)window.location.href=window.location.href;else{var a=d.getPortalSignInUrlFromLocation(),
b=encodeURIComponent(window.location.href);window.location.href=a+"?returnUrl\x3d"+b}};B().then(a.hitch(this,function(g){if(g){var l=r.getPortal(window.portalUrl);g=l.loadSelfInfo();var m=A(window.portalUrl),n;k([g,m]).then(function(a){n=a[0];window.portalSelf=n;window.isXT?a=s.checkProtocolAndUpdateSigninInfo(n,b):(a=new h,a.resolve({success:!0}));return a}).then(function(e){if(e.success){var g=n.user&&n.user.culture||n.culture||p.locale;g&&(g=g.toLowerCase());e=null;!window.queryObject.locale&&
c.isLocaleChanged(p.locale,g)&&(q("wab_locale",g),e=window.location.href);window.isXT&&/[\?|\&](action=)(.+)/gi.test(window.location.href)&&(e||(e=window.location.href),e=s.removeActionFromUrl(e));g="https:"===window.location.protocol;if(n.allSSL||g)window.portalUrl=b.portalUrl=d.setHttpsProtocol(b.portalUrl);l.portalUrl=window.portalUrl;var h=0===window.portalUrl.toLowerCase().indexOf("https:");!g&&h&&(e||(e=window.location.href),e=e.replace(/^http:/i,"https:"));e?window.location.href=e:(e=H.startup,
e.options={signinInfo:b},t.getInstance(H).loadPlugin(e).then(a.hitch(this,function(a){a.placeAt(f.byId("main-page"));a.startup()})))}else console.log("Update signin info error.")})}else e()}),e)}function A(b){var c=d.getSharingUrl(b),e=new h;v({url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback",preventCache:!0}).then(a.hitch(this,function(a){window.portalVersion=a.currentVersion;d.isOnline(b)?window.isPortalSupport3D=!0:window.isPortalSupport3D=0<=r.comparePortalVersion(window.portalVersion,
"3.7");e.resolve()}),a.hitch(this,function(a){console.error(a);e.reject(a)}));return e}function B(){var b=new h,c=u.getPortalCredential(window.portalUrl);c&&c.token?(c=d.getPortalSelfInfoUrl(window.portalUrl)+"?f\x3djson\x26token\x3d"+c.token,c=d.setHttpsProtocol(c),e.get(c,{handleAs:"json",jsonp:"callback",timeout:6E4}).then(a.hitch(this,function(a){a&&!a.error?b.resolve(!0):b.resolve(!1)}),a.hitch(this,function(a){console.error(a);b.reject(a)}))):b.resolve(!1);return b}function F(a,b){l.forEach(b,
function(b){var d=H[b.pluginName],e;for(e in b.parameters)if(e===a.name){var f=b.parameters[e];c.url.isAbsolute(f)||(b.parameters[e]=d.folderUrl+f)}})}function E(a){var b=new h;if(!a.parameters||null===g.stringify(a.parameters).match(/\$\{(\w)+\}/g))return b.resolve(!0),b;var d=H[a.pluginName];t.getInstance().loadPluginI18n(d).then(function(d){a.parameters=c.replacePlaceHolder(a.parameters,d);b.resolve(!0)});return b}var H=g.parse(w);window.builderNls=x;window.pluginsMeta=H;"function"!==typeof q.getAll&&
(q.getAll=function(a){var b=[];(a=q(a))&&b.push(a);return b});jimuConfig.layoutId=jimuConfig.mainPageId;m.subscribe("switchToMainPage",function(a){var b=s.removeActionFromUrl(window.location.href);c.changeLocation(b);z(a)});(function(){for(var a in H){var c=H[a];c.amdFolder="builder/plugins/"+a.replace(/\./g,"/")+"/";c.folderUrl=b.toUrl(c.amdFolder);c.uri=c.amdFolder+"Plugin"}a=[];for(var d in H){var c=H[d],e;for(e in c.extensionPoints){var f=c.extensionPoints[e],g;for(g in f.parameters){var h=f.parameters[g];
"url"===h.type&&F(h,f.extensions)}if(f.extensions)for(h=0;h<f.extensions.length;h++)a.push(E(f.extensions[h]))}}return k(a)})().then(function(){f.setStyle("main-loading","display","none");window.isXT?b(["./xtMain"]):m.publish("switchToMainPage",{portalUrl:d.getPortalUrlFromLocation()})})});