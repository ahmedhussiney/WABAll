// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define(["dojo/_base/array","dojo/Deferred","jimu/portalUtils"],function(e,f,k){function g(a){return e.some(l,function(b){return-1<a.search(b)})}function h(a){return e.some(m,function(b){return-1<a.search(b)})}function n(a){var b=new f;if(a){var d=[];e.forEach(a.operationalLayers,function(b){var a,c;a=b.url;c=document.createElement("a");c.href=a;a=g(c.host);c=h(c.host);if(a||c)d.push({sourceUrl:b.url,title:b.title||b.name,premium:a,consumeCredits:c,useProxy:!1})});b.resolve(d)}else b.resolve([]);return b}
var l=[/traffic\w*\.arcgis\.com/i,/landsat\w*\.arcgis\.com/i,/elevation\w*\.arcgis\.com/i,/geoenrich\w*\.arcgis\.com/i,/hydro\w*\.arcgis\.com/i,/naip\w*\.arcgis\.com/i,/livefeeds\w*\.arcgis\.com/i,/demographics\w*\.arcgis\.com/i,/landscape\w*\.arcgis\.com/i,/historical\w*\.arcgis\.com/i,/earthobs\w*\.arcgis\.com/i],m=[/demographics\w*\.arcgis\.com/i,/geoenrich\w*\.arcgis\.com/i,/route\w*\.arcgis\.com/i,/logistics\w*\.arcgis\.com/i,/analysis\w*\.arcgis\.com/i,/elevation\w*\.arcgis\.com/i],d={queryForSecureServicesInMap:function(a,
b){try{return k.getPortal(a).getItemData(b).then(function(a){return n(a)},function(){return[]})}catch(d){var e=new f;e.resolve([]);return e}}};d.isPremium=g;d.consumesCredits=h;return d});